var Xb=Object.defineProperty;var dt=(i,e)=>{for(var t in e)Xb(i,t,{get:e[t],enumerable:!0})};var ql={};dt(ql,{AddPPToWindowComponent:()=>ki,AddWLToWindowComponent:()=>Bi,AdjustHierarchyPhysXScaleComponent:()=>So,AnalyticsUtils:()=>hR,ArrayUtils:()=>X,AudioEvent:()=>ns,AudioManager:()=>os,AudioManagerComponent:()=>ii,AudioPlayer:()=>Gi,AudioSetup:()=>An,AudioUtils:()=>WA,BaseGamepad:()=>cs,BasePose:()=>Ge,BasePoseParams:()=>xt,BenchmarkMaxPhysXComponent:()=>To,BenchmarkMaxVisibleTrianglesComponent:()=>Po,BrowserUtils:()=>ti,CADisplayLeaderboardComponent:()=>Vo,CADummyServer:()=>Vs,CAError:()=>Fe,CAUtils:()=>pe,CharacterColliderAdditionalParams:()=>ks,CharacterColliderDebugParams:()=>Fs,CharacterColliderHorizontalCheckParams:()=>Is,CharacterColliderHorizontalPositionVerticalCheckDirection:()=>mb,CharacterColliderSetup:()=>tn,CharacterColliderSetupSimplifiedCreationAccuracyLevel:()=>nn,CharacterColliderSetupSimplifiedCreationParams:()=>js,CharacterColliderSetupUtils:()=>rm,CharacterColliderSlideFlickerPreventionMode:()=>ws,CharacterColliderSplitMovementParams:()=>Hs,CharacterColliderSurfaceParams:()=>$n,CharacterColliderVerticalCheckParams:()=>Bs,CharacterColliderWallSlideParams:()=>Ls,CharacterCollisionCheckTransformResults:()=>Kn,CharacterCollisionCheckType:()=>Ai,CharacterCollisionDebugResults:()=>Zn,CharacterCollisionInternalResults:()=>Yn,CharacterCollisionMovementResults:()=>Ei,CharacterCollisionResults:()=>Ue,CharacterCollisionSplitMovementResults:()=>Jn,CharacterCollisionSurfaceInfo:()=>$i,CharacterCollisionSurfaceResults:()=>en,CharacterCollisionSystem:()=>eo,CharacterCollisionSystemComponent:()=>Oo,CharacterCollisionTeleportResults:()=>Xn,CharacterCollisionTransformResults:()=>qn,CharacterCollisionWallSlideResults:()=>Qn,ClassicGamepadCore:()=>Vn,ClearConsoleOnXRSessionStartComponent:()=>Co,CloneParams:()=>jt,CollisionCheck:()=>N,CollisionCheckBridge:()=>Q,CollisionCheckParams:()=>et,CollisionCheckUtils:()=>Os,CollisionRuntimeParams:()=>de,ColorUtils:()=>he,ComponentUtils:()=>j,ConsoleOriginalFunctions:()=>Ee,ConsoleVR:()=>fs,ConsoleVRToolComponent:()=>No,ConsoleVRWidget:()=>da,ConsoleVRWidgetConfig:()=>la,ConsoleVRWidgetConsoleFunction:()=>re,ConsoleVRWidgetMessage:()=>pa,ConsoleVRWidgetMessageType:()=>H,ConsoleVRWidgetParams:()=>ca,ConsoleVRWidgetPulseOnNewMessage:()=>ra,ConsoleVRWidgetSender:()=>Ie,ConsoleVRWidgetUI:()=>ya,CopyHandTransformComponent:()=>wo,CopyHeadTransformComponent:()=>jo,CopyPlayerTransformComponent:()=>zo,CopyReferenceSpaceTransformComponent:()=>Go,CustomCloneParams:()=>co,DebugArrayFunctionsPerformanceAnalyzerComponent:()=>Do,DebugFunctionPerformanceAnalysisResults:()=>Un,DebugFunctionsOverwriter:()=>Nn,DebugFunctionsOverwriterParams:()=>Gn,DebugFunctionsPerformanceAnalysisResultsLogger:()=>As,DebugFunctionsPerformanceAnalysisResultsLoggerParams:()=>Es,DebugFunctionsPerformanceAnalyzer:()=>Ds,DebugFunctionsPerformanceAnalyzerComponent:()=>mt,DebugFunctionsPerformanceAnalyzerParams:()=>Wn,DebugFunctionsPerformanceAnalyzerSortOrder:()=>Lt,DebugManager:()=>ls,DebugManagerComponent:()=>si,DebugPPArrayCreationPerformanceAnalyzerComponent:()=>Eo,DebugPPFunctionsPerformanceAnalyzerComponent:()=>Mo,DebugTransformComponent:()=>xo,DebugVisualManager:()=>Di,DebugWLComponentsFunctionsPerformanceAnalyzerComponent:()=>Ro,DebugWLFunctionsPerformanceAnalyzerComponent:()=>Ao,DeepCloneParams:()=>zt,DefaultResources:()=>is,DefaultResourcesMaterials:()=>Dr,DefaultResourcesMeshes:()=>Mr,DefaultWLComponentCloneCallbacks:()=>Cn,Direction2DTo3DConverter:()=>Kt,Direction2DTo3DConverterParams:()=>Yi,EPSILON:()=>nr,EPSILON_DEGREES:()=>km,EPSILON_SQUARED:()=>Hm,EasingFunction:()=>ue,EasyLightAttenuation:()=>za,EasyLightAttenuationComponent:()=>Qo,EasyLightColor:()=>Ga,EasyLightColorComponent:()=>qo,EasyMeshAmbientFactor:()=>Qa,EasyMeshAmbientFactorComponent:()=>Xo,EasyMeshColor:()=>Na,EasyMeshColorComponent:()=>Ko,EasyObjectTuner:()=>it,EasyScale:()=>Ua,EasyScaleComponent:()=>Jo,EasySetTuneTargeetGrabComponent:()=>Yo,EasySetTuneTargetChildNumberComponent:()=>Zo,EasyTextColor:()=>qa,EasyTextColorComponent:()=>$o,EasyTransform:()=>Wa,EasyTransformComponent:()=>es,EasyTuneBaseArrayWidgetSelector:()=>pn,EasyTuneBaseWidget:()=>kt,EasyTuneBaseWidgetConfig:()=>Ft,EasyTuneBaseWidgetParams:()=>Pa,EasyTuneBaseWidgetUI:()=>wt,EasyTuneBool:()=>um,EasyTuneBoolArray:()=>qr,EasyTuneBoolArrayWidget:()=>Ma,EasyTuneBoolArrayWidgetConfig:()=>Ca,EasyTuneBoolArrayWidgetSelector:()=>Da,EasyTuneBoolArrayWidgetUI:()=>xa,EasyTuneImportVariablesComponent:()=>Wo,EasyTuneInt:()=>fa,EasyTuneIntArray:()=>Ti,EasyTuneNoneWidget:()=>Va,EasyTuneNoneWidgetConfig:()=>Aa,EasyTuneNoneWidgetUI:()=>Ra,EasyTuneNumber:()=>Vi,EasyTuneNumberArray:()=>fi,EasyTuneNumberArrayWidget:()=>Ba,EasyTuneNumberArrayWidgetConfig:()=>Oa,EasyTuneNumberArrayWidgetSelector:()=>La,EasyTuneNumberArrayWidgetUI:()=>Ia,EasyTuneToolComponent:()=>Uo,EasyTuneTransform:()=>Ta,EasyTuneTransformWidget:()=>Fa,EasyTuneTransformWidgetConfig:()=>Ha,EasyTuneTransformWidgetUI:()=>ka,EasyTuneUtils:()=>He,EasyTuneVariable:()=>ga,EasyTuneVariableArray:()=>cn,EasyTuneVariableType:()=>Yt,EasyTuneVariables:()=>Ts,EasyTuneWidget:()=>ja,EasyTuneWidgetConfig:()=>Ea,EasyTuneWidgetParams:()=>wa,EnableDebugComponent:()=>Li,EnableToolComponent:()=>Hi,FSM:()=>ct,FingerCursorComponent:()=>ji,GamepadAxesEvent:()=>Qt,GamepadAxesID:()=>ne,GamepadAxesInfo:()=>ys,GamepadButtonEvent:()=>ae,GamepadButtonID:()=>E,GamepadButtonInfo:()=>ms,GamepadControlSchemeComponent:()=>Ho,GamepadCore:()=>It,GamepadMeshAnimatorComponent:()=>xn,GamepadPulseInfo:()=>us,GamepadUtils:()=>XR,GamepadsManager:()=>ps,GetDefaultResourcesComponent:()=>mi,GetSceneObjectsComponent:()=>yi,Globals:()=>m,GrabbableComponent:()=>Fi,GrabberHandComponent:()=>wi,HandPose:()=>Xi,HandPoseParams:()=>qi,Handedness:()=>A,HandednessIndex:()=>vi,HeadPose:()=>ds,HowlerAudioPlayer:()=>Xl,InitConsoleVRComponent:()=>ri,InitEasyTuneVariablesComponent:()=>li,InputManager:()=>gs,InputManagerComponent:()=>ai,InputSourceType:()=>lt,InputUtils:()=>ie,IntOverFactor:()=>im,IntRangeOverFactor:()=>nm,JSUtils:()=>Y,KeyID:()=>$,Keyboard:()=>hs,KeyboardGamepadCore:()=>On,Mat3Utils:()=>K,Mat4Utils:()=>R,MaterialUtils:()=>xs,MathUtils:()=>B,MeshCreationParams:()=>Pn,MeshCreationTriangleParams:()=>Si,MeshCreationVertexParams:()=>Tn,MeshUtils:()=>Re,Mouse:()=>_s,MouseButtonID:()=>ci,MuteEverythingComponent:()=>go,NumberOverFactor:()=>_i,NumberRangeOverFactor:()=>Fr,ObjectPool:()=>Ui,ObjectPoolManager:()=>ss,ObjectPoolManagerComponent:()=>ni,ObjectPoolParams:()=>Ni,ObjectUtils:()=>c,PPGatewayComponent:()=>_o,PerformDelayedMode:()=>Cs,PerformMode:()=>di,PhysicsCollisionCollector:()=>Xt,PhysicsLayerFlags:()=>Ve,PhysicsUtils:()=>De,PlayerHeadManager:()=>se,PlayerHeadManagerParams:()=>to,PlayerLocomotion:()=>$s,PlayerLocomotionComponent:()=>Io,PlayerLocomotionDirectionReferenceType:()=>Gr,PlayerLocomotionMovement:()=>on,PlayerLocomotionMovementRuntimeParams:()=>Ns,PlayerLocomotionParams:()=>Ys,PlayerLocomotionRotate:()=>gi,PlayerLocomotionRotateParams:()=>Gs,PlayerLocomotionSmooth:()=>Zt,PlayerLocomotionSmoothParams:()=>ea,PlayerLocomotionTeleport:()=>io,PlayerLocomotionTeleportDetectionParams:()=>qs,PlayerLocomotionTeleportDetectionRuntimeParams:()=>jr,PlayerLocomotionTeleportDetectionState:()=>pt,PlayerLocomotionTeleportDetectionVisualizer:()=>Ri,PlayerLocomotionTeleportDetectionVisualizerParams:()=>Qs,PlayerLocomotionTeleportParable:()=>Ht,PlayerLocomotionTeleportParams:()=>Zs,PlayerLocomotionTeleportRuntimeParams:()=>zr,PlayerLocomotionTeleportState:()=>Pt,PlayerLocomotionTeleportTeleportBlinkState:()=>Xs,PlayerLocomotionTeleportTeleportParams:()=>Ks,PlayerLocomotionTeleportTeleportShiftState:()=>sn,PlayerLocomotionTeleportTeleportState:()=>Js,PlayerLocomotionTeleportTeleportType:()=>an,PlayerLocomotionType:()=>lm,PlayerObjects:()=>xr,PlayerObscureManager:()=>Ws,PlayerObscureManagerParams:()=>Us,PlayerTransformManager:()=>tt,PlayerTransformManagerParams:()=>zs,PlayerTransformManagerSyncFlag:()=>ce,PluginUtils:()=>xe,Quat2Utils:()=>V,QuatUtils:()=>T,RaycastHit:()=>st,RaycastParams:()=>ut,RaycastResults:()=>ke,SaveManager:()=>Zl,SaveUtils:()=>Bt,SceneObjects:()=>ts,SceneUtils:()=>Z,SetActiveComponent:()=>bo,SetHandLocalTransformComponent:()=>Mn,SetHeadLocalTransformComponent:()=>zi,SetPlayerHeightComponent:()=>Fo,SetTrackedHandJointLocalTransformComponent:()=>Dn,ShowFPSComponent:()=>vo,SkipStateFunction:()=>Fn,SpatialAudioListenerComponent:()=>fo,State:()=>Zi,StateData:()=>wn,SwitchHandObjectComponent:()=>Bo,TextUtils:()=>uR,Timer:()=>te,TimerState:()=>Ss,ToolCursorComponent:()=>En,ToolHandedness:()=>W,ToolInputSourceType:()=>Ae,TrackedHandDrawAllJointsComponent:()=>Lo,TrackedHandDrawJointComponent:()=>xi,TrackedHandDrawSkinComponent:()=>vn,TrackedHandJointID:()=>ot,TrackedHandJointIDIndex:()=>bn,TrackedHandJointPose:()=>Ln,TrackedHandPose:()=>Hn,TrackedHandPoseParams:()=>Ki,Transition:()=>$l,TransitionData:()=>jn,UniversalGamepad:()=>Bn,Vec2Utils:()=>nt,Vec3Utils:()=>d,Vec4Utils:()=>Nt,VecUtils:()=>gt,VirtualGamepad:()=>sa,VirtualGamepadButtonParams:()=>Mt,VirtualGamepadComponent:()=>ko,VirtualGamepadGamepadCore:()=>no,VirtualGamepadIcon:()=>rn,VirtualGamepadIconParams:()=>oo,VirtualGamepadIconType:()=>Oe,VirtualGamepadParams:()=>ln,VirtualGamepadThumbstickParams:()=>ia,VirtualGamepadVirtualButton:()=>na,VirtualGamepadVirtualThumbstick:()=>oa,VisualArrow:()=>yt,VisualArrowParams:()=>ze,VisualElementType:()=>Me,VisualLine:()=>St,VisualLineParams:()=>Ze,VisualManager:()=>Qi,VisualManagerComponent:()=>oi,VisualMesh:()=>Wi,VisualMeshParams:()=>Ut,VisualPoint:()=>ui,VisualPointParams:()=>vt,VisualRaycast:()=>as,VisualRaycastParams:()=>Wt,VisualResources:()=>rs,VisualResourcesMaterials:()=>Ar,VisualText:()=>Rn,VisualTextParams:()=>Vt,VisualTorus:()=>hi,VisualTorusParams:()=>Ot,VisualTransform:()=>Mi,VisualTransformParams:()=>At,WidgetFrame:()=>yn,WidgetFrameConfig:()=>ua,WidgetFrameUI:()=>ha,WidgetParams:()=>mn,XRGamepadCore:()=>In,XRUtils:()=>O,add:()=>Fy,addComponent:()=>zd,addEngine:()=>ml,addRefreshWidgetCallback:()=>jb,addSetWidgetCurrentVariableCallback:()=>Fb,angle:()=>Iy,angleClamp:()=>$m,angleClampDegrees:()=>ey,angleClampRadians:()=>ty,angleDegrees:()=>By,angleDistance:()=>qm,angleDistanceDegrees:()=>Xm,angleDistanceRadians:()=>Km,angleDistanceSigned:()=>Jm,angleDistanceSignedDegrees:()=>Zm,angleDistanceSignedRadians:()=>Ym,anglePivoted:()=>Zy,anglePivotedDegrees:()=>Yy,anglePivotedRadians:()=>$y,anglePivotedSigned:()=>eu,anglePivotedSignedDegrees:()=>tu,anglePivotedSignedRadians:()=>iu,angleRadians:()=>Ly,angleSigned:()=>Xy,angleSignedDegrees:()=>Ky,angleSignedRadians:()=>Jy,areButtonsPressEnd:()=>Tb,areButtonsPressStart:()=>fb,areButtonsTouchEnd:()=>Sb,areButtonsTouchStart:()=>Cb,assert:()=>UP,ceil:()=>Wf,checkMovement:()=>tb,checkTeleportToTransform:()=>ib,checkTransform:()=>nb,cleanObjectProperties:()=>oT,cloneCollision:()=>fT,cloneDefault:()=>FT,cloneMesh:()=>gT,clonePhysX:()=>PT,clonePostProcess:()=>kT,cloneText:()=>TT,color1To255:()=>dC,color255To1:()=>pC,componentAlongAxis:()=>su,convertCharacterColliderSetupToCollisionCheckParams:()=>lb,convertCharacterCollisionResultsToCollisionRuntimeParams:()=>ab,convertCollisionRuntimeParamsToCharacterCollisionResults:()=>rb,convertDirectionLocalToObject:()=>bd,convertDirectionLocalToWorld:()=>_d,convertDirectionObjectToLocal:()=>Pd,convertDirectionObjectToWorld:()=>hd,convertDirectionToLocal:()=>Mu,convertDirectionToLocalMatrix:()=>Eu,convertDirectionToLocalQuat:()=>Ru,convertDirectionToWorld:()=>xu,convertDirectionToWorldMatrix:()=>Du,convertDirectionToWorldQuat:()=>Au,convertDirectionWorldToLocal:()=>fd,convertDirectionWorldToObject:()=>pd,convertPositionLocalToObject:()=>Cd,convertPositionLocalToWorld:()=>dd,convertPositionObjectToLocal:()=>Td,convertPositionObjectToWorld:()=>ud,convertPositionToLocal:()=>Pu,convertPositionToLocalMatrix:()=>bu,convertPositionToLocalQuat:()=>vu,convertPositionToWorld:()=>Tu,convertPositionToWorldMatrix:()=>Cu,convertPositionToWorldQuat:()=>Su,convertPositionWorldToLocal:()=>gd,convertPositionWorldToObject:()=>cd,convertTransformLocalToObject:()=>Fd,convertTransformLocalToObjectMatrix:()=>wd,convertTransformLocalToObjectQuat:()=>jd,convertTransformLocalToWorld:()=>Ad,convertTransformLocalToWorldMatrix:()=>Rd,convertTransformLocalToWorldQuat:()=>Vd,convertTransformObjectToLocal:()=>Ld,convertTransformObjectToLocalMatrix:()=>Hd,convertTransformObjectToLocalQuat:()=>kd,convertTransformObjectToWorld:()=>Sd,convertTransformObjectToWorldMatrix:()=>vd,convertTransformObjectToWorldQuat:()=>xd,convertTransformWorldToLocal:()=>Od,convertTransformWorldToLocalMatrix:()=>Id,convertTransformWorldToLocalQuat:()=>Bd,convertTransformWorldToObject:()=>Md,convertTransformWorldToObjectMatrix:()=>Dd,convertTransformWorldToObjectQuat:()=>Ed,copyComponentAlongAxis:()=>lu,copyObjectProperties:()=>nT,createPlane:()=>dT,createSimplified:()=>yb,createTeleportColliderSetupFromMovementColliderSetup:()=>ub,cross:()=>Ny,debug:()=>NP,degreesAddRotation:()=>Vu,degreesAddRotationDegrees:()=>Ou,degreesAddRotationQuat:()=>Bu,degreesAddRotationRadians:()=>Iu,degreesToMatrix:()=>wu,degreesToQuat:()=>ou,destroy:()=>J_,distance:()=>Hy,distanceSquared:()=>ky,div:()=>jy,doesObjectPropertyUseAccessors:()=>sT,dot:()=>zy,exitSession:()=>cP,exportVariables:()=>kb,find:()=>ly,findAll:()=>yy,findAllEqual:()=>cy,findAllIndexes:()=>uy,findAllIndexesEqual:()=>dy,findEqual:()=>hy,findIndex:()=>my,findIndexEqual:()=>py,first:()=>sy,floor:()=>Uf,fromAxis:()=>$u,fromAxisDegrees:()=>eh,fromAxisRadians:()=>th,fromDegrees:()=>nh,fromMatrix:()=>My,fromQuat:()=>Oy,fromRadians:()=>ih,fromTwistSwing:()=>_h,generate360TeleportParamsFromMovementParams:()=>ZC,getAngle:()=>qu,getAngleDegrees:()=>Xu,getAngleRadians:()=>Ku,getAssert:()=>JP,getAudioManager:()=>fm,getAxesLocal:()=>Nh,getAxesWorld:()=>Gh,getAxis:()=>Qu,getAxisScaled:()=>Ju,getAxisScaledDegrees:()=>Zu,getAxisScaledRadians:()=>Yu,getBackwardLocal:()=>qh,getBackwardWorld:()=>Qh,getBody:()=>Sm,getCanvas:()=>Rg,getCharacterCollisionSystem:()=>zg,getChildren:()=>G_,getClassFromType:()=>DT,getClear:()=>ZP,getCloneCallback:()=>zT,getClonePostProcessCallback:()=>WT,getCollisionCheck:()=>YC,getComponentBreadth:()=>gg,getComponentChildren:()=>Kd,getComponentDepth:()=>fg,getComponentDescendants:()=>Qd,getComponentDescendantsBreadth:()=>qd,getComponentDescendantsDepth:()=>Xd,getComponentHierarchy:()=>Nd,getComponentHierarchyBreadth:()=>Ud,getComponentHierarchyDepth:()=>Wd,getComponentObjects:()=>ag,getComponentSelf:()=>Gd,getComponentsAmountMapChildren:()=>sg,getComponentsAmountMapDescendants:()=>og,getComponentsAmountMapHierarchy:()=>ng,getComponentsAmountMapSelf:()=>ig,getComponentsBreadth:()=>Tg,getComponentsChildren:()=>n_,getComponentsDepth:()=>Pg,getComponentsDescendants:()=>e_,getComponentsDescendantsBreadth:()=>t_,getComponentsDescendantsDepth:()=>i_,getComponentsHierarchy:()=>Zd,getComponentsHierarchyBreadth:()=>Yd,getComponentsHierarchyDepth:()=>$d,getComponentsObjects:()=>rg,getComponentsSelf:()=>Jd,getConsoleVR:()=>Tf,getDebug:()=>KP,getDebugManager:()=>pl,getDebugVisualManager:()=>Hg,getDefaultMaterials:()=>Lf,getDefaultMeshes:()=>Bf,getDefaultResources:()=>dr,getDefaultWLComponentCloneCallback:()=>qT,getDescendants:()=>w_,getDescendantsBreadth:()=>j_,getDescendantsDepth:()=>z_,getDocument:()=>tl,getDownLocal:()=>Zh,getDownWorld:()=>Jh,getDummyServer:()=>zC,getEasyTuneTarget:()=>Df,getEasyTuneVariables:()=>Sf,getEngine:()=>Q_,getEngines:()=>Eg,getError:()=>QP,getForwardLocal:()=>Wh,getForwardWorld:()=>Uh,getFrame:()=>yP,getGamepad:()=>Zg,getGamepads:()=>Yg,getGamepadsManager:()=>Jg,getHandPose:()=>nf,getHandPoses:()=>of,getHandednessByIndex:()=>vP,getHeadPose:()=>tf,getHierarchy:()=>H_,getHierarchyBreadth:()=>k_,getHierarchyDepth:()=>F_,getID:()=>q_,getInfo:()=>XP,getInputManager:()=>qe,getInputSource:()=>xP,getInputSourceType:()=>DP,getInputSourceTypeByHandedness:()=>MP,getJavascriptComponentClass:()=>RT,getJavascriptComponentClassesByIndex:()=>VT,getJavascriptComponentInstances:()=>AT,getJavascriptComponentTypeFromIndex:()=>BT,getJavascriptComponentTypeIndex:()=>OT,getJavascriptComponentTypeIndexes:()=>IT,getJointIDByIndex:()=>AP,getKeyboard:()=>Kg,getLayerFlagsNames:()=>HP,getLeaderboard:()=>UC,getLeaderboardDummy:()=>WC,getLeftGamepad:()=>$g,getLeftHandPose:()=>sf,getLeftLocal:()=>$h,getLeftTrackedHandPose:()=>mf,getLeftWorld:()=>Yh,getLog:()=>WP,getMainEngine:()=>Gt,getMouse:()=>Xg,getName:()=>U_,getNavigator:()=>bm,getObjectByIDBreadth:()=>xg,getObjectByIDChildren:()=>L_,getObjectByIDDepth:()=>Mg,getObjectByIDDescendants:()=>O_,getObjectByIDDescendantsBreadth:()=>I_,getObjectByIDDescendantsDepth:()=>B_,getObjectByIDHierarchy:()=>A_,getObjectByIDHierarchyBreadth:()=>R_,getObjectByIDHierarchyDepth:()=>V_,getObjectByIDObjects:()=>ug,getObjectByNameBreadth:()=>Cg,getObjectByNameChildren:()=>C_,getObjectByNameDepth:()=>bg,getObjectByNameDescendants:()=>f_,getObjectByNameDescendantsBreadth:()=>T_,getObjectByNameDescendantsDepth:()=>P_,getObjectByNameHierarchy:()=>d_,getObjectByNameHierarchyBreadth:()=>__,getObjectByNameHierarchyDepth:()=>g_,getObjectByNameObjects:()=>mg,getObjectFromPath:()=>$f,getObjectNameFromPath:()=>eT,getObjectParentFromPath:()=>tT,getObjectPoolManager:()=>vm,getObjectProperty:()=>Kf,getObjectPropertyDescriptor:()=>Xf,getObjectPropertyNames:()=>qf,getObjectPropertyOwnParent:()=>Zf,getObjectPropertyOwnParents:()=>Yf,getObjectPrototypes:()=>Qf,getObjects:()=>pg,getObjectsBreadth:()=>dg,getObjectsByIDObjects:()=>hg,getObjectsByNameBreadth:()=>Sg,getObjectsByNameChildren:()=>E_,getObjectsByNameDepth:()=>vg,getObjectsByNameDescendants:()=>x_,getObjectsByNameDescendantsBreadth:()=>M_,getObjectsByNameDescendantsDepth:()=>D_,getObjectsByNameHierarchy:()=>b_,getObjectsByNameHierarchyBreadth:()=>S_,getObjectsByNameHierarchyDepth:()=>v_,getObjectsByNameObjects:()=>yg,getObjectsDepth:()=>_g,getOppositeHandedness:()=>EP,getParent:()=>yd,getPhysics:()=>Ag,getPlayerObjects:()=>wf,getPositionLocal:()=>Th,getPositionWorld:()=>fh,getReferenceSpace:()=>lP,getReferenceSpaceType:()=>mP,getRightGamepad:()=>ef,getRightHandPose:()=>af,getRightLocal:()=>tc,getRightTrackedHandPose:()=>yf,getRightWorld:()=>ec,getRotationLocal:()=>Mh,getRotationLocalDegrees:()=>Dh,getRotationLocalMatrix:()=>Ah,getRotationLocalQuat:()=>Rh,getRotationLocalRadians:()=>Eh,getRotationMatrix:()=>Ph,getRotationWorld:()=>Ch,getRotationWorldDegrees:()=>bh,getRotationWorldMatrix:()=>vh,getRotationWorldQuat:()=>xh,getRotationWorldRadians:()=>Sh,getSDK:()=>NC,getScaleLocal:()=>Oh,getScaleWorld:()=>Vh,getScene:()=>hl,getSceneObjects:()=>bl,getSelf:()=>N_,getSession:()=>aP,getSessionMode:()=>rP,getSimultaneousPressMaxDelay:()=>db,getSimultaneousTouchMaxDelay:()=>_b,getSwing:()=>ch,getSwingFromTwist:()=>ph,getTrackedHandPose:()=>rf,getTrackedHandPoses:()=>lf,getTransform:()=>Ih,getTransformLocal:()=>wh,getTransformLocalMatrix:()=>jh,getTransformLocalQuat:()=>zh,getTransformMatrix:()=>Bh,getTransformQuat:()=>Lh,getTransformWorld:()=>Hh,getTransformWorldMatrix:()=>kh,getTransformWorldQuat:()=>Fh,getTwist:()=>hh,getTwistFromSwing:()=>dh,getTypeFromTypeOrClass:()=>MT,getUpLocal:()=>Kh,getUpWorld:()=>Xh,getUser:()=>XC,getUserDummy:()=>KC,getVisualManager:()=>Om,getVisualResources:()=>Em,getWASM:()=>Vg,getWLJavascriptComponentTypes:()=>xT,getWLNativeComponentTypes:()=>vT,getWarn:()=>qP,getWindow:()=>$a,getXR:()=>Og,hasAudioManager:()=>Cm,hasCharacterCollisionSystem:()=>Ug,hasCloneCallback:()=>GT,hasClonePostProcess:()=>HT,hasClonePostProcessCallback:()=>QT,hasConsoleVR:()=>bf,hasDebugEnabled:()=>jg,hasDebugManager:()=>Lg,hasDefaultResources:()=>If,hasDefaultWLComponentCloneCallback:()=>XT,hasEasyTuneTarget:()=>Rf,hasEasyTuneVariables:()=>Mf,hasEngine:()=>ul,hasEqual:()=>ry,hasInputManager:()=>qg,hasObjectPoolManager:()=>Dm,hasPoseForwardFixed:()=>pf,hasSceneObjects:()=>Ff,hasToolEnabled:()=>ff,hasUniformScaleLocal:()=>p_,hasUniformScaleWorld:()=>c_,hasVisualManager:()=>Lm,hasVisualResources:()=>Vm,hsvCodeToHuman:()=>hC,hsvHumanToCode:()=>cC,hsvToRGB:()=>mC,importVariables:()=>Hb,info:()=>GP,initArrayExtension:()=>xl,initArrayExtensionProtoype:()=>cT,initBridge:()=>eb,initComponentMods:()=>zl,initCursorComponentMod:()=>Fl,initCursorComponentModPrototype:()=>RP,initCursorTargetComponentMod:()=>wl,initCursorTargetComponentModPrototype:()=>VP,initEngine:()=>Dg,initJSExtensions:()=>Ol,initJSPlugins:()=>Il,initMathExtension:()=>Rl,initMathExtensionStatic:()=>ZT,initMouseLookComponentMod:()=>jl,initMouseLookComponentModPrototype:()=>OP,initNumberExtension:()=>Vl,initNumberExtensionPrototype:()=>YT,initObjectExtension:()=>Bl,initObjectExtensionProtoype:()=>$T,initPP:()=>Ql,initPlugins:()=>Ul,initSceneExtension:()=>Ll,initSceneExtensionPrototype:()=>eP,initWLExtensions:()=>Hl,initWLMods:()=>Gl,initWLPlugins:()=>Nl,injectProperties:()=>hT,isARSupported:()=>bP,isAnalyticsEnabled:()=>vC,isAnyButtonPressEnd:()=>qR,isAnyButtonPressStart:()=>gb,isAnyButtonTouchEnd:()=>bb,isAnyButtonTouchStart:()=>Pb,isClass:()=>yT,isClassByName:()=>rT,isConcordant:()=>mu,isDataLogEnabled:()=>DC,isDebugEnabled:()=>kg,isDesktop:()=>iP,isDeviceEmulated:()=>SP,isErrorsLogEnabled:()=>VC,isEventsLogEnabled:()=>AC,isFartherAlongAxis:()=>yu,isFunction:()=>mT,isFunctionByName:()=>aT,isInsideAngleRange:()=>iy,isInsideAngleRangeDegrees:()=>ny,isInsideAngleRangeRadians:()=>oy,isLocalhost:()=>nP,isMobile:()=>tP,isObject:()=>uT,isObjectByName:()=>lT,isOnAxis:()=>gu,isOnPlane:()=>fu,isPlaybackBlocked:()=>eC,isPoseForwardFixed:()=>uf,isReferenceSpaceFloorBased:()=>hP,isRegistered:()=>ET,isSDKAvailable:()=>GC,isSessionActive:()=>uP,isToTheRight:()=>uu,isToolEnabled:()=>df,isTransformChanged:()=>K_,isUseDummyServerOnError:()=>jC,isUseDummyServerOnSDKMissing:()=>wC,isVRSupported:()=>CP,isWLComponent:()=>CT,isWLJavascriptComponent:()=>ST,isWLNativeComponent:()=>bT,isWLNativeComponentRegistered:()=>LT,isXRSupported:()=>PP,last:()=>ay,lengthSigned:()=>qy,load:()=>oC,loadBool:()=>rC,loadNumber:()=>aC,loadString:()=>sC,lookAt:()=>nd,lookAtLocal:()=>sd,lookAtWorld:()=>od,lookTo:()=>ad,lookToLocal:()=>ld,lookToWorld:()=>rd,makeDoubleSided:()=>pT,mapToRange:()=>jm,markDirty:()=>X_,mat3_create:()=>cE,mat4_create:()=>be,negate:()=>Gy,openLink:()=>oP,openLinkOnClick:()=>sP,overwriteObjectProperty:()=>iT,perpendicularRandom:()=>Wu,projectOnAxis:()=>cu,projectOnAxisAlongAxis:()=>pu,projectOnPlane:()=>du,projectOnPlaneAlongAxis:()=>_u,pushUnique:()=>Cy,quat2_create:()=>G,quat_create:()=>w,radiansAddRotation:()=>Lu,radiansAddRotationDegrees:()=>Hu,radiansAddRotationQuat:()=>Fu,radiansAddRotationRadians:()=>ku,radiansToMatrix:()=>ju,radiansToQuat:()=>nu,random:()=>zm,randomBool:()=>Nm,randomInt:()=>Gm,randomPick:()=>Wm,randomSign:()=>Um,randomUUID:()=>Qm,raycast:()=>kP,refreshWidget:()=>Lb,registerPPComponents:()=>Wl,registerSessionEndEventListener:()=>_P,registerSessionStartEndEventListeners:()=>fP,registerSessionStartEventListener:()=>pP,registerWLComponents:()=>$r,removeAll:()=>fy,removeAllEqual:()=>Py,removeAllIndexes:()=>gy,removeAudioManager:()=>Pm,removeCharacterCollisionSystem:()=>Ng,removeCloneCallback:()=>jT,removeClonePostProcessCallback:()=>UT,removeComponentAlongAxis:()=>ru,removeConsoleVR:()=>Cf,removeDebugEnabled:()=>wg,removeDebugManager:()=>Bg,removeDefaultResources:()=>Of,removeDefaultWLComponentCloneCallbacks:()=>JT,removeEasyTuneTarget:()=>Af,removeEasyTuneVariables:()=>xf,removeEngine:()=>yl,removeEqual:()=>Ty,removeIndex:()=>_y,removeInputManager:()=>Qg,removeMainEngine:()=>ll,removeObjectPoolManager:()=>Mm,removePoseForwardFixed:()=>cf,removeRefreshWidgetCallback:()=>zb,removeSceneObjects:()=>kf,removeSetWidgetCurrentVariableCallback:()=>wb,removeToolEnabled:()=>gf,removeVisualManager:()=>Bm,removeVisualResources:()=>Rm,reserveObjects:()=>Z_,reserveObjectsChildren:()=>tg,reserveObjectsDescendants:()=>eg,reserveObjectsHierarchy:()=>$_,reserveObjectsSelf:()=>Y_,resetPosition:()=>jc,resetPositionLocal:()=>Gc,resetPositionWorld:()=>zc,resetRotation:()=>Nc,resetRotationLocal:()=>Wc,resetRotationWorld:()=>Uc,resetScale:()=>Qc,resetScaleLocal:()=>Xc,resetScaleWorld:()=>qc,resetTransform:()=>Kc,resetTransformLocal:()=>Zc,resetTransformWorld:()=>Jc,rgbCodeToHuman:()=>yC,rgbHumanToCode:()=>uC,rgbToHSV:()=>lC,rotateAroundAxisLocal:()=>Jp,rotateAroundAxisLocalDegrees:()=>Zp,rotateAroundAxisLocalRadians:()=>Yp,rotateAroundAxisObject:()=>$p,rotateAroundAxisObjectDegrees:()=>ed,rotateAroundAxisObjectRadians:()=>td,rotateAroundAxisWorld:()=>qp,rotateAroundAxisWorldDegrees:()=>Xp,rotateAroundAxisWorldRadians:()=>Kp,rotateAroundLocal:()=>kp,rotateAroundLocalDegrees:()=>Fp,rotateAroundLocalMatrix:()=>jp,rotateAroundLocalQuat:()=>zp,rotateAroundLocalRadians:()=>wp,rotateAroundMatrix:()=>Vp,rotateAroundObject:()=>Gp,rotateAroundObjectDegrees:()=>Np,rotateAroundObjectMatrix:()=>Wp,rotateAroundObjectQuat:()=>Qp,rotateAroundObjectRadians:()=>Up,rotateAroundWorld:()=>Op,rotateAroundWorldDegrees:()=>Ip,rotateAroundWorldMatrix:()=>Lp,rotateAroundWorldQuat:()=>Hp,rotateAroundWorldRadians:()=>Bp,rotateAxisLocal:()=>xp,rotateAxisLocalDegrees:()=>Mp,rotateAxisLocalRadians:()=>Dp,rotateAxisObject:()=>Ep,rotateAxisObjectDegrees:()=>Ap,rotateAxisObjectRadians:()=>Rp,rotateAxisWorld:()=>bp,rotateAxisWorldDegrees:()=>Sp,rotateAxisWorldRadians:()=>vp,rotateLocal:()=>hp,rotateLocalDegrees:()=>cp,rotateLocalMatrix:()=>dp,rotateLocalQuat:()=>_p,rotateLocalRadians:()=>pp,rotateMatrix:()=>ap,rotateObject:()=>gp,rotateObjectDegrees:()=>fp,rotateObjectMatrix:()=>Pp,rotateObjectQuat:()=>Cp,rotateObjectRadians:()=>Tp,rotateWorld:()=>rp,rotateWorldDegrees:()=>lp,rotateWorldMatrix:()=>yp,rotateWorldQuat:()=>up,rotateWorldRadians:()=>mp,rotationAroundAxis:()=>lh,rotationAroundAxisDegrees:()=>mh,rotationAroundAxisQuat:()=>uh,rotationAroundAxisRadians:()=>yh,rotationToPivoted:()=>zu,rotationToPivotedDegrees:()=>Gu,rotationToPivotedQuat:()=>Uu,rotationToPivotedRadians:()=>Nu,round:()=>Nf,roundDecimal:()=>wm,save:()=>nC,scaleObject:()=>id,sendData:()=>OC,sendEvent:()=>IC,setActive:()=>o_,setActiveChildren:()=>h_,setActiveDescendants:()=>m_,setActiveDescendantsBreadth:()=>y_,setActiveDescendantsDepth:()=>u_,setActiveHierarchy:()=>a_,setActiveHierarchyBreadth:()=>r_,setActiveHierarchyDepth:()=>l_,setActiveObjects:()=>lg,setActiveSelf:()=>s_,setAlpha:()=>_C,setAnalyticsEnabled:()=>SC,setAudioManager:()=>Tm,setAxesLocal:()=>fc,setAxesWorld:()=>gc,setBackwardLocal:()=>bc,setBackwardWorld:()=>Cc,setCharacterCollisionSystem:()=>Gg,setCloneCallback:()=>wT,setClonePostProcessCallback:()=>NT,setClonedMaterials:()=>bC,setCollisionCheck:()=>$C,setConsoleVR:()=>Pf,setDataLogEnabled:()=>MC,setDebugEnabled:()=>Fg,setDebugManager:()=>Ig,setDefaultResources:()=>Vf,setDefaultWLComponentCloneCallbacks:()=>KT,setDownLocal:()=>Mc,setDownWorld:()=>xc,setDummyServer:()=>FC,setEasyTuneTarget:()=>Ef,setEasyTuneVariables:()=>vf,setErrorsLogEnabled:()=>RC,setEventsLogEnabled:()=>EC,setForwardLocal:()=>Pc,setForwardWorld:()=>Tc,setInputManager:()=>Wg,setLayerFlagsNames:()=>LP,setLeftLocal:()=>Ec,setLeftWorld:()=>Dc,setMainEngine:()=>rl,setName:()=>W_,setObjectAlpha:()=>gC,setObjectClonedMaterials:()=>TC,setObjectFogColor:()=>CC,setObjectMaterial:()=>fC,setObjectPoolManager:()=>xm,setObjectProperty:()=>Jf,setObjectSpecularColor:()=>PC,setParent:()=>md,setPoseForwardFixed:()=>hf,setPositionLocal:()=>nc,setPositionRotationDegreesScale:()=>Ay,setPositionRotationQuatScale:()=>Vy,setPositionRotationRadiansScale:()=>Ry,setPositionRotationScale:()=>Ey,setPositionWorld:()=>ic,setRightLocal:()=>Rc,setRightWorld:()=>Ac,setRotationLocal:()=>yc,setRotationLocalDegrees:()=>uc,setRotationLocalMatrix:()=>cc,setRotationLocalQuat:()=>pc,setRotationLocalRadians:()=>hc,setRotationMatrix:()=>oc,setRotationWorld:()=>sc,setRotationWorldDegrees:()=>ac,setRotationWorldMatrix:()=>lc,setRotationWorldQuat:()=>mc,setRotationWorldRadians:()=>rc,setScaleLocal:()=>_c,setScaleWorld:()=>dc,setSceneObjects:()=>Hf,setSendAnalyticsCallback:()=>xC,setSimultaneousPressMaxDelay:()=>cb,setSimultaneousTouchMaxDelay:()=>pb,setToolEnabled:()=>_f,setTransform:()=>Vc,setTransformLocal:()=>kc,setTransformLocalMatrix:()=>Fc,setTransformLocalQuat:()=>wc,setTransformMatrix:()=>Oc,setTransformQuat:()=>Ic,setTransformWorld:()=>Bc,setTransformWorldMatrix:()=>Lc,setTransformWorldQuat:()=>Hc,setUpLocal:()=>vc,setUpWorld:()=>Sc,setUseDummyServerOnError:()=>kC,setUseDummyServerOnSDKMissing:()=>HC,setVisualManager:()=>Im,setVisualResources:()=>Am,setWidgetCurrentVariable:()=>Bb,sign:()=>Fm,signTo:()=>hu,sub:()=>wy,subRotation:()=>oh,subRotationDegrees:()=>sh,subRotationQuat:()=>rh,subRotationRadians:()=>ah,submitScore:()=>QC,submitScoreDummy:()=>qC,transformMat3:()=>Wy,transformMat4:()=>Qy,transformQuat:()=>Uy,translate:()=>Yc,translateAxis:()=>ip,translateAxisLocal:()=>op,translateAxisObject:()=>sp,translateAxisWorld:()=>np,translateLocal:()=>ep,translateObject:()=>tp,translateWorld:()=>$c,unregisterSessionEndEventListener:()=>gP,unregisterSessionStartEndEventListeners:()=>TP,unregisterSessionStartEventListener:()=>dP,unshiftUnique:()=>by,updateCeilingInfo:()=>sb,updateGroundInfo:()=>ob,valueAlongAxis:()=>au,vec2_create:()=>Ce,vec3_create:()=>p,vec4_create:()=>F,wrapObject:()=>cg});import{ARCamera8thwall as Kb,Cursor as Jb,CursorTarget as Zb,DebugObject as Yb,DeviceOrientationLook as $b,FingerCursor as eS,FixedFoveation as tS,HandTracking as iS,HitTestLocation as nS,HowlerAudioListener as oS,HowlerAudioSource as sS,ImageTexture as aS,MouseLookComponent as rS,PlayerHeight as lS,TargetFramerate as mS,TeleportComponent as yS,Trail as uS,TwoJointIkSolver as hS,VideoTexture as cS,VrModeActiveSwitch as pS,Vrm as dS,WasdControlsComponent as _S}from"@wonderlandengine/components";function $r(i){i.registerComponent(Kb,Jb,Zb,Yb,$b,eS,tS,iS,nS,oS,sS,aS,rS,lS,mS,yS,uS,hS,cS,pS,dS,_S)}import{AnimationComponent as Ml,CollisionComponent as Cr,InputComponent as Dl,LightComponent as El,MeshComponent as br,PhysXComponent as Sr,TextComponent as vr,ViewComponent as Al}from"@wonderlandengine/api";import{ARCamera8thwall as fE,Anchor as TE,Cursor as PE,CursorTarget as CE,DebugObject as bE,DeviceOrientationLook as SE,FingerCursor as vE,FixedFoveation as xE,HandTracking as ME,HitTestLocation as DE,HowlerAudioListener as EE,HowlerAudioSource as AE,ImageTexture as RE,MouseLookComponent as VE,PlaneDetection as OE,PlayerHeight as IE,TargetFramerate as BE,TeleportComponent as LE,Trail as HE,TwoJointIkSolver as kE,VideoTexture as FE,VrModeActiveSwitch as wE,Vrm as jE,WasdControlsComponent as zE}from"@wonderlandengine/components";var el={};dt(el,{getAudioManager:()=>fm,hasAudioManager:()=>Cm,removeAudioManager:()=>Pm,setAudioManager:()=>Tm});var Ya=new WeakMap;function fm(i=m.getMainEngine()){return Ya.get(i)}function Tm(i,e=m.getMainEngine()){Ya.set(e,i)}function Pm(i=m.getMainEngine()){Ya.delete(i)}function Cm(i=m.getMainEngine()){return Ya.has(i)}var il={};dt(il,{getBody:()=>Sm,getDocument:()=>tl,getNavigator:()=>bm,getWindow:()=>$a});function $a(i=m.getMainEngine()){return window}function bm(i=m.getMainEngine()){return $a(i).navigator}function tl(i=m.getMainEngine()){return $a(i).document}function Sm(i=m.getMainEngine()){return tl(i).body}var nl={};dt(nl,{getObjectPoolManager:()=>vm,hasObjectPoolManager:()=>Dm,removeObjectPoolManager:()=>Mm,setObjectPoolManager:()=>xm});var er=new WeakMap;function vm(i=m.getMainEngine()){return er.get(i)}function xm(i,e=m.getMainEngine()){er.set(e,i)}function Mm(i=m.getMainEngine()){er.delete(i)}function Dm(i=m.getMainEngine()){return er.has(i)}var ol={};dt(ol,{getVisualManager:()=>Om,getVisualResources:()=>Em,hasVisualManager:()=>Lm,hasVisualResources:()=>Vm,removeVisualManager:()=>Bm,removeVisualResources:()=>Rm,setVisualManager:()=>Im,setVisualResources:()=>Am});var tr=new WeakMap,ir=new WeakMap;function Em(i=m.getMainEngineinEngine()){return tr.get(i)}function Am(i,e=m.getMainEngine()){tr.set(e,i)}function Rm(i=m.getMainEngine()){tr.delete(i)}function Vm(i=m.getMainEngine()){return tr.has(i)}function Om(i=m.getMainEngine()){return ir.get(i)}function Im(i,e=m.getMainEngine()){ir.set(e,i)}function Bm(i=m.getMainEngine()){ir.delete(i)}function Lm(i=m.getMainEngine()){return ir.has(i)}var cl={};dt(cl,{addEngine:()=>ml,getCanvas:()=>Rg,getEngines:()=>Eg,getMainEngine:()=>Gt,getPhysics:()=>Ag,getRoot:()=>XD,getScene:()=>hl,getWASM:()=>Vg,getXR:()=>Og,hasEngine:()=>ul,initEngine:()=>Dg,removeEngine:()=>yl,removeMainEngine:()=>ll,setMainEngine:()=>rl});var ue={linear:i=>i,easeInVeryWeak:i=>1-Math.cos(i*Math.PI/2),easeInWeak:i=>Math.pow(i,2),easeIn:i=>Math.pow(i,3),easeInStrong:i=>Math.pow(i,4),easeInVeryStrong:i=>Math.pow(i,5),easeOutVeryWeak:i=>Math.sin(i*Math.PI/2),easeOutWeak:i=>1-Math.pow(1-i,2),easeOut:i=>1-Math.pow(1-i,3),easeOutStrong:i=>1-Math.pow(1-i,4),easeOutVeryStrong:i=>1-Math.pow(1-i,5),easeInOutVeryWeak:i=>-(Math.cos(i*Math.PI)-1)/2,easeInOutWeak:i=>i<.5?2*Math.pow(i,2):1-Math.pow(-2*i+2,2)/2,easeInOut:i=>i<.5?4*Math.pow(i,3):1-Math.pow(-2*i+2,3)/2,easeInOutStrong:i=>i<.5?8*Math.pow(i,4):1-Math.pow(-2*i+2,4)/2,easeInOutVeryStrong:i=>i<.5?16*Math.pow(i,5):1-Math.pow(-2*i+2,5)/2},nr=1e-6,Hm=nr*nr,km=1e-5;function gS(i,e,t){let n=e??-Number.MAX_VALUE,o=t??Number.MAX_VALUE,s=Math.min(n,o),a=Math.max(n,o);return Math.min(Math.max(i,s),a)}function Fm(i,e=1){let t=Math.sign(i);return t==0&&(t=Math.sign(e)),t}function fS(i){return i*(180/Math.PI)}function TS(i){return i*(Math.PI/180)}function wm(i,e){let t=Math.pow(10,e);return i=Math.round(i*t)/t,i}function jm(i,e,t,n,o){if(e==t)return n;let s=B.clamp(i,e,t);if(s==e)return n;if(s==t)return o;let a=n+(o-n)/(t-e)*(s-e);return B.clamp(a,n,o)}function zm(i=0,e=1){return Math.random()*(e-i)+i}function Gm(i,e){let t=Math.min(i,e),n=Math.max(i,e);return Math.floor(Math.random()*(n-t+1)+t)}function Nm(){return B.randomInt(0,1)==0}function Um(){return Math.random()<.5?1:-1}function Wm(...i){let e=null;if(i.length>0)if(i.length==1&&i[0].length!=null){if(i[0].length>0){let t=B.randomInt(0,i[0].length-1);e=i[0][t]}}else{let t=B.randomInt(0,i.length-1);e=i[t]}return e}var Qm=function(){let i=new Uint8Array(1),e="10000000-1000-4000-8000-"+1e11,t=new RegExp("[018]","g"),n=o=>((o^crypto.getRandomValues(i)[0]&15)>>o/4).toString(16);return function(){let s="";return crypto.randomUUID!=null?s=crypto.randomUUID():s=e.replace(t,n),s}}();function PS(i,e,t){return t<=0?i:t>=1?e:t*(e-i)+i}function CS(i,e,t,n=ue.linear){let o=n(t);return B.lerp(i,e,o)}function qm(i,e){return B.angleDistanceDegrees(i,e)}function Xm(i,e){return Math.abs(B.angleDistanceSignedDegrees(i,e))}function Km(i,e){return Math.abs(B.angleDistanceSignedRadians(i,e))}function Jm(i,e){return B.angleDistanceSignedDegrees(i,e)}function Zm(i,e){let t=B.angleClampDegrees(i,!0),n=B.angleClampDegrees(e,!0),o=n-t;return n-t>180?o=n-t-360:n-t<-180&&(o=n-t+360),o}function Ym(i,e){return B.toRadians(B.angleDistanceSignedDegrees(B.toDegrees(i),B.toDegrees(e)))}function $m(i,e=!1){return B.angleClampDegrees(i,e)}function ey(i,e=!1){let t=i%360;return t<0&&(t+=360),e||t>180&&(t-=360),t}function ty(i,e=!1){return B.toRadians(B.angleClampDegrees(B.toDegrees(i),e))}function iy(i,e,t,n=!1){return B.isInsideAngleRangeDegrees(i,e,t,n)}function ny(i,e,t,n=!1){let o=!1,s=B.angleClampDegrees(i,!0),a=B.angleClampDegrees(e,!0),l=B.angleClampDegrees(t,!0);if(n&&B.angleDistanceSignedDegrees(a,l)<0){let h=a;a=l,l=h}return a<l?o=s>=a&&s<=l:o=s>=a||s<=l,o}function oy(i,e,t,n=!1){return B.isInsideAngleRangeDegrees(B.toDegrees(i),B.toDegrees(e),B.toDegrees(t),n)}var B={EPSILON:nr,EPSILON_SQUARED:Hm,EPSILON_DEGREES:km,clamp:gS,sign:Fm,toDegrees:fS,toRadians:TS,roundDecimal:wm,mapToRange:jm,random:zm,randomInt:Gm,randomBool:Nm,randomSign:Um,randomPick:Wm,randomUUID:Qm,lerp:PS,interpolate:CS,angleDistance:qm,angleDistanceDegrees:Xm,angleDistanceRadians:Km,angleDistanceSigned:Jm,angleDistanceSignedDegrees:Zm,angleDistanceSignedRadians:Ym,angleClamp:$m,angleClampDegrees:ey,angleClampRadians:ty,isInsideAngleRange:iy,isInsideAngleRangeDegrees:ny,isInsideAngleRangeRadians:oy};import{mat3 as sl,quat as OM}from"gl-matrix";import{mat3 as Lx,quat as Je}from"gl-matrix";function sy(i){return i.length>0?i[0]:void 0}function ay(i){return i.length>0?i[i.length-1]:void 0}function bS(i,e){return X.find(i,e)!=null}function ry(i,e,t=null){return X.findEqual(i,e,t)!=null}function ly(i,e){let t,n=i.findIndex(e);return n>=0&&(t=i[n]),t}function my(i,e){return i.findIndex(e)}function yy(i,e){return i.filter(e)}function uy(i,e){let t=[];for(let n=0;n<i.length;n++){let o=i[n];e(o)&&t.push(n)}return t}function hy(i,e,t=null){if(t==null){let o=X.findIndexEqual(i,e);return o<0?void 0:i[o]}let n;for(let o=0;o<i.length;o++){let s=i[o];if(t(s,e)){n=s;break}}return n}function cy(i,e,t=null){if(t==null)return Sy(i,e,!1);let n=[];for(let o=0;o<i.length;o++){let s=i[o];t(s,e)&&n.push(s)}return n}function py(i,e,t=null){if(t==null)return i.indexOf(e);let n=-1;for(let o=0;o<i.length;o++){let s=i[o];if(t(s,e)){n=o;break}}return n}function dy(i,e,t=null){if(t==null)return Sy(i,e,!0);let n=[];for(let o=0;o<i.length;o++){let s=i[o];t(s,e)&&n.push(o)}return n}function _y(i,e){let t;if(e>=0&&e<i.length){let n=i.splice(e,1);n.length==1&&(t=n[0])}return t}function gy(i,e){let t=[];for(let n of e){let o=X.removeIndex(i,n);o!==void 0&&t.push(o)}return t}function SS(i,e){let t,n=i.findIndex(e);return n>=0&&(t=X.removeIndex(i,n)),t}function fy(i,e){let t=[],n;do n=X.remove(i,e),n!==void 0&&t.push(n);while(n!==void 0);return t}function Ty(i,e,t=null){return X.removeIndex(i,X.findIndexEqual(i,e,t))}function Py(i,e,t=null){return X.removeAllIndexes(i,X.findAllIndexesEqual(i,e,t))}function Cy(i,e,t=null){let n=i.length;return X.hasEqual(i,e,t)||(n=i.push(e)),n}function by(i,e,t=null){let n=i.length;return X.hasEqual(i,e,t)||(n=i.unshift(e)),n}function vS(i,e,t=null){for(;e.length>i.length;)e.pop();for(let n=0;n<i.length;n++)t==null?e[n]=i[n]:e[n]=t(e[n],i[n]);return e}function xS(i,e=null){if(e==null)return i.slice(0);let t=null;switch(i.constructor.name){case"Array":t=new Array(i.length);break;case"Uint8ClampedArray":t=new Uint8ClampedArray(i.length);break;case"Uint8Array":t=new Uint8Array(i.length);break;case"Uint16Array":t=new Uint16Array(i.length);break;case"Uint32Array":t=new Uint32Array(i.length);break;case"Int8Array":t=new Int8Array(i.length);break;case"Int16Array":t=new Int16Array(i.length);break;case"Int32Array":t=new Int32Array(i.length);break;case"Float32Array":t=new Float32Array(i.length);break;case"Float64Array":t=new Float64Array(i.length);break;default:t=new Array(i.length),console.error("Cloned array type not supported!");break}for(let n=0;n<i.length;n++)t[n]=X.cloneCallback(i[n]);return t}function MS(i,e,t=null){let n=!0;if(e!=null&&i.length==e.length){for(let o=0;o<i.length;o++)if(t!=null&&!t(i[o],e[o])||t==null&&i[o]!=e[o]){n=!1;break}}else n=!1;return n}function DS(i){return i.length=0,i}var X={first:sy,last:ay,has:bS,hasEqual:ry,find:ly,findIndex:my,findAll:yy,findAllIndexes:uy,findEqual:hy,findAllEqual:cy,findIndexEqual:py,findAllIndexesEqual:dy,removeIndex:_y,removeAllIndexes:gy,remove:SS,removeAll:fy,removeEqual:Ty,removeAllEqual:Py,pushUnique:Cy,unshiftUnique:by,copy:vS,clone:xS,equals:MS,clear:DS};function Sy(i,e,t){let n=[],o=-1;for(;(o=i.indexOf(e,o+1))>=0;)n.push(t?o:i[o]);return n}import{vec3 as Le}from"gl-matrix";import{mat4 as bt}from"gl-matrix";import{mat4 as ES,quat2 as _t}from"gl-matrix";function vy(i,e,t,n,o,s,a,l){let h=_t.create();return i!==void 0&&xy(h,i,e,t,n,o,s,a,l),h}function xy(i,e,t,n,o,s,a,l,h){return t===void 0?_t.set(i,e,e,e,e,e,e,e,e):_t.set(i,e,t,n,o,s,a,l,h),i}function AS(i,e=V.create()){return _t.normalize(e,i),e}function RS(i,e=V.create()){return _t.invert(e,i),e}function VS(i,e=V.create()){return _t.conjugate(e,i),e}function OS(i,e){return _t.copy(e,i),e}function IS(i){return _t.identity(i),i}function BS(i,e=d.create()){return _t.getTranslation(e,i),e}function LS(i,e){return V.getRotationDegrees(i,e)}var HS=function(){let i=q();return function(t,n=d.create()){return T.toDegrees(V.getRotationQuat(t,i),n),n}}(),kS=function(){let i=q();return function(t,n=d.create()){return T.toRadians(V.getRotationQuat(t,i),n),n}}();function FS(i,e=T.create()){return T.copy(i,e),e}var wS=function(){let i=q();return function(t,n){return V.getRotationQuat(t,i),V.setPositionRotationQuat(t,n,i),t}}();function jS(i,e){return V.setRotationDegrees(i,e)}var zS=function(){let i=z();return function(t,n){return V.getPosition(t,i),V.setPositionRotationDegrees(t,i,n),t}}(),GS=function(){let i=z();return function(t,n){return V.getPosition(t,i),V.setPositionRotationRadians(t,i,n),t}}(),NS=function(){let i=z();return function(t,n){return V.getPosition(t,i),V.setPositionRotationQuat(t,i,n),t}}();function US(i,e,t){return V.setPositionRotationDegrees(i,e,t)}var WS=function(){let i=q();return function(t,n,o){return d.degreesToQuat(o,i),V.setPositionRotationQuat(t,n,i),t}}(),QS=function(){let i=q();return function(t,n,o){return d.radiansToQuat(o,i),V.setPositionRotationQuat(t,n,i),t}}();function qS(i,e,t){return _t.fromRotationTranslation(i,t,e),i}function XS(i,e=B.EPSILON){return Math.abs(V.lengthSquared(i)-1)<e}function KS(i){return _t.length(i)}function JS(i){return _t.squaredLength(i)}function ZS(i,e,t=V.create()){return _t.mul(t,i,e),t}function YS(i,e=[d.create(),d.create(),d.create()]){return V.getLeft(i,e[0]),V.getUp(i,e[1]),V.getForward(i,e[2]),e}var $S=function(){let i=Et();return function(t,n=d.create()){return T.toMatrix(t,i),d.set(n,i[6],i[7],i[8]),n}}();function ev(i,e){return e=V.getForward(i,e),d.negate(e,e),e}var tv=function(){let i=Et();return function(t,n=d.create()){return T.toMatrix(t,i),d.set(n,i[0],i[1],i[2]),n}}();function iv(i,e){return e=V.getLeft(i,e),d.negate(e,e),e}var nv=function(){let i=Et();return function(t,n=d.create()){return T.toMatrix(t,i),d.set(n,i[3],i[4],i[5]),n}}();function ov(i,e){return e=V.getUp(i,e),d.negate(e,e),e}function sv(i,e,t=V.create()){return V.mul(e,i,t),t}var av=function(){let i=vy();return function(t,n,o=V.create()){return V.conjugate(n,i),V.mul(i,t,o),o}}();function rv(i,e,t,n){return V.rotateAxisDegrees(i,e,t,n)}function lv(i,e,t,n){return V.rotateAxisRadians(i,B.toRadians(e),t,n)}var mv=function(){let i=q();return function(t,n,o,s=V.create()){return V.getRotationQuat(t,i),T.rotateAxisRadians(i,n,o,i),V.copy(t,s),V.setRotationQuat(s,i),s}}();function yv(i,e=R.create()){return dv(e,i),e}function My(i,e=V.create()){return R.toQuat(i,e),e}function uv(i,e,t,n=V.create()){return t<=0?(V.copy(i,n),n):t>=1?(V.copy(e,n),n):(_t.lerp(n,i,e,t),n)}function hv(i,e,t,n=ue.linear,o=V.create()){let s=n(t);return V.lerp(i,e,s,o)}var cv=function(){let i=z(),e=z(),t=z(),n=q(),o=q(),s=q();return function(l,h,_,y=V.create()){return _<=0?(V.copy(l,y),y):_>=1?(V.copy(h,y),y):(V.getPosition(l,i),V.getPosition(h,e),V.getRotationQuat(l,n),V.getRotationQuat(h,o),d.lerp(i,e,_,t),T.slerp(n,o,_,s),V.setPositionRotationQuat(y,t,s),y)}}();function pv(i,e,t,n=ue.linear,o=V.create()){let s=n(t);return V.slerp(i,e,s,o)}var V={create:vy,set:xy,normalize:AS,invert:RS,conjugate:VS,copy:OS,identity:IS,getPosition:BS,getRotation:LS,getRotationDegrees:HS,getRotationRadians:kS,getRotationQuat:FS,setPosition:wS,setRotation:jS,setRotationDegrees:zS,setRotationRadians:GS,setRotationQuat:NS,setPositionRotation:US,setPositionRotationDegrees:WS,setPositionRotationRadians:QS,setPositionRotationQuat:qS,isNormalized:XS,length:KS,lengthSquared:JS,mul:ZS,getAxes:YS,getForward:$S,getBackward:ev,getLeft:tv,getRight:iv,getUp:nv,getDown:ov,toWorld:sv,toLocal:av,rotateAxis:rv,rotateAxisDegrees:lv,rotateAxisRadians:mv,toMatrix:yv,fromMatrix:My,lerp:uv,interpolate:hv,slerp:cv,sinterpolate:pv},dv=function(){let i=z();return function(t,n){let o=-n[0],s=-n[1],a=-n[2],l=n[3],h=n[4],_=n[5],y=n[6],r=n[7],u=o*o+s*s+a*a+l*l;return u>0?(i[0]=(h*l+r*o+_*a-y*s)*2/u,i[1]=(_*l+r*s+y*o-h*a)*2/u,i[2]=(y*l+r*a+h*s-_*o)*2/u):(i[0]=(h*l+r*o+_*a-y*s)*2,i[1]=(_*l+r*s+y*o-h*a)*2,i[2]=(y*l+r*a+h*s-_*o)*2),ES.fromRotationTranslation(t,n,i),t}}();function Ci(i,e,t,n,o,s,a,l,h,_,y,r,u,g,P,C){let f=bt.create();return i!==void 0&&Dy(f,i,e,t,n,o,s,a,l,h,_,y,r,u,g,P,C),f}function Dy(i,e,t,n,o,s,a,l,h,_,y,r,u,g,P,C,f){return t===void 0?bt.set(i,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e):bt.set(i,e,t,n,o,s,a,l,h,_,y,r,u,g,P,C,f),i}function _v(i,e){return bt.copy(e,i),e}function gv(i){return bt.identity(i),i}function fv(i,e=R.create()){return bt.invert(e,i),e}function Tv(i,e,t=R.create()){return bt.mul(t,i,e),t}function Pv(i,e,t=R.create()){return bt.scale(t,i,e),t}function Cv(i,e=R.create()){return R.copy(i,e),e}function bv(i,e=d.create()){return bt.getTranslation(e,i),e}function Sv(i,e=d.create()){return R.getRotationDegrees(i,e)}var vv=function(){let i=q();return function(t,n=d.create()){return R.getRotationQuat(t,i),T.toDegrees(i,n),n}}(),xv=function(){let i=q();return function(t,n=d.create()){return R.getRotationQuat(t,i),T.toRadians(i,n),n}}(),Mv=function(){let i=z(),e=Ci(),t=z(),n=z();return bi(n,1,1,1),function(s,a=T.create()){return R.getScale(s,i),d.div(n,i,t),R.scale(s,t,e),Kv(a,e),a}}();function Dv(i,e=d.create()){return bt.getScaling(e,i),e}function Ev(i,e){return i[12]=e[0],i[13]=e[1],i[14]=e[2],i}function Av(i,e){return R.setRotationDegrees(i,e),i}var Rv=function(){let i=q();return function(t,n){return R.setRotationQuat(t,d.degreesToQuat(n,i)),t}}(),Vv=function(){let i=z();return function(t,n){return R.setRotationDegrees(t,d.toDegrees(n,i)),t}}(),Ov=function(){let i=z(),e=z();return function(n,o){return R.getPosition(n,i),R.getScale(n,e),R.setPositionRotationQuatScale(n,i,o,e),n}}(),Iv=function(){let i=z();return function(t,n){return R.getScale(t,i),d.div(n,i,i),R.scale(t,i,t),t}}();function Ey(i,e,t,n){return R.setPositionRotationDegreesScale(i,e,t,n),i}var Ay=function(){let i=q();return function(t,n,o,s){return R.setPositionRotationQuatScale(t,n,d.degreesToQuat(o,i),s),t}}(),Ry=function(){let i=z();return function(t,n,o,s){return R.setPositionRotationDegreesScale(t,n,d.toDegrees(o,i),s),t}}();function Vy(i,e,t,n){return bt.fromRotationTranslationScale(i,t,e,n),i}function Bv(i,e,t){return R.setPositionRotationDegrees(i,e,t),i}var Lv=function(){let i=q();return function(t,n,o){return R.setPositionRotationQuat(t,n,d.degreesToQuat(o,i)),t}}(),Hv=function(){let i=z();return function(t,n,o){return R.setPositionRotationDegrees(t,n,d.toDegrees(o,i)),t}}();function kv(i,e,t){return bt.fromRotationTranslation(i,t,e),i}function Fv(i,e=[d.create(),d.create(),d.create()]){return R.getLeft(i,e[0]),R.getUp(i,e[1]),R.getForward(i,e[2]),e}function wv(i,e=d.create()){return d.set(e,i[8],i[9],i[10]),d.normalize(e,e),e}function jv(i,e){return e=R.getForward(i,e),d.negate(e,e),e}function zv(i,e=d.create()){return d.set(e,i[0],i[1],i[2]),d.normalize(e,e),e}function Gv(i,e){return e=R.getLeft(i,e),d.negate(e,e),e}function Nv(i,e=d.create()){return d.set(e,i[4],i[5],i[6]),d.normalize(e,e),e}function Uv(i,e){return e=R.getUp(i,e),d.negate(e,e),e}var Wv=function(){let i=Ci(),e=z(),t=z(),n=z(),o=z();return bi(o,1,1,1),function(a,l,h=R.create()){return R.hasUniformScale(l)?R.mul(l,a,h):(d.set(e,a[12],a[13],a[14]),d.convertPositionToWorldMatrix(e,l,e),R.getScale(l,t),d.div(o,t,n),R.scale(l,n,i),R.mul(i,a,h),R.scale(h,t,h),h[12]=e[0],h[13]=e[1],h[14]=e[2],h[15]=1),h}}(),Qv=function(){let i=Ci(),e=z(),t=z(),n=z(),o=z();return bi(o,1,1,1),function(a,l,h=R.create()){return R.hasUniformScale(l)?(R.invert(l,i),R.mul(i,a,h)):(d.set(e,a[12],a[13],a[14]),d.convertPositionToLocalMatrix(e,l,e),R.getScale(l,t),d.div(o,t,n),R.scale(l,n,i),R.invert(i,i),R.mul(i,a,h),R.scale(h,n,h),h[12]=e[0],h[13]=e[1],h[14]=e[2],h[15]=1),h}}(),qv=function(){let i=z();return function(t){return R.getScale(t,i),Math.abs(i[0]-i[1])<B.EPSILON&&Math.abs(i[1]-i[2])<B.EPSILON&&Math.abs(i[0]-i[2])<B.EPSILON}}(),Xv=function(){let i=z(),e=q();return function(n,o=V.create()){return R.getPosition(n,i),R.getRotationQuat(n,e),V.setPositionRotationQuat(o,i,e),o}}();function Oy(i,e=R.create()){return V.toMatrix(i,e),e}var R={create:Ci,set:Dy,copy:_v,identity:gv,invert:fv,mul:Tv,scale:Pv,clone:Cv,getPosition:bv,getRotation:Sv,getRotationDegrees:vv,getRotationRadians:xv,getRotationQuat:Mv,getScale:Dv,setPosition:Ev,setRotation:Av,setRotationDegrees:Rv,setRotationRadians:Vv,setRotationQuat:Ov,setScale:Iv,setPositionRotationScale:Ey,setPositionRotationDegreesScale:Ay,setPositionRotationRadiansScale:Ry,setPositionRotationQuatScale:Vy,setPositionRotation:Bv,setPositionRotationDegrees:Lv,setPositionRotationRadians:Hv,setPositionRotationQuat:kv,getAxes:Fv,getForward:wv,getBackward:jv,getLeft:zv,getRight:Gv,getUp:Nv,getDown:Uv,toWorld:Wv,toLocal:Qv,hasUniformScale:qv,toQuat:Xv,fromQuat:Oy},Kv=function(){let i=z();return function(t,n){bt.getScaling(i,n);let o=1/i[0],s=1/i[1],a=1/i[2],l=n[0]*o,h=n[1]*s,_=n[2]*a,y=n[4]*o,r=n[5]*s,u=n[6]*a,g=n[8]*o,P=n[9]*s,C=n[10]*a,f=l+r+C,S=0;return f>0?(S=Math.sqrt(f+1)*2,t[3]=.25*S,t[0]=(u-P)/S,t[1]=(g-_)/S,t[2]=(h-y)/S):l>r&&l>C?(S=Math.sqrt(1+l-r-C)*2,t[3]=(u-P)/S,t[0]=.25*S,t[1]=(h+y)/S,t[2]=(g+_)/S):r>C?(S=Math.sqrt(1+r-l-C)*2,t[3]=(g-_)/S,t[0]=(h+y)/S,t[1]=.25*S,t[2]=(u+P)/S):(S=Math.sqrt(1+C-l-r)*2,t[3]=(h-y)/S,t[0]=(g+_)/S,t[1]=(u+P)/S,t[2]=.25*S),t}}();function z(i,e,t){let n=Le.create();return i!==void 0&&bi(n,i,e,t),n}function bi(i,e,t,n){return t===void 0?Le.set(i,e,e,e):Le.set(i,e,t,n),i}function Jv(i,e=d.create()){return Le.normalize(e,i),e}function Zv(i,e){return Le.copy(e,i),e}function Yv(i,e=d.create()){return d.copy(i,e),e}function $v(i){return Le.zero(i),i}function Iy(i,e){return d.angleDegrees(i,e)}function By(i,e){return B.toDegrees(d.angleRadians(i,e))}function Ly(i,e){let t=i[0],n=i[1],o=i[2],s=e[0],a=e[1],l=e[2],h=t*t+n*n+o*o,_=s*s+a*a+l*l,y=h*_,r=0;if(y>B.EPSILON_SQUARED){let u=Math.sqrt(y),g=d.dot(i,e)/u;r=Math.acos(B.clamp(g,-1,1))}return r}function ex(i,e,t=0){let n=i.length==e.length;return n&&(n&&=Math.abs(i[0]-e[0])<=t,n&&=Math.abs(i[1]-e[1])<=t,n&&=Math.abs(i[2]-e[2])<=t),n}function tx(i){return Le.length(i)}function ix(i){return Le.squaredLength(i)}function Hy(i,e){return Le.dist(i,e)}function ky(i,e){return Le.squaredDistance(i,e)}function Fy(i,e,t=d.create()){return Le.add(t,i,e),t}function wy(i,e,t=d.create()){return Le.sub(t,i,e),t}function nx(i,e,t=d.create()){return Le.mul(t,i,e),t}function jy(i,e,t=d.create()){return Le.div(t,i,e),t}function ox(i,e,t=d.create()){return Le.scale(t,i,e),t}function zy(i,e){return Le.dot(i,e)}function Gy(i,e=d.create()){return Le.negate(e,i),e}function Ny(i,e,t=d.create()){return Le.cross(t,i,e),t}function Uy(i,e,t=d.create()){return Le.transformQuat(t,i,e),t}function Wy(i,e,t=d.create()){return Le.transformMat3(t,i,e),t}function Qy(i,e,t=d.create()){return Le.transformMat4(t,i,e),t}function qy(i,e){let t=d.length(i);return d.isConcordant(i,e)||(t*=-1),t}function Xy(i,e,t){return d.angleSignedDegrees(i,e,t)}function Ky(i,e,t){return B.toDegrees(d.angleSignedRadians(i,e,t))}var Jy=function(){let i=z();return function(t,n,o){d.cross(t,n,i);let s=d.angleRadians(t,n);return d.isConcordant(i,o)||(s=-s),s}}();function Zy(i,e,t){return d.anglePivotedDegrees(i,e,t)}function Yy(i,e,t){return B.toDegrees(d.anglePivotedRadians(i,e,t))}var $y=function(){let i=z(),e=z();return function(n,o,s){return i=d.removeComponentAlongAxis(n,s,i),e=d.removeComponentAlongAxis(o,s,e),d.angleRadians(i,e)}}();function eu(i,e,t){return d.anglePivotedSignedDegrees(i,e,t)}function tu(i,e,t){return B.toDegrees(d.anglePivotedSignedRadians(i,e,t))}var iu=function(){let i=z(),e=z();return function(n,o,s){return i=d.removeComponentAlongAxis(n,s,i),e=d.removeComponentAlongAxis(o,s,e),d.angleSignedRadians(i,e,s)}}();function sx(i,e=d.create()){return d.set(e,B.toRadians(i[0]),B.toRadians(i[1]),B.toRadians(i[2])),e}function ax(i,e=d.create()){return d.set(e,B.toDegrees(i[0]),B.toDegrees(i[1]),B.toDegrees(i[2])),e}function rx(i,e){return d.degreesToQuat(i,e)}function nu(i,e=T.create()){return T.fromRadians(i,e),e}function ou(i,e=T.create()){return T.fromDegrees(i,e),e}function lx(i,e=B.EPSILON){return Math.abs(d.lengthSquared(i)-1)<e}function mx(i,e=0){return d.lengthSquared(i)<=e*e}function su(i,e,t=d.create()){let n=d.dot(i,e);return d.copy(e,t),d.scale(t,n,t),t}function au(i,e){return d.dot(i,e)}var ru=function(){let i=z();return function(t,n,o=d.create()){return d.componentAlongAxis(t,n,i),d.sub(t,i,o),o}}(),lu=function(){let i=z();return function(t,n,o,s=d.create()){return d.removeComponentAlongAxis(n,o,s),d.componentAlongAxis(t,o,i),d.add(s,i,s),s}}();function mu(i,e){return d.dot(i,e)>=0}function yu(i,e,t){return d.valueAlongAxis(i,t)>d.valueAlongAxis(e,t)}function uu(i,e,t){return d.signTo(i,e,t)>=0}var hu=function(){let i=z(),e=z();return function(n,o,s,a=1){d.removeComponentAlongAxis(n,s,i),d.removeComponentAlongAxis(o,s,e);let l=d.angleSigned(n,o,s);return l>0?1:l==0?a:-1}}();function cu(i,e,t=d.create()){return d.componentAlongAxis(i,e,t),t}var pu=function(){let i=z(),e=z(),t=z();return function(o,s,a,l=d.create()){if(d.isOnAxis(o,s)||d.isOnAxis(a,s))d.copy(o,l);else if(d.cross(a,s,i),d.normalize(i,i),d.removeComponentAlongAxis(o,i,l),!d.isOnAxis(l,s)){d.projectOnAxis(l,s,e),d.sub(e,l,e),d.isConcordant(e,a)?d.copy(a,t):d.negate(a,t);let h=d.angleRadians(t,e),_=d.length(e)/Math.cos(h);d.scale(t,_,t),d.add(l,t,l),d.projectOnAxis(l,s,l)}return l}}();function du(i,e,t=d.create()){return d.removeComponentAlongAxis(i,e,t),t}var _u=function(){let i=z(),e=z();return function(n,o,s,a=d.create()){if(d.isOnPlane(n,o)||d.isOnPlane(s,o))d.copy(n,a);else{d.copy(n,a),d.projectOnPlane(a,o,i),d.sub(i,a,i),d.isConcordant(i,s)?d.copy(s,e):d.negate(s,e);let l=d.angleRadians(e,i),h=d.length(i)/Math.cos(l);d.scale(e,h,e),d.add(a,e,a),d.projectOnPlane(a,o,a)}return a}}();function gu(i,e){let t=d.angle(i,e);return Math.abs(t)<B.EPSILON_DEGREES||Math.abs(t-180)<B.EPSILON_DEGREES}function fu(i,e){let t=d.angle(i,e);return Math.abs(t-90)<B.EPSILON_DEGREES}function yx(i,e,t){return d.rotateDegrees(i,e,t)}var ux=function(){let i=z();return function(t,n,o){return d.rotateAroundDegrees(t,n,i,o)}}(),hx=function(){let i=z();return function(t,n,o){return d.rotateAroundRadians(t,n,i,o)}}(),cx=function(){let i=z();return function(t,n,o){return d.rotateAroundQuat(t,n,i,o)}}();function px(i,e,t,n){return d.rotateAxisDegrees(i,e,t,n)}var dx=function(){let i=z();return function(t,n,o,s){return d.rotateAroundAxisDegrees(t,n,o,i,s)}}(),_x=function(){let i=z();return function(t,n,o,s){return d.rotateAroundAxisRadians(t,n,o,i,s)}}();function gx(i,e,t,n){return d.rotateAroundDegrees(i,e,t,n)}var fx=function(){let i=q();return function(t,n,o,s=d.create()){return d.degreesToQuat(n,i),d.rotateAroundQuat(t,i,o,s)}}(),Tx=function(){let i=q();return function(t,n,o,s=d.create()){return d.radiansToQuat(n,i),d.rotateAroundQuat(t,i,o,s)}}();function Px(i,e,t,n=d.create()){return d.sub(i,t,n),d.transformQuat(n,e,n),d.add(n,t,n),n}function Cx(i,e,t,n,o){return d.rotateAroundAxisDegrees(i,e,t,n,o)}function bx(i,e,t,n,o){return d.rotateAroundAxisRadians(i,B.toRadians(e),t,n,o)}var Sx=function(){let i=q();return function(t,n,o,s,a=d.create()){return T.fromAxisRadians(n,o,i),d.rotateAroundQuat(t,i,s,a)}}();function Tu(i,e,t){return d.convertPositionToWorldMatrix(i,e,t)}function Pu(i,e,t){return d.convertPositionToLocalMatrix(i,e,t)}function Cu(i,e,t=d.create()){return d.transformMat4(i,e,t),t}var bu=function(){let i=Ci();return function(t,n,o=d.create()){return R.invert(n,i),d.transformMat4(t,i,o),o}}(),Su=function(){let i=Ci(),e=z(),t=q(),n=z();return bi(n,1,1,1),function(s,a,l=d.create()){return V.getPosition(a,e),V.getRotationQuat(a,t),R.setPositionRotationQuatScale(i,e,t,n),d.convertPositionToWorldMatrix(s,i,l)}}(),vu=function(){let i=Ci(),e=z(),t=q(),n=z();return bi(n,1,1,1),function(s,a,l=d.create()){return V.getPosition(a,e),V.getRotationQuat(a,t),R.setPositionRotationQuatScale(i,e,t,n),d.convertPositionToLocalMatrix(s,i,l)}}();function xu(i,e,t){return d.convertDirectionToWorldMatrix(i,e,t)}function Mu(i,e,t){return d.convertDirectionToLocalMatrix(i,e,t)}var Du=function(){let i=q();return function(t,n,o=d.create()){return R.getRotationQuat(n,i),d.transformQuat(t,i,o),o}}(),Eu=function(){let i=q();return function(t,n,o=d.create()){return R.getRotationQuat(n,i),T.conjugate(i,i),d.transformQuat(t,i,o),o}}(),Au=function(){let i=q();return function(t,n,o=d.create()){return V.getRotationQuat(n,i),d.transformQuat(t,i,o),o}}(),Ru=function(){let i=q();return function(t,n,o=d.create()){return V.getRotationQuat(n,i),T.conjugate(i,i),d.transformQuat(t,i,o),o}}();function vx(i,e,t){return d.degreesAddRotation(i,e,t)}function xx(i,e,t){return d.degreesAddRotationDegrees(i,e,t)}function Mx(i,e,t){return d.degreesAddRotationRadians(i,e,t)}function Dx(i,e,t){return d.degreesAddRotationQuat(i,e,t)}function Vu(i,e,t){return d.degreesAddRotationDegrees(i,e,t)}var Ou=function(){let i=q();return function(t,n,o=d.create()){return d.degreesToQuat(t,i),T.toDegrees(T.addRotationDegrees(i,n,i),o)}}(),Iu=function(){let i=q();return function(t,n,o=d.create()){return d.degreesToQuat(t,i),T.toDegrees(T.addRotationRadians(i,n,i),o)}}(),Bu=function(){let i=q();return function(t,n,o=d.create()){return d.degreesToQuat(t,i),T.toDegrees(T.addRotationQuat(i,n,i),o)}}();function Lu(i,e,t){return d.radiansAddRotationDegrees(i,e,t)}var Hu=function(){let i=q();return function(t,n,o=d.create()){return d.radiansToQuat(t,i),T.toRadians(T.addRotationDegrees(i,n,i),o)}}(),ku=function(){let i=q();return function(t,n,o=d.create()){return d.radiansToQuat(t,i),T.toRadians(T.addRotationRadians(i,n,i),o)}}(),Fu=function(){let i=q();return function(t,n,o=d.create()){return d.radiansToQuat(t,i),T.toRadians(T.addRotationQuat(i,n,i),o)}}();function Ex(i,e=K.create()){return d.degreesToMatrix(i,e)}var wu=function(){let i=q();return function(t,n=K.create()){return d.degreesToQuat(t,i),T.toMatrix(i,n)}}(),ju=function(){let i=q();return function(t,n=K.create()){return d.radiansToQuat(t,i),T.toMatrix(i,n)}}();function Ax(i,e,t){return d.rotationToDegrees(i,e,t)}var Rx=function(){let i=q();return function(t,n,o=d.create()){return d.rotationToQuat(t,n,i),T.toDegrees(i,o),o}}(),Vx=function(){let i=q();return function(t,n,o=d.create()){return d.rotationToQuat(t,n,i),T.toRadians(i,o),o}}(),Ox=function(){let i=z();return function(t,n,o=T.create()){d.cross(t,n,i),d.normalize(i,i);let s=d.angleSigned(t,n,i);return T.fromAxisRadians(s,i,o),o}}();function zu(i,e,t,n){return d.rotationToPivotedDegrees(i,e,t,n)}var Gu=function(){let i=q();return function(t,n,o,s=d.create()){return d.rotationToPivotedQuat(t,n,o,i),T.toDegrees(i,s),s}}(),Nu=function(){let i=q();return function(t,n,o,s=d.create()){return d.rotationToPivotedQuat(t,n,o,i),T.toRadians(i,s),s}}(),Uu=function(){let i=z(),e=z(),t=z();return function(o,s,a,l=T.create()){d.removeComponentAlongAxis(o,a,i),d.removeComponentAlongAxis(s,a,e),d.cross(i,e,t),d.normalize(t,t);let h=d.angleSignedRadians(i,e,t);return T.fromAxisRadians(h,t,l),l}}();function Ix(i,e,t,n=d.create()){return t<=0?(d.copy(i,n),n):t>=1?(d.copy(e,n),n):(Le.lerp(n,i,e,t),n)}function Bx(i,e,t,n=ue.linear,o=d.create()){let s=n(t);return d.lerp(i,e,s,o)}var Wu=function(){let i=z();return function(t,n=d.create()){if(d.isZero(t))return d.zero(n);d.copy(t,i);let o=!1;for(let s=0;s<3;s++)t[s]==0&&o++;return o==2?i[0]==0?i[0]=1:i[1]==0?i[1]=1:i[2]==0&&(i[2]=1):i[0]!=0?i[0]=-i[0]:i[1]!=0?i[1]=-i[1]:i[2]!=0&&(i[2]=-i[2]),d.cross(i,t,n),n}}(),d={create:z,set:bi,normalize:Jv,copy:Zv,clone:Yv,zero:$v,angle:Iy,angleDegrees:By,angleRadians:Ly,equals:ex,length:tx,lengthSquared:ix,distance:Hy,distanceSquared:ky,add:Fy,sub:wy,mul:nx,div:jy,scale:ox,dot:zy,negate:Gy,cross:Ny,transformQuat:Uy,transformMat3:Wy,transformMat4:Qy,lengthSigned:qy,angleSigned:Xy,angleSignedDegrees:Ky,angleSignedRadians:Jy,anglePivoted:Zy,anglePivotedDegrees:Yy,anglePivotedRadians:$y,anglePivotedSigned:eu,anglePivotedSignedDegrees:tu,anglePivotedSignedRadians:iu,toRadians:sx,toDegrees:ax,toQuat:rx,radiansToQuat:nu,degreesToQuat:ou,isNormalized:lx,isZero:mx,componentAlongAxis:su,valueAlongAxis:au,removeComponentAlongAxis:ru,copyComponentAlongAxis:lu,isConcordant:mu,isFartherAlongAxis:yu,isToTheRight:uu,signTo:hu,projectOnAxis:cu,projectOnAxisAlongAxis:pu,projectOnPlane:du,projectOnPlaneAlongAxis:_u,isOnAxis:gu,isOnPlane:fu,rotate:yx,rotateDegrees:ux,rotateRadians:hx,rotateQuat:cx,rotateAxis:px,rotateAxisDegrees:dx,rotateAxisRadians:_x,rotateAround:gx,rotateAroundDegrees:fx,rotateAroundRadians:Tx,rotateAroundQuat:Px,rotateAroundAxis:Cx,rotateAroundAxisDegrees:bx,rotateAroundAxisRadians:Sx,convertPositionToWorld:Tu,convertPositionToLocal:Pu,convertPositionToWorldMatrix:Cu,convertPositionToLocalMatrix:bu,convertPositionToWorldQuat:Su,convertPositionToLocalQuat:vu,convertDirectionToWorld:xu,convertDirectionToLocal:Mu,convertDirectionToWorldMatrix:Du,convertDirectionToLocalMatrix:Eu,convertDirectionToWorldQuat:Au,convertDirectionToLocalQuat:Ru,addRotation:vx,addRotationDegrees:xx,addRotationRadians:Mx,addRotationQuat:Dx,degreesAddRotation:Vu,degreesAddRotationDegrees:Ou,degreesAddRotationRadians:Iu,degreesAddRotationQuat:Bu,radiansAddRotation:Lu,radiansAddRotationDegrees:Hu,radiansAddRotationRadians:ku,radiansAddRotationQuat:Fu,toMatrix:Ex,degreesToMatrix:wu,radiansToMatrix:ju,rotationTo:Ax,rotationToDegrees:Rx,rotationToRadians:Vx,rotationToQuat:Ox,rotationToPivoted:zu,rotationToPivotedDegrees:Gu,rotationToPivotedRadians:Nu,rotationToPivotedQuat:Uu,lerp:Ix,interpolate:Bx,perpendicularRandom:Wu};function q(i,e,t,n){let o=Je.create();return i!==void 0&&T.set(o,i,e,t,n),o}function Hx(i,e,t,n,o){return t===void 0?Je.set(i,e,e,e,e):Je.set(i,e,t,n,o),i}function kx(i,e=T.create()){return Je.normalize(e,i),e}function Fx(i,e){return Je.copy(e,i),e}function wx(i,e=T.create()){return T.copy(i,e),e}function jx(i){return Je.identity(i),i}function zx(i){return Je.length(i)}function Gx(i){return Je.squaredLength(i)}function Nx(i,e=T.create()){return Je.invert(e,i),e}function Ux(i,e=T.create()){return Je.conjugate(e,i),e}function Wx(i,e,t=T.create()){return Je.mul(t,i,e),t}var Qu=function(){let i=z(0,0,0);return function(t,n=d.create()){return Je.getAxisAngle(n,t)<=B.EPSILON&&d.copy(i,n),n}}();function qu(i){return T.getAngleDegrees(i)}function Xu(i){let e=T.getAngleRadians(i);return B.toDegrees(e)}var Ku=function(){let i=z();return function(t){return Je.getAxisAngle(i,t)}}();function Ju(i,e=d.create()){return T.getAxisScaledDegrees(i,e)}function Zu(i,e=d.create()){T.getAxis(i,e);let t=T.getAngleDegrees(i);return d.scale(e,t,e),e}var Yu=function(){let i=z(0,0,0);return function(t,n=d.create()){T.getAxis(t,n);let o=T.getAngleRadians(t);return o<=B.EPSILON?d.copy(i,n):d.scale(n,o,n),n}}();function Qx(i,e=[d.create(),d.create(),d.create()]){return T.getLeft(i,e[0]),T.getUp(i,e[1]),T.getForward(i,e[2]),e}var qx=function(){let i=Et();return function(t,n=d.create()){return T.toMatrix(t,i),d.set(n,i[6],i[7],i[8]),n}}();function Xx(i,e){return e=T.getForward(i,e),d.negate(e,e),e}var Kx=function(){let i=Et();return function(t,n=d.create()){return T.toMatrix(t,i),d.set(n,i[0],i[1],i[2]),n}}();function Jx(i,e){return e=T.getLeft(i,e),d.negate(e,e),e}var Zx=function(){let i=Et();return function(t,n=d.create()){return T.toMatrix(t,i),d.set(n,i[3],i[4],i[5]),n}}();function Yx(i,e){return e=T.getUp(i,e),d.negate(e,e),e}function $x(i,e,t,n){return n!=null?T.setForward(i,n,t,e):t!=null?T.setUp(i,t,n,e):T.setLeft(i,e,t,n)}var eM=function(){let i=[null,null,null],e=[2,1,0];return function(n,o,s=null,a=null){i[0]=a,i[1]=s,i[2]=o;let l=gn(n,i,e);return i[0]=null,i[1]=null,i[2]=null,l}}(),tM=function(){let i=z(),e=[null,null,null],t=[2,1,0];return function(o,s,a=null,l=null){d.negate(s,i),e[0]=l,e[1]=a,e[2]=i;let h=gn(o,e,t);return e[0]=null,e[1]=null,e[2]=null,h}}(),iM=function(){let i=[null,null,null],e=[1,2,0];return function(n,o,s=null,a=null){i[0]=a,i[1]=o,i[2]=s;let l=gn(n,i,e);return i[0]=null,i[1]=null,i[2]=null,l}}(),nM=function(){let i=z(),e=[null,null,null],t=[1,2,0];return function(o,s,a=null,l=null){d.negate(s,i),e[0]=l,e[1]=i,e[2]=a;let h=gn(o,e,t);return e[0]=null,e[1]=null,e[2]=null,h}}(),oM=function(){let i=[null,null,null],e=[0,1,2];return function(n,o,s=null,a=null){i[0]=o,i[1]=s,i[2]=a;let l=gn(n,i,e);return i[0]=null,i[1]=null,i[2]=null,l}}(),sM=function(){let i=z(),e=[null,null,null],t=[0,1,2];return function(o,s,a=null,l=null){d.negate(s,i),e[0]=i,e[1]=a,e[2]=l;let h=gn(o,e,t);return e[0]=null,e[1]=null,e[2]=null,h}}();function aM(i,e,t=T.create()){return T.mul(e,i,t),t}var rM=function(){let i=q();return function(t,n,o=T.create()){return T.conjugate(n,i),T.mul(i,t,o),o}}();function $u(i,e,t=T.create()){return T.fromAxisDegrees(i,e,t)}function eh(i,e,t=T.create()){return T.fromAxisRadians(B.toRadians(i),e,t),t}function th(i,e,t=T.create()){return Je.setAxisAngle(t,e,i),t}var lM=function(){let i=Et();return function(t,n,o,s=T.create()){return K.fromAxes(t,n,o,i),K.toQuat(i,s)}}(),ih=function(){let i=z();return function(t,n=T.create()){return d.toDegrees(t,i),T.fromDegrees(i,n)}}();function nh(i,e=T.create()){return Je.fromEuler(e,i[0],i[1],i[2]),e}var mM=function(){let i=Et();return function(t,n=d.create()){return T.toMatrix(t,i),n[1]=Math.asin(-B.clamp(i[2],-1,1)),Math.abs(i[2])<1-B.EPSILON?(n[0]=Math.atan2(i[5],i[8]),n[2]=Math.atan2(i[1],i[0])):(n[0]=0,n[2]=Math.atan2(-i[3],i[4])),n}}();function yM(i,e=d.create()){return T.toRadians(i,e),d.toDegrees(e,e),e}function uM(i,e=B.EPSILON){return Math.abs(T.lengthSquared(i)-1)<e}function hM(i,e,t){return T.addRotationDegrees(i,e,t)}var cM=function(){let i=q();return function(t,n,o){return d.degreesToQuat(n,i),T.addRotationQuat(t,i,o)}}(),pM=function(){let i=q();return function(t,n,o){return d.radiansToQuat(n,i),T.addRotationQuat(t,i,o)}}();function dM(i,e,t=T.create()){return T.mul(e,i,t),t}function oh(i,e,t){return T.subRotationDegrees(i,e,t)}var sh=function(){let i=q();return function(t,n,o){return d.degreesToQuat(n,i),T.subRotationQuat(t,i,o)}}(),ah=function(){let i=q();return function(t,n,o){return d.radiansToQuat(n,i),T.subRotationQuat(t,i,o)}}(),rh=function(){let i=q();return function(t,n,o=T.create()){return T.invert(n,i),T.mul(t,i,o),o}}();function _M(i,e,t){return T.rotationToDegrees(i,e,t)}var gM=function(){let i=q();return function(t,n,o){return d.degreesToQuat(n,i),T.rotationToQuat(t,i,o)}}(),fM=function(){let i=q();return function(t,n,o){return d.radiansToQuat(n,i),T.rotationToQuat(t,i,o)}}();function TM(i,e,t){return T.normalize(T.subRotationQuat(e,i,t),t)}function lh(i,e,t){return T.rotationAroundAxisDegrees(i,e,t)}var mh=function(){let i=q();return function(t,n,o=d.create()){return T.rotationAroundAxisQuat(t,n,i),T.toDegrees(i,o)}}(),yh=function(){let i=q();return function(t,n,o=d.create()){return T.rotationAroundAxisQuat(t,n,i),T.toRadians(i,o)}}();function uh(i,e,t=T.create()){return T.getTwist(i,e,t)}var hh=function(){let i=z(),e=z(),t=q();return function(o,s,a=T.create()){i[0]=o[0],i[1]=o[1],i[2]=o[2];let l=d.dot(s,i);return d.scale(s,l,e),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=o[3],T.normalize(t,t),l<0&&(t[0]=-t[0],t[1]=-t[1],t[2]=-t[2],t[3]=-t[3]),T.copy(t,a)}}(),ch=function(){let i=q();return function(t,n,o=T.create()){return T.getTwist(t,n,i),T.getSwingFromTwist(t,i,o),o}}();function ph(i,e,t=T.create()){return T.subRotationQuat(i,e,t)}var dh=function(){let i=q();return function(t,n,o=T.create()){return T.conjugate(n,i),T.addRotationQuat(t,i,o),o}}();function _h(i,e,t=T.create()){return T.addRotationQuat(i,e,t)}function PM(i,e=K.create()){return Lx.fromQuat(e,i),e}function CM(i,e,t){return T.rotateDegrees(i,e,t)}function bM(i,e,t){return T.addRotationDegrees(i,e,t)}function SM(i,e,t){return T.addRotationRadians(i,e,t)}function vM(i,e,t){return T.addRotationQuat(i,e,t)}function xM(i,e,t,n){return T.rotateAxisDegrees(i,e,t,n)}var MM=function(){let i=q();return function(t,n,o,s){return T.fromAxisDegrees(n,o,i),T.rotateQuat(t,i,s)}}(),DM=function(){let i=q();return function(t,n,o,s){return T.fromAxisRadians(n,o,i),T.rotateQuat(t,i,s)}}();function EM(i,e,t,n=T.create()){return t<=0?(T.copy(i,n),n):t>=1?(T.copy(e,n),n):(Je.lerp(n,i,e,t),n)}function AM(i,e,t,n=ue.linear,o=T.create()){let s=n(t);return T.lerp(i,e,s,o)}function RM(i,e,t,n=T.create()){return t<=0?(T.copy(i,n),n):t>=1?(T.copy(e,n),n):(Je.slerp(n,i,e,t),n)}function VM(i,e,t,n=ue.linear,o=T.create()){let s=n(t);return T.slerp(i,e,s,o)}var T={create:q,set:Hx,normalize:kx,copy:Fx,clone:wx,identity:jx,length:zx,lengthSquared:Gx,invert:Nx,conjugate:Ux,mul:Wx,getAxis:Qu,getAngle:qu,getAngleDegrees:Xu,getAngleRadians:Ku,getAxisScaled:Ju,getAxisScaledDegrees:Zu,getAxisScaledRadians:Yu,getAxes:Qx,getForward:qx,getBackward:Xx,getLeft:Kx,getRight:Jx,getUp:Zx,getDown:Yx,setAxes:$x,setForward:eM,setBackward:tM,setUp:iM,setDown:nM,setLeft:oM,setRight:sM,toWorld:aM,toLocal:rM,fromAxis:$u,fromAxisDegrees:eh,fromAxisRadians:th,fromAxes:lM,fromRadians:ih,fromDegrees:nh,toRadians:mM,toDegrees:yM,isNormalized:uM,addRotation:hM,addRotationDegrees:cM,addRotationRadians:pM,addRotationQuat:dM,subRotation:oh,subRotationDegrees:sh,subRotationRadians:ah,subRotationQuat:rh,rotationTo:_M,rotationToDegrees:gM,rotationToRadians:fM,rotationToQuat:TM,rotationAroundAxis:lh,rotationAroundAxisDegrees:mh,rotationAroundAxisRadians:yh,rotationAroundAxisQuat:uh,getTwist:hh,getSwing:ch,getSwingFromTwist:ph,getTwistFromSwing:dh,fromTwistSwing:_h,toMatrix:PM,rotate:CM,rotateDegrees:bM,rotateRadians:SM,rotateQuat:vM,rotateAxis:xM,rotateAxisDegrees:MM,rotateAxisRadians:DM,lerp:EM,interpolate:AM,slerp:RM,sinterpolate:VM},gn=function(){let i=[z(),z(),z()],e=[[1,-1,1],[1,1,-1],[-1,1,-1]],t=z(),n=z(),o=z(),s=z(),a=z(),l=Et(),h=q();return function(y,r,u){let g=r[u[0]],P=r[u[1]],C=r[u[2]];if(g==null||d.isZero(g,B.EPSILON))return;let f=!1;P!=null&&d.angleRadians(g,P)>B.EPSILON&&(f=!0);let S=!1;if(C!=null&&d.angleRadians(g,C)>B.EPSILON&&(S=!0),f||S){let M=null,D=null,v=null;f?(M=P,D=1,v=2):(M=C,D=2,v=1);let b=e[u[0]];d.cross(g,M,i[v]),d.scale(i[v],b[u[v]],i[v]),d.cross(g,i[v],i[D]),d.scale(i[D],b[u[D]],i[D]),d.cross(i[1],i[2],i[0]),d.scale(i[0],b[u[0]],i[0]),d.normalize(i[X.findIndexEqual(u,0)],t),d.normalize(i[X.findIndexEqual(u,1)],n),d.normalize(i[X.findIndexEqual(u,2)],o),K.set(l,t[0],t[1],t[2],n[0],n[1],n[2],o[0],o[1],o[2]),K.toQuat(l,h),T.copy(h,y)}else{u[0]==0?T.getLeft(y,s):u[0]==1?T.getUp(y,s):T.getForward(y,s);let M=d.angleRadians(g,s);M>B.EPSILON&&(d.cross(s,g,a),d.normalize(a,a),d.isZero(a)&&d.perpendicularRandom(s,a),T.fromAxisRadians(M,a,h),T.rotateQuat(y,h,y))}return y}}();function Et(i,e,t,n,o,s,a,l,h){let _=sl.create();return i!==void 0&&gh(_,i,e,t,n,o,s,a,l,h),_}function gh(i,e,t,n,o,s,a,l,h,_){return t===void 0?sl.set(i,e,e,e,e,e,e,e,e,e):sl.set(i,e,t,n,o,s,a,l,h,_),i}var IM=function(){let i=q();return function(t,n=d.create()){return K.toQuat(t,i),T.toDegrees(i,n),n}}(),BM=function(){let i=q();return function(t,n=d.create()){return K.toQuat(t,i),T.toRadians(i,n),n}}();function LM(i,e=T.create()){return OM.fromMat3(e,i),e}function HM(i,e,t,n=K.create()){return K.set(n,i[0],i[1],i[2],e[0],e[1],e[2],t[0],t[1],t[2]),n}var K={create:Et,set:gh,toDegrees:IM,toRadians:BM,toQuat:LM,fromAxes:HM};var jt=class{constructor(){this.myCloneParent=void 0,this.myIgnoreNonCloneable=!1,this.myIgnoreComponents=!1,this.myIgnoreDescendants=!1,this.myComponentsToIgnore=[],this.myComponentsToInclude=[],this.myIgnoreComponentCallback=null,this.myDescendantsToIgnore=[],this.myDescendantsToInclude=[],this.myIgnoreDescendantCallback=null,this.myUseDefaultComponentClone=!1,this.myUseDefaultComponentCloneAsFallback=!1,this.myDefaultComponentCloneAutoStartIfNotActive=!0,this.myUseDefaultObjectClone=!1,this.myUseDefaultObjectCloneAsFallback=!1,this.myComponentDeepCloneParams=new zt,this.myComponentCustomCloneParams=new co}};function kM(i,e){return c.getPositionWorld(i,e)}function fh(i,e=d.create()){return i.getPositionWorld(e),e}function Th(i,e=d.create()){return i.getPositionLocal(e),e}function FM(i,e){return c.getRotationWorld(i,e)}function wM(i,e){return c.getRotationWorldDegrees(i,e)}function jM(i,e){return c.getRotationWorldRadians(i,e)}function Ph(i,e){return c.getRotationWorldMatrix(i,e)}function zM(i,e){return c.getRotationWorldQuat(i,e)}function Ch(i,e){return c.getRotationWorldDegrees(i,e)}function bh(i,e){return e=c.getRotationWorldRadians(i,e),e=d.toDegrees(e,e),e}var Sh=function(){let i=T.create();return function(t,n=d.create()){return c.getRotationWorldQuat(t,i),T.toRadians(i,n),n}}(),vh=function(){let i=T.create();return function(t,n=K.create()){return c.getRotationWorldQuat(t,i),T.toMatrix(i,n),n}}();function xh(i,e=T.create()){return i.getRotationWorld(e),e}function Mh(i,e){return c.getRotationLocalDegrees(i,e)}function Dh(i,e){return e=c.getRotationLocalRadians(i,e),e=d.toDegrees(e,e),e}var Eh=function(){let i=T.create();return function(t,n=d.create()){return c.getRotationLocalQuat(t,i),T.toRadians(i,n),n}}(),Ah=function(){let i=T.create();return function(t,n=K.create()){return c.getRotationLocalQuat(t,i),T.toMatrix(i,n),n}}();function Rh(i,e=T.create()){return i.getRotationLocal(e),e}function GM(i,e){return c.getScaleWorld(i,e)}function Vh(i,e=d.create()){return i.getScalingWorld(e),e}function Oh(i,e=d.create()){return i.getScalingLocal(e),e}function Ih(i,e){return c.getTransformWorld(i,e)}function Bh(i,e){return c.getTransformWorldMatrix(i,e)}function Lh(i,e){return c.getTransformWorldQuat(i,e)}function Hh(i,e){return c.getTransformWorldMatrix(i,e)}var kh=function(){let i=V.create(),e=d.create();return function(n,o=R.create()){return c.getTransformWorldQuat(n,i),c.getScaleWorld(n,e),R.fromQuat(i,o),R.scale(o,e,o),o}}();function Fh(i,e=V.create()){return i.getTransformWorld(e),e}function wh(i,e){return c.getTransformLocalMatrix(i,e)}var jh=function(){let i=V.create(),e=d.create();return function(n,o=R.create()){return c.getTransformLocalQuat(n,i),c.getScaleLocal(n,e),R.fromQuat(i,o),R.scale(o,e,o),o}}();function zh(i,e=V.create()){return i.getTransformLocal(e),e}function NM(i,e){return c.getAxesWorld(i,e)}function Gh(i,e=[d.create(),d.create(),d.create()]){return c.getLeftWorld(i,e[0]),c.getUpWorld(i,e[1]),c.getForwardWorld(i,e[2]),e}function Nh(i,e=[d.create(),d.create(),d.create()]){return c.getLeftLocal(i,e[0]),c.getUpLocal(i,e[1]),c.getForwardLocal(i,e[2]),e}function UM(i,e){return c.getForwardWorld(i,e)}var Uh=function(){let i=K.create();return function(t,n=d.create()){return c.getRotationWorldMatrix(t,i),n[0]=i[6],n[1]=i[7],n[2]=i[8],n}}(),Wh=function(){let i=K.create();return function(t,n=d.create()){return c.getRotationLocalMatrix(t,i),n[0]=i[6],n[1]=i[7],n[2]=i[8],n}}();function WM(i,e){return c.getBackwardWorld(i,e)}var Qh=function(){let i=K.create();return function(t,n=d.create()){return c.getRotationWorldMatrix(t,i),n[0]=-i[6],n[1]=-i[7],n[2]=-i[8],n}}(),qh=function(){let i=K.create();return function(t,n=d.create()){return c.getRotationLocalMatrix(t,i),n[0]=-i[6],n[1]=-i[7],n[2]=-i[8],n}}();function QM(i,e){return c.getUpWorld(i,e)}var Xh=function(){let i=K.create();return function(t,n=d.create()){return c.getRotationWorldMatrix(t,i),n[0]=i[3],n[1]=i[4],n[2]=i[5],n}}(),Kh=function(){let i=K.create();return function(t,n=d.create()){return c.getRotationLocalMatrix(t,i),n[0]=i[3],n[1]=i[4],n[2]=i[5],n}}();function qM(i,e){return c.getDownWorld(i,e)}var Jh=function(){let i=K.create();return function(t,n=d.create()){return c.getRotationWorldMatrix(t,i),n[0]=-i[3],n[1]=-i[4],n[2]=-i[5],n}}(),Zh=function(){let i=K.create();return function(t,n=d.create()){return c.getRotationLocalMatrix(t,i),n[0]=-i[3],n[1]=-i[4],n[2]=-i[5],n}}();function XM(i,e){return c.getLeftWorld(i,e)}var Yh=function(){let i=K.create();return function(t,n=d.create()){return c.getRotationWorldMatrix(t,i),n[0]=i[0],n[1]=i[1],n[2]=i[2],n}}(),$h=function(){let i=K.create();return function(t,n=d.create()){return c.getRotationLocalMatrix(t,i),n[0]=i[0],n[1]=i[1],n[2]=i[2],n}}();function KM(i,e){return c.getRightWorld(i,e)}var ec=function(){let i=K.create();return function(t,n=d.create()){return c.getRotationWorldMatrix(t,i),n[0]=-i[0],n[1]=-i[1],n[2]=-i[2],n}}(),tc=function(){let i=K.create();return function(t,n=d.create()){return c.getRotationLocalMatrix(t,i),n[0]=-i[0],n[1]=-i[1],n[2]=-i[2],n}}();function JM(i,e){c.setPositionWorld(i,e)}function ic(i,e){i.setTranslationWorld(e)}function nc(i,e){i.setTranslationLocal(e)}function ZM(i,e){c.setRotationWorld(i,e)}function YM(i,e){c.setRotationWorldDegrees(i,e)}function $M(i,e){c.setRotationWorldRadians(i,e)}function oc(i,e){c.setRotationWorldMatrix(i,e)}function eD(i,e){c.setRotationWorldQuat(i,e)}function sc(i,e){c.setRotationWorldDegrees(i,e)}var ac=function(){let i=T.create();return function(t,n){d.degreesToQuat(n,i),c.setRotationWorldQuat(t,i)}}(),rc=function(){let i=d.create();return function(t,n){i=d.toDegrees(n,i),c.setRotationWorldDegrees(t,i)}}(),lc=function(){let i=T.create();return function(t,n){K.toQuat(n,i),c.setRotationWorldQuat(t,i)}}();function mc(i,e){i.setRotationWorld(e)}function yc(i,e){c.setRotationLocalDegrees(i,e)}var uc=function(){let i=T.create();return function(t,n){d.degreesToQuat(n,i),c.setRotationLocalQuat(t,i)}}(),hc=function(){let i=d.create();return function(t,n){i=d.toDegrees(n,i),c.setRotationLocalDegrees(t,i)}}(),cc=function(){let i=T.create();return function(t,n){K.toQuat(n,i),c.setRotationLocalQuat(t,i)}}();function pc(i,e){i.setRotationLocal(e)}function tD(i,e){c.setScaleWorld(i,e)}var dc=function(){let i=d.create();return function(t,n){isNaN(n)?t.setScalingWorld(n):(d.set(i,n),t.setScalingWorld(i))}}(),_c=function(){let i=d.create();return function(t,n){isNaN(n)?t.setScalingLocal(n):(d.set(i,n),t.setScalingLocal(i))}}();function iD(i,e,t,n){c.setAxesWorld(i,e,t,n)}function gc(i,e,t,n){n!=null?c.setForwardWorld(i,n,t,e):t!=null?c.setUpWorld(i,t,n,e):c.setLeftWorld(i,e,t,n)}function fc(i,e,t,n){n!=null?c.setForwardLocal(i,n,t,e):t!=null?c.setUpLocal(i,t,n,e):c.setLeftLocal(i,e,t,n)}function nD(i,e,t,n){c.setForwardWorld(i,e,t,n)}var Tc=function(){let i=T.create();return function(t,n,o=null,s=null){c.getRotationWorldQuat(t,i),T.setForward(i,n,o,s),c.setRotationWorldQuat(t,i)}}(),Pc=function(){let i=T.create();return function(t,n,o=null,s=null){c.getRotationLocalQuat(t,i),T.setForward(i,n,o,s),c.setRotationLocalQuat(t,i)}}();function oD(i,e,t,n){c.setBackwardWorld(i,e,t,n)}var Cc=function(){let i=T.create();return function(t,n,o=null,s=null){c.getRotationWorldQuat(t,i),T.setBackward(i,n,o,s),c.setRotationWorldQuat(t,i)}}(),bc=function(){let i=T.create();return function(t,n,o=null,s=null){c.getRotationLocalQuat(t,i),T.setBackward(i,n,o,s),c.setRotationLocalQuat(t,i)}}();function sD(i,e,t,n){c.setUpWorld(i,e,t,n)}var Sc=function(){let i=T.create();return function(t,n,o=null,s=null){c.getRotationWorldQuat(t,i),T.setUp(i,n,o,s),c.setRotationWorldQuat(t,i)}}(),vc=function(){let i=T.create();return function(t,n,o=null,s=null){c.getRotationLocalQuat(t,i),T.setUp(i,n,o,s),c.setRotationLocalQuat(t,i)}}();function aD(i,e,t,n){c.setDownWorld(i,e,t,n)}var xc=function(){let i=T.create();return function(t,n,o=null,s=null){c.getRotationWorldQuat(t,i),T.setDown(i,n,o,s),c.setRotationWorldQuat(t,i)}}(),Mc=function(){let i=T.create();return function(t,n,o=null,s=null){c.getRotationLocalQuat(t,i),T.setDown(i,n,o,s),c.setRotationLocalQuat(t,i)}}();function rD(i,e,t,n){c.setLeftWorld(i,e,t,n)}var Dc=function(){let i=T.create();return function(t,n,o=null,s=null){c.getRotationWorldQuat(t,i),T.setLeft(i,n,o,s),c.setRotationWorldQuat(t,i)}}(),Ec=function(){let i=T.create();return function(t,n,o=null,s=null){c.getRotationLocalQuat(t,i),T.setLeft(i,n,o,s),c.setRotationLocalQuat(t,i)}}();function lD(i,e,t,n){c.setRightWorld(i,e,t,n)}var Ac=function(){let i=T.create();return function(t,n,o=null,s=null){c.getRotationWorldQuat(t,i),T.setRight(i,n,o,s),c.setRotationWorldQuat(t,i)}}(),Rc=function(){let i=T.create();return function(t,n,o=null,s=null){c.getRotationLocalQuat(t,i),T.setRight(i,n,o,s),c.setRotationLocalQuat(t,i)}}();function Vc(i,e){c.setTransformWorld(i,e)}function Oc(i,e){c.setTransformWorldMatrix(i,e)}function Ic(i,e){c.setTransformWorldQuat(i,e)}function Bc(i,e){return c.setTransformWorldMatrix(i,e)}var Lc=function(){let i=d.create(),e=T.create(),t=d.create(),n=R.create(),o=d.create(),s=d.create(1);return function(l,h){R.getPosition(h,i),R.getScale(h,t),d.div(s,t,o),R.scale(h,o,n),R.getRotationQuat(n,e),T.normalize(e,e),c.setScaleWorld(l,t),c.setRotationWorldQuat(l,e),c.setPositionWorld(l,i)}}();function Hc(i,e){i.setTransformWorld(e)}function kc(i,e){return c.setTransformLocalMatrix(i,e)}var Fc=function(){let i=d.create(),e=T.create(),t=d.create(),n=R.create(),o=d.create(),s=d.create(1);return function(l,h){R.getPosition(h,i),R.getScale(h,t),d.div(s,t,o),R.scale(h,o,n),R.getRotationQuat(n,e),T.normalize(e,e),c.setScaleLocal(l,t),c.setRotationLocalQuat(l,e),c.setPositionLocal(l,i)}}();function wc(i,e){i.setTransformLocal(e)}function jc(i){c.resetPositionWorld(i)}var zc=function(){let i=d.create();return function(t){c.setPositionWorld(t,i)}}(),Gc=function(){let i=d.create();return function(t){c.setPositionLocal(t,i)}}();function Nc(i){c.resetRotationWorld(i)}var Uc=function(){let i=T.create();return function(t){c.setRotationWorldQuat(t,i)}}(),Wc=function(){let i=T.create();return function(t){c.setRotationLocalQuat(t,i)}}();function Qc(i){c.resetScaleWorld(i)}var qc=function(){let i=d.create(1);return function(t){c.setScaleWorld(t,i)}}(),Xc=function(){let i=d.create(1);return function(t){c.setScaleLocal(t,i)}}();function Kc(i){c.resetTransformWorld(i)}function Jc(i){c.resetScaleWorld(i),c.resetRotationWorld(i),c.resetPositionWorld(i)}function Zc(i){c.resetScaleLocal(i),c.resetRotationLocal(i),c.resetPositionLocal(i)}function Yc(i,e){c.translateWorld(i,e)}function $c(i,e){i.translateWorld(e)}function ep(i,e){i.translate(e)}function tp(i,e){i.translateObject(e)}function ip(i,e,t){c.translateAxisWorld(i,e,t)}var np=function(){let i=d.create();return function(t,n,o){d.scale(o,n,i),c.translateWorld(t,i)}}(),op=function(){let i=d.create();return function(t,n,o){d.scale(o,n,i),c.translateLocal(t,i)}}(),sp=function(){let i=d.create();return function(t,n,o){d.scale(o,n,i),c.translateObject(t,i)}}();function mD(i,e){c.rotateWorld(i,e)}function yD(i,e){c.rotateWorldDegrees(i,e)}function uD(i,e){c.rotateWorldRadians(i,e)}function ap(i,e){c.rotateWorldMatrix(i,e)}function hD(i,e){c.rotateWorldQuat(i,e)}function rp(i,e){c.rotateWorldDegrees(i,e)}var lp=function(){let i=T.create();return function(t,n){d.degreesToQuat(n,i),c.rotateWorldQuat(t,i)}}(),mp=function(){let i=d.create();return function(t,n){i=d.toDegrees(n,i),c.rotateWorldDegrees(t,i)}}(),yp=function(){let i=T.create();return function(t,n){K.toQuat(n,i),T.normalize(i,i),c.rotateWorldQuat(t,i)}}(),up=function(){let i=T.create();return function(t,n){c.getRotationWorldQuat(t,i),T.mul(n,i,i),T.normalize(i,i),c.setRotationWorldQuat(t,i)}}();function hp(i,e){c.rotateLocalDegrees(i,e)}var cp=function(){let i=T.create();return function(t,n){d.degreesToQuat(n,i),c.rotateLocalQuat(t,i)}}(),pp=function(){let i=d.create();return function(t,n){i=d.toDegrees(n,i),c.rotateLocalDegrees(t,i)}}(),dp=function(){let i=T.create();return function(t,n){K.toQuat(n,i),T.normalize(i,i),c.rotateLocalQuat(t,i)}}(),_p=function(){let i=T.create();return function(t,n){c.getRotationLocalQuat(t,i),T.mul(n,i,i),T.normalize(i,i),c.setRotationLocalQuat(t,i)}}();function gp(i,e){c.rotateObjectDegrees(i,e)}var fp=function(){let i=T.create();return function(t,n){d.degreesToQuat(n,i),c.rotateObjectQuat(t,i)}}(),Tp=function(){let i=d.create();return function(t,n){i=d.toDegrees(n,i),c.rotateObjectDegrees(t,i)}}(),Pp=function(){let i=T.create();return function(t,n){K.toQuat(n,i),T.normalize(i,i),c.rotateObjectQuat(t,i)}}();function Cp(i,e){i.rotateObject(e)}function cD(i,e,t){c.rotateAxisWorld(i,e,t)}function pD(i,e,t){c.rotateAxisWorldDegrees(i,e,t)}function dD(i,e,t){c.rotateAxisWorldRadians(i,e,t)}function bp(i,e,t){c.rotateAxisWorldDegrees(i,e,t)}function Sp(i,e,t){c.rotateAxisWorldRadians(i,B.toRadians(e),t)}var vp=function(){let i=T.create();return function(t,n,o){T.fromAxisRadians(n,o,i),c.rotateWorldQuat(t,i)}}();function xp(i,e,t){c.rotateAxisLocalDegrees(i,e,t)}function Mp(i,e,t){c.rotateAxisLocalRadians(i,B.toRadians(e),t)}var Dp=function(){let i=T.create();return function(t,n,o){T.fromAxisRadians(n,o,i),c.rotateLocalQuat(t,i)}}();function Ep(i,e,t){c.rotateAxisObjectDegrees(i,e,t)}function Ap(i,e,t){c.rotateAxisObjectRadians(i,B.toRadians(e),t)}var Rp=function(){let i=T.create();return function(t,n,o){T.fromAxisRadians(n,o,i),c.rotateObjectQuat(t,i)}}();function _D(i,e,t){c.rotateAroundWorld(i,e,t)}function gD(i,e,t){c.rotateAroundWorldDegrees(i,e,t)}function fD(i,e,t){c.rotateAroundWorldRadians(i,e,t)}function Vp(i,e,t){c.rotateAroundWorldMatrix(i,e,t)}function TD(i,e,t){c.rotateAroundWorldQuat(i,e,t)}function Op(i,e,t){c.rotateAroundWorldDegrees(i,e,t)}var Ip=function(){let i=T.create();return function(t,n,o){d.degreesToQuat(n,i),c.rotateAroundWorldQuat(t,i,o)}}(),Bp=function(){let i=d.create();return function(t,n,o){i=d.toDegrees(n,i),c.rotateAroundWorldDegrees(t,i,o)}}(),Lp=function(){let i=T.create();return function(t,n,o){K.toQuat(n,i),T.normalize(i,i),c.rotateAroundWorldQuat(t,i,o)}}(),Hp=function(){let i=d.create();return function(t,n,o){T.getAxis(n,i);let s=T.getAngleRadians(n);c.rotateAroundAxisWorldRadians(t,s,i,o)}}();function kp(i,e,t){c.rotateAroundLocalDegrees(i,e,t)}var Fp=function(){let i=T.create();return function(t,n,o){d.degreesToQuat(n,i),c.rotateAroundLocalQuat(t,i,o)}}(),wp=function(){let i=d.create();return function(t,n,o){i=d.toDegrees(n,i),c.rotateAroundLocalDegrees(t,i,o)}}(),jp=function(){let i=T.create();return function(t,n,o){K.toQuat(n,i),T.normalize(i,i),c.rotateAroundLocalQuat(t,i,o)}}(),zp=function(){let i=d.create();return function(t,n,o){T.getAxis(n,i);let s=T.getAngleRadians(n);c.rotateAroundAxisLocalRadians(t,s,i,o)}}();function Gp(i,e,t){c.rotateAroundObjectDegrees(i,e,t)}var Np=function(){let i=T.create();return function(t,n,o){d.degreesToQuat(n,i),c.rotateAroundObjectQuat(t,i,o)}}(),Up=function(){let i=d.create();return function(t,n,o){i=d.toDegrees(n,i),c.rotateAroundObjectDegrees(t,i,o)}}(),Wp=function(){let i=T.create();return function(t,n,o){K.toQuat(n,i),T.normalize(i,i),c.rotateAroundObjectQuat(t,i,o)}}(),Qp=function(){let i=d.create();return function(t,n,o){T.getAxis(n,i);let s=T.getAngleRadians(n);c.rotateAroundAxisObjectRadians(t,s,i,o)}}();function PD(i,e,t,n){c.rotateAroundAxisWorld(i,e,t,n)}function CD(i,e,t,n){c.rotateAroundAxisWorldDegrees(i,e,t,n)}function bD(i,e,t,n){c.rotateAroundAxisWorldRadians(i,e,t,n)}function qp(i,e,t,n){c.rotateAroundAxisWorldDegrees(i,e,t,n)}function Xp(i,e,t,n){c.rotateAroundAxisWorldRadians(i,B.toRadians(e),t,n)}var Kp=function(){let i=V.create(),e=V.create(),t=V.create(),n=T.create();return function(s,a,l,h){V.setPositionRotationQuat(i,h,n),c.getTransformWorldQuat(s,t),V.conjugate(i,e),V.mul(e,t,t),V.rotateAxisRadians(i,a,l,i),V.mul(i,t,t),c.setTransformWorldQuat(s,t)}}();function Jp(i,e,t,n){c.rotateAroundAxisLocalDegrees(i,e,t,n)}function Zp(i,e,t,n){c.rotateAroundAxisLocalRadians(i,B.toRadians(e),t,n)}var Yp=function(){let i=d.create(),e=d.create();return function(n,o,s,a){c.convertPositionLocalToWorld(n,a,i),c.convertDirectionLocalToWorld(n,s,e),c.rotateAroundAxisWorldRadians(n,o,e,i)}}();function $p(i,e,t,n){c.rotateAroundAxisObjectDegrees(i,e,t,n)}function ed(i,e,t,n){c.rotateAroundAxisObjectRadians(i,B.toRadians(e),t,n)}var td=function(){let i=d.create(),e=d.create();return function(n,o,s,a){c.convertPositionObjectToWorld(n,a,i),c.convertDirectionObjectToWorld(n,s,e),c.rotateAroundAxisWorldRadians(n,o,e,i)}}(),id=function(){let i=d.create();return function(t,n){isNaN(n)?t.scale(n):(d.set(i,n),t.scale(i))}}();function nd(i,e,t){c.lookAtWorld(i,e,t)}var od=function(){let i=d.create();return function(t,n,o){c.getPositionWorld(t,i),d.sub(n,i,i),c.lookToWorld(t,i,o)}}(),sd=function(){let i=d.create();return function(t,n,o){c.getPositionLocal(t,i),d.sub(n,i,i),c.lookToLocal(t,i,o)}}();function ad(i,e,t){c.lookToWorld(i,e,t)}var rd=function(){let i=d.create();return function(t,n,o=c.getUpWorld(t,i)){c.setForwardWorld(t,n,o)}}(),ld=function(){let i=d.create();return function(t,n,o=c.getUpLocal(t,i)){c.setForwardLocal(t,n,o)}}(),md=function(){let i=d.create(),e=T.create(),t=d.create();return function(o,s,a=!0){a?(c.getPositionWorld(o,i),c.getRotationWorldQuat(o,e),c.getScaleWorld(o,t),o.parent=s,c.setScaleWorld(o,t),c.setRotationWorldQuat(o,e),c.setPositionWorld(o,i)):o.parent=s}}();function yd(i){return i.parent}var ud=function(){let i=R.create();return function(t,n,o=d.create()){return c.getTransformWorldMatrix(t,i),d.transformMat4(n,i,o),o}}(),hd=function(){let i=T.create();return function(t,n,o=d.create()){return c.getRotationWorldQuat(t,i),d.transformQuat(n,i,o),o}}(),cd=function(){let i=R.create();return function(t,n,o=d.create()){return c.getTransformWorldMatrix(t,i),R.invert(i,i),d.transformMat4(n,i,o),o}}(),pd=function(){let i=T.create();return function(t,n,o=d.create()){return c.getRotationWorldQuat(t,i),T.conjugate(i,i),d.transformQuat(n,i,o),o}}();function dd(i,e,t=d.create()){return c.getParent(i)?c.convertPositionObjectToWorld(c.getParent(i),e,t):d.copy(e,t),t}function _d(i,e,t=d.create()){return c.getParent(i)?c.convertDirectionObjectToWorld(c.getParent(i),e,t):d.copy(e,t),t}function gd(i,e,t=d.create()){return c.getParent(i)?c.convertPositionWorldToObject(c.getParent(i),e,t):d.copy(e,t),t}function fd(i,e,t=d.create()){return c.getParent(i)?c.convertDirectionWorldToObject(c.getParent(i),e,t):d.copy(e,t),t}function Td(i,e,t=d.create()){return c.convertPositionObjectToWorld(i,e,t),c.convertPositionWorldToLocal(i,t,t),t}function Pd(i,e,t=d.create()){return c.convertDirectionObjectToWorld(i,e,t),c.convertDirectionWorldToLocal(i,t,t),t}function Cd(i,e,t=d.create()){return c.convertPositionLocalToWorld(i,e,t),c.convertPositionWorldToObject(i,t,t),t}function bd(i,e,t=d.create()){return c.convertDirectionLocalToWorld(i,e,t),c.convertDirectionWorldToObject(i,t,t),t}function Sd(i,e,t){return c.convertTransformObjectToWorldMatrix(i,e,t)}var vd=function(){let i=R.create(),e=d.create(),t=d.create(),n=d.create(),o=d.create(1);return function(a,l,h=R.create()){return c.getTransformWorldMatrix(a,i),c.hasUniformScaleWorld(a)?R.mul(i,l,h):(d.set(e,l[12],l[13],l[14]),c.convertPositionObjectToWorld(a,e,e),R.getScale(i,t),d.div(o,t,n),R.scale(i,n,i),R.mul(i,l,h),R.scale(h,t,h),h[12]=e[0],h[13]=e[1],h[14]=e[2],h[15]=1),h}}(),xd=function(){let i=d.create(),e=T.create();return function(n,o,s=V.create()){return c.getRotationWorldQuat(n,e),T.mul(e,o,e),V.getPosition(o,i),c.convertPositionObjectToWorld(n,i,i),V.setPositionRotationQuat(s,i,e),s}}();function Md(i,e,t){return c.convertTransformWorldToObjectMatrix(i,e,t)}var Dd=function(){let i=R.create(),e=d.create(),t=d.create(),n=d.create(),o=d.create(1);return function(a,l,h=R.create()){return c.getTransformWorldMatrix(a,i),c.hasUniformScaleWorld(a)?(R.invert(i,i),R.mul(i,l,h)):(d.set(e,l[12],l[13],l[14]),c.convertPositionWorldToObject(a,e,e),R.getScale(i,t),d.div(o,t,n),R.scale(i,n,i),R.invert(i,i),R.mul(i,l,h),R.scale(h,n,h),h[12]=e[0],h[13]=e[1],h[14]=e[2],h[15]=1),h}}(),Ed=function(){let i=d.create(),e=T.create();return function(n,o,s=V.create()){return c.getRotationWorldQuat(n,e),T.conjugate(e,e),T.mul(e,o,e),V.getPosition(o,i),c.convertPositionWorldToObject(n,i,i),V.setPositionRotationQuat(s,i,e),s}}();function Ad(i,e,t){return c.convertTransformLocalToWorldMatrix(i,e,t)}function Rd(i,e,t=R.create()){return c.getParent(i)?c.convertTransformObjectToWorldMatrix(c.getParent(i),e,t):R.copy(e,t),t}function Vd(i,e,t=V.create()){return c.getParent(i)?c.convertTransformObjectToWorldQuat(c.getParent(i),e,t):V.copy(e,t),t}function Od(i,e,t){return c.convertTransformWorldToLocalMatrix(i,e,t)}function Id(i,e,t=R.create()){return c.getParent(i)?c.convertTransformWorldToObjectMatrix(c.getParent(i),e,t):R.copy(e,t),t}function Bd(i,e,t=V.create()){return c.getParent(i)?c.convertTransformWorldToObjectQuat(c.getParent(i),e,t):V.copy(e,t),t}function Ld(i,e,t){return c.convertTransformObjectToLocalMatrix(i,e,t)}function Hd(i,e,t=R.create()){return c.convertTransformObjectToWorldMatrix(i,e,t),c.convertTransformWorldToLocalMatrix(i,t,t),t}function kd(i,e,t=V.create()){return c.convertTransformObjectToWorldQuat(i,e,t),c.convertTransformWorldToLocalQuat(i,t,t),t}function Fd(i,e,t){return c.convertTransformLocalToObjectMatrix(i,e,t)}function wd(i,e,t=R.create()){return c.convertTransformLocalToWorldMatrix(i,e,t),c.convertTransformWorldToObjectMatrix(i,t,t),t}function jd(i,e,t=V.create()){return c.convertTransformLocalToWorldQuat(i,e,t),c.convertTransformWorldToObjectQuat(i,t,t),t}function zd(i,e,t,n=null){let o=null;return typeof t=="boolean"?(o={},o.active=t):(o=t,n!=null&&(o==null&&(o={}),o.active=n)),i.addComponent(e,o)}function SD(i,e,t=0){return c.getComponentHierarchy(i,e,t)}function Gd(i,e,t=0){return i.getComponent(e,t)}function Nd(i,e,t=0){return c.getComponentHierarchyBreadth(i,e,t)}function Ud(i,e,t=0){let n=c.getHierarchyBreadth(i);return c.getComponentObjects(n,e,t)}function Wd(i,e,t=0){let n=c.getHierarchyDepth(i);return c.getComponentObjects(n,e,t)}function Qd(i,e,t=0){return c.getComponentDescendantsBreadth(i,e,t)}function qd(i,e,t=0){let n=c.getDescendantsBreadth(i);return c.getComponentObjects(n,e,t)}function Xd(i,e,t=0){let n=c.getDescendantsDepth(i);return c.getComponentObjects(n,e,t)}function Kd(i,e,t=0){let n=c.getChildren(i);return c.getComponentObjects(n,e,t)}function vD(i,e){return c.getComponentsHierarchy(i,e)}function Jd(i,e){return i.getComponents(e)}function Zd(i,e){return c.getComponentsHierarchyBreadth(i,e)}function Yd(i,e){let t=c.getHierarchyBreadth(i);return c.getComponentsObjects(t,e)}function $d(i,e){let t=c.getHierarchyDepth(i);return c.getComponentsObjects(t,e)}function e_(i,e){return c.getComponentsDescendantsBreadth(i,e)}function t_(i,e){let t=c.getDescendantsBreadth(i);return c.getComponentsObjects(t,e)}function i_(i,e){let t=c.getDescendantsDepth(i);return c.getComponentsObjects(t,e)}function n_(i,e){let t=c.getChildren(i);return c.getComponentsObjects(t,e)}function o_(i,e){c.setActiveHierarchy(i,e)}function s_(i,e){i.active=e}function a_(i,e){c.setActiveHierarchyBreadth(i,e)}function r_(i,e){let t=c.getHierarchyBreadth(i);c.setActiveObjects(t,e)}function l_(i,e){let t=c.getHierarchyDepth(i);c.setActiveObjects(t,e)}function m_(i,e){c.setActiveDescendantsBreadth(i,e)}function y_(i,e){let t=c.getDescendantsBreadth(i);c.setActiveObjects(t,e)}function u_(i,e){let t=c.getDescendantsDepth(i);c.setActiveObjects(t,e)}function h_(i,e){let t=c.getChildren(i);c.setActiveObjects(t,e)}function xD(i){return c.hasUniformScaleWorld(i)}var c_=function(){let i=d.create();return function(t){return c.getScaleWorld(t,i),Math.abs(i[0]-i[1])<B.EPSILON&&Math.abs(i[1]-i[2])<B.EPSILON&&Math.abs(i[0]-i[2])<B.EPSILON}}(),p_=function(){let i=d.create();return function(t){return c.getScaleLocal(t,i),Math.abs(i[0]-i[1])<B.EPSILON&&Math.abs(i[1]-i[2])<B.EPSILON&&Math.abs(i[0]-i[2])<B.EPSILON}}(),MD=function(){let i=d.create(),e=V.create();return function(n,o=new jt){let s=null,a=o.myCloneParent===void 0?c.getParent(n):o.myCloneParent;if(o.myUseDefaultObjectClone){if(s=n.clone(a),o.myDefaultComponentCloneAutoStartIfNotActive){let l=s.pp_getComponents();for(let h of l)o.myDefaultComponentCloneAutoStartIfNotActive&&!h.active&&(h.active=!0,h.active=!1)}}else if(c.isCloneable(n,o)){let l=[];l.push([a,n]);let h=[];for(;l.length>0;){let r=l.shift(),u=r[0],g=r[1],P=u!=null?c.addObject(u):Z.addObject(m.getScene(c.getEngine(n)));if(c.setName(P,c.getName(g)),c.setScaleLocal(P,c.getScaleLocal(g,i)),c.setTransformLocalQuat(P,c.getTransformLocalQuat(g,e)),o.myIgnoreComponents||h.push([g,P]),!o.myIgnoreDescendants)for(let C of c.getChildren(g)){let f=!1;o.myDescendantsToInclude.length>0?f=o.myDescendantsToInclude.find(S=>c.equals(S,C))!=null:f=o.myDescendantsToIgnore.find(S=>c.equals(S,C))==null,f&&o.myIgnoreDescendantCallback!=null&&(f=!o.myIgnoreDescendantCallback(C)),f&&l.push([P,C])}s==null&&(s=P)}let _=[];for(;h.length>0;){let r=h.shift(),u=r[0],g=r[1],P=c.getComponentsSelf(u);for(let C of P)if(j.isCloneable(C.type,o.myUseDefaultComponentClone||o.myUseDefaultComponentCloneAsFallback,c.getEngine(n))){let f=!1;o.myComponentsToInclude.length>0?f=o.myComponentsToInclude.indexOf(C.type)!=-1:f=o.myComponentsToIgnore.indexOf(C.type)==-1,f&&o.myIgnoreComponentCallback!=null&&(f=!o.myIgnoreComponentCallback(C)),f&&_.push([C,g])}}let y=[];for(;_.length>0;){let r=_.shift(),u=r[0],g=r[1],P=null;o.myUseDefaultComponentClone?P=j.cloneDefault(u,g,o.myDefaultComponentCloneAutoStartIfNotActive):P=j.clone(u,g,o.myComponentDeepCloneParams,o.myComponentCustomCloneParams,o.myUseDefaultComponentCloneAsFallback,o.myDefaultComponentCloneAutoStartIfNotActive),P!=null&&j.hasClonePostProcess(u.type,c.getEngine(n))&&y.push([u,P])}for(;y.length>0;){let r=y.shift(),u=r[0],g=r[1];j.clonePostProcess(u,g,o.myComponentDeepCloneParams,o.myComponentCustomCloneParams)}}else if(o.myUseDefaultObjectCloneAsFallback&&(s=n.clone(a),o.myDefaultComponentCloneAutoStartIfNotActive)){let l=s.pp_getComponents();for(let h of l)o.myDefaultComponentCloneAutoStartIfNotActive&&!h.active&&(h.active=!0,h.active=!1)}return s}}();function DD(i,e=new jt){if(e.myIgnoreNonCloneable||e.myIgnoreComponents||e.myUseDefaultComponentClone||e.myUseDefaultComponentCloneAsFallback)return!0;let t=!0,n=[];for(n.push(i);t&&n.length>0;){let o=n.shift(),s=c.getComponentsSelf(o);for(let a of s){let l=!1;if(e.myComponentsToInclude.length>0?l=e.myComponentsToInclude.indexOf(a.type)!=-1:l=e.myComponentsToIgnore.indexOf(a.type)==-1,l&&e.myIgnoreComponentCallback!=null&&(l=!e.myIgnoreComponentCallback(a)),l&&!j.isCloneable(a.type,!1,c.getEngine(i))){t=!1;break}}if(t&&!e.myIgnoreDescendants)for(let a of c.getChildren(o)){let l=!1;e.myDescendantsToInclude.length>0?l=e.myDescendantsToInclude.find(h=>c.equals(h,a))!=null:l=e.myDescendantsToIgnore.find(h=>c.equals(h,a))==null,l&&e.myIgnoreDescendantCallback!=null&&(l=!e.myIgnoreDescendantCallback(a)),l&&n.push(a)}}return t}function ED(i){return c.toStringCompact(i)}var AD=function(){let i="    ",e=`
`,t="{",n="}",o="name: ",s="id: ",a="components: ",l="type: ",h="children: ",_="[",y="]",r=_,u=y,g=",",P=e.concat(i,i);return function(f){let S="";S=S.concat(t,e);let M=c.getComponentsSelf(f),D=c.getChildren(f),v=c.getName(f);if(M.length>0||D.length>0||v.length>0?S=S.concat(i,s,c.getID(f),g,e):S=S.concat(i,s,c.getID(f),e),v.length>0&&(M.length>0||D.length>0?S=S.concat(i,o,c.getName(f),g,e):S=S.concat(i,o,c.getName(f),e)),M.length>0){S=S.concat(i,a,e,i,_,e);for(let b=0;b<M.length;b++){let x=M[b];S=S.concat(i,i,t,e),S=S.concat(i,i,i,l,x.type,g,e),S=S.concat(i,i,i,s,x._id,g,e),S=S.concat(i,i,n),b!=M.length-1?S=S.concat(g,e):S=S.concat(e)}D.length>0?S=S.concat(i,y,g,e):S=S.concat(i,y,e)}if(D.length>0){S=S.concat(i,h,e,i,r,e);for(let b=0;b<D.length;b++){let x=D[b],I=c.toStringExtended(x);I=I.replaceAll(e,P),I=i.concat(i,I),S=S.concat(I),b!=D.length-1?S=S.concat(g,e):S=S.concat(e)}S=S.concat(i,u,e)}return S=S.concat(n),S}}(),RD=function(){let i="    ",e=`
`,t="<none>",n="name: ",o="components: ",s=", ",a=e.concat(i);return function(h){let _="",y=c.getName(h);y.length>0?_=_.concat(n,y):_=_.concat(n,t);let r=c.getComponentsSelf(h);if(r.length>0){_=_.concat(s,o);for(let g=0;g<r.length;g++){let P=r[g];_=_.concat(P.type),g!=r.length-1&&(_=_.concat(s))}}let u=c.getChildren(h);if(u.length>0){_=_.concat(e);for(let g=0;g<u.length;g++){let P=u[g],C=c.toStringCompact(P);C=C.replaceAll(e,a),C=i.concat(C),_=_.concat(C),g!=u.length-1&&(_=_.concat(e))}}return _}}();function VD(i,e,t=!1,n=0){return c.getObjectByNameHierarchy(i,e,t,n)}function d_(i,e,t=!1,n=0){return c.getObjectByNameHierarchyBreadth(i,e,t,n)}function __(i,e,t=!1,n=0){let o=c.getHierarchyBreadth(i);return c.getObjectByNameObjects(o,e,t,n)}function g_(i,e,t=!1,n=0){let o=c.getHierarchyDepth(i);return c.getObjectByNameObjects(o,e,t,n)}function f_(i,e,t=!1,n=0){return c.getObjectByNameDescendantsBreadth(i,e,t,n)}function T_(i,e,t=!1,n=0){let o=c.getDescendantsBreadth(i);return c.getObjectByNameObjects(o,e,t,n)}function P_(i,e,t=!1,n=0){let o=c.getDescendantsDepth(i);return c.getObjectByNameObjects(o,e,t,n)}function C_(i,e,t=!1,n=0){let o=c.getChildren(i);return c.getObjectByNameObjects(o,e,t,n)}function OD(i,e,t=!1){return c.getObjectsByNameHierarchy(i,e,t)}function b_(i,e,t=!1){return c.getObjectsByNameHierarchyBreadth(i,e,t)}function S_(i,e,t=!1){let n=c.getHierarchyBreadth(i);return c.getObjectsByNameObjects(n,e,t)}function v_(i,e,t=!1){let n=c.getHierarchyDepth(i);return c.getObjectsByNameObjects(n,e,t)}function x_(i,e,t=!1){return c.getObjectsByNameDescendantsBreadth(i,e,t)}function M_(i,e,t=!1){let n=c.getDescendantsBreadth(i);return c.getObjectsByNameObjects(n,e,t)}function D_(i,e,t=!1){let n=c.getDescendantsDepth(i);return c.getObjectsByNameObjects(n,e,t)}function E_(i,e,t=!1){let n=c.getChildren(i);return c.getObjectsByNameObjects(n,e,t)}function ID(i,e){return c.getObjectByIDHierarchy(i,e)}function A_(i,e){return c.getObjectByIDHierarchyBreadth(i,e)}function R_(i,e){let t=c.getHierarchyBreadth(i);return c.getObjectByIDObjects(t,e)}function V_(i,e){let t=c.getHierarchyDepth(i);return c.getObjectByIDObjects(t,e)}function O_(i,e){return c.getObjectByIDDescendantsBreadth(i,e)}function I_(i,e){let t=c.getDescendantsBreadth(i);return c.getObjectByIDObjects(t,e)}function B_(i,e){let t=c.getDescendantsDepth(i);return c.getObjectByIDObjects(t,e)}function L_(i,e){let t=c.getChildren(i);return c.getObjectByIDObjects(t,e)}function H_(i){return c.getHierarchyBreadth(i)}function k_(i){let e=c.getDescendantsBreadth(i);return e.unshift(i),e}function F_(i){let e=c.getDescendantsDepth(i);return e.unshift(i),e}function w_(i){return c.getDescendantsBreadth(i)}function j_(i){let e=[],t=c.getChildren(i);for(;t.length>0;){let n=t.shift();e.push(n);for(let o of c.getChildren(n))t.push(o)}return e}function z_(i){let e=[],t=c.getChildren(i);for(let n of t){e.push(n);let o=c.getDescendantsDepth(n);for(let s=0;s<o.length;s++)e.push(o[s])}return e}function G_(i){return i.children}function N_(i){return i}function BD(i){return m.getScene(c.getEngine(i)).addObject(i)}function U_(i){return i.name}function W_(i,e){i.name=e}function Q_(i){return i.engine}function q_(i){return i.objectId}function X_(i){return i.setDirty()}function K_(i){return i.changed}function LD(i,e){return i.equals(e)}function J_(i){let e;try{e=i.destroy()}catch{}return e}function Z_(i,e){c.reserveObjectsHierarchy(i,e)}function Y_(i,e){let t=c.getComponentsAmountMapSelf(i);or(e,t,m.getScene(c.getEngine(i)))}function $_(i,e){let t=c.getComponentsAmountMapHierarchy(i);or(e,t,m.getScene(c.getEngine(i)))}function eg(i,e){let t=c.getComponentsAmountMapDescendants(i);or(e,t,m.getScene(c.getEngine(i)))}function tg(i,e){let t=c.getComponentsAmountMapChildren(i);or(e,t,m.getScene(c.getEngine(i)))}function HD(i,e=new Map){return c.getComponentsAmountMapHierarchy(i,e)}function ig(i,e=new Map){let t=e.get("object");t==null&&(t=0),t+=1,e.set("object",t);let n=c.getComponentsSelf(i);for(let o of n){let s=o.type,a=e.get(s);a==null&&(a=0),a+=1,e.set(s,a)}return e}function ng(i,e=new Map){let t=c.getHierarchy(i);for(let n of t)c.getComponentsAmountMapSelf(n,e);return e}function og(i,e=new Map){let t=c.getDescendants(i);for(let n of t)c.getComponentsAmountMapSelf(n,e);return e}function sg(i,e=new Map){let t=c.getChildren(i);for(let n of t)c.getComponentsAmountMapSelf(n,e);return e}function ag(i,e,t=0){let n=null;for(let o of i)if(n=o.getComponent(e,t),n!=null)break;return n}function rg(i,e){let t=[];for(let n of i){let o=n.getComponents(e);for(let s=0;s<o.length;s++)t.push(o[s])}return t}function lg(i,e){for(let t of i)t.active=e}function mg(i,e,t=!1,n=0){let o=null,s=n;for(let a of i){let l=c.getName(a);if(!t&&l==e||t&&l.match(e)!=null){if(s==0){o=a;break}s--}}return o}function yg(i,e,t=!1){let n=[];for(let o of i){let s=c.getName(o);(!t&&s==e||t&&s.match(e)!=null)&&n.push(o)}return n}function ug(i,e,t=0){let n=null,o=t;for(let s of i)if(c.getID(s)==e){if(o==0){n=s;break}o--}return n}function hg(i,e){let t=[];for(let n of i)c.getID(n)==e&&t.push(n);return t}function cg(i,e=m.getMainEngine()){return e.wrapObject(i)}var c={getPosition:kM,getPositionWorld:fh,getPositionLocal:Th,getRotation:FM,getRotationDegrees:wM,getRotationRadians:jM,getRotationMatrix:Ph,getRotationQuat:zM,getRotationWorld:Ch,getRotationWorldDegrees:bh,getRotationWorldRadians:Sh,getRotationWorldMatrix:vh,getRotationWorldQuat:xh,getRotationLocal:Mh,getRotationLocalDegrees:Dh,getRotationLocalRadians:Eh,getRotationLocalMatrix:Ah,getRotationLocalQuat:Rh,getScale:GM,getScaleWorld:Vh,getScaleLocal:Oh,getTransform:Ih,getTransformMatrix:Bh,getTransformQuat:Lh,getTransformWorld:Hh,getTransformWorldMatrix:kh,getTransformWorldQuat:Fh,getTransformLocal:wh,getTransformLocalMatrix:jh,getTransformLocalQuat:zh,getAxes:NM,getAxesWorld:Gh,getAxesLocal:Nh,getForward:UM,getForwardWorld:Uh,getForwardLocal:Wh,getBackward:WM,getBackwardWorld:Qh,getBackwardLocal:qh,getUp:QM,getUpWorld:Xh,getUpLocal:Kh,getDown:qM,getDownWorld:Jh,getDownLocal:Zh,getLeft:XM,getLeftWorld:Yh,getLeftLocal:$h,getRight:KM,getRightWorld:ec,getRightLocal:tc,setPosition:JM,setPositionWorld:ic,setPositionLocal:nc,setRotation:ZM,setRotationDegrees:YM,setRotationRadians:$M,setRotationMatrix:oc,setRotationQuat:eD,setRotationWorld:sc,setRotationWorldDegrees:ac,setRotationWorldRadians:rc,setRotationWorldMatrix:lc,setRotationWorldQuat:mc,setRotationLocal:yc,setRotationLocalDegrees:uc,setRotationLocalRadians:hc,setRotationLocalMatrix:cc,setRotationLocalQuat:pc,setScale:tD,setScaleWorld:dc,setScaleLocal:_c,setAxes:iD,setAxesWorld:gc,setAxesLocal:fc,setForward:nD,setForwardWorld:Tc,setForwardLocal:Pc,setBackward:oD,setBackwardWorld:Cc,setBackwardLocal:bc,setUp:sD,setUpWorld:Sc,setUpLocal:vc,setDown:aD,setDownWorld:xc,setDownLocal:Mc,setLeft:rD,setLeftWorld:Dc,setLeftLocal:Ec,setRight:lD,setRightWorld:Ac,setRightLocal:Rc,setTransform:Vc,setTransformMatrix:Oc,setTransformQuat:Ic,setTransformWorld:Bc,setTransformWorldMatrix:Lc,setTransformWorldQuat:Hc,setTransformLocal:kc,setTransformLocalMatrix:Fc,setTransformLocalQuat:wc,resetPosition:jc,resetPositionWorld:zc,resetPositionLocal:Gc,resetRotation:Nc,resetRotationWorld:Uc,resetRotationLocal:Wc,resetScale:Qc,resetScaleWorld:qc,resetScaleLocal:Xc,resetTransform:Kc,resetTransformWorld:Jc,resetTransformLocal:Zc,translate:Yc,translateWorld:$c,translateLocal:ep,translateObject:tp,translateAxis:ip,translateAxisWorld:np,translateAxisLocal:op,translateAxisObject:sp,rotate:mD,rotateDegrees:yD,rotateRadians:uD,rotateMatrix:ap,rotateQuat:hD,rotateWorld:rp,rotateWorldDegrees:lp,rotateWorldRadians:mp,rotateWorldMatrix:yp,rotateWorldQuat:up,rotateLocal:hp,rotateLocalDegrees:cp,rotateLocalRadians:pp,rotateLocalMatrix:dp,rotateLocalQuat:_p,rotateObject:gp,rotateObjectDegrees:fp,rotateObjectRadians:Tp,rotateObjectMatrix:Pp,rotateObjectQuat:Cp,rotateAxis:cD,rotateAxisDegrees:pD,rotateAxisRadians:dD,rotateAxisWorld:bp,rotateAxisWorldDegrees:Sp,rotateAxisWorldRadians:vp,rotateAxisLocal:xp,rotateAxisLocalDegrees:Mp,rotateAxisLocalRadians:Dp,rotateAxisObject:Ep,rotateAxisObjectDegrees:Ap,rotateAxisObjectRadians:Rp,rotateAround:_D,rotateAroundDegrees:gD,rotateAroundRadians:fD,rotateAroundMatrix:Vp,rotateAroundQuat:TD,rotateAroundWorld:Op,rotateAroundWorldDegrees:Ip,rotateAroundWorldRadians:Bp,rotateAroundWorldMatrix:Lp,rotateAroundWorldQuat:Hp,rotateAroundLocal:kp,rotateAroundLocalDegrees:Fp,rotateAroundLocalRadians:wp,rotateAroundLocalMatrix:jp,rotateAroundLocalQuat:zp,rotateAroundObject:Gp,rotateAroundObjectDegrees:Np,rotateAroundObjectRadians:Up,rotateAroundObjectMatrix:Wp,rotateAroundObjectQuat:Qp,rotateAroundAxis:PD,rotateAroundAxisDegrees:CD,rotateAroundAxisRadians:bD,rotateAroundAxisWorld:qp,rotateAroundAxisWorldDegrees:Xp,rotateAroundAxisWorldRadians:Kp,rotateAroundAxisLocal:Jp,rotateAroundAxisLocalDegrees:Zp,rotateAroundAxisLocalRadians:Yp,rotateAroundAxisObject:$p,rotateAroundAxisObjectDegrees:ed,rotateAroundAxisObjectRadians:td,scaleObject:id,lookAt:nd,lookAtWorld:od,lookAtLocal:sd,lookTo:ad,lookToWorld:rd,lookToLocal:ld,setParent:md,getParent:yd,convertPositionObjectToWorld:ud,convertDirectionObjectToWorld:hd,convertPositionWorldToObject:cd,convertDirectionWorldToObject:pd,convertPositionLocalToWorld:dd,convertDirectionLocalToWorld:_d,convertPositionWorldToLocal:gd,convertDirectionWorldToLocal:fd,convertPositionObjectToLocal:Td,convertDirectionObjectToLocal:Pd,convertPositionLocalToObject:Cd,convertDirectionLocalToObject:bd,convertTransformObjectToWorld:Sd,convertTransformObjectToWorldMatrix:vd,convertTransformObjectToWorldQuat:xd,convertTransformWorldToObject:Md,convertTransformWorldToObjectMatrix:Dd,convertTransformWorldToObjectQuat:Ed,convertTransformLocalToWorld:Ad,convertTransformLocalToWorldMatrix:Rd,convertTransformLocalToWorldQuat:Vd,convertTransformWorldToLocal:Od,convertTransformWorldToLocalMatrix:Id,convertTransformWorldToLocalQuat:Bd,convertTransformObjectToLocal:Ld,convertTransformObjectToLocalMatrix:Hd,convertTransformObjectToLocalQuat:kd,convertTransformLocalToObject:Fd,convertTransformLocalToObjectMatrix:wd,convertTransformLocalToObjectQuat:jd,addComponent:zd,getComponent:SD,getComponentSelf:Gd,getComponentHierarchy:Nd,getComponentHierarchyBreadth:Ud,getComponentHierarchyDepth:Wd,getComponentDescendants:Qd,getComponentDescendantsBreadth:qd,getComponentDescendantsDepth:Xd,getComponentChildren:Kd,getComponents:vD,getComponentsSelf:Jd,getComponentsHierarchy:Zd,getComponentsHierarchyBreadth:Yd,getComponentsHierarchyDepth:$d,getComponentsDescendants:e_,getComponentsDescendantsBreadth:t_,getComponentsDescendantsDepth:i_,getComponentsChildren:n_,setActive:o_,setActiveSelf:s_,setActiveHierarchy:a_,setActiveHierarchyBreadth:r_,setActiveHierarchyDepth:l_,setActiveDescendants:m_,setActiveDescendantsBreadth:y_,setActiveDescendantsDepth:u_,setActiveChildren:h_,hasUniformScale:xD,hasUniformScaleWorld:c_,hasUniformScaleLocal:p_,clone:MD,isCloneable:DD,toString:ED,toStringExtended:AD,toStringCompact:RD,getObjectByName:VD,getObjectByNameHierarchy:d_,getObjectByNameHierarchyBreadth:__,getObjectByNameHierarchyDepth:g_,getObjectByNameDescendants:f_,getObjectByNameDescendantsBreadth:T_,getObjectByNameDescendantsDepth:P_,getObjectByNameChildren:C_,getObjectsByName:OD,getObjectsByNameHierarchy:b_,getObjectsByNameHierarchyBreadth:S_,getObjectsByNameHierarchyDepth:v_,getObjectsByNameDescendants:x_,getObjectsByNameDescendantsBreadth:M_,getObjectsByNameDescendantsDepth:D_,getObjectsByNameChildren:E_,getObjectByID:ID,getObjectByIDHierarchy:A_,getObjectByIDHierarchyBreadth:R_,getObjectByIDHierarchyDepth:V_,getObjectByIDDescendants:O_,getObjectByIDDescendantsBreadth:I_,getObjectByIDDescendantsDepth:B_,getObjectByIDChildren:L_,getHierarchy:H_,getHierarchyBreadth:k_,getHierarchyDepth:F_,getDescendants:w_,getDescendantsBreadth:j_,getDescendantsDepth:z_,getChildren:G_,getSelf:N_,addObject:BD,getName:U_,setName:W_,getEngine:Q_,getID:q_,markDirty:X_,isTransformChanged:K_,equals:LD,destroy:J_,reserveObjects:Z_,reserveObjectsSelf:Y_,reserveObjectsHierarchy:$_,reserveObjectsDescendants:eg,reserveObjectsChildren:tg,getComponentsAmountMap:HD,getComponentsAmountMapSelf:ig,getComponentsAmountMapHierarchy:ng,getComponentsAmountMapDescendants:og,getComponentsAmountMapChildren:sg,getComponentObjects:ag,getComponentsObjects:rg,setActiveObjects:lg,getObjectByNameObjects:mg,getObjectsByNameObjects:yg,getObjectByIDObjects:ug,getObjectsByIDObjects:hg,wrapObject:cg};function or(i,e,t){let n=e.get("object")*i;e.delete("object");let o={};for(let[s,a]of e.entries())o[s]=a*i;t.reserveObjects(n,o)}function kD(i){return c.wrapObject(0,i.engine)}function FD(i){return c.addObject(Z.getRoot(i))}function pg(i){return Z.getObjectsBreadth(i)}function dg(i){return c.getHierarchyBreadth(Z.getRoot(i))}function _g(i){return c.getHierarchyDepth(Z.getRoot(i))}function wD(i,e,t=0){return Z.getComponentBreadth(i,e,t)}function gg(i,e,t=0){return c.getComponentHierarchyBreadth(Z.getRoot(i),e,t)}function fg(i,e,t=0){return c.getComponentHierarchyDepth(Z.getRoot(i),e,t)}function jD(i,e){return Z.getComponentsBreadth(i,e)}function Tg(i,e){return c.getComponentsHierarchyBreadth(Z.getRoot(i),e)}function Pg(i,e){return c.getComponentsHierarchyDepth(Z.getRoot(i),e)}function zD(i,e,t=!1,n=0){return Z.getObjectByNameBreadth(i,e,t,n)}function Cg(i,e,t=!1,n=0){return c.getObjectByNameHierarchyBreadth(Z.getRoot(i),e,t,n)}function bg(i,e,t=!1,n=0){return c.getObjectByNameHierarchyDepth(Z.getRoot(i),e,t,n)}function GD(i,e,t=!1){return Z.getObjectsByNameBreadth(i,e,t)}function Sg(i,e,t=!1){return c.getObjectsByNameHierarchyBreadth(Z.getRoot(i),e,t)}function vg(i,e,t=!1){return c.getObjectsByNameHierarchyDepth(Z.getRoot(i),e,t)}function ND(i,e){return Z.getObjectByIDBreadth(i,e)}function xg(i,e){return c.getObjectByIDHierarchyBreadth(Z.getRoot(i),e)}function Mg(i,e){return c.getObjectByIDHierarchyDepth(Z.getRoot(i),e)}function UD(i){return Z.toStringCompact(i)}function WD(i){return c.toStringCompact(Z.getRoot(i))}function QD(i){return c.toStringExtended(Z.getRoot(i))}function qD(i,e=new Map){return c.getComponentsAmountMap(Z.getRoot(i),e)}var Z={getRoot:kD,addObject:FD,getObjects:pg,getObjectsBreadth:dg,getObjectsDepth:_g,getComponent:wD,getComponentBreadth:gg,getComponentDepth:fg,getComponents:jD,getComponentsBreadth:Tg,getComponentsDepth:Pg,getObjectByName:zD,getObjectByNameBreadth:Cg,getObjectByNameDepth:bg,getObjectsByName:GD,getObjectsByNameBreadth:Sg,getObjectsByNameDepth:vg,getObjectByID:ND,getObjectByIDBreadth:xg,getObjectByIDDepth:Mg,toString:UD,toStringCompact:WD,toStringExtended:QD,getComponentsAmountMap:qD};var al=null,po=[];function Dg(i){i!=null&&(ml(i),Gt()==null&&rl(i))}function Gt(){return al}function rl(i){ul(i)&&(al=i)}function ll(){al=null}function Eg(){return po}function ml(i){yl(i),po.push(i)}function yl(i){let e=po.indexOf(i);e>=0&&(po.splice(e,1),Gt()==i&&ll())}function ul(i){return po.indexOf(i)>=0}function hl(i=Gt()){let e=null;return i!=null&&(e=i.scene),e}function XD(i=Gt()){let e=null,t=hl(i);return t!=null&&(e=Z.getRoot(t)),e}function Ag(i=Gt()){let e=null;return i!=null&&(e=i.physics),e}function Rg(i=Gt()){let e=null;return i!=null&&(e=i.canvas),e}function Vg(i=Gt()){let e=null;return i!=null&&(e=i.wasm),e}function Og(i=Gt()){let e=null;return i!=null&&(e=i.xr),e}var dl={};dt(dl,{getDebugManager:()=>pl,getDebugVisualManager:()=>Hg,hasDebugEnabled:()=>jg,hasDebugManager:()=>Lg,isDebugEnabled:()=>kg,removeDebugEnabled:()=>wg,removeDebugManager:()=>Bg,setDebugEnabled:()=>Fg,setDebugManager:()=>Ig});var sr=new WeakMap,ar=new WeakMap;function pl(i=m.getMainEngine()){return sr.get(i)}function Ig(i,e=m.getMainEngine()){sr.set(e,i)}function Bg(i=m.getMainEngine()){sr.delete(i)}function Lg(i=m.getMainEngine()){return sr.has(i)}function Hg(i=m.getMainEngine()){let e=pl(i);return e!=null?e.getDebugVisualManager():null}function kg(i=m.getMainEngine()){return ar.get(i)}function Fg(i,e=m.getMainEngine()){ar.set(e,i)}function wg(i=m.getMainEngine()){ar.delete(i)}function jg(i=m.getMainEngine()){return ar.has(i)}var _l={};dt(_l,{getCharacterCollisionSystem:()=>zg,hasCharacterCollisionSystem:()=>Ug,removeCharacterCollisionSystem:()=>Ng,setCharacterCollisionSystem:()=>Gg});var rr=new WeakMap;function zg(i=m.getMainEngine()){return rr.get(i)}function Gg(i,e=m.getMainEngine()){rr.set(e,i)}function Ng(i=m.getMainEngine()){rr.delete(i)}function Ug(i=m.getMainEngine()){return rr.has(i)}var gl={};dt(gl,{getGamepad:()=>Zg,getGamepads:()=>Yg,getGamepadsManager:()=>Jg,getHandPose:()=>nf,getHandPoses:()=>of,getHeadPose:()=>tf,getInputManager:()=>qe,getKeyboard:()=>Kg,getLeftGamepad:()=>$g,getLeftHandPose:()=>sf,getLeftTrackedHandPose:()=>mf,getMouse:()=>Xg,getRightGamepad:()=>ef,getRightHandPose:()=>af,getRightTrackedHandPose:()=>yf,getTrackedHandPose:()=>rf,getTrackedHandPoses:()=>lf,hasInputManager:()=>qg,hasPoseForwardFixed:()=>pf,isPoseForwardFixed:()=>uf,removeInputManager:()=>Qg,removePoseForwardFixed:()=>cf,setInputManager:()=>Wg,setPoseForwardFixed:()=>hf});var lr=new WeakMap,mr=new WeakMap;function qe(i=m.getMainEngine()){return lr.get(i)}function Wg(i,e=m.getMainEngine()){lr.set(e,i)}function Qg(i=m.getMainEngine()){lr.delete(i)}function qg(i=m.getMainEngine()){return lr.has(i)}function Xg(i=m.getMainEngine()){let e=qe(i);return e!=null?e.getMouse():null}function Kg(i=m.getMainEngine()){let e=qe(i);return e!=null?e.getKeyboard():null}function Jg(i=m.getMainEngine()){let e=qe(i);return e!=null?e.getGamepadsManager():null}function Zg(i,e=m.getMainEngine()){let t=qe(e);return t!=null?t.getGamepadsManager().getGamepad(i):null}function Yg(i=m.getMainEngine()){let e=qe(i);return e!=null?e.getGamepadsManager().getGamepads():null}function $g(i=m.getMainEngine()){let e=qe(i);return e!=null?e.getGamepadsManager().getLeftGamepad():null}function ef(i=m.getMainEngine()){let e=qe(i);return e!=null?e.getGamepadsManager().getRightGamepad():null}function tf(i=m.getMainEngine()){let e=qe(i);return e!=null?e.getHeadPose():null}function nf(i,e=m.getMainEngine()){let t=qe(e);return t!=null?t.getHandPose(i):null}function of(i=m.getMainEngine()){let e=qe(i);return e!=null?e.getHandPoses():null}function sf(i=m.getMainEngine()){let e=qe(i);return e!=null?e.getLeftHandPose():null}function af(i=m.getMainEngine()){let e=qe(i);return e!=null?e.getRightHandPose():null}function rf(i,e=m.getMainEngine()){let t=qe(e);return t!=null?t.getTrackedHandPose(i):null}function lf(i=m.getMainEngine()){let e=qe(i);return e!=null?e.getTrackedHandPoses():null}function mf(i=m.getMainEngine()){let e=qe(i);return e!=null?e.getLeftTrackedHandPose():null}function yf(i=m.getMainEngine()){let e=qe(i);return e!=null?e.getRightTrackedHandPose():null}function uf(i=m.getMainEngine()){return mr.get(i)}function hf(i,e=m.getMainEngine()){mr.set(e,i)}function cf(i=m.getMainEngine()){mr.delete(i)}function pf(i=m.getMainEngine()){return mr.has(i)}var fl={};dt(fl,{hasToolEnabled:()=>ff,isToolEnabled:()=>df,removeToolEnabled:()=>gf,setToolEnabled:()=>_f});var yr=new WeakMap;function df(i=m.getMainEngine()){return yr.get(i)}function _f(i,e=m.getMainEngine()){yr.set(e,i)}function gf(i=m.getMainEngine()){yr.delete(i)}function ff(i=m.getMainEngine()){return yr.has(i)}var Tl={};dt(Tl,{getConsoleVR:()=>Tf,hasConsoleVR:()=>bf,removeConsoleVR:()=>Cf,setConsoleVR:()=>Pf});var ur=new WeakMap;function Tf(i=m.getMainEngine()){return ur.get(i)}function Pf(i,e=m.getMainEngine()){ur.set(e,i)}function Cf(i=m.getMainEngine()){ur.delete(i)}function bf(i=m.getMainEngine()){return ur.has(i)}var Pl={};dt(Pl,{getEasyTuneTarget:()=>Df,getEasyTuneVariables:()=>Sf,hasEasyTuneTarget:()=>Rf,hasEasyTuneVariables:()=>Mf,removeEasyTuneTarget:()=>Af,removeEasyTuneVariables:()=>xf,setEasyTuneTarget:()=>Ef,setEasyTuneVariables:()=>vf});var hr=new WeakMap,cr=new WeakMap;function Sf(i=m.getMainEngine()){return hr.get(i)}function vf(i,e=m.getMainEngine()){hr.set(e,i)}function xf(i=m.getMainEngine()){hr.delete(i)}function Mf(i=m.getMainEngine()){return hr.has(i)}function Df(i=m.getMainEngine()){return cr.get(i)}function Ef(i,e=m.getMainEngine()){cr.set(e,i)}function Af(i=m.getMainEngine()){cr.delete(i)}function Rf(i=m.getMainEngine()){return cr.has(i)}var Cl={};dt(Cl,{getDefaultMaterials:()=>Lf,getDefaultMeshes:()=>Bf,getDefaultResources:()=>dr,hasDefaultResources:()=>If,removeDefaultResources:()=>Of,setDefaultResources:()=>Vf});var pr=new WeakMap;function dr(i=m.getMainEngine()){return pr.get(i)}function Vf(i,e=m.getMainEngine()){pr.set(e,i)}function Of(i=m.getMainEngine()){pr.delete(i)}function If(i=m.getMainEngine()){return pr.has(i)}function Bf(i=m.getMainEngine()){let e=dr(i);return e!=null?e.myMeshes:null}function Lf(i=m.getMainEngine()){let e=dr(i);return e!=null?e.myMaterials:null}var Sl={};dt(Sl,{getPlayerObjects:()=>wf,getSceneObjects:()=>bl,hasSceneObjects:()=>Ff,removeSceneObjects:()=>kf,setSceneObjects:()=>Hf});var _r=new WeakMap;function bl(i=m.getMainEngine()){return _r.get(i)}function Hf(i,e=m.getMainEngine()){_r.set(e,i)}function kf(i=m.getMainEngine()){_r.delete(i)}function Ff(i=m.getMainEngine()){return _r.has(i)}function wf(i=m.getMainEngine()){let e=bl(i);return e!=null?e.myPlayerObjects:null}var m={...cl,...Sl,...Cl,...el,...ol,...dl,...il,...nl,..._l,...gl,...fl,...Tl,...Pl};import{MeshComponent as _T,TextComponent as gE}from"@wonderlandengine/api";import{Mesh as Tr,MeshAttribute as Pe,MeshIndexType as Pr}from"@wonderlandengine/api";import{vec2 as Ii}from"gl-matrix";function vl(i,e){let t=Ii.create();return i!==void 0&&jf(t,i,e),t}function jf(i,e,t){return t===void 0?Ii.set(i,e,e):Ii.set(i,e,t),i}function KD(i){return Ii.length(i)}function JD(i,e=vl()){return Ii.normalize(e,i),e}function ZD(i,e){return Ii.copy(e,i),e}function YD(i,e=vl()){return nt.copy(i,e),e}function $D(i){return Ii.zero(i),i}function eE(i,e=0){return nt.length(i)<=e}var nt={create:vl,set:jf,length:KD,normalize:JD,copy:ZD,clone:YD,zero:$D,isZero:eE};import{vec4 as gr}from"gl-matrix";function zf(i,e,t,n){let o=gr.create();return i!==void 0&&Gf(o,i,e,t,n),o}function Gf(i,e,t,n,o){return t===void 0?gr.set(i,e,e,e,e):gr.set(i,e,t,n,o),i}function tE(i,e){return gr.copy(e,i),e}function iE(i,e=zf()){return Nt.copy(i,e),e}var Nt={create:zf,set:Gf,copy:tE,clone:iE};function nE(i,e=null){e=fn(i,e);for(let t=0;t<e.length;t++)e[t]=0;return e}function oE(i,e=0){let t=!0;for(let n=0;n<i.length&&t;n++)t=t&&Math.abs(i[n])<=e;return t}function sE(i,e,t=null){t=fn(i,t);for(let n=0;n<t.length;n++)t[n]=t[n]*e;return t}function Nf(i,e=null){e=fn(i,e);for(let t=0;t<e.length;t++)e[t]=Math.round(e[t]);return e}function Uf(i,e=null){e=fn(i,e);for(let t=0;t<e.length;t++)e[t]=Math.floor(e[t]);return e}function Wf(i,e=null){e=fn(i,e);for(let t=0;t<e.length;t++)e[t]=Math.ceil(e[t]);return e}function aE(i,e,t,n=null){n=fn(i,n);let o=e??-Number.MAX_VALUE,s=t??Number.MAX_VALUE,a=Math.min(o,s),l=Math.max(o,s);for(let h=0;h<n.length;h++)n[h]=B.clamp(n[h],a,l);return n}function rE(i,e,t=0){let n=i.length==e.length;for(let o=0;o<i.length&&n;o++)n=n&&Math.abs(i[o]-e[o])<=t;return n}function lE(i,e=null){return fr(i,e)}function mE(i,e=4){let t=fr(i,e);console.log(t)}function yE(i,e=4){let t=fr(i,e);console.error(t)}function uE(i,e=4){let t=fr(i,e);console.warn(t)}var gt={zero:nE,isZero:oE,scale:sE,round:Nf,floor:Uf,ceil:Wf,clamp:aE,equals:rE,toString:lE,log:mE,error:yE,warn:uE};function fr(i,e){let t="[";for(let n=0;n<i.length;n++)n!=0&&(t=t.concat(", ")),e!=null?t=t.concat(i[n].toFixed(e)):t=t.concat(i[n].toString());return t=t.concat("]"),t}function fn(i,e){return e==null?e=X.clone(i):e!=i&&X.copy(i,e),e}function Qf(i){let e=[];e.push(i);let t=Object.getPrototypeOf(i);for(;t!=null;)X.pushUnique(e,t),t=Object.getPrototypeOf(t);let n=[i];for(;n.length>0;){let o=n.shift();o!=null&&(X.pushUnique(e,o),X.pushUnique(n,Object.getPrototypeOf(o)),X.pushUnique(n,o.prototype))}return e}function qf(i){let e=[],t=Y.getObjectPrototypes(i);for(let n of t)if(n!=null){let o=Object.getOwnPropertyNames(n);for(let s of o)X.pushUnique(e,s)}return e}function Xf(i,e){let t=null,n=Y.getObjectPropertyOwnParent(i,e);return n!=null&&(t=Object.getOwnPropertyDescriptor(n,e)),t}function Kf(i,e){let t,n=Y.getObjectPropertyDescriptor(i,e);return n!=null&&(n.get!=null?t=n.get.bind(i)():t=n.value),t}function Jf(i,e,t){let n=Y.getObjectPropertyDescriptor(e,t),o=!1;if(n!=null&&n.set!=null&&(o=!0,n.set.bind(e)(i)),!o){let s=Y.getObjectPropertyOwnParent(e,t);s==null&&(s=e),Object.defineProperty(s,t,{value:i})}}function Zf(i,e){let t=null,n=Y.getObjectPropertyOwnParents(i,e);return n.length>0&&(t=n[0]),t}function Yf(i,e){let t=[],n=Y.getObjectPrototypes(i);for(let o of n){let s=Object.getOwnPropertyNames(o);X.hasEqual(s,e)&&t.push(o)}return t}function $f(i,e=m.getWindow()){let t=null,n=Y.getObjectNameFromPath(i);return n!=null&&(t=Y.getObjectProperty(Y.getObjectParentFromPath(i,e),n)),t}function eT(i){let e=null;if(i!=null){let t=i.split(".");t.length>0&&(e=t[t.length-1])}return e}function tT(i,e=m.getWindow()){let t=i.split("."),n=e;for(let o=0;o<t.length-1;o++)n=Y.getObjectProperty(n,t[o]);return n}function iT(i,e,t,n=!0,o=!1,s=!1){let a=!1;try{let l=Y.getObjectPropertyOwnParent(e,t);if(l!=null){let h=Object.getOwnPropertyDescriptor(l,t);if(h!=null){let _=Y.getObjectProperty(l,t);Y.copyObjectProperties(_,i,!0,o,s);let y=e;n&&(y=l),Object.defineProperty(y,t,{value:i,enumerable:h.enumerable,writable:h.writable,configurable:h.configurable}),a=!0}else Object.defineProperty(e,t,{value:i}),a=!0}else Object.defineProperty(e,t,{value:i}),a=!0}catch{s&&console.error("Property:",t,"of:",e,"can't be overwritten.")}return a}function nT(i,e,t=!1,n=!1,o=!1){if(i!=null){t&&Y.cleanObjectProperties(e),Object.setPrototypeOf(e,Object.getPrototypeOf(i));let s=Object.getOwnPropertyNames(i);for(let a of s)try{let l=Object.getOwnPropertyDescriptor(i,a);Object.defineProperty(e,a,{value:l.value,enumerable:l.enumerable,writable:l.writable,configurable:l.configurable})}catch{o&&console.error("Property:",a,"of:",i.name,"can't be overwritten.")}n&&hE(i,e)}}function oT(i){let e=Object.getOwnPropertyNames(i);X.pushUnique(e,"__proto__");for(let t of e){try{Object.defineProperty(i,t,{value:void 0})}catch{}try{delete i[t]}catch{}}Object.setPrototypeOf(i,null)}function sT(i,e){let t=!1,n=Y.getObjectPropertyDescriptor(i,e);return n!=null&&(n.get!=null||n.set!=null)&&(t=!0),t}function aT(i,e){let t=!1,n=Y.getObjectProperty(i,e);return n!=null&&(t=Y.isFunction(n)),t}function rT(i,e){let t=!1,n=Y.getObjectProperty(i,e);return n!=null&&(t=Y.isClass(n)),t}function lT(i,e){let t=!1,n=Y.getObjectProperty(i,e);return n!=null&&(t=Y.isObject(n)),t}function mT(i){return typeof i=="function"&&!Y.isClass(i)}var yT=function(){let i=new RegExp("^class");return function(t){return typeof t=="function"&&t.prototype!=null&&typeof t.prototype.constructor=="function"&&t.toString!=null&&typeof t.toString=="function"&&t.toString()?.match(i)!=null}}();function uT(i){return typeof i=="object"}var Y={getObjectPrototypes:Qf,getObjectPropertyNames:qf,getObjectPropertyDescriptor:Xf,getObjectProperty:Kf,setObjectProperty:Jf,getObjectPropertyOwnParent:Zf,getObjectPropertyOwnParents:Yf,getObjectFromPath:$f,getObjectNameFromPath:eT,getObjectParentFromPath:tT,overwriteObjectProperty:iT,copyObjectProperties:nT,cleanObjectProperties:oT,doesObjectPropertyUseAccessors:sT,isFunctionByName:aT,isClassByName:rT,isObjectByName:lT,isFunction:mT,isClass:yT,isObject:uT};function hE(i,e){try{if(typeof e=="function"&&typeof i=="function"){let t=["toString","toLocaleString","valueOf"];for(let n of t){let o=Y.getObjectPropertyDescriptor(i,n);if(o!=null&&o.value!=null&&o.value==Object[n]){let s=Object[n].bind(i)(),a=function(){return s};Y.overwriteObjectProperty(a,e,n,!1,!1)}}}}catch{}}function hT(i,e,t=!0,n=!0,o=!0,s=!0,a=!1,l=null,h=[]){let _=Object.getOwnPropertyNames(i);for(let y of _){if(h.includes(y))continue;let r=t,u=n,g=o;if(s){let S=Object.getOwnPropertyDescriptor(e,y);S!=null&&(r=S.enumerable,u=S.writable,g=S.configurable)}let P=y;l!=null&&(P.length>0&&P[0]==P[0].toUpperCase()?P=l.toUpperCase()+P:P=l+P);let C=Object.getOwnPropertyDescriptor(i,y);if(C!=null&&(C.get!=null||C.set!=null))Object.defineProperty(e,P,{get:C.get,set:C.set,enumerable:r,configurable:g});else{let S=i[y];if(a&&Y.isFunction(S)){let M=i[y];S=function(){return M(this,...arguments)},Object.defineProperty(S,"name",{value:P})}Object.defineProperty(e,P,{value:S,enumerable:r,writable:u,configurable:g})}}}var xe={injectProperties:hT};function xl(){cT()}function Ce(i,e){return nt.create(i,e)}function p(i,e,t){return d.create(i,e,t)}function F(i,e,t,n){return Nt.create(i,e,t,n)}function w(i,e,t,n){return T.create(i,e,t,n)}function G(i,e,t,n,o,s,a,l){return V.create(i,e,t,n,o,s,a,l)}function cE(i,e,t,n,o,s,a,l,h){return K.create(i,e,t,n,o,s,a,l,h)}function be(i,e,t,n,o,s,a,l,h,_,y,r,u,g,P,C){return R.create(i,e,t,n,o,s,a,l,h,_,y,r,u,g,P,C)}function cT(){let i={};i.pp_first=function(){return X.first(this)},i.pp_last=function(){return X.last(this)},i.pp_has=function(r){return X.has(this,r)},i.pp_hasEqual=function(r,u=null){return X.hasEqual(this,r,u)},i.pp_find=function(r){return X.find(this,r)},i.pp_findIndex=function(r){return X.findIndex(this,r)},i.pp_findAll=function(r){return X.findAll(this,r)},i.pp_findAllIndexes=function(r){return X.findAllIndexes(this,r)},i.pp_findEqual=function(r,u=null){return X.findEqual(this,r,u)},i.pp_findAllEqual=function(r,u=null){return X.findAllEqual(this,r,u)},i.pp_findIndexEqual=function(r,u=null){return X.findIndexEqual(this,r,u)},i.pp_findAllIndexesEqual=function(r,u=null){return X.findAllIndexesEqual(this,r,u)},i.pp_removeIndex=function(r){return X.removeIndex(this,r)},i.pp_removeAllIndexes=function(r){return X.removeAllIndexes(this,r)},i.pp_remove=function(r){return X.remove(this,r)},i.pp_removeAll=function(r){return X.removeAll(this,r)},i.pp_removeEqual=function(r,u=null){return X.removeEqual(this,r,u)},i.pp_removeAllEqual=function(r,u=null){return X.removeAllEqual(this,r,u)},i.pp_pushUnique=function(r,u=null){return X.pushUnique(this,r,u)},i.pp_unshiftUnique=function(r,u=null){return X.unshiftUnique(this,r,u)},i.pp_copy=function(r,u=null){return X.copy(r,this,u)},i.pp_clone=function(r=null){return X.clone(this,r)},i.pp_equals=function(r,u=null){return X.equals(this,r,u)},i.pp_clear=function(){return X.clear(this)};let e={};e.vec_zero=function(r=null){return gt.zero(this,r)},e.vec_isZero=function(r=0){return gt.isZero(this,r)},e.vec_scale=function(r,u=null){return gt.scale(this,r,u)},e.vec_round=function(r=null){return gt.round(this,r)},e.vec_floor=function(r=null){return gt.floor(this,r)},e.vec_ceil=function(r=null){return gt.ceil(this,r)},e.vec_clamp=function(r,u,g=null){return gt.clamp(this,r,u,g)},e.vec_equals=function(r,u=0){return gt.equals(this,r,u)},e.vec_toString=function(r=null){return gt.toString(this,r)},e.vec_log=function(r=4){return gt.log(this,r)},e.vec_error=function(r=4){return gt.error(this,r)},e.vec_warn=function(r=4){return gt.warn(this,r)};let t={};t.vec2_set=function(r,u){return nt.set(this,r,u)},t.vec2_length=function(){return nt.length(this)},t.vec2_normalize=function(r=nt.create()){return nt.normalize(this,r)},t.vec2_copy=function(r){return nt.copy(r,this)},t.vec2_clone=function(r=nt.create()){return nt.clone(this,r)},t.vec2_zero=function(){return nt.zero(this)},t.vec2_isZero=function(r=0){return nt.isZero(this,r)};let n={};n.vec3_set=function(r,u,g){return d.set(this,r,u,g)},n.vec3_normalize=function(r=d.create()){return d.normalize(this,r)},n.vec3_copy=function(r){return d.copy(r,this)},n.vec3_clone=function(r=d.create()){return d.clone(this,r)},n.vec3_zero=function(){return d.zero(this)},n.vec3_angle=function(r){return d.angle(this,r)},n.vec3_angleDegrees=function(r){return d.angleDegrees(this,r)},n.vec3_angleRadians=function(r){return d.angleRadians(this,r)},n.vec3_equals=function(r,u=0){return d.equals(this,r,u)},n.vec3_length=function(){return d.length(this)},n.vec3_lengthSquared=function(){return d.lengthSquared(this)},n.vec3_distance=function(r){return d.distance(this,r)},n.vec3_distanceSquared=function(r){return d.distanceSquared(this,r)},n.vec3_add=function(r,u=d.create()){return d.add(this,r,u)},n.vec3_sub=function(r,u=d.create()){return d.sub(this,r,u)},n.vec3_mul=function(r,u=d.create()){return d.mul(this,r,u)},n.vec3_div=function(r,u=d.create()){return d.div(this,r,u)},n.vec3_scale=function(r,u=d.create()){return d.scale(this,r,u)},n.vec3_dot=function(r){return d.dot(this,r)},n.vec3_negate=function(r=d.create()){return d.negate(this,r)},n.vec3_cross=function(r,u=d.create()){return d.cross(this,r,u)},n.vec3_transformQuat=function(r,u=d.create()){return d.transformQuat(this,r,u)},n.vec3_transformMat3=function(r,u=d.create()){return d.transformMat3(this,r,u)},n.vec3_transformMat4=function(r,u=d.create()){return d.transformMat4(this,r,u)},n.vec3_lengthSigned=function(r){return d.lengthSigned(this,r)},n.vec3_angleSigned=function(r,u){return d.angleSigned(this,r,u)},n.vec3_angleSignedDegrees=function(r,u){return d.angleSignedDegrees(this,r,u)},n.vec3_angleSignedRadians=function(r,u){return d.angleSignedRadians(this,r,u)},n.vec3_anglePivoted=function(r,u){return d.anglePivoted(this,r,u)},n.vec3_anglePivotedDegrees=function(r,u){return d.anglePivotedDegrees(this,r,u)},n.vec3_anglePivotedRadians=function(r,u){return d.anglePivotedRadians(this,r,u)},n.vec3_anglePivotedSigned=function(r,u){return d.anglePivotedSigned(this,r,u)},n.vec3_anglePivotedSignedDegrees=function(r,u){return d.anglePivotedSignedDegrees(this,r,u)},n.vec3_anglePivotedSignedRadians=function(r,u){return d.anglePivotedSignedRadians(this,r,u)},n.vec3_toRadians=function(r=d.create()){return d.toRadians(this,r)},n.vec3_toDegrees=function(r=d.create()){return d.toDegrees(this,r)},n.vec3_toQuat=function(r){return d.toQuat(this,r)},n.vec3_radiansToQuat=function(r=T.create()){return d.radiansToQuat(this,r)},n.vec3_degreesToQuat=function(r=T.create()){return d.degreesToQuat(this,r)},n.vec3_isNormalized=function(r=B.EPSILON){return d.isNormalized(this,r)},n.vec3_isZero=function(r=0){return d.isZero(this,r)},n.vec3_componentAlongAxis=function(r,u=d.create()){return d.componentAlongAxis(this,r,u)},n.vec3_valueAlongAxis=function(r){return d.valueAlongAxis(this,r)},n.vec3_removeComponentAlongAxis=function(r,u=d.create()){return d.removeComponentAlongAxis(this,r,u)},n.vec3_copyComponentAlongAxis=function(r,u,g=d.create()){return d.copyComponentAlongAxis(r,this,u,g)},n.vec3_isConcordant=function(r){return d.isConcordant(this,r)},n.vec3_isFartherAlongAxis=function(r,u){return d.isFartherAlongAxis(this,r,u)},n.vec3_isToTheRight=function(r,u){return d.isToTheRight(this,r,u)},n.vec3_signTo=function(r,u,g=1){return d.signTo(this,r,u,g)},n.vec3_projectOnAxis=function(r,u=d.create()){return d.projectOnAxis(this,r,u)},n.vec3_projectOnAxisAlongAxis=function(r,u,g=d.create()){return d.projectOnAxisAlongAxis(this,r,u,g)},n.vec3_projectOnPlane=function(r,u=d.create()){return d.projectOnPlane(this,r,u)},n.vec3_projectOnPlaneAlongAxis=function(r,u,g=d.create()){return d.projectOnPlaneAlongAxis(this,r,u,g)},n.vec3_isOnAxis=function(r){return d.isOnAxis(this,r)},n.vec3_isOnPlane=function(r){return d.isOnPlane(this,r)},n.vec3_rotate=function(r,u){return d.rotate(this,r,u)},n.vec3_rotateDegrees=function(r,u){return d.rotateDegrees(this,r,u)},n.vec3_rotateRadians=function(r,u){return d.rotateRadians(this,r,u)},n.vec3_rotateQuat=function(r,u){return d.rotateQuat(this,r,u)},n.vec3_rotateAxis=function(r,u,g){return d.rotateAxis(this,r,u,g)},n.vec3_rotateAxisDegrees=function(r,u,g){return d.rotateAxisDegrees(this,r,u,g)},n.vec3_rotateAxisRadians=function(r,u,g){return d.rotateAxisRadians(this,r,u,g)},n.vec3_rotateAround=function(r,u,g){return d.rotateAround(this,r,u,g)},n.vec3_rotateAroundDegrees=function(r,u,g=d.create()){return d.rotateAroundDegrees(this,r,u,g)},n.vec3_rotateAroundRadians=function(r,u,g=d.create()){return d.rotateAroundRadians(this,r,u,g)},n.vec3_rotateAroundQuat=function(r,u,g=d.create()){return d.rotateAroundQuat(this,r,u,g)},n.vec3_rotateAroundAxis=function(r,u,g,P){return d.rotateAroundAxis(this,r,u,g,P)},n.vec3_rotateAroundAxisDegrees=function(r,u,g,P){return d.rotateAroundAxisDegrees(this,r,u,g,P)},n.vec3_rotateAroundAxisRadians=function(r,u,g,P=d.create()){return d.rotateAroundAxisRadians(this,r,u,g,P)},n.vec3_convertPositionToWorld=function(r,u){return d.convertPositionToWorld(this,r,u)},n.vec3_convertPositionToLocal=function(r,u){return d.convertPositionToLocal(this,r,u)},n.vec3_convertPositionToWorldMatrix=function(r,u=d.create()){return d.convertPositionToWorldMatrix(this,r,u)},n.vec3_convertPositionToLocalMatrix=function(r,u=d.create()){return d.convertPositionToLocalMatrix(this,r,u)},n.vec3_convertPositionToWorldQuat=function(r,u=d.create()){return d.convertPositionToWorldQuat(this,r,u)},n.vec3_convertPositionToLocalQuat=function(r,u=d.create()){return d.convertPositionToLocalQuat(this,r,u)},n.vec3_convertDirectionToWorld=function(r,u){return d.convertDirectionToWorld(this,r,u)},n.vec3_convertDirectionToLocal=function(r,u){return d.convertDirectionToLocal(this,r,u)},n.vec3_convertDirectionToWorldMatrix=function(r,u=d.create()){return d.convertDirectionToWorldMatrix(this,r,u)},n.vec3_convertDirectionToLocalMatrix=function(r,u=d.create()){return d.convertDirectionToLocalMatrix(this,r,u)},n.vec3_convertDirectionToWorldQuat=function(r,u=d.create()){return d.convertDirectionToWorldQuat(this,r,u)},n.vec3_convertDirectionToLocalQuat=function(r,u=d.create()){return d.convertDirectionToLocalQuat(this,r,u)},n.vec3_addRotation=function(r,u){return d.addRotation(this,r,u)},n.vec3_addRotationDegrees=function(r,u){return d.addRotationDegrees(this,r,u)},n.vec3_addRotationRadians=function(r,u){return d.addRotationRadians(this,r,u)},n.vec3_addRotationQuat=function(r,u){return d.addRotationQuat(this,r,u)},n.vec3_degreesAddRotation=function(r,u){return d.degreesAddRotation(this,r,u)},n.vec3_degreesAddRotationDegrees=function(r,u=d.create()){return d.degreesAddRotationDegrees(this,r,u)},n.vec3_degreesAddRotationRadians=function(r,u=d.create()){return d.degreesAddRotationRadians(this,r,u)},n.vec3_degreesAddRotationQuat=function(r,u=d.create()){return d.degreesAddRotationQuat(this,r,u)},n.vec3_radiansAddRotation=function(r,u){return d.radiansAddRotation(this,r,u)},n.vec3_radiansAddRotationDegrees=function(r,u=d.create()){return d.radiansAddRotationDegrees(this,r,u)},n.vec3_radiansAddRotationRadians=function(r,u=d.create()){return d.radiansAddRotationRadians(this,r,u)},n.vec3_radiansAddRotationQuat=function(r,u=d.create()){return d.radiansAddRotationQuat(this,r,u)},n.vec3_toMatrix=function(r=K.create()){return d.toMatrix(this,r)},n.vec3_degreesToMatrix=function(r=K.create()){return d.degreesToMatrix(this,r)},n.vec3_radiansToMatrix=function(r=K.create()){return d.radiansToMatrix(this,r)},n.vec3_rotationTo=function(r,u){return d.rotationTo(this,r,u)},n.vec3_rotationToDegrees=function(r,u=d.create()){return d.rotationToDegrees(this,r,u)},n.vec3_rotationToRadians=function(r,u=d.create()){return d.rotationToRadians(this,r,u)},n.vec3_rotationToQuat=function(r,u=T.create()){return d.rotationToQuat(this,r,u)},n.vec3_rotationToPivoted=function(r,u,g){return d.rotationToPivoted(this,r,u,g)},n.vec3_rotationToPivotedDegrees=function(r,u,g=d.create()){return d.rotationToPivotedDegrees(this,r,u,g)},n.vec3_rotationToPivotedRadians=function(r,u,g=d.create()){return d.rotationToPivotedRadians(this,r,u,g)},n.vec3_rotationToPivotedQuat=function(r,u,g=T.create()){return d.rotationToPivotedQuat(this,r,u,g)},n.vec3_lerp=function(r,u,g=d.create()){return d.lerp(this,r,u,g)},n.vec3_interpolate=function(r,u,g=ue.linear,P=d.create()){return d.interpolate(this,r,u,g,P)},n.vec3_perpendicularRandom=function(r=d.create()){return d.perpendicularRandom(this,r)};let o={};o.vec4_set=function(r,u,g,P){return Nt.set(this,r,u,g,P)},o.vec4_copy=function(r){return Nt.copy(r,this)},o.vec4_clone=function(r=Nt.create()){return Nt.clone(this,r)};let s={};s.quat_set=function(r,u,g,P){return T.set(this,r,u,g,P)},s.quat_normalize=function(r=T.create()){return T.normalize(this,r)},s.quat_copy=function(r){return T.copy(r,this)},s.quat_clone=function(r=T.create()){return T.clone(this,r)},s.quat_identity=function(){return T.identity(this)},s.quat_length=function(){return T.length(this)},s.quat_lengthSquared=function(){return T.lengthSquared(this)},s.quat_invert=function(r=T.create()){return T.invert(this,r)},s.quat_conjugate=function(r=T.create()){return T.conjugate(this,r)},s.quat_mul=function(r,u=T.create()){return T.mul(this,r,u)},s.quat_getAxis=function(r=d.create()){return T.getAxis(this,r)},s.quat_getAngle=function(){return T.getAngle(this)},s.quat_getAngleDegrees=function(){return T.getAngleDegrees(this)},s.quat_getAngleRadians=function(){return T.getAngleRadians(this)},s.quat_getAxisScaled=function(r=d.create()){return T.getAxisScaled(this,r)},s.quat_getAxisScaledDegrees=function(r=d.create()){return T.getAxisScaledDegrees(this,r)},s.quat_getAxisScaledRadians=function(r=d.create()){return T.getAxisScaledRadians(this,r)},s.quat_getAxes=function(r=[d.create(),d.create(),d.create()]){return T.getAxes(this,r)},s.quat_getForward=function(r=d.create()){return T.getForward(this,r)},s.quat_getBackward=function(r){return T.getBackward(this,r)},s.quat_getLeft=function(r=d.create()){return T.getLeft(this,r)},s.quat_getRight=function(r){return T.getRight(this,r)},s.quat_getUp=function(r=d.create()){return T.getUp(this,r)},s.quat_getDown=function(r){return T.getDown(this,r)},s.quat_setAxes=function(r,u,g){return T.setAxes(this,r,u,g)},s.quat_setForward=function(r,u=null,g=null){return T.setForward(this,r,u,g)},s.quat_setBackward=function(r,u=null,g=null){return T.setBackward(this,r,u,g)},s.quat_setUp=function(r,u=null,g=null){return T.setUp(this,r,u,g)},s.quat_setDown=function(r,u=null,g=null){return T.setDown(this,r,u,g)},s.quat_setLeft=function(r,u=null,g=null){return T.setLeft(this,r,u,g)},s.quat_setRight=function(r,u=null,g=null){return T.setRight(this,r,u,g)},s.quat_toWorld=function(r,u=T.create()){return T.toWorld(this,r,u)},s.quat_toLocal=function(r,u=T.create()){return T.toLocal(this,r,u)},s.quat_fromAxis=function(r,u){return T.fromAxis(r,u,this)},s.quat_fromAxisDegrees=function(r,u){return T.fromAxisDegrees(r,u,this)},s.quat_fromAxisRadians=function(r,u){return T.fromAxisRadians(r,u,this)},s.quat_fromAxes=function(r,u,g){return T.fromAxes(r,u,g,this)},s.quat_fromRadians=function(r){return T.fromRadians(r,this)},s.quat_fromDegrees=function(r){return T.fromDegrees(r,this)},s.quat_toRadians=function(r=d.create()){return T.toRadians(this,r)},s.quat_toDegrees=function(r=d.create()){return T.toDegrees(this,r)},s.quat_isNormalized=function(r=B.EPSILON){return T.isNormalized(this,r)},s.quat_addRotation=function(r,u){return T.addRotation(this,r,u)},s.quat_addRotationDegrees=function(r,u){return T.addRotationDegrees(this,r,u)},s.quat_addRotationRadians=function(r,u){return T.addRotationRadians(this,r,u)},s.quat_addRotationQuat=function(r,u=T.create()){return T.addRotationQuat(this,r,u)},s.quat_subRotation=function(r,u){return T.subRotation(this,r,u)},s.quat_subRotationDegrees=function(r,u){return T.subRotationDegrees(this,r,u)},s.quat_subRotationRadians=function(r,u){return T.subRotationRadians(this,r,u)},s.quat_subRotationQuat=function(r,u=T.create()){return T.subRotationQuat(this,r,u)},s.quat_rotationTo=function(r,u){return T.rotationTo(this,r,u)},s.quat_rotationToDegrees=function(r,u){return T.rotationToDegrees(this,r,u)},s.quat_rotationToRadians=function(r,u){return T.rotationToRadians(this,r,u)},s.quat_rotationToQuat=function(r,u){return T.rotationToQuat(this,r,u)},s.quat_rotationAroundAxis=function(r,u){return T.rotationAroundAxis(this,r,u)},s.quat_rotationAroundAxisDegrees=function(r,u=d.create()){return T.rotationAroundAxisDegrees(this,r,u)},s.quat_rotationAroundAxisRadians=function(r,u=d.create()){return T.rotationAroundAxisRadians(this,r,u)},s.quat_rotationAroundAxisQuat=function(r,u=T.create()){return T.rotationAroundAxisQuat(this,r,u)},s.quat_getTwist=function(r,u=T.create()){return T.getTwist(this,r,u)},s.quat_getSwing=function(r,u=T.create()){return T.getSwing(this,r,u)},s.quat_getSwingFromTwist=function(r,u=T.create()){return T.getSwingFromTwist(this,r,u)},s.quat_getTwistFromSwing=function(r,u=T.create()){return T.getTwistFromSwing(this,r,u)},s.quat_fromTwistSwing=function(r,u){return T.fromTwistSwing(r,u,this)},s.quat_toMatrix=function(r=K.create()){return T.toMatrix(this,r)},s.quat_rotate=function(r,u){return T.rotate(this,r,u)},s.quat_rotateDegrees=function(r,u){return T.rotateDegrees(this,r,u)},s.quat_rotateRadians=function(r,u){return T.rotateRadians(this,r,u)},s.quat_rotateQuat=function(r,u){return T.rotateQuat(this,r,u)},s.quat_rotateAxis=function(r,u,g){return T.rotateAxis(this,r,u,g)},s.quat_rotateAxisDegrees=function(r,u,g){return T.rotateAxisDegrees(this,r,u,g)},s.quat_rotateAxisRadians=function(r,u,g){return T.rotateAxisRadians(this,r,u,g)},s.quat_lerp=function(r,u,g=T.create()){return T.lerp(this,r,u,g)},s.quat_interpolate=function(r,u,g=ue.linear,P=T.create()){return T.interpolate(this,r,u,g,P)},s.quat_slerp=function(r,u,g=T.create()){return T.slerp(this,r,u,g)},s.quat_sinterpolate=function(r,u,g=ue.linear,P=T.create()){return T.sinterpolate(this,r,u,g,P)};let a={};a.quat2_set=function(r,u,g,P,C,f,S,M){return V.set(this,r,u,g,P,C,f,S,M)},a.quat2_normalize=function(r=V.create()){return V.normalize(this,r)},a.quat2_invert=function(r=V.create()){return V.invert(this,r)},a.quat2_conjugate=function(r=V.create()){return V.conjugate(this,r)},a.quat2_copy=function(r){return V.copy(r,this)},a.quat2_identity=function(){return V.identity(this)},a.quat2_getPosition=function(r=d.create()){return V.getPosition(this,r)},a.quat2_getRotation=function(r){return V.getRotation(this,r)},a.quat2_getRotationDegrees=function(r=d.create()){return V.getRotationDegrees(this,r)},a.quat2_getRotationRadians=function(r=d.create()){return V.getRotationRadians(this,r)},a.quat2_getRotationQuat=function(r=T.create()){return V.getRotationQuat(this,r)},a.quat2_setPosition=function(r){return V.setPosition(this,r)},a.quat2_setRotation=function(r){return V.setRotation(this,r)},a.quat2_setRotationDegrees=function(r){return V.setRotationDegrees(this,r)},a.quat2_setRotationRadians=function(r){return V.setRotationRadians(this,r)},a.quat2_setRotationQuat=function(r){return V.setRotationQuat(this,r)},a.quat2_setPositionRotation=function(r,u){return V.setPositionRotation(this,r,u)},a.quat2_setPositionRotationDegrees=function(r,u){return V.setPositionRotationDegrees(this,r,u)},a.quat2_setPositionRotationRadians=function(r,u){return V.setPositionRotationRadians(this,r,u)},a.quat2_setPositionRotationQuat=function(r,u){return V.setPositionRotationQuat(this,r,u)},a.quat2_isNormalized=function(r=B.EPSILON){return V.isNormalized(this,r)},a.quat2_length=function(){return V.length(this)},a.quat2_lengthSquared=function(){return V.lengthSquared(this)},a.quat2_mul=function(r,u=V.create()){return V.mul(this,r,u)},a.quat2_getAxes=function(r=[d.create(),d.create(),d.create()]){return V.getAxes(this,r)},a.quat2_getForward=function(r=d.create()){return V.getForward(this,r)},a.quat2_getBackward=function(r){return V.getBackward(this,r)},a.quat2_getLeft=function(r=d.create()){return V.getLeft(this,r)},a.quat2_getRight=function(r){return V.getRight(this,r)},a.quat2_getUp=function(r=d.create()){return V.getUp(this,r)},a.quat2_getDown=function(r){return V.getDown(this,r)},a.quat2_toWorld=function(r,u=V.create()){return V.toWorld(this,r,u)},a.quat2_toLocal=function(r,u=V.create()){return V.toLocal(this,r,u)},a.quat2_rotateAxis=function(r,u,g){return V.rotateAxis(this,r,u,g)},a.quat2_rotateAxisDegrees=function(r,u,g){return V.rotateAxisDegrees(this,r,u,g)},a.quat2_rotateAxisRadians=function(r,u,g=V.create()){return V.rotateAxisRadians(this,r,u,g)},a.quat2_toMatrix=function(r=R.create()){return V.toMatrix(this,r)},a.quat2_fromMatrix=function(r){return V.fromMatrix(r,this)},a.quat2_lerp=function(r,u,g=V.create()){return V.lerp(this,r,u,g)},a.quat2_interpolate=function(r,u,g=ue.linear,P=V.create()){return V.interpolate(this,r,u,g,P)},a.quat2_slerp=function(r,u,g=V.create()){return V.slerp(this,r,u,g)},a.quat2_sinterpolate=function(r,u,g=ue.linear,P=V.create()){return V.sinterpolate(this,r,u,g,P)};let l={};l.mat3_set=function(r,u,g,P,C,f,S,M,D){return K.set(this,r,u,g,P,C,f,S,M,D)},l.mat3_toDegrees=function(r=d.create()){return K.toDegrees(this,r)},l.mat3_toRadians=function(r=d.create()){return K.toRadians(this,r)},l.mat3_toQuat=function(r=T.create()){return K.toQuat(this,r)},l.mat3_fromAxes=function(r,u,g){return K.fromAxes(r,u,g,this)};let h={};h.mat4_set=function(r,u,g,P,C,f,S,M,D,v,b,x,I,L,k,U){return R.set(this,r,u,g,P,C,f,S,M,D,v,b,x,I,L,k,U)},h.mat4_copy=function(r){return R.copy(r,this)},h.mat4_identity=function(){return R.identity(this)},h.mat4_invert=function(r=R.create()){return R.invert(this,r)},h.mat4_mul=function(r,u=R.create()){return R.mul(this,r,u)},h.mat4_scale=function(r,u=R.create()){return R.scale(this,r,u)},h.mat4_clone=function(r=R.create()){return R.clone(this,r)},h.mat4_getPosition=function(r=d.create()){return R.getPosition(this,r)},h.mat4_getRotation=function(r=d.create()){return R.getRotation(this,r)},h.mat4_getRotationDegrees=function(r=d.create()){return R.getRotationDegrees(this,r)},h.mat4_getRotationRadians=function(r=d.create()){return R.getRotationRadians(this,r)},h.mat4_getRotationQuat=function(r=T.create()){return R.getRotationQuat(this,r)},h.mat4_getScale=function(r=d.create()){return R.getScale(this,r)},h.mat4_setPosition=function(r){return R.setPosition(this,r)},h.mat4_setRotation=function(r){return R.setRotation(this,r)},h.mat4_setRotationDegrees=function(r){return R.setRotationDegrees(this,r)},h.mat4_setRotationRadians=function(r){return R.setRotationRadians(this,r)},h.mat4_setRotationQuat=function(r){return R.setRotationQuat(this,r)},h.mat4_setScale=function(r){return R.setScale(this,r)},h.mat4_setPositionRotationScale=function(r,u,g){return R.setPositionRotationScale(this,r,u,g)},h.mat4_setPositionRotationDegreesScale=function(r,u,g){return R.setPositionRotationDegreesScale(this,r,u,g)},h.mat4_setPositionRotationRadiansScale=function(r,u,g){return R.setPositionRotationRadiansScale(this,r,u,g)},h.mat4_setPositionRotationQuatScale=function(r,u,g){return R.setPositionRotationQuatScale(this,r,u,g)},h.mat4_setPositionRotation=function(r,u){return R.setPositionRotation(this,r,u)},h.mat4_setPositionRotationDegrees=function(r,u){return R.setPositionRotationDegrees(this,r,u)},h.mat4_setPositionRotationRadians=function(r,u){return R.setPositionRotationRadians(this,r,u)},h.mat4_setPositionRotationQuat=function(r,u){return R.setPositionRotationQuat(this,r,u)},h.mat4_getAxes=function(r=[d.create(),d.create(),d.create()]){return R.getAxes(this,r)},h.mat4_getForward=function(r=d.create()){return R.getForward(this,r)},h.mat4_getBackward=function(r){return R.getBackward(this,r)},h.mat4_getLeft=function(r=d.create()){return R.getLeft(this,r)},h.mat4_getRight=function(r){return R.getRight(this,r)},h.mat4_getUp=function(r=d.create()){return R.getUp(this,r)},h.mat4_getDown=function(r){return R.getDown(this,r)},h.mat4_toWorld=function(r,u=R.create()){return R.toWorld(this,r,u)},h.mat4_toLocal=function(r,u=R.create()){return R.toLocal(this,r,u)},h.mat4_hasUniformScale=function(){return R.hasUniformScale(this)},h.mat4_toQuat=function(r=V.create()){return R.toQuat(this,r)},h.mat4_fromQuat=function(r){return R.fromQuat(r,this)};let _=[Array.prototype,Uint8ClampedArray.prototype,Uint8Array.prototype,Uint16Array.prototype,Uint32Array.prototype,Int8Array.prototype,Int16Array.prototype,Int32Array.prototype,Float32Array.prototype,Float64Array.prototype];for(let y of _)xe.injectProperties(i,y,!1,!0,!0),xe.injectProperties(e,y,!1,!0,!0),xe.injectProperties(t,y,!1,!0,!0),xe.injectProperties(n,y,!1,!0,!0),xe.injectProperties(o,y,!1,!0,!0),xe.injectProperties(s,y,!1,!0,!0),xe.injectProperties(a,y,!1,!0,!0),xe.injectProperties(l,y,!1,!0,!0),xe.injectProperties(h,y,!1,!0,!0),xe.injectProperties(i,y,!1,!0,!0)}var Tn=class{constructor(){this.myPosition=null,this.myTextureCoordinates=null,this.myNormal=null,this.myColor=null}},Si=class{constructor(){this.myIndexes=new Uint32Array(3)}},Pn=class{constructor(e=m.getMainEngine()){this.myVertexes=[],this.myTriangles=[],this.myEngine=e}};function pE(i){let e=[];for(let _ of i.myTriangles)e.push(_.myIndexes[0]),e.push(_.myIndexes[1]),e.push(_.myIndexes[2]);let t=new Uint32Array(e.length);t.pp_copy(e);let n=i.myVertexes.length,o=new Tr(i.myEngine,{vertexCount:n,indexData:t,indexType:Pr.UnsignedInt}),s=null,a=null,l=null,h=null;try{s=o.attribute(Pe.Position)}catch{s=null}try{a=o.attribute(Pe.TextureCoordinate)}catch{a=null}try{l=o.attribute(Pe.Normal)}catch{l=null}try{h=o.attribute(Pe.Color)}catch{h=null}for(let _=0;_<i.myVertexes.length;_++){let y=i.myVertexes[_];s!=null&&y.myPosition&&s.set(_,y.myPosition),a!=null&&y.myTextureCoordinates&&a.set(_,y.myTextureCoordinates),l!=null&&y.myNormal&&l.set(_,y.myNormal),h!=null&&y.myColor&&h.set(_,y.myColor)}return o}var dE=function(){let i=p(),e=Ce(),t=p(),n=F();return function(s){if(s==null)return null;let a=s.indexData.pp_clone(),l=new Tr(s.engine,{vertexCount:s.vertexCount,indexData:a,indexType:Pr.UnsignedInt}),h=null,_=null,y=null,r=null,u=null,g=null,P=null,C=null;try{h=s.attribute(Pe.Position),u=l.attribute(Pe.Position)}catch{h=null,u=null}try{_=s.attribute(Pe.TextureCoordinate),g=l.attribute(Pe.TextureCoordinate)}catch{_=null,g=null}try{y=s.attribute(Pe.Normal),P=l.attribute(Pe.Normal)}catch{y=null,P=null}try{r=s.attribute(Pe.Color),C=l.attribute(Pe.Color)}catch{r=null,C=null}for(let f=0;f<s.vertexCount;f++)h!=null&&u!=null&&u.set(f,h.get(f,i)),_!=null&&g!=null&&g.set(f,_.get(f,e)),y!=null&&P!=null&&P.set(f,y.get(f,t)),r!=null&&C!=null&&C.set(f,r.get(f,n));return l}}(),_E=function(){let i=p(),e=Ce(),t=p(),n=F();return function(s){if(s==null)return null;let a=new Uint32Array(s.indexData.length);for(let f=0;f<s.indexData.length/3;f++)a[f*3+0]=s.indexData[f*3+2],a[f*3+1]=s.indexData[f*3+1],a[f*3+2]=s.indexData[f*3+0];let l=new Tr(s.engine,{vertexCount:s.vertexCount,indexData:a,indexType:Pr.UnsignedInt}),h=null,_=null,y=null,r=null,u=null,g=null,P=null,C=null;try{h=s.attribute(Pe.Position),u=l.attribute(Pe.Position)}catch{h=null,u=null}try{_=s.attribute(Pe.TextureCoordinate),g=l.attribute(Pe.TextureCoordinate)}catch{_=null,g=null}try{y=s.attribute(Pe.Normal),P=l.attribute(Pe.Normal)}catch{y=null,P=null}try{r=s.attribute(Pe.Color),C=l.attribute(Pe.Color)}catch{r=null,C=null}for(let f=0;f<s.vertexCount;f++)h!=null&&u!=null&&u.set(f,h.get(f,i)),_!=null&&g!=null&&g.set(f,_.get(f,e)),y!=null&&P!=null&&(y.get(f,t),t.vec3_negate(t),P.set(f,t)),r!=null&&C!=null&&C.set(f,r.get(f,n));return l}}(),pT=function(){let i=p(),e=Ce(),t=p(),n=F();return function(s){if(s==null)return null;let a=new Uint32Array(s.indexData.length*2);for(let f=0;f<a.length/3;f++)a[f*3*2+0]=s.indexData[f*3+0]*2,a[f*3*2+1]=s.indexData[f*3+1]*2,a[f*3*2+2]=s.indexData[f*3+2]*2,a[f*3*2+3]=s.indexData[f*3+2]*2+1,a[f*3*2+4]=s.indexData[f*3+1]*2+1,a[f*3*2+5]=s.indexData[f*3+0]*2+1;let l=new Tr(s.engine,{vertexCount:s.vertexCount*2,indexData:a,indexType:Pr.UnsignedInt}),h=null,_=null,y=null,r=null,u=null,g=null,P=null,C=null;try{h=s.attribute(Pe.Position),u=l.attribute(Pe.Position)}catch{h=null,u=null}try{_=s.attribute(Pe.TextureCoordinate),g=l.attribute(Pe.TextureCoordinate)}catch{_=null,g=null}try{y=s.attribute(Pe.Normal),P=l.attribute(Pe.Normal)}catch{y=null,P=null}try{r=s.attribute(Pe.Color),C=l.attribute(Pe.Color)}catch{r=null,C=null}for(let f=0;f<s.vertexCount;f++){if(h!=null&&u!=null&&(u.set(f*2,h.get(f,i)),u.set(f*2+1,h.get(f,i))),_!=null&&g!=null&&(g.set(f*2,_.get(f,e)),g.set(f*2+1,_.get(f,e))),y!=null&&P!=null){y.get(f,t),P.set(f*2,t);let S=t.vec3_negate();P.set(f*2+1,S)}r!=null&&C!=null&&(C.set(f*2,r.get(f,n)),C.set(f*2+1,r.get(f,n)))}return l}}();function dT(i=m.getMainEngine()){let e=4,t=new Pn(i);for(let a=0;a<e;++a){let l=new Tn;l.myPosition=new p,l.myPosition[0]=-1+(a&1)*2,l.myPosition[1]=-1+((a&2)>>1)*2,l.myPosition[2]=0,l.myTextureCoordinates=new Ce,l.myTextureCoordinates[0]=a&1,l.myTextureCoordinates[1]=(a&2)>>1,l.myNormal=new p,l.myNormal[0]=0,l.myNormal[1]=0,l.myNormal[2]=1,t.myVertexes.push(l)}let n=new Si;n.myIndexes[0]=0,n.myIndexes[1]=1,n.myIndexes[2]=2;let o=new Si;return o.myIndexes[0]=2,o.myIndexes[1]=1,o.myIndexes[2]=3,t.myTriangles.push(n),t.myTriangles.push(o),Re.create(t)}var Re={create:pE,clone:dE,invert:_E,makeDoubleSided:pT,createPlane:dT};function gT(i,e,t=new zt,n=null){let o=j.cloneDefault(i,e,!0);return t.isDeepCloneComponentVariable(_T.TypeName,"material")&&(o.material=i.material.clone()),t.isDeepCloneComponentVariable(_T.TypeName,"mesh")&&(o.mesh=Re.clone(i.mesh)),o}function fT(i,e,t=new zt,n=null){return j.cloneDefault(i,e)}function TT(i,e,t=new zt,n=null){let o=j.cloneDefault(i,e);return t.isDeepCloneComponentVariable(gE.TypeName,"material")&&(o.material=i.material.clone()),o}function PT(i,e,t=new zt,n=null){return j.cloneDefault(i,e)}var Cn={cloneMesh:gT,cloneCollision:fT,cloneText:TT,clonePhysX:PT};var $t=new WeakMap,ei=new WeakMap,zt=class{constructor(){this._myDeepCloneComponents=!1,this._myDeepCloneOverrideComponentsMap=new Map,this._myDeepCloneOverrideComponentsVariablesMap=new Map}setDeepCloneComponents(e){this._myDeepCloneComponents=e}setDeepCloneComponent(e,t){this._myDeepCloneOverrideComponentsMap.set(e,t)}setDeepCloneComponentVariable(e,t,n){let o=null;this._myDeepCloneOverrideComponentsVariablesMap.has(e)||this._myDeepCloneOverrideComponentsVariablesMap.set(e,new Map),o=this._myDeepCloneOverrideComponentsVariablesMap.get(e),o.set(t,n)}isDeepCloneComponent(e){let t=this._myDeepCloneOverrideComponentsMap.get(e);return t??this._myDeepCloneComponents}isDeepCloneComponentVariable(e,t){let n=this._myDeepCloneOverrideComponentsVariablesMap.get(e);if(n!=null){let o=n.get(t);if(o!=null)return o}return this.isDeepCloneComponent(e)}},co=class{constructor(){this._myParams=new Map}addParam(e,t){this._myParams.set(e,t)}removeParam(e){this._myParams.delete(e)}getParam(e){this._myParams.get(e)}hasParam(e){this._myParams.has(e)}};function CT(i){return j.isWLNativeComponent(i)||j.isWLJavascriptComponent(i)}function bT(i){let e=!1,t=j.getTypeFromTypeOrClass(i);return j.getWLNativeComponentTypes().includes(t)&&(e=!0),e}function ST(i){let e=!1,t=j.getTypeFromTypeOrClass(i);return j.getWLJavascriptComponentTypes().includes(t)&&(e=!0),e}function vT(){return UE}function xT(){return WE}function MT(i){if(i==null)return;let e=i;return i.TypeName!=null&&(e=i.TypeName),e}function DT(i,e=m.getMainEngine()){let t=null;if(j.isWLNativeComponent(i)){if(j.isWLNativeComponentRegistered(i,e))switch(i){case Ml.TypeName:t=Ml;break;case Cr.TypeName:t=Cr;break;case Dl.TypeName:t=Dl;break;case El.TypeName:t=El;break;case br.TypeName:t=br;break;case Sr.TypeName:t=Sr;break;case vr.TypeName:t=vr;break;case Al.TypeName:t=Al;break;default:t=null}}else t=j.getJavascriptComponentClass(i,e);return t}function ET(i,e=m.getMainEngine()){let t=j.getTypeFromTypeOrClass(i);return j.getClassFromType(t,e)!=null}function AT(i=m.getMainEngine()){return m.getWASM(i)._components}function RT(i,e=m.getMainEngine()){return j.getJavascriptComponentClassesByIndex(e)[j.getJavascriptComponentTypeIndex(i,e)]}function VT(i=m.getMainEngine()){return m.getWASM(i)._componentTypes}function OT(i,e=m.getMainEngine()){let t=j.getTypeFromTypeOrClass(i);return j.getJavascriptComponentTypeIndexes(e)[t]}function IT(i=m.getMainEngine()){return m.getWASM(i)._componentTypeIndices}function BT(i,e=m.getMainEngine()){let t=null,n=j.getJavascriptComponentClassesByIndex(e)[i];return n!=null&&(t=n.TypeName),t}function LT(i,e=m.getMainEngine()){let t=m.getWASM(e),n=j.getTypeFromTypeOrClass(i);return t._wl_get_component_manager_index(t.tempUTF8(n))>=0}function GE(i,e=!1,t=m.getMainEngine()){let n=j.getTypeFromTypeOrClass(i);return e||j.hasCloneCallback(n,t)||j.getClassFromType(n,t)?.prototype.pp_clone!=null}function HT(i,e=m.getMainEngine()){let t=j.getTypeFromTypeOrClass(i);return j.hasClonePostProcessCallback(t,e)||j.getClassFromType(t,e)?.prototype.pp_clonePostProcess!=null}function NE(i,e,t,n,o=!1,s=!0){let a=null,l=j.getCloneCallback(i.type,c.getEngine(i.object));return l!=null?a=l(i,e,t,n):i.pp_clone!=null?a=i.pp_clone(e,t,n):o&&(a=j.cloneDefault(i,e,s)),a}function kT(i,e,t,n){let o=j.getClonePostProcessCallback(i.type,c.getEngine(i.object));return o!=null?o(i,e,t,n):i.pp_clonePostProcess!=null&&i.pp_clonePostProcess(e,t,n),e}function FT(i,e,t=!0){let n=c.addComponent(e,i.type,i);return t&&!n.active&&(n.active=!0,n.active=!1),n}function wT(i,e,t=m.getMainEngine()){let n=j.getTypeFromTypeOrClass(i);$t.has(t)||$t.set(t,new Map),$t.get(t).set(n,e)}function jT(i,e=m.getMainEngine()){let t=j.getTypeFromTypeOrClass(i);$t.has(e)&&$t.get(e).delete(t)}function zT(i,e=m.getMainEngine()){let t=null,n=j.getTypeFromTypeOrClass(i);return $t.has(e)&&(t=$t.get(e).get(n)),t}function GT(i,e=m.getMainEngine()){let t=!1,n=j.getTypeFromTypeOrClass(i);return $t.has(e)&&(t=$t.get(e).has(n)),t}function NT(i,e,t=m.getMainEngine()){let n=j.getTypeFromTypeOrClass(i);ei.has(t)||ei.set(t,new Map),ei.get(t).set(n,e)}function UT(i,e=m.getMainEngine()){let t=j.getTypeFromTypeOrClass(i);ei.has(e)&&ei.get(e).delete(t)}function WT(i,e=m.getMainEngine()){let t=null,n=j.getTypeFromTypeOrClass(i);return ei.has(e)&&(t=ei.get(e).get(n)),t}function QT(i,e=m.getMainEngine()){let t=!1,n=j.getTypeFromTypeOrClass(i);return ei.has(e)&&(t=ei.get(e).has(n)),t}function qT(i){let e=null;switch(j.getTypeFromTypeOrClass(i)){case br.TypeName:e=Cn.cloneMesh;break;case Cr.TypeName:e=Cn.cloneCollision;break;case vr.TypeName:e=Cn.cloneText;break;case Sr.TypeName:e=Cn.clonePhysX;break;default:e=null}return e}function XT(i){return j.getDefaultWLComponentCloneCallback(i)!=null}function KT(i=m.getMainEngine()){for(let e of j.getWLNativeComponentTypes()){let t=j.getDefaultWLComponentCloneCallback(e);t!=null&&j.setCloneCallback(e,t,i)}for(let e of j.getWLJavascriptComponentTypes()){let t=j.getDefaultWLComponentCloneCallback(e);t!=null&&j.setCloneCallback(e,t,i)}}function JT(i=m.getMainEngine()){for(let e of j.getWLNativeComponentTypes()){let t=j.getDefaultWLComponentCloneCallback(e);t!=null&&j.getCloneCallback(e,i)==t&&j.removeCloneCallback(e,i)}for(let e of j.getWLNativeComponentTypes()){let t=j.getDefaultWLComponentCloneCallback(e);t!=null&&j.getCloneCallback(e,i)==t&&j.removeCloneCallback(e,i)}}var j={isWLComponent:CT,isWLNativeComponent:bT,isWLJavascriptComponent:ST,getWLNativeComponentTypes:vT,getWLJavascriptComponentTypes:xT,getTypeFromTypeOrClass:MT,getClassFromType:DT,isRegistered:ET,getJavascriptComponentInstances:AT,getJavascriptComponentClass:RT,getJavascriptComponentClassesByIndex:VT,getJavascriptComponentTypeIndex:OT,getJavascriptComponentTypeIndexes:IT,getJavascriptComponentTypeFromIndex:BT,isWLNativeComponentRegistered:LT,isCloneable:GE,hasClonePostProcess:HT,clone:NE,clonePostProcess:kT,cloneDefault:FT,setCloneCallback:wT,removeCloneCallback:jT,getCloneCallback:zT,hasCloneCallback:GT,setClonePostProcessCallback:NT,removeClonePostProcessCallback:UT,getClonePostProcessCallback:WT,hasClonePostProcessCallback:QT,setDefaultWLComponentCloneCallbacks:KT,removeDefaultWLComponentCloneCallbacks:JT,getDefaultWLComponentCloneCallback:qT,hasDefaultWLComponentCloneCallback:XT},UE=[Ml.TypeName,Cr.TypeName,Dl.TypeName,El.TypeName,br.TypeName,Sr.TypeName,vr.TypeName,Al.TypeName],WE=[fE.TypeName,TE.TypeName,PE.TypeName,CE.TypeName,bE.TypeName,SE.TypeName,vE.TypeName,xE.TypeName,ME.TypeName,DE.TypeName,EE.TypeName,AE.TypeName,RE.TypeName,VE.TypeName,OE.TypeName,IE.TypeName,BE.TypeName,LE.TypeName,HE.TypeName,kE.TypeName,FE.TypeName,wE.TypeName,jE.TypeName,zE.TypeName];function Rl(){ZT()}function ZT(){let i={};Object.defineProperty(i,"PP_EPSILON",{get(){return B.EPSILON},set(e){B.EPSILON=e}}),Object.defineProperty(i,"PP_EPSILON_SQUARED",{get(){return B.EPSILON_SQUARED},set(e){B.EPSILON=e}}),Object.defineProperty(i,"PP_EPSILON_DEGREES",{get(){return B.EPSILON_DEGREES},set(e){B.EPSILON=e}}),i.pp_clamp=function(t,n,o){return B.clamp(t,n,o)},i.pp_sign=function(t,n=1){return B.sign(t,n)},i.pp_toDegrees=function(t){return B.toDegrees(t)},i.pp_toRadians=function(t){return B.toRadians(t)},i.pp_roundDecimal=function(t,n){return B.roundDecimal(t,n)},i.pp_mapToRange=function(t,n,o,s,a){return B.mapToRange(t,n,o,s,a)},i.pp_random=function(t=0,n=1){return B.random(t,n)},i.pp_randomInt=function(t,n){return B.randomInt(t,n)},i.pp_randomBool=function(){return B.randomBool()},i.pp_randomSign=function(){return B.randomSign()},i.pp_randomPick=function(...t){return B.randomPick(...t)},i.pp_randomUUID=function(){return B.randomUUID()},i.pp_lerp=function(t,n,o){return B.lerp(t,n,o)},i.pp_interpolate=function(t,n,o,s=ue.linear){return B.interpolate(t,n,o,s)},i.pp_angleDistance=function(t,n){return B.angleDistance(t,n)},i.pp_angleDistanceDegrees=function(t,n){return B.angleDistanceDegrees(t,n)},i.pp_angleDistanceRadians=function(t,n){return B.angleDistanceRadians(t,n)},i.pp_angleDistanceSigned=function(t,n){return B.angleDistanceSigned(t,n)},i.pp_angleDistanceSignedDegrees=function(t,n){return B.angleDistanceSignedDegrees(t,n)},i.pp_angleDistanceSignedRadians=function(t,n){return B.angleDistanceSignedRadians(t,n)},i.pp_angleClamp=function(t,n=!1){return B.angleClamp(t,n)},i.pp_angleClampDegrees=function(t,n=!1){return B.angleClampDegrees(t,n)},i.pp_angleClampRadians=function(t,n=!1){return B.angleClampRadians(t,n)},i.pp_isInsideAngleRange=function(t,n,o,s=!1){return B.isInsideAngleRange(t,n,o,s)},i.pp_isInsideAngleRangeDegrees=function(t,n,o,s=!1){return B.isInsideAngleRangeDegrees(t,n,o,s)},i.pp_isInsideAngleRangeRadians=function(t,n,o,s=!1){return B.isInsideAngleRangeRadians(t,n,o,s)},xe.injectProperties(i,Math,!1,!0,!0)}function Vl(i){YT()}function YT(){let i={};i.get=function(){return this.valueOf()},xe.injectProperties(i,Number.prototype,!1,!0,!0)}function Ol(){Rl(),xl(),Vl()}function Il(i){Ol(i)}import{Object3D as QE}from"@wonderlandengine/api";function Bl(){$T()}function $T(){let i={};i.pp_getPosition=function(t){return c.getPosition(this,t)},i.pp_getPositionWorld=function(t=d.create()){return c.getPositionWorld(this,t)},i.pp_getPositionLocal=function(t=d.create()){return c.getPositionLocal(this,t)},i.pp_getRotation=function(t){return c.getRotation(this,t)},i.pp_getRotationDegrees=function(t){return c.getRotationDegrees(this,t)},i.pp_getRotationRadians=function(t){return c.getRotationRadians(this,t)},i.pp_getRotationMatrix=function(t){return c.getRotationMatrix(this,t)},i.pp_getRotationQuat=function(t){return c.getRotationQuat(this,t)},i.pp_getRotationWorld=function(t){return c.getRotationWorld(this,t)},i.pp_getRotationWorldDegrees=function(t){return c.getRotationWorldDegrees(this,t)},i.pp_getRotationWorldRadians=function(t=d.create()){return c.getRotationWorldRadians(this,t)},i.pp_getRotationWorldMatrix=function(t=K.create()){return c.getRotationWorldMatrix(this,t)},i.pp_getRotationWorldQuat=function(t=T.create()){return c.getRotationWorldQuat(this,t)},i.pp_getRotationLocal=function(t){return c.getRotationLocal(this,t)},i.pp_getRotationLocalDegrees=function(t){return c.getRotationLocalDegrees(this,t)},i.pp_getRotationLocalRadians=function(t=d.create()){return c.getRotationLocalRadians(this,t)},i.pp_getRotationLocalMatrix=function(t=K.create()){return c.getRotationLocalMatrix(this,t)},i.pp_getRotationLocalQuat=function(t=T.create()){return c.getRotationLocalQuat(this,t)},i.pp_getScale=function(t){return c.getScale(this,t)},i.pp_getScaleWorld=function(t=d.create()){return c.getScaleWorld(this,t)},i.pp_getScaleLocal=function(t=d.create()){return c.getScaleLocal(this,t)},i.pp_getTransform=function(t){return c.getTransform(this,t)},i.pp_getTransformMatrix=function(t){return c.getTransformMatrix(this,t)},i.pp_getTransformQuat=function(t){return c.getTransformQuat(this,t)},i.pp_getTransformWorld=function(t){return c.getTransformWorld(this,t)},i.pp_getTransformWorldMatrix=function(t=R.create()){return c.getTransformWorldMatrix(this,t)},i.pp_getTransformWorldQuat=function(t=V.create()){return c.getTransformWorldQuat(this,t)},i.pp_getTransformLocal=function(t){return c.getTransformLocal(this,t)},i.pp_getTransformLocalMatrix=function(t=R.create()){return c.getTransformLocalMatrix(this,t)},i.pp_getTransformLocalQuat=function(t=V.create()){return c.getTransformLocalQuat(this,t)},i.pp_getAxes=function(t){return c.getAxes(this,t)},i.pp_getAxesWorld=function(t=[d.create(),d.create(),d.create()]){return c.getAxesWorld(this,t)},i.pp_getAxesLocal=function(t=[d.create(),d.create(),d.create()]){return c.getAxesLocal(this,t)},i.pp_getForward=function(t){return c.getForward(this,t)},i.pp_getForwardWorld=function(t=d.create()){return c.getForwardWorld(this,t)},i.pp_getForwardLocal=function(t=d.create()){return c.getForwardLocal(this,t)},i.pp_getBackward=function(t){return c.getBackward(this,t)},i.pp_getBackwardWorld=function(t=d.create()){return c.getBackwardWorld(this,t)},i.pp_getBackwardLocal=function(t=d.create()){return c.getBackwardLocal(this,t)},i.pp_getUp=function(t){return c.getUp(this,t)},i.pp_getUpWorld=function(t=d.create()){return c.getUpWorld(this,t)},i.pp_getUpLocal=function(t=d.create()){return c.getUpLocal(this,t)},i.pp_getDown=function(t){return c.getDown(this,t)},i.pp_getDownWorld=function(t=d.create()){return c.getDownWorld(this,t)},i.pp_getDownLocal=function(t=d.create()){return c.getDownLocal(this,t)},i.pp_getLeft=function(t){return c.getLeft(this,t)},i.pp_getLeftWorld=function(t=d.create()){return c.getLeftWorld(this,t)},i.pp_getLeftLocal=function(t=d.create()){return c.getLeftLocal(this,t)},i.pp_getRight=function(t){return c.getRight(this,t)},i.pp_getRightWorld=function(t=d.create()){return c.getRightWorld(this,t)},i.pp_getRightLocal=function(t=d.create()){return c.getRightLocal(this,t)},i.pp_setPosition=function(t){return c.setPosition(this,t)},i.pp_setPositionWorld=function(t){return c.setPositionWorld(this,t)},i.pp_setPositionLocal=function(t){return c.setPositionLocal(this,t)},i.pp_setRotation=function(t){return c.setRotation(this,t)},i.pp_setRotationDegrees=function(t){return c.setRotationDegrees(this,t)},i.pp_setRotationRadians=function(t){return c.setRotationRadians(this,t)},i.pp_setRotationMatrix=function(t){return c.setRotationMatrix(this,t)},i.pp_setRotationQuat=function(t){return c.setRotationQuat(this,t)},i.pp_setRotationWorld=function(t){return c.setRotationWorld(this,t)},i.pp_setRotationWorldDegrees=function(t){return c.setRotationWorldDegrees(this,t)},i.pp_setRotationWorldRadians=function(t){return c.setRotationWorldRadians(this,t)},i.pp_setRotationWorldMatrix=function(t){return c.setRotationWorldMatrix(this,t)},i.pp_setRotationWorldQuat=function(t){return c.setRotationWorldQuat(this,t)},i.pp_setRotationLocal=function(t){return c.setRotationLocal(this,t)},i.pp_setRotationLocalDegrees=function(t){return c.setRotationLocalDegrees(this,t)},i.pp_setRotationLocalRadians=function(t){return c.setRotationLocalRadians(this,t)},i.pp_setRotationLocalMatrix=function(t){return c.setRotationLocalMatrix(this,t)},i.pp_setRotationLocalQuat=function(t){return c.setRotationLocalQuat(this,t)},i.pp_setScale=function(t){return c.setScale(this,t)},i.pp_setScaleWorld=function(t){return c.setScaleWorld(this,t)},i.pp_setScaleLocal=function(t){return c.setScaleLocal(this,t)},i.pp_setAxes=function(t,n,o){return c.setAxes(this,t,n,o)},i.pp_setAxesWorld=function(t,n,o){return c.setAxesWorld(this,t,n,o)},i.pp_setAxesLocal=function(t,n,o){return c.setAxesLocal(this,t,n,o)},i.pp_setForward=function(t,n,o){return c.setForward(this,t,n,o)},i.pp_setForwardWorld=function(t,n=null,o=null){return c.setForwardWorld(this,t,n,o)},i.pp_setForwardLocal=function(t,n=null,o=null){return c.setForwardLocal(this,t,n,o)},i.pp_setBackward=function(t,n,o){return c.setBackward(this,t,n,o)},i.pp_setBackwardWorld=function(t,n=null,o=null){return c.setBackwardWorld(this,t,n,o)},i.pp_setBackwardLocal=function(t,n=null,o=null){return c.setBackwardLocal(this,t,n,o)},i.pp_setUp=function(t,n,o){return c.setUp(this,t,n,o)},i.pp_setUpWorld=function(t,n=null,o=null){return c.setUpWorld(this,t,n,o)},i.pp_setUpLocal=function(t,n=null,o=null){return c.setUpLocal(this,t,n,o)},i.pp_setDown=function(t,n,o){return c.setDown(this,t,n,o)},i.pp_setDownWorld=function(t,n=null,o=null){return c.setDownWorld(this,t,n,o)},i.pp_setDownLocal=function(t,n=null,o=null){return c.setDownLocal(this,t,n,o)},i.pp_setLeft=function(t,n,o){return c.setLeft(this,t,n,o)},i.pp_setLeftWorld=function(t,n=null,o=null){return c.setLeftWorld(this,t,n,o)},i.pp_setLeftLocal=function(t,n=null,o=null){return c.setLeftLocal(this,t,n,o)},i.pp_setRight=function(t,n,o){return c.setRight(this,t,n,o)},i.pp_setRightWorld=function(t,n=null,o=null){return c.setRightWorld(this,t,n,o)},i.pp_setRightLocal=function(t,n=null,o=null){return c.setRightLocal(this,t,n,o)},i.pp_setTransform=function(t){return c.setTransform(this,t)},i.pp_setTransformMatrix=function(t){return c.setTransformMatrix(this,t)},i.pp_setTransformQuat=function(t){return c.setTransformQuat(this,t)},i.pp_setTransformWorld=function(t){return c.setTransformWorld(this,t)},i.pp_setTransformWorldMatrix=function(t){return c.setTransformWorldMatrix(this,t)},i.pp_setTransformWorldQuat=function(t){return c.setTransformWorldQuat(this,t)},i.pp_setTransformLocal=function(t){return c.setTransformLocal(this,t)},i.pp_setTransformLocalMatrix=function(t){return c.setTransformLocalMatrix(this,t)},i.pp_setTransformLocalQuat=function(t){return c.setTransformLocalQuat(this,t)},i.pp_resetPosition=function(){return c.resetPosition(this)},i.pp_resetPositionWorld=function(){return c.resetPositionWorld(this)},i.pp_resetPositionLocal=function(){return c.resetPositionLocal(this)},i.pp_resetRotation=function(){return c.resetRotation(this)},i.pp_resetRotationWorld=function(){return c.resetRotationWorld(this)},i.pp_resetRotationLocal=function(){return c.resetRotationLocal(this)},i.pp_resetScale=function(){return c.resetScale(this)},i.pp_resetScaleWorld=function(){return c.resetScaleWorld(this)},i.pp_resetScaleLocal=function(){return c.resetScaleLocal(this)},i.pp_resetTransform=function(){return c.resetTransform(this)},i.pp_resetTransformWorld=function(){return c.resetTransformWorld(this)},i.pp_resetTransformLocal=function(){return c.resetTransformLocal(this)},i.pp_translate=function(t){return c.translate(this,t)},i.pp_translateWorld=function(t){return c.translateWorld(this,t)},i.pp_translateLocal=function(t){return c.translateLocal(this,t)},i.pp_translateObject=function(t){return c.translateObject(this,t)},i.pp_translateAxis=function(t,n){return c.translateAxis(this,t,n)},i.pp_translateAxisWorld=function(t,n){return c.translateAxisWorld(this,t,n)},i.pp_translateAxisLocal=function(t,n){return c.translateAxisLocal(this,t,n)},i.pp_translateAxisObject=function(t,n){return c.translateAxisObject(this,t,n)},i.pp_rotate=function(t){return c.rotate(this,t)},i.pp_rotateDegrees=function(t){return c.rotateDegrees(this,t)},i.pp_rotateRadians=function(t){return c.rotateRadians(this,t)},i.pp_rotateMatrix=function(t){return c.rotateMatrix(this,t)},i.pp_rotateQuat=function(t){return c.rotateQuat(this,t)},i.pp_rotateWorld=function(t){return c.rotateWorld(this,t)},i.pp_rotateWorldDegrees=function(t){return c.rotateWorldDegrees(this,t)},i.pp_rotateWorldRadians=function(t){return c.rotateWorldRadians(this,t)},i.pp_rotateWorldMatrix=function(t){return c.rotateWorldMatrix(this,t)},i.pp_rotateWorldQuat=function(t){return c.rotateWorldQuat(this,t)},i.pp_rotateLocal=function(t){return c.rotateLocal(this,t)},i.pp_rotateLocalDegrees=function(t){return c.rotateLocalDegrees(this,t)},i.pp_rotateLocalRadians=function(t){return c.rotateLocalRadians(this,t)},i.pp_rotateLocalMatrix=function(t){return c.rotateLocalMatrix(this,t)},i.pp_rotateLocalQuat=function(t){return c.rotateLocalQuat(this,t)},i.pp_rotateObject=function(t){return c.rotateObject(this,t)},i.pp_rotateObjectDegrees=function(t){return c.rotateObjectDegrees(this,t)},i.pp_rotateObjectRadians=function(t){return c.rotateObjectRadians(this,t)},i.pp_rotateObjectMatrix=function(t){return c.rotateObjectMatrix(this,t)},i.pp_rotateObjectQuat=function(t){return c.rotateObjectQuat(this,t)},i.pp_rotateAxis=function(t,n){return c.rotateAxis(this,t,n)},i.pp_rotateAxisDegrees=function(t,n){return c.rotateAxisDegrees(this,t,n)},i.pp_rotateAxisRadians=function(t,n){return c.rotateAxisRadians(this,t,n)},i.pp_rotateAxisWorld=function(t,n){return c.rotateAxisWorld(this,t,n)},i.pp_rotateAxisWorldDegrees=function(t,n){return c.rotateAxisWorldDegrees(this,t,n)},i.pp_rotateAxisWorldRadians=function(t,n){return c.rotateAxisWorldRadians(this,t,n)},i.pp_rotateAxisLocal=function(t,n){return c.rotateAxisLocal(this,t,n)},i.pp_rotateAxisLocalDegrees=function(t,n){return c.rotateAxisLocalDegrees(this,t,n)},i.pp_rotateAxisLocalRadians=function(t,n){return c.rotateAxisLocalRadians(this,t,n)},i.pp_rotateAxisObject=function(t,n){return c.rotateAxisObject(this,t,n)},i.pp_rotateAxisObjectDegrees=function(t,n){return c.rotateAxisObjectDegrees(this,t,n)},i.pp_rotateAxisObjectRadians=function(t,n){return c.rotateAxisObjectRadians(this,t,n)},i.pp_rotateAround=function(t,n){return c.rotateAround(this,t,n)},i.pp_rotateAroundDegrees=function(t,n){return c.rotateAroundDegrees(this,t,n)},i.pp_rotateAroundRadians=function(t,n){return c.rotateAroundRadians(this,t,n)},i.pp_rotateAroundMatrix=function(t,n){return c.rotateAroundMatrix(this,t,n)},i.pp_rotateAroundQuat=function(t,n){return c.rotateAroundQuat(this,t,n)},i.pp_rotateAroundWorld=function(t,n){return c.rotateAroundWorld(this,t,n)},i.pp_rotateAroundWorldDegrees=function(t,n){return c.rotateAroundWorldDegrees(this,t,n)},i.pp_rotateAroundWorldRadians=function(t,n){return c.rotateAroundWorldRadians(this,t,n)},i.pp_rotateAroundWorldMatrix=function(t,n){return c.rotateAroundWorldMatrix(this,t,n)},i.pp_rotateAroundWorldQuat=function(t,n){return c.rotateAroundWorldQuat(this,t,n)},i.pp_rotateAroundLocal=function(t,n){return c.rotateAroundLocal(this,t,n)},i.pp_rotateAroundLocalDegrees=function(t,n){return c.rotateAroundLocalDegrees(this,t,n)},i.pp_rotateAroundLocalRadians=function(t,n){return c.rotateAroundLocalRadians(this,t,n)},i.pp_rotateAroundLocalMatrix=function(t,n){return c.rotateAroundLocalMatrix(this,t,n)},i.pp_rotateAroundLocalQuat=function(t,n){return c.rotateAroundLocalQuat(this,t,n)},i.pp_rotateAroundObject=function(t,n){return c.rotateAroundObject(this,t,n)},i.pp_rotateAroundObjectDegrees=function(t,n){return c.rotateAroundObjectDegrees(this,t,n)},i.pp_rotateAroundObjectRadians=function(t,n){return c.rotateAroundObjectRadians(this,t,n)},i.pp_rotateAroundObjectMatrix=function(t,n){return c.rotateAroundObjectMatrix(this,t,n)},i.pp_rotateAroundObjectQuat=function(t,n){return c.rotateAroundObjectQuat(this,t,n)},i.pp_rotateAroundAxis=function(t,n,o){return c.rotateAroundAxis(this,t,n,o)},i.pp_rotateAroundAxisDegrees=function(t,n,o){return c.rotateAroundAxisDegrees(this,t,n,o)},i.pp_rotateAroundAxisRadians=function(t,n,o){return c.rotateAroundAxisRadians(this,t,n,o)},i.pp_rotateAroundAxisWorld=function(t,n,o){return c.rotateAroundAxisWorld(this,t,n,o)},i.pp_rotateAroundAxisWorldDegrees=function(t,n,o){return c.rotateAroundAxisWorldDegrees(this,t,n,o)},i.pp_rotateAroundAxisWorldRadians=function(t,n,o){return c.rotateAroundAxisWorldRadians(this,t,n,o)},i.pp_rotateAroundAxisLocal=function(t,n,o){return c.rotateAroundAxisLocal(this,t,n,o)},i.pp_rotateAroundAxisLocalDegrees=function(t,n,o){return c.rotateAroundAxisLocalDegrees(this,t,n,o)},i.pp_rotateAroundAxisLocalRadians=function(t,n,o){return c.rotateAroundAxisLocalRadians(this,t,n,o)},i.pp_rotateAroundAxisObject=function(t,n,o){return c.rotateAroundAxisObject(this,t,n,o)},i.pp_rotateAroundAxisObjectDegrees=function(t,n,o){return c.rotateAroundAxisObjectDegrees(this,t,n,o)},i.pp_rotateAroundAxisObjectRadians=function(t,n,o){return c.rotateAroundAxisObjectRadians(this,t,n,o)},i.pp_scaleObject=function(t){return c.scaleObject(this,t)},i.pp_lookAt=function(t,n){return c.lookAt(this,t,n)},i.pp_lookAtWorld=function(t,n){return c.lookAtWorld(this,t,n)},i.pp_lookAtLocal=function(t,n){return c.lookAtLocal(this,t,n)},i.pp_lookTo=function(t,n){return c.lookTo(this,t,n)},i.pp_lookToWorld=function(t,n){return c.lookToWorld(this,t,n)},i.pp_lookToLocal=function(t,n){return c.lookToLocal(this,t,n)},i.pp_setParent=function(t,n=!0){return c.setParent(this,t,n)},i.pp_getParent=function(){return c.getParent(this)},i.pp_convertPositionObjectToWorld=function(t,n=d.create()){return c.convertPositionObjectToWorld(this,t,n)},i.pp_convertDirectionObjectToWorld=function(t,n=d.create()){return c.convertDirectionObjectToWorld(this,t,n)},i.pp_convertPositionWorldToObject=function(t,n=d.create()){return c.convertPositionWorldToObject(this,t,n)},i.pp_convertDirectionWorldToObject=function(t,n=d.create()){return c.convertDirectionWorldToObject(this,t,n)},i.pp_convertPositionLocalToWorld=function(t,n=d.create()){return c.convertPositionLocalToWorld(this,t,n)},i.pp_convertDirectionLocalToWorld=function(t,n=d.create()){return c.convertDirectionLocalToWorld(this,t,n)},i.pp_convertPositionWorldToLocal=function(t,n=d.create()){return c.convertPositionWorldToLocal(this,t,n)},i.pp_convertDirectionWorldToLocal=function(t,n=d.create()){return c.convertDirectionWorldToLocal(this,t,n)},i.pp_convertPositionObjectToLocal=function(t,n=d.create()){return c.convertPositionObjectToLocal(this,t,n)},i.pp_convertDirectionObjectToLocal=function(t,n=d.create()){return c.convertDirectionObjectToLocal(this,t,n)},i.pp_convertPositionLocalToObject=function(t,n=d.create()){return c.convertPositionLocalToObject(this,t,n)},i.pp_convertDirectionLocalToObject=function(t,n=d.create()){return c.convertDirectionLocalToObject(this,t,n)},i.pp_convertTransformObjectToWorld=function(t,n){return c.convertTransformObjectToWorld(this,t,n)},i.pp_convertTransformObjectToWorldMatrix=function(t,n=R.create()){return c.convertTransformObjectToWorldMatrix(this,t,n)},i.pp_convertTransformObjectToWorldQuat=function(t,n=V.create()){return c.convertTransformObjectToWorldQuat(this,t,n)},i.pp_convertTransformWorldToObject=function(t,n){return c.convertTransformWorldToObject(this,t,n)},i.pp_convertTransformWorldToObjectMatrix=function(t,n=R.create()){return c.convertTransformWorldToObjectMatrix(this,t,n)},i.pp_convertTransformWorldToObjectQuat=function(t,n=V.create()){return c.convertTransformWorldToObjectQuat(this,t,n)},i.pp_convertTransformLocalToWorld=function(t,n){return c.convertTransformLocalToWorld(this,t,n)},i.pp_convertTransformLocalToWorldMatrix=function(t,n=R.create()){return c.convertTransformLocalToWorldMatrix(this,t,n)},i.pp_convertTransformLocalToWorldQuat=function(t,n=V.create()){return c.convertTransformLocalToWorldQuat(this,t,n)},i.pp_convertTransformWorldToLocal=function(t,n){return c.convertTransformWorldToLocal(this,t,n)},i.pp_convertTransformWorldToLocalMatrix=function(t,n=R.create()){return c.convertTransformWorldToLocalMatrix(this,t,n)},i.pp_convertTransformWorldToLocalQuat=function(t,n=V.create()){return c.convertTransformWorldToLocalQuat(this,t,n)},i.pp_convertTransformObjectToLocal=function(t,n){return c.convertTransformObjectToLocal(this,t,n)},i.pp_convertTransformObjectToLocalMatrix=function(t,n=R.create()){return c.convertTransformObjectToLocalMatrix(this,t,n)},i.pp_convertTransformObjectToLocalQuat=function(t,n=V.create()){return c.convertTransformObjectToLocalQuat(this,t,n)},i.pp_convertTransformLocalToObject=function(t,n){return c.convertTransformLocalToObject(this,t,n)},i.pp_convertTransformLocalToObjectMatrix=function(t,n=R.create()){return c.convertTransformLocalToObjectMatrix(this,t,n)},i.pp_convertTransformLocalToObjectQuat=function(t,n=V.create()){return c.convertTransformLocalToObjectQuat(this,t,n)},i.pp_addComponent=function(t,n,o=null){return c.addComponent(this,t,n,o)},i.pp_getComponent=function(t,n=0){return c.getComponent(this,t,n)},i.pp_getComponentSelf=function(t,n=0){return c.getComponentSelf(this,t,n)},i.pp_getComponentHierarchy=function(t,n=0){return c.getComponentHierarchy(this,t,n)},i.pp_getComponentHierarchyBreadth=function(t,n=0){return c.getComponentHierarchyBreadth(this,t,n)},i.pp_getComponentHierarchyDepth=function(t,n=0){return c.getComponentHierarchyDepth(this,t,n)},i.pp_getComponentDescendants=function(t,n=0){return c.getComponentDescendants(this,t,n)},i.pp_getComponentDescendantsBreadth=function(t,n=0){return c.getComponentDescendantsBreadth(this,t,n)},i.pp_getComponentDescendantsDepth=function(t,n=0){return c.getComponentDescendantsDepth(this,t,n)},i.pp_getComponentChildren=function(t,n=0){return c.getComponentChildren(this,t,n)},i.pp_getComponents=function(t){return c.getComponents(this,t)},i.pp_getComponentsSelf=function(t){return c.getComponentsSelf(this,t)},i.pp_getComponentsHierarchy=function(t){return c.getComponentsHierarchy(this,t)},i.pp_getComponentsHierarchyBreadth=function(t){return c.getComponentsHierarchyBreadth(this,t)},i.pp_getComponentsHierarchyDepth=function(t){return c.getComponentsHierarchyDepth(this,t)},i.pp_getComponentsDescendants=function(t){return c.getComponentsDescendants(this,t)},i.pp_getComponentsDescendantsBreadth=function(t){return c.getComponentsDescendantsBreadth(this,t)},i.pp_getComponentsDescendantsDepth=function(t){return c.getComponentsDescendantsDepth(this,t)},i.pp_getComponentsChildren=function(t){return c.getComponentsChildren(this,t)},i.pp_setActive=function(t){return c.setActive(this,t)},i.pp_setActiveSelf=function(t){return c.setActiveSelf(this,t)},i.pp_setActiveHierarchy=function(t){return c.setActiveHierarchy(this,t)},i.pp_setActiveHierarchyBreadth=function(t){return c.setActiveHierarchyBreadth(this,t)},i.pp_setActiveHierarchyDepth=function(t){return c.setActiveHierarchyDepth(this,t)},i.pp_setActiveDescendants=function(t){return c.setActiveDescendants(this,t)},i.pp_setActiveDescendantsBreadth=function(t){return c.setActiveDescendantsBreadth(this,t)},i.pp_setActiveDescendantsDepth=function(t){return c.setActiveDescendantsDepth(this,t)},i.pp_setActiveChildren=function(t){return c.setActiveChildren(this,t)},i.pp_hasUniformScale=function(){return c.hasUniformScale(this)},i.pp_hasUniformScaleWorld=function(){return c.hasUniformScaleWorld(this)},i.pp_hasUniformScaleLocal=function(){return c.hasUniformScaleLocal(this)},i.pp_clone=function(t=new jt){return c.clone(this,t)},i.pp_isCloneable=function(t=new jt){return c.isCloneable(this,t)},i.pp_toString=function(){return c.toString(this)},i.pp_toStringExtended=function(){return c.toStringExtended(this)},i.pp_toStringCompact=function(){return c.toStringCompact(this)},i.pp_getObjectByName=function(t,n=!1,o=0){return c.getObjectByName(this,t,n,o)},i.pp_getObjectByNameHierarchy=function(t,n=!1,o=0){return c.getObjectByNameHierarchy(this,t,n,o)},i.pp_getObjectByNameHierarchyBreadth=function(t,n=!1,o=0){return c.getObjectByNameHierarchyBreadth(this,t,n,o)},i.pp_getObjectByNameHierarchyDepth=function(t,n=!1,o=0){return c.getObjectByNameHierarchyDepth(this,t,n,o)},i.pp_getObjectByNameDescendants=function(t,n=!1,o=0){return c.getObjectByNameDescendants(this,t,n,o)},i.pp_getObjectByNameDescendantsBreadth=function(t,n=!1,o=0){return c.getObjectByNameDescendantsBreadth(this,t,n,o)},i.pp_getObjectByNameDescendantsDepth=function(t,n=!1,o=0){return c.getObjectByNameDescendantsDepth(this,t,n,o)},i.pp_getObjectByNameChildren=function(t,n=!1,o=0){return c.getObjectByNameChildren(this,t,n,o)},i.pp_getObjectsByName=function(t,n=!1){return c.getObjectsByName(this,t,n)},i.pp_getObjectsByNameHierarchy=function(t,n=!1){return c.getObjectsByNameHierarchy(this,t,n)},i.pp_getObjectsByNameHierarchyBreadth=function(t,n=!1){return c.getObjectsByNameHierarchyBreadth(this,t,n)},i.pp_getObjectsByNameHierarchyDepth=function(t,n=!1){return c.getObjectsByNameHierarchyDepth(this,t,n)},i.pp_getObjectsByNameDescendants=function(t,n=!1){return c.getObjectsByNameDescendants(this,t,n)},i.pp_getObjectsByNameDescendantsBreadth=function(t,n=!1){return c.getObjectsByNameDescendantsBreadth(this,t,n)},i.pp_getObjectsByNameDescendantsDepth=function(t,n=!1){return c.getObjectsByNameDescendantsDepth(this,t,n)},i.pp_getObjectsByNameChildren=function(t,n=!1){return c.getObjectsByNameChildren(this,t,n)},i.pp_getObjectByID=function(t){return c.getObjectByID(this,t)},i.pp_getObjectByIDHierarchy=function(t){return c.getObjectByIDHierarchy(this,t)},i.pp_getObjectByIDHierarchyBreadth=function(t){return c.getObjectByIDHierarchyBreadth(this,t)},i.pp_getObjectByIDHierarchyDepth=function(t){return c.getObjectByIDHierarchyDepth(this,t)},i.pp_getObjectByIDDescendants=function(t){return c.getObjectByIDDescendants(this,t)},i.pp_getObjectByIDDescendantsBreadth=function(t){return c.getObjectByIDDescendantsBreadth(this,t)},i.pp_getObjectByIDDescendantsDepth=function(t){return c.getObjectByIDDescendantsDepth(this,t)},i.pp_getObjectByIDChildren=function(t){return c.getObjectByIDChildren(this,t)},i.pp_getHierarchyBreadth=function(){return c.getHierarchyBreadth(this)},i.pp_getHierarchyDepth=function(){return c.getHierarchyDepth(this)},i.pp_getDescendants=function(){return c.getDescendants(this)},i.pp_getDescendantsBreadth=function(){return c.getDescendantsBreadth(this)},i.pp_getDescendantsDepth=function(){return c.getDescendantsDepth(this)},i.pp_getChildren=function(){return c.getChildren(this)},i.pp_getSelf=function(){return c.getSelf(this)},i.pp_addObject=function(){return c.addObject(this)},i.pp_getName=function(){return c.getName(this)},i.pp_setName=function(t){return c.setName(this,t)},i.pp_getEngine=function(){return c.getEngine(this)},i.pp_getID=function(){return c.getID(this)},i.pp_markDirty=function(){return c.markDirty(this)},i.pp_isTransformChanged=function(){return c.isTransformChanged(this)},i.pp_equals=function(t){return c.equals(this,t)},i.pp_destroy=function(){return c.destroy(this)},i.pp_reserveObjects=function(t){return c.reserveObjects(this,t)},i.pp_reserveObjectsSelf=function(t){return c.reserveObjectsSelf(this,t)},i.pp_reserveObjectsHierarchy=function(t){return c.reserveObjectsHierarchy(this,t)},i.pp_reserveObjectsDescendants=function(t){return c.reserveObjectsDescendants(this,t)},i.pp_reserveObjectsChildren=function(t){return c.reserveObjectsChildren(this,t)},i.pp_getComponentsAmountMap=function(t=new Map){return c.getComponentsAmountMap(this,t)},i.pp_getComponentsAmountMapSelf=function(t=new Map){return c.getComponentsAmountMapSelf(this,t)},i.pp_getComponentsAmountMapHierarchy=function(t=new Map){return c.getComponentsAmountMapHierarchy(this,t)},i.pp_getComponentsAmountMapDescendants=function(t=new Map){return c.getComponentsAmountMapDescendants(this,t)},i.pp_getComponentsAmountMapChildren=function(t=new Map){return c.getComponentsAmountMapChildren(this,t)},xe.injectProperties(i,QE.prototype,!1,!0,!0)}import{Scene as qE}from"@wonderlandengine/api";function Ll(i){eP()}function eP(){let i={};i.pp_getRoot=function(){return Z.getRoot(this)},i.pp_addObject=function(){return Z.addObject(this)},i.pp_getObjects=function(){return Z.getObjects(this)},i.pp_getObjectsBreadth=function(){return Z.getObjectsBreadth(this)},i.pp_getObjectsDepth=function(){return Z.getObjectsDepth(this)},i.pp_getComponent=function(t,n=0){return Z.getComponent(this,t,n)},i.pp_getComponentBreadth=function(t,n=0){return Z.getComponentBreadth(this,t,n)},i.pp_getComponentDepth=function(t,n=0){return Z.getComponentDepth(this,t,n)},i.pp_getComponents=function(t){return Z.getComponents(this,t)},i.pp_getComponentsBreadth=function(t){return Z.getComponentsBreadth(this,t)},i.pp_getComponentsDepth=function(t){return Z.getComponentsDepth(this,t)},i.pp_getObjectByName=function(t,n=!1,o=0){return Z.getObjectByName(this,t,n,o)},i.pp_getObjectByNameBreadth=function(t,n=!1,o=0){return Z.getObjectByNameBreadth(this,t,n,o)},i.pp_getObjectByNameDepth=function(t,n=!1,o=0){return Z.getObjectByNameDepth(this,t,n,o)},i.pp_getObjectsByName=function(t,n=!1){return Z.getObjectsByName(this,t,n)},i.pp_getObjectsByNameBreadth=function(t,n=!1){return Z.getObjectsByNameBreadth(this,t,n)},i.pp_getObjectsByNameDepth=function(t,n=!1){return Z.getObjectsByNameDepth(this,t,n)},i.pp_getObjectByID=function(t){return Z.getObjectByID(this,t)},i.pp_getObjectByIDBreadth=function(t){return Z.getObjectByIDBreadth(this,t)},i.pp_getObjectByIDDepth=function(t){return Z.getObjectByIDDepth(this,t)},i.pp_toString=function(){return Z.toString(this)},i.pp_toStringCompact=function(){return Z.toStringCompact(this)},i.pp_toStringExtended=function(){return Z.toStringExtended(this)},i.pp_getComponentsAmountMap=function(t=new Map){return Z.getComponentsAmountMap(this,t)},xe.injectProperties(i,qE.prototype,!1,!0,!0)}function Hl(i){Bl(),Ll(i)}import{InputComponent as XE,ViewComponent as KE}from"@wonderlandengine/api";import{Cursor as JE,CursorTarget as kl,HitTestLocation as ZE}from"@wonderlandengine/components";var tP=function(){let i=new RegExp("Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini","i");return function(){let t=window.navigator.userAgent;return t!=null&&t.match(i)!=null}}();function iP(){return!ti.isMobile()}var nP=function(){let i=new RegExp("(localhost|127\\.0\\.0\\.1)(:(\\d{4}))?");return function(t=null,n=!1){let o=!1,s=window.location.origin.match(i);if(s!=null){if(t==null)o=!0;else if(s.length>=4&&s[3]!=null){let a=s[3];n?o=a.match(t)!=null:o=a==t}}return o}}();function oP(i,e=!0,t=!0,n=!0,o=!1,s=null,a=null,l=m.getMainEngine()){let h=document.createElement("a");h.style.display="none",document.body.appendChild(h),h.addEventListener("click",function(){let _;e?_="_blank":_="_top",window.open(i,_)!=null?(!t&&n&&O.exitSession(l),s?.()):o?setTimeout(function(){ti.openLinkOnClick(i,e,n,s,a)},100):a?.()}),t&&O.exitSession(l),h.click(),document.body.removeChild(h)}function sP(i,e=!0,t=!0,n=null,o=null,s=m.getMainEngine()){document.addEventListener("click",function(){let a;e?a="_blank":a="_top",window.open(i,a)!=null?(t&&O.exitSession(s),n?.()):o?.()},{once:!0})}var ti={isMobile:tP,isDesktop:iP,isLocalhost:nP,openLink:oP,openLinkOnClick:sP};function aP(i=m.getMainEngine()){let e=m.getXR(i);return e!=null?e.session:null}function rP(i=m.getMainEngine()){let e=m.getXR(i);return e!=null?e.sessionMode:null}function lP(i=m.getMainEngine()){let e=m.getXR(i);return e!=null?e.currentReferenceSpace:null}function mP(i=m.getMainEngine()){let e="local";try{let t=m.getXR(i);e=t!=null?t.currentReferenceSpaceType:null}catch{}return e}function yP(i=m.getMainEngine()){let e=m.getXR(i);return e!=null?e.frame:null}function uP(i=m.getMainEngine()){return O.getSession(i)!=null}function hP(i=m.getMainEngine()){return O.getReferenceSpaceType(i).includes("floor")}function cP(i=m.getMainEngine()){let e=O.getSession(i);e?.end()}function pP(i,e,t=!1,n=!1,o=m.getMainEngine()){e!=null&&(n?o.onXRSessionStart.add(e.bind(void 0,!1),{id:i,immediate:!1}):o.onXRSessionStart.add(e,{id:i,immediate:!1}),t&&O.isSessionActive(o)&&(n?e(!0,O.getSession(o),O.getSessionMode(o)):e(O.getSession(o),O.getSessionMode(o))))}function dP(i,e=m.getMainEngine()){e.onXRSessionStart.remove(i)}function _P(i,e,t=m.getMainEngine()){e!=null&&t.onXRSessionEnd.add(e,{id:i})}function gP(i,e=m.getMainEngine()){return e.onXRSessionEnd.remove(i)}function fP(i,e,t,n=!1,o=!1,s=m.getMainEngine()){O.registerSessionEndEventListener(i,t,s),O.registerSessionStartEventListener(i,e,n,o,s)}function TP(i,e=m.getMainEngine()){O.unregisterSessionEndEventListener(i,e),O.unregisterSessionStartEventListener(i,e)}function PP(i=m.getMainEngine()){return O.isVRSupported(i)||O.isARSupported(i)}function CP(i=m.getMainEngine()){return i.vrSupported}function bP(i=m.getMainEngine()){return i.arSupported}function SP(i=!0){return window.CustomWebXRPolyfill!=null&&(!i||ti.isLocalhost())}var O={getSession:aP,getSessionMode:rP,getReferenceSpace:lP,getReferenceSpaceType:mP,getFrame:yP,isSessionActive:uP,exitSession:cP,registerSessionStartEventListener:pP,unregisterSessionStartEventListener:dP,registerSessionEndEventListener:_P,unregisterSessionEndEventListener:gP,registerSessionStartEndEventListeners:fP,unregisterSessionStartEndEventListeners:TP,isReferenceSpaceFloorBased:hP,isXRSupported:PP,isVRSupported:CP,isARSupported:bP,isDeviceEmulated:SP};var A={LEFT:"left",RIGHT:"right"},vi={LEFT:0,RIGHT:1},lt={GAMEPAD:0,TRACKED_HAND:1},ot={WRIST:"wrist",THUMB_METACARPAL:"thumb-metacarpal",THUMB_PHALANX_PROXIMAL:"thumb-phalanx-proximal",THUMB_PHALANX_DISTAL:"thumb-phalanx-distal",THUMB_TIP:"thumb-tip",INDEX_FINGER_METACARPAL:"index-finger-metacarpal",INDEX_FINGER_PHALANX_PROXIMAL:"index-finger-phalanx-proximal",INDEX_FINGER_PHALANX_INTERMEDIATE:"index-finger-phalanx-intermediate",INDEX_FINGER_PHALANX_DISTAL:"index-finger-phalanx-distal",INDEX_FINGER_TIP:"index-finger-tip",MIDDLE_FINGER_METACARPAL:"middle-finger-metacarpal",MIDDLE_FINGER_PHALANX_PROXIMAL:"middle-finger-phalanx-proximal",MIDDLE_FINGER_PHALANX_INTERMEDIATE:"middle-finger-phalanx-intermediate",MIDDLE_FINGER_PHALANX_DISTAL:"middle-finger-phalanx-distal",MIDDLE_FINGER_TIP:"middle-finger-tip",RING_FINGER_METACARPAL:"ring-finger-metacarpal",RING_FINGER_PHALANX_PROXIMAL:"ring-finger-phalanx-proximal",RING_FINGER_PHALANX_INTERMEDIATE:"ring-finger-phalanx-intermediate",RING_FINGER_PHALANX_DISTAL:"ring-finger-phalanx-distal",RING_FINGER_TIP:"ring-finger-tip",PINKY_FINGER_METACARPAL:"pinky-finger-metacarpal",PINKY_FINGER_PHALANX_PROXIMAL:"pinky-finger-phalanx-proximal",PINKY_FINGER_PHALANX_INTERMEDIATE:"pinky-finger-phalanx-intermediate",PINKY_FINGER_PHALANX_DISTAL:"pinky-finger-phalanx-distal",PINKY_FINGER_TIP:"pinky-finger-tip"},bn={WRIST:0,THUMB_METACARPAL:1,THUMB_PHALANX_PROXIMAL:2,THUMB_PHALANX_DISTAL:3,THUMB_TIP:4,INDEX_FINGER_METACARPAL:5,INDEX_FINGER_PHALANX_PROXIMAL:6,INDEX_FINGER_PHALANX_INTERMEDIATE:7,INDEX_FINGER_PHALANX_DISTAL:8,INDEX_FINGER_TIP:9,MIDDLE_FINGER_METACARPAL:10,MIDDLE_FINGER_PHALANX_PROXIMAL:11,MIDDLE_FINGER_PHALANX_INTERMEDIATE:12,MIDDLE_FINGER_PHALANX_DISTAL:13,MIDDLE_FINGER_TIP:14,RING_FINGER_METACARPAL:15,RING_FINGER_PHALANX_PROXIMAL:16,RING_FINGER_PHALANX_INTERMEDIATE:17,RING_FINGER_PHALANX_DISTAL:18,RING_FINGER_TIP:19,PINKY_FINGER_METACARPAL:20,PINKY_FINGER_PHALANX_PROXIMAL:21,PINKY_FINGER_PHALANX_INTERMEDIATE:22,PINKY_FINGER_PHALANX_DISTAL:23,PINKY_FINGER_TIP:24};function vP(i){let e=null;switch(i){case vi.LEFT:e=A.LEFT;break;case vi.RIGHT:e=A.RIGHT;break}return e}function xP(i,e=null,t=m.getMainEngine()){let n=null,o=O.getSession(t);if(o!=null&&o.inputSources!=null)for(let s=0;s<o.inputSources.length;s++){let a=o.inputSources[s];if((!e||e==lt.GAMEPAD&&!a.hand||e==lt.TRACKED_HAND&&a.hand)&&a.handedness==i){n=a;break}}return n}function MP(i,e){let t=ie.getInputSource(i,void 0,e);return ie.getInputSourceType(t)}function DP(i){let e=null;return i&&(i.hand?e=lt.TRACKED_HAND:e=lt.GAMEPAD),e}function EP(i){let e=null;switch(i){case A.LEFT:e=A.RIGHT;break;case A.RIGHT:e=A.LEFT;break}return e}function AP(i){let e=null,t=null;for(let n in bn)if(bn[n]==i){t=n;break}return t!=null&&(e=ot[t]),e}var ie={getHandednessByIndex:vP,getInputSource:xP,getInputSourceTypeByHandedness:MP,getInputSourceType:DP,getOppositeHandedness:EP,getJointIDByIndex:AP};function Fl(){RP()}function RP(){let i={};i.init=function(){this.maxDistance=100,this.visible=!1,this.globalTarget=this.object.pp_addComponent(kl),this.hitTestTarget=this.object.pp_addComponent(kl),this.hoveringObject=null,this.hoveringObjectTarget=null,this.cursorPos=p(),this._collisionMask=1<<this.collisionGroup,this._doubleClickTimer=0,this._tripleClickTimer=0,this._multipleClickObject=null,this._multipleClickDelay=.3,this._onDestroyCallbacks=[],this._prevHitLocationLocalToTarget=p(),this._pointerID=null,this._updatePointerStyle=!1,this._lastClientX=null,this._lastClientY=null,this._lastWidth=null,this._lastHeight=null,this._lastPointerID=null,this._lastOriginalMouseEvent=null,this._lastOriginalGamepadEvent=null,this._pointerLeaveToProcess=!1,this._pointerLeaveMouseEvent=null,this._transformQuat=G(),this._origin=p(),this._direction=p(),this._isHovering=!1,this._isDown=!1,this._lastIsDown=!1,this._isRealDown=!1,this._isDownForUpWithDown=!1,this._isUpWithNoDown=!1,this._tempVec=p(),this._viewComponent=null,this._cursorRayOrigin=p(),this._cursorRayScale=p(),this._projectionMatrix=be(),this._hitTestLocation=null,this._hitTestObject=null,this._rayHitLocation=p(),this._hitObjectData=[null,null,null],this._myViewEventListenersRegistered=!1},i.start=function(){if(this.handedness==0){let t=this.object.pp_getComponent(XE);t?(this.handedness=t.handedness,this.input=t):console.warn("cursor component on object "+this.object.pp_getName()+' was configured with handedness "input component", but object has no input component.')}else this.handedness=ie.getHandednessByIndex(this.handedness-1);this.pp_setViewComponent(this.object.pp_getComponent(KE)),O.registerSessionStartEventListener(this,this.setupVREvents.bind(this),!0,!1,this.engine),this._onDestroyCallbacks.push(()=>{O.unregisterSessionStartEventListener(this,this.engine)}),this.cursorRayObject&&(this.cursorRayObject.pp_setActive(!1),this._cursorRayScale.set(this.cursorRayObject.pp_getScaleLocal()),this._setCursorRayTransform(null)),this._setCursorVisibility(!1),this.useWebXRHitTest&&(this._hitTestObject=this.object.pp_addObject(),this._hitTestLocation=this.hitTestObject.pp_addComponent(ZE,{scaleObject:!1}))},i.update=function(t){if(this._doubleClickTimer>0&&(this._doubleClickTimer-=t),this._tripleClickTimer>0&&(this._tripleClickTimer-=t),O.isSessionActive(this.engine)&&this._viewComponent==null){if(this.arTouchDown&&this._pp_isAR()){let o=O.getSession(this.engine).inputSources[0].gamepad.axes;this._direction.vec3_set(o[0],-o[1],-1),this.updateDirection()}else this.object.pp_getPosition(this._origin),this.object.pp_getForward(this._direction);let n=this._pp_rayCast();this._pp_hoverBehaviour(n[0],n[1],n[2],this._lastOriginalGamepadEvent)}else if(!O.isSessionActive(this.engine)&&this._viewComponent!=null)if(this._lastPointerID!=null){this._pp_updateMousePos(this._lastClientX,this._lastClientY,this._lastWidth,this._lastHeight);let n=this._pp_rayCast();this._pp_hoverBehaviour(n[0],n[1],n[2],this._lastOriginalMouseEvent),this.hoveringObject!=null?this._pointerID=this._lastPointerID:this._pointerID=null}else this.hoveringObject!=null&&this._pp_hoverBehaviour(null,null,null,this._lastOriginalMouseEvent,!0);else this.hoveringObject!=null&&this._pp_hoverBehaviour(null,null,null,null,!0);this._pp_processPointerLeave(),this.hoveringObject!=null&&(this.cursorPos[0]!=0||this.cursorPos[1]!=0||this.cursorPos[2]!=0)?(this.cursorObject&&(this._setCursorVisibility(!0),this.cursorObject.pp_setPosition(this.cursorPos),this.cursorObject.pp_setTransformLocalQuat(this.cursorObject.pp_getTransformLocalQuat(this._transformQuat).quat2_normalize(this._transformQuat))),this.cursorRayObject&&this._setCursorRayTransform(this.cursorPos)):(this.cursorObject&&this._setCursorVisibility(!1),this.cursorRayObject&&this._setCursorRayTransform(null)),this.cursorRayObject&&(O.isSessionActive(this.engine)&&this._viewComponent==null||!O.isSessionActive(this.engine)&&this._viewComponent!=null&&this.handedness!=A.LEFT&&this.handedness!=A.RIGHT?this.cursorRayObject.pp_setActive(!0):this.cursorRayObject.pp_setActive(!1)),this.hoveringObject==null&&(this._pointerID=null),this._updatePointerStyle=!1,this._lastOriginalMouseEvent=null,this._lastOriginalGamepadEvent=null},i.onActivate=function(){this._isDown=!1,this._lastIsDown=!1,this._isDownForUpWithDown=!1,this._isUpWithNoDown=!1},i.onDeactivate=function(){this.hoveringObject!=null&&this._pp_hoverBehaviour(null,null,null,null,!0),this.hoveringObject=null,this.hoveringObjectTarget=null,this._pp_updateCursorStyle(),this._setCursorVisibility(!1),this.cursorRayObject&&this.cursorRayObject.pp_setActive(!1),this._isDown=!1,this._lastIsDown=!1,this._isRealDown=!1,this._isDownForUpWithDown=!1,this._isUpWithNoDown=!1,this._pointerID=null,this._lastPointerID=null,this._lastClientX=null,this._lastClientY=null,this._lastWidth=null,this._lastHeight=null,this._lastOriginalMouseEvent=null,this._lastOriginalGamepadEvent=null,this._pointerLeaveToProcess=!1,this._pointerLeaveMouseEvent=null},i.onDestroy=function(){this._hitTestObject!=null&&this._hitTestObject.pp_destroy();for(let t of this._onDestroyCallbacks)t()},i.updateDirection=function(){let e=G();return function(){this.object.pp_getPosition(this._origin),this._direction.vec3_transformMat4(this._projectionMatrix,this._direction),this._direction.vec3_normalize(this._direction),this._direction.vec3_transformQuat(this.object.pp_getTransformQuat(e),this._direction)}}(),i.setupVREvents=function(t){let n=this.onSelect.bind(this);t.addEventListener("select",n);let o=this.onSelectStart.bind(this);t.addEventListener("selectstart",o);let s=this.onSelectEnd.bind(this);t.addEventListener("selectend",s),this._onDestroyCallbacks.push(()=>{if(!O.isSessionActive(this.engine))return;let a=O.getSession(this.engine);a.removeEventListener("select",n),a.removeEventListener("selectstart",o),a.removeEventListener("selectend",s)}),this._onViewportResize()},i.onSelect=function(t){},i.onSelectStart=function(t){this.active&&(this._pp_isAR()?(this.arTouchDown=!0,this._lastOriginalGamepadEvent=t):t.inputSource.handedness==this.handedness&&(this._isDown=!0,this._isRealDown=!0,this._lastIsDown||(this._isDownForUpWithDown=!0),this._lastOriginalGamepadEvent=t))},i.onSelectEnd=function(t){this.active&&(this._pp_isAR()?(this.arTouchDown=!1,this._lastOriginalGamepadEvent=t):t.inputSource.handedness==this.handedness&&(this._isDownForUpWithDown||(this._isUpWithNoDown=!0),this._isDown=!1,this._isRealDown=!1,this._isDownForUpWithDown=!1,this._lastOriginalGamepadEvent=t))},i.onPointerMove=function(t){if(this.active&&!this._pointerLeaveToProcess){if(this._pointerID!=null&&this._pointerID!=t.pointerId)return;let n=m.getBody(this.engine).getBoundingClientRect();this._pp_updateMouseData(t,t.clientX,t.clientY,n.width,n.height,t.pointerId)}},i.onClick=function(t){},i.onPointerDown=function(t){if(this.active&&!this._pointerLeaveToProcess){if(this._pointerID!=null&&this._pointerID!=t.pointerId||t.button!==0)return;let n=m.getBody(this.engine).getBoundingClientRect();this._pp_updateMouseData(t,t.clientX,t.clientY,n.width,n.height,t.pointerId),this._isDown=!0,this._isRealDown=!0,this._lastIsDown||(this._isDownForUpWithDown=!0)}},i.onPointerUp=function(t){if(this.active&&!this._pointerLeaveToProcess){if(this._pointerID!=null&&this._pointerID!=t.pointerId||t.button!==0)return;let n=m.getBody(this.engine).getBoundingClientRect();this._pp_updateMouseData(t,t.clientX,t.clientY,n.width,n.height,t.pointerId),this._isDownForUpWithDown||(this._isUpWithNoDown=!0),this._isDown=!1,this._isRealDown=!1,this._isDownForUpWithDown=!1,this._updatePointerStyle=!0}},i._onViewportResize=function(){this._viewComponent&&this._viewComponent.projectionMatrix.mat4_invert(this._projectionMatrix)},i._setCursorRayTransform=function(t){if(this.cursorRayObject&&this.cursorRayScalingAxis!=4&&(this.cursorRayObject.pp_resetScaleLocal(),t!=null)){this.cursorRayObject.pp_getPosition(this._cursorRayOrigin);let n=this._cursorRayOrigin.vec3_distance(t);this._cursorRayScale[this.cursorRayScalingAxis]=n,this.cursorRayObject.pp_scaleObject(this._cursorRayScale)}},i._setCursorVisibility=function(t){this.visible=t,this.cursorObject&&this.cursorObject.pp_setActive(t)},i._pp_hoverBehaviour=function(t,n,o,s=null,a=!1){if(!a&&t!=null){let l=!1;(this.hoveringObject==null||!this.hoveringObject.pp_equals(t))&&(this.hoveringObject!=null&&(this.hoveringReality?this.hitTestTarget.onUnhover.notify(null,this,s):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onUnhover.notify(this.hoveringObject,this,s),this.globalTarget.onUnhover.notify(this.hoveringObject,this,s))),l=!0,this.hoveringObject=t,this.hoveringObjectTarget=this.hoveringObject.pp_getComponent(kl),this.hoveringReality?this.hitTestTarget.onHover.notify(o,this,s):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onHover.notify(this.hoveringObject,this,s),this.globalTarget.onHover.notify(this.hoveringObject,this,s)),this._pp_updateCursorStyle(),!this._pp_isDownToProcess()&&this._isRealDown&&(this._isDown=!0,this._lastIsDown=!0,this._isDownForUpWithDown=!1,this._isUpWithNoDown=!1,this.hoveringReality?this.hitTestTarget.onDownOnHover.notify(o,this,s):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onDownOnHover.notify(this.hoveringObject,this,s),this.globalTarget.onDownOnHover.notify(this.hoveringObject,this,s)))),this._updatePointerStyle&&this._pp_updateCursorStyle(),!l&&this._pp_isMoving(n)&&(this.hoveringReality?this.hitTestTarget.onMove.notify(o,this,s):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onMove.notify(this.hoveringObject,this,s),this.globalTarget.onMove.notify(this.hoveringObject,this,s))),this._pp_isDownToProcess()?(this.hoveringReality?this.hitTestTarget.onDown.notify(o,this,s):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onDown.notify(this.hoveringObject,this,s),this.globalTarget.onDown.notify(this.hoveringObject,this,s)),this.hoveringReality?this.hitTestTarget.onClick.notify(o,this,s):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onClick.notify(this.hoveringObject,this,s),this.globalTarget.onClick.notify(this.hoveringObject,this,s)),this._tripleClickTimer>0&&this._multipleClickObject&&this._multipleClickObject.pp_equals(this.hoveringObject)?(this.hoveringReality?this.hitTestTarget.onTripleClick.notify(o,this,s):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onTripleClick.notify(this.hoveringObject,this,s),this.globalTarget.onTripleClick.notify(this.hoveringObject,this,s)),this._tripleClickTimer=0):this._doubleClickTimer>0&&this._multipleClickObject&&this._multipleClickObject.pp_equals(this.hoveringObject)?(this.hoveringReality?this.hitTestTarget.onDoubleClick.notify(o,this,s):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onDoubleClick.notify(this.hoveringObject,this,s),this.globalTarget.onDoubleClick.notify(this.hoveringObject,this,s)),this._tripleClickTimer=this._multipleClickDelay,this._doubleClickTimer=0):(this.hoveringReality?this.hitTestTarget.onSingleClick.notify(o,this,s):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onSingleClick.notify(this.hoveringObject,this,s),this.globalTarget.onSingleClick.notify(this.hoveringObject,this,s)),this._tripleClickTimer=0,this._doubleClickTimer=this._multipleClickDelay,this._multipleClickObject=this.hoveringObject)):!this._isUpWithNoDown&&!l&&this._pp_isUpToProcess()?this.hoveringReality?(this.hitTestTarget.onUp.notify(o,this,s),this.hitTestTarget.onUpWithDown.notify(o,this,s)):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onUp.notify(this.hoveringObject,this,s),this.globalTarget.onUp.notify(this.hoveringObject,this,s),this.hoveringObjectTarget&&this.hoveringObjectTarget.onUpWithDown.notify(this.hoveringObject,this,s),this.globalTarget.onUpWithDown.notify(this.hoveringObject,this,s)):(this._isUpWithNoDown||l&&this._pp_isUpToProcess())&&(this.hoveringReality?(this.hitTestTarget.onUp.notify(o,this,s),this.hitTestTarget.onUpWithNoDown.notify(o,this,s)):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onUp.notify(this.hoveringObject,this,s),this.globalTarget.onUp.notify(this.hoveringObject,this,s),this.hoveringObjectTarget&&this.hoveringObjectTarget.onUpWithNoDown.notify(this.hoveringObject,this,s),this.globalTarget.onUpWithNoDown.notify(this.hoveringObject,this,s))),this._prevHitLocationLocalToTarget=this.hoveringObject.pp_convertPositionWorldToLocal(n,this._prevHitLocationLocalToTarget)}else this.hoveringObject!=null&&(a||t==null)&&(this.hoveringReality?this.hitTestTarget.onUnhover.notify(null,this,s):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onUnhover.notify(this.hoveringObject,this,s),this.globalTarget.onUnhover.notify(this.hoveringObject,this,s)),this.hoveringObject=null,this.hoveringObjectTarget=null,this._pp_updateCursorStyle());this.hoveringObject!=null?this._lastIsDown=this._isDown:(this._isDown=!1,this._lastIsDown=!1,this._isDownForUpWithDown=!1),this._isUpWithNoDown=!1},i._pp_rayCast=function(){let t=this.rayCastMode==0?m.getScene(this.engine).rayCast(this._origin,this._direction,this._collisionMask):m.getPhysics(this.engine).rayCast(this._origin,this._direction,this._collisionMask,this.maxDistance),n=!0;this.rayCastMode==0&&t.hitCount>0&&t.distances[0]>this.maxDistance&&(n=!1),this._hitObjectData[0]=null,this._hitObjectData[1]=null,this._hitObjectData[2]=null;let o=1/0;this._hitTestLocation!=null&&this._hitTestLocation.visible&&(this._hitTestObject.pp_getPositionWorld(this.cursorPos),this._rayHitLocation.vec3_copy(this.cursorPos),o=this.cursorPos.vec3_distance(this.object.pp_getPositionWorld(this._tempVec)),this._hitObjectData[0]=this._hitTestObject,this._hitObjectData[1]=this._rayHitLocation),this.hoveringReality=!1,t.hitCount>0&&n?t.distances[0]<=o?(this.cursorPos.vec3_copy(t.locations[0]),this._rayHitLocation.vec3_copy(this.cursorPos),this._hitObjectData[0]=t.objects[0],this._hitObjectData[1]=this._rayHitLocation):this.hoveringReality=!0:o==1/0&&(this.cursorPos.vec3_zero(),this._hitObjectData[0]=null,this._hitObjectData[1]=null);let s=O.getFrame(this.engine);return this.hoveringReality&&s!=null&&(this._hitObjectData[2]=this._hitTestLocation.getHitTestResults(s)[0]),this._hitObjectData},i._pp_updateMouseData=function(t,n,o,s,a,l){this._lastClientX=n,this._lastClientY=o,this._lastWidth=s,this._lastHeight=a,this._lastPointerID=l,this._lastOriginalMouseEvent=t},i._pp_updateMousePos=function(t,n,o,s){let a=t/o,l=n/s;this._direction.vec3_set(a*2-1,-l*2+1,-1),this.updateDirection()},i.pp_setViewComponent=function(t){if(this._viewComponent=t,this._viewComponent!=null&&(this._viewComponent.projectionMatrix.mat4_invert(this._projectionMatrix),!this._myViewEventListenersRegistered)){this._myViewEventListenersRegistered=!0;let n=this.onClick.bind(this);m.getCanvas(this.engine).addEventListener("click",n);let o=this.onPointerDown.bind(this);m.getCanvas(this.engine).addEventListener("pointerdown",o);let s=this.onPointerMove.bind(this);m.getCanvas(this.engine).addEventListener("pointermove",s);let a=this.onPointerUp.bind(this);m.getCanvas(this.engine).addEventListener("pointerup",a);let l=this._pp_onPointerLeave.bind(this);m.getCanvas(this.engine).addEventListener("pointerleave",l);let h=this._onViewportResize.bind(this);this.engine.onResize.add(h),this._onDestroyCallbacks.push(()=>{m.getCanvas(this.engine).removeEventListener("click",n),m.getCanvas(this.engine).removeEventListener("pointerdown",o),m.getCanvas(this.engine).removeEventListener("pointermove",s),m.getCanvas(this.engine).removeEventListener("pointerup",a),m.getCanvas(this.engine).removeEventListener("pointerleave",l),this.engine.onResize.remove(h),this._myViewEventListenersRegistered=!1})}},i._pp_onPointerLeave=function(t){(this._pointerID==null||this._pointerID==t.pointerId)&&(this._pointerLeaveToProcess=!0,this._pointerLeaveMouseEvent=t)},i._pp_processPointerLeave=function(){this._pointerLeaveToProcess&&(this._pointerID=null,this._lastPointerID=null,this._lastClientX=null,this._lastClientY=null,this._lastWidth=null,this._lastHeight=null,this._lastOriginalMouseEvent=this._pointerLeaveMouseEvent,this._pointerLeaveToProcess=!1,this._pointerLeaveMouseEvent=null,this.hoveringObject!=null&&this._pp_hoverBehaviour(null,null,null,this._lastOriginalMouseEvent,!0),this._isDown=!1,this._lastIsDown=!1,this._isRealDown=!1,this._isDownForUpWithDown=!1,this._isUpWithNoDown=!1)},i._pp_isDownToProcess=function(){return this._isDown!==this._lastIsDown&&this._isDown},i._pp_isUpToProcess=function(){return this._isDown!==this._lastIsDown&&!this._isDown},i._pp_isMoving=function(){let e=p();return function(n){let o=!1;return e=this.hoveringObject.pp_convertPositionWorldToLocal(n,e),e.vec_equals(this._prevHitLocationLocalToTarget,1e-4)||(o=!0),o}}(),i._pp_isAR=function(){let t=O.getSession(this.engine).inputSources[0];return this.input!=null&&t.handedness==="none"&&t.gamepad!=null},i._pp_updateCursorStyle=function(){this.styleCursor&&(this.hoveringObjectTarget!=null&&!this.hoveringObjectTarget.isSurface?m.getBody(this.engine).style.cursor="pointer":m.getBody(this.engine).style.cursor=="pointer"&&(m.getBody(this.engine).style.cursor="default"))},xe.injectProperties(i,JE.prototype,!1,!0,!0)}import{Emitter as Sn}from"@wonderlandengine/api";import{CursorTarget as YE}from"@wonderlandengine/components";function wl(){VP()}function VP(){let i={};i.init=function(){this.onSingleClick=new Sn,this.onDoubleClick=new Sn,this.onTripleClick=new Sn,this.onDownOnHover=new Sn,this.onUpWithDown=new Sn,this.onUpWithNoDown=new Sn,this.isSurface=!1},i.start=function(){},i.update=function(t){},i.onActivate=function(){},i.onDeactivate=function(){},i.onDestroy=function(){},xe.injectProperties(i,YE.prototype,!1,!0,!0)}import{MouseLookComponent as eA}from"@wonderlandengine/components";import{Emitter as $E}from"@wonderlandengine/api";var te=class{constructor(e,t=!0){this._myDuration=e,this._myOnEndEmitter=new $E,this._myDone=!1,this._myJustDone=!1,this._myStarted=!1,t?this.start():this.reset()}start(e=null){this.reset(e),this._myStarted=!0}end(){this._done()}reset(e=null){e!=null&&(this._myDuration=Math.max(0,e)),this._myTimeLeft=this._myDuration,this._myDone=!1,this._myJustDone=!1,this._myStarted=!1}update(e){this._myJustDone=!1,this.isRunning()&&(this._myTimeLeft=Math.max(0,this._myTimeLeft-e),this._myTimeLeft==0&&this._done())}isDone(){return this._myDone}isJustDone(){return this._myJustDone}isStarted(){return this._myStarted}isRunning(){return this.isStarted()&&!this.isDone()}getDuration(){return this._myDuration}setDuration(e){this._myDuration=Math.max(0,e)}getTimeLeft(){return this._myTimeLeft}getPercentage(){let e=1;return this._myTimeLeft>0&&this._myDuration>0&&(e=(this._myDuration-this._myTimeLeft)/this._myDuration),Math.pp_clamp(e,0,1)}setPercentage(e){if(this.isRunning()){let t=Math.pp_clamp(1-e,0,1);this._myTimeLeft=this._myDuration*t}}onEnd(e,t=null){this._myOnEndEmitter.add(e,{id:t})}unregisterOnEnd(e=null){this._myOnEndEmitter.remove(e)}_done(){this._myTimeLeft=0,this._myDone=!0,this._myJustDone=!0,this._myOnEndEmitter.notify()}};function jl(){OP()}function OP(){let i={};i.init=function(){this.pointerId=null,this.prevMoveEvent=null,this.resetMovingDelay=.15,this.resetMovingTimer=new te(this.resetMovingDelay,!1),this.isMoving=!1,this.pointerMoveListener=this._onMove.bind(this),this.contextMenuListener=function(t){this.active&&t.preventDefault()}.bind(this),this.pointerDown=function(t){if(this.active){if(this.pointerId!=null)return;if(!this.mouseDown&&t.button==this.mouseButtonIndex&&(this.pointerId=t.pointerId,this.mouseDown=!0,t.button==1))return t.preventDefault(),!1}}.bind(this),this.pointerUp=function(t){if(this.active){if(t.pointerId!=this.pointerId)return;this.mouseDown&&t.button==this.mouseButtonIndex&&(this.mouseDown=!1)}}.bind(this),this.pointerLeave=function(t){if(this.active){if(t.pointerId!=this.pointerId)return;this.pointerId=null,this.prevMoveEvent=null,this.mouseDown&&(this.mouseDown=!1)}}.bind(this),m.getBody(this.engine).addEventListener("pointermove",this.pointerMoveListener),this.requireMouseDown&&(this.mouseButtonIndex==2&&m.getCanvas(this.engine).addEventListener("contextmenu",this.contextMenuListener,!1),m.getCanvas(this.engine).addEventListener("pointerdown",this.pointerDown),m.getBody(this.engine).addEventListener("pointerup",this.pointerUp)),m.getBody(this.engine).addEventListener("pointerleave",this.pointerLeave)},i.start=function(){},i.onActivate=function(){},i.onDeactivate=function(){this.mouseDown,this.isMoving=!1,this.mouseDown=!1,this.pointerId=null,this.prevMoveEvent=null},i.onDestroy=function(){m.getBody(this.engine).removeEventListener("pointermove",this.pointerMoveListener),m.getCanvas(this.engine).removeEventListener("contextmenu",this.contextMenuListener),m.getCanvas(this.engine).removeEventListener("pointerdown",this.pointerDown),m.getBody(this.engine).removeEventListener("pointerup",this.pointerUp),m.getBody(this.engine).removeEventListener("pointerleave",this.pointerLeave)},i.update=function(t){this.resetMovingTimer.isRunning()&&(this.resetMovingTimer.update(t),this.resetMovingTimer.isDone()&&(this.resetMovingTimer.reset(),this.isMoving=!1)),this.isMoving||((!this.requireMouseDown||!this.mouseDown)&&(this.pointerId=null),this.prevMoveEvent=null)},i._onMove=function(){let e=p(),t=p(),n=p(),o=p(),s=p(),a=p();return function(h){if(this.active){if(this.pointerId!=null&&h.pointerId!=this.pointerId)return;if(this.mouseDown||!this.requireMouseDown){e=this.object.pp_getBackward(e),t=this.object.pp_getUp(t),n.vec3_set(0,1,0),this.object.pp_getParent()!=null&&(n=this.object.pp_getParent().pp_getUp(n)),s=e.vec3_cross(n,s);let _=1;e.vec3_angle(n)<_?s=t.vec3_negate(s).vec3_cross(n,s):e.vec3_angle(n.vec3_negate(o))<_?s=t.vec3_cross(n,s):t.vec3_isConcordant(n)||s.vec3_negate(s),s.vec3_normalize(s);let y=h.movementX,r=h.movementY;(y==null||r==null)&&(this.prevMoveEvent!=null?(y=h.pageX-this.prevMoveEvent.pageX,r=h.pageY-this.prevMoveEvent.pageY):(y=0,r=0)),this.rotationX=-this.sensitity*y,this.rotationY=-this.sensitity*r,this.object.pp_rotateAxis(this.rotationY,s);let u=90-.001;a=this.object.pp_getUp(a);let g=Math.pp_angleClamp(a.vec3_angleSigned(n,s));if(Math.abs(g)>u){let P=(Math.abs(g)-u)*Math.pp_sign(g);this.object.pp_rotateAxis(P,s)}this.object.pp_rotateAxis(this.rotationX,n),this.prevMoveEvent=h,this.pointerId=h.pointerId,this.resetMovingTimer.start(this.resetMovingDelay),this.isMoving=!0}}}}(),xe.injectProperties(i,eA.prototype,!1,!0,!0)}function zl(){Fl(),wl(),jl()}function Gl(){zl()}function Nl(i){Hl(i),Gl()}function Ul(i){Il(),Nl(i)}function Wl(i){i.registerComponent(ki,Bi,So,ii,To,Po,Vo,Oo,Co,No,wo,jo,Go,zo,Eo,Do,mt,si,Mo,xo,Ro,Ao,Qo,qo,Xo,Ko,Jo,Yo,Zo,$o,es,Wo,Uo,Li,Hi,ji,Ho,xn,mi,yi,Fi,wi,ri,li,ai,go,ni,_o,Io,bo,Mn,zi,Fo,Dn,vo,fo,Bo,En,Lo,xi,vn,ko,oi)}function Ql(i){m.initEngine(i),j.setDefaultWLComponentCloneCallbacks(i),$r(i),Wl(i),Ul(i)}var ts=class{constructor(){this.myScene=null,this.myCauldron=null,this.myDynamics=null,this.myParticles=null,this.myVisualElements=null,this.myTools=null,this.myPlayerObjects=new xr}},xr=class{constructor(){this.myPlayer=null,this.myCauldron=null,this.myReferenceSpace=null,this.myCameraNonXR=null,this.myEyes=[],this.myEyeLeft=null,this.myEyeRight=null,this.myHands=[],this.myHandLeft=null,this.myHandRight=null,this.myHead=null,this.myHeadDebugs=null}};var is=class{constructor(){this.myMeshes=new Mr,this.myMaterials=new Dr}},Mr=class{constructor(){this.myPlane=null,this.myCube=null,this.mySphere=null,this.myCone=null,this.myCylinder=null,this.myCircle=null,this.myInvertedCube=null,this.myInvertedSphere=null,this.myInvertedCone=null,this.myInvertedCylinder=null,this.myDoubleSidedPlane=null,this.myDoubleSidedCube=null,this.myDoubleSidedSphere=null,this.myDoubleSidedCone=null,this.myDoubleSidedCylinder=null,this.myDoubleSidedCircle=null}},Dr=class{constructor(){this.myFlatOpaque=null,this.myFlatTransparentNoDepth=null,this.myPhongOpaque=null,this.myText=null}};import{Component as UA,Property as Vr}from"@wonderlandengine/api";import{Component as oA,Property as IP}from"@wonderlandengine/api";import{Howler as Er}from"howler";import{Emitter as tA}from"@wonderlandengine/api";import{Howl as iA,Howler as nA}from"howler";var An=class i{constructor(e=null){this.myAudioFilePath=e,this.myLoop=!1,this.myAutoPlay=!1,this.myVolume=1,this._myRate=1,this.myPool=5,this.myPreload=!0,this.myPreventPlayWhenAudioContextNotRunning=!1,this.myPosition=null,this.mySpatial=!0,this.myReferenceDistance=Number.MAX_VALUE}clone(){let e=new i;return e.myAudioFilePath=this.myAudioFilePath,e.myLoop=this.myLoop,e.myAutoPlay=this.myAutoPlay,e.myVolume=this.myVolume,e.myPitch=this.myPitch,e.myRate=this.myRate,e.myPool=this.myPool,e.myPreload=this.myPreload,e.myPreventPlayWhenAudioContextNotRunning=this.myPreventPlayWhenAudioContextNotRunning,this.myPosition!=null?e.myPosition=this.myPosition.vec3_clone():e.myPosition=null,e.mySpatial=this.mySpatial,e.myReferenceDistance=this.myReferenceDistance,e}get myPitch(){return this._myRate}get myRate(){return this._myRate}set myPitch(e){this._myRate=e}set myRate(e){this._myRate=e}};var ns={END:"end",STOP:"stop",LOAD:"load",LOAD_ERROR:"loaderror",PLAY:"play",PLAY_ERROR:"playerror",PAUSE:"pause",MUTE:"mute",VOLUME:"volume",RATE:"rate",SEEK:"seek",FADE:"fade",UNLOCK:"unlock"},Gi=class{constructor(e,t=null){e==null?this._myAudioSetup=new An:typeof e=="string"?this._myAudioSetup=new An(e):this._myAudioSetup=e.clone(),this._myAudio=null,t==null?(this._myAudio=new iA({src:[this._myAudioSetup.myAudioFilePath],loop:this._myAudioSetup.myLoop,volume:this._myAudioSetup.myVolume,autoplay:!1,rate:this._myAudioSetup.myRate,pool:this._myAudioSetup.myPool,pos:this._myAudioSetup.mySpatial?this._myAudioSetup.myPosition:null,refDistance:this._myAudioSetup.myReferenceDistance,preload:this._myAudioSetup.myPreload}),this._myAudio._pannerAttr.refDistance=this._myAudioSetup.myReferenceDistance):this._myAudio=t,this._myLastAudioID=null,this._myAudioEventEmitters=new Map;for(let n in ns)this._myAudioEventEmitters.set(ns[n],new tA);this._addListeners(),this._myAudioSetup.myAutoPlay&&this.play(),this._myDestroyed=!1}isValid(){return this._myAudio!=null}play(){if(nA.state!="running"&&this._myAudioSetup.myPreventPlayWhenAudioContextNotRunning)return!1;let e=this._myAudio.play();return e!=null&&(this._myLastAudioID=e,this.updatePosition(this._myAudioSetup.myPosition,!0),this.updatePitch(this._myAudioSetup.myPitch,!0),this.updateVolume(this._myAudioSetup.myVolume,!0)),e!=null}stop(){this._myAudio.stop()}pause(){this._myAudio.pause()}resume(){this._myAudio.play()}isPlaying(e=!1){let t=!1;return e?t=this._myAudio.playing(this._myLastAudioID):t=this._myAudio.playing(),t}isLoaded(){return this._myAudio.state()=="loaded"}fade(e,t,n,o=!0,s=!0){s&&this.setVolume(t),o?this._myAudio.fade(e,t,n*1e3,this._myLastAudioID):this._myAudio.fade(e,t,n*1e3)}isFading(e=!0){let t=!1;if(e){let n=this._myAudio._soundById(this._myLastAudioID);n!=null&&(t=n._fadeTo!=null)}else for(let n of this._myAudio._sounds)if(n._fadeTo!=null){t=!0;break}return t}updatePosition(e,t=!0,n=!0){n&&this.setPosition(e),this._myAudioSetup.mySpatial&&e&&(t?this._myAudio.pos(e[0],e[1],e[2],this._myLastAudioID):this._myAudio.pos(e[0],e[1],e[2]))}updatePitch(e,t=!0,n=!0){this.updateRate(e,t,n)}updateRate(e,t=!0,n=!0){n&&this.setRate(e),e!=null&&(t?this._myAudio.rate(e,this._myLastAudioID):this._myAudio.rate(e))}updateVolume(e,t=!0,n=!0){n&&this.setVolume(e),e!=null&&(t?this._myAudio.volume(e,this._myLastAudioID):this._myAudio.volume(e))}setSpatial(e){this._myAudioSetup.mySpatial=e}setPosition(e){this._myAudioSetup.myPosition=e}setPitch(e){this._myAudioSetup.myPitch=e}setRate(e){this._myAudioSetup.myRate=e}setVolume(e){this._myAudioSetup.myVolume=e}getDuration(){return this._myAudio.duration()}getVolume(){return this._myAudioSetup.myVolume}getPitch(){return this._myAudioSetup.myPitch}getRate(){return this._myAudioSetup.myRate}registerAudioEventListener(e,t,n,o=!1){this._myAudioEventEmitters.get(e).add(n,{id:t,once:o})}unregisterAudioEventListener(e,t){this._myAudioEventEmitters.get(e).remove(t)}_addListeners(){if(this._myAudio!=null)for(let e in ns){let t=ns[e];this._myAudio.on(t,function(n){this._myAudioEventEmitters.get(t).notify(n)}.bind(this))}}destroy(){this._myDestroyed=!0,this._myAudio.unload()}isDestroyed(){return this._myDestroyed}};var os=class{constructor(e=!0,t=m.getMainEngine()){this._myEngine=t,this._myPreloadAudio=e,this._myAudioSetups=new Map}createAudioPlayer(e){return this.getAudioSetup(e)!=null?new Gi(this.getAudioSetup(e)):null}getAudioSetup(e){return this._myAudioSetups.get(e)}addAudioSetup(e,t,n=null){this._myAudioSetups.set(e,t),(this._myPreloadAudio&&n==null||n!=null&&n)&&this.createAudioPlayer(e)}removeAudioSetup(e){this._myAudioSetups.delete(e)}setVolume(e){Er.volume(e)}setMute(e){Er.mute(e)}stop(){Er.stop()}unloadAllAudioSources(){Er.unload()}};var ii=class extends oA{static TypeName="pp-audio-manager";static Properties={_myPreloadAudio:IP.bool(!0),_myCleanUpAudioSourcesOnInit:IP.bool(!0)};init(){this._myAudioManager=null,m.hasAudioManager(this.engine)||(this._myAudioManager=new os(this._myPreloadAudio,this.engine),this._myCleanUpAudioSourcesOnInit&&this._myAudioManager.unloadAllAudioSources(),m.setAudioManager(this._myAudioManager,this.engine))}onDestroy(){this._myAudioManager!=null&&m.getAudioManager(this.engine)==this._myAudioManager&&m.removeAudioManager(this.engine)}};import{Component as sA}from"@wonderlandengine/api";var ss=class{constructor(){this._myPools=new Map,this._myDestroyed=!1}addPool(e,t){this._myPools.has(e)?console.warn("Trying to add a Pool with an ID that has been already used:",e):this._myPools.set(e,t)}destroyPool(e){let t=this._myPools.get(e);t!=null&&(this._myPools.delete(e),t.destroy())}getPool(e){return this._myPools.get(e)}hasPool(e){return this._myPools.has(e)}get(e){return this._myPools.has(e)?this._myPools.get(e).get():null}has(e,t){let n=!1;if(t===void 0){for(let o of this._myPools.values())if(o.has(e)){n=!0;break}}else n=this._myPools.get(e).has(t);return n}isBusy(e,t){let n=!1;if(t===void 0){for(let o of this._myPools.values())if(o.isBusy(e)){n=!0;break}}else n=this._myPools.get(e).isBusy(t);return n}isAvailable(e,t){let n=!1;if(t===void 0){for(let o of this._myPools.values())if(o.isAvailable(e)){n=!0;break}}else n=this._myPools.get(e).isAvailable(t);return n}release(e,t){if(t===void 0)for(let n of this._myPools.values())n.release(e);else this._myPools.get(e).release(t)}releaseAll(e=void 0){if(e===void 0)for(let t of this._myPools.values())t.releaseAll();else this._myPools.get(e).releaseAll()}increase(e,t){let n=this._myPools.get(e);n&&n.increase(t)}increasePercentage(e,t){let n=this._myPools.get(e);n&&n.increasePercentage(t)}getSize(e){return this._myPools.has(e)?this._myPools.get(e).getSize():null}getAvailableSize(e){return this._myPools.has(e)?this._myPools.get(e).getAvailableSize():null}getBusySize(e){return this._myPools.has(e)?this._myPools.get(e).getBusySize():null}destroy(){this._myDestroyed=!0;for(let e of this._myPools.values())e.destroy()}isDestroyed(){return this._myDestroyed}};var ni=class extends sA{static TypeName="pp-object-pools-manager";static Properties={};init(){this._myObjectPoolManager=null,m.hasObjectPoolManager(this.engine)||(this._myObjectPoolManager=new ss,m.setObjectPoolManager(this._myObjectPoolManager,this.engine))}onDestroy(){this._myObjectPoolManager!=null&&m.getObjectPoolManager(this.engine)==this._myObjectPoolManager&&m.removeObjectPoolManager(this.engine)}};import{Component as cA}from"@wonderlandengine/api";var Ni=class{constructor(){this.myCloneObjectPrototype=!0,this.myInitialPoolSize=0,this.myAmountToAddWhenEmpty=0,this.myPercentageToAddWhenEmpty=0,this.myCloneParams=void 0,this.myOptimizeObjectsAllocation=!0,this.myCloneCallback=null,this.mySetActiveCallback=null,this.myEqualCallback=null,this.myDestroyCallback=null,this.myOptimizeObjectsAllocationCallback=null,this.myLogEnabled=!1}},Ui=class{constructor(e,t){this._myObjectPoolParams=t,this._myObjectPrototype=e,t.myCloneObjectPrototype&&(this._myObjectPrototype=this._clone(e)),this._myAvailableObjects=[],this._myBusyObjects=[],this._addToPool(t.myInitialPoolSize,!1),this._myDestroyed=!1}get(){let e=this._myAvailableObjects.shift();if(e==null){let t=Math.ceil(this._myBusyObjects.length*this._myObjectPoolParams.myPercentageToAddWhenEmpty);t+=this._myObjectPoolParams.myAmountToAddWhenEmpty,this._addToPool(t,this._myObjectPoolParams.myLogEnabled),e=this._myAvailableObjects.shift()}return e!=null&&this._myBusyObjects.push(e),e}has(e){let t=!1;return(this.isBusy(e)||this.isAvailable(e))&&(t=!0),t}isBusy(e){return this._myBusyObjects.pp_has(this._equals.bind(this,e))}isAvailable(e){return this._myAvailableObjects.pp_has(this._equals.bind(this,e))}release(e){let t=this._myBusyObjects.pp_remove(this._equals.bind(this,e));t!=null&&(this._setActive(t,!1),this._myAvailableObjects.push(t))}releaseAll(){for(let e of this._myBusyObjects)this._setActive(e,!1),this._myAvailableObjects.push(e)}increase(e){this._addToPool(e,!1)}increasePercentage(e){let t=Math.ceil(this.getSize()*e);this._addToPool(t,!1)}getSize(){return this._myBusyObjects.length+this._myAvailableObjects.length}getAvailableSize(){return this._myAvailableObjects.length}getBusySize(){return this._myAvailableObjects.length}_addToPool(e,t){if(!(e<=0)){this._myObjectPoolParams.myOptimizeObjectsAllocation&&(this._myObjectPoolParams.myOptimizeObjectsAllocationCallback!=null?this._myObjectPoolParams.myOptimizeObjectsAllocationCallback(this._myObjectPrototype,e):this._myObjectPrototype.pp_reserveObjects!=null&&this._myObjectPrototype.pp_reserveObjects(e));for(let n=0;n<e;n++)this._myAvailableObjects.push(this._clone(this._myObjectPrototype));t&&console.warn("Added new elements to the pool:",e)}}_clone(e){let t=null;return this._myObjectPoolParams.myCloneCallback!=null?t=this._myObjectPoolParams.myCloneCallback(e,this._myObjectPoolParams.myCloneParams):e.pp_clone!=null?t=e.pp_clone(this._myObjectPoolParams.myCloneParams):e.clone!=null&&(t=e.clone(this._myObjectPoolParams.myCloneParams)),t==null?console.error("Object not cloneable, pool will return null"):this._setActive(t,!1),t}_setActive(e,t){this._myObjectPoolParams.mySetActiveCallback!=null?this._myObjectPoolParams.mySetActiveCallback(e,t):e.pp_setActive!=null?e.pp_setActive(t):e.setActive!=null&&e.setActive(t)}_equals(e,t){let n=!1;return this._myObjectPoolParams.myEqualCallback!=null?n=this._myObjectPoolParams.myEqualCallback(e,t):e.pp_equals!=null?n=e.pp_equals(t):e.equals!=null?n=e.equals(t):n=e==t,n}destroy(){this._myDestroyed=!0;for(let e of this._myAvailableObjects)this._destroyObject(e);for(let e of this._myBusyObjects)this._destroyObject(e);this._destroyObject(this._myObjectPrototype)}isDestroyed(){return this._myDestroyed}_destroyObject(e){this._myObjectPoolParams.myDestroyCallback!=null?this._myObjectPoolParams.myDestroyCallback(e):e.pp_destroy!=null?e.pp_destroy():e.destroy!=null&&e.destroy()}};import{MeshComponent as rA}from"@wonderlandengine/api";var Me={MESH:0,LINE:1,POINT:2,TEXT:3,ARROW:4,TRANSFORM:5,RAYCAST:6,TORUS:7};import{MeshComponent as aA}from"@wonderlandengine/api";var Ze=class{constructor(e=m.getMainEngine()){this.myStart=p(),this.myDirection=p(0,0,1),this.myLength=0,this.myThickness=.005,this.myMesh=null,this.myMaterial=null,this.myColor=null,this.myParent=m.getSceneObjects(e).myVisualElements,this.myLocal=!1,this.myType=Me.LINE}setStartEnd(e,t){return t.vec3_sub(e,this.myDirection),this.myLength=this.myDirection.vec3_length(),this.myDirection.vec3_normalize(this.myDirection),this.myStart.vec3_copy(e),this}copy(e){}},St=class i{constructor(e=new Ze){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myLineParentObject=null,this._myLineObject=null,this._myLineMeshComponent=null,this._myFlatOpaqueMaterial=null,this._myDestroyed=!1,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){this._myVisible!=e&&(this._myVisible=e,this._myLineParentObject.pp_setActive(e))}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1)}_build(){this._myLineParentObject=m.getSceneObjects(this._myParams.myParent.pp_getEngine()).myVisualElements.pp_addObject(),this._myLineObject=this._myLineParentObject.pp_addObject(),this._myLineMeshComponent=this._myLineObject.pp_addComponent(aA)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new Ze(this._myParams.myParent.pp_getEngine());e.copy(this._myParams);let t=new i(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}_refresh(){}destroy(){this._myDestroyed=!0,this._myLineParentObject.pp_destroy()}isDestroyed(){return this._myDestroyed}};St.prototype._refresh=function(){let i=p(),e=p(),t=p(0,1,0);return function(){this._myLineParentObject.pp_setParent(this._myParams.myParent,!1),this._myParams.myLocal?this._myLineParentObject.pp_setPositionLocal(this._myParams.myStart):this._myLineParentObject.pp_setPosition(this._myParams.myStart),i.vec3_set(this._myParams.myThickness/2,this._myParams.myLength/2,this._myParams.myThickness/2),this._myParams.myLocal?this._myLineObject.pp_setScaleLocal(i):this._myLineObject.pp_setScale(i),this._myParams.myLocal?this._myLineObject.pp_setUpLocal(this._myParams.myDirection,t):this._myLineObject.pp_setUp(this._myParams.myDirection,t),this._myLineObject.pp_resetPositionLocal(),e.vec3_set(0,this._myParams.myLength/2,0),this._myLineObject.pp_translateObject(e),this._myParams.myMesh!=null?this._myLineMeshComponent.mesh=this._myParams.myMesh:this._myLineMeshComponent.mesh=m.getDefaultMeshes(this._myParams.myParent.pp_getEngine()).myCylinder,this._myParams.myMaterial==null?this._myParams.myColor==null?this._myLineMeshComponent.material=m.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myMesh:(this._myFlatOpaqueMaterial==null&&(this._myFlatOpaqueMaterial=m.getDefaultMaterials(this._myParams.myParent.pp_getEngine()).myFlatOpaque.clone()),this._myLineMeshComponent.material=this._myFlatOpaqueMaterial,this._myFlatOpaqueMaterial.color=this._myParams.myColor):this._myLineMeshComponent.material=this._myParams.myMaterial}}();Ze.prototype.copy=function(e){this.myStart.vec3_copy(e.myStart),this.myDirection.vec3_copy(e.myDirection),this.myLength=e.myLength,this.myThickness=e.myThickness,this.myMesh=e.myMesh,e.myMaterial!=null?this.myMaterial=e.myMaterial.clone():this.myMaterial=null,e.myColor!=null?this.myColor!=null?this.myColor.vec4_copy(e.myColor):this.myColor=e.myColor.vec4_clone():this.myColor=null,this.myParent=e.myParent,this.myLocal=e.myLocal,this.myType=e.myType};var ze=class{constructor(e=m.getMainEngine()){this.myStart=p(),this.myDirection=p(0,0,1),this.myLength=0,this.myThickness=.005,this.myArrowThickness=null,this.myArrowLength=null,this.myShareArrowLengthWithLineWhenArrowLongerThanLength=!0,this.myLineMesh=null,this.myArrowMesh=null,this.myMaterial=null,this.myColor=null,this.myParent=m.getSceneObjects(e).myVisualElements,this.myLocal=!1,this.myType=Me.ARROW}setStartEnd(e,t){return t.vec3_sub(e,this.myDirection),this.myLength=this.myDirection.vec3_length(),this.myDirection.vec3_normalize(this.myDirection),this.myStart.vec3_copy(e),this}copy(e){}},yt=class i{constructor(e=new ze){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myVisualLine=new St(new Ze(this._myParams.myParent.pp_getEngine())),this._myVisualLine.setAutoRefresh(!1),this._myArrowParentObject=null,this._myArrowObject=null,this._myArrowMeshComponent=null,this._myFlatOpaqueMaterial=null,this._myDestroyed=!1,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){this._myVisible!=e&&(this._myVisible=e,this._myVisualLine.setVisible(e),this._myArrowParentObject.pp_setActive(e))}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh(),this._myVisualLine.forceRefresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1),this._myVisualLine.update(e)}_build(){this._myArrowParentObject=m.getSceneObjects(this._myParams.myParent.pp_getEngine()).myVisualElements.pp_addObject(),this._myArrowObject=this._myArrowParentObject.pp_addObject(),this._myArrowMeshComponent=this._myArrowObject.pp_addComponent(rA)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new ze(this._myParams.myParent.pp_getEngine());e.copy(this._myParams);let t=new i(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}_refresh(){}destroy(){this._myDestroyed=!0,this._myVisualLine.destroy(),this._myArrowParentObject.pp_destroy()}isDestroyed(){return this._myDestroyed}};yt.prototype._refresh=function(){let i=p(),e=p(),t=p(),n=p(0,1,0);return function(){this._myArrowParentObject.pp_setParent(this._myParams.myParent,!1);let s=this._myParams.myArrowThickness!=null?this._myParams.myArrowThickness:this._myParams.myThickness*1.5,a=this._myParams.myArrowLength!=null?this._myParams.myArrowLength:this._myParams.myThickness*3.5;this._myParams.myShareArrowLengthWithLineWhenArrowLongerThanLength&&a>this._myParams.myLength/2&&(a=this._myParams.myLength/2),a=Math.min(a,this._myParams.myLength),t.vec3_set(s,a/2,s);let l=this._myParams.myLength-a;this._myParams.myDirection.vec3_scale(l,i),i.vec3_add(this._myParams.myStart,i),this._myParams.myLocal?(this._myArrowParentObject.pp_setPositionLocal(i),this._myArrowParentObject.pp_setUpLocal(this._myParams.myDirection,n)):(this._myArrowParentObject.pp_setPosition(i),this._myArrowParentObject.pp_setUp(this._myParams.myDirection,n)),e.vec3_set(0,a/2-1e-5,0),this._myArrowParentObject.pp_translateObject(e),this._myParams.myLocal?this._myArrowObject.pp_setScaleLocal(t):this._myArrowObject.pp_setScale(t),this._myParams.myArrowMesh!=null?this._myArrowMeshComponent.mesh=this._myParams.myArrowMesh:this._myArrowMeshComponent.mesh=m.getDefaultMeshes(this._myParams.myParent.pp_getEngine()).myCone,this._myParams.myMaterial==null?this._myParams.myColor==null?this._myArrowMeshComponent.material=m.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myMesh:(this._myFlatOpaqueMaterial==null&&(this._myFlatOpaqueMaterial=m.getDefaultMaterials(this._myParams.myParent.pp_getEngine()).myFlatOpaque.clone()),this._myArrowMeshComponent.material=this._myFlatOpaqueMaterial,this._myFlatOpaqueMaterial.color=this._myParams.myColor):this._myArrowMeshComponent.material=this._myParams.myMaterial;let h=this._myVisualLine.getParams();h.myStart.vec3_copy(this._myParams.myStart),h.myDirection.vec3_copy(this._myParams.myDirection),h.myLength=l,h.myThickness=this._myParams.myThickness,h.myMesh=this._myParams.myLineMesh,h.myMaterial=this._myArrowMeshComponent.material,h.myParent=this._myParams.myParent,h.myLocal=this._myParams.myLocal,this._myVisualLine.paramsUpdated()}}();ze.prototype.copy=function(e){this.myStart.vec3_copy(e.myStart),this.myDirection.vec3_copy(e.myDirection),this.myLength=e.myLength,this.myThickness=e.myThickness,this.myArrowThickness=e.myArrowThickness,this.myArrowLength=e.myArrowLength,this.myShareArrowLengthWithLineWhenArrowLongerThanLength=e.myShareArrowLengthWithLineWhenArrowLongerThanLength,this.myArrowMesh=e.myArrowMesh,this.myLineMesh=e.myLineMesh,e.myMaterial!=null?this.myMaterial=e.myMaterial.clone():this.myMaterial=null,e.myColor!=null?this.myColor!=null?this.myColor.vec4_copy(e.myColor):this.myColor=e.myColor.vec4_clone():this.myColor=null,this.myParent=e.myParent,this.myLocal=e.myLocal,this.myType=e.myType};import{MeshComponent as lA}from"@wonderlandengine/api";var Ut=class{constructor(e=m.getMainEngine()){this.myTransform=be(),this.myMesh=null,this.myMaterial=null,this.myParent=m.getSceneObjects(e).myVisualElements,this.myLocal=!1,this.myType=Me.MESH}copy(e){}},Wi=class i{constructor(e=new Ut){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myMeshObject=null,this._myMeshComponent=null,this._myDestroyed=!1,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){this._myVisible!=e&&(this._myVisible=e,this._myMeshObject.pp_setActive(e))}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1)}_refresh(){this._myMeshObject.pp_setParent(this._myParams.myParent,!1),this._myParams.myLocal?this._myMeshObject.pp_setTransformLocal(this._myParams.myTransform):this._myMeshObject.pp_setTransform(this._myParams.myTransform),this._myParams.myMesh==null?this._myMeshComponent.mesh=m.getDefaultMeshes(this._myParams.myParent.pp_getEngine()).mySphere:this._myMeshComponent.mesh=this._myParams.myMesh,this._myParams.myMaterial==null?this._myMeshComponent.material=m.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myMesh:this._myMeshComponent.material=this._myParams.myMaterial}_build(){this._myMeshObject=m.getSceneObjects(this._myParams.myParent.pp_getEngine()).myVisualElements.pp_addObject(),this._myMeshComponent=this._myMeshObject.pp_addComponent(lA)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new Ut(this._myParams.myParent.pp_getEngine());e.copy(this._myParams);let t=new i(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}destroy(){this._myDestroyed=!0,this._myMeshObject.pp_destroy()}isDestroyed(){return this._myDestroyed}};Ut.prototype.copy=function(e){this.myTransform.pp_copy(e.myTransform),e.myMesh!=null?this.myMesh=e.myMesh:this.myMesh=null,e.myMaterial!=null?this.myMaterial=e.myMaterial.clone():this.myMaterial=null,this.myParent=e.myParent,this.myLocal=e.myLocal,this.myType=e.myType};import{MeshComponent as mA}from"@wonderlandengine/api";var vt=class{constructor(e=m.getMainEngine()){this.myPosition=p(),this.myRadius=.005,this.myMesh=null,this.myMaterial=null,this.myColor=null,this.myParent=m.getSceneObjects(e).myVisualElements,this.myLocal=!1,this.myType=Me.POINT}copy(e){}},ui=class i{constructor(e=new vt){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myPointObject=null,this._myPointMeshComponent=null,this._myFlatOpaqueMaterial=null,this._myDestroyed=!1,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){this._myVisible!=e&&(this._myVisible=e,this._myPointObject.pp_setActive(e))}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1)}_build(){this._myPointObject=m.getSceneObjects(this._myParams.myParent.pp_getEngine()).myVisualElements.pp_addObject(),this._myPointMeshComponent=this._myPointObject.pp_addComponent(mA)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new vt(this._myParams.myParent.pp_getEngine());e.copy(this._myParams);let t=new i(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}_refresh(){}destroy(){this._myDestroyed=!0,this._myPointObject.pp_destroy()}isDestroyed(){return this._myDestroyed}};ui.prototype._refresh=function(){let i=p(0,0,0);return function(){this._myPointObject.pp_setParent(this._myParams.myParent,!1),this._myParams.myLocal?(this._myPointObject.pp_setPositionLocal(this._myParams.myPosition),this._myPointObject.pp_setRotationLocal(i),this._myPointObject.pp_setScaleLocal(this._myParams.myRadius)):(this._myPointObject.pp_setPosition(this._myParams.myPosition),this._myPointObject.pp_setRotation(i),this._myPointObject.pp_setScale(this._myParams.myRadius)),this._myParams.myMesh!=null?this._myPointMeshComponent.mesh=this._myParams.myMesh:this._myPointMeshComponent.mesh=m.getDefaultMeshes(this._myParams.myParent.pp_getEngine()).mySphere,this._myParams.myMaterial==null?this._myParams.myColor==null?this._myPointMeshComponent.material=m.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myMesh:(this._myFlatOpaqueMaterial==null&&(this._myFlatOpaqueMaterial=m.getDefaultMaterials(this._myParams.myParent.pp_getEngine()).myFlatOpaque.clone()),this._myPointMeshComponent.material=this._myFlatOpaqueMaterial,this._myFlatOpaqueMaterial.color=this._myParams.myColor):this._myPointMeshComponent.material=this._myParams.myMaterial}}();vt.prototype.copy=function(e){this.myPosition.vec3_copy(e.myPosition),this.myRadius=e.myRadius,this.myMesh=e.myMesh,e.myMaterial!=null?this.myMaterial=e.myMaterial.clone():this.myMaterial=null,e.myColor!=null?this.myColor!=null?this.myColor.vec4_copy(e.myColor):this.myColor=e.myColor.vec4_clone():this.myColor=null,this.myParent=e.myParent,this.myLocal=e.myLocal,this.myType=e.myType};var BP=["0","1","2","3","4","5","6","7"];function LP(i){BP=i}function HP(){return BP}var kP=function(){let i=p(),e=p(),t=(n,o)=>n.pp_equals(o);return function(o,s=new ke){let a=o.myPhysics.rayCast(o.myOrigin,o.myDirection,o.myBlockLayerFlags.getMask(),o.myDistance);s.myRaycastParams==null&&(s.myRaycastParams=new ut(o.myPhysics)),s.myRaycastParams.copy(o);let l=0,h=0,_=a.hitCount;if(_!=0){let y=null,r=null,u=null,g=null;e=o.myDirection.vec3_negate(e);for(let P=0;P<_;P++){if(o.myObjectsToIgnore.length!=0&&(y==null&&(y=a.objects),o.myObjectsToIgnore.pp_hasEqual(y[P],t)))continue;r==null&&(r=a.distances);let C=r[P]==0;if(C&&(u==null&&(u=a.locations),C&&=o.myOrigin.vec3_sub(u[P],i).vec3_isZero(Math.PP_EPSILON),C&&(g||(g=a.normals),C&&=e.vec3_equals(g[P],Math.PP_EPSILON_DEGREES))),!o.myIgnoreHitsInsideCollision||!C){let f=null;l<s.myHits.length?f=s.myHits[l]:s._myUnusedHits!=null&&s._myUnusedHits.length>0?(f=s._myUnusedHits.pop(),s.myHits.push(f)):(f=new st,s.myHits.push(f)),y==null&&(y=a.objects),u==null&&(u=a.locations),g==null&&(g=a.normals),f.myPosition.vec3_copy(u[P]),f.myNormal.vec3_copy(g[P]),f.myDistance=r[P],f.myObject=y[P],f.myInsideCollision=C,h++,l++}}}if(s.myHits.length>h){s._myUnusedHits==null&&(s._myUnusedHits=[]);let y=s.myHits.length-h;for(let r=0;r<y;r++)s._myUnusedHits.push(s.myHits.pop())}return s}}(),De={setLayerFlagsNames:LP,getLayerFlagsNames:HP,raycast:kP};var Ve=class{constructor(){this._myLayerMask=0}setFlagActive(e,t){let n=e;if(isNaN(e)&&(n=De.getLayerFlagsNames().pp_findIndexEqual(e)),n>=0&&n<De.getLayerFlagsNames().length){let o=1<<n;t?this._myLayerMask=this._myLayerMask|o:this._myLayerMask=this._myLayerMask&~o}}isFlagActive(e){let t=e;isNaN(e)&&(t=De.getLayerFlagsNames().pp_findIndexEqual(e));let n=!1;if(t>=0&&t<De.getLayerFlagsNames().length){let o=1<<t;n=!!(this._myLayerMask&o)}return n}setAllFlagsActive(e){e?this._myLayerMask=Math.pow(2,De.getLayerFlagsNames().length)-1:this._myLayerMask=0}add(e){this._myLayerMask=this._myLayerMask|e.getMask()}remove(e){this._myLayerMask=this._myLayerMask&~e.getMask()}intersect(e){this._myLayerMask=this._myLayerMask&e.getMask()}copy(e){this._myLayerMask=e._myLayerMask}getMask(){return this._myLayerMask}setMask(e){this._myLayerMask=e}};var ut=class{constructor(e=m.getPhysics()){this.myOrigin=p(),this.myDirection=p(),this.myDistance=0,this.myBlockLayerFlags=new Ve,this.myObjectsToIgnore=[],this.myIgnoreHitsInsideCollision=!1,this.myPhysics=e}copy(e){this.myOrigin.vec3_copy(e.myOrigin),this.myDirection.vec3_copy(e.myDirection),this.myDistance=e.myDistance,this.myBlockLayerFlags.copy(e.myBlockLayerFlags),this.myObjectsToIgnore.pp_copy(e.myObjectsToIgnore),this.myIgnoreHitsInsideCollision=e.myIgnoreHitsInsideCollision,this.myPhysics=e.myPhysics}reset(){this.myOrigin.vec3_zero(),this.myDirection.vec3_zero(),this.myDistance=0,this.myBlockLayerFlags.setAllFlagsActive(!1),this.myObjectsToIgnore.pp_clear(),this.myIgnoreHitsInsideCollision=!1}},ke=class{constructor(){this.myRaycastParams=null,this.myHits=[],this._myUnusedHits=null}isColliding(e=!1){return e?this.getFirstHitOutsideCollision()!=null:this.myHits.length>0}getFirstHitInsideCollision(){let e=null;for(let t=0;t<this.myHits.length;t++){let n=this.myHits[t];if(n.myInsideCollision){e=n;break}}return e}getFirstHitOutsideCollision(){let e=null;for(let t=0;t<this.myHits.length;t++){let n=this.myHits[t];if(!n.myInsideCollision){e=n;break}}return e}getHitsInsideCollision(){let e=[];for(let t=0;t<this.myHits.length;t++){let n=this.myHits[t];n.myInsideCollision&&e.push(n)}return e}getHitsOutsideCollision(){let e=[];for(let t=0;t<this.myHits.length;t++){let n=this.myHits[t];n.myInsideCollision||e.push(n)}return e}removeHit(e){let t=this.myHits.pp_removeIndex(e);return t!=null&&(this._myUnusedHits==null&&(this._myUnusedHits=[]),this._myUnusedHits.push(t)),t}removeAllHits(){this._myUnusedHits==null&&(this._myUnusedHits=[]);for(let e=0;e<this.myHits.length;e++)this._myUnusedHits.push(this.myHits[e]);this.myHits.pp_clear()}copy(e){}reset(){this.myRaycastParams!=null&&this.myRaycastParams.reset(),this.removeAllHits()}},st=class{constructor(){this.myPosition=p(),this.myNormal=p(),this.myDistance=0,this.myObject=null,this.myInsideCollision=!1}isValid(){return this.myObject!=null}copy(e){this.myPosition.vec3_copy(e.myPosition),this.myNormal.vec3_copy(e.myNormal),this.myDistance=e.myDistance,this.myObject=e.myObject,this.myInsideCollision=e.myInsideCollision}reset(){this.myPosition.vec3_zero(),this.myNormal.vec3_zero(),this.myDistance=0,this.myObject=null,this.myInsideCollision=!1}};ke.prototype.copy=function(){let i=function(e,t){return e==null&&(e=new st),e.copy(t),e};return function(t){if(t.myRaycastParams==null?this.myRaycastParams=null:(this.myRaycastParams==null&&(this.myRaycastParams=new ut(t.myRaycastParams.myPhysics)),this.myRaycastParams.copy(t.myRaycastParams)),this.myHits.length>t.myHits.length){this._myUnusedHits==null&&(this._myUnusedHits=[]);for(let n=0;n<this.myHits.length-t.myHits.length;n++)this._myUnusedHits.push(this.myHits.pop())}else if(this.myHits.length<t.myHits.length&&this._myUnusedHits!=null){let n=Math.min(this._myUnusedHits.length,t.myHits.length-this.myHits.length);for(let o=0;o<n;o++)this.myHits.push(this._myUnusedHits.pop())}this.myHits.pp_copy(t.myHits,i)}}();var Wt=class{constructor(e=m.getMainEngine()){this._myRaycastResults=new ke,this.myHitNormalLength=.2,this.myThickness=.005,this.myShowOnlyFirstHit=!0,this.myRayMaterial=null,this.myHitNormalMaterial=null,this.myParent=m.getSceneObjects(e).myVisualElements,this.myLocal=!1,this.myType=Me.RAYCAST}get myRaycastResults(){return this._myRaycastResults}set myRaycastResults(e){this._myRaycastResults.copy(e)}copy(e){}},as=class i{constructor(e=new Wt){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myVisualRaycast=new yt(new ze(this._myParams.myParent.pp_getEngine())),this._myVisualRaycast.setAutoRefresh(!1),this._myVisualRaycastHitList=[],this._myDestroyed=!1,this._addVisualRaycastHit(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){if(this._myVisible!=e)if(this._myVisible=e,this._myVisible){if(this._myParams.myRaycastResults.myRaycastParams!=null&&this._myVisualRaycast.setVisible(!0),this._myParams.myRaycastResults.myHits.length>0){let t=Math.min(this._myParams.myRaycastResults.myHits.length,this._myVisualRaycastHitList.length);for(let n=0;n<t;n++)this._myVisualRaycastHitList[n].setVisible(!0)}}else{this._myVisualRaycast.setVisible(!1);for(let t of this._myVisualRaycastHitList)t.setVisible(!1)}}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){if(this._refresh(),this._myVisualRaycast.forceRefresh(),this._myParams.myRaycastResults.myHits.length>0){let e=Math.min(this._myParams.myRaycastResults.myHits.length,this._myVisualRaycastHitList.length);for(let t=0;t<e;t++)this._myVisualRaycastHitList[t].forceRefresh()}}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1),this._myVisualRaycast.update(e);for(let t of this._myVisualRaycastHitList)t.update(e)}_refresh(){for(let e of this._myVisualRaycastHitList)e.setVisible(!1);if(this._myParams.myRaycastResults.myHits.length>0){let e=this._myParams.myShowOnlyFirstHit?this._myParams.myRaycastResults.myHits.pp_first().myDistance:this._myParams.myRaycastResults.myHits.pp_last().myDistance;{let n=this._myVisualRaycast.getParams();n.myStart.vec3_copy(this._myParams.myRaycastResults.myRaycastParams.myOrigin),n.myDirection.vec3_copy(this._myParams.myRaycastResults.myRaycastParams.myDirection),n.myLength=e,n.myThickness=this._myParams.myThickness,this._myParams.myRayMaterial==null?n.myMaterial=m.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myRay:n.myMaterial=this._myParams.myRayMaterial,n.myParent=this._myParams.myParent,n.myLocal=this._myParams.myLocal,this._myVisualRaycast.paramsUpdated(),this._myVisualRaycast.setVisible(this._myVisible)}let t=this._myParams.myShowOnlyFirstHit?1:this._myParams.myRaycastResults.myHits.length;for(;t>this._myVisualRaycastHitList.length;)this._addVisualRaycastHit();for(let n=0;n<t;n++){let o=this._myVisualRaycastHitList[n];{let s=o.getParams();s.myStart.vec3_copy(this._myParams.myRaycastResults.myHits[n].myPosition),s.myDirection.vec3_copy(this._myParams.myRaycastResults.myHits[n].myNormal),s.myLength=this._myParams.myHitNormalLength,s.myThickness=this._myParams.myThickness,this._myParams.myHitNormalMaterial==null?s.myMaterial=m.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myHitNormal:s.myMaterial=this._myParams.myHitNormalMaterial,s.myParent=this._myParams.myParent,s.myLocal=this._myParams.myLocal,o.paramsUpdated(),o.setVisible(this._myVisible)}}}else if(this._myParams.myRaycastResults.myRaycastParams!=null){let e=this._myVisualRaycast.getParams();e.myStart.vec3_copy(this._myParams.myRaycastResults.myRaycastParams.myOrigin),e.myDirection.vec3_copy(this._myParams.myRaycastResults.myRaycastParams.myDirection),e.myLength=this._myParams.myRaycastResults.myRaycastParams.myDistance,e.myThickness=this._myParams.myThickness,this._myParams.myRayMaterial==null?e.myMaterial=m.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myRay:e.myMaterial=this._myParams.myRayMaterial,e.myParent=this._myParams.myParent,e.myLocal=this._myParams.myLocal,this._myVisualRaycast.paramsUpdated(),this._myVisualRaycast.setVisible(this._myVisible)}else this._myVisualRaycast.setVisible(!1)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new Wt(this._myParams.myParent.pp_getEngine());e.copy(this._myParams);let t=new i(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}_addVisualRaycastHit(){let e=new yt(new ze(this._myParams.myParent.pp_getEngine()));e.setAutoRefresh(!1),e.setVisible(!1),this._myVisualRaycastHitList.push(e)}destroy(){this._myDestroyed=!0,this._myVisualRaycast.destroy();for(let e of this._myVisualRaycastHitList)e.destroy()}isDestroyed(){return this._myDestroyed}};Wt.prototype.copy=function(e){this.myRaycastResults=e.myRaycastResults,this.myHitNormalLength=e.myHitNormalLength,this.myThickness=e.myThickness,this.myShowOnlyFirstHit=e.myShowOnlyFirstHit,e.myRayMaterial!=null?this.myRayMaterial=e.myRayMaterial.clone():this.myRayMaterial=null,e.myHitNormalMaterial!=null?this.myHitNormalMaterial=e.myHitNormalMaterial.clone():this.myHitNormalMaterial=null,this.myParent=e.myParent,this.myLocal=e.myLocal,this.myType=e.myType};import{Alignment as yA,Justification as uA,TextComponent as hA}from"@wonderlandengine/api";var Vt=class{constructor(e=m.getMainEngine()){this.myText="",this.myAlignment=yA.Center,this.myJustification=uA.Middle,this.myTransform=be(),this.myMaterial=null,this.myColor=null,this.myParent=m.getSceneObjects(e).myVisualElements,this.myLocal=!1,this.myLookAtObject=null,this.myType=Me.TEXT}copy(e){}},Rn=class i{constructor(e=new Vt){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myTextObject=null,this._myTextComponent=null,this._myTextMaterial=null,this._myDestroyed=!1,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){this._myVisible!=e&&(this._myVisible=e,this._myTextObject.pp_setActive(e))}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh()}update(e){(this._myDirty||this._myParams.myLookAtObject!=null)&&(this._refresh(),this._myDirty=!1)}_refresh(){}_build(){this._myTextObject=m.getSceneObjects(this._myParams.myParent.pp_getEngine()).myVisualElements.pp_addObject(),this._myTextComponent=this._myTextObject.pp_addComponent(hA)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new Vt(this._myParams.myParent.pp_getEngine());e.copy(this._myParams);let t=new i(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}destroy(){this._myDestroyed=!0,this._myTextObject.pp_destroy()}isDestroyed(){return this._myDestroyed}};Vt.prototype.copy=function(e){this.myText=e.myText,this.myAlignment=e.myAlignment,this.myJustification=e.myJustification,this.myTransform.mat4_copy(e.myTransform),e.myMaterial!=null?this.myMaterial=e.myMaterial.clone():this.myMaterial=null,e.myColor!=null?this.myColor!=null?this.myColor.vec4_copy(e.myColor):this.myColor=e.myColor.vec4_clone():this.myColor=null,this.myParent=e.myParent,this.myLocal=e.myLocal,this.myLookAtObject=e.myLookAtObject,this.myType=e.myType};Rn.prototype._refresh=function(){let i=p();return function(){this._myTextObject.pp_setParent(this._myParams.myParent,!1),this._myParams.myLocal?this._myTextObject.pp_setTransformLocal(this._myParams.myTransform):this._myTextObject.pp_setTransform(this._myParams.myTransform),this._myParams.myLookAtObject!=null&&(this._myParams.myLookAtObject.pp_getPosition(i),this._myTextObject.pp_lookAt(i)),this._myParams.myMaterial==null?this._myParams.myColor==null?this._myTextComponent.material=m.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myText:(this._myTextMaterial==null&&(this._myTextMaterial=m.getDefaultMaterials(this._myParams.myParent.pp_getEngine()).myText.clone()),this._myTextComponent.material=this._myTextMaterial,this._myTextMaterial.color=this._myParams.myColor):this._myTextComponent.material=this._myParams.myMaterial,this._myTextComponent.text=" ",this._myTextComponent.text=this._myParams.myText,this._myTextComponent.alignment=this._myParams.myAlignment,this._myTextComponent.justification=this._myParams.myJustification,this._myDirty=!1}}();var Ot=class{constructor(e=m.getMainEngine()){this.myTransform=be(),this.myRadius=0,this.mySegmentsAmount=12,this.mySegmentThickness=.05,this.mySegmentMesh=null,this.myMaterial=null,this.myColor=null,this.myParent=m.getSceneObjects(e).myVisualElements,this.myLocal=!1,this.myType=Me.TORUS}copy(e){}},hi=class i{constructor(e=new Ot){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myTorusParentObject=null,this._myVisualSegmentList=[],this._myFlatOpaqueMaterial=null,this._myDestroyed=!1,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){if(this._myVisible!=e)if(this._myVisible=e,this._myVisible){let t=Math.min(this._myParams.mySegmentsAmount,this._myVisualSegmentList.length);for(let n=0;n<t;n++)this._myVisualSegmentList[n].setVisible(!0)}else for(let t of this._myVisualSegmentList)t.setVisible(!1)}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh();let e=Math.min(this._myParams.mySegmentsAmount,this._myVisualSegmentList.length);for(let t=0;t<e;t++)this._myVisualSegmentList[t].forceRefresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1);for(let t of this._myVisualSegmentList)t.update(e)}_build(){this._myTorusParentObject=m.getSceneObjects(this._myParams.myParent.pp_getEngine()).myVisualElements.pp_addObject(),this._fillSegmentList()}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}_fillSegmentList(){for(;this._myVisualSegmentList.length<this._myParams.mySegmentsAmount;){let e=new St(new Ze(this._myParams.myParent.pp_getEngine()));e.setAutoRefresh(!1),e.setVisible(!1),e.getParams().myParent=this._myTorusParentObject,e.getParams().myLocal=!0,this._myVisualSegmentList.push(e)}}clone(){let e=new Ot(this._myParams.myParent.pp_getEngine());e.copy(this._myParams);let t=new i(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}_refresh(){}destroy(){this._myDestroyed=!0;for(let e of this._myVisualSegmentList)e.destroy();this._myTorusParentObject.pp_destroy()}isDestroyed(){return this._myDestroyed}};hi.prototype._refresh=function(){let i=p(),e=p(),t=p(),n=p(),o=p(),s=p(0,1,0);return function(){this._fillSegmentList();for(let h of this._myVisualSegmentList)h.setVisible(!1);this._myTorusParentObject.pp_setParent(this._myParams.myParent,!1),this._myParams.myLocal?this._myTorusParentObject.pp_setTransformLocal(this._myParams.myTransform):this._myTorusParentObject.pp_setTransform(this._myParams.myTransform);let l=2*Math.PI/this._myParams.mySegmentsAmount;i.vec3_set(this._myParams.myRadius,0,0);for(let h=0;h<this._myParams.mySegmentsAmount;h++){e=i.vec3_rotateAxisRadians(l,s,e),t=e.vec3_sub(i,t).vec3_normalize(t);let _=Math.tan(l/2)*this._myParams.mySegmentThickness/2;n=i.vec3_sub(t.vec3_scale(_,n),n),o=e.vec3_add(t.vec3_scale(_,o),o);let y=this._myVisualSegmentList[h],r=y.getParams();r.setStartEnd(n,o),r.myThickness=this._myParams.mySegmentThickness,r.myMesh=this._myParams.mySegmentMesh,this._myParams.myMaterial==null?this._myParams.myColor==null?r.myMaterial=m.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myMesh:(this._myFlatOpaqueMaterial==null&&(this._myFlatOpaqueMaterial=m.getDefaultMaterials(this._myParams.myParent.pp_getEngine()).myFlatOpaque.clone()),r.myMaterial=this._myFlatOpaqueMaterial,this._myFlatOpaqueMaterial.color=this._myParams.myColor):r.myMaterial=this._myParams.myMaterial,y.paramsUpdated(),y.setVisible(this._myVisible),i.vec3_copy(e)}}}();Ot.prototype.copy=function(e){this.myRadius=e.myRadius,this.mySegmentsAmount=e.mySegmentsAmount,this.mySegmentThickness=e.mySegmentThickness,this.myTransform.mat4_copy(e.myTransform),this.mySegmentMesh=e.mySegmentMesh,e.myMaterial!=null?this.myMaterial=e.myMaterial.clone():this.myMaterial=null,e.myColor!=null?this.myColor!=null?this.myColor.vec4_copy(e.myColor):this.myColor=e.myColor.vec4_clone():this.myColor=null,this.myParent=e.myParent,this.myLocal=e.myLocal,this.myType=e.myType};var At=class{constructor(e=m.getMainEngine()){this.myTransform=be(),this.myLength=.2,this.myThickness=.005,this.myForwardMaterial=null,this.myUpMaterial=null,this.myRightMaterial=null,this.myParent=m.getSceneObjects(e).myVisualElements,this.myLocal=!1,this.myType=Me.TRANSFORM}copy(e){}},Mi=class i{constructor(e=new At){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myVisualRight=new yt(new ze(this._myParams.myParent.pp_getEngine())),this._myVisualUp=new yt(new ze(this._myParams.myParent.pp_getEngine())),this._myVisualForward=new yt(new ze(this._myParams.myParent.pp_getEngine())),this._myVisualRight.setAutoRefresh(!1),this._myVisualUp.setAutoRefresh(!1),this._myVisualForward.setAutoRefresh(!1),this._myDestroyed=!1,this.forceRefresh(),this.setVisible(!0)}setVisible(e){this._myVisible!=e&&(this._myVisible=e,this._myVisualRight.setVisible(e),this._myVisualUp.setVisible(e),this._myVisualForward.setVisible(e))}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh(),this._myVisualRight.forceRefresh(),this._myVisualUp.forceRefresh(),this._myVisualForward.forceRefresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1),this._myVisualRight.update(e),this._myVisualUp.update(e),this._myVisualForward.update(e)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new At(this._myParams.myParent.pp_getEngine());e.copy(this._myParams);let t=new i(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}_refresh(){}destroy(){this._myDestroyed=!0,this._myVisualRight.destroy(),this._myVisualUp.destroy(),this._myVisualForward.destroy()}isDestroyed(){return this._myDestroyed}};Mi.prototype._refresh=function(){let i=[p(),p(),p()],e=p(),t=p();return function(){i=this._myParams.myTransform.mat4_getAxes(i),e=this._myParams.myTransform.mat4_getScale(e);let o=0;for(let s of e)o=Math.max(s,o);o==0?(e[0]=1,e[1]=1,e[2]=1):(e[0]=e[0]/o,e[1]=e[1]/o,e[2]=e[2]/o),t=this._myParams.myTransform.mat4_getPosition(t);{let s=this._myVisualRight.getParams();s.myStart.vec3_copy(t),s.myDirection=i[0].vec3_negate(s.myDirection).vec3_normalize(s.myDirection),s.myLength=Math.max(this._myParams.myLength*e[0],.001),s.myThickness=this._myParams.myThickness,this._myParams.myRightMaterial==null?s.myMaterial=m.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myRight:s.myMaterial=this._myParams.myRightMaterial,s.myParent=this._myParams.myParent,s.myLocal=this._myParams.myLocal,this._myVisualRight.paramsUpdated()}{let s=this._myVisualUp.getParams();s.myStart.vec3_copy(t),s.myDirection=i[1].vec3_normalize(s.myDirection),s.myLength=Math.max(this._myParams.myLength*e[1],.001),s.myThickness=this._myParams.myThickness,this._myParams.myUpMaterial==null?s.myMaterial=m.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myUp:s.myMaterial=this._myParams.myUpMaterial,s.myParent=this._myParams.myParent,s.myLocal=this._myParams.myLocal,this._myVisualUp.paramsUpdated()}{let s=this._myVisualForward.getParams();s.myStart.vec3_copy(t),s.myDirection=i[2].vec3_normalize(s.myDirection),s.myLength=Math.max(this._myParams.myLength*e[2],.001),s.myThickness=this._myParams.myThickness,this._myParams.myForwardMaterial==null?s.myMaterial=m.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myForward:s.myMaterial=this._myParams.myForwardMaterial,s.myParent=this._myParams.myParent,s.myLocal=this._myParams.myLocal,this._myVisualForward.paramsUpdated()}}}();At.prototype.copy=function(e){this.myTransform.mat4_copy(e.myTransform),this.myLength=e.myLength,this.myThickness=e.myThickness,e.myRightMaterial!=null?this.myRightMaterial=e.myRightMaterial.clone():this.myRightMaterial=null,e.myUpMaterial!=null?this.myUpMaterial=e.myUpMaterial.clone():this.myUpMaterial=null,e.myForwardMaterial!=null?this.myForwardMaterial=e.myForwardMaterial.clone():this.myForwardMaterial=null,this.myParent=e.myParent,this.myLocal=e.myLocal,this.myType=e.myType};var Qi=class{constructor(e=m.getMainEngine()){this._myEngine=e,this._myVisualElementPrototypeCreationCallbacks=new Map,this._myVisualElementsTypeMap=new Map,this._myVisualElementLastID=0,this._myVisualElementsToShow=[],this._myActive=!0,this._myDestroyed=!1,this._myObjectPoolManagerPrefix=this._getClassName()+"_"+Math.pp_randomUUID()+"_visual_element_type_",this._myTypePoolIDs=new Map,this._addStandardVisualElementTypes()}setActive(e){this._myActive!=e&&(this._myActive=e,this._myActive||this.clearVisualElement())}isActive(){return this._myActive}start(){}update(e){this._myActive&&this._updateDraw(e)}draw(e,t=0,n=null){if(!this._myActive)return 0;let o=null,s=!1;if(n!=null&&this._myVisualElementsTypeMap.has(e.myType)){let h=this._myVisualElementsTypeMap.get(e.myType);h.has(n)&&(o=h.get(n)[0],o.copyParams(e),o.setVisible(!1),s=!0)}if(o==null&&(o=this._getVisualElementFromPool(e)),o==null)return console.error("Couldn't create the requested visual element"),null;this._myVisualElementsTypeMap.has(e.myType)||this._myVisualElementsTypeMap.set(e.myType,new Map);let a=this._myVisualElementsTypeMap.get(e.myType),l=null;if(!s)l=this._myVisualElementLastID+1,this._myVisualElementLastID=l,a.set(l,[o,new te(t,t!=null)]);else{l=n;let h=a.get(l);h[0]=o,h[1].reset(t),t!=null&&h[1].start()}return this._myVisualElementsToShow.push(o),l}getVisualElement(e){let t=null;for(let n of this._myVisualElementsTypeMap.values())if(n.has(e)){t=n.get(e)[0];break}return t}getVisualElementParams(e){return this.getVisualElement(e).getParams()}getVisualElementID(e){let t=null;for(let n of this._myVisualElementsTypeMap.values()){for(let[o,s]of n.entries())if(s[0]==e){t=o;break}if(t!=null)break}return t}clearVisualElement(e=null){if(e==null){for(let t of this._myVisualElementsTypeMap.values())for(let n of t.values())this._releaseElement(n[0]);this._myVisualElementsToShow=[],this._myVisualElementsTypeMap=new Map,this._myVisualElementLastID=0}else for(let t of this._myVisualElementsTypeMap.values())if(t.has(e)){let n=t.get(e);this._releaseElement(n[0]),t.delete(e),this._myVisualElementsToShow.pp_removeEqual(n[0]);break}}allocateVisualElementType(e,t){m.getObjectPoolManager(this._myEngine).hasPool(this._getTypePoolID(e))||this._addVisualElementTypeToPool(e);let n=m.getObjectPoolManager(this._myEngine).getPool(this._getTypePoolID(e)),o=n.getAvailableSize()-t;o<0&&n.increase(-o)}addVisualElementType(e,t){this._myVisualElementPrototypeCreationCallbacks.set(e,t)}removeVisualElementType(e){this._myVisualElementPrototypeCreationCallbacks.delete(e)}_updateDraw(e){for(let t of this._myVisualElementsToShow)t.setVisible(!0);this._myVisualElementsToShow.pp_clear();for(let t of this._myVisualElementsTypeMap.values()){let n=[];for(let o of t.entries()){let s=o[1];s[1].isDone()?(this._releaseElement(s[0]),n.push(o[0])):(s[0].update(e),s[1].update(e))}for(let o of n)t.delete(o)}}_getVisualElementFromPool(e){let t=null;return m.getObjectPoolManager(this._myEngine).hasPool(this._getTypePoolID(e.myType))||this._addVisualElementTypeToPool(e.myType),t=m.getObjectPoolManager(this._myEngine).get(this._getTypePoolID(e.myType)),t?.copyParams(e),t}_addVisualElementTypeToPool(e){let t=new Ni;t.myInitialPoolSize=10,t.myAmountToAddWhenEmpty=0,t.myPercentageToAddWhenEmpty=.5,t.mySetActiveCallback=function(o,s){o.setVisible(s)};let n=null;this._myVisualElementPrototypeCreationCallbacks.has(e)&&(n=this._myVisualElementPrototypeCreationCallbacks.get(e)()),n!=null?(n.setVisible(!1),n.setAutoRefresh(!0),m.getObjectPoolManager(this._myEngine).addPool(this._getTypePoolID(e),new Ui(n,t))):console.error("Visual element type not supported")}_addStandardVisualElementTypes(){this.addVisualElementType(Me.LINE,()=>new St(new Ze(this._myEngine))),this.addVisualElementType(Me.MESH,()=>new Wi(new Ut(this._myEngine))),this.addVisualElementType(Me.POINT,()=>new ui(new vt(this._myEngine))),this.addVisualElementType(Me.ARROW,()=>new yt(new ze(this._myEngine))),this.addVisualElementType(Me.TEXT,()=>new Rn(new Vt(this._myEngine))),this.addVisualElementType(Me.TRANSFORM,()=>new Mi(new At(this._myEngine))),this.addVisualElementType(Me.RAYCAST,()=>new as(new Wt(this._myEngine))),this.addVisualElementType(Me.TORUS,()=>new hi(new Ot(this._myEngine)))}_getTypePoolID(e){let t=this._myTypePoolIDs.get(e);return t==null&&(t=this._myObjectPoolManagerPrefix+e,this._myTypePoolIDs.set(e,t)),t}_releaseElement(e){let t=m.getSceneObjects(this._myEngine).myVisualElements;e.getParams().myParent!=t&&(e.getParams().myParent=t,e.forceRefresh()),m.getObjectPoolManager(this._myEngine).release(this._getTypePoolID(e.getParams().myType),e)}_getClassName(){return"visual_manager"}destroy(){this._myDestroyed=!0;for(let e of this._myTypePoolIDs.values())m.getObjectPoolManager(this._myEngine)?.destroyPool(e)}isDestroyed(){return this._myDestroyed}};var rs=class{constructor(){this.myDefaultMaterials=new Ar}},Ar=class{constructor(){this.myMesh=null,this.myText=null,this.myRight=null,this.myUp=null,this.myForward=null,this.myRay=null,this.myHitNormal=null}};var oi=class extends cA{static TypeName="pp-visual-manager";static Properties={};init(){this._myVisualManager=null,m.hasVisualManager(this.engine)||(this._myVisualManager=new Qi(this.engine),m.setVisualManager(this._myVisualManager,this.engine)),m.hasVisualResources(this.engine)||(this._myVisualResources=new rs,m.setVisualResources(this._myVisualResources,this.engine))}start(){this._myVisualResources!=null&&(this._myVisualResources.myDefaultMaterials.myMesh=m.getDefaultMaterials(this.engine).myFlatOpaque.clone(),this._myVisualResources.myDefaultMaterials.myText=m.getDefaultMaterials(this.engine).myText.clone(),this._myVisualResources.myDefaultMaterials.myRight=m.getDefaultMaterials(this.engine).myFlatOpaque.clone(),this._myVisualResources.myDefaultMaterials.myRight.color=F(1,0,0,1),this._myVisualResources.myDefaultMaterials.myUp=m.getDefaultMaterials(this.engine).myFlatOpaque.clone(),this._myVisualResources.myDefaultMaterials.myUp.color=F(0,1,0,1),this._myVisualResources.myDefaultMaterials.myForward=m.getDefaultMaterials(this.engine).myFlatOpaque.clone(),this._myVisualResources.myDefaultMaterials.myForward.color=F(0,0,1,1),this._myVisualResources.myDefaultMaterials.myRay=m.getDefaultMaterials(this.engine).myFlatOpaque.clone(),this._myVisualResources.myDefaultMaterials.myRay.color=F(0,1,0,1),this._myVisualResources.myDefaultMaterials.myHitNormal=m.getDefaultMaterials(this.engine).myFlatOpaque.clone(),this._myVisualResources.myDefaultMaterials.myHitNormal.color=F(1,0,0,1)),this.myVisualManager!=null&&this.myVisualManager.start()}update(e){this.myVisualManager!=null&&this.myVisualManager.update(e)}onDestroy(){this._myVisualManager!=null&&m.getVisualManager(this.engine)==this._myVisualManager&&(m.removeVisualManager(this.engine),this._myVisualManager.destroy()),this._myVisualResources!=null&&m.getVisualResources(this.engine)==this._myVisualResources&&m.removeVisualResources(this.engine)}};import*as pA from"@wonderlandengine/api";import{Component as dA,Property as _A}from"@wonderlandengine/api";import*as gA from"@wonderlandengine/components";var Bi=class extends dA{static TypeName="pp-add-wl-to-window";static Properties={_myAdd:_A.bool(!0)};init(){this._myAdd&&(m.getWindow(this.engine).WL={},this._addProperties(pA),this._addProperties(gA))}_addProperties(e){let t=Object.getOwnPropertyNames(e);for(let n of t)e[n]!=null&&(m.getWindow(this.engine).WL[n]=e[n])}onDestroy(){m.getWindow(this.engine).WL=void 0}};import{Component as fA}from"@wonderlandengine/api";import{Alignment as FP,Justification as wP}from"@wonderlandengine/api";var Di=class extends Qi{constructor(e){super(e),this._myDefaultColor=F(1,0,1,1),this._myDefaultLineThickness=.005,this._myDefaultPointRadius=.01,this._myDefaultAxisLength=.2,this._myDefaultTextLookAtPlayer=!0,this._myDefaultTextAlignment=FP.Center,this._myDefaultTextJustification=wP.Middle,this._myDefaultUITextAlignment=FP.Center,this._myDefaultUITextJustification=wP.Middle,this._myDefaultUITextScale=1,this._myDefaultUITextScreenPosition=p(1,1,1)}drawLine(e,t,n,o,s=this._myDefaultColor,a=this._myDefaultLineThickness){if(this.isActive()){let l=new Ze(this._myEngine);l.myStart.vec3_copy(t),l.myDirection.vec3_copy(n),l.myLength=o,l.myThickness=a,l.myColor=F(),l.myColor.vec4_copy(s),this.draw(l,e)}}drawLineEnd(e,t,n,o=this._myDefaultColor,s=this._myDefaultLineThickness){}drawArrow(e,t,n,o,s=this._myDefaultColor,a=this._myDefaultLineThickness){if(this.isActive()){let l=new ze(this._myEngine);l.myStart.vec3_copy(t),l.myDirection.vec3_copy(n),l.myLength=o,l.myThickness=a,l.myColor=F(),l.myColor.vec4_copy(s),this.draw(l,e)}}drawArrowEnd(e,t,n,o=this._myDefaultColor,s=this._myDefaultLineThickness){}drawPoint(e,t,n=this._myDefaultColor,o=this._myDefaultPointRadius){if(this.isActive()){let s=new vt(this._myEngine);s.myPosition.vec3_copy(t),s.myRadius=o,s.myColor=F(),s.myColor.vec4_copy(n),this.draw(s,e)}}drawText(e,t,n,o=this._myDefaultColor,s=this._myDefaultTextLookAtPlayer,a=this._myDefaultTextAlignment,l=this._myDefaultTextJustification){if(this.isActive()){let h=new Vt(this._myEngine);h.myText=t,h.myAlignment=a,h.myJustification=l,h.myTransform.mat4_copy(n),h.myColor=F(),h.myColor.vec4_copy(o),s&&(h.myLookAtObject=m.getPlayerObjects(this._myEngine).myHead),this.draw(h,e)}}drawRaycast(e,t,n=!0,o=this._myDefaultAxisLength,s=this._myDefaultLineThickness){if(this.isActive()){let a=new Wt(this._myEngine);a.myRaycastResults=t,a.myShowOnlyFirstHit=n,a.myHitNormalLength=o,a.myThickness=s,this.draw(a,e)}}drawTransform(e,t,n=this._myDefaultAxisLength,o=this._myDefaultLineThickness){if(this.isActive()){let s=new At(this._myEngine);s.myTransform.mat4_copy(t),s.myLength=n,s.myThickness=o,this.draw(s,e)}}drawUIText(e,t,n,o=this._myDefaultUITextScale,s=this._myDefaultColor,a=this._myDefaultUITextAlignment,l=this._myDefaultUITextJustification){}_getClassName(){return"debug_visual_manager"}};Di.prototype.drawLineEnd=function(){let i=p();return function(t,n,o,s=this._myDefaultColor,a=this._myDefaultLineThickness){if(this.isActive()){i=o.vec3_sub(n,i);let l=i.vec3_length();i.vec3_normalize(i),this.drawLine(t,n,i,l,s,a)}}}();Di.prototype.drawArrowEnd=function(){let i=p();return function(t,n,o,s=this._myDefaultColor,a=this._myDefaultLineThickness){if(this.isActive()){i=o.vec3_sub(n,i);let l=i.vec3_length();i.vec3_normalize(i),this.drawArrow(t,n,i,l,s,a)}}}();Di.prototype.drawUIText=function(){let i=w(),e=p(0,1,0),t=p(),n=p(-.12*1,.12*1,.35),o=p(-.27*1.15,.13*1.05,.35),s=p(),a=p(),l=p();return function(_,y,r=this._myDefaultUITextScreenPosition,u=this._myDefaultUITextScale,g=this._myDefaultColor,P=this._myDefaultUITextAlignment,C=this._myDefaultUITextJustification){if(this.isActive()){let f=new Vt(this._myEngine);f.myText=y,f.myAlignment=P,f.myJustification=C,f.myColor=F(),f.myColor.vec4_copy(g);let S=.2;O.isSessionActive(this._myEngine)?(f.myTransform.mat4_setPositionRotationScale(n.vec3_mul(r,s),a.vec3_set(0,180,0),l.vec3_set(S*u,S*u,S*u)),t=f.myTransform.mat4_getPosition(t).vec3_negate(t).vec3_normalize(t),i=f.myTransform.mat4_getRotationQuat(i),i.quat_setForward(t,e,i),f.myTransform.mat4_setRotationQuat(i)):f.myTransform.mat4_setPositionRotationScale(o.vec3_mul(r,s),a.vec3_set(0,180,0),l.vec3_set(S*u,S*u,S*u)),f.myParent=m.getPlayerObjects(this._myEngine).myHeadDebugs,f.myLocal=!0,this.draw(f,_)}}}();var ls=class{constructor(e=m.getMainEngine()){this._myEngine=e,this._myDebugVisualManager=new Di(this._myEngine),this._myDestroyed=!1}getDebugVisualManager(){return this._myDebugVisualManager}start(){this._myDebugVisualManager.start()}update(e){this._myDebugVisualManager.setActive(m.isDebugEnabled(this._myEngine)),this._myDebugVisualManager.update(e)}destroy(){this._myDestroyed=!0,this._myDebugVisualManager.destroy()}isDestroyed(){return this._myDestroyed}};var si=class extends fA{static TypeName="pp-debug-manager";static Properties={};init(){this._myDebugManager=null,m.hasDebugManager(this.engine)||(this._myDebugManager=new ls(this.engine),m.setDebugManager(this._myDebugManager,this.engine))}start(){this._myDebugManager!=null&&this._myDebugManager.start()}update(e){this._myDebugManager!=null&&this._myDebugManager.update(e)}onDestroy(){this._myDebugManager!=null&&m.getDebugManager(this.engine)==this._myDebugManager&&(m.removeDebugManager(this.engine),this._myDebugManager.destroy())}};import{Component as TA,Property as PA}from"@wonderlandengine/api";var Li=class extends TA{static TypeName="pp-enable-debug";static Properties={_myEnable:PA.bool(!0)};init(){this._myDebugEnabled=null,m.hasDebugEnabled(this.engine)||(this._myDebugEnabled=this._myEnable,m.setDebugEnabled(this._myDebugEnabled,this.engine))}onDestroy(){this._myDebugEnabled!=null&&m.isDebugEnabled(this.engine)==this._myDebugEnabled&&m.removeDebugEnabled(this.engine)}};import{Component as bA,Property as Rr}from"@wonderlandengine/api";var E={SELECT:0,SQUEEZE:1,TOUCHPAD:2,THUMBSTICK:3,BOTTOM_BUTTON:4,TOP_BUTTON:5,THUMB_REST:6},ae={PRESS_START:0,PRESS_END:1,PRESSED:2,NOT_PRESSED:3,TOUCH_START:4,TOUCH_END:5,TOUCHED:6,NOT_TOUCHED:7,VALUE_CHANGED:8,ALWAYS:9},ne={THUMBSTICK:0},Qt={X_CHANGED:0,Y_CHANGED:1,AXES_CHANGED:2,ALWAYS:3},ms=class i{constructor(e,t){this.myID=e,this.myHandedness=t,this.myPressed=!1,this.myPrevIsPressed=!1,this.myTouched=!1,this.myPrevIsTouched=!1,this.myValue=0,this.myPrevValue=0,this.myTimePressed=0,this.myPrevTimePressed=0,this.myTimeNotPressed=0,this.myPrevTimeNotPressed=0,this.myTimeTouched=0,this.myPrevTimeTouched=0,this.myTimeNotTouched=0,this.myPrevTimeNotTouched=0,this.myMultiplePressStartCount=0,this.myPrevMultiplePressStartCount=0,this.myMultiplePressEndCount=0,this.myPrevMultiplePressEndCount=0,this.myMultipleTouchStartCount=0,this.myPrevMultipleTouchStartCount=0,this.myMultipleTouchEndCount=0,this.myPrevMultipleTouchEndCount=0}getID(){return this.myID}getHandedness(){return this.myHandedness}getValue(){return this.myValue}isPressed(){return this.myPressed}isTouched(){return this.myTouched}isPressStart(e=null){return this.myPressed&&!this.myPrevIsPressed&&(e==null||this.myMultiplePressStartCount==e)}isPressEnd(e=null){return!this.myPressed&&this.myPrevIsPressed&&(e==null||this.myMultiplePressEndCount==e)}isTouchStart(e=null){return this.myTouched&&!this.myPrevIsTouched&&(e==null||this.myMultipleTouchStartCount==e)}isTouchEnd(e=null){return!this.myTouched&&this.myPrevIsTouched&&(e==null||this.myMultipleTouchEndCount==e)}clone(){let e=new i(this.myID,this.myHandedness);return e.myPressed=this.myPressed,e.myPrevIsPressed=this.myPrevIsPressed,e.myTouched=this.myTouched,e.myPrevIsTouched=this.myPrevIsTouched,e.myValue=this.myValue,e.myPrevValue=this.myPrevValue,e.myTimePressed=this.myTimePressed,e.myPrevTimePressed=this.myPrevTimePressed,e.myTimeNotPressed=this.myTimeNotPressed,e.myPrevTimeNotPressed=this.myPrevTimeNotPressed,e.myTimeTouched=this.myTimeTouched,e.myPrevTimeTouched=this.myPrevTimeTouched,e.myTimeNotTouched=this.myTimeNotTouched,e.myPrevTimeNotTouched=this.myPrevTimeNotTouched,e.myMultiplePressStartCount=this.myMultiplePressStartCount,e.myPrevMultiplePressStartCount=this.myPrevMultiplePressStartCount,e.myMultiplePressEndCount=this.myMultiplePressEndCount,e.myPrevMultiplePressEndCount=this.myPrevMultiplePressEndCount,e.myMultipleTouchStartCount=this.myMultipleTouchStartCount,e.myPrevMultipleTouchStartCount=this.myPrevMultipleTouchStartCount,e.myMultipleTouchEndCount=this.myMultipleTouchEndCount,e.myPrevMultipleTouchEndCount=this.myPrevMultipleTouchEndCount,e}},ys=class i{constructor(e,t){this.myID=e,this.myHandedness=t,this.myAxes=Ce(0,0),this.myPrevAxes=Ce(0,0)}getID(){return this.myID}getAxes(){return this.myAxes}getHandedness(){return this.myHandedness}clone(){let e=new i(this.myID,this.myHandedness);return e.myAxes.vec2_copy(this.myAxes),e.myPrevAxes.vec2_copy(this.myPrevAxes),e}},us=class i{constructor(){this.myIntensity=0,this.myDuration=0,this.myDevicePulsing=!1}clone(){let e=new i;return e.myIntensity=this.myIntensity,e.myDuration=this.myDuration,e.myDevicePulsing=this.myDevicePulsing,e}};var It=class{constructor(e){this._myHandPose=e,this._myManagingHandPose=!1,this._myDestroyed=!1}getHandedness(){return this.getHandPose().getHandedness()}getHandPose(){return this._myHandPose}getEngine(){return this.getHandPose().getEngine()}isGamepadCoreActive(){return!0}setManageHandPose(e){this._myManagingHandPose=e}isManagingHandPose(){return this._myManagingHandPose}start(){this.getHandPose()&&this.isManagingHandPose()&&this.getHandPose().start(),this._startHook()}preUpdate(e){this.getHandPose()&&this.isManagingHandPose()&&this.getHandPose().update(e),this._preUpdateHook(e)}postUpdate(e){this._postUpdateHook(e)}getButtonData(e){return this._createButtonData()}getAxesData(e){return this._createAxesData()}getHapticActuators(){return[]}_startHook(){}_preUpdateHook(e){}_postUpdateHook(e){}_destroyHook(){}_createButtonData(){return{myPressed:!1,myTouched:!1,myValue:0}}_createAxesData(){return Ce(0,0)}destroy(){this._myDestroyed=!0,this._destroyHook(),this.isManagingHandPose()&&this.getHandPose().destroy()}isDestroyed(){return this._myDestroyed}};var Vn=class extends It{constructor(e,t){super(t),this._myGamepadIndex=e,this._myCurrentGamepads=window.navigator.getGamepads(),this._myButtonData=this._createButtonData(),this._myAxesData=this._createAxesData(),this._myHapticActuators=[]}_preUpdateHook(e){this._myCurrentGamepads=window.navigator.getGamepads()}isGamepadCoreActive(){let e=this._getClassicGamepad();return e!=null&&(e.connected==null||e.connected)}getButtonData(e){this._myButtonData.myPressed=!1,this._myButtonData.myTouched=!1,this._myButtonData.myValue=0;let t=this._getClassicGamepad();if(t!=null&&this.isGamepadCoreActive()){let n=null;if(this.getHandedness()==A.LEFT)switch(e){case E.SELECT:n=t.buttons[4];break;case E.SQUEEZE:n=t.buttons[6];break;case E.TOUCHPAD:n=null;break;case E.THUMBSTICK:n=t.buttons[10];break;case E.BOTTOM_BUTTON:n=t.buttons[13];break;case E.TOP_BUTTON:n=t.buttons[12];break;case E.THUMB_REST:n=null;break}else switch(e){case E.SELECT:n=t.buttons[5];break;case E.SQUEEZE:n=t.buttons[7];break;case E.TOUCHPAD:n=null;break;case E.THUMBSTICK:n=t.buttons[11];break;case E.BOTTOM_BUTTON:n=t.buttons[0];break;case E.TOP_BUTTON:n=t.buttons[3];break;case E.THUMB_REST:n=null;break}n!=null&&(this._myButtonData.myPressed=n.pressed,this._myButtonData.myTouched=n.touched,this._myButtonData.myValue=n.value)}return this._myButtonData}getAxesData(e){this._myAxesData.vec2_zero();let t=this._getClassicGamepad();return t!=null&&this.isGamepadCoreActive()&&(this.getHandedness()==A.LEFT?(this._myAxesData[0]=t.axes[0],this._myAxesData[1]=t.axes[1]):(this._myAxesData[0]=t.axes[2],this._myAxesData[1]=t.axes[3]),this._myAxesData[1]=-this._myAxesData[1]),this._myAxesData}getHapticActuators(){this._myHapticActuators.pp_clear();let e=this._getClassicGamepad();if(e!=null&&this.isGamepadCoreActive()){if(e.hapticActuators!=null)for(let t=0;t<e.hapticActuators.length;t++)this._myHapticActuators.push(e.hapticActuators[t]);e.vibrationActuator!=null&&this._myHapticActuators.push(e.vibrationActuator)}return this._myHapticActuators}_getClassicGamepad(){let e=null;if(this._myGamepadIndex!=null)this._myGamepadIndex<this._myCurrentGamepads.length&&(e=this._myCurrentGamepads[this._myGamepadIndex]);else for(let t=0;t<this._myCurrentGamepads.length;t++){let n=this._myCurrentGamepads[t];if(n!=null&&(n.connected==null||n.connected)){e=n;break}}return e}};var $={_0:"0",_1:"1",_2:"2",_3:"3",_4:"4",_5:"5",_6:"6",_7:"7",_8:"8",_9:"9",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z",a:"a",b:"b",c:"c",d:"d",e:"e",f:"f",g:"g",h:"h",i:"i",j:"j",k:"k",l:"l",m:"m",n:"n",o:"o",p:"p",q:"q",r:"r",s:"s",t:"t",u:"u",v:"v",w:"w",x:"x",y:"y",z:"z",UP:"ArrowUp",DOWN:"ArrowDown",LEFT:"ArrowLeft",RIGHT:"ArrowRight",SPACE:" ",ENTER:"Enter",BACKSPACE:"Backspace",ESC:"Escape",SHIFT_LEFT:"ShiftLeft",SHIFT_RIGHT:"ShiftRight",CONTROL_LEFT:"ControlLeft",CONTROL_RIGHT:"ControlRight",ALT_LEFT:"AltLeft",ALT_RIGHT:"AltRight"},hs=class{constructor(e=m.getMainEngine()){this._myEngine=e,this._myKeyInfos={},this._myKeyInfosIDs=[];for(let t in $)this.addKey($[t]);this._myOnKeyDownEventListener=null,this._myOnKeyUpEventListener=null,this._myDestroyed=!1}isKeyPressed(e){let t=!1;return this._myKeyInfos[e]!=null&&(t=this._myKeyInfos[e].myPressed),t}isKeyPressStart(e){let t=!1;return this._myKeyInfos[e]!=null&&(t=this._myKeyInfos[e].myPressStart),t}isKeyPressEnd(e){let t=!1;return this._myKeyInfos[e]!=null&&(t=this._myKeyInfos[e].myPressEnd),t}addKey(e){this._myKeyInfos[e]=this._createKeyInfo(),this._myKeyInfosIDs.push(e)}start(){this._myOnKeyDownEventListener=this._keyDown.bind(this),m.getWindow(this._myEngine).addEventListener("keydown",this._myOnKeyDownEventListener),this._myOnKeyUpEventListener=this._keyUp.bind(this),m.getWindow(this._myEngine).addEventListener("keyup",this._myOnKeyUpEventListener)}update(e){if(!m.getDocument(this._myEngine).hasFocus())for(let t=0;t<this._myKeyInfosIDs.length;t++){let n=this._myKeyInfosIDs[t],o=this._myKeyInfos[n];o.myPressed&&(o.myPressed=!1,o.myPressEndToProcess=!0)}for(let t=0;t<this._myKeyInfosIDs.length;t++){let n=this._myKeyInfosIDs[t],o=this._myKeyInfos[n];o.myPressStart=o.myPressStartToProcess,o.myPressEnd=o.myPressEndToProcess,o.myPressStartToProcess=!1,o.myPressEndToProcess=!1}}_keyDown(e){this._keyPressedChanged(e.key,!0),e.key!=e.code&&this._keyPressedChanged(e.code,!0)}_keyUp(e){this._keyPressedChanged(e.key,!1),e.key!=e.code&&this._keyPressedChanged(e.code,!1)}_keyPressedChanged(e,t){if(this._myKeyInfos[e]!=null){let n=this._myKeyInfos[e];t?(n.myPressed=!0,n.myPressStartToProcess=!0):(n.myPressed=!1,n.myPressEndToProcess=!0)}}_createKeyInfo(){return{myPressed:!1,myPressStart:!1,myPressStartToProcess:!1,myPressEnd:!1,myPressEndToProcess:!1}}destroy(){this._myDestroyed=!0,m.getWindow(this._myEngine).removeEventListener("keydown",this._myOnKeyDownEventListener),m.getWindow(this._myEngine).removeEventListener("keyup",this._myOnKeyUpEventListener)}isDestroyed(){return this._myDestroyed}};var On=class extends It{constructor(e){super(e),this._myButtonData=this._createButtonData(),this._myAxesData=this._createAxesData(),this._myHapticActuators=[]}isGamepadCoreActive(){return!0}getButtonData(e){this._myButtonData.myPressed=!1,this._myButtonData.myTouched=!1,this._myButtonData.myValue=0;let t=m.getKeyboard(this.getEngine());if(this.isGamepadCoreActive())if(this.getHandedness()==A.LEFT)switch(e){case E.SELECT:this._myButtonData.myPressed=t.isKeyPressed($.E)||t.isKeyPressed($.e);break;case E.SQUEEZE:this._myButtonData.myPressed=t.isKeyPressed($.Q)||t.isKeyPressed($.q);break;case E.TOUCHPAD:this._myButtonData.myPressed=t.isKeyPressed($.X)||t.isKeyPressed($.x);break;case E.THUMBSTICK:this._myButtonData.myPressed=t.isKeyPressed($.R)||t.isKeyPressed($.r);break;case E.BOTTOM_BUTTON:this._myButtonData.myPressed=t.isKeyPressed($.C)||t.isKeyPressed($.c);break;case E.TOP_BUTTON:this._myButtonData.myPressed=t.isKeyPressed($.F)||t.isKeyPressed($.f);break;case E.THUMB_REST:this._myButtonData.myPressed=t.isKeyPressed($.V)||t.isKeyPressed($.v);break}else switch(e){case E.SELECT:this._myButtonData.myPressed=t.isKeyPressed($.U)||t.isKeyPressed($.u);break;case E.SQUEEZE:this._myButtonData.myPressed=t.isKeyPressed($.O)||t.isKeyPressed($.o);break;case E.TOUCHPAD:this._myButtonData.myPressed=t.isKeyPressed($.M)||t.isKeyPressed($.m);break;case E.THUMBSTICK:this._myButtonData.myPressed=t.isKeyPressed($.Y)||t.isKeyPressed($.y);break;case E.BOTTOM_BUTTON:this._myButtonData.myPressed=t.isKeyPressed($.N)||t.isKeyPressed($.n);break;case E.TOP_BUTTON:this._myButtonData.myPressed=t.isKeyPressed($.H)||t.isKeyPressed($.h);break;case E.THUMB_REST:this._myButtonData.myPressed=t.isKeyPressed($.B)||t.isKeyPressed($.b);break}return this._myButtonData.myPressed&&(this._myButtonData.myTouched=!0,this._myButtonData.myValue=1),this._myButtonData}getAxesData(e){this._myAxesData.vec2_zero();let t=m.getKeyboard(this.getEngine());return this.isGamepadCoreActive()&&(this.getHandedness()==A.LEFT?((t.isKeyPressed($.W)||t.isKeyPressed($.w))&&(this._myAxesData[1]+=1),(t.isKeyPressed($.S)||t.isKeyPressed($.s))&&(this._myAxesData[1]+=-1),(t.isKeyPressed($.D)||t.isKeyPressed($.d))&&(this._myAxesData[0]+=1),(t.isKeyPressed($.A)||t.isKeyPressed($.a))&&(this._myAxesData[0]+=-1)):((t.isKeyPressed($.I)||t.isKeyPressed($.i)||t.isKeyPressed($.UP))&&(this._myAxesData[1]+=1),(t.isKeyPressed($.K)||t.isKeyPressed($.k)||t.isKeyPressed($.DOWN))&&(this._myAxesData[1]+=-1),(t.isKeyPressed($.L)||t.isKeyPressed($.l)||t.isKeyPressed($.RIGHT))&&(this._myAxesData[0]+=1),(t.isKeyPressed($.J)||t.isKeyPressed($.j)||t.isKeyPressed($.LEFT))&&(this._myAxesData[0]+=-1))),this._myAxesData}getHapticActuators(){return this._myHapticActuators}};var In=class extends It{constructor(e){super(e),this._mySelectPressed=!1,this._mySqueezePressed=!1,this._myXRSessionActive=!1,this._myInputSource=null,this._myGamepad=null,this._mySelectStartEventListener=null,this._mySelectEndEventListener=null,this._mySqueezeStartEventListener=null,this._mySqueezeEndEventListener=null,this._myButtonData=this._createButtonData(),this._myAxesData=this._createAxesData(),this._myHapticActuators=[]}isGamepadCoreActive(){return this._myXRSessionActive&&this._myGamepad!=null&&(this._myGamepad.connected==null||this._myGamepad.connected)}_startHook(){O.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this.getEngine())}_preUpdateHook(e){this._myInputSource=this.getHandPose().getInputSource(),this._myInputSource!=null?this._myGamepad=this._myInputSource.gamepad:this._myGamepad=null}getButtonData(e){if(this._myButtonData.myPressed=!1,this._myButtonData.myTouched=!1,this._myButtonData.myValue=0,this.isGamepadCoreActive()){if(e<this._myGamepad.buttons.length){let t=this._myGamepad.buttons[e];e!=E.SELECT&&e!=E.SQUEEZE?this._myButtonData.myPressed=t.pressed:this._myButtonData.myPressed=this._getSpecialButtonPressed(e),this._myButtonData.myTouched=t.touched,this._myButtonData.myValue=t.value}else if(e==E.TOP_BUTTON&&this._myGamepad.buttons.length>=3){let t=this._myGamepad.buttons[2];this._myButtonData.myPressed=t.pressed,this._myButtonData.myTouched=t.touched,this._myButtonData.myValue=t.value}}return this._myButtonData}getAxesData(e){if(this._myAxesData.vec2_zero(),this.isGamepadCoreActive()){let t=this._myGamepad.axes;t.length==4?(Math.abs(t[0])>Math.abs(t[2])?this._myAxesData[0]=t[0]:this._myAxesData[0]=t[2],Math.abs(t[1])>Math.abs(t[3])?this._myAxesData[1]=t[1]:this._myAxesData[1]=t[3]):t.length==2&&(this._myAxesData[0]=t[0],this._myAxesData[1]=t[1]),this._myAxesData[1]=-this._myAxesData[1]}return this._myAxesData}getHapticActuators(){if(this._myHapticActuators.pp_clear(),this.isGamepadCoreActive()){if(this._myGamepad.hapticActuators!=null)for(let e=0;e<this._myGamepad.hapticActuators.length;e++)this._myHapticActuators.push(this._myGamepad.hapticActuators[e]);this._myGamepad.vibrationActuator!=null&&this._myHapticActuators.push(this._myGamepad.vibrationActuator)}return this._myHapticActuators}_getSpecialButtonPressed(e){let t=!1;return this.isGamepadCoreActive()&&(e==E.SELECT?t=this._mySelectPressed:e==E.SQUEEZE&&(t=this._mySqueezePressed)),t}_onXRSessionStart(e){this._mySelectStartEventListener=this._selectStart.bind(this),this._mySelectEndEventListener=this._selectEnd.bind(this),this._mySqueezeStartEventListener=this._squeezeStart.bind(this),this._mySqueezeEndEventListener=this._squeezeEnd.bind(this),e.addEventListener("selectstart",this._mySelectStartEventListener),e.addEventListener("selectend",this._mySelectEndEventListener),e.addEventListener("squeezestart",this._mySqueezeStartEventListener),e.addEventListener("squeezeend",this._mySqueezeEndEventListener),this._myXRSessionActive=!0}_onXRSessionEnd(e){this._mySelectStartEventListener=null,this._mySelectEndEventListener=null,this._mySqueezeStartEventListener=null,this._mySqueezeEndEventListener=null,this._myXRSessionActive=!1}_selectStart(e){this._myInputSource!=null&&this._myInputSource==e.inputSource&&(this._mySelectPressed=!0)}_selectEnd(e){this._myInputSource!=null&&this._myInputSource==e.inputSource&&(this._mySelectPressed=!1)}_squeezeStart(e){this._myInputSource!=null&&this._myInputSource==e.inputSource&&(this._mySqueezePressed=!0)}_squeezeEnd(e){this._myInputSource!=null&&this._myInputSource==e.inputSource&&(this._mySqueezePressed=!1)}_destroyHook(){O.getSession(this.getEngine())?.removeEventListener("selectstart",this._mySelectStartEventListener),O.getSession(this.getEngine())?.removeEventListener("selectend",this._mySelectEndEventListener),O.getSession(this.getEngine())?.removeEventListener("squeezestart",this._mySqueezeStartEventListener),O.getSession(this.getEngine())?.removeEventListener("squeezeend",this._mySqueezeEndEventListener),O.unregisterSessionStartEndEventListeners(this,this.getEngine())}};import{Emitter as jP}from"@wonderlandengine/api";var cs=class{constructor(e){this._myHandedness=e,this._myButtonInfos={},this._myButtonInfosIDs=[];for(let t in E)this._myButtonInfos[E[t]]=new ms(E[t],this._myHandedness),this._myButtonInfosIDs.push(E[t]);this._myAxesInfos={},this._myAxesInfosIDs=[];for(let t in ne)this._myAxesInfos[ne[t]]=new ys(ne[t],this._myHandedness),this._myAxesInfosIDs.push(ne[t]);this._myButtonEmitters=[];for(let t in E){this._myButtonEmitters[E[t]]=[];for(let n in ae)this._myButtonEmitters[E[t]][ae[n]]=new jP}this._myAxesEmitters=[];for(let t in ne){this._myAxesEmitters[ne[t]]=[];for(let n in Qt)this._myAxesEmitters[ne[t]][Qt[n]]=new jP}this._myPulseInfo=new us,this._myDestroyed=!1,this._myMultiplePressMaxDelay=.4,this._myMultipleTouchMaxDelay=.4}getHandedness(){return this._myHandedness}getButtonInfo(e){return this._myButtonInfos[e]}registerButtonEventListener(e,t,n,o){this._myButtonEmitters[e][t].add(o,{id:n})}unregisterButtonEventListener(e,t,n){this._myButtonEmitters[e][t].remove(n)}getAxesInfo(e){return this._myAxesInfos[e]}registerAxesEventListener(e,t,n,o){this._myAxesEmitters[e][t].add(o,{id:n})}unregisterAxesEventListener(e,t,n){this._myAxesEmitters[e][t].remove(n)}pulse(e,t=0){this._myPulseInfo.myIntensity=Math.pp_clamp(e,0,1),this._myPulseInfo.myDuration=Math.max(t,0)}stopPulse(){this._myPulseInfo.myIntensity=0,this._myPulseInfo.myDuration=0}isPulsing(){return this._myPulseInfo.myIntensity>0||this._myPulseInfo.myDuration>0}getPulseInfo(){return this._myPulseInfo}getMultiplePressMaxDelay(){return this._myMultiplePressMaxDelay}setMultiplePressMaxDelay(e){this._myMultiplePressMaxDelay=e}getMultipleTouchMaxDelay(){return this._myMultipleTouchMaxDelay}setMultipleTouchMaxDelay(e){this._myMultipleTouchMaxDelay=e}getHandPose(){return null}_startHook(){}_preUpdate(e){}_postUpdate(e){}_getButtonData(e){return this._createButtonData()}_getAxesData(e){return this._createAxesData()}_getHapticActuators(){return[]}_destroyHook(){}start(){this._startHook()}update(e){this._preUpdate(e),this._preUpdateButtonInfos(),this._updateButtonInfos(),this._postUpdateButtonInfos(e),this._preUpdateAxesInfos(),this._updateAxesInfos(),this._postUpdateAxesInfos(),this._updatePulse(e),this._postUpdate(e)}_preUpdateButtonInfos(){for(let e=0;e<this._myButtonInfosIDs.length;e++){let t=this._myButtonInfosIDs[e],n=this._myButtonInfos[t];n.myPrevIsPressed=n.myPressed,n.myPrevIsTouched=n.myTouched,n.myPrevValue=n.myValue}}_updateButtonInfos(){this._updateSingleButtonInfo(E.SELECT),this._updateSingleButtonInfo(E.SQUEEZE),this._updateSingleButtonInfo(E.TOUCHPAD),this._updateSingleButtonInfo(E.THUMBSTICK),this._updateSingleButtonInfo(E.BOTTOM_BUTTON),this._updateSingleButtonInfo(E.TOP_BUTTON),this._updateSingleButtonInfo(E.THUMB_REST)}_updateSingleButtonInfo(e){let t=this._myButtonInfos[e],n=this._getButtonData(e);t.myPressed=n.myPressed,t.myTouched=n.myTouched,t.myValue=n.myValue}_postUpdateButtonInfos(e){for(let t=0;t<this._myButtonInfosIDs.length;t++){let n=this._myButtonInfosIDs[t],o=this._myButtonInfos[n];o.myPressed?(o.myTimePressed+=e,o.myPrevIsPressed||(o.myMultiplePressStartCount+=1,o.myPrevTimeNotPressed=o.myTimeNotPressed,o.myTimeNotPressed=0),o.myPrevTimeNotPressed+o.myTimePressed>this._myMultiplePressMaxDelay&&o.myMultiplePressEndCount>0&&(o.myPrevMultiplePressEndCount=o.myMultiplePressEndCount,o.myMultiplePressEndCount=0),o.myTimePressed>this._myMultiplePressMaxDelay&&o.myMultiplePressStartCount>0&&(o.myPrevMultiplePressStartCount=o.myMultiplePressStartCount,o.myMultiplePressStartCount=0)):(o.myTimeNotPressed+=e,o.myPrevIsPressed&&(o.myMultiplePressEndCount+=1,o.myPrevTimePressed=o.myTimePressed,o.myTimePressed=0),o.myPrevTimePressed+o.myTimeNotPressed>this._myMultiplePressMaxDelay&&o.myMultiplePressStartCount>0&&(o.myPrevMultiplePressStartCount=o.myMultiplePressStartCount,o.myMultiplePressStartCount=0),o.myTimeNotPressed>this._myMultiplePressMaxDelay&&o.myMultiplePressEndCount>0&&(o.myPrevMultiplePressEndCount=o.myMultiplePressEndCount,o.myMultiplePressEndCount=0)),o.myTouched?(o.myTimeTouched+=e,o.myPrevIsTouched||(o.myMultipleTouchStartCount+=1,o.myPrevTimeNotTouched=o.myTimeNotTouched,o.myTimeNotTouched=0),o.myPrevTimeNotTouched+o.myTimeTouched>this._myMultipleTouchMaxDelay&&o.myMultipleTouchEndCount>0&&(o.myPrevMultipleTouchEndCount=o.myMultipleTouchEndCount,o.myMultipleTouchEndCount=0),o.myTimeTouched>this._myMultipleTouchMaxDelay&&o.myMultipleTouchStartCount>0&&(o.myPrevMultipleTouchStartCount=o.myMultipleTouchStartCount,o.myMultipleTouchStartCount=0)):(o.myTimeNotTouched+=e,o.myPrevIsTouched&&(o.myMultipleTouchEndCount+=1,o.myPrevTimeTouched=o.myTimeTouched,o.myTimeTouched=0),o.myPrevTimeTouched+o.myTimeNotTouched>this._myMultipleTouchMaxDelay&&o.myMultipleTouchStartCount>0&&(o.myPrevMultipleTouchStartCount=o.myMultipleTouchStartCount,o.myMultipleTouchStartCount=0),o.myTimeNotTouched>this._myMultipleTouchMaxDelay&&o.myMultipleTouchEndCount>0&&(o.myPrevMultipleTouchEndCount=o.myMultipleTouchEndCount,o.myMultipleTouchEndCount=0))}for(let t=0;t<this._myButtonInfosIDs.length;t++){let n=this._myButtonInfosIDs[t],o=this._myButtonInfos[n],s=this._myButtonEmitters[n];o.myPressed&&!o.myPrevIsPressed&&s[ae.PRESS_START].notify(o,this),!o.myPressed&&o.myPrevIsPressed&&s[ae.PRESS_END].notify(o,this),o.myPressed?s[ae.PRESSED].notify(o,this):s[ae.NOT_PRESSED].notify(o,this),o.myTouched&&!o.myPrevIsTouched&&s[ae.TOUCH_START].notify(o,this),!o.myTouched&&o.myPrevIsTouched&&s[ae.TOUCH_END].notify(o,this),o.myTouched?s[ae.TOUCHED].notify(o,this):s[ae.NOT_TOUCHED].notify(o,this),o.myValue!=o.myPrevValue&&s[ae.VALUE_CHANGED].notify(o,this),s[ae.ALWAYS].notify(o,this)}this._mySelectStart=!1,this._mySelectEnd=!1,this._mySqueezeStart=!1,this._mySqueezeEnd=!1}_preUpdateAxesInfos(){for(let e=0;e<this._myAxesInfosIDs.length;e++){let t=this._myAxesInfosIDs[e],n=this._myAxesInfos[t];n.myPrevAxes[0]=n.myAxes[0],n.myPrevAxes[1]=n.myAxes[1]}}_updateAxesInfos(){this._updateSingleAxesInfo(ne.THUMBSTICK)}_updateSingleAxesInfo(e){let t=this._myAxesInfos[e],n=this._getAxesData(e);t.myAxes[0]=n[0],t.myAxes[1]=n[1]}_postUpdateAxesInfos(){for(let e in ne){let t=this._myAxesInfos[ne[e]],n=this._myAxesEmitters[ne[e]];t.myAxes[0]!=t.myPrevAxes[0]&&n[Qt.X_CHANGED].notify(t,this),t.myAxes[1]!=t.myPrevAxes[1]&&n[Qt.Y_CHANGED].notify(t,this),(t.myAxes[0]!=t.myPrevAxes[0]||t.myAxes[1]!=t.myPrevAxes[1])&&n[Qt.AXES_CHANGED].notify(t,this),n[Qt.ALWAYS].notify(t,this)}}_updatePulse(e){if(this._myPulseInfo.myDevicePulsing||this._myPulseInfo.myIntensity>0){let t=this._getHapticActuators();if(t.length>0){if(this._myPulseInfo.myIntensity>0){for(let n=0;n<t.length;n++)t[n].pulse(this._myPulseInfo.myIntensity,Math.max(250,this._myPulseInfo.myDuration*1e3));this._myPulseInfo.myDevicePulsing=!0}else if(this._myPulseInfo.myDevicePulsing){for(let n=0;n<t.length;n++){let o=t[n];o.pulse(0,1);try{o.reset()}catch{}}this._myPulseInfo.myDevicePulsing=!1}}else this._myPulseInfo.myDevicePulsing=!1}this._myPulseInfo.myDuration-=e,this._myPulseInfo.myDuration<=0&&(this._myPulseInfo.myIntensity=0,this._myPulseInfo.myDuration=0)}_createButtonData(){return{myPressed:!1,myTouched:!1,myValue:0}}_createAxesData(){return Ce(0,0)}destroy(){this._myDestroyed=!0,this._destroyHook()}isDestroyed(){return this._myDestroyed}};var Bn=class extends cs{constructor(e){super(e),this._myGamepadCores={},this._myGamepadCoresIDs=[],this._myStarted=!1,this._myButtonData=this._createButtonData(),this._myAxesData=this._createAxesData(),this._myHapticActuators=[]}addGamepadCore(e,t){t.getHandedness()==this.getHandedness()&&(this._myGamepadCores[e]=t,this._myGamepadCoresIDs.push(e),this._myStarted&&t.start())}getGamepadCore(e){return this._myGamepadCores[e]}removeGamepadCore(e){this._myGamepadCores[e]!=null&&(delete this._myGamepadCores[e],this._myGamepadCoresIDs.pp_removeEqual(e))}removeAllGamepadCores(){this._myGamepadCores={},this._myGamepadCoresIDs=[]}getHandPose(){let e=null;for(let t=0;t<this._myGamepadCoresIDs.length;t++){let n=this._myGamepadCoresIDs[t],o=this._myGamepadCores[n];if(o.isGamepadCoreActive()){let s=o.getHandPose();(e==null||s!=null&&s.isValid())&&(e=s)}if(e!=null&&e.isValid())break}return e}_startHook(){for(let e=0;e<this._myGamepadCoresIDs.length;e++){let t=this._myGamepadCoresIDs[e];this._myGamepadCores[t].start()}this._myStarted=!0}_preUpdate(e){for(let t=0;t<this._myGamepadCoresIDs.length;t++){let n=this._myGamepadCoresIDs[t];this._myGamepadCores[n].preUpdate(e)}}_postUpdate(e){for(let t=0;t<this._myGamepadCoresIDs.length;t++){let n=this._myGamepadCoresIDs[t];this._myGamepadCores[n].postUpdate(e)}}_getButtonData(e){this._myButtonData.myPressed=!1,this._myButtonData.myTouched=!1,this._myButtonData.myValue=0;for(let t=0;t<this._myGamepadCoresIDs.length;t++){let n=this._myGamepadCoresIDs[t],o=this._myGamepadCores[n];if(o.isGamepadCoreActive()){let s=o.getButtonData(e);this._myButtonData.myPressed=this._myButtonData.myPressed||s.myPressed,this._myButtonData.myTouched=this._myButtonData.myTouched||s.myTouched,Math.abs(s.myValue)>Math.abs(this._myButtonData.myValue)&&(this._myButtonData.myValue=s.myValue)}}return this._myButtonData}_getAxesData(e){this._myAxesData.vec2_zero();for(let t=0;t<this._myGamepadCoresIDs.length;t++){let n=this._myGamepadCoresIDs[t],o=this._myGamepadCores[n];if(o.isGamepadCoreActive()){let s=o.getAxesData(e);Math.abs(s[0])>Math.abs(this._myAxesData[0])&&(this._myAxesData[0]=s[0]),Math.abs(s[1])>Math.abs(this._myAxesData[1])&&(this._myAxesData[1]=s[1])}}return this._myAxesData}_getHapticActuators(){this._myHapticActuators.pp_clear();for(let e=0;e<this._myGamepadCoresIDs.length;e++){let t=this._myGamepadCoresIDs[e],n=this._myGamepadCores[t];if(n.isGamepadCoreActive()){let o=n.getHapticActuators();for(let s=0;s<o.length;s++)this._myHapticActuators.push(o[s])}}return this._myHapticActuators}_destroyHook(){for(let e=0;e<this._myGamepadCoresIDs.length;e++){let t=this._myGamepadCoresIDs[e];this._myGamepadCores[t].destroy()}}};var ps=class{constructor(){this._myGamepads=[],this._myGamepads[A.LEFT]=new Bn(A.LEFT),this._myGamepads[A.RIGHT]=new Bn(A.RIGHT),this._myDestroyed=!1}start(){for(let e in this._myGamepads)this._myGamepads[e].start()}update(e){for(let t in this._myGamepads)this._myGamepads[t].update(e)}getLeftGamepad(){return this._myGamepads[A.LEFT]}getRightGamepad(){return this._myGamepads[A.RIGHT]}getGamepad(e){return this._myGamepads[e]}getGamepads(){return this._myGamepads}destroy(){this._myDestroyed=!0;for(let e in this._myGamepads)this._myGamepads[e].destroy()}isDestroyed(){return this._myDestroyed}};import{Emitter as CA}from"@wonderlandengine/api";var xt=class{constructor(e=m.getMainEngine()){this.myReferenceObject=null,this.myForwardFixed=!0,this.myUpdateOnViewReset=!0,this.myForceEmulatedVelocities=!1,this.myEngine=e}},Ge=class{constructor(e=new xt){this._myForwardFixed=e.myForwardFixed,this._myForceEmulatedVelocities=e.myForceEmulatedVelocities,this._myUpdateOnViewReset=e.myUpdateOnViewReset,this._myReferenceObject=e.myReferenceObject,this._myEngine=e.myEngine,this._myPosition=p(),this._myRotationQuat=G(),this._myPrevPosition=p(),this._myPrevRotationQuat=w(),this._myLinearVelocity=p(),this._myAngularVelocityRadians=p(),this._myValid=!1,this._myLinearVelocityEmulated=!0,this._myAngularVelocityEmulated=!0,this._myPoseUpdatedEmitter=new CA,this._myViewResetEventListener=null,this._myDestroyed=!1}getEngine(){return this._myEngine}setReferenceObject(e){this._myReferenceObject=e}getReferenceObject(){return this._myReferenceObject}setForwardFixed(e){this._myForwardFixed=e}isForwardFixed(){return this._myForwardFixed}setForceEmulatedVelocities(e){this._myForceEmulatedVelocities=e}isForceEmulatedVelocities(){return this._myForceEmulatedVelocities}setUpdateOnViewReset(e){this._myUpdateOnViewReset=e}isUpdateOnViewReset(){return this._myUpdateOnViewReset}getReferenceSpace(){return O.getReferenceSpace(this._myEngine)}getPosition(e=p(),t=void 0){}getRotation(e=p(),t=void 0){return this.getRotationDegrees(e,t)}getRotationDegrees(e=p(),t=void 0){}getRotationRadians(e=p(),t=void 0){}getRotationQuat(e=w(),t=void 0){}getTransform(e=be(),t=void 0){return this.getTransformMatrix(e,t)}getTransformMatrix(e=be(),t=void 0){}getTransformQuat(e=G(),t=void 0){}getLinearVelocity(e=p(),t=void 0){}getAngularVelocity(e=p(),t=void 0){return this.getAngularVelocityDegrees(e,t)}getAngularVelocityDegrees(e=p(),t=void 0){}getAngularVelocityRadians(e=p(),t=void 0){}isValid(){return this._myValid}isLinearVelocityEmulated(){return this._myLinearVelocityEmulated}isAngularVelocityEmulated(){return this._myAngularVelocityEmulated}registerPoseUpdatedEventListener(e,t){this._myPoseUpdatedEmitter.add(t,{id:e})}unregisterPoseUpdatedEventListener(e){this._myPoseUpdatedEmitter.remove(e)}start(){O.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!0,this._myEngine)}update(e){this._update(e,!0)}_isReadyToGetPose(){return!0}_getPose(e){return null}_updateHook(e,t,n){}_onXRSessionStartHook(e,t){}_onXRSessionEndHook(){}_onViewResetHook(){}_destroyHook(){}_update(e,t){this._myPrevPosition.vec3_copy(this._myPosition),this._myPrevRotationQuat.quat_copy(this._myRotationQuat);let n=O.getFrame(this._myEngine);if(n&&this._isReadyToGetPose()){let o=null;try{o=this._getPose(n)}catch{}o?(this._myPosition[0]=o.transform.position.x,this._myPosition[1]=o.transform.position.y,this._myPosition[2]=o.transform.position.z,this._myRotationQuat[0]=o.transform.orientation.x,this._myRotationQuat[1]=o.transform.orientation.y,this._myRotationQuat[2]=o.transform.orientation.z,this._myRotationQuat[3]=o.transform.orientation.w,this._myRotationQuat.quat_normalize(this._myRotationQuat),t&&(o.linearVelocity&&!this._myForceEmulatedVelocities?(this._myLinearVelocity[0]=o.linearVelocity.x,this._myLinearVelocity[1]=o.linearVelocity.y,this._myLinearVelocity[2]=o.linearVelocity.z,this._myLinearVelocityEmulated=!1):(this._computeEmulatedLinearVelocity(e),this._myLinearVelocityEmulated=!0),o.angularVelocity&&!this._myForceEmulatedVelocities?(this._myAngularVelocityRadians[0]=o.angularVelocity.x,this._myAngularVelocityRadians[1]=o.angularVelocity.y,this._myAngularVelocityRadians[2]=o.angularVelocity.z,this._myAngularVelocityEmulated=!1):(this._computeEmulatedAngularVelocity(e),this._myAngularVelocityEmulated=!0)),this._myValid=!0):(t&&(this._myLinearVelocity[0]=0,this._myLinearVelocity[1]=0,this._myLinearVelocity[2]=0,this._myAngularVelocityRadians[0]=0,this._myAngularVelocityRadians[1]=0,this._myAngularVelocityRadians[2]=0),this._myValid=!1,this._myLinearVelocityEmulated=!0,this._myAngularVelocityEmulated=!0),this._updateHook(e,t,o)}else t&&(this._myLinearVelocity[0]=0,this._myLinearVelocity[1]=0,this._myLinearVelocity[2]=0,this._myAngularVelocityRadians[0]=0,this._myAngularVelocityRadians[1]=0,this._myAngularVelocityRadians[2]=0),this._myValid=!1,this._myLinearVelocityEmulated=!0,this._myAngularVelocityEmulated=!0,this._updateHook(e,t,null);this._myPoseUpdatedEmitter.notify(this)}_computeEmulatedLinearVelocity(e){e>0?(this._myPosition.vec3_sub(this._myPrevPosition,this._myLinearVelocity),this._myLinearVelocity.vec3_scale(1/e,this._myLinearVelocity)):(this._myLinearVelocity[0]=0,this._myLinearVelocity[1]=0,this._myLinearVelocity[2]=0)}_onXRSessionStart(e,t){let n=O.getReferenceSpace(this._myEngine);n.addEventListener!=null&&(this._myViewResetEventListener=this._onViewReset.bind(this),n.addEventListener("reset",this._myViewResetEventListener)),this._onXRSessionStartHook(e,t)}_onXRSessionEnd(){this._onXRSessionEndHook(),this._myViewResetEventListener=null}_onViewReset(){this._myUpdateOnViewReset&&this._update(0,!1),this._onViewResetHook()}_computeEmulatedAngularVelocity(){}destroy(){this._myDestroyed=!0,this._destroyHook(),O.getReferenceSpace(this._myEngine)?.removeEventListener?.("reset",this._myViewResetEventListener),O.unregisterSessionStartEndEventListeners(this,this._myEngine)}isDestroyed(){return this._myDestroyed}};Ge.prototype.getPosition=function(){let i=be();return function(t=p(),n=void 0){let o=n===void 0?this._myReferenceObject:n;return t.vec3_copy(this._myPosition),o==null?t:t.vec3_convertPositionToWorld(o.pp_getTransform(i),t)}}();Ge.prototype.getRotationDegrees=function(){let i=w();return function(t=p(),n=void 0){return this.getRotationQuat(i,n).quat_toDegrees(t)}}();Ge.prototype.getRotationRadians=function(){let i=w();return function(t=p(),n=void 0){return this.getRotationQuat(i,n).quat_toRadians(t)}}();Ge.prototype.getRotationQuat=function(){let i=w(),e=p();return function(n=w(),o=void 0){let s=o===void 0?this._myReferenceObject:o;return n.quat_copy(this._myRotationQuat),this._myForwardFixed&&n.quat_rotateAxisRadians(Math.PI,n.quat_getUp(e),n),s==null?n:n.quat_toWorld(s.pp_getRotationQuat(i),n)}}();Ge.prototype.getTransformMatrix=function(){let i=G();return function(t=be(),n=void 0){return this.getTransformQuat(i,n).quat2_toMatrix(t)}}();Ge.prototype.getTransformQuat=function(){let i=w(),e=G();return function(n=G(),o=void 0){let s=o===void 0?this._myReferenceObject:o;return n.quat2_identity(),n.quat2_setPositionRotationQuat(this._myPosition,this.getRotationQuat(i,o)),s==null?n:n.quat_toWorld(s.pp_getTransformQuat(e),n)}}();Ge.prototype.getLinearVelocity=function(){let i=be();return function(t=p(),n=void 0){let o=n===void 0?this._myReferenceObject:n;return t.vec3_copy(this._myLinearVelocity),o==null?t:t.vec3_convertDirectionToWorld(o.pp_getTransform(i),t)}}();Ge.prototype.getAngularVelocityDegrees=function(){let i=p();return function(t=p(),n=void 0){return this.getAngularVelocityRadians(i,n).vec3_toDegrees(t)}}();Ge.prototype.getAngularVelocityRadians=function(){let i=be();return function(t=p(),n=void 0){let o=n===void 0?this._myReferenceObject:n;return t.vec3_copy(this._myAngularVelocityRadians),o==null?t:t.vec3_convertDirectionToWorld(o.pp_getTransform(i),t)}}();Ge.prototype._computeEmulatedAngularVelocity=function(){let i=p(),e=p();return function(n){n>0?(i=this._myRotationQuat.quat_toRadians(i),e=this._myPrevRotationQuat.quat_toRadians(e),i.vec3_sub(e,this._myAngularVelocityRadians),this._myAngularVelocityRadians.vec3_scale(1/n,this._myAngularVelocityRadians)):(this._myAngularVelocityRadians[0]=0,this._myAngularVelocityRadians[1]=0,this._myAngularVelocityRadians[2]=0)}}();var qi=class extends xt{constructor(e){super(e),this.myFixTrackedHandRotation=!0}},Xi=class extends Ge{constructor(e,t=new qi){super(t),this._myInputSource=null,this._myHandedness=e,this._myFixTrackedHandRotation=t.myFixTrackedHandRotation,this._myTrackedHand=!1,this._myInputSourcesChangeEventListener=null}getHandedness(){return this._myHandedness}getInputSource(){return this._myInputSource}getInputSourceType(){return this._myInputSource==null?null:ie.getInputSourceType(this._myInputSource)}isFixTrackedHandRotation(){return this._myFixTrackedHandRotation}setFixTrackedHandRotation(e){this.myFixTrackedHandRotation=e}getRotationQuat(e=void 0){}_isReadyToGetPose(){return this._myInputSource!=null}_getPose(e){return e.getPose(this._myInputSource.gripSpace,this.getReferenceSpace())}_onXRSessionStartHook(e,t){this._myInputSourcesChangeEventListener=function(){if(this._myInputSource=null,t.inputSources!=null&&t.inputSources.length>0)for(let n of t.inputSources)n.handedness==this._myHandedness&&(this._myInputSource=n,this._myTrackedHand=ie.getInputSourceType(this._myInputSource)==lt.TRACKED_HAND)}.bind(this),this._myInputSourcesChangeEventListener(),t.addEventListener("inputsourceschange",this._myInputSourcesChangeEventListener)}_onXRSessionEndHook(){this._myInputSource=null,this._myInputSourcesChangeEventListener=null}_destroyHook(){O.getSession(this.getEngine())?.removeEventListener("inputsourceschange",this._myInputSourcesChangeEventListener)}};Xi.prototype.getRotationQuat=function(){let i=w(),e=p(),t=p(),n=p();return function(s=w(),a=void 0){let l=a===void 0?this._myReferenceObject:a;if(s.quat_copy(this._myRotationQuat),this._myForwardFixed&&s.quat_rotateAxisRadians(Math.PI,s.quat_getUp(e),s),this._myFixTrackedHandRotation&&this._myTrackedHand){s.quat_rotateAxis(-60,s.quat_getRight(t),s);let h=20;h=this._myHandedness==A.LEFT?h:-h,s.quat_rotateAxis(h,s.quat_getForward(n),s)}return l==null?s:s.quat_toWorld(l.pp_getRotationQuat(i),s)}}();var ds=class extends Ge{_getPose(e){return e.getViewerPose(this.getReferenceSpace())}};var Ln=class extends Ge{constructor(e,t,n=new xt){super(n),this._myInputSource=null,this._myHandedness=e,this._myTrackedHandJointID=t,this._myJointRadius=0,this._myInputSourcesChangeEventListener=null}getHandedness(){return this._myHandedness}getTrackedHandJointID(){return this._myTrackedHandJointID}setTrackedHandJointID(e){this._myTrackedHandJointID=e}getJointRadius(){return this._myJointRadius}_isReadyToGetPose(){return this._myInputSource!=null}_getPose(e){return e.getJointPose(this._myInputSource.hand.get(this._myTrackedHandJointID),this.getReferenceSpace())}_updateHook(e,t,n){n!=null&&(this._myJointRadius=n.radius)}_onXRSessionStartHook(e,t){this._myInputSourcesChangeEventListener=function(){if(this._myInputSource=null,t.inputSources!=null&&t.inputSources.length>0)for(let n of t.inputSources)n.handedness==this._myHandedness&&ie.getInputSourceType(n)==lt.TRACKED_HAND&&(this._myInputSource=n)}.bind(this),this._myInputSourcesChangeEventListener(),t.addEventListener("inputsourceschange",this._myInputSourcesChangeEventListener)}_onXRSessionEndHook(){this._myInputSource=null,this._myInputSourcesChangeEventListener=null}_destroyHook(){O.getSession(this.getEngine())?.removeEventListener("inputsourceschange",this._myInputSourcesChangeEventListener)}};var Ki=class extends xt{constructor(e=!0,t=m.getMainEngine()){if(super(t),this.myTrackedHandJointIDList=[],e)for(let n in ot)this.myTrackedHandJointIDList.push([ot[n]])}},Hn=class{constructor(e,t=new Ki){this._myHandedness=e,this._myForwardFixed=t.myForwardFixed,this._myForceEmulatedVelocities=t.myForceEmulatedVelocities,this._myReferenceObject=t.myReferenceObject,this._myEngine=t.myEngine,this._myTrackedHandJointPoseParams=new xt(this._myEngine),this._myTrackedHandJointPoseParams.myForwardFixed=this._myForwardFixed,this._myTrackedHandJointPoseParams.myForceEmulatedVelocities=this._myForceEmulatedVelocities,this._myTrackedHandJointPoseParams.myReferenceObject=this._myReferenceObject,this._myTrackedHandJointPoses=[];for(let n of t.myTrackedHandJointIDList){let o=new Ln(this._myHandedness,n,this._myTrackedHandJointPoseParams);this._myTrackedHandJointPoses[n]=o}}start(){for(let e in this._myTrackedHandJointPoses)this._myTrackedHandJointPoses[e].start()}update(e){for(let t in this._myTrackedHandJointPoses)this._myTrackedHandJointPoses[t].update(e)}getEngine(){this._myEngine}getHandedness(){return this._myHandedness}getJointPose(e){return this._myTrackedHandJointPoses[e]}getJointPoseByIndex(e){return this._myTrackedHandJointPoses[ie.getJointIDByIndex(e)]}getJointPoses(){return this._myTrackedHandJointPoses}addTrackedHandJointID(e){if(!this._myTrackedHandJointPoses.pp_has(t=>t.getTrackedHandJointID()==e)){let t=new Ln(this._myHandedness,e,this._myTrackedHandJointPoseParams);this._myTrackedHandJointPoses.push(t)}}removeTrackedHandJointID(e){this._myTrackedHandJointPoses.pp_remove(t=>t.getTrackedHandJointID()==e)}setReferenceObject(e){this._myReferenceObject=e,this._myTrackedHandJointPoseParams.myReferenceObject=this._myReferenceObject;for(let t in this._myTrackedHandJointPoses)this._myTrackedHandJointPoses[t].setReferenceObject(e)}getReferenceObject(){return this._myReferenceObject}setForwardFixed(e){this._myForwardFixed=e,this._myTrackedHandJointPoseParams.myForwardFixed=this._myForwardFixed;for(let t in this._myTrackedHandJointPoses)this._myTrackedHandJointPoses[t].setForwardFixed(e)}isForwardFixed(){return this._myForwardFixed}setForceEmulatedVelocities(e){this._myForceEmulatedVelocities=e,this._myTrackedHandJointPoseParams.myForceEmulatedVelocities=this._myForceEmulatedVelocities;for(let t in this._myTrackedHandJointPoses)this._myTrackedHandJointPoses[t].setForceEmulatedVelocities(e)}isForceEmulatedVelocities(){return this._myForceEmulatedVelocities}destroy(){this._myDestroyed=!0;for(let e of this._myTrackedHandJointPoses)e.destroy()}isDestroyed(){return this._myDestroyed}};import{ViewComponent as zP}from"@wonderlandengine/api";var ci={LEFT:0,MIDDLE:1,RIGHT:2},_s=class{constructor(e=m.getMainEngine()){this._myEngine=e,this._myButtonInfos={},this._myButtonInfosIDs=[];for(let t in ci)this._myButtonInfos[ci[t]]=this._createButtonInfo(),this._myButtonInfosIDs.push(ci[t]);this._myPreventContextMenuEventListener=this._preventContextMenu.bind(this),this._myPreventMiddleButtonScrollEventListener=this._preventMiddleButtonScroll.bind(this),this._myInternalMousePosition=Ce(),this._myScreenSize=Ce(),this._updateScreenSize(),this._myResetMovingDelay=.15,this._myResetMovingTimer=new te(this._myResetMovingDelay,!1),this._myMoving=!1,this._myInsideView=!1,this._myValid=!1,this._myPointerUpOnPointerLeave=!0,this._myContextMenuActive=!0,this._myMiddleButtonScrollActive=!0,this._myPointerID=null,this._myLastValidPointerEvent=null,this._myPointerEventValidCallbacks={},this._myPointerEventValidCallbacksIDs=[],this._myPointerMoveEventListener=null,this._myPointerDownEventListener=null,this._myPointerUpEventListener=null,this._myPointerLeaveEventListener=null,this._myPointerEnterEventListener=null,this._myMouseDownEventListener=null,this._myMouseUpEventListener=null,this._myDestroyed=!1,this._myProjectionMatrixInverse=be(),this._myRotationQuat=w(),this._myOriginWorld=p(),this._myDirectionWorld=p()}start(){this._myPointerMoveEventListener=this._onPointerAction.bind(this,this._onPointerMove.bind(this)),m.getBody(this._myEngine).addEventListener("pointermove",this._myPointerMoveEventListener),this._myPointerDownEventListener=this._onPointerAction.bind(this,this._onPointerDown.bind(this)),m.getBody(this._myEngine).addEventListener("pointerdown",this._myPointerDownEventListener),this._myPointerUpEventListener=this._onPointerAction.bind(this,this._onPointerUp.bind(this)),m.getBody(this._myEngine).addEventListener("pointerup",this._myPointerUpEventListener),this._myPointerLeaveEventListener=this._onPointerLeave.bind(this),m.getBody(this._myEngine).addEventListener("pointerleave",this._myPointerLeaveEventListener),this._myPointerEnterEventListener=this._onPointerEnter.bind(this),m.getBody(this._myEngine).addEventListener("pointerenter",this._myPointerEnterEventListener),this._myMouseDownEventListener=this._onMouseAction.bind(this,this._onPointerDown.bind(this)),m.getBody(this._myEngine).addEventListener("mousedown",this._myMouseDownEventListener),this._myMouseUpEventListener=this._onMouseAction.bind(this,this._onPointerUp.bind(this)),m.getBody(this._myEngine).addEventListener("mouseup",this._myMouseUpEventListener)}update(e){this._myResetMovingTimer.isRunning()&&(this._myResetMovingTimer.update(e),this._myResetMovingTimer.isDone()&&(this._myResetMovingTimer.reset(),this._myMoving=!1));for(let t=0;t<this._myButtonInfosIDs.length;t++){let n=this._myButtonInfosIDs[t],o=this._myButtonInfos[n];o.myPressStart=o.myPressStartToProcess,o.myPressEnd=o.myPressEndToProcess,o.myPressStartToProcess=!1,o.myPressEndToProcess=!1}this._updateScreenSize(),!this.isAnyButtonPressed()&&!this._myMoving&&(this._myPointerID=null),this._myLastValidPointerEvent!=null&&(this._isPointerEventValid(this._myLastValidPointerEvent)||(this._myInsideView&&this._onPointerLeave(this._myLastValidPointerEvent),this._myLastValidPointerEvent=null))}isValid(){return this._myValid}isButtonPressed(e){let t=!1;return this._myButtonInfosIDs[e]!=null&&(t=this._myButtonInfos[e].myPressed),t}isAnyButtonPressed(){let e=!1;for(let t=0;t<this._myButtonInfosIDs.length;t++){let n=this._myButtonInfosIDs[t];if(this._myButtonInfos[n].myPressed){e=!0;break}}return e}isButtonPressStart(e){let t=!1;return this._myButtonInfosIDs[e]!=null&&(t=this._myButtonInfos[e].myPressStart),t}isButtonPressEnd(e=null){let t=!1;return this._myButtonInfosIDs[e]!=null&&(t=this._myButtonInfos[e].myPressEnd),t}isMoving(){return this._myMoving}isInsideView(){return this._myInsideView}isTargetingRenderCanvas(){return this.isInsideView()&&this._myLastValidPointerEvent!=null&&this._myLastValidPointerEvent.target==m.getCanvas(this._myEngine)}raycastWorld(e,t=new ke){return this.getOriginWorld(e.myOrigin),this.getDirectionWorld(e.myDirection),t=De.raycast(e,t,m.getPhysics(this._myEngine)),t}getPositionScreen(e=Ce()){let t=e;return t[0]=this._myInternalMousePosition[0],t[1]=this._myScreenSize[1]-1-this._myInternalMousePosition[1],t}getPositionScreenNormalized(e=Ce()){let t=e;return t[0]=this._myScreenSize[0]==0?0:this._myInternalMousePosition[0]/this._myScreenSize[0]*2-1,t[1]=this._myScreenSize[1]==0?0:(this._myScreenSize[1]-1-this._myInternalMousePosition[1])/this._myScreenSize[1]*2-1,t}getScreenSize(){return this._myScreenSize}getPositionWorld(e,t=p()){let n=this.getOriginWorld(this._myOriginWorld),o=this.getDirectionWorld(this._myDirectionWorld);return t=n.vec3_add(o.vec3_scale(e,t),t),t}getOriginWorld(e=p()){return O.isSessionActive(this._myEngine)?m.getPlayerObjects(this._myEngine).myEyeLeft.pp_getPosition(e):m.getPlayerObjects(this._myEngine).myCameraNonXR.pp_getPosition(e),e}getDirectionWorld(e=p()){let t=this._myInternalMousePosition[0]/this._myScreenSize[0],n=this._myInternalMousePosition[1]/this._myScreenSize[1],o=e;o.vec3_set(t*2-1,-n*2+1,-1);let s=this._myProjectionMatrixInverse;O.isSessionActive(this._myEngine)?s=m.getPlayerObjects(this._myEngine).myEyeLeft.pp_getComponent(zP).projectionMatrix.mat4_invert(s):s=m.getPlayerObjects(this._myEngine).myCameraNonXR.pp_getComponent(zP).projectionMatrix.mat4_invert(s),o.vec3_transformMat4(s,o),o.vec3_normalize(o);let a=o;return O.isSessionActive(this._myEngine)?a=o.vec3_transformQuat(m.getPlayerObjects(this._myEngine).myEyeLeft.pp_getRotationQuat(this._myRotationQuat),o):a=o.vec3_transformQuat(m.getPlayerObjects(this._myEngine).myCameraNonXR.pp_getRotationQuat(this._myRotationQuat),o),a.vec3_normalize(a),e}setTouchValid(e){let t="pp_internal_touch_valid_callback";e?this.removePointerEventValidCallback(t):this.addPointerEventValidCallback(t,function(n){return n.pointerType=="mouse"})}setTargetOnlyRenderCanvas(e){let t="pp_internal_target_only_render_canvas_callback";e?this.addPointerEventValidCallback(t,function(n){return n.target==m.getCanvas(this._myEngine)}):this.removePointerEventValidCallback(t)}getLastValidPointerEvent(){return this._myLastValidPointerEvent}addPointerEventValidCallback(e,t){this._myPointerEventValidCallbacks[e]=t,this._myPointerEventValidCallbacksIDs.push(e)}removePointerEventValidCallback(e){delete this._myPointerEventValidCallbacks[e],this._myPointerEventValidCallbacksIDs.pp_removeEqual(e)}isPointerUpOnPointerLeave(){return this._myPointerUpOnPointerLeave}setPointerUpOnPointerLeave(e){this._myPointerUpOnPointerLeave=e}isContextMenuActive(){return this._myContextMenuActive}setContextMenuActive(e){this._myContextMenuActive!=e&&(e?m.getBody(this._myEngine).removeEventListener("contextmenu",this._myPreventContextMenuEventListener):m.getBody(this._myEngine).addEventListener("contextmenu",this._myPreventContextMenuEventListener,!1),this._myContextMenuActive=e)}isMiddleButtonScrollActive(){return this._myMiddleButtonScrollActive}setMiddleButtonScrollActive(e){this._myMiddleButtonScrollActive!=e&&(e?m.getBody(this._myEngine).removeEventListener("mousedown",this._myPreventMiddleButtonScrollEventListener):m.getBody(this._myEngine).addEventListener("mousedown",this._myPreventMiddleButtonScrollEventListener,!1),this._myMiddleButtonScrollActive=e)}setResetMovingDelay(e){this._myResetMovingDelay=e}getResetMovingDelay(){return this._myResetMovingDelay}_onPointerAction(e,t){if(this._isPointerEventIDValid(t)){if(!this._isPointerEventValid(t)){this._myInsideView&&this._onPointerLeave(t);return}this._myInsideView||this._onPointerEnter(t),e(t),this._updatePositionAndScreen(t),this._updatePointerData(t)}}_onMouseAction(e,t){this._myInsideView&&this._isMouseAllowed()&&this._isPointerEventIDValid(this._myLastValidPointerEvent)&&this._isPointerEventValid(this._myLastValidPointerEvent)&&e(t)}_onPointerMove(e){this._myResetMovingTimer.start(this._myResetMovingDelay),this._myMoving=!0}_onPointerDown(e){let t=this._myButtonInfos[e.button];t.myPressed||(t.myPressed=!0,t.myPressStartToProcess=!0)}_onPointerUp(e){let t=this._myButtonInfos[e.button];t.myPressed&&(t.myPressed=!1,t.myPressEndToProcess=!0)}_onPointerLeave(e){if(!(!this._myInsideView||this._myLastValidPointerEvent==null||e.pointerId!=this._myLastValidPointerEvent.pointerId)){if(this._myInsideView=!1,this._myMoving=!1,this._myPointerUpOnPointerLeave)for(let t=0;t<this._myButtonInfosIDs.length;t++){let n=this._myButtonInfosIDs[t],o=this._myButtonInfos[n];o.myPressed&&(o.myPressed=!1,o.myPressEndToProcess=!0)}this._myPointerID=null}}_onPointerEnter(e){this._myInsideView&&this._myPointerID!=null||!this._isPointerEventIDValid(e)||!this._isPointerEventValid(e)||(this._myInsideView=!0,this._updatePositionAndScreen(e),this._updatePointerData(e))}_preventContextMenu(e){!this._isPointerEventIDValid(e)||!this._isPointerEventValid(e)||e.preventDefault()}_preventMiddleButtonScroll(e){if(!(!this._isPointerEventIDValid(e)||!this._isPointerEventValid(e))&&e.button==1)return e.preventDefault(),!1}_updatePositionAndScreen(e){this._updateScreenSize(),this._myInternalMousePosition[0]=e.clientX,this._myInternalMousePosition[1]=e.clientY,this._myValid=!0}_updateScreenSize(){let e=m.getBody(this._myEngine).getBoundingClientRect();this._myScreenSize[0]=e.width,this._myScreenSize[1]=e.height}_updatePointerData(e){this._myPointerID=e.pointerId,this._myLastValidPointerEvent=e}_isPointerEventIDValid(e){return e==null?!1:this._myPointerID==null||this._myPointerID==e.pointerId}_isPointerEventValid(e){if(e==null)return!1;let t=!0;for(let n=0;n<this._myPointerEventValidCallbacksIDs.length;n++){let o=this._myPointerEventValidCallbacksIDs[n],s=this._myPointerEventValidCallbacks[o];if(!s(e)){t=!1;break}}return t}_isMouseAllowed(){return this._myLastValidPointerEvent!=null&&this._myLastValidPointerEvent.pointerId==1}_createButtonInfo(){return{myPressed:!1,myPressStart:!1,myPressStartToProcess:!1,myPressEnd:!1,myPressEndToProcess:!1}}destroy(){this._myDestroyed=!0,m.getBody(this._myEngine).removeEventListener("pointermove",this._myPointerMoveEventListener),m.getBody(this._myEngine).removeEventListener("pointerdown",this._myPointerDownEventListener),m.getBody(this._myEngine).removeEventListener("pointerup",this._myPointerUpEventListener),m.getBody(this._myEngine).removeEventListener("pointerleave",this._myPointerLeaveEventListener),m.getBody(this._myEngine).removeEventListener("pointerenter",this._myPointerEnterEventListener),m.getBody(this._myEngine).removeEventListener("mousedown",this._myMouseDownEventListener),m.getBody(this._myEngine).removeEventListener("mouseup",this._myMouseUpEventListener),m.getBody(this._myEngine).removeEventListener("contextmenu",this._myPreventContextMenuEventListener),m.getBody(this._myEngine).removeEventListener("mousedown",this._myPreventMiddleButtonScrollEventListener)}isDestroyed(){return this._myDestroyed}};var gs=class{constructor(e=m.getMainEngine()){this._myEngine=e,this._myMouse=new _s(this._myEngine),this._myKeyboard=new hs(this._myEngine),this._myHeadPose=new ds(new xt(this._myEngine)),this._myHeadPose.setReferenceObject(m.getPlayerObjects(this._myEngine).myReferenceSpace),this._myHeadPose.setForwardFixed(m.isPoseForwardFixed(this._myEngine)),this._myHandPoses=[],this._myHandPoses[A.LEFT]=new Xi(A.LEFT,new qi(this._myEngine)),this._myHandPoses[A.RIGHT]=new Xi(A.RIGHT,new qi(this._myEngine)),this._myHandPoses[A.LEFT].setReferenceObject(m.getPlayerObjects(this._myEngine).myReferenceSpace),this._myHandPoses[A.RIGHT].setReferenceObject(m.getPlayerObjects(this._myEngine).myReferenceSpace),this._myHandPoses[A.LEFT].setForwardFixed(m.isPoseForwardFixed(this._myEngine)),this._myHandPoses[A.RIGHT].setForwardFixed(m.isPoseForwardFixed(this._myEngine)),this._myTrackedHandPoses=[],this._myTrackedHandPoses[A.LEFT]=new Hn(A.LEFT,new Ki(!0,this._myEngine)),this._myTrackedHandPoses[A.RIGHT]=new Hn(A.RIGHT,new Ki(!0,this._myEngine)),this._myTrackedHandPoses[A.LEFT].setReferenceObject(m.getPlayerObjects(this._myEngine).myReferenceSpace),this._myTrackedHandPoses[A.RIGHT].setReferenceObject(m.getPlayerObjects(this._myEngine).myReferenceSpace),this._myTrackedHandPoses[A.LEFT].setForwardFixed(m.isPoseForwardFixed(this._myEngine)),this._myTrackedHandPoses[A.RIGHT].setForwardFixed(m.isPoseForwardFixed(this._myEngine)),this._myGamepadsManager=new ps(this._myEngine),this._myStarted=!1,this._myTrackedHandPosesEnabled=!0,this._myTrackedHandPosesStarted=!1,this._myDestroyed=!1}start(){this._myMouse.start(),this._myKeyboard.start(),this._myHeadPose.setReferenceObject(m.getPlayerObjects(this._myEngine).myReferenceSpace),this._myHeadPose.setForwardFixed(m.isPoseForwardFixed(this._myEngine)),this._myHeadPose.start();for(let e in this._myHandPoses)this._myHandPoses[e].setReferenceObject(m.getPlayerObjects(this._myEngine).myReferenceSpace),this._myHandPoses[e].setForwardFixed(m.isPoseForwardFixed(this._myEngine)),this._myHandPoses[e].start();this._myTrackedHandPosesEnabled&&this._startTrackedHandPoses(),this._myGamepadsManager.start(),this._myStarted=!0}update(e){this._myMouse.update(e),this._myKeyboard.update(e),this._myHeadPose.setReferenceObject(m.getPlayerObjects(this._myEngine).myReferenceSpace),this._myHeadPose.setForwardFixed(m.isPoseForwardFixed(this._myEngine)),this._myHeadPose.update(e);for(let t in this._myHandPoses)this._myHandPoses[t].setReferenceObject(m.getPlayerObjects(this._myEngine).myReferenceSpace),this._myHandPoses[t].setForwardFixed(m.isPoseForwardFixed(this._myEngine)),this._myHandPoses[t].update(e);this._updateTrackedHandPoses(),this._myGamepadsManager.update(e)}getMouse(){return this._myMouse}getKeyboard(){return this._myKeyboard}getGamepadsManager(){return this._myGamepadsManager}getHeadPose(){return this._myHeadPose}getLeftHandPose(){return this._myHandPoses[A.LEFT]}getRightHandPose(){return this._myHandPoses[A.RIGHT]}getHandPose(e){return this._myHandPoses[e]}getHandPoses(){return this._myHandPoses}getLeftTrackedHandPose(){return this._myTrackedHandPoses[A.LEFT]}getRightTrackedHandPose(){return this._myTrackedHandPoses[A.RIGHT]}getTrackedHandPose(e){return this._myTrackedHandPoses[e]}getTrackedHandPoses(){return this._myTrackedHandPoses}areTrackedHandPosesEnabled(){return this._myTrackedHandPosesEnabled}setTrackedHandPosesEnabled(e){this._myTrackedHandPosesEnabled=e,this._myStarted&&this._myTrackedHandPosesEnabled&&this._startTrackedHandPoses()}_startTrackedHandPoses(){if(!this._myTrackedHandPosesStarted){for(let e in this._myTrackedHandPoses)this._myTrackedHandPoses[e].setReferenceObject(m.getPlayerObjects(this._myEngine).myReferenceSpace),this._myTrackedHandPoses[e].setForwardFixed(m.isPoseForwardFixed(this._myEngine)),this._myTrackedHandPoses[e].start();this._myTrackedHandPosesStarted=!0}}_updateTrackedHandPoses(e){if(this._myTrackedHandPosesEnabled&&this._myTrackedHandPosesStarted)for(let t in this._myTrackedHandPoses)this._myTrackedHandPoses[t].setReferenceObject(m.getPlayerObjects(this._myEngine).myReferenceSpace),this._myTrackedHandPoses[t].setForwardFixed(m.isPoseForwardFixed(this._myEngine)),this._myTrackedHandPoses[t].update(e)}destroy(){this._myDestroyed=!0,this._myMouse.destroy(),this._myKeyboard.destroy(),this._myHeadPose.destroy();for(let e in this._myHandPoses)this._myHandPoses[e].destroy();for(let e in this._myTrackedHandPoses)this._myTrackedHandPoses[e].destroy();this._myGamepadsManager.destroy()}isDestroyed(){return this._myDestroyed}};var ai=class extends bA{static TypeName="pp-input-manager";static Properties={_myPoseForwardFixed:Rr.bool(!0),_myPreventMouseContextMenu:Rr.bool(!0),_myPreventMouseMiddleButtonScroll:Rr.bool(!0),_myEnableTrackedHandPoses:Rr.bool(!0)};init(){this._myInputManager=null,this._myPoseForwardFixedGlobal=null,m.hasInputManager(this.engine)||(this._myInputManager=new gs(this.engine),this._myInputManager.setTrackedHandPosesEnabled(this._myEnableTrackedHandPoses),m.setInputManager(this._myInputManager,this.engine)),m.hasPoseForwardFixed(this.engine)||(this._myPoseForwardFixedGlobal=this._myPoseForwardFixed,m.setPoseForwardFixed(this._myPoseForwardFixedGlobal,this.engine))}start(){this._myInputManager!=null&&(this._myInputManager.start(),this._setupMousePrevent(),this._addGamepadCores())}update(e){this._myInputManager!=null&&this._myInputManager.update(e)}_setupMousePrevent(){this._myPreventMouseContextMenu&&this._myInputManager.getMouse().setContextMenuActive(!1),this._myPreventMouseMiddleButtonScroll&&this._myInputManager.getMouse().setMiddleButtonScrollActive(!1)}_addGamepadCores(){let e=this._myInputManager.getLeftHandPose(),t=this._myInputManager.getRightHandPose(),n=new In(e),o=new In(t);this._myInputManager.getGamepadsManager().getLeftGamepad().addGamepadCore("pp_left_xr_gamepad",n),this._myInputManager.getGamepadsManager().getRightGamepad().addGamepadCore("pp_right_xr_gamepad",o);let s=new On(e),a=new On(t);this._myInputManager.getGamepadsManager().getLeftGamepad().addGamepadCore("pp_left_keyboard_gamepad",s),this._myInputManager.getGamepadsManager().getRightGamepad().addGamepadCore("pp_right_keyboard_gamepad",a);let l=new Vn(null,e),h=new Vn(null,t);this._myInputManager.getGamepadsManager().getLeftGamepad().addGamepadCore("pp_left_classic_gamepad",l),this._myInputManager.getGamepadsManager().getRightGamepad().addGamepadCore("pp_right_classic_gamepad",h)}onDestroy(){this._myInputManager!=null&&m.getInputManager(this.engine)==this._myInputManager&&(m.removeInputManager(this.engine),this._myInputManager.destroy()),this._myPoseForwardFixedGlobal!=null&&m.isPoseForwardFixed(this.engine)==this._myPoseForwardFixedGlobal&&m.removePoseForwardFixed(this.engine)}};import{Component as SA,Property as vA}from"@wonderlandengine/api";var Hi=class extends SA{static TypeName="pp-enable-tools";static Properties={_myEnable:vA.bool(!0)};init(){this._myToolEnabled=null,m.hasToolEnabled(this.engine)||(this._myToolEnabled=this._myEnable,m.setToolEnabled(this._myToolEnabled,this.engine))}onDestroy(){this._myToolEnabled!=null&&m.isToolEnabled(this.engine)==this._myToolEnabled&&m.removeToolEnabled(this.engine)}};import{Component as HA,Property as kA}from"@wonderlandengine/api";var xA=console.log,MA=console.error,DA=console.warn,EA=console.info,AA=console.debug,RA=console.assert,VA=console.clear;function OA(i=m.getMainEngine(),...e){return Ee.getLog(i).apply(console,e)}function IA(i=m.getMainEngine(),...e){return Ee.getError(i).apply(console,e)}function BA(i=m.getMainEngine(),...e){return Ee.getWarn(i).apply(console,e)}function GP(i=m.getMainEngine(),...e){return Ee.getInfo(i).apply(console,e)}function NP(i=m.getMainEngine(),...e){return Ee.getDebug(i).apply(console,e)}function UP(i=m.getMainEngine(),...e){return Ee.getAssert(i).apply(console,e)}function LA(i=m.getMainEngine(),...e){return Ee.getClear(i).apply(console,e)}function WP(i=m.getMainEngine()){return xA}function QP(i=m.getMainEngine()){return MA}function qP(i=m.getMainEngine()){return DA}function XP(i=m.getMainEngine()){return EA}function KP(i=m.getMainEngine()){return AA}function JP(i=m.getMainEngine()){return RA}function ZP(i=m.getMainEngine()){return VA}var Ee={log:OA,error:IA,warn:BA,info:GP,debug:NP,assert:UP,clear:LA,getLog:WP,getError:QP,getWarn:qP,getInfo:XP,getDebug:KP,getAssert:JP,getClear:ZP};var fs=class{constructor(e=m.getMainEngine()){this._myEngine=e,this._myForwardToBrowserConsole=!0}log(...e){this._myForwardToBrowserConsole&&Ee.log(this._myEngine,...e)}error(...e){this._myForwardToBrowserConsole&&Ee.error(this._myEngine,...e)}warn(...e){this._myForwardToBrowserConsole&&Ee.warn(this._myEngine,...e)}info(...e){this._myForwardToBrowserConsole&&Ee.info(this._myEngine,...e)}debug(...e){this._myForwardToBrowserConsole&&Ee.debug(this._myEngine,...e)}assert(...e){this._myForwardToBrowserConsole&&Ee.assert(this._myEngine,...e)}clear(...e){this._myForwardToBrowserConsole&&Ee.clear(this._myEngine,...e)}setForwardToBrowserConsole(e){this._myForwardToBrowserConsole=e}isForwardToBrowserConsole(){return this._myForwardToBrowserConsole}};var ri=class extends HA{static TypeName="pp-init-console-vr";static Properties={_myInit:kA.bool(!0)};init(){this._myConsoleVR=null,this._myInit&&(m.hasConsoleVR(this.engine)||(this._myConsoleVR=new fs(this.engine),m.setConsoleVR(this._myConsoleVR,this.engine)))}onDestroy(){this._myConsoleVR!=null&&m.getConsoleVR(this.engine)==this._myConsoleVR&&m.removeConsoleVR(this.engine)}};import{Component as FA,Property as wA}from"@wonderlandengine/api";var Ts=class{constructor(){this._myVariables=new Map}add(e,t=!1){(t||!this._myVariables.has(e.getName()))&&this._myVariables.set(e.getName(),e)}remove(e){this._myVariables.delete(e)}get(e){let t=this._myVariables.get(e);return t?t.getValue():null}set(e,t,n=!1){let o=this._myVariables.get(e);o&&o.setValue(t,n)}has(e){return this._myVariables.has(e)}length(){return this._myVariables.size}isWidgetCurrentVariable(e){let t=this._myVariables.get(e);return t?t.isWidgetCurrentVariable():!1}getEasyTuneVariable(e){return this._myVariables.get(e)}getEasyTuneVariablesList(){return Array.from(this._myVariables.values())}getEasyTuneVariablesNames(){return Array.from(this._myVariables.keys())}fromJSON(e,t=!1){let n=JSON.parse(e);for(let o of this._myVariables.values()){let s=n[o.getName()];s!==void 0&&o.fromJSON(s,t)}}toJSON(){let e={};for(let t of this._myVariables.values())e[t.getName()]=t.toJSON();return JSON.stringify(e)}registerValueChangedEventListener(e,t,n){this._myVariables.get(e).registerValueChangedEventListener(t,n)}unregisterValueChangedEventListener(e,t,n){this._myVariables.get(e).unregisterValueChangedEventListener(t)}};var li=class extends FA{static TypeName="pp-init-easy-tune-variables";static Properties={_myInit:wA.bool(!0)};init(){this._myEasyTuneVariables=null,this._myInit&&(m.hasEasyTuneVariables(this.engine)||(this._myEasyTuneVariables=new Ts,m.setEasyTuneVariables(this._myEasyTuneVariables,this.engine)))}onDestroy(){this._myEasyTuneVariables!=null&&m.getEasyTuneVariables(this.engine)==this._myEasyTuneVariables&&m.removeEasyTuneVariables(this.engine)}};import{Component as jA,Property as zA}from"@wonderlandengine/api";var ki=class extends jA{static TypeName="pp-add-pp-to-window";static Properties={_myAdd:zA.bool(!0)};init(){this._myAdd&&(m.getWindow(this.engine).PP={},this._addProperties(ql))}_addProperties(e){let t=Object.getOwnPropertyNames(e);for(let n of t)e[n]!=null&&(m.getWindow(this.engine).PP[n]=e[n])}onDestroy(){m.getWindow(this.engine).PP=void 0}};import{Component as GA,Property as qt}from"@wonderlandengine/api";var mi=class extends GA{static TypeName="pp-get-default-resources";static Properties={_myPlane:qt.mesh(),_myCube:qt.mesh(),_mySphere:qt.mesh(),_myCone:qt.mesh(),_myCylinder:qt.mesh(),_myCircle:qt.mesh(),_myFlatOpaque:qt.material(),_myFlatTransparentNoDepth:qt.material(),_myPhongOpaque:qt.material(),_myText:qt.material()};init(){this._myDefaultResources=null,m.hasDefaultResources(this.engine)||(this._myDefaultResources=new is,this._myDefaultResources.myMeshes.myPlane=Re.clone(this._myPlane),this._myDefaultResources.myMeshes.myCube=Re.clone(this._myCube),this._myDefaultResources.myMeshes.mySphere=Re.clone(this._mySphere),this._myDefaultResources.myMeshes.myCone=Re.clone(this._myCone),this._myDefaultResources.myMeshes.myCylinder=Re.clone(this._myCylinder),this._myDefaultResources.myMeshes.myCircle=Re.clone(this._myCircle),this._myDefaultResources.myMeshes.myInvertedCube=Re.invert(this._myCube),this._myDefaultResources.myMeshes.myInvertedSphere=Re.invert(this._mySphere),this._myDefaultResources.myMeshes.myInvertedCone=Re.invert(this._myCone),this._myDefaultResources.myMeshes.myInvertedCylinder=Re.invert(this._myCylinder),this._myDefaultResources.myMeshes.myDoubleSidedPlane=Re.makeDoubleSided(this._myPlane),this._myDefaultResources.myMeshes.myDoubleSidedCube=Re.makeDoubleSided(this._myCube),this._myDefaultResources.myMeshes.myDoubleSidedSphere=Re.makeDoubleSided(this._mySphere),this._myDefaultResources.myMeshes.myDoubleSidedCone=Re.makeDoubleSided(this._myCone),this._myDefaultResources.myMeshes.myDoubleSidedCylinder=Re.makeDoubleSided(this._myCylinder),this._myDefaultResources.myMeshes.myDoubleSidedCircle=Re.makeDoubleSided(this._myCircle),this._myFlatOpaque!=null&&(this._myDefaultResources.myMaterials.myFlatOpaque=this._myFlatOpaque.clone()),this._myFlatTransparentNoDepth!=null&&(this._myDefaultResources.myMaterials.myFlatTransparentNoDepth=this._myFlatTransparentNoDepth.clone()),this._myPhongOpaque!=null&&(this._myDefaultResources.myMaterials.myPhongOpaque=this._myPhongOpaque.clone()),this._myText!=null&&(this._myDefaultResources.myMaterials.myText=this._myText.clone()),m.setDefaultResources(this._myDefaultResources,this.engine))}onDestroy(){this._myDefaultResources!=null&&m.getDefaultResources(this.engine)==this._myDefaultResources&&m.removeDefaultResources(this.engine)}};import{Component as NA,Property as pi}from"@wonderlandengine/api";var yi=class extends NA{static TypeName="pp-get-scene-objects";static Properties={_myScene:pi.object(),_myPlayer:pi.object(),_myReferenceSpace:pi.object(),_myCameraNonXR:pi.object(),_myEyeLeft:pi.object(),_myEyeRight:pi.object(),_myHandLeft:pi.object(),_myHandRight:pi.object(),_myHead:pi.object()};init(){this._mySceneObjects=null,m.hasSceneObjects(this.engine)||(this._mySceneObjects=new ts,this._mySceneObjects.myScene=this._myScene,this._mySceneObjects.myPlayerObjects.myPlayer=this._myPlayer,this._mySceneObjects.myPlayerObjects.myReferenceSpace=this._myReferenceSpace,this._mySceneObjects.myPlayerObjects.myCameraNonXR=this._myCameraNonXR,this._mySceneObjects.myPlayerObjects.myEyeLeft=this._myEyeLeft,this._mySceneObjects.myPlayerObjects.myEyeRight=this._myEyeRight,this._mySceneObjects.myPlayerObjects.myHandLeft=this._myHandLeft,this._mySceneObjects.myPlayerObjects.myHandRight=this._myHandRight,this._mySceneObjects.myPlayerObjects.myEyes=[],this._mySceneObjects.myPlayerObjects.myEyes[A.LEFT]=this._myEyeLeft,this._mySceneObjects.myPlayerObjects.myEyes[A.RIGHT]=this._myEyeRight,this._mySceneObjects.myPlayerObjects.myHands=[],this._mySceneObjects.myPlayerObjects.myHands[A.LEFT]=this._myHandLeft,this._mySceneObjects.myPlayerObjects.myHands[A.RIGHT]=this._myHandRight,this._mySceneObjects.myPlayerObjects.myHead=this._myHead,this._mySceneObjects.myPlayerObjects.myReferenceSpace==null&&(this._mySceneObjects.myPlayerObjects.myReferenceSpace=this._mySceneObjects.myPlayerObjects.myPlayer),this._mySceneObjects.myCauldron=this._mySceneObjects.myScene.pp_addObject(),this._mySceneObjects.myCauldron.pp_setName("Cauldron"),this._mySceneObjects.myDynamics=this._mySceneObjects.myScene.pp_addObject(),this._mySceneObjects.myDynamics.pp_setName("Dynamics"),this._mySceneObjects.myParticles=this._mySceneObjects.myScene.pp_addObject(),this._mySceneObjects.myParticles.pp_setName("Particles"),this._mySceneObjects.myVisualElements=this._mySceneObjects.myScene.pp_addObject(),this._mySceneObjects.myVisualElements.pp_setName("Visual Elements"),this._mySceneObjects.myTools=this._mySceneObjects.myScene.pp_addObject(),this._mySceneObjects.myTools.pp_setName("Tools"),this._mySceneObjects.myPlayerObjects.myCauldron=this._mySceneObjects.myPlayerObjects.myPlayer.pp_addObject(),this._mySceneObjects.myPlayerObjects.myCauldron.pp_setName("Cauldron"),this._mySceneObjects.myPlayerObjects.myHeadDebugs=this._mySceneObjects.myPlayerObjects.myHead.pp_addObject(),this._mySceneObjects.myPlayerObjects.myHeadDebugs.pp_setName("Head Debugs"),m.setSceneObjects(this._mySceneObjects,this.engine))}onDestroy(){this._mySceneObjects!=null&&m.getSceneObjects(this.engine)==this._mySceneObjects&&m.removeSceneObjects(this.engine)}};var YP=new WeakMap,_o=class extends UA{static TypeName="pp-gateway";static Properties={_myEnableDebug:Vr.bool(!0),_myEnableTool:Vr.bool(!0),_myAddPPToWindow:Vr.bool(!0),_myAddWLToWindow:Vr.bool(!0),...ai.Properties,...ii.Properties,...oi.Properties,...ni.Properties,...si.Properties,...yi.Properties,...mi.Properties};static onRegister(e){YP.has(e)||(YP.set(e,null),Ql(e))}init(){this._myGetDefaultResourcesComponent=this.object.pp_addComponent(mi,this._getProperties(mi.Properties),!1),this._myGetSceneObjectsComponent=this.object.pp_addComponent(yi,this._getProperties(yi.Properties),!1),this._myEnableDebugComponent=null,this._myEnableDebug&&(this._myEnableDebugComponent=this.object.pp_addComponent(Li,!1)),this._myEnableToolComponent=null,this._myEnableTool&&(this._myEnableToolComponent=this.object.pp_addComponent(Hi,!1)),this._myAddPPToWindowComponent=null,this._myAddPPToWindow&&(this._myAddPPToWindowComponent=this.object.pp_addComponent(ki,!1)),this._myAddWLToWindowComponent=null,this._myAddWLToWindow&&(this._myAddWLToWindowComponent=this.object.pp_addComponent(Bi,!1)),this._myInitConsoleVRComponent=this.object.pp_addComponent(ri,!1),this._myInitEasyTuneVariablesComponent=this.object.pp_addComponent(li,!1),this._myObjectPoolManagerComponent=this.object.pp_addComponent(ni,this._getProperties(ni.Properties),!1),this._myInputManagerComponent=this.object.pp_addComponent(ai,this._getProperties(ai.Properties),!1),this._myAudioManagerComponent=this.object.pp_addComponent(ii,this._getProperties(ii.Properties),!1),this._myVisualManagerComponent=this.object.pp_addComponent(oi,this._getProperties(oi.Properties),!1),this._myDebugManagerComponent=this.object.pp_addComponent(si,this._getProperties(si.Properties),!1)}start(){this._myGetDefaultResourcesComponent.active=!0,this._myGetSceneObjectsComponent.active=!0,this._myEnableDebugComponent!=null&&(this._myEnableDebugComponent.active=!0),this._myEnableToolComponent!=null&&(this._myEnableToolComponent.active=!0),this._myAddPPToWindowComponent!=null&&(this._myAddPPToWindowComponent.active=!0),this._myAddWLToWindowComponent!=null&&(this._myAddWLToWindowComponent.active=!0),this._myInitConsoleVRComponent.active=!0,this._myInitEasyTuneVariablesComponent.active=!0,this._myObjectPoolManagerComponent.active=!0,this._myInputManagerComponent.active=!0,this._myAudioManagerComponent.active=!0,this._myVisualManagerComponent.active=!0,this._myDebugManagerComponent.active=!0}_getProperties(e){let t={},n=Object.getOwnPropertyNames(e);for(let o of n)this[o]!=null&&(t[o]=this[o]);return t}};import{Howler as $P}from"howler";function eC(){let i=!1;return $P!=null&&$P.state!="running"&&(i=!0),i}var WA={isPlaybackBlocked:eC};var Xl=class extends Gi{constructor(e,t=null){super(t,e),t==null?(this._myAudioSetup.myAudioFilePath=this._myAudio._src,this._myAudioSetup.myLoop=this._myAudio._loop,this._myAudioSetup.myAutoPlay=this._myAudio._autoplay,this._myAudioSetup.myVolume=this._myAudio._volume,this._myAudioSetup.myRate=this._myAudio._rate,this._myAudioSetup.myPool=this._myAudio._pool,this._myAudioSetup.myPreload=this._myAudio._preload,this._myAudioSetup.myPosition=this._myAudio._pos!=null?this._myAudio._pos.vec3_clone():null,this._myAudioSetup.mySpatial=this._myAudio._pos!=null,this._myAudioSetup.myReferenceDistance=this._myAudio._pannerAttr.refDistance):(this._myAudioSetup.myAudioFilePath=this._myAudio._src,this._myAudio.loop(this._myAudioSetup.myLoop),this._myAudio._autoplay=this._myAudioSetup.myAutoPlay,this._myAudio.volume(this._myAudioSetup.myVolume),this._myAudio.rate(this._myAudioSetup.myRate),this._myAudio._pool=this._myAudioSetup.myPool,this._myAudio._preload=this._myAudioSetup.myPreload,this.updatePosition(this._myAudioSetup.myPosition),this._myAudio._pannerAttr.refDistance=this._myAudioSetup.myReferenceDistance,this._myAudioSetup.myAutoPlay&&this._myAudio.play()),this._addListeners()}};import{Component as QA}from"@wonderlandengine/api";import{Howler as qA}from"howler";var go=class extends QA{static TypeName="pp-mute-everything";static Properties={};start(){qA.mute(!0)}};import{Component as XA}from"@wonderlandengine/api";import{Howler as tC}from"howler";var fo=class extends XA{static TypeName="pp-spatial-audio-listener";static Properties={};init(){this._myOrigin=p(),this._myForward=p(),this._myUp=p()}start(){this._updateAudioListener()}update(e){this._updateAudioListener()}_updateAudioListener(){this.object.pp_getPosition(this._myOrigin),this.object.pp_getForward(this._myForward),this.object.pp_getUp(this._myUp),tC.pos(this._myOrigin[0],this._myOrigin[1],this._myOrigin[2]),tC.orientation(this._myForward[0],this._myForward[1],this._myForward[2],this._myUp[0],this._myUp[1],this._myUp[2])}};import{Component as KA,PhysXComponent as JA,Property as ft,Shape as Jl}from"@wonderlandengine/api";import{CollisionEventType as Ps,Emitter as Kl,PhysXComponent as iC}from"@wonderlandengine/api";var Xt=class{constructor(e,t=!1){this._myPhysX=e,this._myTrigger=t,this._myCollisions=[],this._myCollisionsStart=[],this._myCollisionsEnd=[],this._myUpdateActive=!1,this._myCollisionsStartToProcess=[],this._myCollisionsEndToProcess=[],this._myCollisionCallbackID=null,this._myActive=!1,this.setActive(!0),this._myLogEnabled=!1,this._myTriggerDesyncFixDelay=new te(.1),this._myCollisionEmitter=new Kl,this._myCollisionStartEmitter=new Kl,this._myCollisionEndEmitter=new Kl,this._myDestroyed=!1}getPhysX(){return this._myPhysX}getCollisions(){return this._myCollisions}getCollisionsStart(){return this._myCollisionsStart}getCollisionsEnd(){return this._myCollisionsEnd}isActive(){return this._myActive}setActive(e){this._myActive!=e&&(this._myActive=e,this._myCollisions.pp_clear(),this._myCollisionsStart.pp_clear(),this._myCollisionsEnd.pp_clear(),this._myUpdateActive=!1,this._myCollisionsStartToProcess.pp_clear(),this._myCollisionsEndToProcess.pp_clear(),this._myActive?this._myCollisionCallbackID=this._myPhysX.onCollision(this._onCollision.bind(this)):this._myCollisionCallbackID!=null&&(this._myPhysX.removeCollisionCallback(this._myCollisionCallbackID),this._myCollisionCallbackID=null))}setUpdateActive(e){this._myUpdateActive=e}update(e){if(!this._myActive)return;this._myUpdateActive=!0;let t=this._myCollisionsStartToProcess;this._myCollisionsStartToProcess=this._myCollisionsStart,this._myCollisionsStartToProcess.pp_clear(),this._myCollisionsStart=t;let n=this._myCollisionsEndToProcess;this._myCollisionsEndToProcess=this._myCollisionsEnd,this._myCollisionsEndToProcess.pp_clear(),this._myCollisionsEnd=n,this._myTrigger&&this._triggerDesyncFix(e)}isLogEnabled(){return this._myLogEnabled}setLogEnabled(e){this._myLogEnabled=e}registerCollisionEventListener(e,t){this._myCollisionEmitter.add(t,{id:e})}unregisterCollisionEventListener(e){this._myCollisionEmitter.remove(e)}registerCollisionStartEventListener(e,t){this._myCollisionStartEmitter.add(t,{id:e})}unregisterCollisionStartEventListener(e){this._myCollisionStartEmitter.remove(e)}registerCollisionEndEventListener(e,t){this._myCollisionEndEmitter.add(t,{id:e})}unregisterCollisionEndEventListener(e){this._myCollisionEndEmitter.remove(e)}_onCollision(e,t){e==Ps.Touch||e==Ps.TriggerTouch?this._onCollisionStart(e,t):(e==Ps.TouchLost||e==Ps.TriggerTouchLost)&&this._onCollisionEnd(e,t),this._myCollisionEmitter.notify(this._myPhysX,t,e)}_onCollisionStart(e,t){if(this._myLogEnabled){let n=!1;for(let o of this._myCollisions)if(o.pp_equals(t.object)){n=!0;break}n&&console.error("Collision Start on object already collected")}this._myCollisions.push(t.object),this._myUpdateActive&&(this._myCollisionsStartToProcess.push(t.object),this._myCollisionsEndToProcess.pp_removeAll(function(n){return n.pp_equals(t.object)})),this._myLogEnabled&&console.log("Collision Start -",this._myCollisions.length),this._myCollisionStartEmitter.notify(this._myPhysX,t,e)}_onCollisionEnd(e,t){if(this._myLogEnabled){let n=!1;for(let o of this._myCollisions)if(o.pp_equals(t.object)){n=!0;break}n||console.error("Collision End on object not collected")}this._myCollisions.pp_removeAll(function(n){return n.pp_equals(t.object)}),this._myUpdateActive&&(this._myCollisionsEndToProcess.push(t.object),this._myCollisionsStartToProcess.pp_removeAll(function(n){return n.pp_equals(t.object)})),this._myLogEnabled&&console.log("Collision End -",this._myCollisions.length),this._myCollisionEndEmitter.notify(this._myPhysX,t,e)}_triggerDesyncFix(e){}destroy(){this._myDestroyed=!0,this._myCollisionCallbackID!=null&&(this._myPhysX.removeCollisionCallback(this._myCollisionCallbackID),this._myCollisionCallbackID=null)}isDestroyed(){return this._myDestroyed}};Xt.prototype._triggerDesyncFix=function(){let i=function(e){let t=e.pp_getComponentSelf(iC);return t==null||!t.active};return function(t){if(this._myTriggerDesyncFixDelay.update(t),this._myTriggerDesyncFixDelay.isDone()){this._myTriggerDesyncFixDelay.start();let n=this._myCollisions.pp_findAll(i);if(n.length>0)for(let o=0;o<n.length;o++){let a=n[o].pp_getComponentSelf(iC);a?this._onCollisionEnd(Ps.TriggerTouchLost,a):console.error("NO PHYSX, HOW?")}}}}();var To=class extends KA{static TypeName="pp-benchmark-max-physx";static Properties={_myStaticDomeSize:ft.float(40),_myStaticPhysXCount:ft.int(1e3),_myDynamicDomeSize:ft.float(80),_myDynamicPhysXCount:ft.int(250),_myKinematicDomeSize:ft.float(120),_myKinematicPhysXCount:ft.int(250),_myRaycastCount:ft.int(100),_myVisualizeRaycast:ft.bool(!1),_myVisualizeRaycastDelay:ft.float(.5),_myUseConvexMesh:ft.bool(!1),_myShapeIndex:ft.int(0),_myShapeScaleMultiplier:ft.float(1),_myLogEnabled:ft.bool(!0),_myClearConsoleBeforeLog:ft.bool(!0)};start(){this._myValid=!1,m.isDebugEnabled(this.engine)&&(this._myValid=!0,this._myStarted=!1,this._myPreStartTimer=new te(1))}_start(){this._myParentObject=this.object.pp_addObject(),this._myRaycastParams=new ut(m.getPhysics(this.engine)),this._myRaycastResults=new ke,this._myStaticPhysXObjects=[],this._myStaticPhysXComponents=[],this._myStaticPhysXCollectors=[],this._myDynamicPhysXObjects=[],this._myDynamicPhysXComponents=[],this._myDynamicPhysXCollectors=[],this._myKinematicPhysXObjects=[],this._myKinematicPhysXComponents=[],this._myKinematicPhysXCollectors=[],this._spawnDome(!0,!1),this._spawnDome(!1,!1),this._spawnDome(!1,!0),this._myStartTimer=new te(1),this._myTimer=new te(0),this._myDebugTimer=new te(this._myVisualizeRaycastDelay),this._myLogEnabledTimer=new te(1),this._myFPSHistory=[];for(let e=0;e<7;e++)this._myFPSHistory.push(0);this._myAddVelocityDelay=10,this._myTranslateVec3=p(),this._myRotateVec3=p(),this._myStarted=!0}update(e){if(this._myValid)if(!this._myStarted)this._myPreStartTimer.update(e),this._myPreStartTimer.isDone()&&this._start();else{if(this._myStartTimer.update(e),this._myStartTimer.isDone()){if(this._myTimer.update(e),this._myDebugTimer.update(e),this._myLogEnabledTimer.update(e),this._myTimer.isDone()){this._myTimer.start();let t=!1;this._myDebugTimer.isDone()&&(this._myDebugTimer.start(),t=!0),t=t&&this._myVisualizeRaycast,this._raycastTest(t)}if(this._myFPSHistory.pop(),this._myFPSHistory.unshift(Math.round(1/e)),this._myLogEnabled&&this._myLogEnabledTimer.isDone()){this._myLogEnabledTimer.start(),this._myClearConsoleBeforeLog&&console.clear(),console.log("Static PhysX Dome Size:",this._myStaticPhysXObjects.length),console.log("Dynamic PhysX Dome Size:",this._myDynamicPhysXObjects.length),console.log("Kinematic PhysX Dome Size:",this._myKinematicPhysXObjects.length);let t=0;for(let l of this._myStaticPhysXCollectors)t+=l.getCollisions().length;let n=0;for(let l of this._myDynamicPhysXCollectors)n+=l.getCollisions().length;let o=0;for(let l of this._myKinematicPhysXCollectors)o+=l.getCollisions().length;let s=(t+n+o)/2;console.log("Current Collisions Count:",s),console.log("Raycast Count:",this._myRaycastCount),console.log("FPS History:");let a="";for(let l of this._myFPSHistory)a=a.concat(l,`
`);console.log(a)}}if(this._myAddVelocityDelay>0&&(this._myAddVelocityDelay--,this._myAddVelocityDelay==0))for(let t of this._myDynamicPhysXComponents){t.kinematic=!1;let n=50;t.linearVelocity=[Math.pp_random(-n,n),Math.pp_random(-n,n),Math.pp_random(-n,n)],t.angularVelocity=[Math.pp_random(-n,n),Math.pp_random(-n,n),Math.pp_random(-n,n)]}for(let t of this._myKinematicPhysXObjects){let n=5*e;this._myTranslateVec3.vec3_set(Math.pp_random(-n,n),Math.pp_random(-n,n),Math.pp_random(-n,n)),t.pp_translate(this._myTranslateVec3);let o=50*e;this._myRotateVec3.vec3_set(Math.pp_random(-o,o),Math.pp_random(-o,o),Math.pp_random(-o,o)),t.pp_rotate(this._myRotateVec3)}}}_raycastTest(e){let t=this._myRaycastCount,n=1e4;for(let o=0;o<t;o++){let s=[Math.pp_random(1,2)*Math.pp_randomSign(),Math.pp_random(1,2)*Math.pp_randomSign(),Math.pp_random(1,2)*Math.pp_randomSign()],a=[Math.pp_random(-1,1),Math.pp_random(-1,1),Math.pp_random(-1,1)];a.vec3_normalize(a),this._myRaycastParams.myOrigin.vec3_copy(s),this._myRaycastParams.myDirection.vec3_copy(a),this._myRaycastParams.myDistance=n,this._myRaycastParams.myBlockLayerFlags.setAllFlagsActive();let l=De.raycast(this._myRaycastParams,this._myRaycastResults);e&&m.isDebugEnabled(this.engine)&&m.getDebugVisualManager(this.engine).drawRaycast(this._myDebugTimer.getDuration(),l,!0,5,.015)}}_spawnDome(e,t){let n=this._myStaticPhysXCount,o=this._myStaticPhysXObjects,s=Math.ceil(Math.sqrt(this._myStaticPhysXCount));e||(t?(s=Math.ceil(Math.sqrt(this._myDynamicPhysXCount)),n=this._myDynamicPhysXCount,o=this._myDynamicPhysXObjects):(s=Math.ceil(Math.sqrt(this._myKinematicPhysXCount)),n=this._myKinematicPhysXCount,o=this._myKinematicPhysXObjects));let a=Math.PI*2/s,l=Math.max(0,this._myStaticDomeSize-20),h=this._myStaticDomeSize+20;e||(t?(l=Math.max(0,this._myDynamicDomeSize-20),h=this._myDynamicDomeSize+20):(l=Math.max(0,this._myKinematicDomeSize-20),h=this._myKinematicDomeSize+20));let _=0,y=Math.pp_toRadians(10),r=p(0,1,0),u=p(0,0,-1);for(let g=0;g<s/2;g++){let P=p(0,1,0),C=p();u.vec3_cross(P,C),C.vec3_normalize(C);for(let f=0;f<s;f++){if(o.length<n){let S=Math.random()*(h-l)+l,M=(Math.random()*2-1)*(y-_)+_,D=(Math.random()*2-1)*(y-_)+_,v=P.pp_clone();v.vec3_rotateAxisRadians(M,C,v),v.vec3_rotateAxisRadians(D,r,v),v.vec3_scale(S,v),this._addPhysX(v,e,t)}if(P.vec3_rotateAxisRadians(a/2,C,P),o.length<n){let S=Math.random()*(h-l)+l,M=(Math.random()*2-1)*(y-_)+_,D=(Math.random()*2-1)*(y-_)+_,v=P.pp_clone();v.vec3_rotateAxisRadians(M,C,v),v.vec3_rotateAxisRadians(D,r,v),v.vec3_scale(S,v),this._addPhysX(v,e,t)}P.vec3_rotateAxisRadians(a/2,C,P)}u.vec3_rotateAxisRadians(a,r,u)}}_addPhysX(e,t,n){let o=e,s=Math.pp_random(1,10),a=Math.pp_randomPick(Jl.Sphere,Jl.Box);this._myUseConvexMesh&&(a=Jl.ConvexMesh,s*=this._myShapeScaleMultiplier);let l=this._myParentObject.pp_addObject();l.pp_setPosition(o);let h=l.pp_addComponent(JA,{shape:a,shapeData:{index:this._myShapeIndex},extents:p(s,s,s),static:t,kinematic:!n,mass:1});t?(this._myStaticPhysXObjects.push(l),this._myStaticPhysXComponents.push(h),this._myStaticPhysXCollectors.push(new Xt(h))):n?(this._myDynamicPhysXObjects.push(l),this._myDynamicPhysXComponents.push(h),this._myDynamicPhysXCollectors.push(new Xt(h))):(this._myKinematicPhysXObjects.push(l),this._myKinematicPhysXComponents.push(h),this._myKinematicPhysXCollectors.push(new Xt(h)))}onDestroy(){for(let e of this._myStaticPhysXCollectors)e.destroy();for(let e of this._myDynamicPhysXCollectors)e.destroy();for(let e of this._myKinematicPhysXCollectors)e.destroy()}};import{Alignment as Or,Component as ZA,Justification as Ir,MeshComponent as Br,Property as ht,TextComponent as Lr}from"@wonderlandengine/api";var Po=class extends ZA{static TypeName="pp-benchmark-max-visible-triangles";static Properties={_myTargetFrameRate:ht.int(-1),_myTargetFrameRateThreshold:ht.int(3),_myStartPlaneCount:ht.int(1),_myPlaneTriangles:ht.int(100),_mySecondsBeforeDoubling:ht.float(.5),_myDTHistoryToIgnorePercentage:ht.float(.25),_myCloneMaterial:ht.bool(!1),_myCloneMesh:ht.bool(!1),_myLogEnabled:ht.bool(!0),_myStartOnXRStart:ht.bool(!1),_myDisplayInFrontOfPlayer:ht.bool(!0),_myDisplayInFrontOfPlayerDistance:ht.float(10),_myPlaneMaterial:ht.material(),_myBackgroundMaterial:ht.material(),_myTextMaterial:ht.material(null)};_start(){this._myBackgroundSize=4,this._myBackgroundObject.pp_setActive(!0),this._myBackgroundObject.pp_setScale(this._myBackgroundSize+.1),this._myBackgroundObject.pp_translateLocal(p(0,0,-.001)),this._myDoubleTimer=new te(this._mySecondsBeforeDoubling),this._myDone=!1,this._myCurrentPlanes=this._myStartPlaneCount,this._myDTHistory=[],this._myUpperLimit=-1,this._myLowerLimit=0,this._myPlanes=[],this._mySkipNextFrames=0,this._myMaxWaitFrames=0,this._myMaxPlanesReached=!1,this._myFirstTime=!0}_update(e){{if(e<1e-5)return;if(e>.5&&this._myMaxWaitFrames>0){this._myMaxWaitFrames--;return}if(this._myMaxWaitFrames=10,this._mySkipNextFrames>0){this._mySkipNextFrames--;return}}if(!this._myDone&&(this._myDoubleTimer.update(e),this._myDTHistory.push(e),this._myDoubleTimer.isDone())){this._myDoubleTimer.start();let t=this._computeAverageFrameRate(!1);if(this._myFirstTime)this._myFirstTime=!1;else{let n=!1;t<this._myStableFrameRate-this._myTargetFrameRateThreshold?(this._myUpperLimit=this._myCurrentPlanes,n=!0,this._myUpperLimit==1&&(this._myLowerLimit=1)):(this._myLowerLimit=this._myCurrentPlanes,this._myUpperLimit>0&&(this._myUpperLimit=Math.max(this._myUpperLimit,this._myLowerLimit))),this._myTriangleTextComponent.text="Triangles: "+this._myCurrentPlanes*this._myRealTrianglesAmount,this._myPlaneTextComponent.text="Planes: "+this._myCurrentPlanes,this._myFPSTextComponent.text="FPS: "+t+" / "+this._myStableFrameRate,n?(this._myTriangleTextComponent.material.color=this._myLagColor,this._myPlaneTextComponent.material.color=this._myLagColor,this._myFPSTextComponent.material.color=this._myLagColor):(this._myTriangleTextComponent.material.color=this._myNormalColor,this._myPlaneTextComponent.material.color=this._myNormalColor,this._myFPSTextComponent.material.color=this._myNormalColor);let o=!1;(this._myUpperLimit>0&&!n&&this._myUpperLimit-this._myLowerLimit<=Math.max(2,1e3/this._myRealTrianglesAmount)||n&&this._myUpperLimit-this._myLowerLimit<=1||!n&&this._myMaxPlanesReached)&&(t<this._myStableFrameRate-this._myTargetFrameRateThreshold?(this._myLowerLimit=Math.max(1,Math.floor(this._myUpperLimit/2.5)),this._myUpperLimit=0,o=!0,this._myLogEnabled&&console.log("Rst - Triangles:",this._myCurrentPlanes*this._myRealTrianglesAmount,"- Planes:",this._myCurrentPlanes,"- Frame Rate:",t)):(this._myMaxPlanesReached?this._myLogEnabled&&(console.log("Aborted - Max Planes Reached"),this._myDoneTextComponent.text="Aborted - Max Planes Reached"):(this._displayPlanes(this._myLowerLimit),this._myLogEnabled&&(console.log(`
End - Triangles:`,this._myLowerLimit*this._myRealTrianglesAmount,"- Planes:",this._myLowerLimit,"- Frame Rate:",t),console.log("Plane Triangles (Adjusted):",this._myRealTrianglesAmount),console.log("Target Frame Rate:",this._myStableFrameRate,"- Threshold: ",this._myStableFrameRate-this._myTargetFrameRateThreshold)),this._myTriangleTextComponent.text="Triangles: "+this._myLowerLimit*this._myRealTrianglesAmount,this._myPlaneTextComponent.text="Planes: "+this._myLowerLimit,this._myFPSTextComponent.text="FPS: "+t+" / "+this._myStableFrameRate,this._myDoneTextComponent.text="End"),this._myDone=!0)),n&&!o&&this._myLogEnabled&&console.log("Lag - Triangles:",this._myCurrentPlanes*this._myRealTrianglesAmount,"- Planes:",this._myCurrentPlanes,"- Frame Rate:",t),this._myDone||(this._myUpperLimit>0?(this._myCurrentPlanes=Math.floor((this._myUpperLimit+this._myLowerLimit)/2),this._myCurrentPlanes=Math.max(this._myCurrentPlanes,1)):o?this._myCurrentPlanes=this._myLowerLimit:this._myCurrentPlanes=this._myLowerLimit*2,this._myCurrentPlanes>5e4?(this._myCurrentPlanes=5e4,this._myMaxPlanesReached=!0):this._myMaxPlanesReached=!1)}this._myDone||(this._displayPlanes(this._myCurrentPlanes),this._myElapsedTime=0,this._myFrameCount=0,this._mySkipNextFrames=30)}}_displayPlanes(e){for(;this._myPlanes.length>e;){let l=this._myPlanes.pop();m.getObjectPoolManager(this.engine).release(this._myPoolID,l)}for(;this._myPlanes.length<e;){let l=m.getObjectPoolManager(this.engine).get(this._myPoolID);this._myPlanes.push(l)}let t=1;for(;t*t<e;)t++;let n=.01,o=n*(t-1),s=(this._myBackgroundSize*2-o)/(t*2),a=e;for(let l=0;l<t&&a>0;l++)for(let h=0;h<t&&a>0;h++){let _=this._myPlanes[a-1];_.pp_setScale(s);let y=[-this._myBackgroundSize+s+h*s*2+h*n,this._myBackgroundSize-s-l*s*2-l*n,0];_.pp_setPositionLocal(y),_.pp_setActive(!0),a--}}start(){if(this._myValid=!1,!m.isDebugEnabled(this.engine))return;this._myValid=!0,this._myPlaneMaterial==null&&(this._myPlaneMaterial=m.getDefaultMaterials(this.engine).myPhongOpaque.clone(),this._myPlaneMaterial.diffuseColor=F(.95,.95,.95,1),this._myPlaneMaterial.ambientColor=F(0,0,0,1),this._myPlaneMaterial.ambientFactor=.5),this._myBackgroundMaterial==null&&(this._myBackgroundMaterial=m.getDefaultMaterials(this.engine).myPhongOpaque.clone(),this._myBackgroundMaterial.diffuseColor=F(.25,.25,.25,1),this._myBackgroundMaterial.ambientColor=F(0,0,0,1),this._myBackgroundMaterial.ambientFactor=.5),this._myTextMaterial==null&&(this._myTextMaterial=m.getDefaultMaterials(this.engine).myText.clone()),this._myLagColor=F(.6,0,0,1),this._myNormalColor=F(.25,.25,.25,1),this._myRealTrianglesAmount=0;let e=this.object;this._myDisplayInFrontOfPlayer&&(e=m.getPlayerObjects(this.engine).myHead.pp_addObject(),e.pp_rotateAxis(180,p(0,1,0)),e.pp_translateLocal(p(0,0,this._myDisplayInFrontOfPlayerDistance))),this._myTrianglesObject=e.pp_addObject(),this._myBackgroundObject=this._myTrianglesObject.pp_addObject();{let n=this._myBackgroundObject.pp_addComponent(Br);n.mesh=Re.createPlane(this.engine),n.material=this._myBackgroundMaterial.clone()}this._myPlaneObject=this._myTrianglesObject.pp_addObject();{let n=this._myPlaneObject.pp_addComponent(Br);n.mesh=this._createPlaneMesh(this._myPlaneTriangles),this._myRealTrianglesAmount=n.mesh.indexData.length/3,n.material=this._myPlaneMaterial.clone()}let t=new Ni;this._myCloneMesh?this._myRealTrianglesAmount<=4?t.myInitialPoolSize=15e3:this._myRealTrianglesAmount<=8?t.myInitialPoolSize=1e4:this._myRealTrianglesAmount<=64?t.myInitialPoolSize=7500:t.myInitialPoolSize=5e3:t.myInitialPoolSize=3e4,t.myPercentageToAddWhenEmpty=0,t.myAmountToAddWhenEmpty=1e4,t.myCloneParams=new jt,t.myCloneParams.myComponentDeepCloneParams.setDeepCloneComponentVariable(Br.TypeName,"material",this._myCloneMaterial),t.myCloneParams.myComponentDeepCloneParams.setDeepCloneComponentVariable(Br.TypeName,"mesh",this._myCloneMesh),this._myPoolID=this.type+"_"+Math.pp_randomUUID(),m.getObjectPoolManager(this.engine).addPool(this._myPoolID,new Ui(this._myPlaneObject,t)),this._myBackgroundObject.pp_setActive(!1),this._myPlaneObject.pp_setActive(!1),this._myStartTimer=new te(2),this._mySessionStarted=!1,this._myTextsObject=this._myTrianglesObject.pp_addObject(),this._myTriangleTextObject=this._myTextsObject.pp_addObject(),this._myTriangleTextComponent=this._myTriangleTextObject.pp_addComponent(Lr),this._myTriangleTextComponent.alignment=Or.Left,this._myTriangleTextComponent.justification=Ir.Line,this._myTriangleTextComponent.material=this._myTextMaterial.clone(),this._myTriangleTextComponent.material.color=this._myNormalColor,this._myTriangleTextComponent.text=" ",this._myPlaneTextObject=this._myTextsObject.pp_addObject(),this._myPlaneTextComponent=this._myPlaneTextObject.pp_addComponent(Lr),this._myPlaneTextComponent.alignment=Or.Left,this._myPlaneTextComponent.justification=Ir.Line,this._myPlaneTextComponent.material=this._myTextMaterial.clone(),this._myPlaneTextComponent.material.color=this._myNormalColor,this._myPlaneTextComponent.text=" ",this._myFPSTextObject=this._myTextsObject.pp_addObject(),this._myFPSTextComponent=this._myFPSTextObject.pp_addComponent(Lr),this._myFPSTextComponent.alignment=Or.Left,this._myFPSTextComponent.justification=Ir.Line,this._myFPSTextComponent.material=this._myTextMaterial.clone(),this._myFPSTextComponent.material.color=this._myNormalColor,this._myFPSTextComponent.text=" ",this._myDoneTextObject=this._myTrianglesObject.pp_addObject(),this._myDoneTextComponent=this._myDoneTextObject.pp_addComponent(Lr),this._myDoneTextComponent.alignment=Or.Center,this._myDoneTextComponent.justification=Ir.Line,this._myDoneTextComponent.material=this._myTextMaterial.clone(),this._myDoneTextComponent.material.color=this._myNormalColor,this._myDoneTextComponent.text=" ",this._myTextsObject.pp_setPositionLocal(p(0,4.3,0)),this._myTextsObject.pp_setScale(2.75),this._myTriangleTextObject.pp_setPositionLocal(p(-1.4,0,0)),this._myPlaneTextObject.pp_setPositionLocal(p(.55,0,0)),this._myFPSTextObject.pp_setPositionLocal(p(-.315,0,0)),this._myDoneTextObject.pp_setPositionLocal(p(0,-4.6,0)),this._myDoneTextObject.pp_setScale(4),this._myDTHistory=[],this._myFramesToSkip=10}update(e){this._myValid&&(this._myFramesToSkip==0?this._mySessionStarted||!this._myStartOnXRStart?this._myStartTimer.isRunning()?(this._myStartTimer.update(e),this._myDTHistory.push(e),this._myStartTimer.isDone()&&(this._myStableFrameRate=this._computeAverageFrameRate(!0),this._myTargetFrameRate>0&&(this._myStableFrameRate=this._myTargetFrameRate),this._myLogEnabled&&(console.log(`
Plane Triangles (Adjusted):`,this._myRealTrianglesAmount),console.log("Target Frame Rate:",this._myStableFrameRate,"- Threshold: ",this._myStableFrameRate-this._myTargetFrameRateThreshold),console.log("")),this._start())):this._update(e):this._mySessionStarted=O.getSession(this.engine)!=null:this._myFramesToSkip--)}_computeAverageFrameRate(e){let t=0;this._myDTHistory.sort();let n=Math.floor(this._myDTHistory.length*Math.min(.9,this._myDTHistoryToIgnorePercentage*(e?2:1)));for(let s=0;s<n&&this._myDTHistory.length>1;s++)this._myDTHistory.pop();let o=0;for(let s of this._myDTHistory)o+=s;return o/=this._myDTHistory.length,t=Math.round(1/o),this._myDTHistory=[],t}_createPlaneMesh(e){let t=Math.ceil(e/2),n=1,o=1,s=1;for(;s*s<t;)s++;for(n=s,o=s;n>1&&o>1&&n*o>t&&(n-1)*o>=t;)n--;let a=new Pn(this.engine);for(let h=0;h<n+1;h++)for(let _=0;_<o+1;_++){let y=2/o*_,r=2/n*h,u=new Tn;u.myPosition=p(),u.myPosition[0]=y-1,u.myPosition[1]=r-1,u.myPosition[2]=0,u.myTextureCoordinates=Ce(),u.myTextureCoordinates[0]=y/2,u.myTextureCoordinates[1]=r/2,u.myNormal=p(),u.myNormal[0]=0,u.myNormal[1]=0,u.myNormal[2]=1,a.myVertexes.push(u)}for(let h=0;h<n;h++)for(let _=0;_<o;_++){let y=new Si;y.myIndexes[0]=h*(o+1)+_,y.myIndexes[1]=h*(o+1)+_+1,y.myIndexes[2]=(h+1)*(o+1)+_;let r=new Si;r.myIndexes[0]=(h+1)*(o+1)+_,r.myIndexes[1]=h*(o+1)+_+1,r.myIndexes[2]=(h+1)*(o+1)+_+1,a.myTriangles.push(y),a.myTriangles.push(r)}return Re.create(a)}onDestroy(){m.getObjectPoolManager(this.engine)?.destroyPool(this._myPoolID)}};import{Emitter as Ji}from"@wonderlandengine/api";function nC(i,e){e!=null&&localStorage.setItem(i,e)}function YA(i){return Bt.loadString(i,null)!=null}function $A(i){return localStorage.removeItem(i)}function eR(){return localStorage.clear()}function oC(i,e=null){return Bt.loadString(i,e)}function sC(i,e=null){let t=localStorage.getItem(i);return t==null&&(t=e),t}function aC(i,e=null){let t=Bt.loadString(i);return t!=null?Number(t):e}function rC(i,e=null){let t=Bt.loadString(i);return t=="true"?!0:t=="false"?!1:e}var Bt={save:nC,has:YA,remove:$A,clear:eR,load:oC,loadString:sC,loadNumber:aC,loadBool:rC};var Zl=class{constructor(e=m.getMainEngine()){this._myEngine=e,this._mySaveCache=new Map,this._myCacheEnabled=!0,this._myCommitSavesDelayTimer=new te(0,!1),this._myDelaySavesCommit=!0,this._myIDsToCommit=[],this._myCacheDefaultValueOnFail=!0,O.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this._myEngine),this._myClearEmitter=new Ji,this._myDeleteEmitter=new Ji,this._myDeleteIDEmitters=new Map,this._mySaveEmitter=new Ji,this._mySaveValueChangedEmitter=new Ji,this._mySaveIDEmitters=new Map,this._mySaveValueChangedIDEmitters=new Map,this._myCommitSaveEmitter=new Ji,this._myCommitSaveIDEmitters=new Map,this._myCommitSavesEmitter=new Ji,this._myLoadEmitter=new Ji,this._myLoadIDEmitters=new Map,this._myVisibilityChangeEventListener=null,this._myDestroyed=!1}setCommitSavesDelay(e){this._myCommitSavesDelayTimer.start(e)}setDelaySavesCommit(e){this._myDelaySavesCommit=e}setCacheDefaultValueOnFail(e){this._myCacheDefaultValueOnFail=e}setCacheEnabled(e){this._myCacheEnabled=e}update(e){this._myCommitSavesDelayTimer.isRunning()&&(this._myCommitSavesDelayTimer.update(e),this._myCommitSavesDelayTimer.isDone()&&this.commitSaves())}save(e,t,n=null,o=null){let s=!1;if(this._mySaveCache.has(e)&&this._isCacheEnabled(o)&&(s=this._mySaveCache.get(e)===t),!s)if(this._mySaveCache.set(e,t),this._myDelaySavesCommit&&n==null||n!=null&&n)this._myIDsToCommit.pp_pushUnique(e),this._myCommitSavesDelayTimer.isRunning()||this._myCommitSavesDelayTimer.start();else{let a=this._commitSave(e,!1),l=!1;this._myCommitSavesEmitter.notify(l,a)}if(this._mySaveEmitter.notify(e,t),this._mySaveIDEmitters.size>0){let a=this._mySaveIDEmitters.get(e);a?.notify(e,t)}if(!s&&(this._mySaveValueChangedEmitter.notify(e,t),this._mySaveValueChangedIDEmitters.size>0)){let a=this._mySaveValueChangedIDEmitters.get(e);a?.notify(e,t)}}commitSaves(){if(this._myIDsToCommit.length>0){let e=!1;for(let n of this._myIDsToCommit)if(this._mySaveCache.has(n)){let o=this._commitSave(n,!0);e=e||o}this._myIDsToCommit=[];let t=!0;this._myCommitSavesEmitter.notify(t,e)}}has(e,t=null){return this._mySaveCache.has(e)&&this._isCacheEnabled(t)||Bt.has(e)}remove(e){if(this._mySaveCache.delete(e),Bt.remove(e),this._myDeleteEmitter.notify(e),this._myDeleteIDEmitters.size>0){let t=this._myDeleteIDEmitters.get(e);t?.notify(e)}}clear(){this._mySaveCache.clear(),Bt.clear(),this._myClearEmitter.notify()}load(e,t=null,n=null){return this._load(e,t,"load",n)}loadString(e,t=null,n=null){return this._load(e,t,"loadString",n)}loadNumber(e,t=null,n=null){return this._load(e,t,"loadNumber",n)}loadBool(e,t=null,n=null){return this._load(e,t,"loadBool",n)}getCommitSavesDelay(){return this._myCommitSavesDelayTimer.getDuration()}isDelaySavesCommit(){return this._myDelaySavesCommit}isCacheDefaultValueOnFail(){return this._myCacheDefaultValueOnFail}isCacheEnabled(){return this._myCacheEnabled}_commitSave(e,t){let n=this._mySaveCache.get(e),o=!1;try{Bt.save(e,n)}catch{o=!0}if(this._myCommitSaveEmitter.notify(e,n,t,o),this._myCommitSaveIDEmitters.size>0){let s=this._myCommitSaveIDEmitters.get(e);s?.notify(e,n,t,o)}return o}_load(e,t,n,o=null){let s=null,a=!1,l=!1;if(this._mySaveCache.has(e)&&this._isCacheEnabled(o))s=this._mySaveCache.get(e),s==null&&t!=null&&(s=t,this._myCacheDefaultValueOnFail&&this._mySaveCache.set(e,s)),l=!0;else{let h=null;try{h=Bt[n](e,null)}catch{h=null,a=!0}h==null?s=t:s=h,h!=null||this._myCacheDefaultValueOnFail?this._mySaveCache.set(e,s):this._mySaveCache.set(e,null)}if(this._myLoadEmitter.notify(e,s,l,a),this._myLoadIDEmitters.size>0){let h=this._myLoadIDEmitters.get(e);h?.notify(e,s,l,a)}return s}_onXRSessionStart(e){this._myVisibilityChangeEventListener=function(t){t.session.visibilityState!="visible"&&this._onXRSessionInterrupt()}.bind(this),e.addEventListener("visibilitychange",this._myVisibilityChangeEventListener)}_onXRSessionEnd(){this._myVisibilityChangeEventListener=null,this._onXRSessionInterrupt()}_onXRSessionInterrupt(){this.commitSaves()}registerClearEventListener(e,t){this._myClearEmitter.add(t,{id:e})}unregisterClearEventListener(e){this._myClearEmitter.remove(e)}registerDeleteEventListener(e,t){this._myDeleteEmitter.add(t,{id:e})}unregisterDeleteEventListener(e){this._myDeleteEmitter.remove(e)}registerDeleteIDEventListener(e,t,n){let o=this._myDeleteIDEmitters.get(e);o==null&&(this._myDeleteIDEmitters.set(e,new Map),o=this._myDeleteIDEmitters.get(e)),o.add(n,{id:t})}unregisterDeleteIDEventListener(e,t){let n=this._myDeleteIDEmitters.get(e);n!=null&&(n.remove(t),n.size<=0&&this._myDeleteIDEmitters.delete(e))}registerSaveEventListener(e,t){this._mySaveEmitter.add(t,{id:e})}unregisterSaveEventListener(e){this._mySaveEmitter.remove(e)}registerSaveIDEventListener(e,t,n){let o=this._mySaveIDEmitters.get(e);o==null&&(this._mySaveIDEmitters.set(e,new Map),o=this._mySaveIDEmitters.get(e)),o.add(n,{id:t})}unregisterSaveIDEventListener(e,t){let n=this._mySaveIDEmitters.get(e);n!=null&&(n.remove(t),n.size<=0&&this._mySaveIDEmitters.delete(e))}registerSaveValueChangedEventListener(e,t){this._mySaveValueChangedEmitter.add(t,{id:e})}unregisterSaveValueChangedEventListener(e){this._mySaveValueChangedEmitter.remove(e)}registerSaveValueChangedIDEventListener(e,t,n){let o=this._mySaveValueChangedIDEmitters.get(e);o==null&&(this._mySaveValueChangedIDEmitters.set(e,new Map),o=this._mySaveValueChangedIDEmitters.get(e)),o.add(n,{id:t})}unregisterSaveValueChangedIDEventListener(e,t){let n=this._mySaveValueChangedIDEmitters.get(e);n!=null&&(n.remove(t),n.size<=0&&this._mySaveValueChangedIDEmitters.delete(e))}registerCommitSavesEventListener(e,t){this._myCommitSavesEmitter.add(t,{id:e})}unregisterCommitSavesEventListener(e){this._myCommitSavesEmitter.remove(e)}registerCommitSaveEventListener(e,t){this._myCommitSaveEmitter.add(t,{id:e})}unregisterCommitSaveEventListener(e){this._myCommitSaveEmitter.remove(e)}registerCommitSaveIDEventListener(e,t,n){let o=this._myCommitSaveIDEmitters.get(e);o==null&&(this._myCommitSaveIDEmitters.set(e,new Map),o=this._myCommitSaveIDEmitters.get(e)),o.add(n,{id:t})}unregisterCommitSaveIDEventListener(e,t){let n=this._myCommitSaveIDEmitters.get(e);n!=null&&(n.remove(t),n.size<=0&&this._myCommitSaveIDEmitters.delete(e))}registerLoadEventListener(e,t){this._myLoadEmitter.add(t,{id:e})}unregisterLoadEventListener(e){this._myLoadEmitter.remove(e)}registerLoadIDEventListener(e,t,n){let o=this._myLoadIDEmitters.get(e);o==null&&(this._myLoadIDEmitters.set(e,new Map),o=this._myLoadIDEmitters.get(e)),o.add(n,{id:t})}unregisterLoadIDEventListener(e,t){let n=this._myLoadIDEmitters.get(e);n!=null&&(n.remove(t),n.size<=0&&this._myLoadIDEmitters.delete(e))}_isCacheEnabled(e=null){return this._myCacheEnabled&&e==null||e!=null&&e}destroy(){this._myDestroyed=!0,O.getSession(this._myEngine)?.removeEventListener("visibilitychange",this._myVisibilityChangeEventListener),O.unregisterSessionStartEndEventListeners(this,this._myEngine)}isDestroyed(){return this._myDestroyed}};import{Component as tR,Property as iR}from"@wonderlandengine/api";var Co=class extends tR{static TypeName="pp-clear-console-on-xr-session-start";static Properties={_myFirstTimeOnly:iR.bool(!0)};start(){this._myFirstTime=!0,O.registerSessionStartEventListener(this,this._onXRSessionStart.bind(this),!0,!1,this.engine)}_onXRSessionStart(){(!this._myFirstTimeOnly||this._myFirstTime)&&(this._myFirstTime=!1,console.clear())}onDestroy(){O.unregisterSessionStartEventListener(this,this.engine)}};import{Component as nR,Property as Yl}from"@wonderlandengine/api";var bo=class extends nR{static TypeName="pp-set-active";static Properties={_myActive:Yl.bool(!0),_mySetActiveOn:Yl.enum(["Self","Children","Descendants","Hierarchy"],"Hierarchy"),_mySetActiveWhen:Yl.enum(["Init","Start","First Update","Enter XR","Exit XR","First Enter XR","First Exit XR"],"Init")};init(){this.active&&this._mySetActiveWhen==0&&this._setActive()}start(){this._mySetActiveWhen==1&&this._setActive(),this._myFirstUpdate=!0,this._myFirstXRStart=!0,this._myFirstXREnd=!0,(this._mySetActiveWhen==3||this._mySetActiveWhen==5)&&O.registerSessionStartEventListener(this,this._onXRSessionStart.bind(this),!0,!0,this.engine),(this._mySetActiveWhen==4||this._mySetActiveWhen==6)&&O.registerSessionEndEventListener(this,this._onXRSessionEnd.bind(this),this.engine)}update(e){this._mySetActiveWhen==2&&this._myFirstUpdate&&this._setActive(),this._myFirstUpdate=!1}_onXRSessionStart(){(this._mySetActiveWhen==3||this._mySetActiveWhen==5&&this._myFirstXRStart)&&this._setActive(),this._myFirstXRStart=!1}_onXRSessionEnd(){(this._mySetActiveWhen==4||this._mySetActiveWhen==6&&this._myFirstXREnd)&&this._setActive(),this._myFirstXREnd=!1}_setActive(){this._mySetActiveOn==0?this.object.pp_setActiveSelf(this._myActive):this._mySetActiveOn==1?this.object.pp_setActiveChildren(this._myActive):this._mySetActiveOn==2?this.object.pp_setActiveDescendants(this._myActive):this.object.pp_setActive(this._myActive)}onDestroy(){O.unregisterSessionStartEndEventListeners(this,this.engine)}};import{Component as oR,PhysXComponent as sR,Property as aR}from"@wonderlandengine/api";var So=class extends oR{static TypeName="pp-adjust-hierarchy-physx-scale";static Properties={_myWhen:aR.enum(["Init","Start","First Update"],"Start")};init(){this.active&&this._myWhen==0&&this._adjustScale()}start(){this._myWhen==1&&this._adjustScale(),this._myFirst=!0}update(e){this._myWhen==2&&this._myFirst&&(this._myFirst=!1,this._adjustScale())}_adjustScale(){let e=this.object.pp_getScale(),t=this.object.pp_getComponents(sR);for(let n of t)n.extents[0]=n.extents[0]*e[0],n.extents[1]=n.extents[1]*e[1],n.extents[2]=n.extents[2]*e[2],n.active&&(n.active=!1,n.active=!0)}};import{Alignment as rR,Component as lR,Justification as mR,Property as kn}from"@wonderlandengine/api";var vo=class extends lR{static TypeName="pp-show-fps";static Properties={_myRefreshSeconds:kn.float(.25),_myScreenPositionX:kn.float(1),_myScreenPositionY:kn.float(-1),_myScreenPositionZ:kn.float(1),_myScale:kn.float(1.5),_myTextMaterial:kn.material()};start(){this._myColor=F(1,1,1,1),this._myTextMaterial!=null&&this._myColor.vec4_copy(this._myTextMaterial.color),this._myScreenPosition=p(this._myScreenPositionX,this._myScreenPositionY,this._myScreenPositionZ),this._myCurrentFPS=0,this._myTimer=new te(this._myRefreshSeconds),this._myTotalDT=0,this._myFrames=0}update(e){m.isDebugEnabled(this.engine)&&(this._myTotalDT+=e,this._myFrames++,this._myTimer.update(e),this._myTimer.isDone()&&(this._myTimer.start(),this._myCurrentFPS=Math.round(this._myFrames/this._myTotalDT),this._myTotalDT=0,this._myFrames=0),m.getDebugVisualManager(this.engine).drawUIText(0,this._myCurrentFPS.toFixed(0),this._myScreenPosition,this._myScale,this._myColor,rR.Right,mR.Bottom))}};import{Emitter as Hr}from"@wonderlandengine/api";var wn=class{constructor(e,t){this.myID=e,this.myObject=t}},jn=class{constructor(e,t,n,o,s){this.myID=e,this.myFromState=t,this.myToState=n,this.myObject=o,this.mySkipStateFunction=s}},di={IMMEDIATE:0,DELAYED:1},Cs={QUEUE:0,KEEP_FIRST:1,KEEP_LAST:2},Fn={NONE:0,END:1,START:2,BOTH:3},ct=class i{constructor(e=di.IMMEDIATE,t=Cs.QUEUE){this._myCurrentStateData=null,this._myStates=new Map,this._myTransitions=new Map,this._myLogEnabled=!1,this._myLogShowDelayedInfo=!1,this._myLogFSMName="FSM",this._myPerformMode=e,this._myPerformDelayedMode=t,this._myPendingPerforms=[],this._myCurrentlyPerformedTransition=null,this._myInitEmitter=new Hr,this._myInitIDEmitters=new Map,this._myTransitionEmitter=new Hr,this._myTransitionIDEmitters=[]}addState(e,t=null){let n=null;!t||typeof t=="function"?(n={},typeof t=="function"?n.update=function(){return t(...arguments)}:n.update=null,n.clone=function(){let a={};return a.update=this.update,a.clone=this.clone,a}):n=t;let o=new wn(e,n);this._myStates.set(e,o),this._myTransitions.set(e,new Map)}addTransition(e,t,n,o=null,s=Fn.NONE){let a=null;if(!o||typeof o=="function"?(a={},typeof o=="function"?a.perform=function(){return o(...arguments)}:a.perform=null,a.clone=function(){let h={};return h.perform=this.perform,h.clone=this.clone,h}):a=o,this.hasState(e)&&this.hasState(t)){let l=this._getTransitionsFromState(e),h=new jn(n,this.getState(e),this.getState(t),a,s);l.set(n,h)}else!this.hasState(e)&&!this.hasState(t)?console.error("Can't add transition:",n,"- from state not found:",e,"- to state not found:",t):this.hasState(e)?this.hasState(t)||console.error("Can't add transition:",n,"- to state not found:",t):console.error("Can't add transition:",n,"- from state not found:",e)}init(e,t=null,...n){let o=t;if(t&&typeof t=="function"&&(o={},o.performInit=t),this.hasState(e)){let s=this._myStates.get(e);if(this._myLogEnabled&&console.log(this._myLogFSMName,"- Init:",e),o&&o.performInit?o.performInit(this,s,...n):s.myObject&&s.myObject.init&&s.myObject.init(this,s,...n),this._myCurrentStateData=s,this._myInitEmitter.notify(this,s,o,...n),this._myInitIDEmitters.size>0){let a=this._myInitIDEmitters.get(e);a?.notify(this,s,o,...n)}}else this._myLogEnabled&&console.warn(this._myLogFSMName,"- Init state not found:",e)}update(e,...t){if(this._myPendingPerforms.length>0){for(let n=0;n<this._myPendingPerforms.length;n++)this._perform(this._myPendingPerforms[n].myID,di.DELAYED,...this._myPendingPerforms[n].myArgs);this._myPendingPerforms=[]}this._myCurrentStateData&&this._myCurrentStateData.myObject&&this._myCurrentStateData.myObject.update&&this._myCurrentStateData.myObject.update(e,this,...t)}perform(e,...t){this._myPerformMode==di.DELAYED?this.performDelayed(e,...t):this.performImmediate(e,...t)}performDelayed(e,...t){let n=!1;switch(this._myPerformDelayedMode){case Cs.QUEUE:this._myPendingPerforms.push(new bs(e,...t)),n=!0;break;case Cs.KEEP_FIRST:this.hasPendingPerforms()||(this._myPendingPerforms.push(new bs(e,...t)),n=!0);break;case Cs.KEEP_LAST:this.resetPendingPerforms(),this._myPendingPerforms.push(new bs(e,...t)),n=!0;break}return n}performImmediate(e,...t){return this._perform(e,di.IMMEDIATE,...t)}canPerform(e){return this.hasTransitionFromState(this._myCurrentStateData.myID,e)}canGoTo(e,t=null){return this.hasTransitionFromStateToState(this._myCurrentStateData.myID,e,t)}isInState(e){return this._myCurrentStateData!=null&&this._myCurrentStateData.myID==e}isPerformingTransition(){return this._myCurrentlyPerformedTransition!=null}getCurrentlyPerformedTransition(){return this._myCurrentlyPerformedTransition}hasBeenInit(){return this._myCurrentStateData!=null}reset(){this.resetState(),this.resetPendingPerforms()}resetState(){this._myCurrentStateData=null}resetPendingPerforms(){this._myPendingPerforms=[]}getCurrentState(){return this._myCurrentStateData}getCurrentTransitions(){return this.getTransitionsFromState(this._myCurrentStateData.myID)}getCurrentTransitionsToState(e){return this.getTransitionsFromStateToState(this._myCurrentStateData.myID,e)}getState(e){return this._myStates.get(e)}getStates(){return this._myStates.values()}getTransitions(){let e=[];for(let t of this._myTransitions.values())for(let n of t.values())e.push(n);return e}getTransitionsFromState(e){let t=this._getTransitionsFromState(e);return Array.from(t.values())}getTransitionsFromStateToState(e,t){let n=this._getTransitionsFromState(e),o=[];for(let s of n.values())s.myToState.myID==t&&o.push(s);return o}removeState(e){if(this.hasState(e)){this._myStates.delete(e),this._myTransitions.delete(e);for(let t of this._myTransitions.values()){let n=[];for(let[o,s]of t.entries())s.myToState.myID==e&&n.push(o);for(let o of n)t.delete(o)}return!0}return!1}removeTransitionFromState(e,t){let n=this._getTransitionsFromState(e);return n?n.delete(t):!1}hasState(e){return this._myStates.has(e)}hasTransitionFromState(e,t){return this.getTransitionsFromState(e).findIndex(function(s){return s.myID==t})>=0}hasTransitionFromStateToState(e,t,n=null){let o=this.getTransitionsFromStateToState(e,t),s=!1;return n?s=o.findIndex(function(l){return l.myID==n})>=0:s=o.length>0,s}setPerformMode(e){this._myPerformMode=e}getPerformMode(){return this._myPerformMode}setPerformDelayedMode(e){this._myPerformDelayedMode=e}getPerformDelayedMode(){return this._myPerformDelayedMode}hasPendingPerforms(){return this._myPendingPerforms.length>0}getPendingPerforms(){return this._myPendingPerforms.pp_clone()}clone(e=!1){if(!this.isCloneable(e))return null;let t=new i;t._myLogEnabled=this._myLogEnabled,t._myLogShowDelayedInfo=this._myLogShowDelayedInfo,t._myLogFSMName=this._myLogFSMName,t._myPerformMode=this._myPerformMode,t._myPerformDelayedMode=this._myPerformDelayedMode,t._myPendingPerforms=this._myPendingPerforms.pp_clone();for(let n of this._myStates.entries()){let o=null;e?o=new wn(n[1].myID,n[1].myObject.clone()):o=new wn(n[1].myID,n[1].myObject),t._myStates.set(o.myID,o)}for(let n of this._myTransitions.entries()){let o=new Map;t._myTransitions.set(n[0],o);for(let s of n[1].entries()){let a=null,l=t.getState(s[1].myFromState.myID),h=t.getState(s[1].myToState.myID);e?a=new jn(s[1].myID,l,h,s[1].myObject.clone(),s[1].mySkipStateFunction):a=new jn(s[1].myID,l,h,s[1].myObject,s[1].mySkipStateFunction),o.set(a.myID,a)}}return this._myCurrentStateData&&(t._myCurrentStateData=t.getState(this._myCurrentStateData.myID)),t}isCloneable(e=!1){if(!e)return!0;let t=!0;for(let n of this._myStates.entries())t=t&&n[1].myObject.clone!=null;for(let n of this._myTransitions.entries())for(let o of n[1].entries())t=t&&o[1].myObject.clone!=null;return t}setLogEnabled(e,t=null,n=!1){this._myLogEnabled=e,this._myLogShowDelayedInfo=n,t&&(this._myLogFSMName="FSM: ".concat(t))}registerInitEventListener(e,t){this._myInitEmitter.add(t,{id:e})}unregisterInitEventListener(e){this._myInitEmitter.remove(e)}registerInitIDEventListener(e,t,n){let o=this._myInitIDEmitters.get(e);o==null&&(this._myInitIDEmitters.set(e,new Hr),o=this._myInitIDEmitters.get(e)),o.add(n,{id:t})}unregisterInitIDEventListener(e,t){let n=this._myInitIDEmitters.get(e);n!=null&&(n.remove(t),n.isEmpty&&this._myInitIDEmitters.delete(e))}registerTransitionEventListener(e,t){this._myTransitionEmitter.add(t,{id:e})}unregisterTransitionEventListener(e){this._myTransitionEmitter.remove(e)}registerTransitionIDEventListener(e,t,n,o,s){let a=null;for(let l of this._myTransitionIDEmitters)if(l[0]==e&&l[1]==t&&l[2]==n){a=l[3];break}if(a==null){let l=[];l[0]=e,l[1]=t,l[2]=n,l[3]=new Hr,a=l[3],this._myTransitionIDEmitters.push(l)}a.add(s,{id:o})}unregisterTransitionIDEventListener(e,t,n,o){let s=null;for(let a of this._myTransitionIDEmitters)if(a[0]==e&&a[1]==t&&a[2]==n){s=a[3];break}s!=null&&(s.remove(o),s.isEmpty&&this._myTransitionIDEmitters.pp_remove(a=>a[0]==e&&a[1]==t&&a[2]==n))}_perform(e,t,...n){if(this.isPerformingTransition()){let o=this.getCurrentlyPerformedTransition(),s=[this._myLogFSMName,"- Trying to perform:",e];return this._myLogShowDelayedInfo&&s.push(t==di.DELAYED?"- Delayed":"- Immediate"),s.push("- But another transition is currently being performed -",o.myID),console.warn(...s),!1}if(this._myCurrentStateData){if(this.canPerform(e)){let s=this._myTransitions.get(this._myCurrentStateData.myID).get(e);this._myCurrentlyPerformedTransition=s;let a=this._myCurrentStateData,l=this._myStates.get(s.myToState.myID);if(this._myLogEnabled){let h=[this._myLogFSMName,"- From:",a.myID,"- To:",l.myID,"- With:",e];this._myLogShowDelayedInfo&&h.push(t==di.DELAYED?"- Delayed":"- Immediate"),console.log(...h)}if(s.mySkipStateFunction!=Fn.END&&s.mySkipStateFunction!=Fn.BOTH&&a.myObject&&a.myObject.end&&a.myObject.end(this,s,...n),s.myObject&&s.myObject.perform&&s.myObject.perform(this,s,...n),s.mySkipStateFunction!=Fn.START&&s.mySkipStateFunction!=Fn.BOTH&&l.myObject&&l.myObject.start&&l.myObject.start(this,s,...n),this._myCurrentStateData=s.myToState,this._myTransitionEmitter.notify(this,a,l,s,t,...n),this._myTransitionIDEmitters.length>0){let h=[];for(let _ of this._myTransitionIDEmitters)(_[0]==null||_[0]==a.myID)&&(_[1]==null||_[1]==l.myID)&&(_[2]==null||_[2]==s.myID)&&h.push(_[3]);for(let _ of h)_.notify(this,a,l,s,t,...n)}return this._myCurrentlyPerformedTransition=null,!0}else if(this._myLogEnabled){let o=[this._myLogFSMName,"- No Transition:",e,"- From:",this._myCurrentStateData.myID];this._myLogShowDelayedInfo&&o.push(t==di.DELAYED?"- Delayed":"- Immediate"),console.warn(...o)}}else if(this._myLogEnabled){let o=[this._myLogFSMName,"- FSM not initialized yet"];this._myLogShowDelayedInfo&&o.push(t==di.DELAYED?"- Delayed":"- Immediate"),console.warn(...o)}return!1}_getTransitionsFromState(e){return this._myTransitions.get(e)}},bs=class{constructor(e,...t){this.myID=e,this.myArgs=t}};var Zi=class{update(e,t,...n){}init(e,t,...n){}start(e,t,...n){}end(e,t,...n){}};var $l=class{performInit(e,t,...n){}perform(e,t,...n){}};var Ss=class extends Zi{constructor(e=0,t=null,...n){super(),this._myTransitionToPerformOnEnd=t,this._myTransitionArgs=n,this._myTimer=new te(e,!1)}setDuration(e){this._myTimer.setDuration(e)}setTransitionToPerformOnEnd(e,...t){this._myTransitionToPerformOnEnd=e,this._myTransitionArgs=t}onEnd(e,t=null){this._myTimer.onEnd(e,t)}unregisterOnEnd(e=null){this._myTimer.unregisterOnEnd(e)}update(e,t){this._myTimer.update(e),this._myTimer.isDone()&&this._myTransitionToPerformOnEnd!=null&&t.perform(this._myTransitionToPerformOnEnd,...this._myTransitionArgs)}start(e,t,n=null,o=null,...s){this._myTimer.start(n),o!=null&&(this._myTransitionToPerformOnEnd=o,this._myTransitionArgs=s)}init(e,t,n=null,o=null,...s){this._myTimer.start(n),o!=null&&(this._myTransitionToPerformOnEnd=o,this._myTransitionArgs=s)}};function lC(i){let e=i.pp_clone(),t=i[0],n=i[1],o=i[2],s=Math.max(t,n,o),a=Math.min(t,n,o),l=s-a,h,_=s===0?0:l/s,y=s;switch(s){case a:h=0;break;case t:h=n-o+l*(n<o?6:0),h/=6*l;break;case n:h=o-t+l*2,h/=6*l;break;case o:h=t-n+l*4,h/=6*l;break}return e[0]=h,e[1]=_,e[2]=y,e}function mC(i){let e=i.pp_clone(),t=i[0],n=i[1],o=i[2],s,a,l,h,_,y,r,u;switch(h=Math.floor(t*6),_=t*6-h,y=o*(1-n),r=o*(1-_*n),u=o*(1-(1-_)*n),h%6){case 0:s=o,a=u,l=y;break;case 1:s=r,a=o,l=y;break;case 2:s=y,a=o,l=u;break;case 3:s=y,a=r,l=o;break;case 4:s=u,a=y,l=o;break;case 5:s=o,a=y,l=r;break}return e[0]=s,e[1]=a,e[2]=l,e}function yC(i){return he.color1To255(i)}function uC(i){return he.color255To1(i)}function hC(i){return he.color1To255(i)}function cC(i){return he.color255To1(i)}function pC(i){let e=i.pp_clone();for(let t=0;t<e.length;t++)e[t]/=255,e[t]=Math.pp_clamp(e[t],0,1);return e}function dC(i){let e=i.pp_clone();for(let t=0;t<e.length;t++)e[t]=Math.round(e[t]*255),e[t]=Math.pp_clamp(e[t],0,255);return e}var he={rgbToHSV:lC,hsvToRGB:mC,rgbCodeToHuman:yC,rgbHumanToCode:uC,hsvCodeToHuman:hC,hsvHumanToCode:cC,color255To1:pC,color1To255:dC};import{MeshComponent as vs}from"@wonderlandengine/api";var _C=function(){let i=F();return function(t,n){t.color!=null&&(i.vec4_copy(t.color),i[3]=n,t.color=i),t.diffuseColor!=null&&(i.vec4_copy(t.diffuseColor),i[3]=n,t.diffuseColor=i),t.ambientColor!=null&&(i.vec4_copy(t.ambientColor),i[3]=n,t.ambientColor=i)}}();function gC(i,e){let t=i.pp_getComponents(vs);for(let n of t)n.material!=null&&xs.setAlpha(n.material,e)}function fC(i,e,t=!1){let n=i.pp_getComponents(vs);for(let o of n)t?o.material=e.clone():o.material=e}function TC(i){let e=i.pp_getComponents(vs);for(let t of e)t.material=t.material.clone()}function PC(i,e){let t=i.pp_getComponents(vs);for(let n of t)n.material.specularColor!=null&&(n.material.specularColor=e)}function CC(i,e){let t=i.pp_getComponents(vs);for(let n of t)n.material.fogColor!=null&&(n.material.fogColor=e)}var xs={setAlpha:_C,setObjectAlpha:gC,setObjectMaterial:fC,setObjectClonedMaterials:TC,setObjectSpecularColor:PC,setObjectFogColor:CC};import{TextComponent as yR}from"@wonderlandengine/api";function bC(i){let e=i.pp_getComponents(yR);for(let t of e)t.material=t.material.clone()}var uR={setClonedMaterials:bC};var kr=!1,Ms=null,em=!1,tm=!1,zn=!1;function SC(i){kr=i}function vC(){return kr}function xC(i){Ms=i}function MC(i){em=i}function DC(){return em}function EC(i){tm=i}function AC(){return tm}function RC(i){zn=i}function VC(){return zn}function OC(...i){try{kr&&(em&&console.log("Analytics data sent: "+i),Ms!=null?Ms(...i):zn&&console.error("You need to set the send analytics callback"))}catch(e){zn&&console.error(e)}}function IC(i,e=1){try{kr&&(tm&&console.log("Analytics event sent: "+i+" - Value: "+e),Ms!=null?Ms("event",i,{value:e}):zn&&console.error("You need to set the send analytics callback"))}catch(t){zn&&console.error(t)}}var hR={setAnalyticsEnabled:SC,isAnalyticsEnabled:vC,setSendAnalyticsCallback:xC,setDataLogEnabled:MC,isDataLogEnabled:DC,setEventsLogEnabled:EC,isEventsLogEnabled:AC,setErrorsLogEnabled:RC,isErrorsLogEnabled:VC,sendData:OC,sendEvent:IC};import{Component as cR,Property as BC}from"@wonderlandengine/api";var xo=class extends cR{static TypeName="pp-debug-transform";static Properties={_myLength:BC.float(.1),_myThickness:BC.float(.005)};start(){this._myStarted=!1,m.isDebugEnabled(this.engine)&&(this._myDebugVisualTransform=null,this._myDebugTransformParams=new At(this.engine),this._myDebugTransformParams.myLength=this._myLength,this._myDebugTransformParams.myThickness=this._myThickness,this._myDebugVisualTransform=new Mi(this._myDebugTransformParams),this._myDebugVisualTransform.setVisible(m.isDebugEnabled(this.engine)),this._myStarted=!0)}update(e){m.isDebugEnabled(this.engine)&&this._myStarted&&(this.object.pp_getTransform(this._myDebugTransformParams.myTransform),this._myDebugVisualTransform.paramsUpdated(),this._myDebugVisualTransform.setVisible(!0))}onDestroy(){this._myStarted&&this._myDebugVisualTransform.destroy()}};var Gn=class{constructor(e=m.getMainEngine()){this.myObjectsByReference=[],this.myObjectsByPath=[],this.myClassesByReference=[],this.myClassesByPath=[],this.myFunctionsByPath=[],this.myExcludeConstructors=!1,this.myExcludeJSObjectFunctions=!1,this.myFunctionNamesToInclude=[],this.myFunctionNamesToExclude=[],this.myFunctionPathsToInclude=[],this.myFunctionPathsToExclude=[],this.myObjectAddObjectDescendantsDepthLevel=0,this.myObjectAddClassDescendantsDepthLevel=0,this.myObjectNamesToInclude=[],this.myObjectNamesToExclude=[],this.myClassNamesToInclude=[],this.myClassNamesToExclude=[],this.myObjectPathsToInclude=[],this.myObjectPathsToExclude=[],this.myClassPathsToInclude=[],this.myClassPathsToExclude=[],this.myLogEnabled=!1,this.myEngine=e}},Nn=class{constructor(e=new Gn){this._myParams=e,this._myPropertiesAlreadyOverwritten=new Map}overwriteFunctions(){let e=this._getReferencesAndParents(this._myParams.myClassesByReference,this._myParams.myClassesByPath,!0),t=this._getReferencesAndParents(this._myParams.myObjectsByReference,this._myParams.myObjectsByPath,!1),n=this._getReferencesAndParents([],this._myParams.myFunctionsByPath,!1);this._objectAddDescendants(t,e);for(let o of e){let s=o[0],a=o[1],l=o[2],h=o[3],_=o[4];this._overwriteReferenceFunctions(s,a,l,h,_,!0)}for(let o of t){let s=o[0],a=o[1],l=o[2],h=o[3],_=o[4];this._overwriteReferenceFunctions(s,a,l,h,_,!1)}for(let o of n){let s=o[1],a=o[2],l=o[3];this._overwriteFunction(s,a,null,null,l,!1,!0)}}_getOverwrittenFunction(e,t,n,o,s){return Y.getObjectProperty(e,t)}_getOverwrittenConstructor(e,t,n,o,s){return Y.getObjectProperty(e,t)}_onOverwriteSuccess(e,t,n,o,s,a,l,h){}_onOverwriteFailure(e,t,n,o,s,a,l,h){}_overwriteReferenceFunctions(e,t,n,o,s,a){let l=this._myParams.myObjectPathsToInclude,h=this._myParams.myObjectPathsToExclude,_=this._myParams.myObjectNamesToInclude,y=this._myParams.myObjectNamesToExclude;a&&(l=this._myParams.myClassPathsToInclude,h=this._myParams.myClassPathsToExclude,_=this._myParams.myClassNamesToInclude,y=this._myParams.myClassNamesToExclude);let r=this._filterName(o,l,h),u=this._filterName(s,_,y);if(r&&u){let g=Y.getObjectPropertyNames(e);g.pp_hasEqual("constructor")&&g.unshift("constructor");for(let P of g){let C=null,f=null,S=null;if(a){let M=e;if(t!=null){let D=Object.getOwnPropertyDescriptor(t,n);D!=null&&D.value!=null&&(M=D.value)}if(C=M.prototype,C==null)C=M;else try{Y.getObjectProperty(C,P)==null&&(C=M)}catch{C=M}f=t,S=n}else C=e;this._overwriteFunction(C,P,f,S,o,a,!1)}}}_overwriteFunction(e,t,n,o,s,a,l){try{if(!(this._myPropertiesAlreadyOverwritten.get(t)!=null&&this._myPropertiesAlreadyOverwritten.get(t).pp_hasEqual(e))&&(Y.isFunctionByName(e,t)||t=="constructor"&&Y.isClassByName(e,t))&&(!this._myParams.myExcludeJSObjectFunctions||!this._isJSObjectFunction(t))){let _=this._filterName(t,this._myParams.myFunctionNamesToInclude,this._myParams.myFunctionNamesToExclude),y=this._filterName((s!=null?s+".":"")+t,this._myParams.myFunctionPathsToInclude,this._myParams.myFunctionPathsToExclude);if(_&&y){this._myPropertiesAlreadyOverwritten.has(t)||this._myPropertiesAlreadyOverwritten.set(t,[]);let r=!1,u=!1;if(t!="constructor")try{let g=this._getOverwrittenFunction(e,t,s,a,l);g!=Y.getObjectProperty(e,t)?r=Y.overwriteObjectProperty(g,e,t,!1,!0,this._myParams.myLogEnabled):r=!0}catch(g){r=!1,this._myParams.myLogEnabled&&console.error(g)}else if(!this._myParams.myExcludeConstructors&&a&&n!=null){let g=Y.getObjectProperty(n,o);if(g!=null&&g.prototype!=null){u=!0;try{let P=this._getOverwrittenConstructor(n,o,s,a,l);P!=g?(r=Y.overwriteObjectProperty(P,n,o,!1,!0,this._myParams.myLogEnabled),r&&(r=Y.overwriteObjectProperty(P,g.prototype,t,!1,!0,this._myParams.myLogEnabled))):r=!0}catch(P){r=!1,this._myParams.myLogEnabled&&console.error(P)}}}r?(this._myPropertiesAlreadyOverwritten.get(t).push(e),this._onOverwriteSuccess(e,t,n,o,s,a,l,u)):this._onOverwriteFailure(e,t,n,o,s,a,l,u)}}}catch(h){this._myParams.myLogEnabled&&console.error(h)}}_getReferencesAndParents(e,t,n){let o=[],s=(a,l)=>a[0]==l[0];for(let a of t){let l=a,h="",_=a,y="";a!=null&&Array.isArray(a)&&a.length!=null&&a.length==2&&typeof a[1]=="string"&&(l=a[0],_=a[1]),h=Y.getObjectNameFromPath(l),y=Y.getObjectNameFromPath(_);let r=Y.getObjectFromPath(l,m.getWindow(this._myParams.myEngine)),u=Y.getObjectParentFromPath(l,m.getWindow(this._myParams.myEngine));r!=null&&o.pp_pushUnique([r,u,h,_,y],s)}for(let a of e){let l=a,h="",_="",y="";a!=null&&a.length!=null&&a.length==2&&typeof a[1]=="string"?(l=a[0],_=a[1],y=Y.getObjectNameFromPath(_)):(_=n?l.name:null,y=n?l.name:null),n?h=l.name:h=Y.getObjectNameFromPath(_),l!=null&&o.pp_pushUnique([l,null,h,_,y],s)}return o}_objectAddDescendants(e,t){let n=(s,a)=>s[0]==a[0],o=[];for(let s of e)o.pp_pushUnique([s[0],0,s[3]],n);for(;o.length>0;){let s=o.shift(),a=s[0],l=s[1],h=s[2];if(l+1<=this._myParams.myObjectAddObjectDescendantsDepthLevel||this._myParams.myObjectAddObjectDescendantsDepthLevel==-1||l+1<=this._myParams.myObjectAddClassDescendantsDepthLevel||this._myParams.myObjectAddClassDescendantsDepthLevel==-1){let _=null;try{_=Y.getObjectPropertyNames(a)}catch{continue}for(let y of _){let r=null;try{if(r=Y.getObjectProperty(a,y),r==null)continue}catch{continue}let u="",g="";h!=null?(g=y,u=h+"."+g):(g=y,u=g);let P=Y.isClassByName(a,y),C=Y.isObjectByName(a,y),f=this._myParams.myObjectPathsToInclude,S=this._myParams.myObjectPathsToExclude,M=this._myParams.myObjectNamesToInclude,D=this._myParams.myObjectNamesToExclude;P&&(f=this._myParams.myClassPathsToInclude,S=this._myParams.myClassPathsToExclude,M=this._myParams.myClassNamesToInclude,D=this._myParams.myClassNamesToExclude);let v=this._filterName(u,f,S),b=this._filterName(y,M,D);v&&b&&(C&&(l+1<=this._myParams.myObjectAddObjectDescendantsDepthLevel||this._myParams.myObjectAddObjectDescendantsDepthLevel==-1)&&e.pp_pushUnique([r,a,y,u,g],n),P&&y!="constructor"&&(l+1<=this._myParams.myObjectAddClassDescendantsDepthLevel||this._myParams.myObjectAddClassDescendantsDepthLevel==-1)&&t.pp_pushUnique([r,a,y,u,g],n),C&&o.pp_pushUnique([r,l+1,u],n))}}}}_filterName(e,t,n){let o=t.length==0;for(let s of t)if(e.match(s)!=null){o=!0;break}if(o){for(let s of n)if(e.match(s)!=null){o=!1;break}}return o}_isJSObjectFunction(e){}};Nn.prototype._isJSObjectFunction=function(){let i=["__defineGetter__","__defineSetter__","hasOwnProperty","__lookupGetter__","__lookupSetter__","isPrototypeOf","propertyIsEnumerable","toString","valueOf","__proto__","toLocaleString","arguments","caller","apply","bind","call","callee"];return function(t){return i.pp_hasEqual(t)}}();var Wn=class extends Gn{constructor(){super(),this.myExecutionTimeAnalysisEnabled=!0,this.myAddPathPrefixToFunctionID=!0,this.myFilterDebugFunctionsPerformanceAnalyzerClasses=!0}},Un=class{constructor(){this.myReference=null,this.myName="",this.myPath="",this.myID="",this.myCallsCount=0,this.myTotalExecutionTime=0,this.myTotalExecutionTimePercentage=0,this.myAverageExecutionTime=0,this.myTimeElapsedSinceLastReset=0,this._myTotalExecutionTimeInternal=0}reset(){this.myCallsCount=0,this.myTotalExecutionTime=0,this.myTotalExecutionTimePercentage=0,this.myAverageExecutionTime=0,this.myTimeElapsedSinceLastReset=0,this._myTotalExecutionTimeInternal=0}max(e){this.myCallsCount=Math.max(this.myCallsCount,e.myCallsCount),this.myTotalExecutionTime=Math.max(this.myTotalExecutionTime,e.myTotalExecutionTime),this.myTotalExecutionTimePercentage=Math.max(this.myTotalExecutionTimePercentage,e.myTotalExecutionTimePercentage),this.myAverageExecutionTime=Math.max(this.myAverageExecutionTime,e.myAverageExecutionTime)}copy(e){this.myReference=e.myReference,this.myName=e.myName,this.myPath=e.myPath,this.myID=e.myID,this.myCallsCount=e.myCallsCount,this.myTotalExecutionTime=e.myTotalExecutionTime,this.myTotalExecutionTimePercentage=e.myTotalExecutionTimePercentage,this.myAverageExecutionTime=e.myAverageExecutionTime,this.myTimeElapsedSinceLastReset=e.myTimeElapsedSinceLastReset,this._myTotalExecutionTimeInternal=e._myTotalExecutionTimeInternal}},Lt={NONE:0,CALLS_COUNT:1,TOTAL_EXECUTION_TIME:2,AVERAGE_EXECUTION_TIME:3},Ds=class i extends Nn{constructor(e=new Wn){super(e),this._myFunctionPerformanceAnalysisResults=new Map,this._myFunctionPerformanceAnalysisMaxResults=new Map,this._myResultsAlreadyAdded=!1,this._myExecutionTimes={myOverheadExecutionTimeSinceLastReset:0,myLastFunctionExecutionTime:0,myOriginalFunctionOverheadExecutionTimes:[]},this._myTimeOfLastReset=m.getWindow(this._myParams.myEngine).performance.now(),this._myMaxTimeElapsedSinceLastReset=0;let t=Array.prototype.push,n=Array.prototype.pop;this._myExecutionTimes.myOriginalFunctionOverheadExecutionTimes.push=function(){return t.bind(this)(...arguments)},this._myExecutionTimes.myOriginalFunctionOverheadExecutionTimes.pop=function(){return n.bind(this)(...arguments)}}overwriteFunctions(){super.overwriteFunctions(),this.resetResults(),this.resetMaxResults()}getTimeElapsedSinceLastReset(){return m.getWindow(this._myParams.myEngine).performance.now()-this._myTimeOfLastReset-this._myExecutionTimes.myOverheadExecutionTimeSinceLastReset}getMaxTimeElapsedSinceLastReset(){return this._myMaxTimeElapsedSinceLastReset=Math.max(this._myMaxTimeElapsedSinceLastReset,this.getTimeElapsedSinceLastReset()),this._myMaxTimeElapsedSinceLastReset}resetResults(){this._updateDerivatesResults(),this._updateMaxResults();for(let e of this._myFunctionPerformanceAnalysisResults.keys())this._myFunctionPerformanceAnalysisResults.get(e).reset();this._myExecutionTimes.myOverheadExecutionTimeSinceLastReset=0,this._myTimeOfLastReset=m.getWindow(this._myParams.myEngine).performance.now()}resetMaxResults(){this._myMaxTimeElapsedSinceLastReset=0;for(let e of this._myFunctionPerformanceAnalysisMaxResults.keys())this._myFunctionPerformanceAnalysisMaxResults.get(e).reset()}getResults(e=Lt.NONE){this._updateDerivatesResults(),this._updateMaxResults();let t=this._myFunctionPerformanceAnalysisResults;return t=this._sortResults(t,e),t}getMaxResults(e=Lt.NONE){this._updateDerivatesResults(),this._updateMaxResults();let t=this._myFunctionPerformanceAnalysisMaxResults;return t=this._sortResults(t,e),t}_getOverwrittenFunction(e,t,n,o,s){return this._getOverwrittenFunctionInternal(e,t,n,o,s,!1)}_getOverwrittenConstructor(e,t,n,o,s){return this._getOverwrittenFunctionInternal(e,t,n,o,s,!0)}_onOverwriteSuccess(e,t,n,o,s,a,l,h){this._myResultsAlreadyAdded=!1}_onOverwriteFailure(e,t,n,o,s,a,l,h){if(this._myResultsAlreadyAdded){let _=this._getPropertyID(t,s,l,h);this._myFunctionPerformanceAnalysisResults.delete(_)}}_sortResults(e,t){let n=e;return t!=Lt.NONE&&(n=new Map([...e.entries()].sort(function(o,s){let a=0;return t==Lt.CALLS_COUNT?(a=-(o[1].myCallsCount-s[1].myCallsCount),a==0&&(a=-(o[1].myTotalExecutionTime-s[1].myTotalExecutionTime),a==0&&(a=-(o[1].myAverageExecutionTime-s[1].myAverageExecutionTime)))):t==Lt.TOTAL_EXECUTION_TIME?(a=-(o[1].myTotalExecutionTime-s[1].myTotalExecutionTime),a==0&&(a=-(o[1].myAverageExecutionTime-s[1].myAverageExecutionTime),a==0&&(a=-(o[1].myCallsCount-s[1].myCallsCount)))):(a=-(o[1].myAverageExecutionTime-s[1].myAverageExecutionTime),a==0&&(a=-(o[1].myTotalExecutionTime-s[1].myTotalExecutionTime),a==0&&(a=-(o[1].myCallsCount-s[1].myCallsCount)))),a}))),n}_getPropertyID(e,t,n,o){let s=o?"constructor":e;return t!=null&&this._myParams.myAddPathPrefixToFunctionID&&(n?s=t:s=t+"."+s),s}_updateDerivatesResults(){let e=this.getTimeElapsedSinceLastReset(),t=m.getWindow(this._myParams.myEngine).performance.now();for(let n of this._myFunctionPerformanceAnalysisResults.keys()){let o=this._myFunctionPerformanceAnalysisResults.get(n);e!=0?o.myTotalExecutionTimePercentage=o.myTotalExecutionTime/e:o.myCallsCount!=0?o.myTotalExecutionTimePercentage=1:o.myTotalExecutionTimePercentage=0,o.myCallsCount!=0?o.myAverageExecutionTime=o.myTotalExecutionTime/o.myCallsCount:o.myAverageExecutionTime=0,o.myTimeElapsedSinceLastReset=e}this._myExecutionTimes.myOverheadExecutionTimeSinceLastReset+=m.getWindow(this._myParams.myEngine).performance.now()-t}_updateMaxResults(){let e=m.getWindow(this._myParams.myEngine).performance.now();this._myMaxTimeElapsedSinceLastReset=Math.max(this._myMaxTimeElapsedSinceLastReset,this.getTimeElapsedSinceLastReset());for(let t of this._myFunctionPerformanceAnalysisResults.keys())if(this._myFunctionPerformanceAnalysisMaxResults.has(t))this._myFunctionPerformanceAnalysisMaxResults.get(t).max(this._myFunctionPerformanceAnalysisResults.get(t));else{let n=new Un;n.copy(this._myFunctionPerformanceAnalysisResults.get(t)),this._myFunctionPerformanceAnalysisMaxResults.set(t,n)}this._myExecutionTimes.myOverheadExecutionTimeSinceLastReset+=m.getWindow(this._myParams.myEngine).performance.now()-e}_getOverwrittenFunctionInternal(e,t,n,o,s,a){let l=Y.getObjectProperty(e,t);if((!this._myParams.myFilterDebugFunctionsPerformanceAnalyzerClasses||!this._isPerformanceAnalyzer(e,t,o))&&t!="_myPerformanceAnalyzerOriginalFunction"){let h=this._getPropertyID(t,n,s,a);this._myResultsAlreadyAdded=this._myFunctionPerformanceAnalysisResults.has(h);let _=new Un;_.myReference=e,_.myName=t,_.myPath=n,_.myID=n,this._myFunctionPerformanceAnalysisResults.set(h,_);try{let y=m.getWindow(this._myParams.myEngine),r=this._myFunctionPerformanceAnalysisResults.get(h),u=this._myExecutionTimes,g=e[t],P=175e-6,C=35e-5,f=this._myParams.myExecutionTimeAnalysisEnabled;a?l=function(){let S=y.performance.now(),M=null,D,v=0,b=0,x=0,I=0,L=0,k=0,U=0;if(f){u.myOriginalFunctionOverheadExecutionTimes.push(0),v=y.performance.now(),b=y.performance.now();try{v=y.performance.now(),D=new g(...arguments),b=y.performance.now()}catch(ye){b=y.performance.now(),M=ye}}else try{D=new g(...arguments)}catch(ye){M=ye}if(r.myCallsCount+=1,f&&(x=u.myOriginalFunctionOverheadExecutionTimes.pop(),I=b-v-x,L=I-P,g._myPerformanceAnalyzerHasBeenOverwritten&&(L=u.myLastFunctionExecutionTime),r._myTotalExecutionTimeInternal+=L,r.myTotalExecutionTime=Math.max(0,r._myTotalExecutionTimeInternal),u.myLastFunctionExecutionTime=L,k=v-S,U=k-b-C,u.myOriginalFunctionOverheadExecutionTimes.length>0&&(u.myOriginalFunctionOverheadExecutionTimes[u.myOriginalFunctionOverheadExecutionTimes.length-1]+=U+x+C*2.75,u.myOriginalFunctionOverheadExecutionTimes[u.myOriginalFunctionOverheadExecutionTimes.length-1]+=y.performance.now()),u.myOverheadExecutionTimeSinceLastReset+=U,u.myOverheadExecutionTimeSinceLastReset+=y.performance.now()),M!=null)throw M;return D}:l=function(){let S=y.performance.now(),M=null,D,v=null,b=0,x=0,I=0,L=0,k=0,U=0,ye=0;if(f){u.myOriginalFunctionOverheadExecutionTimes.push(0),b=y.performance.now(),x=y.performance.now();try{v=g.bind(this),b=y.performance.now(),D=v(...arguments),x=y.performance.now()}catch(le){x=y.performance.now(),M=le}}else try{v=g.bind(this),D=v(...arguments)}catch(le){M=le}if(r.myCallsCount+=1,f&&(I=u.myOriginalFunctionOverheadExecutionTimes.pop(),L=x-b-I,k=L-P,g._myPerformanceAnalyzerHasBeenOverwritten&&(k=u.myLastFunctionExecutionTime),r._myTotalExecutionTimeInternal+=k,r.myTotalExecutionTime=Math.max(0,r._myTotalExecutionTimeInternal),u.myLastFunctionExecutionTime=k,U=b-S,ye=U-x-C,u.myOriginalFunctionOverheadExecutionTimes.length>0&&(u.myOriginalFunctionOverheadExecutionTimes[u.myOriginalFunctionOverheadExecutionTimes.length-1]+=ye+I+C*2.75,u.myOriginalFunctionOverheadExecutionTimes[u.myOriginalFunctionOverheadExecutionTimes.length-1]+=y.performance.now()),u.myOverheadExecutionTimeSinceLastReset+=ye,u.myOverheadExecutionTimeSinceLastReset+=y.performance.now()),M!=null)throw M;return D},l!=null&&(Object.defineProperty(l,"_myPerformanceAnalyzerHasBeenOverwritten",{value:!0,enumerable:!1,configurable:!1,writable:!1}),Object.defineProperty(l,"_myPerformanceAnalyzerOriginalFunction",{value:g,enumerable:!1,configurable:!1,writable:!1}))}catch(y){this._myParams.myLogEnabled&&console.error("Function:",t,"of:",e,`can't be overwritten.
Error:`,y)}}return l}_isPerformanceAnalyzer(e,t,n){let o=!1;return n&&(e==i.prototype||e==Un.prototype)&&(o=!0),o}};var Es=class{constructor(){this.myPerformanceAnalyzer=null,this.myLogTitle="Functions Performance Analysis Results",this.mySecondsBetweenLogs=1,this.myLogFunction="log",this.myFormatLog=!0,this.myFormatLogIndentationCharacter="-",this.myLogMaxResults=!1,this.myLogSortOrder=Lt.NONE,this.myLogMaxAmountOfFunctions=null,this.myLogFunctionsWithCallsCountAbove=null,this.myLogFunctionsWithTotalExecutionTimePercentageAbove=null,this.myLogCallsCountResults=!1,this.myLogTotalExecutionTimeResults=!1,this.myLogTotalExecutionTimePercentageResults=!1,this.myLogAverageExecutionTimeResults=!1,this.myClearConsoleBeforeLog=!1}},As=class{constructor(e){this._myParams=e,this._myLogTimer=new te(this._myParams.mySecondsBetweenLogs),this._myMaxNameLength=0,this._myMaxCallsCountLength=0,this._myMaxTotalExecutionTimeLength=0,this._myMaxTotalExecutionTimePercentageLength=0,this._myMaxAverageExecutionTimeLength=0}update(e){if(this._myParams.myPerformanceAnalyzer!=null&&(this._myLogTimer.update(e),this._myLogTimer.isDone())){this._myLogTimer.start();let t=this._myParams.myPerformanceAnalyzer.getTimeElapsedSinceLastReset();this._myParams.myLogMaxResults&&(t=this._myParams.myPerformanceAnalyzer.getMaxTimeElapsedSinceLastReset());let n=null;if(this._myParams.myLogMaxResults?n=this._myParams.myPerformanceAnalyzer.getMaxResults(this._myParams.myLogSortOrder):n=this._myParams.myPerformanceAnalyzer.getResults(this._myParams.myLogSortOrder),this._myParams.myLogFunctionsWithCallsCountAbove!=null){let a=new Map(n);n=new Map;let l=[...a.keys()];for(let h=0;h<l.length;h++){let _=a.get(l[h]);_.myCallsCount>this._myParams.myLogFunctionsWithCallsCountAbove&&n.set(l[h],_)}}if(this._myParams.myLogFunctionsWithTotalExecutionTimePercentageAbove!=null){let a=new Map(n);n=new Map;let l=[...a.keys()];for(let h=0;h<l.length;h++){let _=a.get(l[h]);_.myTotalExecutionTimePercentage*100>this._myParams.myLogFunctionsWithTotalExecutionTimePercentageAbove&&n.set(l[h],_)}}if(this._myParams.myLogMaxAmountOfFunctions!=null){let a=new Map(n);n=new Map;let l=[...a.keys()];for(let h=0;h<this._myParams.myLogMaxAmountOfFunctions&&h<l.length;h++){let _=a.get(l[h]);n.set(l[h],_)}}this._myParams.myClearConsoleBeforeLog&&console.clear();let o=new Map;for(let a of n.keys()){let l=n.get(a),h={};this._myParams.myLogCallsCountResults&&(h.myCallsCount=l.myCallsCount),this._myParams.myLogTotalExecutionTimeResults&&(h.myTotalExecutionTime=l.myTotalExecutionTime),this._myParams.myLogTotalExecutionTimePercentageResults&&(h.myTotalExecutionTimePercentage=l.myTotalExecutionTimePercentage),this._myParams.myLogAverageExecutionTimeResults&&(h.myAverageExecutionTime=l.myAverageExecutionTime),o.set(a,h)}let s="";for(let a of n.entries()){let l=a[0],h=a[1];this._myMaxNameLength=Math.max(this._myMaxNameLength,l.length),this._myMaxCallsCountLength=Math.max(this._myMaxCallsCountLength,h.myCallsCount.toFixed(0).length),this._myMaxTotalExecutionTimeLength=Math.max(this._myMaxTotalExecutionTimeLength,h.myTotalExecutionTime.toFixed(5).length),this._myMaxTotalExecutionTimePercentageLength=Math.max(this._myMaxTotalExecutionTimePercentageLength,(h.myTotalExecutionTimePercentage*100).toFixed(2).length),this._myMaxAverageExecutionTimeLength=Math.max(this._myMaxAverageExecutionTimeLength,h.myAverageExecutionTime.toFixed(5).length)}for(let a of n.entries()){let l=a[0],h=a[1],_=0;this._myParams.myLogCallsCountResults&&_++,this._myParams.myLogTotalExecutionTimeResults&&_++,this._myParams.myLogTotalExecutionTimePercentageResults&&_++,this._myParams.myLogAverageExecutionTimeResults&&_++;let y=[],r=_>1?"Calls Count: ":"";if(this._myParams.myFormatLog)for(let f=0;f<this._myMaxCallsCountLength-h.myCallsCount.toFixed(0).length;f++)r+=" ";r+=h.myCallsCount.toFixed(0);let u=_>1?"Total Time: ":"";if(this._myParams.myFormatLog)for(let f=0;f<this._myMaxTotalExecutionTimeLength-h.myTotalExecutionTime.toFixed(5).length;f++)u+=" ";u+=h.myTotalExecutionTime.toFixed(5)+"ms";let g=_>1?"Total Time: ":"";if(this._myParams.myFormatLog)for(let f=0;f<this._myMaxTotalExecutionTimePercentageLength-(h.myTotalExecutionTimePercentage*100).toFixed(2).length;f++)g+=" ";g+=(h.myTotalExecutionTimePercentage*100).toFixed(2)+"%";let P=_>1?"Average Time: ":"";if(this._myParams.myFormatLog)for(let f=0;f<this._myMaxAverageExecutionTimeLength-h.myAverageExecutionTime.toFixed(5).length;f++)P+=" ";switch(P+=h.myAverageExecutionTime.toFixed(5)+"ms",this._myParams.myLogCallsCountResults||(r=null),this._myParams.myLogTotalExecutionTimeResults||(u=null),this._myParams.myLogTotalExecutionTimePercentageResults||(g=null),this._myParams.myLogAverageExecutionTimeResults||(P=null),this._myParams.myLogSortOrder){case Lt.CALLS_COUNT:y.push(r),y.push(u),y.push(g),y.push(P);break;case Lt.TOTAL_EXECUTION_TIME:y.push(u),y.push(g),y.push(P),y.push(r);break;case Lt.AVERAGE_EXECUTION_TIME:y.push(P),y.push(u),y.push(g),y.push(r);break;default:y.push(r),y.push(u),y.push(g),y.push(P)}if(s+=`
`,this._myParams.myFormatLog){let f=l+" ";for(;f.length<this._myMaxNameLength+1;)f+=this._myParams.myFormatLogIndentationCharacter;f+=this._myParams.myFormatLogIndentationCharacter+" ",s+=f}else s+=l+" - ";let C=!0;for(let f of y)f!=null&&(C?C=!1:s+=" - ",s+=f)}this._myParams.myLogTotalExecutionTimeResults||this._myParams.myLogTotalExecutionTimePercentageResults||this._myParams.myLogAverageExecutionTimeResults?console[this._myParams.myLogFunction](`
`+this._myParams.myLogTitle,`

Total Time:`,t.toFixed(5),`ms
`,s):console[this._myParams.myLogFunction](`
`+this._myParams.myLogTitle,`
`,s)}}};import{Component as pR,Property as Se}from"@wonderlandengine/api";var mt=class extends pR{static TypeName="pp-debug-functions-performance-analyzer";static Properties={_myObjectsByPath:Se.string(""),_myClassesByPath:Se.string(""),_myFunctionsByPath:Se.string(""),_myDelayStart:Se.float(0),_myLogTitle:Se.string("Functions Performance Analysis Results"),_myLogFunction:Se.enum(["Log","Error","Warn","Debug"],"Log"),_mySecondsBetweenLogs:Se.float(1),_myLogMaxResults:Se.bool(!1),_myLogSortOrder:Se.enum(["None","Calls Count","Total Execution Time","Average Execution Time"],"None"),_myLogCallsCountResults:Se.bool(!0),_myLogTotalExecutionTimeResults:Se.bool(!0),_myLogTotalExecutionTimePercentageResults:Se.bool(!0),_myLogAverageExecutionTimeResults:Se.bool(!0),_myLogMaxAmountOfFunctions:Se.int(-1),_myLogFunctionsWithCallsCountAbove:Se.int(-1),_myLogFunctionsWithTotalExecutionTimePercentageAbove:Se.float(-1),_myFunctionPathsToInclude:Se.string(""),_myFunctionPathsToExclude:Se.string(""),_myExcludeConstructors:Se.bool(!1),_myExcludeJSObjectFunctions:Se.bool(!0),_myAddPathPrefixToFunctionID:Se.bool(!0),_myObjectAddObjectDescendantsDepthLevel:Se.int(0),_myObjectAddClassDescendantsDepthLevel:Se.int(0),_myClearConsoleBeforeLog:Se.bool(!1),_myResetMaxResultsShortcutEnabled:Se.bool(!1),_myClassesByReference:Se.enum(["Code Driven"],"Code Driven"),_myObjectsByReference:Se.enum(["Code Driven"],"Code Driven")};init(){this._myActive=!1,m.isDebugEnabled(this.engine)&&(this._myActive=!0,this._myFunctionsPerformanceAnalyzer=null,this._myFunctionsPerformanceAnalysisResultsLogger=null,this._mySkipFirstUpdate=!0,this._myStartTimer=new te(this._myDelayStart),this._myDelayStart==0&&(this._myStartTimer.end(),this._mySkipFirstUpdate=!1,this._start()))}update(e){if(this._myActive){if(this._mySkipFirstUpdate){this._mySkipFirstUpdate=!1;return}this._myStartTimer.isRunning()?(this._myStartTimer.update(e),this._myStartTimer.isDone()&&this._start()):(this._myFunctionsPerformanceAnalysisResultsLogger.update(e),this._myFunctionsPerformanceAnalyzer.resetResults()),this._myResetMaxResultsShortcutEnabled&&m.getLeftGamepad(this.engine).getButtonInfo(E.SELECT).isPressEnd(3)&&this._myFunctionsPerformanceAnalyzer.resetMaxResults()}}_start(){let e=new Wn(this.engine);if(this._myObjectsByPath.length>0){let n=[...this._myObjectsByPath.split(",")];for(let o=0;o<n.length;o++)n[o]=n[o].trim();e.myObjectsByPath.push(...n)}if(this._myClassesByPath.length>0){let n=[...this._myClassesByPath.split(",")];for(let o=0;o<n.length;o++)n[o]=n[o].trim();e.myClassesByPath.push(...n)}if(this._myFunctionsByPath.length>0){let n=[...this._myFunctionsByPath.split(",")];for(let o=0;o<n.length;o++)n[o]=n[o].trim();e.myFunctionsByPath.push(...n)}if(e.myExcludeConstructors=this._myExcludeConstructors,e.myExcludeJSObjectFunctions=this._myExcludeJSObjectFunctions,e.myAddPathPrefixToFunctionID=this._myAddPathPrefixToFunctionID,this._myFunctionPathsToInclude.length>0){let n=[...this._myFunctionPathsToInclude.split(",")];for(let o=0;o<n.length;o++)n[o]=n[o].trim();e.myFunctionPathsToInclude.push(...n)}if(this._myFunctionPathsToExclude.length>0){let n=[...this._myFunctionPathsToExclude.split(",")];for(let o=0;o<n.length;o++)n[o]=n[o].trim();e.myFunctionPathsToExclude.push(...n)}e.myObjectAddObjectDescendantsDepthLevel=this._myObjectAddObjectDescendantsDepthLevel,e.myObjectAddClassDescendantsDepthLevel=this._myObjectAddClassDescendantsDepthLevel,e.myExecutionTimeAnalysisEnabled=this._myLogTotalExecutionTimeResults||this._myLogTotalExecutionTimePercentageResults||this._myLogAverageExecutionTimeResults,e.myClassesByReference=this._myClassesByReference!=0?this._myClassesByReference:[],e.myObjectsByReference=this._myObjectsByReference!=0?this._myObjectsByReference:[],this._myFunctionsPerformanceAnalyzer=new Ds(e),this._myFunctionsPerformanceAnalyzer.overwriteFunctions();let t=new Es;t.myPerformanceAnalyzer=this._myFunctionsPerformanceAnalyzer,t.myLogTitle=this._myLogTitle,t.mySecondsBetweenLogs=this._mySecondsBetweenLogs,t.myLogFunction=["log","error","warn","debug"][this._myLogFunction],t.myLogMaxAmountOfFunctions=this._myLogMaxAmountOfFunctions>=0?this._myLogMaxAmountOfFunctions:null,t.myLogFunctionsWithCallsCountAbove=this._myLogFunctionsWithCallsCountAbove>=0?this._myLogFunctionsWithCallsCountAbove:null,t.myLogFunctionsWithTotalExecutionTimePercentageAbove=this._myLogFunctionsWithTotalExecutionTimePercentageAbove>=0?this._myLogFunctionsWithTotalExecutionTimePercentageAbove:null,t.myLogMaxResults=this._myLogMaxResults,t.myClearConsoleBeforeLog=this._myClearConsoleBeforeLog,t.myLogSortOrder=this._myLogSortOrder,t.myLogCallsCountResults=this._myLogCallsCountResults,t.myLogTotalExecutionTimeResults=this._myLogTotalExecutionTimeResults,t.myLogTotalExecutionTimePercentageResults=this._myLogTotalExecutionTimePercentageResults,t.myLogAverageExecutionTimeResults=this._myLogAverageExecutionTimeResults,this._myFunctionsPerformanceAnalysisResultsLogger=new As(t)}};import{Component as dR,Property as Ye}from"@wonderlandengine/api";var Mo=class extends dR{static TypeName="pp-debug-pp-functions-performance-analyzer";static Properties={_myDelayStart:Ye.float(0),_myLogFunction:Ye.enum(["Log","Error","Warn","Debug"],"Log"),_mySecondsBetweenLogs:Ye.float(1),_myLogMaxResults:Ye.bool(!1),_myLogSortOrder:Ye.enum(["None","Calls Count","Total Execution Time","Average Execution Time"],"None"),_myLogCallsCountResults:Ye.bool(!0),_myLogTotalExecutionTimeResults:Ye.bool(!0),_myLogTotalExecutionTimePercentageResults:Ye.bool(!0),_myLogAverageExecutionTimeResults:Ye.bool(!0),_myLogMaxAmountOfFunctions:Ye.int(-1),_myLogFunctionsWithCallsCountAbove:Ye.int(-1),_myLogFunctionsWithTotalExecutionTimePercentageAbove:Ye.float(-1),_myFunctionPathsToInclude:Ye.string(""),_myFunctionPathsToExclude:Ye.string(""),_myExcludeConstructors:Ye.bool(!1),_myClearConsoleBeforeLog:Ye.bool(!1),_myResetMaxResultsShortcutEnabled:Ye.bool(!1)};init(){this.object.pp_addComponent(mt,{_myObjectsByPath:"PP",_myDelayStart:this._myDelayStart,_myLogTitle:"PP Functions Performance Analysis Results",_myLogFunction:this._myLogFunction,_mySecondsBetweenLogs:this._mySecondsBetweenLogs,_myLogMaxResults:this._myLogMaxResults,_myLogSortOrder:this._myLogSortOrder,_myLogMaxAmountOfFunctions:this._myLogMaxAmountOfFunctions,_myLogFunctionsWithCallsCountAbove:this._myLogFunctionsWithCallsCountAbove,_myLogFunctionsWithTotalExecutionTimePercentageAbove:this._myLogFunctionsWithTotalExecutionTimePercentageAbove,_myLogCallsCountResults:this._myLogCallsCountResults,_myLogTotalExecutionTimeResults:this._myLogTotalExecutionTimeResults,_myLogTotalExecutionTimePercentageResults:this._myLogTotalExecutionTimePercentageResults,_myLogAverageExecutionTimeResults:this._myLogAverageExecutionTimeResults,_myFunctionPathsToInclude:this._myFunctionPathsToInclude,_myFunctionPathsToExclude:this._myFunctionPathsToExclude,_myExcludeConstructors:this._myExcludeConstructors,_myExcludeJSObjectFunctions:!0,_myAddPathPrefixToFunctionID:!0,_myObjectAddObjectDescendantsDepthLevel:1,_myObjectAddClassDescendantsDepthLevel:1,_myClearConsoleBeforeLog:this._myClearConsoleBeforeLog,_myResetMaxResultsShortcutEnabled:this._myResetMaxResultsShortcutEnabled})}};import{Component as _R,Property as Ne}from"@wonderlandengine/api";var Do=class extends _R{static TypeName="pp-debug-array-functions-performance-analyzer";static Properties={_myIncludeOnlyMainArrayTypes:Ne.bool(!0),_myIncludeOnlyArrayExtensionFunctions:Ne.bool(!1),_myDelayStart:Ne.float(0),_myLogFunction:Ne.enum(["Log","Error","Warn","Debug"],"Log"),_mySecondsBetweenLogs:Ne.float(1),_myLogMaxResults:Ne.bool(!1),_myLogSortOrder:Ne.enum(["None","Calls Count","Total Execution Time","Average Execution Time"],"None"),_myLogCallsCountResults:Ne.bool(!0),_myLogTotalExecutionTimeResults:Ne.bool(!0),_myLogTotalExecutionTimePercentageResults:Ne.bool(!0),_myLogAverageExecutionTimeResults:Ne.bool(!0),_myLogMaxAmountOfFunctions:Ne.int(-1),_myLogFunctionsWithCallsCountAbove:Ne.int(-1),_myLogFunctionsWithTotalExecutionTimePercentageAbove:Ne.float(-1),_myFunctionPathsToInclude:Ne.string(""),_myFunctionPathsToExclude:Ne.string(""),_myExcludeConstructors:Ne.bool(!1),_myClearConsoleBeforeLog:Ne.bool(!1),_myResetMaxResultsShortcutEnabled:Ne.bool(!1)};init(){let e="Array, Uint8ClampedArray, Uint8Array, Uint16Array, Uint32Array, Int8Array, Int16Array, Int32Array, Float32Array, Float64Array";this._myIncludeOnlyMainArrayTypes&&(e="Array, Uint8Array, Uint16Array, Float32Array"),this.object.pp_addComponent(mt,{_myClassesByPath:e,_myDelayStart:this._myDelayStart,_myLogTitle:"Array Functions Performance Analysis Results",_myLogFunction:this._myLogFunction,_mySecondsBetweenLogs:this._mySecondsBetweenLogs,_myLogMaxResults:this._myLogMaxResults,_myLogSortOrder:this._myLogSortOrder,_myLogMaxAmountOfFunctions:this._myLogMaxAmountOfFunctions,_myLogFunctionsWithCallsCountAbove:this._myLogFunctionsWithCallsCountAbove,_myLogFunctionsWithTotalExecutionTimePercentageAbove:this._myLogFunctionsWithTotalExecutionTimePercentageAbove,_myLogCallsCountResults:this._myLogCallsCountResults,_myLogTotalExecutionTimeResults:this._myLogTotalExecutionTimeResults,_myLogTotalExecutionTimePercentageResults:this._myLogTotalExecutionTimePercentageResults,_myLogAverageExecutionTimeResults:this._myLogAverageExecutionTimeResults,_myFunctionPathsToInclude:this._myFunctionPathsToInclude+(this._myFunctionPathsToInclude.length>0&&this._myIncludeOnlyArrayExtensionFunctions?", ":"")+(this._myIncludeOnlyArrayExtensionFunctions?"pp_, vec_, vec2_, vec3_, vec4_, quat_, quat2_, mat3_, mat4_, _pp_, _vec_, _quat_":""),_myFunctionPathsToExclude:this._myFunctionPathsToExclude,_myExcludeConstructors:this._myExcludeConstructors,_myExcludeJSObjectFunctions:!0,_myAddPathPrefixToFunctionID:!0,_myClearConsoleBeforeLog:this._myClearConsoleBeforeLog,_myResetMaxResultsShortcutEnabled:this._myResetMaxResultsShortcutEnabled})}};import{Component as gR,Property as Tt}from"@wonderlandengine/api";var Eo=class extends gR{static TypeName="pp-debug-pp-array-creation-performance-analyzer";static Properties={_myDelayStart:Tt.float(0),_myLogFunction:Tt.enum(["Log","Error","Warn","Debug"],"Log"),_mySecondsBetweenLogs:Tt.float(1),_myLogMaxResults:Tt.bool(!1),_myLogSortOrder:Tt.enum(["None","Calls Count","Total Execution Time","Average Execution Time"],"None"),_myLogCallsCountResults:Tt.bool(!0),_myLogTotalExecutionTimeResults:Tt.bool(!0),_myLogTotalExecutionTimePercentageResults:Tt.bool(!0),_myLogAverageExecutionTimeResults:Tt.bool(!0),_myLogMaxAmountOfFunctions:Tt.int(-1),_myLogFunctionsWithCallsCountAbove:Tt.int(-1),_myLogFunctionsWithTotalExecutionTimePercentageAbove:Tt.float(-1),_myClearConsoleBeforeLog:Tt.bool(!1),_myResetMaxResultsShortcutEnabled:Tt.bool(!1)};init(){this.object.pp_addComponent(mt,{_myObjectsByReference:[[nt,"Vec2Utils"],[d,"Vec3Utils"],[Nt,"Vec4Utils"],[T,"QuatUtils"],[V,"Quat2Utils"],[K,"Mat3Utils"],[R,"Mat4Utils"]],_myDelayStart:this._myDelayStart,_myLogTitle:"PP Array Creation Performance Analysis Results",_myLogFunction:this._myLogFunction,_mySecondsBetweenLogs:this._mySecondsBetweenLogs,_myLogMaxResults:this._myLogMaxResults,_myLogSortOrder:this._myLogSortOrder,_myLogMaxAmountOfFunctions:this._myLogMaxAmountOfFunctions,_myLogFunctionsWithCallsCountAbove:this._myLogFunctionsWithCallsCountAbove,_myLogFunctionsWithTotalExecutionTimePercentageAbove:this._myLogFunctionsWithTotalExecutionTimePercentageAbove,_myLogCallsCountResults:this._myLogCallsCountResults,_myLogTotalExecutionTimeResults:this._myLogTotalExecutionTimeResults,_myLogTotalExecutionTimePercentageResults:this._myLogTotalExecutionTimePercentageResults,_myLogAverageExecutionTimeResults:this._myLogAverageExecutionTimeResults,_myFunctionPathsToInclude:"create",_myExcludeConstructors:!0,_myExcludeJSObjectFunctions:!0,_myAddPathPrefixToFunctionID:!0,_myClearConsoleBeforeLog:this._myClearConsoleBeforeLog,_myResetMaxResultsShortcutEnabled:this._myResetMaxResultsShortcutEnabled})}};import{Component as fR,Property as $e}from"@wonderlandengine/api";var Ao=class extends fR{static TypeName="pp-debug-wl-functions-performance-analyzer";static Properties={_myDelayStart:$e.float(0),_myLogFunction:$e.enum(["Log","Error","Warn","Debug"],"Log"),_mySecondsBetweenLogs:$e.float(1),_myLogMaxResults:$e.bool(!1),_myLogSortOrder:$e.enum(["None","Calls Count","Total Execution Time","Average Execution Time"],"None"),_myLogCallsCountResults:$e.bool(!0),_myLogTotalExecutionTimeResults:$e.bool(!0),_myLogTotalExecutionTimePercentageResults:$e.bool(!0),_myLogAverageExecutionTimeResults:$e.bool(!0),_myLogMaxAmountOfFunctions:$e.int(-1),_myLogFunctionsWithCallsCountAbove:$e.int(-1),_myLogFunctionsWithTotalExecutionTimePercentageAbove:$e.float(-1),_myFunctionPathsToInclude:$e.string(""),_myFunctionPathsToExclude:$e.string(""),_myExcludeConstructors:$e.bool(!1),_myClearConsoleBeforeLog:$e.bool(!1),_myResetMaxResultsShortcutEnabled:$e.bool(!1)};init(){this.object.pp_addComponent(mt,{_myObjectsByPath:"WL",_myDelayStart:this._myDelayStart,_myLogTitle:"WL Functions Performance Analysis Results",_myLogFunction:this._myLogFunction,_mySecondsBetweenLogs:this._mySecondsBetweenLogs,_myLogMaxResults:this._myLogMaxResults,_myLogSortOrder:this._myLogSortOrder,_myLogMaxAmountOfFunctions:this._myLogMaxAmountOfFunctions,_myLogFunctionsWithCallsCountAbove:this._myLogFunctionsWithCallsCountAbove,_myLogFunctionsWithTotalExecutionTimePercentageAbove:this._myLogFunctionsWithTotalExecutionTimePercentageAbove,_myLogCallsCountResults:this._myLogCallsCountResults,_myLogTotalExecutionTimeResults:this._myLogTotalExecutionTimeResults,_myLogTotalExecutionTimePercentageResults:this._myLogTotalExecutionTimePercentageResults,_myLogAverageExecutionTimeResults:this._myLogAverageExecutionTimeResults,_myFunctionPathsToInclude:this._myFunctionPathsToInclude,_myFunctionPathsToExclude:this._myFunctionPathsToExclude,_myExcludeConstructors:this._myExcludeConstructors,_myExcludeJSObjectFunctions:!0,_myAddPathPrefixToFunctionID:!0,_myObjectAddObjectDescendantsDepthLevel:1,_myObjectAddClassDescendantsDepthLevel:1,_myClearConsoleBeforeLog:this._myClearConsoleBeforeLog,_myResetMaxResultsShortcutEnabled:this._myResetMaxResultsShortcutEnabled})}};import{AnimationComponent as TR,CollisionComponent as PR,Component as CR,InputComponent as bR,LightComponent as SR,MeshComponent as vR,PhysXComponent as xR,Property as we,TextComponent as MR,ViewComponent as DR}from"@wonderlandengine/api";var Ro=class extends CR{static TypeName="pp-debug-wl-components-functions-performance-analyzer";static Properties={_myAnalyzeComponentTypes:we.bool(!0),_myAnalyzeComponentInstances:we.bool(!1),_myComponentInstanceID:we.enum(["Object ID","Object Name","Object ID - Object Name"],"Object ID - Object Name"),_myDelayStart:we.float(0),_myLogFunction:we.enum(["Log","Error","Warn","Debug"],"Log"),_mySecondsBetweenLogs:we.float(1),_myLogMaxResults:we.bool(!1),_myLogSortOrder:we.enum(["None","Calls Count","Total Execution Time","Average Execution Time"],"None"),_myLogCallsCountResults:we.bool(!0),_myLogTotalExecutionTimeResults:we.bool(!0),_myLogTotalExecutionTimePercentageResults:we.bool(!0),_myLogAverageExecutionTimeResults:we.bool(!0),_myLogMaxAmountOfFunctions:we.int(-1),_myLogFunctionsWithCallsCountAbove:we.int(-1),_myLogFunctionsWithTotalExecutionTimePercentageAbove:we.float(-1),_myFunctionPathsToInclude:we.string(""),_myFunctionPathsToExclude:we.string(""),_myExcludeConstructors:we.bool(!1),_myClearConsoleBeforeLog:we.bool(!1),_myResetMaxResultsShortcutEnabled:we.bool(!1)};init(){this._myStartTimer=new te(this._myDelayStart),this._myDelayStart==0&&(this._myStartTimer.end(),this._start())}update(e){this._myStartTimer.isRunning()&&(this._myStartTimer.update(e),this._myStartTimer.isDone()&&this._start())}_start(){let e=[],t=[];this._myAnalyzeComponentInstances&&this._addComponentInstanceReferences(e),this._myAnalyzeComponentTypes&&this._addComponentTypeReferences(t),this._myAnalyzerComponent=this.object.pp_addComponent(mt,{_myObjectsByReference:e,_myClassesByReference:t,_myDelayStart:0,_myLogTitle:"WL Components Performance Analysis Results",_myLogFunction:this._myLogFunction,_mySecondsBetweenLogs:this._mySecondsBetweenLogs,_myLogMaxResults:this._myLogMaxResults,_myLogSortOrder:this._myLogSortOrder,_myLogMaxAmountOfFunctions:this._myLogMaxAmountOfFunctions,_myLogFunctionsWithCallsCountAbove:this._myLogFunctionsWithCallsCountAbove,_myLogFunctionsWithTotalExecutionTimePercentageAbove:this._myLogFunctionsWithTotalExecutionTimePercentageAbove,_myLogCallsCountResults:this._myLogCallsCountResults,_myLogTotalExecutionTimeResults:this._myLogTotalExecutionTimeResults,_myLogTotalExecutionTimePercentageResults:this._myLogTotalExecutionTimePercentageResults,_myLogAverageExecutionTimeResults:this._myLogAverageExecutionTimeResults,_myFunctionPathsToInclude:this._myFunctionPathsToInclude,_myFunctionPathsToExclude:this._myFunctionPathsToExclude,_myExcludeConstructors:this._myExcludeConstructors,_myExcludeJSObjectFunctions:!0,_myAddPathPrefixToFunctionID:!0,_myObjectAddClassDescendantsDepthLevel:0,_myClearConsoleBeforeLog:this._myClearConsoleBeforeLog,_myResetMaxResultsShortcutEnabled:this._myResetMaxResultsShortcutEnabled})}_addComponentTypeReferences(e){let t=[TR,PR,bR,SR,vR,xR,MR,DR];for(let n of t)e.push([n.prototype,'{"'+n.TypeName+'"}']);for(let n of j.getJavascriptComponentClassesByIndex(this.engine))e.push([n.prototype,'{"'+n.TypeName+'"}'])}_addComponentInstanceReferences(e){for(let t of j.getJavascriptComponentInstances(this.engine)){let n="";switch(this._myComponentInstanceID){case 0:n=t.object.pp_getID();break;case 1:n=t.object.pp_getName();break;case 2:n=t.object.pp_getID(),t.object.pp_getName().length>0&&(n=n+" - "+t.object.pp_getName());break}e.push([t,'{"'+t.type+'"}['+n+"]"])}}};var Yi=class{constructor(){this.myStartFlyingForward=!1,this.myStartFlyingRight=!1,this.myAutoUpdateFlyForward=!1,this.myAutoUpdateFlyRight=!1,this.myResetFlyForwardWhenZero=!1,this.myResetFlyRightWhenZero=!1,this.myMinAngleToFlyForwardUp=90,this.myMinAngleToFlyForwardDown=90,this.myMinAngleToFlyRightUp=90,this.myMinAngleToFlyRightDown=90,this.myAdjustForwardWhenCloseToUp=!0,this.myAdjustRightWhenCloseToUp=!0,this.myAdjustForwardWhenCloseToUpAngleThreshold=10,this.myAdjustRightWhenCloseToUpAngleThreshold=10,this.myInvertForwardWhenUpsideDown=!1,this.myInvertRightWhenUpsideDown=!1,this.myAdjustLastValidFlatForwardOverConversionReferenceRotation=!0,this.myAdjustLastValidFlatRightOverConversionReferenceRotation=!0}},Kt=class{constructor(e=new Yi){this._myParams=e,this._myFlyingForward=this._myParams.myStartFlyingForward,this._myFlyingRight=this._myParams.myStartFlyingRight,this._myLastConvertRotationQuat=w(),this._myLastConvertRotationQuatValid=!1,this._myLastValidFlatForward=p(),this._myLastValidFlatRight=p()}convert(e,t,n=null,o=p()){return this.convertTransform(e,t,n,o)}isFlying(){return this._myFlyingForward||this._myFlyingRight}isFlyingForward(){return this._myFlyingForward}isFlyingRight(){return this._myFlyingRight}startFlying(){this._myFlyingForward=!0,this._myFlyingRight=!0}startFlyingForward(){this._myFlyingForward=!0}startFlyingRight(){this._myFlyingRight=!0}stopFlying(){this._myFlyingForward=!1,this._myFlyingRight=!1}stopFlyingForward(){this._myFlyingForward=!1}stopFlyingRight(){this._myFlyingRight=!1}resetFly(){this.resetFlyForward(),this.resetFlyRight()}resetFlyForward(){this._myParams.myStartFlyingForward?this.startFlyingForward():this.stopFlyingForward()}resetFlyRight(){this._myParams.myStartFlyingRight?this.startFlyingRight():this.stopFlyingRight()}resetLastValidFlatDirections(){this._myLastValidFlatForward.vec3_zero(),this._myLastValidFlatRight.vec3_zero()}resetLastValidFlatForward(){this._myLastValidFlatForward.vec3_zero()}resetLastValidFlatRight(){this._myLastValidFlatRight.vec3_zero()}resetLastConvertTransform(){this._myLastConvertRotationQuatValid=!1,this._myLastConvertRotationQuat.quat_identity()}convertForward(e,t,n=null,o=p()){}convertTransform(e,t,n=null,o=p()){return this.convertTransformMatrix(e,t,n,o)}convertTransformMatrix(e,t,n=null,o=p()){}convertTransformQuat(e,t,n=null,o=p()){}convertRotationQuat(e,t,n=null,o=p()){}};Kt.prototype.convertForward=function(){let i=w();return function(t,n,o=null,s=p()){return i.quat_identity(),i.quat_setForward(n,o),this.convertRotationQuat(t,i,o,s)}}();Kt.prototype.convertTransformMatrix=function(){let i=w();return function(t,n,o=null,s=p()){return i=n.mat4_getRotationQuat(i),this.convertRotationQuat(t,i,o,s)}}();Kt.prototype.convertTransformQuat=function(){let i=w();return function(t,n,o=null,s=p()){return i=n.quat2_getRotationQuat(i),this.convertRotationQuat(t,i,o,s)}}();Kt.prototype.convertRotationQuat=function(){let i=p(),e=p(),t=p(),n=p(),o=p(),s=p(),a=w();return function(h,_,y=null,r=p()){if(r.vec3_zero(),(this._myParams.myAdjustLastValidFlatForwardOverConversionReferenceRotation||this._myParams.myAdjustLastValidFlatRightOverConversionReferenceRotation)&&y!=null&&this._myLastConvertRotationQuatValid&&(a=this._myLastConvertRotationQuat.quat_rotationToQuat(_,a).quat_rotationAroundAxisQuat(y,a),Math.pp_angleClamp(a.quat_getAngle(),!0)>Math.PP_EPSILON_DEGREES&&(this._myParams.myAdjustLastValidFlatForwardOverConversionReferenceRotation&&this._myLastValidFlatForward.vec3_rotateQuat(a,this._myLastValidFlatForward),this._myParams.myAdjustLastValidFlatRightOverConversionReferenceRotation&&this._myLastValidFlatRight.vec3_rotateQuat(a,this._myLastValidFlatRight))),h.vec2_isZero())this._myParams.myAutoUpdateFlyForward&&this._myParams.myResetFlyForwardWhenZero&&this.resetFlyForward(),this._myParams.myAutoUpdateFlyRight&&this._myParams.myResetFlyRightWhenZero&&this.resetFlyRight();else{if(i=_.quat_getForward(i),e=_.quat_getRight(e),t=_.quat_getUp(t),y!=null){let u=!y.vec3_isConcordant(t);if(n=y.vec3_negate(n),this._myParams.myAutoUpdateFlyForward){let g=i.vec3_angle(y);this._myFlyingForward=this._myFlyingForward||g<90-this._myParams.myMinAngleToFlyForwardUp||g>90+this._myParams.myMinAngleToFlyForwardDown}if(this._myParams.myAutoUpdateFlyRight){let g=e.vec3_angle(y);this._myFlyingRight=this._myFlyingRight||g<90-this._myParams.myMinAngleToFlyRightUp||g>90+this._myParams.myMinAngleToFlyRightDown}this._myFlyingForward||(this._myParams.myAdjustForwardWhenCloseToUp&&!this._myLastValidFlatForward.vec3_isZero(Math.PP_EPSILON)&&(i.vec3_angle(y)<this._myParams.myAdjustForwardWhenCloseToUpAngleThreshold||i.vec3_angle(n)<this._myParams.myAdjustForwardWhenCloseToUpAngleThreshold)?i.pp_copy(this._myLastValidFlatForward):u&&this._myParams.myInvertForwardWhenUpsideDown&&i.vec3_negate(i),i=i.vec3_removeComponentAlongAxis(y,i),i.vec3_normalize(i),i.vec3_isZero(Math.PP_EPSILON)&&(this._myLastValidFlatForward.vec3_isZero(Math.PP_EPSILON)?i.vec3_set(0,0,1):i.pp_copy(this._myLastValidFlatForward))),this._myFlyingRight||(this._myParams.myAdjustRightWhenCloseToUp&&!this._myLastValidFlatRight.vec3_isZero(Math.PP_EPSILON)&&(e.vec3_angle(y)<this._myParams.myAdjustRightWhenCloseToUpAngleThreshold||e.vec3_angle(n)<this._myParams.myAdjustRightWhenCloseToUpAngleThreshold)?e.pp_copy(this._myLastValidFlatRight):u&&this._myParams.myInvertRightWhenUpsideDown&&e.vec3_negate(e),e=e.vec3_removeComponentAlongAxis(y,e),e.vec3_normalize(e),e.vec3_isZero(Math.PP_EPSILON)&&(this._myLastValidFlatRight.vec3_isZero(Math.PP_EPSILON)?e.vec3_set(-1,0,0):e.pp_copy(this._myLastValidFlatRight))),(i.vec3_angle(y)>=this._myParams.myAdjustForwardWhenCloseToUpAngleThreshold&&i.vec3_angle(n)>=this._myParams.myAdjustForwardWhenCloseToUpAngleThreshold||h[1]!=0&&this._myLastValidFlatForward.vec3_isZero(Math.PP_EPSILON))&&(this._myLastValidFlatForward=i.vec3_removeComponentAlongAxis(y,this._myLastValidFlatForward),this._myLastValidFlatForward.vec3_normalize(this._myLastValidFlatForward)),(e.vec3_angle(y)>=this._myParams.myAdjustRightWhenCloseToUpAngleThreshold&&e.vec3_angle(n)>=this._myParams.myAdjustRightWhenCloseToUpAngleThreshold||h[0]!=0&&this._myLastValidFlatRight.vec3_isZero(Math.PP_EPSILON))&&(this._myLastValidFlatRight=e.vec3_removeComponentAlongAxis(y,this._myLastValidFlatRight),this._myLastValidFlatRight.vec3_normalize(this._myLastValidFlatRight))}r=e.vec3_scale(h[0],s).vec3_add(i.vec3_scale(h[1],o),r),y!=null&&!this._myFlyingForward&&!this._myFlyingRight&&(r=r.vec3_removeComponentAlongAxis(y,r)),r.vec3_normalize(r)}return this._myLastConvertRotationQuat.quat_copy(_),this._myLastConvertRotationQuatValid=!0,r}}();var _i=class{constructor(e,t=null,n=0,o=0,s=ue.linear,a=null){t==null&&(t=e),this._myFromNumber=e,this._myToNumber=t,this._myFromFactor=n,this._myToFactor=o,this._myEasingFunction=s,this._myRoundingFunction=a}get(e){let t=this._myEasingFunction(Math.pp_mapToRange(e,this._myFromFactor,this._myToFactor,0,1)),n=Math.pp_lerp(this._myFromNumber,this._myToNumber,t);return this._myRoundingFunction&&(n=this._myRoundingFunction(n,this._myFromNumber,this._myToNumber)),n}getAverage(e){return this.get(e)}getRange(e){let t=this.get(e);return[t,t]}getMax(e){return this.get(e)}getMin(e){return this.get(e)}isInside(e,t){return this.get(t)==e}isInsideAngleRange(e,t){return this.isInsideAngleRangeDegrees(e,t)}isInsideAngleRangeDegrees(e,t){let n=this.get(t),o=Math.pp_angleClampDegrees(e),s=Math.pp_angleClampDegrees(n);return o==s}isInsideAngleRangeRadians(e,t){let n=this.get(t),o=Math.pp_angleClampRadians(e),s=Math.pp_angleClampRadians(n);return o==s}},im=class extends _i{constructor(e,t,n,o,s=ue.linear,a=null){a==null&&(a=function(l,h,_){let y=null;return h<=_?y=Math.floor(l):y=Math.ceil(l),y}),super(e,t,n,o,s,a)}},Fr=class{constructor(e,t=null,n=0,o=0,s=ue.linear,a=null){t==null&&(t=e),this._myFromNumberOverFactor=new _i(e[0],t[0],n,o,s,a),this._myToNumberOverFactor=new _i(e[1],t[1],n,o,s,a),this._myRoundingFunction=a}get(e){let t=this._myFromNumberOverFactor.get(e),n=this._myToNumberOverFactor.get(e),o=null;return this._myRoundingFunction?o=Math.pp_randomInt(t,n):o=Math.pp_random(t,n),o}getAverage(e){let t=this._myFromNumberOverFactor.get(e),n=this._myToNumberOverFactor.get(e),o=(t+n)/2;return this._myRoundingFunction&&(o=this._myRoundingFunction(o,t,n)),o}getRange(e){let t=this._myFromNumberOverFactor.get(e),n=this._myToNumberOverFactor.get(e);return[t,n]}getMax(e){let t=this._myFromNumberOverFactor.get(e),n=this._myToNumberOverFactor.get(e);return Math.max(t,n)}getMin(e){let t=this._myFromNumberOverFactor.get(e),n=this._myToNumberOverFactor.get(e);return Math.min(t,n)}isInside(e,t){let n=this._myFromNumberOverFactor.get(t),o=this._myToNumberOverFactor.get(t),s=Math.min(n,o),a=Math.max(n,o);return e>=s&&e<=a}isInsideAngleRange(e,t){return this.isInsideAngleRangeDegrees(e,t)}isInsideAngleRangeDegrees(e,t){let n=this._myFromNumberOverFactor.get(t),o=this._myToNumberOverFactor.get(t);return Math.pp_isInsideAngleRangeDegrees(e,n,o)}isInsideAngleRangeRadians(e,t){let n=this._myFromNumberOverFactor.get(t),o=this._myToNumberOverFactor.get(t);return Math.pp_isInsideAngleRangeRadians(e,n,o)}},nm=class extends Fr{constructor(e,t,n,o,s=ue.linear,a=null){a==null&&(a=function(l,h,_){let y=null;return h<=_?y=Math.floor(l):y=Math.ceil(l),y}),super(e,t,n,o,s,a)}};import{Component as ER,Emitter as om,PhysXComponent as AR,Property as wr}from"@wonderlandengine/api";var Fi=class extends ER{static TypeName="pp-grabbable";static Properties={_myThrowLinearVelocityMultiplier:wr.float(1),_myThrowAngularVelocityMultiplier:wr.float(1),_myKinematicValueOnRelease:wr.enum(["True","False","Own"],"False"),_myParentOnRelease:wr.enum(["Scene","Own"],"Own")};init(){this._myGrabbed=!1,this._myGrabber=null,this._myOldParent=null,this._myPhysX=null,this._myOldKinematicValue=null,this._myGrabEmitter=new om,this._myThrowEmitter=new om,this._myReleaseEmitter=new om}start(){this._myOldParent=this.object.pp_getParent(),this._myPhysX=this.object.pp_getComponent(AR)}onDeactivate(){this.release()}grab(e){this.isGrabbed()||(this._myOldKinematicValue=this._myPhysX.kinematic),this.release(),this._myPhysX.kinematic=!0,this._myOldParent=this.object.pp_getParent(),this.object.pp_setParent(e),this._myGrabbed=!0,this._myGrabEmitter.notify(e,this)}throw(e,t){if(this._myGrabbed){let n=this._myGrabber;this._release(),this._myPhysX.linearVelocity=e.vec3_scale(this._myThrowLinearVelocityMultiplier),this._myPhysX.angularVelocity=t.vec3_scale(this._myThrowAngularVelocityMultiplier),this._myThrowEmitter.notify(n,this),this._myReleaseEmitter.notify(n,this,!0)}}release(){if(this._myGrabbed){let e=this._myGrabber;this._release(),this._myReleaseEmitter.notify(e,this,!1)}}getLinearVelocity(){let e=p();return this._myPhysX.linearVelocity.vec3_clone(e),e}getAngularVelocity(){return this.getAngularVelocityDegrees()}getAngularVelocityDegrees(){let e=p();return this._myPhysX.angularVelocity.vec3_toDegrees(e),e}getAngularVelocityRadians(){let e=p();return this._myPhysX.angularVelocity.vec3_clone(e),e}isGrabbed(){return this._myGrabbed}getGrabber(){return this._myGrabber}registerGrabEventListener(e,t){this._myGrabEmitter.add(t,{id:e})}unregisterGrabEventListener(e){this._myGrabEmitter.remove(e)}registerThrowEventListener(e,t){this._myThrowEmitter.add(t,{id:e})}unregisterThrowEventListener(e){this._myThrowEmitter.remove(e)}registerReleaseEventListener(e,t){this._myReleaseEmitter.add(t,{id:e})}unregisterReleaseEventListener(e){this._myReleaseEmitter.remove(e)}_release(){this._myParentOnRelease==0?this.object.pp_setParent(m.getSceneObjects(this.engine).myDynamics):this.object.pp_setParent(this._myOldParent),this._myGrabbed=!1,this._myGrabber=null,this._myKinematicValueOnRelease==0?this._myPhysX.kinematic=!0:this._myKinematicValueOnRelease==1?this._myPhysX.kinematic=!1:this._myOldKinematicValue!=null&&(this._myPhysX.kinematic=this._myOldKinematicValue),this._myPhysX.kinematic&&(this._myPhysX.linearVelocity=p(),this._myPhysX.angularVelocity=p())}pp_clone(e){return j.cloneDefault(this,e)}pp_clonePostProcess(e){e.start()}};import{Component as RR,Emitter as LC,PhysXComponent as VR,Property as Rt}from"@wonderlandengine/api";var wi=class extends RR{static TypeName="pp-grabber-hand";static Properties={_myHandedness:Rt.enum(["Left","Right"],"Left"),_myGrabButton:Rt.enum(["Select","Squeeze","Both","Both Exclusive"],"Squeeze"),_mySnapOnPivot:Rt.bool(!1),_myMaxNumberOfObjects:Rt.int(1),_myThrowVelocitySource:Rt.enum(["Hand","Grabbable"],"Hand"),_myThrowLinearVelocityMultiplier:Rt.float(1),_myThrowMaxLinearSpeed:Rt.float(15),_myThrowAngularVelocityMultiplier:Rt.float(.5),_myThrowMaxAngularSpeed:Rt.float(1080),_myThrowLinearVelocityBoost:Rt.float(1.75),_myThrowLinearVelocityBoostMinSpeedThreshold:Rt.float(.6),_myThrowLinearVelocityBoostMaxSpeedThreshold:Rt.float(2.5)};init(){this._myGrabbables=[],this._myGamepad=null,this._myActiveGrabButton=null,this._myLinearVelocityHistorySize=5,this._myLinearVelocityHistorySpeedAverageSamplesFromStart=1,this._myLinearVelocityHistoryDirectionAverageSamplesFromStart=3,this._myLinearVelocityHistoryDirectionAverageSkipFromStart=0,this._myHandLinearVelocityHistory=new Array(this._myLinearVelocityHistorySize),this._myHandLinearVelocityHistory.fill(p()),this._myAngularVelocityHistorySize=1,this._myHandAngularVelocityHistory=new Array(this._myAngularVelocityHistorySize),this._myHandAngularVelocityHistory.fill(p()),this._myThrowMaxAngularSpeedRadians=Math.pp_toRadians(this._myThrowMaxAngularSpeed),this._myGrabEmitter=new LC,this._myThrowEmitter=new LC,this._myDebugEnabled=!1}start(){this._myHandedness==vi.LEFT?this._myGamepad=m.getLeftGamepad(this.engine):this._myGamepad=m.getRightGamepad(this.engine),this._myPhysX=this.object.pp_getComponent(VR),this._myCollisionsCollector=new Xt(this._myPhysX,!0)}update(e){this._myCollisionsCollector.update(e),this._myGrabbables.length>0&&(this._updateLinearVelocityHistory(),this._updateAngularVelocityHistory())}grab(e=null){this._grab(e)}throw(e=null){this._throw(e)}getGamepad(){return this._myGamepad}getHandedness(){return ie.getHandednessByIndex(this._myHandedness)}registerGrabEventListener(e,t){this._myGrabEmitter.add(t,{id:e})}unregisterGrabEventListener(e){this._myGrabEmitter.remove(e)}registerThrowEventListener(e,t){this._myThrowEmitter.add(t,{id:e})}unregisterThrowEventListener(e){this._myThrowEmitter.remove(e)}onActivate(){this._myGamepad!=null&&(this._myGrabButton==0?(this._myGamepad.registerButtonEventListener(E.SELECT,ae.PRESS_START,this,this._grab.bind(this,E.SELECT)),this._myGamepad.registerButtonEventListener(E.SELECT,ae.PRESS_END,this,this._throw.bind(this,E.SELECT))):this._myGrabButton==1?(this._myGamepad.registerButtonEventListener(E.SQUEEZE,ae.PRESS_START,this,this._grab.bind(this,E.SQUEEZE)),this._myGamepad.registerButtonEventListener(E.SQUEEZE,ae.PRESS_END,this,this._throw.bind(this,E.SQUEEZE))):(this._myGamepad.registerButtonEventListener(E.SQUEEZE,ae.PRESS_START,this,this._grab.bind(this,E.SQUEEZE)),this._myGamepad.registerButtonEventListener(E.SQUEEZE,ae.PRESS_END,this,this._throw.bind(this,E.SQUEEZE)),this._myGamepad.registerButtonEventListener(E.SELECT,ae.PRESS_START,this,this._grab.bind(this,E.SELECT)),this._myGamepad.registerButtonEventListener(E.SELECT,ae.PRESS_END,this,this._throw.bind(this,E.SELECT))))}onDeactivate(){this.throw(),this._myGamepad!=null&&(this._myGrabButton==0?(this._myGamepad.unregisterButtonEventListener(E.SELECT,ae.PRESS_START,this),this._myGamepad.unregisterButtonEventListener(E.SELECT,ae.PRESS_END,this)):this._myGrabButton==1?(this._myGamepad.unregisterButtonEventListener(E.SQUEEZE,ae.PRESS_START,this),this._myGamepad.unregisterButtonEventListener(E.SQUEEZE,ae.PRESS_END,this)):(this._myGamepad.unregisterButtonEventListener(E.SQUEEZE,ae.PRESS_START,this),this._myGamepad.unregisterButtonEventListener(E.SQUEEZE,ae.PRESS_END,this),this._myGamepad.unregisterButtonEventListener(E.SELECT,ae.PRESS_START,this),this._myGamepad.unregisterButtonEventListener(E.SELECT,ae.PRESS_END,this)))}_grab(e){if(!(this._myGrabbables.length>=this._myMaxNumberOfObjects)&&(this._myGrabButton==2||this._myActiveGrabButton==null||this._myActiveGrabButton==e||e==null)){let t=[],n=this._myCollisionsCollector.getCollisions();for(let s=0;s<n.length;s++){let a=n[s].pp_getComponent(Fi);a&&a.active&&t.push(a)}let o=this.object.pp_getPosition();t.sort(function(s,a){let l=s.object.pp_getPosition(),h=a.object.pp_getPosition(),_=l.vec3_distance(o),y=h.vec3_distance(o);return Math.pp_sign(_-y,0)});for(let s of t){if(!this._isAlreadyGrabbed(s)){let a=new sm(s,this._myThrowVelocitySource==1,this._myLinearVelocityHistorySize,this._myAngularVelocityHistorySize);this._myGrabbables.push(a),s.grab(this.object),s.registerReleaseEventListener(this,this._onRelease.bind(this)),this._mySnapOnPivot&&s.object.pp_resetPositionLocal(),this._myGrabEmitter.notify(this,s)}if(this._myGrabbables.length>=this._myMaxNumberOfObjects)break}this._myGrabbables.length>0&&this._myActiveGrabButton==null&&(this._myActiveGrabButton=e)}}_throw(e){if(this._myGrabButton==2||this._myActiveGrabButton==null||this._myActiveGrabButton==e||e==null){if(this._myGrabbables.length>0){let t=null,n=null;this._myThrowVelocitySource==0&&(t=this._computeReleaseLinearVelocity(this._myHandLinearVelocityHistory),n=this._computeReleaseAngularVelocity(this._myHandAngularVelocityHistory));for(let o of this._myGrabbables){let s=o.getGrabbable();s.unregisterReleaseEventListener(this),this._myThrowVelocitySource==1&&(t=this._computeReleaseLinearVelocity(o.getLinearVelocityHistory()),n=this._computeReleaseAngularVelocity(o.getAngularVelocityHistory())),s.throw(t,n),this._myThrowEmitter.notify(this,s)}this._myGrabbables=[]}this._myActiveGrabButton=null}}_onRelease(e,t){t.unregisterReleaseEventListener(this),this._myGrabbables.pp_remove(n=>n.getGrabbable()==t),this._myGrabbables.length<=0&&(this._myActiveGrabButton=null)}_updateLinearVelocityHistory(){let e=this._myGamepad.getHandPose();this._myHandLinearVelocityHistory.unshift(e.getLinearVelocity()),this._myHandLinearVelocityHistory.pop();for(let t of this._myGrabbables)t.updateLinearVelocityHistory()}_updateAngularVelocityHistory(){let e=this._myGamepad.getHandPose();this._myHandAngularVelocityHistory.unshift(e.getAngularVelocityRadians()),this._myHandAngularVelocityHistory.pop();for(let t of this._myGrabbables)t.updateAngularVelocityHistory()}_computeReleaseLinearVelocity(e){let t=e[0].vec3_length();for(let h=1;h<this._myLinearVelocityHistorySpeedAverageSamplesFromStart;h++)t+=e[h].vec3_length();t/=this._myLinearVelocityHistorySpeedAverageSamplesFromStart;let n=Math.pp_mapToRange(t,this._myThrowLinearVelocityBoostMinSpeedThreshold,this._myThrowLinearVelocityBoostMaxSpeedThreshold,0,1);n=ue.easeIn(n);let o=t*(n*this._myThrowLinearVelocityBoost);t+=o,t*=this._myThrowLinearVelocityMultiplier,t=Math.pp_clamp(t,0,this._myThrowMaxLinearSpeed),this._myDebugEnabled&&m.isDebugEnabled(this.engine)&&this._debugDirectionLines(e);let s=this._myLinearVelocityHistoryDirectionAverageSamplesFromStart,a=this._myLinearVelocityHistoryDirectionAverageSkipFromStart+this._myLinearVelocityHistoryDirectionAverageSamplesFromStart,l=p();for(let h=this._myLinearVelocityHistoryDirectionAverageSkipFromStart;h<a;h++){let _=e[h];_.vec3_scale(s,_),l.vec3_add(_,l),s--}return l.vec3_normalize(l),l.vec3_scale(t,l),l}_computeReleaseAngularVelocity(e){let t=e[0],n=t.vec3_length();n=Math.pp_clamp(n*this._myThrowAngularVelocityMultiplier,0,this._myThrowMaxAngularSpeedRadians);let o=t;return o.vec3_normalize(o),o.vec3_scale(n,o),o}_debugDirectionLines(e){for(let t=this._myLinearVelocityHistoryDirectionAverageSkipFromStart+this._myLinearVelocityHistoryDirectionAverageSamplesFromStart;t>this._myLinearVelocityHistoryDirectionAverageSkipFromStart;t--){let n=t-this._myLinearVelocityHistoryDirectionAverageSkipFromStart,o=t-this._myLinearVelocityHistoryDirectionAverageSkipFromStart,s=p();for(let l=this._myLinearVelocityHistoryDirectionAverageSkipFromStart;l<o;l++){let h=e[l].pp_clone();h.vec3_scale(n,h),s.vec3_add(h,s),n--}s.vec3_normalize(s);let a=1/t;m.getDebugVisualManager(this.engine).drawLine(5,this.object.pp_getPosition(),s,.2,F(a,a,a,1))}}_isAlreadyGrabbed(e){return this._myGrabbables.pp_find(n=>n.getGrabbable()==e)!=null}},sm=class{constructor(e,t,n,o){this._myGrabbable=e,this._myUseGrabbableAsVelocitySource=t,this._myUseGrabbableAsVelocitySource&&(this._myLinearVelocityHistory=new Array(n),this._myLinearVelocityHistory.fill(p()),this._myAngularVelocityHistory=new Array(o),this._myAngularVelocityHistory.fill(p()))}getGrabbable(){return this._myGrabbable}getLinearVelocityHistory(){return this._myLinearVelocityHistory}getAngularVelocityHistory(){return this._myAngularVelocityHistory}updateLinearVelocityHistory(){this._myUseGrabbableAsVelocitySource&&(this._myLinearVelocityHistory.unshift(this._myGrabbable.getLinearVelocity()),this._myLinearVelocityHistory.pop())}updateAngularVelocityHistory(){this._myUseGrabbableAsVelocitySource&&(this._myAngularVelocityHistory.unshift(this._myGrabbable.getAngularVelocityRadians()),this._myAngularVelocityHistory.pop())}onDestroy(){this._myCollisionsCollector.destroy()}};var oe=null,Rs=!1,at=!1,Fe={DUMMY_NOT_INITIALIZED:0,CA_SDK_MISSING:1,SUBMIT_SCORE_FAILED:2,GET_LEADERBOARD_FAILED:3,GET_USER_FAILED:4,USER_HAS_NO_SCORE:5};function HC(i){Rs=i}function kC(i){at=i}function FC(i){oe=i}function wC(){return Rs}function jC(){return at}function zC(){return oe}function GC(){return window.casdk!=null}function NC(){return window.casdk}function UC(i,e,t,n,o=null,s=null,a=null){if(pe.isSDKAvailable()){let l=pe.getSDK();if(t)pe.getUser(function(h){let _=h.displayName;try{l.getLeaderboard(i,e,t,n).then(function(y){if(y.leaderboard){let r=!1;for(let u of y.leaderboard)if(u.displayName==_&&u.score!=0){r=!0;break}if(r)o?.(y.leaderboard);else if(oe!=null&&oe.getLeaderboard!=null&&at&&a==null||a!=null&&a)pe.getLeaderboardDummy(i,e,t,n,o,s);else if(s!=null){let u={};u.reason="Searching for around player but the user has not submitted a score yet",u.type=Fe.USER_HAS_NO_SCORE,s(u,y)}}else if(oe!=null&&oe.getLeaderboard!=null&&at&&a==null||a!=null&&a)pe.getLeaderboardDummy(i,e,t,n,o,s);else if(s!=null){let r={};r.reason="Get leaderboard failed",r.type=Fe.GET_LEADERBOARD_FAILED,s(r,y)}}).catch(function(y){if(oe!=null&&oe.getLeaderboard!=null&&at&&a==null||a!=null&&a)pe.getLeaderboardDummy(i,e,t,n,o,s);else if(s!=null){let r={};r.reason="Get leaderboard failed",r.type=Fe.GET_LEADERBOARD_FAILED,s(r,y)}})}catch{if(oe!=null&&oe.getLeaderboard!=null&&at&&a==null||a!=null&&a)pe.getLeaderboardDummy(i,e,t,n,o,s);else if(s!=null){let r={};r.reason="Get leaderboard failed",r.type=Fe.GET_LEADERBOARD_FAILED,s(r,null)}}},function(){if(oe!=null&&oe.getLeaderboard!=null&&at&&a==null||a!=null&&a)pe.getLeaderboardDummy(i,e,t,n,o,s);else if(s!=null){let h={};h.reason="Searching for around player but the user can't be retrieved",h.type=Fe.GET_USER_FAILED,s(h,null)}},!1);else try{l.getLeaderboard(i,e,t,n).then(function(h){if(h.leaderboard)o?.(h.leaderboard);else if(oe!=null&&oe.getLeaderboard!=null&&at&&a==null||a!=null&&a)pe.getLeaderboardDummy(i,e,t,n,o,s);else if(s!=null){let _={};_.reason="Get leaderboard failed",_.type=Fe.GET_LEADERBOARD_FAILED,s(_,h)}}).catch(function(h){if(oe!=null&&oe.getLeaderboard!=null&&at&&a==null||a!=null&&a)pe.getLeaderboardDummy(i,e,t,n,o,s);else if(s!=null){let _={};_.reason="Get leaderboard failed",_.type=Fe.GET_LEADERBOARD_FAILED,s(_,h)}})}catch{if(oe!=null&&oe.getLeaderboard!=null&&at&&a==null||a!=null&&a)pe.getLeaderboardDummy(i,e,t,n,o,s);else if(s!=null){let _={};_.reason="Get leaderboard failed",_.type=Fe.GET_LEADERBOARD_FAILED,s(_,null)}}}else if(oe!=null&&oe.getLeaderboard!=null&&Rs&&a==null||a!=null&&a)pe.getLeaderboardDummy(i,e,t,n,o,s);else if(s!=null){let l={};l.reason="Construct Arcade SDK missing",l.type=Fe.CA_SDK_MISSING,s(l,null)}}function WC(i,e,t,n,o=null,s=null){if(oe)oe.getLeaderboard(i,e,t,n,o,s);else if(s!=null){let a={};a.reason="Dummy server not initialized",a.type=Fe.DUMMY_NOT_INITIALIZED,s(a,null)}}function QC(i,e,t=null,n=null,o=null){if(pe.isSDKAvailable()){let s=pe.getSDK();try{s.submitScore(i,e).then(function(a){if(a.error){if(oe!=null&&oe.submitScore!=null&&at&&o==null||o!=null&&o)pe.submitScoreDummy(i,e,t,n);else if(n!=null){let l={};l.reason="Submit score failed",l.type=Fe.SUBMIT_SCORE_FAILED,n(l,a)}}else t()}).catch(function(a){if(oe!=null&&oe.submitScore!=null&&at&&o==null||o!=null&&o)pe.submitScoreDummy(i,e,t,n);else if(n!=null){let l={};l.reason="Submit score failed",l.type=Fe.SUBMIT_SCORE_FAILED,n(l,a)}})}catch{if(oe!=null&&oe.submitScore!=null&&at&&o==null||o!=null&&o)pe.submitScoreDummy(i,e,t,n);else if(n!=null){let l={};l.reason="Submit score failed",l.type=Fe.SUBMIT_SCORE_FAILED,n(l,null)}}}else if(oe!=null&&oe.submitScore!=null&&Rs&&o==null||o!=null&&o)pe.submitScoreDummy(i,e,t,n);else if(n!=null){let s={};s.reason="Construct Arcade SDK missing",s.type=Fe.CA_SDK_MISSING,n(s,null)}}function qC(i,e,t=null,n=null){if(oe)oe.submitScore(i,e,t,n);else if(n!=null){let o={};o.reason="Dummy server not initialized",o.type=Fe.DUMMY_NOT_INITIALIZED,n(o,null)}}function XC(i=null,e=null,t=null){if(pe.isSDKAvailable()){let n=pe.getSDK();try{n.getUser().then(function(o){if(o.user)i?.(o.user);else if(oe!=null&&oe.getUser!=null&&at&&t==null||t!=null&&t)pe.getUserDummy(i,e);else if(e!=null){let s={};s.reason="Get user failed",s.type=Fe.GET_USER_FAILED,e(s,o)}}).catch(function(o){if(oe!=null&&oe.getUser!=null&&at&&t==null||t!=null&&t)pe.getUserDummy(i,e);else if(e!=null){let s={};s.reason="Get user failed",s.type=Fe.GET_USER_FAILED,e(s,o)}})}catch{if(oe!=null&&oe.getUser!=null&&at&&t==null||t!=null&&t)pe.getUserDummy(i,e);else if(e!=null){let s={};s.reason="Get user failed",s.type=Fe.GET_USER_FAILED,e(s,null)}}}else if(oe!=null&&oe.getUser!=null&&Rs&&t==null||t!=null&&t)pe.getUserDummy(i,e);else if(e!=null){let n={};n.reason="Construct Arcade SDK missing",n.type=Fe.CA_SDK_MISSING,e(n,null)}}function KC(i=null,e=null){if(oe)oe.getUser(i,e);else if(e!=null){let t={};t.reason="Dummy server not initialized",t.type=Fe.DUMMY_NOT_INITIALIZED,e(t,null)}}var pe={setUseDummyServerOnSDKMissing:HC,setUseDummyServerOnError:kC,setDummyServer:FC,isUseDummyServerOnSDKMissing:wC,isUseDummyServerOnError:jC,getDummyServer:zC,isSDKAvailable:GC,getSDK:NC,getLeaderboard:UC,getLeaderboardDummy:WC,submitScore:QC,submitScoreDummy:qC,getUser:XC,getUserDummy:KC};var Vs=class{constructor(e=m.getMainEngine()){this._myEngine=e}getLeaderboard(e,t,n,o,s=null,a=null){let l=null;for(pe.isSDKAvailable()?l=[{rank:0,displayName:"An",score:0},{rank:1,displayName:"Error",score:0},{rank:2,displayName:"Has",score:0},{rank:3,displayName:"Occurred",score:0},{rank:4,displayName:"While",score:0},{rank:5,displayName:"Trying",score:0},{rank:6,displayName:"To",score:0},{rank:7,displayName:"Retrieve",score:0},{rank:8,displayName:"The",score:0},{rank:9,displayName:"Leaderboard",score:0}]:n?l=[{rank:0,displayName:"Sign In",score:0},{rank:1,displayName:"And",score:0},{rank:2,displayName:"Play",score:0},{rank:3,displayName:"On",score:0},{rank:4,displayName:"HeyVR",score:0},{rank:5,displayName:"To",score:0},{rank:6,displayName:"Submit",score:0},{rank:7,displayName:"Your",score:0},{rank:8,displayName:"Own",score:0},{rank:9,displayName:"Score",score:0}]:l=[{rank:0,displayName:"The",score:0},{rank:1,displayName:"Top 10",score:0},{rank:2,displayName:"Leaderboard",score:0},{rank:3,displayName:"Is",score:0},{rank:4,displayName:"Available",score:0},{rank:5,displayName:"Only",score:0},{rank:5,displayName:"When",score:0},{rank:7,displayName:"Playing",score:0},{rank:8,displayName:"On",score:0},{rank:9,displayName:"HeyVR",score:0}];l.length>o;)l.pop();s?.(l)}submitScore(e,t,n=null,o=null){n?.()}getUser(e=null,t=null){let n={};n.displayName="Florian",e?.(n)}};import{Component as OR,Property as Jt,TextComponent as JC}from"@wonderlandengine/api";var Vo=class extends OR{static TypeName="pp-ca-display-leaderboard";static Properties={_myUsernamesTextObject:Jt.object(),_myScoresTextObject:Jt.object(),_myLeaderboardID:Jt.string(""),_myLocal:Jt.bool(!1),_myAscending:Jt.bool(!1),_myScoresAmount:Jt.int(10),_myScoreFormat:Jt.enum(["Value","Hours:Minutes:Seconds","Minutes:Seconds","Seconds","Hours:Minutes","Minutes"],"Value"),_myPositionAndUsernameSeparator:Jt.string(" - "),_myNumberOfLinesBetweenScores:Jt.int(1),_myAddDefaultCADummyServer:Jt.bool(!1)};init(){this._myUsernamesTextComponent=null,this._myScoresTextComponent=null,this._myStarted=!1,this._myDestroyed=!1}start(){this._myAddDefaultCADummyServer&&(pe.setDummyServer(new Vs),pe.setUseDummyServerOnSDKMissing(!0),pe.setUseDummyServerOnError(!0))}update(e){this._myStarted||(this._myStarted=!0,this._myUsernamesTextObject!=null&&(this._myUsernamesTextComponent=this._myUsernamesTextObject.pp_getComponent(JC)),this._myScoresTextObject!=null&&(this._myScoresTextComponent=this._myScoresTextObject.pp_getComponent(JC)),this.updateLeaderboard())}updateLeaderboard(){pe.getLeaderboard(this._myLeaderboardID,this._myAscending,this._myLocal,this._myScoresAmount,this._onLeaderboardRetrieved.bind(this))}_onLeaderboardRetrieved(e){if(this._myDestroyed)return;let t="",n="",o=0;for(let s of e){let a=s.rank+1;a.toFixed(0).length>o&&(o=a.toFixed(0).length)}for(let s of e){let l=(s.rank+1).toFixed(0);for(;l.length<o;)l="0".concat(l);let h=`
`;for(let y=0;y<this._myNumberOfLinesBetweenScores;y++)h=h+`
`;t=t.concat(l,this._myPositionAndUsernameSeparator,s.displayName,h);let _=this._formatScore(s.score);n=n.concat(_,h)}this._myUsernamesTextComponent!=null&&(this._myUsernamesTextComponent.text=t),this._myScoresTextComponent!=null&&(this._myScoresTextComponent.text=n)}_formatScore(e){let t=e.toString();return this._myScoreFormat==1?t=this._formatTime(e,!0,!0,!0):this._myScoreFormat==2?t=this._formatTime(e,!1,!0,!0):this._myScoreFormat==3?t=this._formatTime(e,!1,!1,!0):this._myScoreFormat==4?t=this._formatTime(e,!0,!0,!1):this._myScoreFormat==5&&(t=this._formatTime(e,!1,!0,!1)),t}_formatTime(e,t,n,o){let s=Math.floor(e/1e3),a=0;t&&(a=Math.floor(s/3600),s-=a*3600);let l=0;n&&(l=Math.floor(s/60),s-=l*60);let h=0;o&&(h=Math.floor(s));let _="";return o&&(_=h.toFixed(0).length<2&&(n||t)?"0".concat(h.toFixed(0)):h.toFixed(0)),n&&(_=(l.toFixed(0).length<2&&(o||t)?"0".concat(l.toFixed(0)):l.toFixed(0))+(o?":"+_:"")),t&&(_=(a.toFixed(0).length<2&&(o||n)?"0".concat(a.toFixed(0)):a.toFixed(0))+(n?":"+_:"")),_}pp_clone(e){return j.cloneDefault(this,e)}onDestroy(){this._myDestroyed=!0}};var et=class{constructor(){this.mySplitMovementEnabled=!1,this.mySplitMovementMaxLength=0,this.mySplitMovementMaxStepsEnabled=!1,this.mySplitMovementMaxSteps=0,this.mySplitMovementStepEqualLength=!1,this.mySplitMovementStepEqualLengthMinLength=0,this.mySplitMovementStopWhenHorizontalMovementCanceled=!1,this.mySplitMovementStopWhenVerticalMovementCanceled=!1,this.mySplitMovementStopCallback=null,this.mySplitMovementStopReturnPrevious=!1,this.myRadius=0,this.myDistanceFromFeetToIgnore=0,this.myDistanceFromHeadToIgnore=0,this.myPositionOffsetLocal=p(),this.myRotationOffsetLocalQuat=w(),this.myHorizontalMovementCheckEnabled=!1,this.myHorizontalMovementStepEnabled=!1,this.myHorizontalMovementStepMaxLength=0,this.myHorizontalMovementRadialStepAmount=0,this.myHorizontalMovementCheckDiagonalOutward=!1,this.myHorizontalMovementCheckDiagonalInward=!1,this.myHorizontalMovementCheckStraight=!1,this.myHorizontalMovementCheckHorizontalBorder=!1,this.myHorizontalMovementCheckVerticalStraight=!1,this.myHorizontalMovementCheckVerticalDiagonalUpwardOutward=!1,this.myHorizontalMovementCheckVerticalDiagonalUpwardInward=!1,this.myHorizontalMovementCheckVerticalDiagonalDownwardOutward=!1,this.myHorizontalMovementCheckVerticalDiagonalDownwardInward=!1,this.myHorizontalMovementCheckVerticalStraightDiagonalUpward=!1,this.myHorizontalMovementCheckVerticalStraightDiagonalDownward=!1,this.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward=!1,this.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward=!1,this.myHorizontalMovementHorizontalStraightCentralCheckEnabled=!1,this.myHorizontalMovementVerticalStraightCentralCheckEnabled=!1,this.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=!1,this.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled=!1,this.myHorizontalPositionCheckEnabled=!1,this.myHalfConeAngle=0,this.myHalfConeSliceAmount=0,this.myCheckConeBorder=!1,this.myCheckConeRay=!1,this.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision=!0,this.myHorizontalPositionCheckVerticalDirectionType=0,this.myCheckHorizontalFixedForwardEnabled=!1,this.myCheckHorizontalFixedForward=p(),this.myVerticalMovementCheckEnabled=!1,this.myVerticalPositionCheckEnabled=!1,this.myFeetRadius=0,this.myAdjustVerticalMovementWithGroundAngleDownhill=!1,this.myAdjustVerticalMovementWithGroundAngleUphill=!1,this.myAdjustVerticalMovementWithGroundAngleDownhillMaxAngle=null,this.myAdjustVerticalMovementWithGroundAngleUphillMaxAngle=null,this.myAdjustVerticalMovementWithGroundAngleDownhillMaxPerceivedAngle=null,this.myAdjustVerticalMovementWithGroundAngleUphillMaxPerceivedAngle=null,this.myAdjustHorizontalMovementWithGroundAngleDownhill=!1,this.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle=null,this.myAdjustVerticalMovementWithCeilingAngleDownhill=!1,this.myAdjustVerticalMovementWithCeilingAngleUphill=!1,this.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle=null,this.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle=null,this.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle=null,this.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle=null,this.myAdjustHorizontalMovementWithCeilingAngleDownhill=!1,this.myAdjustHorizontalMovementWithCeilingAngleDownhillMinAngle=null,this.myCheckVerticalFixedForwardEnabled=!1,this.myCheckVerticalFixedForward=p(),this.myCheckVerticalBothDirection=!1,this.mySnapOnGroundEnabled=!1,this.mySnapOnGroundExtraDistance=0,this.mySnapOnCeilingEnabled=!1,this.mySnapOnCeilingExtraDistance=0,this.myGroundPopOutEnabled=!1,this.myGroundPopOutExtraDistance=0,this.myCeilingPopOutEnabled=!1,this.myCeilingPopOutExtraDistance=0,this.myVerticalMovementReduceEnabled=!1,this.myGroundCircumferenceAddCenter=!1,this.myGroundCircumferenceSliceAmount=0,this.myGroundCircumferenceStepAmount=0,this.myGroundCircumferenceRotationPerStep=0,this.myVerticalAllowHitInsideCollisionIfOneOk=!1,this.myCheckHeight=!1,this.myCheckHeightVerticalMovement=!1,this.myCheckHeightVerticalPosition=!1,this.myCheckHeightTopMovement=!1,this.myCheckHeightTopPosition=!1,this.myCheckHeightConeOnCollision=!1,this.myCheckHeightConeOnCollisionKeepHit=!1,this.myHeightCheckStepAmountMovement=0,this.myHeightCheckStepAmountPosition=0,this.myCheckVerticalStraight=!1,this.myCheckVerticalDiagonalRayOutward=!1,this.myCheckVerticalDiagonalRayInward=!1,this.myCheckVerticalDiagonalBorderOutward=!1,this.myCheckVerticalDiagonalBorderInward=!1,this.myCheckVerticalDiagonalBorderRayOutward=!1,this.myCheckVerticalDiagonalBorderRayInward=!1,this.myCheckVerticalSearchFartherVerticalHit=!1,this.myGroundAngleToIgnore=0,this.myGroundAngleToIgnoreWithPerceivedAngle=null,this.myCeilingAngleToIgnore=0,this.myCeilingAngleToIgnoreWithPerceivedAngle=null,this.myHorizontalMovementGroundAngleIgnoreHeight=null,this.myHorizontalMovementCeilingAngleIgnoreHeight=null,this.myHorizontalPositionGroundAngleIgnoreHeight=null,this.myHorizontalPositionCeilingAngleIgnoreHeight=null,this.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft=null,this.myHorizontalMovementCeilingAngleIgnoreMaxMovementLeft=null,this.myHeight=0,this.myComputeGroundInfoEnabled=!1,this.myComputeCeilingInfoEnabled=!1,this.myDistanceToBeOnGround=0,this.myDistanceToComputeGroundInfo=0,this.myDistanceToBeOnCeiling=0,this.myDistanceToComputeCeilingInfo=0,this.myVerticalFixToBeOnGround=0,this.myVerticalFixToComputeGroundInfo=0,this.myVerticalFixToBeOnCeiling=0,this.myVerticalFixToComputeCeilingInfo=0,this.myGroundIsBaseInsideCollisionCheckEnabled=!1,this.myCeilingIsBaseInsideCollisionCheckEnabled=!1,this.myIsOnGroundIfInsideHit=!1,this.myIsOnCeilingIfInsideHit=!1,this.myIsOnGroundMaxSurfaceAngle=null,this.myIsOnCeilingMaxSurfaceAngle=null,this.myFindGroundDistanceMaxOutsideDistance=0,this.myFindGroundDistanceMaxInsideDistance=0,this.myFindCeilingDistanceMaxOutsideDistance=0,this.myFindCeilingDistanceMaxInsideDistance=0,this.myAllowGroundSteepFix=!1,this.myAllowCeilingSteepFix=!1,this.myMustStayOnGround=!1,this.myMustStayOnCeiling=!1,this.myMustStayOnValidGroundAngleDownhill=!1,this.myMustStayOnValidCeilingAngleDownhill=!1,this.myRegatherGroundInfoOnSurfaceCheckFail=!1,this.myRegatherCeilingInfoOnSurfaceCheckFail=!1,this.myMustStayBelowIgnorableGroundAngleDownhill=!1,this.myMustStayBelowIgnorableCeilingAngleDownhill=!1,this.myMustStayBelowGroundAngleDownhill=null,this.myMustStayBelowCeilingAngleDownhill=null,this.myMovementMustStayOnGroundHitAngle=null,this.myMovementMustStayOnCeilingHitAngle=null,this.myTeleportMustBeOnIgnorableGroundAngle=!1,this.myCheckTransformMustBeOnIgnorableGroundAngle=!1,this.myTeleportMustBeOnIgnorableCeilingAngle=!1,this.myCheckTransformMustBeOnIgnorableCeilingAngle=!1,this.myTeleportMustBeOnGroundAngle=null,this.myCheckTransformMustBeOnGroundAngle=null,this.myTeleportMustBeOnCeilingAngle=null,this.myCheckTransformMustBeOnCeilingAngle=null,this.myTeleportMustBeOnGround=!1,this.myCheckTransformMustBeOnGround=!1,this.myTeleportMustBeOnCeiling=!1,this.myCheckTransformMustBeOnCeiling=!1,this.mySlidingEnabled=!1,this.mySlidingHorizontalMovementCheckBetterNormal=!1,this.mySlidingMaxAttempts=0,this.mySlidingCheckBothDirections=!1,this.mySlidingFlickeringPreventionType=0,this.mySlidingFlickeringPreventionCheckOnlyIfAlreadySliding=!1,this.mySlidingFlickerPreventionCheckAnywayCounter=0,this.mySlidingAdjustSign90Degrees=!1,this.myHorizontalBlockLayerFlags=new Ve,this.myHorizontalObjectsToIgnore=[],this.myVerticalBlockLayerFlags=new Ve,this.myVerticalObjectsToIgnore=[],this.myExtraMovementCheckCallback=null,this.myExtraTeleportCheckCallback=null,this.myExtraCheckTransformCheckCallback=null,this.myDebugEnabled=!1,this.myDebugHorizontalMovementEnabled=!1,this.myDebugHorizontalPositionEnabled=!1,this.myDebugVerticalMovementEnabled=!1,this.myDebugVerticalPositionEnabled=!1,this.myDebugSlidingEnabled=!1,this.myDebugGroundInfoEnabled=!1,this.myDebugCeilingInfoEnabled=!1,this.myDebugRuntimeParamsEnabled=!1,this.myDebugMovementEnabled=!1}copy(e){this.mySplitMovementEnabled=e.mySplitMovementEnabled,this.mySplitMovementMaxLength=e.mySplitMovementMaxLength,this.mySplitMovementMaxStepsEnabled=e.mySplitMovementMaxStepsEnabled,this.mySplitMovementMaxSteps=e.mySplitMovementMaxSteps,this.mySplitMovementStepEqualLength=e.mySplitMovementStepEqualLength,this.mySplitMovementStepEqualLengthMinLength=e.mySplitMovementStepEqualLengthMinLength,this.mySplitMovementStopWhenHorizontalMovementCanceled=e.mySplitMovementStopWhenHorizontalMovementCanceled,this.mySplitMovementStopWhenVerticalMovementCanceled=e.mySplitMovementStopWhenVerticalMovementCanceled,this.mySplitMovementStopCallback=e.mySplitMovementStopCallback,this.mySplitMovementStopReturnPrevious=e.mySplitMovementStopReturnPrevious,this.myRadius=e.myRadius,this.myDistanceFromFeetToIgnore=e.myDistanceFromFeetToIgnore,this.myDistanceFromHeadToIgnore=e.myDistanceFromHeadToIgnore,this.myPositionOffsetLocal.vec3_copy(e.myPositionOffsetLocal),this.myRotationOffsetLocalQuat.quat_copy(e.myRotationOffsetLocalQuat),this.myHorizontalMovementCheckEnabled=e.myHorizontalMovementCheckEnabled,this.myHorizontalMovementStepEnabled=e.myHorizontalMovementStepEnabled,this.myHorizontalMovementStepMaxLength=e.myHorizontalMovementStepMaxLength,this.myHorizontalMovementRadialStepAmount=e.myHorizontalMovementRadialStepAmount,this.myHorizontalMovementCheckDiagonalOutward=e.myHorizontalMovementCheckDiagonalOutward,this.myHorizontalMovementCheckDiagonalInward=e.myHorizontalMovementCheckDiagonalInward,this.myHorizontalMovementCheckStraight=e.myHorizontalMovementCheckStraight,this.myHorizontalMovementCheckHorizontalBorder=e.myHorizontalMovementCheckHorizontalBorder,this.myHorizontalMovementCheckVerticalStraight=e.myHorizontalMovementCheckVerticalStraight,this.myHorizontalMovementCheckVerticalDiagonalUpwardOutward=e.myHorizontalMovementCheckVerticalDiagonalUpwardOutward,this.myHorizontalMovementCheckVerticalDiagonalUpwardInward=e.myHorizontalMovementCheckVerticalDiagonalUpwardInward,this.myHorizontalMovementCheckVerticalDiagonalDownwardOutward=e.myHorizontalMovementCheckVerticalDiagonalDownwardOutward,this.myHorizontalMovementCheckVerticalDiagonalDownwardInward=e.myHorizontalMovementCheckVerticalDiagonalDownwardInward,this.myHorizontalMovementCheckVerticalStraightDiagonalUpward=e.myHorizontalMovementCheckVerticalStraightDiagonalUpward,this.myHorizontalMovementCheckVerticalStraightDiagonalDownward=e.myHorizontalMovementCheckVerticalStraightDiagonalDownward,this.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward=e.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward,this.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward=e.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward,this.myHorizontalMovementHorizontalStraightCentralCheckEnabled=e.myHorizontalMovementHorizontalStraightCentralCheckEnabled,this.myHorizontalMovementVerticalStraightCentralCheckEnabled=e.myHorizontalMovementVerticalStraightCentralCheckEnabled,this.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=e.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled,this.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled=e.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled,this.myHorizontalPositionCheckEnabled=e.myHorizontalPositionCheckEnabled,this.myHalfConeAngle=e.myHalfConeAngle,this.myHalfConeSliceAmount=e.myHalfConeSliceAmount,this.myCheckConeBorder=e.myCheckConeBorder,this.myCheckConeRay=e.myCheckConeRay,this.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision=e.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision,this.myHorizontalPositionCheckVerticalDirectionType=e.myHorizontalPositionCheckVerticalDirectionType,this.myVerticalMovementCheckEnabled=e.myVerticalMovementCheckEnabled,this.myVerticalPositionCheckEnabled=e.myVerticalPositionCheckEnabled,this.myFeetRadius=e.myFeetRadius,this.myAdjustVerticalMovementWithGroundAngleDownhill=e.myAdjustVerticalMovementWithGroundAngleDownhill,this.myAdjustVerticalMovementWithGroundAngleUphill=e.myAdjustVerticalMovementWithGroundAngleUphill,this.myAdjustVerticalMovementWithGroundAngleDownhillMaxAngle=e.myAdjustVerticalMovementWithGroundAngleDownhillMaxAngle,this.myAdjustVerticalMovementWithGroundAngleUphillMaxAngle=e.myAdjustVerticalMovementWithGroundAngleUphillMaxAngle,this.myAdjustVerticalMovementWithGroundAngleDownhillMaxPerceivedAngle=e.myAdjustVerticalMovementWithGroundAngleDownhillMaxPerceivedAngle,this.myAdjustVerticalMovementWithGroundAngleUphillMaxPerceivedAngle=e.myAdjustVerticalMovementWithGroundAngleUphillMaxPerceivedAngle,this.myAdjustHorizontalMovementWithGroundAngleDownhill=e.myAdjustHorizontalMovementWithGroundAngleDownhill,this.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle=e.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle,this.myAdjustVerticalMovementWithCeilingAngleDownhill=e.myAdjustVerticalMovementWithCeilingAngleDownhill,this.myAdjustVerticalMovementWithCeilingAngleUphill=e.myAdjustVerticalMovementWithCeilingAngleUphill,this.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle=e.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle,this.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle=e.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle,this.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle=e.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle,this.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle=e.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle,this.myAdjustHorizontalMovementWithCeilingAngleDownhill=e.myAdjustHorizontalMovementWithCeilingAngleDownhill,this.myAdjustHorizontalMovementWithCeilingAngleDownhillMinAngle=e.myAdjustHorizontalMovementWithCeilingAngleDownhillMinAngle,this.myCheckVerticalFixedForwardEnabled=e.myCheckVerticalFixedForwardEnabled,this.myCheckVerticalFixedForward.vec3_copy(e.myCheckVerticalFixedForward),this.myCheckVerticalBothDirection=e.myCheckVerticalBothDirection,this.mySnapOnGroundEnabled=e.mySnapOnGroundEnabled,this.mySnapOnGroundExtraDistance=e.mySnapOnGroundExtraDistance,this.mySnapOnCeilingEnabled=e.mySnapOnCeilingEnabled,this.mySnapOnCeilingExtraDistance=e.mySnapOnCeilingExtraDistance,this.myGroundPopOutEnabled=e.myGroundPopOutEnabled,this.myGroundPopOutExtraDistance=e.myGroundPopOutExtraDistance,this.myCeilingPopOutEnabled=e.myCeilingPopOutEnabled,this.myCeilingPopOutExtraDistance=e.myCeilingPopOutExtraDistance,this.myVerticalMovementReduceEnabled=e.myVerticalMovementReduceEnabled,this.myGroundCircumferenceAddCenter=e.myGroundCircumferenceAddCenter,this.myGroundCircumferenceSliceAmount=e.myGroundCircumferenceSliceAmount,this.myGroundCircumferenceStepAmount=e.myGroundCircumferenceStepAmount,this.myGroundCircumferenceRotationPerStep=e.myGroundCircumferenceRotationPerStep,this.myVerticalAllowHitInsideCollisionIfOneOk=e.myVerticalAllowHitInsideCollisionIfOneOk,this.myCheckHeight=e.myCheckHeight,this.myCheckHeightVerticalMovement=e.myCheckHeightVerticalMovement,this.myCheckHeightVerticalPosition=e.myCheckHeightVerticalPosition,this.myCheckHeightTopMovement=e.myCheckHeightTopMovement,this.myCheckHeightTopPosition=e.myCheckHeightTopPosition,this.myCheckHeightConeOnCollision=e.myCheckHeightConeOnCollision,this.myCheckHeightConeOnCollisionKeepHit=e.myCheckHeightConeOnCollisionKeepHit,this.myHeightCheckStepAmountMovement=e.myHeightCheckStepAmountMovement,this.myHeightCheckStepAmountPosition=e.myHeightCheckStepAmountPosition,this.myCheckVerticalStraight=e.myCheckVerticalStraight,this.myCheckVerticalDiagonalRayOutward=e.myCheckVerticalDiagonalRayOutward,this.myCheckVerticalDiagonalRayInward=e.myCheckVerticalDiagonalRayInward,this.myCheckVerticalDiagonalBorderOutward=e.myCheckVerticalDiagonalBorderOutward,this.myCheckVerticalDiagonalBorderInward=e.myCheckVerticalDiagonalBorderInward,this.myCheckVerticalDiagonalBorderRayOutward=e.myCheckVerticalDiagonalBorderRayOutward,this.myCheckVerticalDiagonalBorderRayInward=e.myCheckVerticalDiagonalBorderRayInward,this.myCheckVerticalSearchFartherVerticalHit=e.myCheckVerticalSearchFartherVerticalHit,this.myGroundAngleToIgnore=e.myGroundAngleToIgnore,this.myGroundAngleToIgnoreWithPerceivedAngle=e.myGroundAngleToIgnoreWithPerceivedAngle,this.myCeilingAngleToIgnore=e.myCeilingAngleToIgnore,this.myCeilingAngleToIgnoreWithPerceivedAngle=e.myCeilingAngleToIgnoreWithPerceivedAngle,this.myHorizontalMovementGroundAngleIgnoreHeight=e.myHorizontalMovementGroundAngleIgnoreHeight,this.myHorizontalMovementCeilingAngleIgnoreHeight=e.myHorizontalMovementCeilingAngleIgnoreHeight,this.myHorizontalPositionGroundAngleIgnoreHeight=e.myHorizontalPositionGroundAngleIgnoreHeight,this.myHorizontalPositionCeilingAngleIgnoreHeight=e.myHorizontalPositionCeilingAngleIgnoreHeight,this.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft=e.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft,this.myHorizontalMovementCeilingAngleIgnoreMaxMovementLeft=e.myHorizontalMovementCeilingAngleIgnoreMaxMovementLeft,this.myHeight=e.myHeight,this.myComputeGroundInfoEnabled=e.myComputeGroundInfoEnabled,this.myComputeCeilingInfoEnabled=e.myComputeCeilingInfoEnabled,this.myDistanceToBeOnGround=e.myDistanceToBeOnGround,this.myDistanceToComputeGroundInfo=e.myDistanceToComputeGroundInfo,this.myDistanceToBeOnCeiling=e.myDistanceToBeOnCeiling,this.myDistanceToComputeCeilingInfo=e.myDistanceToComputeCeilingInfo,this.myVerticalFixToBeOnGround=e.myVerticalFixToBeOnGround,this.myVerticalFixToComputeGroundInfo=e.myVerticalFixToComputeGroundInfo,this.myVerticalFixToBeOnCeiling=e.myVerticalFixToBeOnCeiling,this.myVerticalFixToComputeCeilingInfo=e.myVerticalFixToComputeCeilingInfo,this.myGroundIsBaseInsideCollisionCheckEnabled=e.myGroundIsBaseInsideCollisionCheckEnabled,this.myCeilingIsBaseInsideCollisionCheckEnabled=e.myCeilingIsBaseInsideCollisionCheckEnabled,this.myIsOnGroundIfInsideHit=e.myIsOnGroundIfInsideHit,this.myIsOnCeilingIfInsideHit=e.myIsOnCeilingIfInsideHit,this.myIsOnGroundMaxSurfaceAngle=e.myIsOnGroundMaxSurfaceAngle,this.myIsOnCeilingMaxSurfaceAngle=e.myIsOnCeilingMaxSurfaceAngle,this.myFindGroundDistanceMaxOutsideDistance=e.myFindGroundDistanceMaxOutsideDistance,this.myFindGroundDistanceMaxInsideDistance=e.myFindGroundDistanceMaxInsideDistance,this.myFindCeilingDistanceMaxOutsideDistance=e.myFindCeilingDistanceMaxOutsideDistance,this.myFindCeilingDistanceMaxInsideDistance=e.myFindCeilingDistanceMaxInsideDistance,this.myAllowGroundSteepFix=e.myAllowGroundSteepFix,this.myAllowCeilingSteepFix=e.myAllowCeilingSteepFix,this.myMustStayOnGround=e.myMustStayOnGround,this.myMustStayOnCeiling=e.myMustStayOnCeiling,this.myMustStayOnValidGroundAngleDownhill=e.myMustStayOnValidGroundAngleDownhill,this.myMustStayOnValidCeilingAngleDownhill=e.myMustStayOnValidCeilingAngleDownhill,this.myRegatherGroundInfoOnSurfaceCheckFail=e.myRegatherGroundInfoOnSurfaceCheckFail,this.myRegatherCeilingInfoOnSurfaceCheckFail=e.myRegatherCeilingInfoOnSurfaceCheckFail,this.myMustStayBelowGroundAngleDownhill=e.myMustStayBelowGroundAngleDownhill,this.myMustStayBelowCeilingAngleDownhill=e.myMustStayBelowCeilingAngleDownhill,this.myMustStayBelowIgnorableGroundAngleDownhill=e.myMustStayBelowIgnorableGroundAngleDownhill,this.myMustStayBelowIgnorableCeilingAngleDownhill=e.myMustStayBelowIgnorableCeilingAngleDownhill,this.myMovementMustStayOnGroundHitAngle=e.myMovementMustStayOnGroundHitAngle,this.myMovementMustStayOnCeilingHitAngle=e.myMovementMustStayOnCeilingHitAngle,this.myTeleportMustBeOnIgnorableGroundAngle=e.myTeleportMustBeOnIgnorableGroundAngle,this.myCheckTransformMustBeOnIgnorableGroundAngle=e.myCheckTransformMustBeOnIgnorableGroundAngle,this.myTeleportMustBeOnIgnorableCeilingAngle=e.myTeleportMustBeOnIgnorableCeilingAngle,this.myCheckTransformMustBeOnIgnorableCeilingAngle=e.myCheckTransformMustBeOnIgnorableCeilingAngle,this.myTeleportMustBeOnGroundAngle=e.myTeleportMustBeOnGroundAngle,this.myCheckTransformMustBeOnGroundAngle=e.myCheckTransformMustBeOnGroundAngle,this.myTeleportMustBeOnCeilingAngle=e.myTeleportMustBeOnCeilingAngle,this.myCheckTransformMustBeOnCeilingAngle=e.myCheckTransformMustBeOnCeilingAngle,this.myTeleportMustBeOnGround=e.myTeleportMustBeOnGround,this.myCheckTransformMustBeOnGround=e.myCheckTransformMustBeOnGround,this.myTeleportMustBeOnCeiling=e.myTeleportMustBeOnCeiling,this.myCheckTransformMustBeOnCeiling=e.myCheckTransformMustBeOnCeiling,this.mySlidingEnabled=e.mySlidingEnabled,this.mySlidingHorizontalMovementCheckBetterNormal=e.mySlidingHorizontalMovementCheckBetterNormal,this.mySlidingMaxAttempts=e.mySlidingMaxAttempts,this.mySlidingCheckBothDirections=e.mySlidingCheckBothDirections,this.mySlidingFlickeringPreventionType=e.mySlidingFlickeringPreventionType,this.mySlidingFlickeringPreventionCheckOnlyIfAlreadySliding=e.mySlidingFlickeringPreventionCheckOnlyIfAlreadySliding,this.mySlidingFlickerPreventionCheckAnywayCounter=e.mySlidingFlickerPreventionCheckAnywayCounter,this.mySlidingAdjustSign90Degrees=e.mySlidingAdjustSign90Degrees,this.myHorizontalBlockLayerFlags.copy(e.myHorizontalBlockLayerFlags),this.myHorizontalObjectsToIgnore.pp_copy(e.myHorizontalObjectsToIgnore),this.myVerticalBlockLayerFlags.copy(e.myVerticalBlockLayerFlags),this.myVerticalObjectsToIgnore.pp_copy(e.myVerticalObjectsToIgnore),this.myExtraMovementCheckCallback=e.myExtraMovementCheckCallback,this.myExtraTeleportCheckCallback=e.myExtraTeleportCheckCallback,this.myExtraCheckTransformCheckCallback=e.myExtraCheckTransformCheckCallback,this.myDebugEnabled=e.myDebugEnabled,this.myDebugHorizontalMovementEnabled=e.myDebugHorizontalMovementEnabled,this.myDebugHorizontalPositionEnabled=e.myDebugHorizontalPositionEnabled,this.myDebugVerticalMovementEnabled=e.myDebugVerticalMovementEnabled,this.myDebugVerticalPositionEnabled=e.myDebugVerticalPositionEnabled,this.myDebugSlidingEnabled=e.myDebugSlidingEnabled,this.myDebugGroundInfoEnabled=e.myDebugGroundInfoEnabled,this.myDebugCeilingInfoEnabled=e.myDebugCeilingInfoEnabled,this.myDebugRuntimeParamsEnabled=e.myDebugRuntimeParamsEnabled,this.myDebugMovementEnabled=e.myDebugMovementEnabled}},de=class{constructor(){this.myOriginalPosition=p(),this.myNewPosition=p(),this.myOriginalHeight=0,this.myOriginalForward=p(),this.myOriginalUp=p(),this.myOffsetUp=p(),this.myOriginalMovement=p(),this.myFixedMovement=p(),this.myLastValidOriginalHorizontalMovement=p(),this.myLastValidOriginalVerticalMovement=p(),this.myLastValidSurfaceAdjustedHorizontalMovement=p(),this.myLastValidSurfaceAdjustedVerticalMovement=p(),this.myLastValidEndHorizontalMovement=p(),this.myLastValidEndVerticalMovement=p(),this.myIsOnGround=!1,this.myGroundAngle=0,this.myGroundPerceivedAngle=0,this.myGroundNormal=p(),this.myGroundHitMaxAngle=0,this.myGroundHitMaxNormal=p(),this.myGroundDistance=null,this.myGroundIsBaseInsideCollision=!1,this.myIsOnCeiling=!1,this.myCeilingAngle=0,this.myCeilingPerceivedAngle=0,this.myCeilingNormal=p(),this.myCeilingHitMaxAngle=0,this.myCeilingHitMaxNormal=p(),this.myCeilingDistance=null,this.myCeilingIsBaseInsideCollision=!1,this.myHorizontalMovementCanceled=!1,this.myIsCollidingHorizontally=!1,this.myHorizontalCollisionHit=new st,this.myVerticalMovementCanceled=!1,this.myIsCollidingVertically=!1,this.myVerticalCollisionHit=new st,this.myHasSnappedOnGround=!1,this.myHasSnappedOnCeiling=!1,this.myHasPoppedOutGround=!1,this.myHasPoppedOutCeiling=!1,this.myHasReducedVerticalMovement=!1,this.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleDownhill=!1,this.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleUphill=!1,this.myVerticalMovementHasAdjustedHorizontalMovementOverGroundAngleDownhill=!1,this.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleDownhill=!1,this.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleUphill=!1,this.myVerticalMovementHasAdjustedHorizontalMovementOverCeilingAngleDownhill=!1,this.myIsSliding=!1,this.myIsSlidingIntoOppositeDirection=!1,this.myIsSlidingFlickerPrevented=!1,this.mySlidingFlickerPreventionCheckAnywayCounter=0,this.mySlidingMovementAngle=0,this.mySlidingCollisionAngle=0,this.mySlidingCollisionHit=new st,this.mySlidingWallNormal=new p,this.mySliding90DegreesSign=0,this.mySlidingRecompute90DegreesSign=!0,this.myLastValidIsSliding=!1,this.mySlidingPreviousHorizontalMovement=p(),this.myOriginalTeleportPosition=p(),this.myFixedTeleportPosition=p(),this.myOriginalPositionCheckPosition=p(),this.myFixedPositionCheckPosition=p(),this.myTeleportCanceled=!1,this.myIsPositionOk=!1,this.myIsTeleport=!1,this.myIsMove=!1,this.myIsPositionCheck=!1,this.myIsPositionCheckAllowAdjustments=!1,this.mySplitMovementSteps=0,this.mySplitMovementStepsPerformed=0,this.mySplitMovementStop=!1,this.mySplitMovementMovementChecked=p(),this.myRealIsOnGround=!1,this.myRealIsOnCeiling=!1}reset(){this.myOriginalPosition.vec3_zero(),this.myNewPosition.vec3_zero(),this.myOriginalHeight=0,this.myOriginalForward.vec3_zero(),this.myOriginalUp.vec3_zero(),this.myOffsetUp.vec3_zero(),this.myOriginalMovement.vec3_zero(),this.myFixedMovement.vec3_zero(),this.myLastValidOriginalHorizontalMovement.vec3_zero(),this.myLastValidOriginalVerticalMovement.vec3_zero(),this.myLastValidSurfaceAdjustedHorizontalMovement.vec3_zero(),this.myLastValidSurfaceAdjustedVerticalMovement.vec3_zero(),this.myLastValidEndHorizontalMovement.vec3_zero(),this.myLastValidEndVerticalMovement.vec3_zero(),this.myIsOnGround=!1,this.myGroundAngle=0,this.myGroundPerceivedAngle=0,this.myGroundNormal.vec3_zero(),this.myGroundHitMaxAngle=0,this.myGroundHitMaxNormal.vec3_zero(),this.myGroundDistance=null,this.myGroundIsBaseInsideCollision=!1,this.myIsOnCeiling=!1,this.myCeilingAngle=0,this.myCeilingPerceivedAngle=0,this.myCeilingNormal.vec3_zero(),this.myCeilingHitMaxAngle=0,this.myCeilingHitMaxNormal.vec3_zero(),this.myCeilingDistance=null,this.myCeilingIsBaseInsideCollision=!1,this.myHorizontalMovementCanceled=!1,this.myIsCollidingHorizontally=!1,this.myHorizontalCollisionHit.reset(),this.myVerticalMovementCanceled=!1,this.myIsCollidingVertically=!1,this.myVerticalCollisionHit.reset(),this.myHasSnappedOnGround=!1,this.myHasSnappedOnCeiling=!1,this.myHasPoppedOutGround=!1,this.myHasPoppedOutCeiling=!1,this.myHasReducedVerticalMovement=!1,this.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleDownhill=!1,this.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleUphill=!1,this.myVerticalMovementHasAdjustedHorizontalMovementOverGroundAngleDownhill=!1,this.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleDownhill=!1,this.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleUphill=!1,this.myVerticalMovementHasAdjustedHorizontalMovementOverCeilingAngleDownhill=!1,this.myIsSliding=!1,this.myIsSlidingIntoOppositeDirection=!1,this.myIsSlidingFlickerPrevented=!1,this.mySlidingFlickerPreventionCheckAnywayCounter=0,this.mySlidingMovementAngle=0,this.mySlidingCollisionAngle=0,this.mySlidingCollisionHit.reset(),this.mySliding90DegreesSign=0,this.mySlidingRecompute90DegreesSign=!0,this.myLastValidIsSliding=!1,this.mySlidingPreviousHorizontalMovement.vec3_zero(),this.mySlidingWallNormal.vec3_zero(),this.myOriginalTeleportPosition.vec3_zero(),this.myFixedTeleportPosition.vec3_zero(),this.myOriginalPositionCheckPosition.vec3_zero(),this.myFixedPositionCheckPosition.vec3_zero(),this.myTeleportCanceled=!1,this.myIsPositionOk=!1,this.myIsTeleport=!1,this.myIsMove=!1,this.myIsPositionCheck=!1,this.myIsPositionCheckAllowAdjustments=!1,this.mySplitMovementSteps=0,this.mySplitMovementStepsPerformed=0,this.mySplitMovementStop=!1,this.mySplitMovementMovementChecked.vec3_zero(),this.myRealIsOnGround=!1,this.myRealIsOnCeiling=!1}copy(e){this.myOriginalPosition.vec3_copy(e.myOriginalPosition),this.myNewPosition.vec3_copy(e.myNewPosition),this.myOriginalHeight=e.myOriginalHeight,this.myOriginalForward.vec3_copy(e.myOriginalForward),this.myOriginalUp.vec3_copy(e.myOriginalUp),this.myOffsetUp.vec3_copy(e.myOffsetUp),this.myOriginalMovement.vec3_copy(e.myOriginalMovement),this.myFixedMovement.vec3_copy(e.myFixedMovement),this.myLastValidOriginalHorizontalMovement.vec3_copy(e.myLastValidOriginalHorizontalMovement),this.myLastValidOriginalVerticalMovement.vec3_copy(e.myLastValidOriginalVerticalMovement),this.myLastValidSurfaceAdjustedHorizontalMovement.vec3_copy(e.myLastValidSurfaceAdjustedHorizontalMovement),this.myLastValidSurfaceAdjustedVerticalMovement.vec3_copy(e.myLastValidSurfaceAdjustedVerticalMovement),this.myLastValidEndHorizontalMovement.vec3_copy(e.myLastValidEndHorizontalMovement),this.myLastValidEndVerticalMovement.vec3_copy(e.myLastValidEndVerticalMovement),this.myIsOnGround=e.myIsOnGround,this.myGroundAngle=e.myGroundAngle,this.myGroundPerceivedAngle=e.myGroundPerceivedAngle,this.myGroundNormal.vec3_copy(e.myGroundNormal),this.myGroundHitMaxAngle=e.myGroundHitMaxAngle,this.myGroundHitMaxNormal.vec3_copy(e.myGroundHitMaxNormal),this.myGroundDistance=e.myGroundDistance,this.myGroundIsBaseInsideCollision=e.myGroundIsBaseInsideCollision,this.myIsOnCeiling=e.myIsOnCeiling,this.myCeilingAngle=e.myCeilingAngle,this.myCeilingPerceivedAngle=e.myCeilingPerceivedAngle,this.myCeilingNormal.vec3_copy(e.myCeilingNormal),this.myCeilingHitMaxAngle=e.myCeilingHitMaxAngle,this.myCeilingHitMaxNormal.vec3_copy(e.myCeilingHitMaxNormal),this.myCeilingDistance=e.myCeilingDistance,this.myCeilingIsBaseInsideCollision=e.myCeilingIsBaseInsideCollision,this.myHorizontalMovementCanceled=e.myHorizontalMovementCanceled,this.myIsCollidingHorizontally=e.myIsCollidingHorizontally,this.myHorizontalCollisionHit.copy(e.myHorizontalCollisionHit),this.myVerticalMovementCanceled=e.myVerticalMovementCanceled,this.myIsCollidingVertically=e.myIsCollidingVertically,this.myVerticalCollisionHit.copy(e.myVerticalCollisionHit),this.myHasSnappedOnGround=e.myHasSnappedOnGround,this.myHasSnappedOnCeiling=e.myHasSnappedOnCeiling,this.myHasPoppedOutGround=e.myHasPoppedOutGround,this.myHasPoppedOutCeiling=e.myHasPoppedOutCeiling,this.myHasReducedVerticalMovement=e.myHasReducedVerticalMovement,this.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleDownhill=e.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleDownhill,this.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleUphill=e.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleUphill,this.myVerticalMovementHasAdjustedHorizontalMovementOverGroundAngleDownhill=e.myVerticalMovementHasAdjustedHorizontalMovementOverGroundAngleDownhill,this.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleDownhill=e.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleDownhill,this.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleUphill=e.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleUphill,this.myVerticalMovementHasAdjustedHorizontalMovementOverCeilingAngleDownhill=e.myVerticalMovementHasAdjustedHorizontalMovementOverCeilingAngleDownhill,this.myIsSliding=e.myIsSliding,this.myIsSlidingIntoOppositeDirection=e.myIsSlidingIntoOppositeDirection,this.myIsSlidingFlickerPrevented=e.myIsSlidingFlickerPrevented,this.mySlidingFlickerPreventionCheckAnywayCounter=e.mySlidingFlickerPreventionCheckAnywayCounter,this.mySlidingMovementAngle=e.mySlidingMovementAngle,this.mySlidingCollisionAngle=e.mySlidingCollisionAngle,this.mySlidingCollisionHit.copy(e.mySlidingCollisionHit),this.mySliding90DegreesSign=e.mySliding90DegreesSign,this.mySlidingRecompute90DegreesSign=e.mySlidingRecompute90DegreesSign,this.myLastValidIsSliding=e.myLastValidIsSliding,this.mySlidingPreviousHorizontalMovement.vec3_copy(e.mySlidingPreviousHorizontalMovement),this.mySlidingWallNormal.vec3_copy(e.mySlidingWallNormal),this.myOriginalTeleportPosition.vec3_copy(e.myOriginalTeleportPosition),this.myFixedTeleportPosition.vec3_copy(e.myFixedTeleportPosition),this.myTeleportCanceled=e.myTeleportCanceled,this.myIsPositionOk=e.myIsPositionOk,this.myOriginalPositionCheckPosition.vec3_copy(e.myOriginalPositionCheckPosition),this.myFixedPositionCheckPosition.vec3_copy(e.myFixedPositionCheckPosition),this.myIsTeleport=e.myIsTeleport,this.myIsMove=e.myIsMove,this.myIsPositionCheck=e.myIsPositionCheck,this.myIsPositionCheckAllowAdjustments=e.myIsPositionCheckAllowAdjustments,this.mySplitMovementSteps=e.mySplitMovementSteps,this.mySplitMovementStepsPerformed=e.mySplitMovementStepsPerformed,this.mySplitMovementStop=e.mySplitMovementStop,this.mySplitMovementMovementChecked.vec3_copy(e.mySplitMovementMovementChecked),this.myRealIsOnGround=e.myRealIsOnGround,this.myRealIsOnCeiling=e.myRealIsOnCeiling}};function ZC(i,e=new et){return e.copy(i),e.myHalfConeAngle=180,e.myHalfConeSliceAmount=Math.round(e.myHalfConeAngle/i.myHalfConeAngle*i.myHalfConeSliceAmount),e.myCheckHorizontalFixedForwardEnabled=!0,e.myCheckHorizontalFixedForward=p(0,0,1),e}var Os={generate360TeleportParamsFromMovementParams:ZC},N=class{constructor(e=m.getMainEngine()){this._myEngine=e,this._myRaycastParams=new ut(m.getPhysics(this._myEngine)),this._myRaycastResult=new ke,this._myFixRaycastResult=new ke,this._myBackupRaycastHit=new st,this._myPrevCollisionRuntimeParams=new de,this._mySlidingCollisionRuntimeParams=new de,this._myCheckBetterSlidingNormalCollisionRuntimeParams=new de,this._myInternalSlidingCollisionRuntimeParams=new de,this._mySlidingFlickeringFixCollisionRuntimeParams=new de,this._mySlidingFlickeringFixSlidingCollisionRuntimeParams=new de,this._mySlidingOppositeDirectionCollisionRuntimeParams=new de,this._mySlidingOnVerticalCheckCollisionRuntimeParams=new de,this._myDebugEnabled=!1,this._myTotalRaycasts=0,this._myTotalRaycastsMax=0}move(e,t,n,o){this._move(e,t,n,o)}teleport(e,t,n,o){this._teleport(e,t,n,o)}positionCheck(e,t,n,o){this._positionCheck(e,t,n,o)}updateSurfaceInfo(e,t,n){this._updateSurfaceInfo(e,t,n)}_debugMovement(e,t,n,o,s){let a=e.vec3_removeComponentAlongAxis(o),l=t.vec3_removeComponentAlongAxis(o),h=t.vec3_componentAlongAxis(o),_=n.vec3_add(o.vec3_scale(s.myDistanceFromFeetToIgnore+.001));a.vec3_isZero()||(a.vec3_normalize(a),m.getDebugVisualManager(this._myEngine).drawArrow(0,_,a,.2,F(.5,.5,1,1))),l.vec3_isZero()||(l.vec3_normalize(l),m.getDebugVisualManager(this._myEngine).drawArrow(0,_,l,.2,F(0,0,1,1))),h.vec3_isZero()||(h.vec3_normalize(h),m.getDebugVisualManager(this._myEngine).drawArrow(0,n,h,.2,F(0,0,1,1)))}_debugRuntimeParams(e){e.myHorizontalCollisionHit.isValid()&&m.getDebugVisualManager(this._myEngine).drawArrow(0,e.myHorizontalCollisionHit.myPosition,e.myHorizontalCollisionHit.myNormal,.2,F(1,0,0,1)),e.mySlidingCollisionHit.isValid()&&m.getDebugVisualManager(this._myEngine).drawArrow(0,e.mySlidingCollisionHit.myPosition,e.mySlidingCollisionHit.myNormal,.2,F(1,0,0,1)),e.myVerticalCollisionHit.isValid()&&m.getDebugVisualManager(this._myEngine).drawArrow(0,e.myVerticalCollisionHit.myPosition,e.myVerticalCollisionHit.myNormal,.2,F(1,0,0,1))}_raycastAndDebug(e,t,n,o,s,a,l){}};N.prototype._raycastAndDebug=function(){let i=new ke;return function(t,n,o,s,a,l,h){this._myRaycastParams.myOrigin.vec3_copy(t),this._myRaycastParams.myDirection.vec3_copy(n),this._myRaycastParams.myDistance=o,a?(this._myRaycastParams.myBlockLayerFlags.copy(l.myHorizontalBlockLayerFlags),this._myRaycastParams.myObjectsToIgnore=l.myHorizontalObjectsToIgnore):(this._myRaycastParams.myBlockLayerFlags.copy(l.myVerticalBlockLayerFlags),this._myRaycastParams.myObjectsToIgnore=l.myVerticalObjectsToIgnore),this._myRaycastParams.myIgnoreHitsInsideCollision=s;let _=null;return!1&&m.isDebugEnabled(this._myEngine)?((!1||!this._myRaycastResult.isColliding())&&(_=De.raycast(this._myRaycastParams,i)),!this._myRaycastResult.isColliding()&&i.isColliding()&&this._myRaycastResult.copy(i),_=this._myRaycastResult):_=De.raycast(this._myRaycastParams,this._myRaycastResult),this._myTotalRaycasts++,this._myDebugEnabled&&m.isDebugEnabled(this._myEngine)&&m.getDebugVisualManager(this._myEngine).drawRaycast(0,_),_}}();N.prototype._move=function(){let i=p(),e=p(),t=p(),n=G(),o=G(),s=p(),a=p(),l=p(),h=p(),_=p(),y=p(),r=p(),u=p(),g=new de,P=p(),C=p();return function(S,M,D,v){n.quat2_setPositionRotationQuat(D.myPositionOffsetLocal,D.myRotationOffsetLocalQuat),o=n.quat2_toWorld(M,o),M.vec_equals(o,1e-5)&&o.quat2_copy(M),i=o.quat2_getUp(i),e=o.quat2_getForward(e),t=o.quat2_getPosition(t);let b=D.myHeight;b=b-1e-5,b<1e-5&&(b=0),s=S.vec3_removeComponentAlongAxis(i,s),a=S.vec3_componentAlongAxis(i,a);let x=1;if(l.vec3_copy(S),!S.vec3_isZero(1e-5)&&D.mySplitMovementEnabled){let k=S.vec3_length()/D.mySplitMovementMaxSteps;if(!D.mySplitMovementStepEqualLength||k<D.mySplitMovementStepEqualLengthMinLength){let U=D.mySplitMovementStepEqualLength?D.mySplitMovementStepEqualLengthMinLength:D.mySplitMovementMaxLength;x=Math.ceil(S.vec3_length()/U),x>1&&(l=l.vec3_normalize(l).vec3_scale(U,l),x=D.mySplitMovementMaxStepsEnabled?Math.min(x,D.mySplitMovementMaxSteps):x),x=Math.max(1,x),x==1&&l.vec3_copy(S)}else x=D.mySplitMovementMaxSteps,x>1&&(l=l.vec3_normalize(l).vec3_scale(k,l))}y.vec3_zero(),_.vec3_zero(),g.copy(v),P.vec3_copy(y),C.vec3_copy(_);let I=0,L=!1;for(let k=0;k<x;k++){if(x==1||k!=x-1?h.vec3_copy(l):h=S.vec3_sub(_,h),r=t.vec3_add(y,r),u.vec3_zero(),u=this._moveStep(h,r,i,e,b,!0,D,v,u),y.vec3_add(u,y),_=_.vec3_add(l,_),I=k+1,v.myHorizontalMovementCanceled&&v.myVerticalMovementCanceled||v.myHorizontalMovementCanceled&&D.mySplitMovementStopWhenHorizontalMovementCanceled||v.myVerticalMovementCanceled&&D.mySplitMovementStopWhenVerticalMovementCanceled||D.mySplitMovementStopCallback!=null&&D.mySplitMovementStopCallback(v)){D.mySplitMovementStopReturnPrevious&&(v.copy(g),y.vec3_copy(P),_.vec3_copy(C),I-=1),L=!0;break}g.copy(v),P.vec3_copy(y),C.vec3_copy(_)}v.mySplitMovementSteps=x,v.mySplitMovementStepsPerformed=I,v.mySplitMovementStop=L,v.mySplitMovementMovementChecked.vec3_copy(_),v.myOriginalUp=M.quat2_getUp(v.myOriginalUp),v.myOriginalForward=M.quat2_getForward(v.myOriginalForward),v.myOriginalPosition=M.quat2_getPosition(v.myOriginalPosition),v.myOffsetUp.vec3_copy(i),v.myOriginalHeight=D.myHeight,v.myOriginalMovement.vec3_copy(S),v.myFixedMovement.vec3_copy(y),v.myNewPosition=v.myOriginalPosition.vec3_add(v.myFixedMovement,v.myNewPosition),v.myIsMove=!0}}();N.prototype._moveStep=function(){let i=p(),e=p(),t=p(),n=p(),o=p(),s=p(),a=p(),l=p(),h=p(),_=p(),y=p(),r=p(),u=p(0,0,1),g=p(1,0,0);return function(C,f,S,M,D,v,b,x,I){i=C.vec3_removeComponentAlongAxis(S,i),i.vec3_isZero(1e-6)&&i.vec3_zero(),e=C.vec3_componentAlongAxis(S,e),e.vec3_isZero(1e-6)&&e.vec3_zero(),i.vec3_isZero(),this._myPrevCollisionRuntimeParams.copy(x),x.reset(),y=this._adjustHorizontalMovementWithSurface(i,e,S,b,x,this._myPrevCollisionRuntimeParams,y),y.vec3_isZero(1e-5)&&y.vec3_zero(),this._syncCollisionRuntimeParamsWithPrevious(y,e,S,b,x,this._myPrevCollisionRuntimeParams),s.vec3_copy(b.myCheckHorizontalFixedForward),b.myCheckHorizontalFixedForwardEnabled?(b.myCheckHorizontalFixedForward.vec3_isOnAxis(S)&&(u.vec3_isOnAxis(S)?s.vec3_copy(g):s.vec3_copy(u)),s=s.vec3_removeComponentAlongAxis(S,s),s=s.vec3_normalize(s),s.vec_equals(b.myCheckHorizontalFixedForward,1e-5)&&s.vec3_copy(b.myCheckHorizontalFixedForward)):y.vec3_isZero()?i.vec3_isZero()?s.vec3_copy(M):s=i.vec3_normalize(s):s=y.vec3_normalize(s),t.vec3_zero(),y.vec3_isZero()||(t=this._horizontalCheck(y,f,D,S,s,v,b,x,this._myPrevCollisionRuntimeParams,!1,t),b.mySlidingEnabled&&x.myIsCollidingHorizontally&&this._isSlidingNormalValid(y,S,x)&&(t=this._horizontalSlide(y,f,D,S,s,v,b,x,this._myPrevCollisionRuntimeParams,t))),t.vec3_isZero(1e-6)&&t.vec3_zero(),!y.vec3_isZero()&&t.vec3_isZero()&&(x.myHorizontalMovementCanceled=!0);{a.vec3_copy(b.myCheckVerticalFixedForward),b.myCheckVerticalFixedForwardEnabled?(b.myCheckVerticalFixedForward.vec3_isOnAxis(S)&&(u.vec3_isOnAxis(S)?a.vec3_copy(g):a.vec3_copy(u)),a=a.vec3_removeComponentAlongAxis(S,a),a=a.vec3_normalize(a),a.vec_equals(b.myCheckVerticalFixedForward,1e-5)&&a.vec3_copy(b.myCheckVerticalFixedForward)):t.vec3_isZero()?y.vec3_isZero()?i.vec3_isZero()?a.vec3_copy(M):a=i.vec3_normalize(a):a=y.vec3_normalize(a):a=t.vec3_normalize(a),_=this._adjustVerticalMovementWithSurface(t,e,S,b,x,this._myPrevCollisionRuntimeParams,_),h=f.vec3_add(t,h);let k=Math.pp_sign(e.vec3_lengthSigned(S),0);n.vec3_zero(),n=this._verticalCheck(_,k,h,D,S,a,b,x,n),n.vec3_isZero(1e-6)&&n.vec3_zero()}I.vec3_zero(),x.myIsCollidingVertically?(x.myHorizontalMovementCanceled=!0,x.myVerticalMovementCanceled=!0,t.vec3_zero(),n.vec3_zero(),b.myCheckVerticalFixedForwardEnabled||(y.vec3_isZero()?i.vec3_isZero()?a.vec3_copy(M):a=i.vec3_normalize(a):a=y.vec3_normalize(a))):I=t.vec3_add(n,I),h=f.vec3_add(I,h),l.vec3_copy(M),t.vec3_isZero()?y.vec3_isZero()?i.vec3_isZero()||(l=i.vec3_normalize(l)):l=y.vec3_normalize(l):l=t.vec3_normalize(l),b.myComputeGroundInfoEnabled&&this._gatherSurfaceInfo(h,D,S,l,a,!0,b,x),b.myComputeCeilingInfoEnabled&&this._gatherSurfaceInfo(h,D,S,l,a,!1,b,x),!y.vec3_isZero()&&!x.myHorizontalMovementCanceled&&(this._postSurfaceCheck(t,n,S,b,x,this._myPrevCollisionRuntimeParams)||(x.myHorizontalMovementCanceled=!0,x.myVerticalMovementCanceled=!0,t.vec3_zero(),n.vec3_zero(),I.vec3_zero(),h=f.vec3_add(I,h),y.vec3_isZero()?i.vec3_isZero()?l.vec3_copy(M):l=i.vec3_normalize(l):l=y.vec3_normalize(l),b.myComputeGroundInfoEnabled&&b.myRegatherGroundInfoOnSurfaceCheckFail?this._gatherSurfaceInfo(h,D,S,l,a,!0,b,x):(x.myIsOnGround=this._myPrevCollisionRuntimeParams.myIsOnGround,x.myGroundAngle=this._myPrevCollisionRuntimeParams.myGroundAngle,x.myGroundPerceivedAngle=this._myPrevCollisionRuntimeParams.myGroundPerceivedAngle,x.myGroundNormal.vec3_copy(this._myPrevCollisionRuntimeParams.myGroundNormal)),b.myComputeCeilingInfoEnabled&&b.myRegatherCeilingInfoOnSurfaceCheckFail?this._gatherSurfaceInfo(h,D,S,l,a,!1,b,x):(x.myIsOnCeiling=this._myPrevCollisionRuntimeParams.myIsOnCeiling,x.myCeilingAngle=this._myPrevCollisionRuntimeParams.myCeilingAngle,x.myCeilingPerceivedAngle=this._myPrevCollisionRuntimeParams.myCeilingPerceivedAngle,x.myCeilingNormal.vec3_copy(this._myPrevCollisionRuntimeParams.myCeilingNormal)))),b.myExtraMovementCheckCallback!=null&&(r.vec3_copy(I),I=b.myExtraMovementCheckCallback(C,r,f,S,M,D,b,this._myPrevCollisionRuntimeParams,x,I),t=I.vec3_removeComponentAlongAxis(S,t),n=I.vec3_componentAlongAxis(S,n)),b.mySlidingAdjustSign90Degrees&&!x.myHorizontalMovementCanceled&&!x.myIsSliding&&!t.vec3_isZero()&&(x.mySlidingRecompute90DegreesSign=!0),i.vec3_isZero()||x.myLastValidOriginalHorizontalMovement.vec3_copy(i),y.vec3_isZero()||x.myLastValidSurfaceAdjustedHorizontalMovement.vec3_copy(y),e.vec3_isZero()||x.myLastValidOriginalVerticalMovement.vec3_copy(e),_.vec3_isZero()||x.myLastValidSurfaceAdjustedVerticalMovement.vec3_copy(_),t.vec3_isZero(1e-6)||(x.myLastValidIsSliding=x.myIsSliding,x.myIsSlidingFlickerPrevented=!1,x.myLastValidEndHorizontalMovement.vec3_copy(t),x.myIsSliding),n.vec3_isZero(1e-6)||x.myLastValidEndVerticalMovement.vec3_copy(n);let L=!1;if(!x.myHorizontalMovementCanceled&&!t.vec3_isZero(1e-6)){o=t.vec3_normalize(o);let k=this._surfaceTooSteep(S,o,b,this._myPrevCollisionRuntimeParams);if(k[0]||k[1]){o=t.vec3_normalize(o);let U=this._surfaceTooSteep(S,o,b,x);(k[0]&&U[0]||k[1]&&U[1]||!v||k[0]&&!b.myAllowGroundSteepFix||k[1]&&!b.myAllowCeilingSteepFix)&&(I.vec3_zero(),x.copy(this._myPrevCollisionRuntimeParams),this._moveStep(C,f,S,M,D,!1,b,x,I),L=!0)}}return L||(b.myDebugEnabled&&b.myDebugMovementEnabled&&m.isDebugEnabled(this._myEngine)&&this._debugMovement(C,I,h,S,b),b.myDebugEnabled&&b.myDebugRuntimeParamsEnabled&&m.isDebugEnabled(this._myEngine)&&this._debugRuntimeParams(x)),I}}();N.prototype._syncCollisionRuntimeParamsWithPrevious=function(){let i=p();return function(t,n,o,s,a,l){if(a.myIsSlidingFlickerPrevented=l.myIsSlidingFlickerPrevented,a.myLastValidOriginalHorizontalMovement.vec3_copy(l.myLastValidOriginalHorizontalMovement),a.myLastValidOriginalVerticalMovement.vec3_copy(l.myLastValidOriginalVerticalMovement),a.myLastValidSurfaceAdjustedHorizontalMovement.vec3_copy(l.myLastValidSurfaceAdjustedHorizontalMovement),a.myLastValidSurfaceAdjustedVerticalMovement.vec3_copy(l.myLastValidSurfaceAdjustedVerticalMovement),a.myLastValidIsSliding=l.myLastValidIsSliding,a.mySliding90DegreesSign=l.mySliding90DegreesSign,a.mySlidingRecompute90DegreesSign=l.mySlidingRecompute90DegreesSign,s.mySlidingAdjustSign90Degrees){let h=.5;if(!l.myLastValidSurfaceAdjustedHorizontalMovement.vec3_isZero()&&!t.vec3_isZero()&&t.vec3_angle(l.myLastValidSurfaceAdjustedHorizontalMovement)>h){if(!l.myLastValidIsSliding){let _=t.vec3_angleSigned(l.myLastValidSurfaceAdjustedHorizontalMovement,o),y=10;Math.abs(_)<180-y&&(a.mySliding90DegreesSign=Math.pp_sign(_))}a.mySlidingRecompute90DegreesSign=!0}}i=l.myFixedMovement.vec3_removeComponentAlongAxis(o,i),i.vec3_isZero(1e-6)?a.mySlidingPreviousHorizontalMovement.vec3_copy(l.mySlidingPreviousHorizontalMovement):a.mySlidingPreviousHorizontalMovement.vec3_copy(i)}}();Object.defineProperty(N.prototype,"_move",{enumerable:!1});Object.defineProperty(N.prototype,"_moveStep",{enumerable:!1});Object.defineProperty(N.prototype,"_syncCollisionRuntimeParamsWithPrevious",{enumerable:!1});N.prototype._teleport=function(){let i=p(),e=p(),t=p(),n=p(),o=G(),s=G(),a=p(),l=p(),h=p(),_=p(),y=p(),r=p(),u=p(),g=p(),P=p(),C=p(),f=p(0,0,1),S=p(1,0,0);return function(D,v,b,x,I=!1){o.quat2_setPositionRotationQuat(b.myPositionOffsetLocal,b.myRotationOffsetLocalQuat),s=o.quat2_toWorld(v,s),v.vec_equals(s,1e-5)&&s.quat2_copy(v),i=s.quat2_getUp(i),e=s.quat2_getForward(e),t=s.quat2_getPosition(t),l.vec3_copy(D),n=v.quat2_getPosition(n),a=n.vec3_sub(t,a),a.vec3_isZero(1e-5)?a.vec3_zero():l=l.vec3_sub(a,l);let L=b.myHeight;if(L=L-1e-5,L<1e-5&&(L=0),this._myPrevCollisionRuntimeParams.copy(x),x.reset(),_.vec3_copy(b.myCheckHorizontalFixedForward),b.myCheckHorizontalFixedForwardEnabled?(b.myCheckHorizontalFixedForward.vec3_isOnAxis(i)&&(f.vec3_isOnAxis(i)?_.vec3_copy(S):_.vec3_copy(f)),_=_.vec3_removeComponentAlongAxis(i,_),_=_.vec3_normalize(_),_.vec_equals(b.myCheckHorizontalFixedForward,1e-5)&&_.vec3_copy(b.myCheckHorizontalFixedForward)):_.vec3_copy(e),u=this._horizontalCheck(h,l,L,i,_,!1,b,x,this._myPrevCollisionRuntimeParams,!1,u),x.myIsCollidingHorizontally)x.myTeleportCanceled=!0;else{P=l.vec3_add(u,P),y.vec3_copy(b.myCheckVerticalFixedForward),b.myCheckVerticalFixedForwardEnabled?(b.myCheckVerticalFixedForward.vec3_isOnAxis(i)&&(f.vec3_isOnAxis(i)?y.vec3_copy(S):y.vec3_copy(f)),y=y.vec3_removeComponentAlongAxis(i,y),y=y.vec3_normalize(y),y.vec_equals(b.myCheckVerticalFixedForward,1e-5)&&y.vec3_copy(b.myCheckVerticalFixedForward)):y.vec3_copy(e);let k=-1;if(g=this._verticalCheck(h,k,P,L,i,y,b,x,g),x.myIsCollidingVertically)x.myTeleportCanceled=!0;else{if(P=P.vec3_add(g,P),r.vec3_copy(e),b.myComputeGroundInfoEnabled&&this._gatherSurfaceInfo(P,L,i,r,y,!0,b,x),b.myComputeCeilingInfoEnabled&&this._gatherSurfaceInfo(P,L,i,r,y,!1,b,x),x.myIsOnGround||(b.myTeleportMustBeOnGround&&!I||b.myCheckTransformMustBeOnGround&&I)&&(x.myTeleportCanceled=!0),x.myIsOnCeiling||(b.myTeleportMustBeOnCeiling&&!I||b.myCheckTransformMustBeOnCeiling&&I)&&(x.myTeleportCanceled=!0),x.myIsOnGround){let U=null;I?(b.myCheckTransformMustBeOnIgnorableGroundAngle&&(U=b.myGroundAngleToIgnore),b.myCheckTransformMustBeOnGroundAngle!=null&&(U=Math.min(U,b.myCheckTransformMustBeOnGroundAngle))):(b.myTeleportMustBeOnIgnorableGroundAngle&&(U=b.myGroundAngleToIgnore),b.myTeleportMustBeOnGroundAngle!=null&&(U=Math.min(U,b.myTeleportMustBeOnGroundAngle))),U!=null&&x.myGroundAngle>U+1e-4&&(x.myTeleportCanceled=!0)}if(x.myIsOnCeiling){let U=null;I?(b.myCheckTransformMustBeOnIgnorableCeilingAngle&&(U=b.myCeilingAngleToIgnore),b.myCheckTransformMustBeOnCeilingAngle!=null&&(U=Math.min(U,b.myCheckTransformMustBeOnCeilingAngle))):(b.myTeleportMustBeOnIgnorableCeilingAngle&&(U=b.myCeilingAngleToIgnore),b.myTeleportMustBeOnCeilingAngle!=null&&(U=Math.min(U,b.myTeleportMustBeOnCeilingAngle))),U!=null&&x.myCeilingAngle>U+1e-4&&(x.myTeleportCanceled=!0)}x.myTeleportCanceled&&(b.myComputeGroundInfoEnabled&&b.myRegatherGroundInfoOnSurfaceCheckFail?this._gatherSurfaceInfo(P,L,i,r,y,!0,b,x):(x.myIsOnGround=this._myPrevCollisionRuntimeParams.myIsOnGround,x.myGroundAngle=this._myPrevCollisionRuntimeParams.myGroundAngle,x.myGroundPerceivedAngle=this._myPrevCollisionRuntimeParams.myGroundPerceivedAngle,x.myGroundNormal.vec3_copy(this._myPrevCollisionRuntimeParams.myGroundNormal)),b.myComputeCeilingInfoEnabled&&b.myRegatherCeilingInfoOnSurfaceCheckFail?this._gatherSurfaceInfo(P,L,i,r,y,!1,b,x):(x.myIsOnCeiling=this._myPrevCollisionRuntimeParams.myIsOnCeiling,x.myCeilingAngle=this._myPrevCollisionRuntimeParams.myCeilingAngle,x.myCeilingPerceivedAngle=this._myPrevCollisionRuntimeParams.myCeilingPerceivedAngle,x.myCeilingNormal.vec3_copy(this._myPrevCollisionRuntimeParams.myCeilingNormal)))}}I?b.myExtraCheckTransformCheckCallback!=null&&(C.vec3_copy(P),P=b.myExtraCheckTransformCheckCallback(C,t,i,e,L,b,this._myPrevCollisionRuntimeParams,x,P)):b.myExtraTeleportCheckCallback!=null&&(C.vec3_copy(P),P=b.myExtraTeleportCheckCallback(l,C,t,i,e,L,b,this._myPrevCollisionRuntimeParams,x,P)),x.myOriginalUp=v.quat2_getUp(x.myOriginalUp),x.myOriginalForward=v.quat2_getForward(x.myOriginalForward),x.myOriginalPosition=v.quat2_getPosition(x.myOriginalPosition),x.myOriginalHeight=b.myHeight,x.myOriginalTeleportPosition.vec3_copy(D),x.myTeleportCanceled?x.myNewPosition.vec3_copy(x.myOriginalPosition):(x.myFixedTeleportPosition.vec3_copy(P),a.vec3_isZero(1e-5)||(x.myFixedTeleportPosition=x.myFixedTeleportPosition.vec3_add(a,x.myFixedTeleportPosition)),x.myNewPosition.vec3_copy(x.myFixedTeleportPosition)),x.myIsTeleport=!0,b.myDebugEnabled&&b.myDebugRuntimeParamsEnabled&&m.isDebugEnabled(this._myEngine)&&this._debugRuntimeParams(x)}}();Object.defineProperty(N.prototype,"_teleport",{enumerable:!1});N.prototype._positionCheck=function(){let i=p();return function(t,n,o,s){i=n.quat2_getPosition(i),this._teleport(i,n,o,s,!0),s.myIsPositionOk=!s.myTeleportCanceled,s.myIsPositionCheck=!0,s.myOriginalPositionCheckPosition.vec3_copy(s.myOriginalTeleportPosition),s.myFixedPositionCheckPosition.vec3_copy(s.myFixedTeleportPosition),s.myIsPositionCheckAllowAdjustments=t,t||(s.myIsPositionOk=s.myIsPositionOk&&s.myOriginalPositionCheckPosition.vec_equals(s.myFixedPositionCheckPosition,1e-5)),s.myOriginalTeleportPosition.vec3_zero(),s.myFixedTeleportPosition.vec3_zero(),s.myTeleportCanceled=!1,s.myIsTeleport=!1}}();Object.defineProperty(N.prototype,"_positionCheck",{enumerable:!1});N.prototype._horizontalCheck=function(){let i=p(),e=p(),t=p(),n=p();return function(s,a,l,h,_,y,r,u,g,P,C){u.myIsCollidingHorizontally=!1,u.myHorizontalCollisionHit.reset(),C.vec3_zero(),n=s.vec3_normalize(n);let f=this._surfaceTooSteep(h,n,r,g);if(s.vec3_isZero(1e-6)||(!f[0]||y&&r.myAllowGroundSteepFix)&&(!f[1]||y&&r.myAllowCeilingSteepFix)){i=a.vec3_add(h.vec3_scale(r.myDistanceFromFeetToIgnore+1e-4,i),i);let S=Math.max(0,l-r.myDistanceFromFeetToIgnore-r.myDistanceFromHeadToIgnore-1e-4*2),M=!0;r.myHorizontalMovementCheckEnabled&&!s.vec3_isZero(1e-6)&&(M=this._horizontalMovementCheck(s,a,l,i,S,h,r,u)),M?r.myHorizontalPositionCheckEnabled?(e=i.vec3_add(s,e),t=a.vec3_add(s,t),this._horizontalPositionCheck(t,l,e,S,h,_,r,u)&&C.vec3_copy(s),C.vec3_isZero(1e-6)&&C.vec3_zero()):C.vec3_copy(s):!P&&r.mySlidingEnabled&&r.mySlidingHorizontalMovementCheckBetterNormal&&this._horizontalCheckBetterSlideNormal(s,a,l,i,S,h,_,r,u)}return C}}();N.prototype._horizontalCheckRaycast=function(){let i=p(),e=p(),t=p();return function(o,s,a,l,h,_,y,r,u,g,P,C=!1,f=!1){let S=o;i=s.vec3_sub(S,i),a!=null&&!i.vec3_isConcordant(a)&&(i.vec3_negate(i),S=s);let M=i.vec3_length();i.vec3_normalize(i);let D=this._raycastAndDebug(S,i,M,h,!0,g,P),v=!0;if(D.isColliding()){let b=C?D.myHits.length:1,x=0;for(let I=0;I<b;I++){let L=D.myHits[I];if((_==null||!_(L,f))&&(y==null||!y(L,f))){v=!1,x=I;break}}if(!v&&x>0)for(let I=0;I<x;I++)D.removeHit(0)}if(!v&&u){let b=D.myHits[0].myPosition;e=r.vec3_copyComponentAlongAxis(b,l,e),t.vec3_copy(b);let x=1e-4;i=i.vec3_componentAlongAxis(l,i),i.vec3_isZero(1e-6)||(i.vec3_normalize(i),i.vec3_scale(x,i),e.vec3_add(i,e),t.vec3_add(i,t)),i=t.vec3_sub(e,i),i.vec3_normalize(i),i.vec3_scale(x,i),t=t.vec3_add(i,t);let I=this._myRaycastResult;this._myRaycastResult=this._myFixRaycastResult,v=this._horizontalCheckRaycast(e,t,null,l,!1,_,y,r,!1,g,P),this._myRaycastResult.isColliding()?this._myFixRaycastResult=I:(v=!1,this._myRaycastResult=I)}return v}}();N.prototype._ignoreSurfaceAngle=function(){let i=(s,a)=>s.pp_equals(a),e=p(),t=p(),n=p(),o=p();return function(a,l,h,_,y,r,u,g,P,C,f){let S=!1,M=null,D=u?P.myHorizontalMovementGroundAngleIgnoreHeight:P.myHorizontalPositionGroundAngleIgnoreHeight,v=u?P.myHorizontalMovementCeilingAngleIgnoreHeight:P.myHorizontalPositionCeilingAngleIgnoreHeight;r&&D!=null?M=Math.pp_clamp(D+2e-4,0,l):!r&&v!=null&&(M=Math.pp_clamp(l-v-2e-4,0,l));let b=null;if(u&&(r&&P.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft!=null?b=P.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft:!r&&P.myHorizontalMovementCeilingAngleIgnoreMaxMovementLeft!=null&&(b=P.myHorizontalMovementCeilingAngleIgnoreMaxMovementLeft)),C.myInsideCollision)f&&(_==null||_.pp_hasEqual(C.myObject,i))&&(S=!0);else{e=h.vec3_normalize(e);let x=C.myNormal.vec3_angle(g);if(r||(x=180-x),r&&P.myGroundAngleToIgnore>0&&x>P.myGroundAngleToIgnore+1e-4){if(P.myGroundAngleToIgnoreWithPerceivedAngle!=null&&x<=P.myGroundAngleToIgnoreWithPerceivedAngle+1e-4){let I=this.computeSurfacePerceivedAngle(C.myNormal,e,g,!0);x=Math.abs(I)}}else if(!r&&P.myCeilingAngleToIgnore>0&&x>P.myCeilingAngleToIgnore+1e-4&&P.myCeilingAngleToIgnoreWithPerceivedAngle!=null&&x<=P.myCeilingAngleToIgnoreWithPerceivedAngle+1e-4){let I=this.computeSurfacePerceivedAngle(C.myNormal,e,g,!1);x=Math.abs(I)}if((r&&P.myGroundAngleToIgnore>0&&x<=P.myGroundAngleToIgnore+1e-4||!r&&P.myCeilingAngleToIgnore>0&&x<=P.myCeilingAngleToIgnore+1e-4)&&(_==null||_.pp_hasEqual(C.myObject,i))){let I=!0,L=!0;if(M!=null){I=!1;let k=a.vec3_valueAlongAxis(g),ye=C.myPosition.vec3_valueAlongAxis(g)-k;(r&&ye<=M||!r&&ye>=M)&&(I=!0)}if(I&&u&&b!=null){let k=h.vec3_length();if(k>b){L=!1;let U=C.myPosition,ye=Math.min(P.myHalfConeAngle,90);t=U.vec3_sub(a,t),t.vec3_isToTheRight(e,g)?o=e.vec3_rotateAxis(-ye,g,o):o=e.vec3_rotateAxis(ye,g,o),n=t.vec3_projectOnAxisAlongAxis(e,o,n);let le=n.vec3_length();k-le<=b&&(L=!0)}}I&&L&&(S=!0)}}return S&&y?.pp_pushUnique(C.myObject,i),S}}();Object.defineProperty(N.prototype,"_horizontalCheck",{enumerable:!1});Object.defineProperty(N.prototype,"_horizontalCheckRaycast",{enumerable:!1});Object.defineProperty(N.prototype,"_ignoreSurfaceAngle",{enumerable:!1});N.prototype._horizontalSlide=function(){let i=p();return function(t,n,o,s,a,l,h,_,y,r){if(t.vec3_isZero(1e-5))return r.vec3_zero();if(this._mySlidingCollisionRuntimeParams.copy(_),i.vec3_copy(_.mySlidingPreviousHorizontalMovement),r=this._internalHorizontalSlide(t,n,o,s,a,i,l,h,this._mySlidingCollisionRuntimeParams,y,!1,r),h.mySlidingCheckBothDirections&&this._horizontalSlideCheckOpposite(t,n,o,s,a,i,this._myPrevCollisionRuntimeParams.myIsSliding,l,h,_,this._mySlidingCollisionRuntimeParams,y,r),this._mySlidingCollisionRuntimeParams.myIsSliding&&h.mySlidingFlickeringPreventionType>0){let u=this._horizontalSlideFlickerCheck(t,r,n,o,s,a,l,h,this._mySlidingCollisionRuntimeParams,y);this._mySlidingCollisionRuntimeParams.myIsSliding=!u}if(this._mySlidingCollisionRuntimeParams.myIsSliding){let u=_.myIsSlidingFlickerPrevented;_.copy(this._mySlidingCollisionRuntimeParams),_.myIsSlidingFlickerPrevented=u||this._mySlidingCollisionRuntimeParams.myIsSlidingFlickerPrevented}else _.myIsSlidingFlickerPrevented=_.myIsSlidingFlickerPrevented||this._mySlidingCollisionRuntimeParams.myIsSlidingFlickerPrevented,r.vec3_zero();return r}}();N.prototype._horizontalSlideCheckOpposite=function(){let i=p(),e=p();return function(n,o,s,a,l,h,_,y,r,u,g,P,C){i=u.myHorizontalCollisionHit.myNormal.vec3_removeComponentAlongAxis(a,i),i.vec3_normalize(i);let f=20;if(!(i.vec3_angle(n)>180-f)&&!(_&&g.myIsSliding&&C.vec3_isConcordant(h))&&(this._mySlidingOppositeDirectionCollisionRuntimeParams.copy(u),e=this._internalHorizontalSlide(n,o,s,a,l,h,y,r,this._mySlidingOppositeDirectionCollisionRuntimeParams,P,!0,e),this._mySlidingOppositeDirectionCollisionRuntimeParams.myIsSliding)){let S=!1;if(g.myIsSliding){if(n.vec3_angle(e)<n.vec3_angle(C)-1e-4)S=!0;else if(Math.abs(n.vec3_angle(e)-n.vec3_angle(C))<=1e-4&&h.vec3_angle(e)<h.vec3_angle(C)-1e-4){let M=5;i.vec3_angle(n)<90+M&&(S=!0)}}else{let M=.001;n.vec3_isConcordant(e)&&n.vec3_angle(e)<90-M&&(S=!0)}S&&(C.vec3_copy(e),g.copy(this._mySlidingOppositeDirectionCollisionRuntimeParams))}}}();N.prototype._horizontalSlideFlickerCheck=function(){let i=p(),e=p(),t=p(),n=p();return function(s,a,l,h,_,y,r,u,g,P){let C=!1;i.vec3_copy(g.mySlidingPreviousHorizontalMovement);let f=this._myPrevCollisionRuntimeParams.myIsSlidingFlickerPrevented||i.vec3_isZero(1e-5);if(!f&&(this._myPrevCollisionRuntimeParams.myIsSliding||!u.mySlidingFlickeringPreventionCheckOnlyIfAlreadySliding)){let S=90,M=85;switch(u.mySlidingFlickeringPreventionType){case 1:f=i.vec3_signTo(s,_,0)!=a.vec3_signTo(s,_,0);break;case 2:f=u.mySlidingCheckBothDirections&&g.myIsSlidingIntoOppositeDirection,f=f||Math.abs(g.mySlidingCollisionAngle)>S+1e-5;break;case 3:f=u.mySlidingCheckBothDirections&&g.myIsSlidingIntoOppositeDirection,f=f||Math.abs(g.mySlidingCollisionAngle)>S+1e-5,f=f||Math.abs(Math.abs(g.mySlidingCollisionAngle)-S)<1e-5&&Math.abs(g.mySlidingMovementAngle)>M+1e-5;break;case 4:f=!0;break}}if(f||this._myPrevCollisionRuntimeParams.mySlidingFlickerPreventionCheckAnywayCounter>0)if(f?g.mySlidingFlickerPreventionCheckAnywayCounter=u.mySlidingFlickerPreventionCheckAnywayCounter:g.mySlidingFlickerPreventionCheckAnywayCounter=Math.max(0,this._myPrevCollisionRuntimeParams.mySlidingFlickerPreventionCheckAnywayCounter-1),(u.mySlidingFlickeringPreventionType!=1||g.myIsSlidingFlickerPrevented||this._myPrevCollisionRuntimeParams.mySlidingFlickerPreventionCheckAnywayCounter>0)&&this._myPrevCollisionRuntimeParams.myIsSliding&&i.vec3_signTo(s,_,0)!=a.vec3_signTo(s,_,0))C=!0,g.myIsSlidingFlickerPrevented=!0;else{this._mySlidingFlickeringFixCollisionRuntimeParams.reset(),this._mySlidingFlickeringFixCollisionRuntimeParams.mySliding90DegreesSign=g.mySliding90DegreesSign,this._mySlidingFlickeringFixCollisionRuntimeParams.mySlidingRecompute90DegreesSign=!1,e=l.vec3_add(a,e);let S=u.myDebugEnabled;u.myDebugEnabled=u.myDebugEnabled&&u.myDebugSlidingEnabled,t.vec3_zero(),t=this._horizontalCheck(s,e,h,_,y,r,u,this._mySlidingFlickeringFixCollisionRuntimeParams,P,!1,t),u.myDebugEnabled=S,t.vec3_isZero(1e-5)&&(this._mySlidingFlickeringFixSlidingCollisionRuntimeParams.copy(this._mySlidingFlickeringFixCollisionRuntimeParams),n=this._internalHorizontalSlide(s,e,h,_,y,a,r,u,this._mySlidingFlickeringFixSlidingCollisionRuntimeParams,P,!1,n),u.mySlidingCheckBothDirections&&this._horizontalSlideCheckOpposite(s,e,h,_,y,a,!0,r,u,this._mySlidingFlickeringFixCollisionRuntimeParams,this._mySlidingFlickeringFixSlidingCollisionRuntimeParams,P,n),this._mySlidingFlickeringFixSlidingCollisionRuntimeParams.myIsSliding&&a.vec3_signTo(s,_,0)!=n.vec3_signTo(s,_,0)&&(C=!0,g.myIsSlidingFlickerPrevented=!0))}return C}}();N.prototype._internalHorizontalSlide=function(){let i=p(),e=p(),t=p(),n=p(),o=p(),s=p();return function(l,h,_,y,r,u,g,P,C,f,S,M){if(l.vec3_isZero(1e-5))return M.vec3_zero();if(i=C.myHorizontalCollisionHit.myNormal.vec3_negate(i),i.vec3_removeComponentAlongAxis(y,i),i[0]=Math.abs(i[0])<.01?0:i[0],i[2]=Math.abs(i[2])<.01?0:i[2],i.vec3_normalize(i),C.mySlidingCollisionHit.copy(C.myHorizontalCollisionHit),C.mySlidingWallNormal.vec3_copy(C.myHorizontalCollisionHit.myNormal),M.vec3_zero(),e.vec3_copy(i),S&&(e.vec3_copy(l),e.vec3_normalize(e)),!e.vec3_isZero(1e-5)){e.vec3_scale(l.vec3_length(),e);let D=i.vec3_signTo(l,y);if(P.mySlidingAdjustSign90Degrees){let L=.1;i.vec3_angle(l)<L&&C.mySliding90DegreesSign!=0?D=C.mySliding90DegreesSign:(C.mySliding90DegreesSign==0||C.mySlidingRecompute90DegreesSign)&&(C.mySliding90DegreesSign=D),C.mySlidingRecompute90DegreesSign=!1}S&&(D*=-1);let v=90*D,b=Math.pp_angleClamp(e.vec3_angleSigned(l.vec3_rotateAxis(90*D,y,t),y)*D,!0)*D,x=Math.pp_angleClamp(e.vec3_angleSigned(l,y)*D,!0)*D;if(S?(b=v,x=0):(Math.abs(b)<Math.abs(x)&&(x=0),Math.abs(Math.abs(b)-Math.abs(x))<1e-4&&(x=b),(Math.abs(b)<Math.abs(v)||Math.abs(Math.abs(b)-Math.abs(v))<1e-4)&&(v=b),(Math.abs(v)<Math.abs(x)||Math.abs(Math.abs(x)-Math.abs(v))<1e-4)&&(v=x)),S&&!u.vec3_isZero(1e-6)){let L=l.vec3_angleSigned(u,y);Math.pp_sign(L)==Math.pp_sign(b)&&Math.abs(b)>Math.abs(L)&&(v=L)}n.vec3_zero();let I=P.myDebugEnabled;P.myDebugEnabled=P.myDebugEnabled&&P.myDebugSlidingEnabled;for(let L=0;L<P.mySlidingMaxAttempts&&(this._myInternalSlidingCollisionRuntimeParams.copy(C),n=e.vec3_rotateAxis(v,y,n),o.vec3_copy(r),P.myCheckHorizontalFixedForwardEnabled||n.vec3_isZero()||(o=n.vec3_normalize(o)),s.vec3_zero(),s=this._horizontalCheck(n,h,_,y,o,g,P,this._myInternalSlidingCollisionRuntimeParams,f,!0,s),s.vec3_isZero(1e-5)?(v!=b&&(x=v),L==0&&v!=b?v=b:v=(x+b)/2):(M.vec3_copy(n),C.copy(this._myInternalSlidingCollisionRuntimeParams),C.myIsSliding=!0,C.myIsSlidingIntoOppositeDirection=S,C.mySlidingMovementAngle=l.vec3_angleSigned(n,y),C.mySlidingCollisionAngle=i.vec3_angleSigned(n,y),b=v,v=(b+x)/2),!(Math.abs(Math.abs(b)-Math.abs(x))<1e-4));L++);P.myDebugEnabled=I}return C.myIsSliding||C.mySlidingCollisionHit.reset(),M}}();N.prototype._horizontalCheckBetterSlideNormal=function(){let i=p(),e=p(),t=p(),n=p(),o=p(),s=p();return function(l,h,_,y,r,u,g,P,C){i=l.vec3_normalize(i);let f=C.myHorizontalCollisionHit.myPosition,S=Math.min(P.myHalfConeAngle,90);e=f.vec3_sub(y,e),e.vec3_isToTheRight(i,u)?t=i.vec3_rotateAxis(-S,u,t):t=i.vec3_rotateAxis(S,u,t),n=e.vec3_projectOnAxisAlongAxis(i,t,n),n.vec3_isConcordant(i)?n=i.vec3_scale(Math.min(n.vec3_length(),l.vec3_length()),n):n.vec3_zero(),P.myDebugEnabled&&P.myDebugHorizontalMovementEnabled&&m.isDebugEnabled(this._myEngine)&&m.getDebugVisualManager(this._myEngine).drawArrow(0,y,i,n.vec3_length(),F(1,0,1,1)),this._myCheckBetterSlidingNormalCollisionRuntimeParams.copy(C),this._myCheckBetterSlidingNormalCollisionRuntimeParams.myIsCollidingHorizontally=!1,this._myCheckBetterSlidingNormalCollisionRuntimeParams.myHorizontalCollisionHit.reset(),o=y.vec3_add(n,o),s=y.vec3_add(n,s);let M=P.myDebugEnabled;P.myDebugEnabled=P.myDebugEnabled&&P.myDebugSlidingEnabled,P.myHorizontalPositionCheckEnabled&&this._horizontalPositionCheck(h,_,o,r,u,g,P,this._myCheckBetterSlidingNormalCollisionRuntimeParams),P.myDebugEnabled=M,this._myCheckBetterSlidingNormalCollisionRuntimeParams.myIsCollidingHorizontally&&!this._myCheckBetterSlidingNormalCollisionRuntimeParams.myHorizontalCollisionHit.myInsideCollision&&C.copy(this._myCheckBetterSlidingNormalCollisionRuntimeParams)}}();N.prototype._isSlidingNormalValid=function(){let i=p();return function(t,n,o){let s=!1;return i=o.myHorizontalCollisionHit.myNormal.vec3_removeComponentAlongAxis(n,i),i.vec3_normalize(i),i.vec3_isZero(1e-6)||(s=!0),s}}();Object.defineProperty(N.prototype,"_horizontalSlide",{enumerable:!1});Object.defineProperty(N.prototype,"_horizontalSlideCheckOpposite",{enumerable:!1});Object.defineProperty(N.prototype,"_horizontalSlideFlickerCheck",{enumerable:!1});Object.defineProperty(N.prototype,"_internalHorizontalSlide",{enumerable:!1});Object.defineProperty(N.prototype,"_horizontalCheckBetterSlideNormal",{enumerable:!1});Object.defineProperty(N.prototype,"_isSlidingNormalValid",{enumerable:!1});N.prototype._horizontalMovementCheck=function(){let i=[],e=[],t=0,n=function(){let P=null;for(;e.length<=t;)e.push(p());return P=e[t],t++,P},o=[],s=[],a=[],l=(P,C)=>P.pp_equals(C),h=p(),_=p(),y=p(),r=p(),u=p(),g=p();return function(C,f,S,M,D,v,b,x){this._myDebugEnabled=b.myDebugEnabled&&b.myDebugHorizontalMovementEnabled;let I=Math.min(b.myHalfConeAngle,90);h=C.vec3_normalize(h),i.length=0,t=0;let L=b.myRadius/b.myHorizontalMovementRadialStepAmount;{let le=n();le.vec3_copy(M),i.push(le)}{u=h.vec3_rotateAxis(I,v,u),g=h.vec3_rotateAxis(-I,v,g);for(let le=1;le<=b.myHorizontalMovementRadialStepAmount;le++){{let Te=le*L,Be=n(),ve=u.vec3_scale(Te,Be),me=ve.vec3_add(M,ve);i.push(me)}{let Te=le*L,Be=n(),ve=g.vec3_scale(Te,Be),me=ve.vec3_add(M,ve);i.push(me)}}}let k=null,U=null,ye=null;if(b.myGroundAngleToIgnore>0){k=o,k.length=0,ye=a,ye.length=0;let le=this._ignoreSurfaceAngle.bind(this,f,S,C,null,k,!0,!0,v,b),Te=null;b.myCeilingAngleToIgnore>0&&(Te=this._ignoreSurfaceAngle.bind(this,f,S,C,null,ye,!1,!0,v,b)),_.vec3_zero(),this._horizontalMovementHorizontalCheck(C,M,i,_,v,le,Te,b,x)}if(b.myCeilingAngleToIgnore>0&&!x.myIsCollidingHorizontally&&b.myCheckHeight){U=s,U.length=0;let le=null;b.myGroundAngleToIgnore>0&&(le=this._ignoreSurfaceAngle.bind(this,f,S,C,k,null,!0,!0,v,b));let Te=this._ignoreSurfaceAngle.bind(this,f,S,C,null,U,!1,!0,v,b);_=v.vec3_scale(D,_),this._horizontalMovementHorizontalCheck(C,M,i,_,v,le,Te,b,x)}if(!x.myIsCollidingHorizontally){let le=!0;if(ye!=null){for(let me of ye)if(!U.pp_hasEqual(me,l)){le=!1;break}}let Te=null,Be=null;b.myGroundAngleToIgnore>0&&(Te=this._ignoreSurfaceAngle.bind(this,f,S,C,k,null,!0,!0,v,b)),b.myCeilingAngleToIgnore>0&&(Be=this._ignoreSurfaceAngle.bind(this,f,S,C,U,null,!1,!0,v,b));let ve=0;b.myCheckHeight&&b.myHeightCheckStepAmountMovement>0&&D>1e-6&&(ve=b.myHeightCheckStepAmountMovement,y=v.vec3_scale(D/ve,y));for(let me=0;me<=ve&&(r=y.vec3_scale(me,r),!((b.myCheckHeightTopMovement||me==0)&&(me!=0&&me!=ve||me==0&&!le||me==0&&b.myGroundAngleToIgnore==0||me==ve&&b.myCeilingAngleToIgnore==0)&&(this._horizontalMovementHorizontalCheck(C,M,i,r,v,Te,Be,b,x),x.myIsCollidingHorizontally)||me>0&&(b.myCheckHeightVerticalMovement&&this._horizontalMovementVerticalCheck(C,M,i,r,y,v,Te,Be,b,x),x.myIsCollidingHorizontally)));me++);}return!x.myIsCollidingHorizontally}}();N.prototype._horizontalMovementVerticalCheck=function(){let i=p(),e=p(),t=p(),n=p(),o=p(),s=p(),a=p(),l=p(),h=p(),_=p();return function(r,u,g,P,C,f,S,M,D,v){let b=!0,x=1;i.vec3_copy(r),D.myHorizontalMovementStepEnabled&&(x=Math.max(1,Math.ceil(r.vec3_length()/D.myHorizontalMovementStepMaxLength)),r.vec3_scale(1/x,i)),e=r.vec3_normalize(e);for(let I=0;I<x;I++)for(let L=0;L<g.length;L++){if(t=g[L].vec3_add(i.vec3_scale(I,t),t).vec3_add(P,t),L>0){let k=Math.max(0,L-2);if(n=g[k].vec3_add(i.vec3_scale(I,n),n).vec3_add(P,n),D.myHorizontalMovementCheckVerticalDiagonalUpwardOutward&&(o=t.vec3_add(i,o),l=n.vec3_sub(C,l),b=this._horizontalCheckRaycast(l,o,e,f,!0,S,M,u,!0,D,v),!b)||D.myHorizontalMovementCheckVerticalDiagonalUpwardInward&&(s=n.vec3_add(i,s),a=t.vec3_sub(C,a),b=this._horizontalCheckRaycast(a,s,e,f,!0,S,M,u,!0,D,v),!b)||D.myHorizontalMovementCheckVerticalDiagonalDownwardOutward&&(h=t.vec3_add(i,h),h=h.vec3_sub(C,h),b=this._horizontalCheckRaycast(n,h,e,f,!0,S,M,u,!0,D,v),!b)||D.myHorizontalMovementCheckVerticalDiagonalDownwardInward&&(_=n.vec3_add(i,_),_=_.vec3_sub(C,_),b=this._horizontalCheckRaycast(t,_,e,f,!0,S,M,u,!0,D,v),!b))break;if(I==0){if(D.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward&&(l=n.vec3_sub(C,l),b=this._horizontalCheckRaycast(l,t,e,f,!0,S,M,u,!0,D,v),!b))break;if(D.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward){let U=t.vec3_sub(C);if(b=this._horizontalCheckRaycast(U,n,e,f,!0,S,M,u,!0,D,v),!b)break}}if(D.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward&&(o=t.vec3_add(i,o),_=n.vec3_sub(C,_).vec3_add(i,_),b=this._horizontalCheckRaycast(_,o,e,f,!0,S,M,u,!0,D,v),!b)||D.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward&&(s=n.vec3_add(i,s),h=t.vec3_sub(C,h).vec3_add(i,h),b=this._horizontalCheckRaycast(h,s,e,f,!0,S,M,u,!0,D,v),!b))break}if((D.myHorizontalMovementCheckVerticalStraight||D.myHorizontalMovementHorizontalStraightCentralCheckEnabled&&L==0)&&(I==0&&(a=t.vec3_sub(C,a),b=this._horizontalCheckRaycast(a,t,e,f,!0,S,M,u,!0,D,v),!b)||(o=t.vec3_add(i,o),h=o.vec3_sub(C,h),b=this._horizontalCheckRaycast(h,o,e,f,!0,S,M,u,!0,D,v),!b))||(D.myHorizontalMovementCheckVerticalStraightDiagonalUpward||D.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled&&L==0)&&(o=t.vec3_add(i,o),a=t.vec3_sub(C,a),b=this._horizontalCheckRaycast(a,o,e,f,!0,S,M,u,!0,D,v),!b)||(D.myHorizontalMovementCheckVerticalStraightDiagonalDownward||D.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled&&L==0)&&(h=t.vec3_sub(C,h).vec3_add(i,h),b=this._horizontalCheckRaycast(t,h,e,f,!0,S,M,u,!0,D,v),!b))break;if(!b){v.myIsCollidingHorizontally=!0,v.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]);break}}return b}}();N.prototype._horizontalMovementHorizontalCheck=function(){let i=p(),e=p(),t=p(),n=p(),o=p(),s=p();return function(l,h,_,y,r,u,g,P,C){let f=!0,S=1;i.vec3_copy(l),P.myHorizontalMovementStepEnabled&&(S=Math.max(1,Math.ceil(l.vec3_length()/P.myHorizontalMovementStepMaxLength)),l.vec3_scale(1/S,i)),e=l.vec3_normalize(e);for(let M=0;M<S;M++){for(let D=0;D<_.length;D++){if(t=_[D].vec3_add(i.vec3_scale(M,t),t).vec3_add(y,t),D>0){let v=Math.max(0,D-2);if(n=_[v].vec3_add(i.vec3_scale(M,n),n).vec3_add(y,n),P.myHorizontalMovementCheckDiagonalOutward&&(o=t.vec3_add(i,o),f=this._horizontalCheckRaycast(n,o,e,r,!0,u,g,h,!0,P,C),!f)||P.myHorizontalMovementCheckDiagonalInward&&(s=n.vec3_add(i,s),f=this._horizontalCheckRaycast(t,s,e,r,!0,u,g,h,!0,P,C),!f)||P.myHorizontalMovementCheckHorizontalBorder&&(M==0&&(f=this._horizontalCheckRaycast(n,t,e,r,!0,u,g,h,!0,P,C),!f)||(o=t.vec3_add(i,o),s=n.vec3_add(i,s),f=this._horizontalCheckRaycast(s,o,e,r,!0,u,g,h,!0,P,C),!f)))break}if((P.myHorizontalMovementCheckStraight||P.myHorizontalMovementVerticalStraightCentralCheckEnabled&&D==0)&&(o=t.vec3_add(i,o),f=this._horizontalCheckRaycast(t,o,null,r,!0,u,g,h,!0,P,C),!f))break}if(!f){C.myIsCollidingHorizontally=!0,C.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]);break}}return f}}();Object.defineProperty(N.prototype,"_horizontalMovementCheck",{enumerable:!1});Object.defineProperty(N.prototype,"_horizontalMovementVerticalCheck",{enumerable:!1});Object.defineProperty(N.prototype,"_horizontalMovementHorizontalCheck",{enumerable:!1});N.prototype._horizontalPositionCheck=function(){let i=[],e=[],t=0,n=function(){let S=null;for(;e.length<=t;)e.push(p());return S=e[t],t++,S},o=[],s=[],a=[],l=(S,M)=>S.pp_equals(M),h=p(),_=p(),y=p(),r=p(),u=p(),g=p(),P=p(),C=p(),f=new st;return function(M,D,v,b,x,I,L,k){this._myDebugEnabled=L.myDebugEnabled&&L.myDebugHorizontalPositionEnabled,i.length=0,t=0;let ye=Math.min(L.myHalfConeAngle,180)/L.myHalfConeSliceAmount,le=n();i.push(v.vec3_add(I.vec3_scale(L.myRadius,le),le));for(let me=1;me<=L.myHalfConeSliceAmount;me++){let Qe=me*ye;le=n();let je=I.vec3_rotateAxis(-Qe,x,le);i.push(v.vec3_add(je.vec3_scale(L.myRadius,je),je)),le=n(),je=I.vec3_rotateAxis(Qe,x,le),i.push(v.vec3_add(je.vec3_scale(L.myRadius,je),je))}let Te=null,Be=null,ve=null;if(L.myGroundAngleToIgnore>0){Te=o,Te.length=0,ve=a,ve.length=0;let me=this._ignoreSurfaceAngle.bind(this,M,D,I,null,Te,!0,!1,x,L),Qe=null;L.myCeilingAngleToIgnore>0&&(Qe=this._ignoreSurfaceAngle.bind(this,M,D,I,null,ve,!1,!1,x,L)),h.vec3_zero(),this._horizontalPositionHorizontalCheck(v,i,h,x,I,me,Qe,L,k)}if(L.myCeilingAngleToIgnore>0&&!k.myIsCollidingHorizontally&&L.myCheckHeight){Be=s,Be.length=0;let me=null;L.myGroundAngleToIgnore>0&&(me=this._ignoreSurfaceAngle.bind(this,M,D,I,Te,null,!0,!1,x,L));let Qe=this._ignoreSurfaceAngle.bind(this,M,D,I,null,Be,!1,!1,x,L);h=x.vec3_scale(b,h),this._horizontalPositionHorizontalCheck(v,i,h,x,I,me,Qe,L,k)}if(!k.myIsCollidingHorizontally){let me=!0;if(ve!=null){for(let Ke of ve)if(!Be.pp_hasEqual(Ke,l)){me=!1;break}}let Qe=null,je=null;L.myGroundAngleToIgnore>0&&(Qe=this._ignoreSurfaceAngle.bind(this,M,D,I,Te,null,!0,!1,x,L)),L.myCeilingAngleToIgnore>0&&(je=this._ignoreSurfaceAngle.bind(this,M,D,I,Be,null,!1,!1,x,L));let Dt=0;L.myCheckHeight&&L.myHeightCheckStepAmountPosition>0&&b>0&&(Dt=L.myHeightCheckStepAmountPosition,x.vec3_scale(b/Dt,_));for(let Ke=0;Ke<=Dt&&(y=_.vec3_scale(Ke,y),!((L.myCheckHeightTopPosition||Ke==0)&&(Ke!=0&&Ke!=Dt||Ke==0&&!me||Ke==0&&L.myGroundAngleToIgnore==0||Ke!=0&&Ke==Dt&&L.myCeilingAngleToIgnore==0)&&(this._horizontalPositionHorizontalCheck(v,i,y,x,I,Qe,je,L,k),k.myIsCollidingHorizontally)));Ke++)if(Ke>0&&L.myCheckHeightVerticalPosition){let dn=1e-4;if((L.myHorizontalPositionCheckVerticalDirectionType==0||L.myHorizontalPositionCheckVerticalDirectionType==2)&&(C.vec3_copy(x),this._horizontalPositionVerticalCheck(v,i,y,_,C,x,Qe,je,L,k),k.myIsCollidingHorizontally&&L.myCheckHeightConeOnCollision)){if(r=k.myHorizontalCollisionHit.myPosition.vec3_sub(v,r).vec3_componentAlongAxis(x,r),r.vec3_add(C.vec3_scale(dn,u),r),k.myIsCollidingHorizontally=!1,L.myCheckHeightConeOnCollisionKeepHit&&f.copy(k.myHorizontalCollisionHit),k.myHorizontalCollisionHit.reset(),this._horizontalPositionHorizontalCheck(v,i,r,x,I,Qe,je,L,k),k.myIsCollidingHorizontally)break;if(L.myCheckHeightConeOnCollisionKeepHit){k.myIsCollidingHorizontally=!0,k.myHorizontalCollisionHit.copy(f);break}}if(!k.myIsCollidingHorizontally&&((L.myHorizontalPositionCheckVerticalDirectionType==1||L.myHorizontalPositionCheckVerticalDirectionType==2)&&(C=x.vec3_negate(C),g=y.vec3_sub(_,g),P=_.vec3_negate(P),this._horizontalPositionVerticalCheck(v,i,g,P,C,x,Qe,je,L,k)),k.myIsCollidingHorizontally&&L.myCheckHeightConeOnCollision)){if(r=k.myHorizontalCollisionHit.myPosition.vec3_sub(v,r).vec3_componentAlongAxis(x,r),r.vec3_add(C.vec3_scale(dn,u),r),k.myIsCollidingHorizontally=!1,L.myCheckHeightConeOnCollisionKeepHit&&f.copy(k.myHorizontalCollisionHit),k.myHorizontalCollisionHit.reset(),this._horizontalPositionHorizontalCheck(v,i,r,x,I,Qe,je,L,k),k.myIsCollidingHorizontally)break;if(L.myCheckHeightConeOnCollisionKeepHit){k.myIsCollidingHorizontally=!0,k.myHorizontalCollisionHit.copy(f);break}}}}return!k.myIsCollidingHorizontally}}();N.prototype._horizontalPositionHorizontalCheck=function(){let i=p(),e=p(),t=p(),n=p();return function(s,a,l,h,_,y,r,u,g){let P=!0;i=s.vec3_add(l,i);let C=Math.floor(a.length/2)+1;for(let f=0;f<C;f++){if(f>0){let S=Math.max(0,f*2),M=Math.max(0,f*2-1),D=a[S].vec_equals(a[M],1e-6);if(u.myCheckConeBorder)for(let v=0;v<2;v++){let b=v==0?S:M;t=a[b].vec3_add(l,t);let x=Math.max(0,b-2);if(n=a[x].vec3_add(l,n),P=this._horizontalCheckRaycast(n,t,_.vec3_negate(e),h,!0,y,r,s,!0,u,g),!P)break}if(u.myCheckConeRay&&P)for(let v=0;v<2&&!(v==1&&D);v++){let b=v==0?S:M;if(t=a[b].vec3_add(l,t),P=this._horizontalCheckRaycast(i,t,null,h,!1,y,r,s,!1,u,g),!P)break}}else if(u.myCheckConeRay&&(t=a[f].vec3_add(l,t),P=this._horizontalCheckRaycast(i,t,null,h,!1,y,r,s,!1,u,g),!P))break;if(!P)break}return P||(g.myIsCollidingHorizontally=!0,g.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0])),P}}();N.prototype._horizontalPositionVerticalCheck=function(){let i=p(),e=p(),t=p(),n=p(),o=p(),s=p();return function(l,h,_,y,r,u,g,P,C,f){let S=!0;i=l.vec3_add(_,i),e=i.vec3_sub(y,e);for(let M=0;M<=h.length;M++){let D=!1;if(M==h.length?(t.vec3_copy(i),n.vec3_copy(e)):(t=h[M].vec3_add(_,t),n=t.vec3_sub(y,n),M>0&&(D=h[M].vec_equals(h[M-1],1e-6))),C.myCheckVerticalStraight&&!D&&(S=this._horizontalCheckRaycast(n,t,null,u,C.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision,g,P,l,!0,C,f,!0,!0),!S&&(f.myIsCollidingHorizontally?this._myRaycastResult.myHits[0].myPosition.vec3_isFartherAlongAxis(f.myHorizontalCollisionHit.myPosition,r)&&f.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]):(f.myIsCollidingHorizontally=!0,f.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0])),!C.myCheckVerticalSearchFartherVerticalHit)))break;if(M<h.length){if((C.myCheckVerticalDiagonalRayOutward||C.myCheckVerticalDiagonalBorderRayOutward&&(M==h.length-2||M==h.length-1))&&!D&&(S=this._horizontalCheckRaycast(e,t,null,u,C.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision,g,P,l,!0,C,f,!0,!0),!S&&(f.myIsCollidingHorizontally?this._myRaycastResult.myHits[0].myPosition.vec3_isFartherAlongAxis(f.myHorizontalCollisionHit.myPosition,r)&&f.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]):(f.myIsCollidingHorizontally=!0,f.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0])),!C.myCheckVerticalSearchFartherVerticalHit))||(C.myCheckVerticalDiagonalRayInward||C.myCheckVerticalDiagonalBorderRayInward&&(M==h.length-2||M==h.length-1))&&!D&&(S=this._horizontalCheckRaycast(n,i,null,u,C.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision,g,P,l,!0,C,f,!0,!0),!S&&(f.myIsCollidingHorizontally?this._myRaycastResult.myHits[0].myPosition.vec3_isFartherAlongAxis(f.myHorizontalCollisionHit.myPosition,r)&&f.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]):(f.myIsCollidingHorizontally=!0,f.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0])),!C.myCheckVerticalSearchFartherVerticalHit)))break;if(M>0&&(C.myCheckVerticalDiagonalBorderOutward||C.myCheckVerticalDiagonalBorderInward)){let v=Math.max(0,M-2);if(o=h[v].vec3_add(_,o),s=o.vec3_sub(y,s),C.myCheckVerticalDiagonalBorderOutward&&(S=this._horizontalCheckRaycast(s,t,null,u,C.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision,g,P,l,!0,C,f,!0,!0),!S&&(f.myIsCollidingHorizontally?this._myRaycastResult.myHits[0].myPosition.vec3_isFartherAlongAxis(f.myHorizontalCollisionHit.myPosition,r)&&f.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]):(f.myIsCollidingHorizontally=!0,f.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0])),!C.myCheckVerticalSearchFartherVerticalHit))||C.myCheckVerticalDiagonalBorderInward&&(S=this._horizontalCheckRaycast(n,o,null,u,C.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision,g,P,l,!0,C,f,!0,!0),!S&&(f.myIsCollidingHorizontally?this._myRaycastResult.myHits[0].myPosition.vec3_isFartherAlongAxis(f.myHorizontalCollisionHit.myPosition,r)&&f.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]):(f.myIsCollidingHorizontally=!0,f.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0])),!C.myCheckVerticalSearchFartherVerticalHit)))break}}}return!f.myIsCollidingHorizontally}}();Object.defineProperty(N.prototype,"_horizontalPositionCheck",{enumerable:!1});Object.defineProperty(N.prototype,"_horizontalPositionHorizontalCheck",{enumerable:!1});Object.defineProperty(N.prototype,"_horizontalPositionVerticalCheck",{enumerable:!1});N.prototype._verticalCheck=function(){let i=p(),e=p(),t=p(0,0,0);return function(o,s,a,l,h,_,y,r,u){r.myIsCollidingVertically=!1,r.myVerticalCollisionHit.reset();let g=Math.pp_sign(o.vec3_lengthSigned(h),-1),P=g<0;if(u.vec3_copy(o),y.myVerticalMovementCheckEnabled&&(u=this._verticalMovementAdjustment(o,P,s,a,l,h,_,y,r,u),y.myCheckVerticalBothDirection&&(u.vec_equals(o,1e-5)||s==0||g!=s))){i=a.vec3_add(u,i);let C=!P;e=this._verticalMovementAdjustment(t,C,s,i,l,h,_,y,r,e),u.vec3_add(e,u),P=!P}return y.myVerticalPositionCheckEnabled&&(i=a.vec3_add(u,i),this._verticalPositionCheck(i,P,l,h,_,y,r)||(u.vec3_zero(),r.myHasSnappedOnGround=!1,r.myHasSnappedOnCeiling=!1,r.myHasPoppedOutGround=!1,r.myHasPoppedOutCeiling=!1,r.myHasReducedVerticalMovement=!1)),u}}();N.prototype._verticalMovementAdjustment=function(){let i=p(),e=p(),t=p(),n=p(),o=p(),s=p(),a=p(),l=p();return function(_,y,r,u,g,P,C,f,S,M){this._myDebugEnabled=f.myDebugEnabled&&f.myDebugVerticalMovementEnabled,i.vec3_zero(),e.vec3_zero();let D=!1,v=!1;if(y?(i.vec3_zero(),e.vec3_copy(_),f.myGroundPopOutExtraDistance>0&&f.myGroundPopOutEnabled&&(i.vec3_add(P.vec3_scale(f.myGroundPopOutExtraDistance+1e-5,t),i),D=!0)):(i=P.vec3_scale(g,i),e=P.vec3_scale(g,e).vec3_add(_,e),f.myCeilingPopOutExtraDistance>0&&f.myCeilingPopOutEnabled&&(i.vec3_add(P.vec3_scale(-f.myCeilingPopOutExtraDistance-1e-5,t),i),D=!0)),y&&r<=0&&this._myPrevCollisionRuntimeParams.myIsOnGround&&f.mySnapOnGroundEnabled&&f.mySnapOnGroundExtraDistance>0?(e.vec3_add(P.vec3_scale(-f.mySnapOnGroundExtraDistance-1e-5,t),e),v=!0):!y&&this._myPrevCollisionRuntimeParams.myIsOnCeiling&&f.mySnapOnCeilingEnabled&&f.mySnapOnCeilingExtraDistance>0&&(r>0||r==0&&(!this._myPrevCollisionRuntimeParams.myIsOnGround||!f.mySnapOnGroundEnabled))&&(e.vec3_add(P.vec3_scale(f.mySnapOnCeilingExtraDistance+1e-5,t),e),v=!0),M.vec3_zero(),i.vec3_distance(e)>1e-5){let b=this._getVerticalCheckPositions(u,P,C,f,S);n.vec3_copy(P),y||n.vec3_negate(n);let x=!1;for(let I=0;I<b.length;I++){let L=b[I];a=L.vec3_add(i,a),l=L.vec3_add(e,l).vec3_sub(a,l);let k=l.vec3_length();l.vec3_normalize(l);let U=this._raycastAndDebug(a,l,k,!0,!1,f,S);U.myHits.length>0&&(x?U.myHits[0].myPosition.vec3_isFartherAlongAxis(o,n)&&o.vec3_copy(U.myHits[0].myPosition):(x=!0,o.vec3_copy(U.myHits[0].myPosition)))}x?(s=P.vec3_negate(s),y?(M=o.vec3_sub(u,M).vec3_componentAlongAxis(P,M),v&&M.vec3_isFartherAlongAxis(_,s)?S.myHasSnappedOnGround=!0:D&&M.vec3_isFartherAlongAxis(_,P)&&!M.vec3_isZero(1e-5)&&(_.vec3_isZero(1e-5)||!M.vec3_isConcordant(_))?S.myHasPoppedOutGround=!0:S.myHasReducedVerticalMovement=!0):(M=o.vec3_sub(u.vec3_add(P.vec3_scale(g,M),M),M).vec3_componentAlongAxis(P,M),v&&M.vec3_isFartherAlongAxis(_,P)?S.myHasSnappedOnCeiling=!0:D&&M.vec3_isFartherAlongAxis(_,s)&&!M.vec3_isZero(1e-5)&&(_.vec3_isZero(1e-5)||!M.vec3_isConcordant(_))?S.myHasPoppedOutCeiling=!0:S.myHasReducedVerticalMovement=!0),!D&&!M.vec3_isConcordant(_)&&M.vec3_zero(),!f.myVerticalMovementReduceEnabled&&S.myHasReducedVerticalMovement&&(M.vec3_copy(_),S.myHasReducedVerticalMovement=!1)):M.vec3_copy(_)}else M.vec3_copy(_);return M.vec3_length()<1e-5&&M.vec3_zero(),M}}();N.prototype._verticalPositionCheck=function(){let i=p(),e=p(),t=p(),n=p(),o=p();return function(a,l,h,_,y,r,u){if(h<1e-5)return!0;this._myDebugEnabled=r.myDebugEnabled&&r.myDebugVerticalPositionEnabled;let g=this._getVerticalCheckPositions(a,_,y,r,u),P=!0,C=!1,f=1e-4;i=_.vec3_scale(f,i),e=_.vec3_scale(h-f,e),h-f<f*10&&(e=_.vec3_scale(f*10,e));let S=!1;for(let M=0;M<g.length;M++){let D=g[M];l?(t=D.vec3_add(i,t),n=D.vec3_add(e,n)):(t=D.vec3_add(e,t),n=D.vec3_add(i,n));let v=t;o=n.vec3_sub(v,o);let b=o.vec3_length();o.vec3_normalize(o);let x=this._raycastAndDebug(v,o,b,!1,!1,r,u);if(x.isColliding()){let I=x.getFirstHitOutsideCollision();if(I!=null){P=!1,u.myVerticalCollisionHit.copy(I);break}else if(!S&&(S=!0,u.myVerticalCollisionHit.copy(x.myHits[0]),!r.myVerticalAllowHitInsideCollisionIfOneOk)){P=!1;break}}else C=!0}return u.myIsCollidingVertically=!P||!C,!u.myIsCollidingVertically}}();N.prototype._getVerticalCheckPositions=function(){let i=[],e=[],t=0,n=function(){let s=null;for(;e.length<=t;)e.push(p());return s=e[t],t++,s},o=p();return function(a,l,h,_,y){if(i.length=0,t=0,_.myGroundCircumferenceAddCenter){let P=n();P.vec3_copy(a),i.push(P)}let r=_.myFeetRadius/_.myGroundCircumferenceStepAmount,u=360/_.myGroundCircumferenceSliceAmount,g=0;for(let P=0;P<_.myGroundCircumferenceStepAmount;P++){let C=r*(P+1);o=h.vec3_rotateAxis(g,l,o);for(let f=0;f<_.myGroundCircumferenceSliceAmount;f++){let S=n(),M=o.vec3_rotateAxis(u*f,l,S);i.push(a.vec3_add(M.vec3_scale(C,M),M))}g+=_.myGroundCircumferenceRotationPerStep}return i}}();Object.defineProperty(N.prototype,"_verticalCheck",{enumerable:!1});Object.defineProperty(N.prototype,"_verticalMovementAdjustment",{enumerable:!1});Object.defineProperty(N.prototype,"_verticalPositionCheck",{enumerable:!1});Object.defineProperty(N.prototype,"_getVerticalCheckPositions",{enumerable:!1});N.prototype._updateSurfaceInfo=function(){let i=p(),e=p(),t=p(),n=G(),o=G(),s=p(),a=p(),l=p(0,0,1),h=p(1,0,0);return function(y,r,u){n.quat2_setPositionRotationQuat(r.myPositionOffsetLocal,r.myRotationOffsetLocalQuat),o=n.quat2_toWorld(y,o),y.vec_equals(o,1e-5)&&o.quat2_copy(y),i=o.quat2_getUp(i),e=o.quat2_getForward(e),t=o.quat2_getPosition(t);let g=r.myHeight;g=g-1e-5,g<1e-5&&(g=0),s.vec3_copy(e),a.vec3_copy(r.myCheckVerticalFixedForward),r.myCheckVerticalFixedForwardEnabled?(r.myCheckVerticalFixedForward.vec3_isOnAxis(i)&&(l.vec3_isOnAxis(i)?a.vec3_copy(h):a.vec3_copy(l)),a=a.vec3_removeComponentAlongAxis(i,a),a=a.vec3_normalize(a),a.vec_equals(r.myCheckVerticalFixedForward,1e-5)&&a.vec3_copy(r.myCheckVerticalFixedForward)):a.vec3_copy(e),r.myComputeGroundInfoEnabled&&this._gatherSurfaceInfo(t,g,i,s,a,!0,r,u),r.myComputeCeilingInfoEnabled&&this._gatherSurfaceInfo(t,g,i,s,a,!1,r,u)}}();N.prototype._postSurfaceCheck=function(){let i=p();return function(t,n,o,s,a,l){let h=n.vec3_isZero(1e-5),_=Math.pp_sign(n.vec3_lengthSigned(o),-1)<0,y=t.vec3_isZero(1e-5);i=t.vec3_normalize(i);let r=this.computeSurfacePerceivedAngle(a.myGroundNormal,i,o,!0),u=this.computeSurfacePerceivedAngle(a.myCeilingNormal,i,o,!1),g=!0;s.myMustStayOnGround&&l.myIsOnGround&&!a.myIsOnGround&&(h||_)&&(g=!1);let P=!0;s.myMustStayOnCeiling&&l.myIsOnCeiling&&!a.myIsOnCeiling&&(h||_)&&(P=!1);let C=!0;if(s.myMustStayBelowGroundAngleDownhill!=null||s.myMustStayBelowIgnorableGroundAngleDownhill){let I=null;s.myMustStayBelowIgnorableGroundAngleDownhill?s.myMustStayBelowGroundAngleDownhill==null?I=s.myGroundAngleToIgnore:I=Math.min(s.myMustStayBelowGroundAngleDownhill,s.myGroundAngleToIgnore):I=s.myMustStayBelowGroundAngleDownhill,!y&&r<0&&l.myIsOnGround&&l.myGroundAngle<=I&&a.myIsOnGround&&a.myGroundAngle>I+1e-4&&(C=!1)}let f=!0;if(s.myMustStayBelowCeilingAngleDownhill!=null||s.myMustStayBelowIgnorableCeilingAngleDownhill){let I=null;s.myMustStayBelowIgnorableCeilingAngleDownhill?s.myMustStayBelowCeilingAngleDownhill==null?I=s.myCeilingAngleToIgnore:I=Math.min(s.myMustStayBelowCeilingAngleDownhill,s.myCeilingAngleToIgnore):I=s.myMustStayBelowCeilingAngleDownhill,!y&&r<0&&l.myIsOnCeiling&&l.myCeilingAngle<=I&&a.myIsOnCeiling&&a.myCeilingAngle>I+1e-4&&(f=!1)}let S=!0;s.myMovementMustStayOnGroundHitAngle!=null&&!y&&l.myIsOnGround&&l.myGroundHitMaxAngle<=s.myMovementMustStayOnGroundHitAngle&&a.myIsOnGround&&a.myGroundHitMaxAngle>s.myMovementMustStayOnGroundHitAngle+1e-4&&(S=!1);let M=!0;s.myMovementMustStayOnCeilingHitAngle!=null&&!y&&l.myIsOnCeiling&&l.myCeilingHitMaxAngle<=s.myMovementMustStayOnCeilingHitAngle&&a.myIsOnCeiling&&a.myCeilingHitMaxAngle>s.myMovementMustStayOnCeilingHitAngle+1e-4&&(M=!1);let D=!0,v=!0;a.myIsOnGround&&a.myGroundAngle>s.myGroundAngleToIgnore+1e-4&&l.myIsOnGround&&!y&&(r>0?(D=!1,s.myGroundAngleToIgnoreWithPerceivedAngle!=null&&a.myGroundAngle<=s.myGroundAngleToIgnoreWithPerceivedAngle+1e-4&&(D=Math.abs(r)<=s.myGroundAngleToIgnore+1e-4)):r<0&&l.myGroundAngle<=s.myGroundAngleToIgnore+1e-4&&s.myMustStayOnValidGroundAngleDownhill&&(v=!1));let b=!0,x=!0;return a.myIsOnCeiling&&a.myCeilingAngle>s.myCeilingAngleToIgnore+1e-4&&l.myIsOnCeiling&&!y&&(u>0?(b=!1,s.myCeilingAngleToIgnoreWithPerceivedAngle!=null&&a.myCeilingAngle<=s.myCeilingAngleToIgnoreWithPerceivedAngle+1e-4&&(b=Math.abs(u)<=s.myCeilingAngleToIgnore+1e-4)):u<0&&l.myCeilingAngle<=s.myCeilingAngleToIgnore+1e-4&&s.myMustStayOnValidCeilingAngleDownhill&&(x=!1)),g&&P&&C&&f&&S&&M&&D&&v&&b&&x}}();N.prototype._surfaceTooSteep=function(){let i=[!1,!1];return function(t,n,o,s){let a=!1,l=!1;if(s.myIsOnGround&&s.myGroundAngle>o.myGroundAngleToIgnore+1e-4){let h=this.computeSurfacePerceivedAngle(s.myGroundNormal,n,t,!0);a=h>0,a&&o.myGroundAngleToIgnoreWithPerceivedAngle!=null&&s.myGroundAngle<=o.myGroundAngleToIgnoreWithPerceivedAngle+1e-4&&(a=Math.abs(h)>o.myGroundAngleToIgnore+1e-4)}if(!a&&s.myIsOnCeiling&&s.myCeilingAngle>o.myCeilingAngleToIgnore+1e-4){let h=this.computeSurfacePerceivedAngle(s.myCeilingNormal,n,t,!1);l=h>0,l&&o.myCeilingAngleToIgnoreWithPerceivedAngle!=null&&s.myCeilingAngle<=o.myCeilingAngleToIgnoreWithPerceivedAngle+1e-4&&(l=Math.abs(h)>o.myCeilingAngleToIgnore+1e-4)}return i[0]=a,i[1]=l,i}}();N.prototype._adjustVerticalMovementWithSurface=function(){let i=p(),e=p();return function(n,o,s,a,l,h,_){if(_.vec3_copy(o),n.vec3_isZero(1e-5))return _;let y=0;if(i=n.vec3_normalize(i),h.myIsOnGround){let r=this.computeSurfacePerceivedAngle(h.myGroundNormal,i,s,!0),u=n.vec3_length()*Math.tan(Math.pp_toRadians(Math.abs(r)));u*=Math.pp_sign(r),Math.abs(u)>1e-5&&(r>0?a.myAdjustVerticalMovementWithGroundAngleUphill&&(a.myAdjustVerticalMovementWithGroundAngleUphillMaxPerceivedAngle==null||Math.abs(r)<=a.myAdjustVerticalMovementWithGroundAngleUphillMaxPerceivedAngle)&&(a.myAdjustVerticalMovementWithGroundAngleUphillMaxAngle==null||h.myGroundAngle<=a.myAdjustVerticalMovementWithGroundAngleUphillMaxAngle)&&(y=u,l.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleUphill=!0):r<0&&a.myAdjustVerticalMovementWithGroundAngleDownhill&&(a.myAdjustVerticalMovementWithGroundAngleDownhillMaxPerceivedAngle==null||Math.abs(r)<=a.myAdjustVerticalMovementWithGroundAngleDownhillMaxPerceivedAngle)&&(a.myAdjustVerticalMovementWithGroundAngleDownhillMaxAngle==null||h.myGroundAngle<=a.myAdjustVerticalMovementWithGroundAngleDownhillMaxAngle)&&(y=u,l.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleDownhill=!0))}if(h.myIsOnCeiling){let r=this.computeSurfacePerceivedAngle(h.myCeilingNormal,i,s,!1),u=n.vec3_length()*Math.tan(Math.pp_toRadians(Math.abs(r)));if(u*=Math.pp_sign(r),Math.abs(u)>1e-5){let g=Math.pp_sign(y)==Math.pp_sign(u);(y==0||g&&Math.abs(u)>Math.abs(y))&&(r>0?a.myAdjustVerticalMovementWithCeilingAngleUphill&&(a.myAdjustVerticalMovementWithCeilingAngleUphillMaxPerceivedAngle==null||Math.abs(r)<=a.myAdjustVerticalMovementWithCeilingAngleUphillMaxPerceivedAngle)&&(a.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle==null||h.myCeilingAngle<=a.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle)&&(y=u,l.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleUphill=!0,l.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleUphill=!1):r<0&&a.myAdjustVerticalMovementWithCeilingAngleDownhill&&(a.myAdjustVerticalMovementWithCeilingAngleDownhillMaxPerceivedAngle==null||Math.abs(r)<=a.myAdjustVerticalMovementWithCeilingAngleDownhillMaxPerceivedAngle)&&(a.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle==null||h.myCeilingAngle<=a.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle)&&(y=u,l.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleDownhill=!0,l.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleDownhill=!1))}}if(Math.abs(y)>1e-5){let r=o.vec3_lengthSigned(s),u=Math.pp_sign(y)==Math.pp_sign(r);e=s.vec3_scale(y,e),o.vec3_isZero(1e-5)?_.vec3_copy(e):u||!u&&(l.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleUphill||l.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleUphill)?_=o.vec3_add(e,_):(l.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleUphill=!1,l.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleUphill=!1,l.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleDownhill=!1,l.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleDownhill=!1)}return _.vec3_isZero(1e-6)&&_.vec3_zero(),_}}();N.prototype._adjustHorizontalMovementWithSurface=function(){let i=p(),e=p(),t=p(),n=p(),o=p(),s=p();return function(l,h,_,y,r,u,g){if(g.vec3_copy(l),h.vec3_isZero(1e-5))return g;let P=!h.vec3_isConcordant(_);if(i.vec3_zero(),e.vec3_zero(),u.myIsOnGround&&(e=u.myGroundNormal.vec3_removeComponentAlongAxis(_,e),!e.vec3_isZero(1e-5))){e.vec3_normalize(e);let C=h.vec3_length()/Math.tan(Math.pp_toRadians(u.myGroundAngle));C*=P?1:-1,Math.abs(C)>1e-5&&P&&y.myAdjustHorizontalMovementWithGroundAngleDownhill&&(y.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle==null||u.myGroundAngle>=y.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle)&&(i=e.vec3_scale(C,i),r.myVerticalMovementHasAdjustedHorizontalMovementOverGroundAngleDownhill=!0)}if(u.myIsOnCeiling&&(t=u.myCeilingNormal.vec3_removeComponentAlongAxis(_,t),!t.vec3_isZero(1e-5))){t.vec3_normalize(t);let C=h.vec3_length()/Math.tan(Math.pp_toRadians(u.myCeilingAngle));if(C*=P?-1:1,Math.abs(C)>1e-5){let f=t.vec3_isConcordant(e);(i.vec3_isZero()||f)&&(P||y.myAdjustHorizontalMovementWithCeilingAngleDownhill&&(y.myAdjustHorizontalMovementWithCeilingAngleDownhillMinAngle==null||u.myCeilingAngle>=y.myAdjustHorizontalMovementWithCeilingAngleDownhillMinAngle)&&(n=t.vec3_scale(C,n),e.vec3_isZero()?(i.vec3_copy(n),r.myVerticalMovementHasAdjustedHorizontalMovementOverCeilingAngleDownhill=!0):(s=n.vec3_removeComponentAlongAxis(s),o=n.vec3_componentAlongAxis(s),o.vec3_isFartherAlongAxis(i,e)?(r.myVerticalMovementHasAdjustedHorizontalMovementOverGroundAngleDownhill=!1,i.vec3_copy(n),r.myVerticalMovementHasAdjustedHorizontalMovementOverCeilingAngleDownhill=!0):s.vec3_isZero(1e-5)||(i=i.vec3_add(s,i),r.myVerticalMovementHasAdjustedHorizontalMovementOverCeilingAngleDownhill=!0))))}}return i.vec3_isZero()||(l.vec3_isZero(1e-5)?g.vec3_copy(i):(i.vec3_isConcordant(l),g=l.vec3_add(i,g))),g.vec3_isZero(1e-6)&&g.vec3_zero(),g}}();N.prototype._computeExtraSurfaceVerticalMovement=function(){let i=p(),e=p();return function(n,o,s,a,l){if(l.vec3_zero(),!n.vec3_isZero()){if(a.myIsOnGround&&a.myGroundAngle!=0){i=n.vec3_normalize(i);let h=this.computeSurfacePerceivedAngle(a.myGroundNormal,i,o,!0),_=n.vec3_length()*Math.tan(Math.pp_toRadians(Math.abs(h)));_*=Math.pp_sign(h),Math.abs(_)>1e-5&&(s.mySnapOnGroundEnabled||_>0)&&l.vec3_add(o.vec3_scale(_,e),l)}else if(a.myIsOnCeiling&&a.myCeilingAngle!=0){i=n.vec3_normalize(i);let h=this.computeSurfacePerceivedAngle(a.myCeilingNormal,i,o,!1),_=n.vec3_length()*Math.tan(Math.pp_toRadians(Math.abs(h)));_*=Math.pp_sign(h),_*=-1,Math.abs(_)>1e-5&&(s.mySnapOnCeilingEnabled||_<0)&&l.vec3_add(o.vec3_scale(_,e),l)}}return l}}();N.prototype._gatherSurfaceInfo=function(){let i=p(),e=p(),t=p(),n=p(),o=p(),s=p(),a=p(),l=p(),h=p(),_=p(),y=p(),r=p(),u=p();return function(P,C,f,S,M,D,v,b){this._myDebugEnabled=v.myDebugEnabled&&(D&&v.myDebugGroundInfoEnabled||!D&&v.myDebugCeilingInfoEnabled);let x=this._getVerticalCheckPositions(P,f,M,v,b);i.vec3_copy(f);let I=v.myDistanceToBeOnGround,L=v.myDistanceToComputeGroundInfo,k=v.myFindGroundDistanceMaxOutsideDistance,U=v.myVerticalFixToBeOnGround,ye=v.myVerticalFixToComputeGroundInfo,le=v.myFindGroundDistanceMaxInsideDistance,Te=v.myIsOnGroundIfInsideHit,Be=v.myGroundIsBaseInsideCollisionCheckEnabled;D||(i.vec3_negate(i),I=v.myDistanceToBeOnCeiling,L=v.myDistanceToComputeCeilingInfo,k=v.myFindCeilingDistanceMaxOutsideDistance,U=v.myVerticalFixToBeOnCeiling,ye=v.myVerticalFixToComputeCeilingInfo,le=v.myFindCeilingDistanceMaxInsideDistance,Te=v.myIsOnCeilingIfInsideHit,Be=v.myCeilingIsBaseInsideCollisionCheckEnabled),e=i.vec3_scale(Math.max(U,ye,le,1e-5),e),t=i.vec3_negate(t).vec3_scale(Math.max(I,L,k,1e-5),t),n.vec3_zero(),D||(n=f.vec3_scale(C,n)),o=i.vec3_scale(1e-4,o);let ve=!1,me=0,Qe=0;l.vec3_zero();let je=0;h.vec3_zero();let Dt=null,Ke=x.length>0;for(let dn=0;dn<x.length;dn++){let Oi=x[dn];Oi.vec3_add(n,Oi);let Jr=!1;if(Be){s=Oi.vec3_add(o,s),a=Oi.vec3_sub(o,a);let ho=s;u=a.vec3_sub(ho,u);let Zr=u.vec3_length();u.vec3_normalize(u);let _n=this._raycastAndDebug(ho,u,Zr,!1,!1,v,b);_n.isColliding()&&(Jr=_n.myHits[0].myInsideCollision)}if(Ke&&=Jr,Jr)Te&&(ve=!0);else{y=Oi.vec3_add(e,y),r=Oi.vec3_add(t,r);let ho=y;u=r.vec3_sub(ho,u);let Zr=u.vec3_length();u.vec3_normalize(u);let _n=this._raycastAndDebug(ho,u,Zr,!0,!1,v,b);if(_n.isColliding()){_=_n.myHits[0].myPosition.vec3_sub(Oi,_);let rt=_.vec3_lengthSigned(i);if((rt>=0&&rt<=U+1e-5||rt<0&&Math.abs(rt)<=I+1e-5)&&(ve=!0),rt>=0&&rt<=ye+1e-5||rt<0&&Math.abs(rt)<=L+1e-5){let Yr=_n.myHits[0].myNormal;l.vec3_add(Yr,l);let gm=Yr.vec3_angle(i);gm>je&&(je=gm,h.vec3_copy(Yr))}(rt>=0&&rt<=le+1e-5||rt<0&&Math.abs(rt)<=k+1e-5)&&(Dt==null||Math.abs(rt)<Math.abs(Dt))&&(Dt=-rt)}}}l.vec3_isZero()||(l.vec3_normalize(l),me=l.vec3_angle(i),me<=1e-4?(me=0,l.vec3_copy(i)):me>=180-1e-4&&(me=180,l=i.vec3_negate(l)),Qe=this.computeSurfacePerceivedAngle(l,S,f,D)),D?(b.myRealIsOnGround=ve,b.myGroundAngle=me,b.myGroundPerceivedAngle=Qe,b.myGroundNormal.vec3_copy(l),b.myGroundHitMaxAngle=je,b.myGroundHitMaxNormal.vec3_copy(h),b.myGroundDistance=Dt,b.myGroundIsBaseInsideCollision=Ke,ve&&(v.myIsOnGroundMaxSurfaceAngle==null||b.myGroundAngle<=v.myIsOnGroundMaxSurfaceAngle)&&(b.myIsOnGround=ve)):(b.myRealIsOnCeiling=ve,b.myCeilingAngle=me,b.myCeilingPerceivedAngle=Qe,b.myCeilingNormal.vec3_copy(l),b.myCeilingHitMaxAngle=je,b.myCeilingHitMaxNormal.vec3_copy(h),b.myCeilingDistance=Dt,b.myCeilingIsBaseInsideCollision=Ke,ve&&(v.myIsOnCeilingMaxSurfaceAngle==null||b.myCeilingAngle<=v.myIsOnCeilingMaxSurfaceAngle)&&(b.myIsOnCeiling=ve))}}();N.prototype.computeSurfacePerceivedAngle=function(){let i=p(),e=p();return function(n,o,s,a=!0){let l=0;e.vec3_copy(s),a||e.vec3_negate(e);let h=n.vec3_angle(e);h<=Math.PP_EPSILON_DEGREES?h=0:h>=180-Math.PP_EPSILON_DEGREES&&(h=180),i=o.vec3_projectOnPlaneAlongAxis(n,s,i),l=i.vec3_angle(o);let _=i.vec3_isFartherAlongAxis(o,s);return(!_&&a||_&&!a)&&(l*=-1),Math.abs(l)>=h&&(h!=0&&h!=180?l=h*Math.pp_sign(l):l=h),l}}();Object.defineProperty(N.prototype,"_surfaceTooSteep",{enumerable:!1});Object.defineProperty(N.prototype,"_computeExtraSurfaceVerticalMovement",{enumerable:!1});Object.defineProperty(N.prototype,"_gatherSurfaceInfo",{enumerable:!1});Object.defineProperty(N.prototype,"_updateSurfaceInfo",{enumerable:!1});var Ue=class{constructor(){this.myCheckType=null,this.myTransformResults=new qn,this.myMovementResults=new Ei,this.myHorizontalMovementResults=new Ei,this.myVerticalMovementResults=new Ei,this.myTeleportResults=new Xn,this.myCheckTransformResults=new Kn,this.myWallSlideResults=new Qn,this.myGroundInfo=new $i,this.myCeilingInfo=new $i,this.myGroundResults=new en,this.myCeilingResults=new en,this.mySplitMovementResults=new Jn,this.myDebugResults=new Zn,this.myInternalResults=new Yn}reset(){}copy(e){}},Ai={CHECK_MOVEMENT:0,CHECK_TELEPORT:1,CHECK_TRANSFORM:2,UPDATE_SURFACE_INFO:3,UPDATE_GROUND_INFO:4,UPDATE_CEILING_INFO:5},$i=class{constructor(){this.myOnSurface=!1,this.mySurfaceAngle=0,this.mySurfacePerceivedAngle=0,this.mySurfaceNormal=p(),this.mySurfaceHitMaxAngle=0,this.mySurfaceHitMaxNormal=p(),this.mySurfaceDistance=null,this.myBaseInsideCollision=!1}reset(){}copy(e){}},Qn=class{constructor(){this.myHasSlid=!1,this.mySlideMovementAngle=0,this.mySlideMovementWallAngle=0,this.myWallNormal=p()}reset(){}copy(e){}},qn=class{constructor(){this.myInitialTransformQuat=G(),this.myFinalTransformQuat=G()}reset(){}copy(e){}},Ei=class{constructor(){this.myInitialMovement=p(),this.myFinalMovement=p(),this.myMovementFailed=!1,this.myMovementCollided=!1,this.myReferenceCollisionHit=new st}reset(){}copy(e){}},Xn=class{constructor(){this.myInitialTeleportTransformQuat=G(),this.myFinalTeleportTransformQuat=G(),this.myTeleportFailed=!1}reset(){}copy(e){}},Kn=class{constructor(){this.myInitialCheckTransformQuat=G(),this.myFinalCheckTransformQuat=G(),this.myCheckTransformFailed=!1}reset(){}copy(e){}},en=class{constructor(){this.myHasSnappedOnSurface=!1,this.myHasPoppedOutSurface=!1,this.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleDownhill=!1,this.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleUphill=!1,this.myHasVerticalMovementAdjustedHorizontalMovementOverSurfaceAngleDownhill=!1}reset(){}copy(e){}},Jn=class{constructor(){this.myStepsToPerform=0,this.myStepsPerformed=0,this.myMovementInterrupted=!1,this.myMovementChecked=p()}reset(){}copy(e){}},Zn=class{constructor(){this._myRaycastsPerformed=0}reset(){}copy(e){}},Yn=class{constructor(){this.myLastRelevantInitialHorizontalMovement=p(),this.myLastRelevantAdjustedInitialHorizontalMovement=p(),this.myLastRelevantFinalHorizontalMovement=p(),this.myLastRelevantInitialVerticalMovement=p(),this.myLastRelevantAdjustedInitialVerticalMovement=p(),this.myLastRelevantFinalVerticalMovement=p(),this.myLastRelevantHasWallSlid=!1,this.myHasWallSlidTowardOppositeDirection=!1,this.myLastRelevantWallSlideFlickerPrevented=!1,this.myWallSlideFlickerPreventionForceCheckCounter=0,this.myWallSlide90DegreesDirectionSign=0,this.myWallSlide90DegreesRecomputeDirectionSign=!0}reset(){}copy(e){}};Ue.prototype.reset=function(){this.myCheckType=null,this.myTransformResults.reset(),this.myMovementResults.reset(),this.myHorizontalMovementResults.reset(),this.myVerticalMovementResults.reset(),this.myTeleportResults.reset(),this.myCheckTransformResults.reset(),this.myWallSlideResults.reset(),this.myGroundInfo.reset(),this.myCeilingInfo.reset(),this.myGroundResults.reset(),this.myCeilingResults.reset(),this.mySplitMovementResults.reset(),this.myInternalResults.reset()};Ue.prototype.copy=function(e){this.myCheckType=e.myCheckType,this.myTransformResults.copy(e.myTransformResults),this.myMovementResults.copy(e.myMovementResults),this.myHorizontalMovementResults.copy(e.myHorizontalMovementResults),this.myVerticalMovementResults.copy(e.myVerticalMovementResults),this.myTeleportResults.copy(e.myTeleportResults),this.myCheckTransformResults.copy(e.myCheckTransformResults),this.myWallSlideResults.copy(e.myWallSlideResults),this.myGroundInfo.copy(e.myGroundInfo),this.myCeilingInfo.copy(e.myCeilingInfo),this.myGroundResults.copy(e.myGroundResults),this.myCeilingResults.copy(e.myCeilingResults),this.mySplitMovementResults.copy(e.mySplitMovementResults),this.myInternalResults.copy(e.myInternalResults)};$i.prototype.reset=function(){this.myOnSurface=!1,this.mySurfaceAngle=0,this.mySurfacePerceivedAngle=0,this.mySurfaceNormal.vec3_zero(),this.mySurfaceHitMaxAngle=0,this.mySurfaceHitMaxNormal.vec3_zero(),this.mySurfaceDistance=null,this.myBaseInsideCollision=!1};$i.prototype.copy=function(e){this.myOnSurface=e.myOnSurface,this.mySurfaceAngle=e.mySurfaceAngle,this.mySurfacePerceivedAngle=e.mySurfacePerceivedAngle,this.mySurfaceNormal.vec3_copy(e.mySurfaceNormal),this.mySurfaceHitMaxAngle=e.mySurfaceHitMaxAngle,this.mySurfaceHitMaxNormal.vec3_copy(e.mySurfaceHitMaxNormal),this.mySurfaceDistance=e.mySurfaceDistance,this.myBaseInsideCollision=e.myBaseInsideCollision};Qn.prototype.reset=function(){this.myHasSlid=!1,this.mySlideMovementAngle=0,this.mySlideMovementWallAngle=0,this.myWallNormal.vec3_zero()};Qn.prototype.copy=function(e){this.myHasSlid=e.myHasSlid,this.mySlideMovementAngle=e.mySlideMovementAngle,this.mySlideMovementWallAngle=e.mySlideMovementWallAngle,this.myWallNormal.vec3_copy(e.myWallNormal)};qn.prototype.reset=function(){this.myInitialTransformQuat.quat2_identity(),this.myFinalTransformQuat.quat2_identity()};qn.prototype.copy=function(e){this.myInitialTransformQuat.quat2_copy(e.myInitialTransformQuat),this.myFinalTransformQuat.quat2_copy(e.myFinalTransformQuat)};Ei.prototype.reset=function(){this.myInitialMovement.vec3_zero(),this.myFinalMovement.vec3_zero(),this.myMovementFailed=!1,this.myMovementCollided=!1,this.myReferenceCollisionHit.reset()};Ei.prototype.copy=function(e){this.myInitialMovement.vec3_copy(e.myInitialMovement),this.myFinalMovement.vec3_copy(e.myFinalMovement),this.myMovementFailed=e.myMovementFailed,this.myMovementCollided=e.myMovementCollided,this.myReferenceCollisionHit.copy(e.myReferenceCollisionHit)};Xn.prototype.reset=function(){this.myInitialTeleportTransformQuat.quat2_identity(),this.myFinalTeleportTransformQuat.quat2_identity(),this.myTeleportFailed=!1};Xn.prototype.copy=function(e){this.myInitialTeleportTransformQuat.quat2_copy(e.myInitialTeleportTransformQuat),this.myFinalTeleportTransformQuat.quat2_copy(e.myFinalTeleportTransformQuat),this.myTeleportFailed=e.myTeleportFailed};Kn.prototype.reset=function(){this.myInitialCheckTransformQuat.quat2_identity(),this.myFinalCheckTransformQuat.quat2_identity(),this.myCheckTransformFailed=!1};Kn.prototype.copy=function(e){this.myInitialCheckTransformQuat.quat2_copy(e.myInitialCheckTransformQuat),this.myFinalCheckTransformQuat.quat2_copy(e.myFinalCheckTransformQuat),this.myCheckTransformFailed=e.myCheckTransformFailed};en.prototype.reset=function(){this.myHasSnappedOnSurface=!1,this.myHasPoppedOutSurface=!1,this.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleDownhill=!1,this.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleUphill=!1,this.myHasVerticalMovementAdjustedHorizontalMovementOverSurfaceAngleDownhill=!1};en.prototype.copy=function(e){this.myHasSnappedOnSurface=e.myHasSnappedOnSurface,this.myHasPoppedOutSurface=e.myHasPoppedOutSurface,this.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleDownhill=e.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleDownhill,this.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleUphill=e.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleUphill,this.myHasVerticalMovementAdjustedHorizontalMovementOverSurfaceAngleDownhill=e.myHasVerticalMovementAdjustedHorizontalMovementOverSurfaceAngleDownhill};Jn.prototype.reset=function(){this.myStepsToPerform=0,this.myStepsPerformed=0,this.myMovementInterrupted=!1,this.myMovementChecked.vec3_zero()};Jn.prototype.copy=function(e){this.myStepsToPerform=e.myStepsToPerform,this.myStepsPerformed=e.myStepsPerformed,this.myMovementInterrupted=e.myMovementInterrupted,this.myMovementChecked.vec3_copy(e.myMovementChecked)};Zn.prototype.reset=function(){this._myRaycastsPerformed=0};Zn.prototype.copy=function(e){this._myRaycastsPerformed=e._myRaycastsPerformed};Yn.prototype.reset=function(){};Yn.prototype.copy=function(e){this.myLastRelevantInitialHorizontalMovement.vec3_copy(e.myLastRelevantInitialHorizontalMovement),this.myLastRelevantAdjustedInitialHorizontalMovement.vec3_copy(e.myLastRelevantAdjustedInitialHorizontalMovement),this.myLastRelevantFinalHorizontalMovement.vec3_copy(e.myLastRelevantFinalHorizontalMovement),this.myLastRelevantInitialVerticalMovement.vec3_copy(e.myLastRelevantInitialVerticalMovement),this.myLastRelevantAdjustedInitialVerticalMovement.vec3_copy(e.myLastRelevantAdjustedInitialVerticalMovement),this.myLastRelevantFinalVerticalMovement.vec3_copy(e.myLastRelevantFinalVerticalMovement),this.myLastRelevantHasWallSlid=e.myLastRelevantHasWallSlid,this.myHasWallSlidTowardOppositeDirection=e.myHasWallSlidTowardOppositeDirection,this.myLastRelevantWallSlideFlickerPrevented=e.myLastRelevantWallSlideFlickerPrevented,this.myWallSlideFlickerPreventionForceCheckCounter=e.myWallSlideFlickerPreventionForceCheckCounter,this.myWallSlide90DegreesDirectionSign=e.myWallSlide90DegreesDirectionSign,this.myWallSlide90DegreesRecomputeDirectionSign=e.myWallSlide90DegreesRecomputeDirectionSign};var am=new WeakMap;function YC(i=m.getMainEngine()){return am.get(i)}function $C(i,e=m.getMainEngine()){am.set(e,i)}function eb(i=m.getMainEngine()){am.has(i)||Q.setCollisionCheck(new N(i),i)}var tb=function(){let i=new et,e=new de;return function(n,o,s,a,l=new Ue,h=m.getMainEngine()){Q.convertCharacterColliderSetupToCollisionCheckParams(s,i),Q.convertCharacterCollisionResultsToCollisionRuntimeParams(a,e),Q.getCollisionCheck(h).move(n,o,i,e),Q.convertCollisionRuntimeParamsToCharacterCollisionResults(e,o,l)}}(),ib=function(){let i=p(),e=new et,t=new de;return function(o,s,a,l,h=new Ue,_=m.getMainEngine()){Q.convertCharacterColliderSetupToCollisionCheckParams(a,e),Q.convertCharacterCollisionResultsToCollisionRuntimeParams(l,t),i=o.quat2_getPosition(i),Q.getCollisionCheck(_).teleport(i,o,e,t),Q.convertCollisionRuntimeParamsToCharacterCollisionResults(t,s,h)}}(),nb=function(){let i=new et,e=new de;return function(n,o,s,a=new Ue,l=m.getMainEngine()){Q.convertCharacterColliderSetupToCollisionCheckParams(o,i),Q.convertCharacterCollisionResultsToCollisionRuntimeParams(s,e),Q.getCollisionCheck(l).positionCheck(!0,n,i,e),Q.convertCollisionRuntimeParamsToCharacterCollisionResults(e,n,a)}}(),ob=function(){let i=new et,e=new de;return function(n,o,s,a=new Ue,l=m.getMainEngine()){Q.convertCharacterColliderSetupToCollisionCheckParams(o,i),Q.convertCharacterCollisionResultsToCollisionRuntimeParams(s,e),i.myComputeCeilingInfoEnabled=!1,Q.getCollisionCheck(l).updateSurfaceInfo(n,i,e),Q.convertCollisionRuntimeParamsToCharacterCollisionResults(e,n,a)}}(),sb=function(){let i=new et,e=new de;return function(n,o,s,a=new Ue,l=m.getMainEngine()){Q.convertCharacterColliderSetupToCollisionCheckParams(o,i),Q.convertCharacterCollisionResultsToCollisionRuntimeParams(s,e),i.myComputeGroundInfoEnabled=!1,Q.getCollisionCheck(l).updateSurfaceInfo(n,i,e),Q.convertCollisionRuntimeParamsToCharacterCollisionResults(e,n,a)}}();function ab(i,e){return e.reset(),i.myTransformResults.myInitialTransformQuat.quat2_getPosition(e.myOriginalPosition),i.myTransformResults.myFinalTransformQuat.quat2_getPosition(e.myNewPosition),i.myTransformResults.myInitialTransformQuat.quat2_getForward(e.myOriginalForward),i.myTransformResults.myInitialTransformQuat.quat2_getUp(e.myOriginalUp),e.myOriginalMovement.vec3_copy(i.myMovementResults.myInitialMovement),e.myFixedMovement.vec3_copy(i.myMovementResults.myFinalMovement),e.myLastValidOriginalHorizontalMovement.vec3_copy(i.myInternalResults.myLastRelevantInitialHorizontalMovement),e.myLastValidOriginalVerticalMovement.vec3_copy(i.myInternalResults.myLastRelevantInitialVerticalMovement),e.myLastValidEndHorizontalMovement.vec3_copy(i.myInternalResults.myLastRelevantFinalHorizontalMovement),e.myLastValidEndVerticalMovement.vec3_copy(i.myInternalResults.myLastRelevantFinalVerticalMovement),e.myLastValidSurfaceAdjustedHorizontalMovement.vec3_copy(i.myInternalResults.myLastRelevantAdjustedInitialHorizontalMovement),e.myLastValidSurfaceAdjustedVerticalMovement.vec3_copy(i.myInternalResults.myLastRelevantAdjustedInitialVerticalMovement),e.myIsOnGround=i.myGroundInfo.myOnSurface,e.myGroundAngle=i.myGroundInfo.mySurfaceAngle,e.myGroundPerceivedAngle=i.myGroundInfo.mySurfacePerceivedAngle,e.myGroundNormal.vec3_copy(i.myGroundInfo.mySurfaceNormal),e.myGroundHitMaxAngle=i.myGroundInfo.mySurfaceHitMaxAngle,e.myGroundHitMaxNormal.vec3_copy(i.myGroundInfo.mySurfaceHitMaxNormal),e.myGroundDistance=i.myGroundInfo.mySurfaceDistance,e.myGroundIsBaseInsideCollision=i.myGroundInfo.myBaseInsideCollision,e.myIsOnCeiling=i.myCeilingInfo.myOnSurface,e.myCeilingAngle=i.myCeilingInfo.mySurfaceAngle,e.myCeilingPerceivedAngle=i.myCeilingInfo.mySurfacePerceivedAngle,e.myCeilingNormal.vec3_copy(i.myCeilingInfo.mySurfaceNormal),e.myCeilingHitMaxAngle=i.myCeilingInfo.mySurfaceHitMaxAngle,e.myCeilingHitMaxNormal.vec3_copy(i.myCeilingInfo.mySurfaceHitMaxNormal),e.myCeilingDistance=i.myCeilingInfo.mySurfaceDistance,e.myCeilingIsBaseInsideCollision=i.myCeilingInfo.myBaseInsideCollision,e.myHorizontalMovementCanceled=i.myHorizontalMovementResults.myMovementFailed,e.myIsCollidingHorizontally=i.myHorizontalMovementResults.myMovementCollided,e.myHorizontalCollisionHit.copy(i.myHorizontalMovementResults.myReferenceCollisionHit),e.myVerticalMovementCanceled=i.myVerticalMovementResults.myMovementFailed,e.myIsCollidingVertically=i.myVerticalMovementResults.myMovementCollided,e.myVerticalCollisionHit.copy(i.myVerticalMovementResults.myReferenceCollisionHit),e.myHasSnappedOnGround=i.myGroundResults.myHasSnappedOnSurface,e.myHasSnappedOnCeiling=i.myCeilingResults.myHasSnappedOnSurface,e.myHasPoppedOutGround=i.myGroundResults.myHasPoppedOutSurface,e.myHasPoppedOutCeiling=i.myCeilingResults.myHasPoppedOutSurface,e.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleDownhill=i.myGroundResults.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleDownhill,e.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleUphill=i.myGroundResults.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleUphill,e.myVerticalMovementHasAdjustedHorizontalMovementOverGroundAngleDownhill=i.myGroundResults.myHasVerticalMovementAdjustedHorizontalMovementOverSurfaceAngleDownhill,e.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleDownhill=i.myCeilingResults.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleDownhill,e.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleUphill=i.myCeilingResults.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleUphill,e.myVerticalMovementHasAdjustedHorizontalMovementOverCeilingAngleDownhill=i.myCeilingResults.myHasVerticalMovementAdjustedHorizontalMovementOverSurfaceAngleDownhill,e.myIsSliding=i.myWallSlideResults.myHasSlid,e.mySlidingMovementAngle=i.myWallSlideResults.mySlideMovementAngle,e.mySlidingCollisionAngle=i.myWallSlideResults.mySlideMovementWallAngle,e.mySlidingWallNormal.vec3_copy(i.myWallSlideResults.myWallNormal),e.myIsSlidingIntoOppositeDirection=i.myInternalResults.myHasWallSlidTowardOppositeDirection,e.myIsSlidingFlickerPrevented=i.myInternalResults.myLastRelevantWallSlideFlickerPrevented,e.mySlidingFlickerPreventionCheckAnywayCounter=i.myInternalResults.myWallSlideFlickerPreventionForceCheckCounter,e.mySliding90DegreesSign=i.myInternalResults.myWallSlide90DegreesDirectionSign,e.mySlidingRecompute90DegreesSign=i.myInternalResults.myWallSlide90DegreesRecomputeDirectionSign,e.myLastValidIsSliding=i.myInternalResults.myLastRelevantHasWallSlid,e.mySlidingPreviousHorizontalMovement.vec3_copy(i.myInternalResults.myLastRelevantFinalHorizontalMovement),e.myOriginalTeleportPosition.vec3_copy(i.myTeleportResults.myInitialTeleportTransformQuat),e.myFixedTeleportPosition.vec3_copy(i.myTeleportResults.myFinalTeleportTransformQuat),e.myTeleportCanceled=i.myTeleportResults.myTeleportFailed,e.myIsPositionOk=i.myCheckTransformResults.myCheckTransformFailed,i.myCheckTransformResults.myInitialCheckTransformQuat.quat2_getPosition(e.myOriginalPositionCheckPosition),i.myCheckTransformResults.myFinalCheckTransformQuat.quat2_getPosition(e.myFixedPositionCheckPosition),e.myIsTeleport=i.myCheckType==Ai.CHECK_TELEPORT,e.myIsMove=i.myCheckType==Ai.CHECK_MOVEMENT,e.myIsPositionCheck=i.myCheckType==Ai.CHECK_TRANSFORM,e.mySplitMovementSteps=i.mySplitMovementResults.myStepsToPerform,e.mySplitMovementStepsPerformed=i.mySplitMovementResults.myStepsPerformed,e.mySplitMovementStop=i.mySplitMovementResults.myMovementInterrupted,e.mySplitMovementMovementChecked.vec3_copy(i.mySplitMovementResults.myMovementChecked),e}var rb=function(){let i=w();return function(t,n,o){return o.reset(),t.myIsMove?o.myCheckType=Ai.CHECK_MOVEMENT:t.myIsTeleport?o.myCheckType=Ai.CHECK_TELEPORT:t.myIsPositionCheck&&(o.myCheckType=Ai.CHECK_TRANSFORM),i.quat_setForward(t.myOriginalForward,t.myOriginalUp),o.myTransformResults.myInitialTransformQuat.quat2_setPositionRotationQuat(t.myOriginalPosition,i),o.myTransformResults.myFinalTransformQuat.quat2_setPositionRotationQuat(t.myNewPosition,i),o.myMovementResults.myInitialMovement.vec3_copy(t.myOriginalMovement),o.myMovementResults.myFinalMovement.vec3_copy(t.myFixedMovement),o.myMovementResults.myMovementFailed=t.myHorizontalMovementCanceled&&t.myVerticalMovementCanceled,o.myMovementResults.myMovementCollided=t.myIsCollidingHorizontally||t.myIsCollidingVertically,t.myIsCollidingHorizontally?o.myMovementResults.myReferenceCollisionHit.copy(t.myHorizontalCollisionHit):t.myIsCollidingVertically&&o.myMovementResults.myReferenceCollisionHit.copy(t.myVerticalCollisionHit),o.myHorizontalMovementResults.myMovementFailed=t.myHorizontalMovementCanceled,o.myHorizontalMovementResults.myMovementCollided=t.myIsCollidingHorizontally,o.myHorizontalMovementResults.myReferenceCollisionHit.copy(t.myHorizontalCollisionHit),o.myHorizontalMovementResults.myInitialMovement=t.myOriginalMovement.vec3_removeComponentAlongAxis(t.myOffsetUp,o.myHorizontalMovementResults.myInitialMovement),o.myHorizontalMovementResults.myFinalMovement=t.myFixedMovement.vec3_removeComponentAlongAxis(t.myOffsetUp,o.myHorizontalMovementResults.myFinalMovement),o.myVerticalMovementResults.myMovementFailed=t.myVerticalMovementCanceled,o.myVerticalMovementResults.myMovementCollided=t.myIsCollidingVertically,o.myVerticalMovementResults.myReferenceCollisionHit.copy(t.myVerticalCollisionHit),o.myVerticalMovementResults.myInitialMovement=t.myOriginalMovement.vec3_componentAlongAxis(t.myOffsetUp,o.myVerticalMovementResults.myInitialMovement),o.myVerticalMovementResults.myFinalMovement=t.myFixedMovement.vec3_componentAlongAxis(t.myOffsetUp,o.myVerticalMovementResults.myFinalMovement),o.myTeleportResults.myInitialTeleportTransformQuat.quat2_copy(o.myTransformResults.myInitialTransformQuat),o.myTeleportResults.myInitialTeleportTransformQuat.quat2_setPosition(t.myOriginalTeleportPosition),o.myTeleportResults.myFinalTeleportTransformQuat.quat2_copy(o.myTransformResults.myFinalTransformQuat),o.myTeleportResults.myFinalTeleportTransformQuat.quat2_setPosition(t.myFixedTeleportPosition),o.myTeleportResults.myTeleportFailed=t.myTeleportCanceled,o.myCheckTransformResults.myInitialCheckTransformQuat.quat2_copy(o.myTransformResults.myInitialTransformQuat),o.myCheckTransformResults.myInitialCheckTransformQuat.quat2_setPosition(t.myOriginalPositionCheckPosition),o.myCheckTransformResults.myFinalCheckTransformQuat.quat2_copy(o.myTransformResults.myFinalTransformQuat),o.myCheckTransformResults.myFinalCheckTransformQuat.quat2_setPosition(t.myFixedPositionCheckPosition),o.myCheckTransformResults.myCheckTransformFailed=!t.myIsPositionOk,o.myWallSlideResults.myHasSlid=t.myIsSliding,o.myWallSlideResults.mySlideMovementAngle=t.mySlidingMovementAngle,o.myWallSlideResults.mySlideMovementWallAngle=t.mySlidingCollisionAngle,o.myWallSlideResults.myWallNormal.vec3_copy(t.mySlidingWallNormal),o.myGroundInfo.myOnSurface=t.myIsOnGround,o.myGroundInfo.mySurfaceAngle=t.myGroundAngle,o.myGroundInfo.mySurfacePerceivedAngle=t.myGroundPerceivedAngle,o.myGroundInfo.mySurfaceNormal.vec3_copy(t.myGroundNormal),o.myGroundInfo.mySurfaceHitMaxAngle=t.myGroundHitMaxAngle,o.myGroundInfo.mySurfaceHitMaxNormal.vec3_copy(t.myGroundHitMaxNormal),o.myGroundInfo.mySurfaceDistance=t.myGroundDistance,o.myGroundInfo.myBaseInsideCollision=t.myGroundIsBaseInsideCollision,o.myCeilingInfo.myOnSurface=t.myIsOnCeiling,o.myCeilingInfo.mySurfaceAngle=t.myCeilingAngle,o.myCeilingInfo.mySurfacePerceivedAngle=t.myCeilingPerceivedAngle,o.myCeilingInfo.mySurfaceNormal.vec3_copy(t.myCeilingNormal),o.myCeilingInfo.mySurfaceHitMaxAngle=t.myCeilingHitMaxAngle,o.myCeilingInfo.mySurfaceHitMaxNormal.vec3_copy(t.myCeilingHitMaxNormal),o.myCeilingInfo.mySurfaceDistance=t.myCeilingDistance,o.myCeilingInfo.myBaseInsideCollision=t.myCeilingIsBaseInsideCollision,o.myGroundResults.myHasSnappedOnSurface=t.myHasSnappedOnGround,o.myGroundResults.myHasPoppedOutSurface=t.myHasPoppedOutGround,o.myCeilingResults.myHasSnappedOnSurface=t.myHasSnappedOnCeiling,o.myCeilingResults.myHasPoppedOutSurface=t.myHasPoppedOutCeiling,o.myGroundResults.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleDownhill=t.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleDownhill,o.myGroundResults.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleUphill=t.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleUphill,o.myGroundResults.myHasVerticalMovementAdjustedHorizontalMovementOverSurfaceAngleDownhill=t.myVerticalMovementHasAdjustedHorizontalMovementOverGroundAngleDownhill,o.myCeilingResults.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleDownhill=t.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleDownhill,o.myCeilingResults.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleUphill=t.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleUphill,o.myCeilingResults.myHasVerticalMovementAdjustedHorizontalMovementOverSurfaceAngleDownhill=t.myVerticalMovementHasAdjustedHorizontalMovementOverCeilingAngleDownhill,o.mySplitMovementResults.myStepsToPerform=t.mySplitMovementSteps,o.mySplitMovementResults.myStepsPerformed=t.mySplitMovementStepsPerformed,o.mySplitMovementResults.myMovementInterrupted=t.mySplitMovementStop,o.mySplitMovementResults.myMovementChecked.vec3_copy(t.mySplitMovementMovementChecked),o.myInternalResults.myLastRelevantInitialHorizontalMovement.vec3_copy(t.myLastValidOriginalHorizontalMovement),o.myInternalResults.myLastRelevantFinalHorizontalMovement.vec3_copy(t.myLastValidEndHorizontalMovement),o.myInternalResults.myLastRelevantInitialVerticalMovement.vec3_copy(t.myLastValidOriginalVerticalMovement),o.myInternalResults.myLastRelevantFinalVerticalMovement.vec3_copy(t.myLastValidEndVerticalMovement),o.myInternalResults.myLastRelevantAdjustedInitialHorizontalMovement.vec3_copy(t.myLastValidSurfaceAdjustedHorizontalMovement),o.myInternalResults.myLastRelevantAdjustedInitialVerticalMovement.vec3_copy(t.myLastValidSurfaceAdjustedVerticalMovement),o.myInternalResults.myLastRelevantHasWallSlid=t.myLastValidIsSliding,o.myInternalResults.myHasWallSlidTowardOppositeDirection=t.myIsSlidingIntoOppositeDirection,o.myInternalResults.myLastRelevantWallSlideFlickerPrevented=t.myIsSlidingFlickerPrevented,o.myInternalResults.myWallSlideFlickerPreventionForceCheckCounter=t.mySlidingFlickerPreventionCheckAnywayCounter,o.myInternalResults.myWallSlide90DegreesDirectionSign=t.mySliding90DegreesSign,o.myInternalResults.myWallSlide90DegreesRecomputeDirectionSign=t.mySlidingRecompute90DegreesSign,o.myTransformResults.myInitialTransformQuat.quat2_copy(n),o}}(),lb=function(){return function(e,t){return t.myHeight=e.myHeight,t.myRadius=e.myHorizontalCheckParams.myHorizontalCheckConeRadius,t.myDistanceFromFeetToIgnore=e.myHorizontalCheckParams.myHorizontalCheckFeetDistanceToIgnore,t.myDistanceFromHeadToIgnore=e.myHorizontalCheckParams.myHorizontalCheckHeadDistanceToIgnore,t.myHorizontalMovementCheckEnabled=e.myHorizontalCheckParams.myHorizontalMovementCheckEnabled,t.myHorizontalMovementStepEnabled=e.myHorizontalCheckParams.myHorizontalMovementCheckSplitMovementEnabled,t.myHorizontalMovementStepMaxLength=e.myHorizontalCheckParams.myHorizontalMovementCheckSplitMovementMaxStepLength,t.myHorizontalMovementRadialStepAmount=e.myHorizontalCheckParams.myHorizontalMovementCheckRadialSteps,t.myHorizontalMovementCheckDiagonalOutward=e.myHorizontalCheckParams.myHorizontalMovementHorizontalDiagonalOutwardCheckEnabled,t.myHorizontalMovementCheckDiagonalInward=e.myHorizontalCheckParams.myHorizontalMovementHorizontalDiagonalInwardCheckEnabled,t.myHorizontalMovementCheckStraight=e.myHorizontalCheckParams.myHorizontalMovementHorizontalStraightCheckEnabled,t.myHorizontalMovementCheckHorizontalBorder=e.myHorizontalCheckParams.myHorizontalMovementHorizontalRadialCheckEnabled,t.myHorizontalMovementCheckVerticalStraight=e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightCheckEnabled,t.myHorizontalMovementCheckVerticalDiagonalUpwardOutward=e.myHorizontalCheckParams.myHorizontalMovementVerticalDiagonalOutwardUpwardCheckEnabled,t.myHorizontalMovementCheckVerticalDiagonalUpwardInward=e.myHorizontalCheckParams.myHorizontalMovementVerticalDiagonalInwardUpwardCheckEnabled,t.myHorizontalMovementCheckVerticalDiagonalDownwardOutward=e.myHorizontalCheckParams.myHorizontalMovementVerticalDiagonalOutwardDownwardCheckEnabled,t.myHorizontalMovementCheckVerticalDiagonalDownwardInward=e.myHorizontalCheckParams.myHorizontalMovementVerticalDiagonalInwardDownwardCheckEnabled,t.myHorizontalMovementCheckVerticalStraightDiagonalUpward=e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalUpwardCheckEnabled,t.myHorizontalMovementCheckVerticalStraightDiagonalDownward=e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalDownwardCheckEnabled,t.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward=e.myHorizontalCheckParams.myHorizontalMovementVerticalRadialDiagonalOutwardCheckEnabled,t.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward=e.myHorizontalCheckParams.myHorizontalMovementVerticalRadialDiagonalInwardCheckEnabled,t.myHorizontalMovementHorizontalStraightCentralCheckEnabled=e.myHorizontalCheckParams.myHorizontalMovementHorizontalStraightCentralCheckEnabled,t.myHorizontalMovementVerticalStraightCentralCheckEnabled=e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightCentralCheckEnabled,t.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled,t.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled=e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled,t.myHorizontalPositionCheckEnabled=e.myHorizontalCheckParams.myHorizontalPositionCheckEnabled,t.myHalfConeAngle=e.myHorizontalCheckParams.myHorizontalCheckConeHalfAngle,t.myHalfConeSliceAmount=e.myHorizontalCheckParams.myHorizontalPositionCheckConeHalfSlices,t.myCheckConeBorder=e.myHorizontalCheckParams.myHorizontalPositionHorizontalBorderCheckEnabled,t.myCheckConeRay=e.myHorizontalCheckParams.myHorizontalPositionHorizontalRadialCheckEnabled,t.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision=e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckIgnoreHitsInsideCollision,t.myHorizontalPositionCheckVerticalDirectionType=e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckDirection,t.myCheckHeight=e.myHorizontalCheckParams.myHorizontalHeightCheckEnabled,t.myCheckHeightVerticalMovement=e.myHorizontalCheckParams.myHorizontalMovementHeightVerticalCheckEnabled,t.myCheckHeightVerticalPosition=e.myHorizontalCheckParams.myHorizontalPositionHeightVerticalCheckEnabled,t.myCheckHeightTopMovement=e.myHorizontalCheckParams.myHorizontalMovementHeightHorizontalCheckEnabled,t.myCheckHeightTopPosition=e.myHorizontalCheckParams.myHorizontalPositionHeightHorizontalCheckEnabled,t.myCheckHeightConeOnCollision=e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHit,t.myCheckHeightConeOnCollisionKeepHit=e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHitKeepVerticalHitIfNoHorizontalHit,t.myHeightCheckStepAmountMovement=e.myHorizontalCheckParams.myHorizontalMovementHeightCheckSteps,t.myHeightCheckStepAmountPosition=e.myHorizontalCheckParams.myHorizontalPositionHeightCheckSteps,t.myCheckVerticalStraight=e.myHorizontalCheckParams.myHorizontalPositionVerticalStraightCheckEnabled,t.myCheckVerticalDiagonalRayOutward=e.myHorizontalCheckParams.myHorizontalPositionVerticalRadialDiagonalOutwardCheckEnabled,t.myCheckVerticalDiagonalRayInward=e.myHorizontalCheckParams.myHorizontalPositionVerticalRadialDiagonalInwardCheckEnabled,t.myCheckVerticalDiagonalBorderOutward=e.myHorizontalCheckParams.myHorizontalPositionVerticalBorderDiagonalOutwardCheckEnabled,t.myCheckVerticalDiagonalBorderInward=e.myHorizontalCheckParams.myHorizontalPositionVerticalBorderDiagonalInwardCheckEnabled,t.myCheckVerticalDiagonalBorderRayOutward=e.myHorizontalCheckParams.myHorizontalPositionVerticalRadialBorderDiagonalOutwardCheckEnabled,t.myCheckVerticalDiagonalBorderRayInward=e.myHorizontalCheckParams.myHorizontalPositionVerticalRadialBorderDiagonalInwardCheckEnabled,t.myCheckVerticalSearchFartherVerticalHit=e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckGetFarthestHit,t.myCheckHorizontalFixedForwardEnabled=e.myHorizontalCheckParams.myHorizontalCheckFixedForwardEnabled,t.myCheckHorizontalFixedForward.vec3_copy(e.myHorizontalCheckParams.myHorizontalCheckFixedForward),t.myVerticalMovementCheckEnabled=e.myVerticalCheckParams.myVerticalMovementCheckEnabled,t.myVerticalPositionCheckEnabled=e.myVerticalCheckParams.myVerticalPositionCheckEnabled,t.myFeetRadius=e.myVerticalCheckParams.myVerticalCheckCircumferenceRadius,t.myAdjustVerticalMovementWithGroundAngleDownhill=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhill,t.myAdjustVerticalMovementWithGroundAngleUphill=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphill,t.myAdjustVerticalMovementWithGroundAngleDownhillMaxAngle=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhillMaxSurfaceAngle,t.myAdjustVerticalMovementWithGroundAngleUphillMaxAngle=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphillMaxSurfaceAngle,t.myAdjustVerticalMovementWithGroundAngleDownhillMaxPerceivedAngle=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhillMaxSurfacePerceivedAngle,t.myAdjustVerticalMovementWithGroundAngleUphillMaxPerceivedAngle=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphillMaxSurfacePerceivedAngle,t.myAdjustHorizontalMovementWithGroundAngleDownhill=e.myGroundParams.myVerticalMovementAdjustHorizontalMovementOverSurfaceAngleDownhill,t.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle=e.myGroundParams.myVerticalMovementAdjustHorizontalMovementOverSurfaceAngleDownhillMinSurfaceAngle,t.myAdjustVerticalMovementWithCeilingAngleDownhill=e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhill,t.myAdjustVerticalMovementWithCeilingAngleUphill=e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphill,t.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle=e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhillMaxSurfaceAngle,t.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle=e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphillMaxSurfaceAngle,t.myAdjustVerticalMovementWithCeilingAngleDownhillMaxPerceivedAngle=e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhillMaxSurfacePerceivedAngle,t.myAdjustVerticalMovementWithCeilingAngleUphillMaxPerceivedAngle=e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphillMaxSurfacePerceivedAngle,t.myAdjustHorizontalMovementWithCeilingAngleDownhill=e.myCeilingParams.myVerticalMovementAdjustHorizontalMovementOverSurfaceAngleDownhill,t.myAdjustHorizontalMovementWithCeilingAngleDownhillMinAngle=e.myCeilingParams.myVerticalMovementAdjustHorizontalMovementOverSurfaceAngleDownhillMinSurfaceAngle,t.myCheckVerticalFixedForwardEnabled=e.myVerticalCheckParams.myVerticalCheckFixedForwardEnabled,t.myCheckVerticalFixedForward.vec3_copy(e.myVerticalCheckParams.myVerticalCheckFixedForward),t.myCheckVerticalBothDirection=e.myVerticalCheckParams.myVerticalMovementCheckPerformCheckOnBothSides,t.myVerticalMovementReduceEnabled=e.myVerticalCheckParams.myVerticalMovementCheckReductionEnabled,t.myGroundCircumferenceAddCenter=e.myVerticalCheckParams.myVerticalCheckCircumferenceCentralCheckEnabled,t.myGroundCircumferenceSliceAmount=e.myVerticalCheckParams.myVerticalCheckCircumferenceSlices,t.myGroundCircumferenceStepAmount=e.myVerticalCheckParams.myVerticalCheckCircumferenceRadialSteps,t.myGroundCircumferenceRotationPerStep=e.myVerticalCheckParams.myVerticalCheckCircumferenceRotationPerRadialStep,t.myVerticalAllowHitInsideCollisionIfOneOk=e.myVerticalCheckParams.myVerticalCheckAllowHitsInsideCollisionIfOneValid,t.myHorizontalBlockLayerFlags.copy(e.myHorizontalCheckParams.myHorizontalCheckBlockLayerFlags),t.myVerticalBlockLayerFlags.copy(e.myVerticalCheckParams.myVerticalCheckBlockLayerFlags),t.myHorizontalObjectsToIgnore.pp_copy(e.myHorizontalCheckParams.myHorizontalCheckObjectsToIgnore),t.myVerticalObjectsToIgnore.pp_copy(e.myVerticalCheckParams.myVerticalCheckObjectsToIgnore),t.mySnapOnGroundEnabled=e.myGroundParams.mySurfaceSnapEnabled,t.mySnapOnGroundExtraDistance=e.myGroundParams.mySurfaceSnapMaxDistance,t.mySnapOnCeilingEnabled=e.myCeilingParams.mySurfaceSnapEnabled,t.mySnapOnCeilingExtraDistance=e.myCeilingParams.mySurfaceSnapMaxDistance,t.myGroundPopOutEnabled=e.myGroundParams.mySurfacePopOutEnabled,t.myGroundPopOutExtraDistance=e.myGroundParams.mySurfacePopOutMaxDistance,t.myCeilingPopOutEnabled=e.myCeilingParams.mySurfacePopOutEnabled,t.myCeilingPopOutExtraDistance=e.myCeilingParams.mySurfacePopOutMaxDistance,t.myGroundAngleToIgnore=e.myGroundParams.mySurfaceAngleToIgnore,t.myGroundAngleToIgnoreWithPerceivedAngle=e.myGroundParams.mySurfaceAngleToIgnoreWithSurfacePerceivedAngle,t.myCeilingAngleToIgnore=e.myCeilingParams.mySurfaceAngleToIgnore,t.myCeilingAngleToIgnoreWithPerceivedAngle=e.myCeilingParams.mySurfaceAngleToIgnoreWithSurfacePerceivedAngle,t.myHorizontalMovementGroundAngleIgnoreHeight=e.myGroundParams.myHorizontalMovementSurfaceAngleToIgnoreMaxVerticalDistance,t.myHorizontalMovementCeilingAngleIgnoreHeight=e.myCeilingParams.myHorizontalMovementSurfaceAngleToIgnoreMaxVerticalDistance,t.myHorizontalPositionGroundAngleIgnoreHeight=e.myGroundParams.myHorizontalPositionSurfaceAngleToIgnoreMaxVerticalDistance,t.myHorizontalPositionCeilingAngleIgnoreHeight=e.myCeilingParams.myHorizontalPositionSurfaceAngleToIgnoreMaxVerticalDistance,t.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft=e.myGroundParams.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft,t.myHorizontalMovementCeilingAngleIgnoreMaxMovementLeft=e.myCeilingParams.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft,t.myComputeGroundInfoEnabled=e.myGroundParams.myCollectSurfaceInfo,t.myComputeCeilingInfoEnabled=e.myCeilingParams.myCollectSurfaceInfo,t.myDistanceToBeOnGround=e.myGroundParams.myOnSurfaceMaxOutsideDistance,t.myDistanceToComputeGroundInfo=e.myGroundParams.myCollectSurfaceNormalMaxOutsideDistance,t.myDistanceToBeOnCeiling=e.myCeilingParams.myOnSurfaceMaxOutsideDistance,t.myDistanceToComputeCeilingInfo=e.myCeilingParams.myCollectSurfaceNormalMaxOutsideDistance,t.myVerticalFixToBeOnGround=e.myGroundParams.myOnSurfaceMaxInsideDistance,t.myVerticalFixToComputeGroundInfo=e.myGroundParams.myCollectSurfaceNormalMaxInsideDistance,t.myVerticalFixToBeOnCeiling=e.myCeilingParams.myOnSurfaceMaxInsideDistance,t.myVerticalFixToComputeCeilingInfo=e.myCeilingParams.myCollectSurfaceNormalMaxInsideDistance,t.myGroundIsBaseInsideCollisionCheckEnabled=e.myGroundParams.myBaseInsideCollisionCheckEnabled,t.myCeilingIsBaseInsideCollisionCheckEnabled=e.myCeilingParams.myBaseInsideCollisionCheckEnabled,t.myIsOnGroundIfInsideHit=e.myGroundParams.myOnSurfaceIfBaseInsideCollision,t.myIsOnCeilingIfInsideHit=e.myCeilingParams.myOnSurfaceIfBaseInsideCollision,t.myFindGroundDistanceMaxOutsideDistance=e.myGroundParams.myFindSurfaceDistanceMaxOutsideDistance,t.myFindGroundDistanceMaxInsideDistance=e.myGroundParams.myFindSurfaceDistanceMaxInsideDistance,t.myFindCeilingDistanceMaxOutsideDistance=e.myCeilingParams.myFindSurfaceDistanceMaxOutsideDistance,t.myFindCeilingDistanceMaxInsideDistance=e.myCeilingParams.myFindSurfaceDistanceMaxInsideDistance,t.myAllowGroundSteepFix=e.myGroundParams.myHorizontalMovementAllowExitAttemptWhenOnNotIgnorableSurfacePerceivedAngle,t.myAllowCeilingSteepFix=e.myCeilingParams.myHorizontalMovementAllowExitAttemptWhenOnNotIgnorableSurfacePerceivedAngle,t.myMustStayOnGround=e.myGroundParams.myMovementMustStayOnSurface,t.myMustStayOnCeiling=e.myCeilingParams.myMovementMustStayOnSurface,t.myRegatherGroundInfoOnSurfaceCheckFail=e.myGroundParams.myRecollectSurfaceInfoOnSurfaceCheckFailed,t.myRegatherCeilingInfoOnSurfaceCheckFail=e.myCeilingParams.myRecollectSurfaceInfoOnSurfaceCheckFailed,t.myMustStayBelowIgnorableGroundAngleDownhill=e.myGroundParams.myMovementMustStayOnIgnorableSurfaceAngleDownhill,t.myMustStayBelowIgnorableCeilingAngleDownhill=e.myCeilingParams.myMovementMustStayOnIgnorableSurfaceAngleDownhill,t.myMustStayBelowGroundAngleDownhill=e.myGroundParams.myMovementMustStayOnSurfaceAngleDownhill,t.myMustStayBelowCeilingAngleDownhill=e.myCeilingParams.myMovementMustStayOnSurfaceAngleDownhill,t.myMovementMustStayOnGroundHitAngle=e.myGroundParams.myMovementMustStayOnSurfaceHitMaxAngle,t.myMovementMustStayOnCeilingHitAngle=e.myCeilingParams.myMovementMustStayOnSurfaceHitMaxAngle,t.myTeleportMustBeOnIgnorableGroundAngle=e.myGroundParams.myTeleportMustBeOnIgnorableSurfaceAngle,t.myCheckTransformMustBeOnIgnorableGroundAngle=e.myGroundParams.myCheckTransformMustBeOnIgnorableSurfaceAngle,t.myTeleportMustBeOnIgnorableCeilingAngle=e.myCeilingParams.myTeleportMustBeOnIgnorableSurfaceAngle,t.myCheckTransformMustBeOnIgnorableCeilingAngle=e.myCeilingParams.myCheckTransformMustBeOnIgnorableSurfaceAngle,t.myTeleportMustBeOnGroundAngle=e.myGroundParams.myTeleportMustBeOnSurfaceAngle,t.myCheckTransformMustBeOnGroundAngle=e.myGroundParams.myCheckTransformMustBeOnSurfaceAngle,t.myTeleportMustBeOnCeilingAngle=e.myCeilingParams.myTeleportMustBeOnSurfaceAngle,t.myCheckTransformMustBeOnCeilingAngle=e.myCeilingParams.myCheckTransformMustBeOnSurfaceAngle,t.myTeleportMustBeOnGround=e.myGroundParams.myTeleportMustBeOnSurface,t.myCheckTransformMustBeOnGround=e.myGroundParams.myCheckTransformMustBeOnSurface,t.myTeleportMustBeOnCeiling=e.myCeilingParams.myTeleportMustBeOnSurface,t.myCheckTransformMustBeOnCeiling=e.myCeilingParams.myCheckTransformMustBeOnSurface,t.mySlidingEnabled=e.myWallSlideParams.myWallSlideEnabled,t.mySlidingHorizontalMovementCheckBetterNormal=e.myHorizontalCheckParams.myHorizontalMovementCheckGetBetterReferenceHit,t.mySlidingMaxAttempts=e.myWallSlideParams.myWallSlideMaxAttempts,t.mySlidingCheckBothDirections=e.myWallSlideParams.myCheckBothWallSlideDirections,t.mySlidingFlickeringPreventionType=e.myWallSlideParams.myWallSlideFlickerPreventionMode,t.mySlidingFlickeringPreventionCheckOnlyIfAlreadySliding=e.myWallSlideParams.myWallSlideFlickerPreventionCheckOnlyIfAlreadySliding,t.mySlidingFlickerPreventionCheckAnywayCounter=e.myWallSlideParams.myWallSlideFlickerPreventionForceCheckCounter,t.mySlidingAdjustSign90Degrees=e.myWallSlideParams.my90DegreesWallSlideAdjustDirectionSign,t.mySplitMovementEnabled=e.mySplitMovementParams.mySplitMovementEnabled,t.mySplitMovementMaxLength=e.mySplitMovementParams.mySplitMovementMaxStepLength,t.mySplitMovementMaxStepsEnabled=e.mySplitMovementParams.mySplitMovementMaxSteps!=null,t.mySplitMovementMaxSteps=e.mySplitMovementParams.mySplitMovementMaxSteps,t.mySplitMovementStepEqualLength=e.mySplitMovementParams.mySplitMovementMaxStepLength==null,t.mySplitMovementStepEqualLengthMinLength=e.mySplitMovementParams.mySplitMovementMinStepLength,t.mySplitMovementStopWhenHorizontalMovementCanceled=e.mySplitMovementParams.mySplitMovementStopOnHorizontalMovementFailed,t.mySplitMovementStopWhenVerticalMovementCanceled=e.mySplitMovementParams.mySplitMovementStopOnVerticalMovementFailed,t.mySplitMovementStopCallback=e.mySplitMovementParams.mySplitMovementStopOnCallback,t.mySplitMovementStopReturnPrevious=e.mySplitMovementParams.mySplitMovementStopReturnPreviousResults,t.myPositionOffsetLocal.vec3_copy(e.myAdditionalParams.myPositionOffsetLocal),t.myRotationOffsetLocalQuat.quat_copy(e.myAdditionalParams.myRotationOffsetLocalQuat),t.myDebugEnabled=e.myDebugParams.myVisualDebugEnabled,t.myDebugHorizontalMovementEnabled=e.myDebugParams.myVisualDebugHorizontalMovementCheckEnabled,t.myDebugHorizontalPositionEnabled=e.myDebugParams.myVisualDebugHorizontalPositionCheckEnabled,t.myDebugVerticalMovementEnabled=e.myDebugParams.myVisualDebugVerticalMovementCheckEnabled,t.myDebugVerticalPositionEnabled=e.myDebugParams.myVisualDebugVerticalPositionCheckEnabled,t.myDebugSlidingEnabled=e.myDebugParams.myVisualDebugSlideEnabled,t.myDebugGroundInfoEnabled=e.myDebugParams.myVisualDebugGroundInfoEnabled,t.myDebugCeilingInfoEnabled=e.myDebugParams.myVisualDebugGroundInfoEnabled,t.myDebugRuntimeParamsEnabled=e.myDebugParams.myVisualDebugResultsEnabled,t.myDebugMovementEnabled=e.myDebugParams.myVisualDebugMovementEnabled,t}}(),Q={getCollisionCheck:YC,setCollisionCheck:$C,initBridge:eb,checkMovement:tb,checkTeleportToTransform:ib,checkTransform:nb,updateGroundInfo:ob,updateCeilingInfo:sb,convertCharacterCollisionResultsToCollisionRuntimeParams:ab,convertCollisionRuntimeParamsToCharacterCollisionResults:rb,convertCharacterColliderSetupToCollisionCheckParams:lb};var tn=class{constructor(){this.myHeight=0,this.myHorizontalCheckParams=new Is,this.myVerticalCheckParams=new Bs,this.myWallSlideParams=new Ls,this.myGroundParams=new $n,this.myCeilingParams=new $n,this.mySplitMovementParams=new Hs,this.myAdditionalParams=new ks,this.myDebugParams=new Fs}copy(e){}},mb={UPWARD:0,DOWNWARD:1,BOTH:2},Is=class{constructor(){this.myHorizontalCheckConeRadius=0,this.myHorizontalCheckConeHalfAngle=0,this.myHorizontalHeightCheckEnabled=!1,this.myHorizontalCheckFeetDistanceToIgnore=0,this.myHorizontalCheckHeadDistanceToIgnore=0,this.myHorizontalCheckFixedForwardEnabled=!1,this.myHorizontalCheckFixedForward=p(),this.myHorizontalMovementCheckEnabled=!1,this.myHorizontalMovementCheckRadialSteps=0,this.myHorizontalMovementCheckSplitMovementEnabled=!1,this.myHorizontalMovementCheckSplitMovementMaxSteps=null,this.myHorizontalMovementCheckSplitMovementMaxStepLength=null,this.myHorizontalMovementCheckSplitMovementMinStepLength=null,this.myHorizontalMovementCheckGetBetterReferenceHit=!1,this.myHorizontalMovementHorizontalRadialCheckEnabled=!1,this.myHorizontalMovementHorizontalDiagonalOutwardCheckEnabled=!1,this.myHorizontalMovementHorizontalDiagonalInwardCheckEnabled=!1,this.myHorizontalMovementHorizontalStraightCheckEnabled=!1,this.myHorizontalMovementHorizontalStraightCentralCheckEnabled=!1,this.myHorizontalMovementHeightCheckSteps=0,this.myHorizontalMovementHeightHorizontalCheckEnabled=!1,this.myHorizontalMovementHeightVerticalCheckEnabled=!1,this.myHorizontalMovementVerticalRadialDiagonalOutwardCheckEnabled=!1,this.myHorizontalMovementVerticalRadialDiagonalInwardCheckEnabled=!1,this.myHorizontalMovementVerticalDiagonalOutwardUpwardCheckEnabled=!1,this.myHorizontalMovementVerticalDiagonalOutwardDownwardCheckEnabled=!1,this.myHorizontalMovementVerticalDiagonalInwardUpwardCheckEnabled=!1,this.myHorizontalMovementVerticalDiagonalInwardDownwardCheckEnabled=!1,this.myHorizontalMovementVerticalStraightCheckEnabled=!1,this.myHorizontalMovementVerticalStraightCentralCheckEnabled=!1,this.myHorizontalMovementVerticalStraightDiagonalUpwardCheckEnabled=!1,this.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=!1,this.myHorizontalMovementVerticalStraightDiagonalDownwardCheckEnabled=!1,this.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled=!1,this.myHorizontalPositionCheckEnabled=!1,this.myHorizontalPositionCheckConeHalfSlices=0,this.myHorizontalPositionHorizontalBorderCheckEnabled=!1,this.myHorizontalPositionHorizontalRadialCheckEnabled=!1,this.myHorizontalPositionHeightCheckSteps=0,this.myHorizontalPositionHeightHorizontalCheckEnabled=!1,this.myHorizontalPositionHeightVerticalCheckEnabled=!1,this.myHorizontalPositionVerticalStraightCheckEnabled=!1,this.myHorizontalPositionVerticalStraightCentralCheckEnabled=!1,this.myHorizontalPositionVerticalRadialDiagonalOutwardCheckEnabled=!1,this.myHorizontalPositionVerticalRadialDiagonalInwardCheckEnabled=!1,this.myHorizontalPositionVerticalBorderDiagonalOutwardCheckEnabled=!1,this.myHorizontalPositionVerticalBorderDiagonalInwardCheckEnabled=!1,this.myHorizontalPositionVerticalRadialBorderDiagonalOutwardCheckEnabled=!1,this.myHorizontalPositionVerticalRadialBorderDiagonalInwardCheckEnabled=!1,this.myHorizontalPositionVerticalCheckGetFarthestHit=!1,this.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHit=!1,this.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHitKeepVerticalHitIfNoHorizontalHit=!1,this.myHorizontalPositionVerticalCheckIgnoreHitsInsideCollision=!1,this.myHorizontalPositionVerticalCheckDirection=mb.UPWARD,this.myHorizontalCheckBlockLayerFlags=new Ve,this.myHorizontalCheckObjectsToIgnore=[]}copy(e){}},Bs=class{constructor(){this.myVerticalCheckCircumferenceRadius=0,this.myVerticalCheckCircumferenceSlices=0,this.myVerticalCheckCircumferenceCentralCheckEnabled=!1,this.myVerticalCheckCircumferenceRadialSteps=0,this.myVerticalCheckCircumferenceRotationPerRadialStep=0,this.myVerticalCheckFixedForwardEnabled=!1,this.myVerticalCheckFixedForward=p(),this.myVerticalMovementCheckEnabled=!1,this.myVerticalMovementCheckReductionEnabled=!1,this.myVerticalMovementCheckPerformCheckOnBothSides=!1,this.myVerticalPositionCheckEnabled=!1,this.myVerticalCheckAllowHitsInsideCollisionIfOneValid=!1,this.myVerticalCheckBlockLayerFlags=new Ve,this.myVerticalCheckObjectsToIgnore=[]}copy(e){}},ws={NONE:0,USE_PREVIOUS_RESULTS:1,COLLISION_ANGLE_ABOVE_90_DEGREES:2,COLLISION_ANGLE_ABOVE_90_DEGREES_OR_MOVEMENT_ANGLE_ABOVE_85_DEGREES:3,ALWAYS:4},Ls=class{constructor(){this.myWallSlideEnabled=!1,this.myWallSlideMaxAttempts=0,this.myCheckBothWallSlideDirections=!1,this.myWallSlideFlickerPreventionMode=ws.NONE,this.myWallSlideFlickerPreventionCheckOnlyIfAlreadySliding=!1,this.myWallSlideFlickerPreventionForceCheckCounter=0,this.my90DegreesWallSlideAdjustDirectionSign=!1}copy(e){}},$n=class{constructor(){this.mySurfaceSnapEnabled=!1,this.mySurfaceSnapMaxDistance=0,this.mySurfacePopOutEnabled=!1,this.mySurfacePopOutMaxDistance=0,this.mySurfaceAngleToIgnore=0,this.mySurfaceAngleToIgnoreWithSurfacePerceivedAngle=null,this.myHorizontalMovementSurfaceAngleToIgnoreMaxVerticalDistance=null,this.myHorizontalPositionSurfaceAngleToIgnoreMaxVerticalDistance=null,this.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft=null,this.myCollectSurfaceInfo=!1,this.myOnSurfaceMaxOutsideDistance=0,this.myOnSurfaceMaxInsideDistance=0,this.myBaseInsideCollisionCheckEnabled=!1,this.myOnSurfaceIfBaseInsideCollision=!1,this.myCollectSurfaceNormalMaxOutsideDistance=0,this.myCollectSurfaceNormalMaxInsideDistance=0,this.myFindSurfaceDistanceMaxOutsideDistance=0,this.myFindSurfaceDistanceMaxInsideDistance=0,this.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhill=!1,this.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphill=!1,this.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhillMaxSurfaceAngle=null,this.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphillMaxSurfaceAngle=null,this.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhillMaxSurfacePerceivedAngle=null,this.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphillMaxSurfacePerceivedAngle=null,this.myVerticalMovementAdjustHorizontalMovementOverSurfaceAngleDownhill=!1,this.myVerticalMovementAdjustHorizontalMovementOverSurfaceAngleDownhillMinSurfaceAngle=null,this.myMovementMustStayOnSurface=!1,this.myMovementMustStayOnSurfaceHitMaxAngle=null,this.myMovementMustStayOnIgnorableSurfaceAngleDownhill=!1,this.myMovementMustStayOnSurfaceAngleDownhill=null,this.myTeleportMustBeOnSurface=!1,this.myTeleportMustBeOnIgnorableSurfaceAngle=!1,this.myTeleportMustBeOnSurfaceAngle=null,this.myCheckTransformMustBeOnSurface=!1,this.myCheckTransformMustBeOnIgnorableSurfaceAngle=!1,this.myCheckTransformMustBeOnSurfaceAngle=null,this.myRecollectSurfaceInfoOnSurfaceCheckFailed=!1,this.myHorizontalMovementAllowExitAttemptWhenOnNotIgnorableSurfacePerceivedAngle=!1}copy(e){}},Hs=class{constructor(){this.mySplitMovementEnabled=!1,this.mySplitMovementMaxSteps=null,this.mySplitMovementMaxStepLength=null,this.mySplitMovementMinStepLength=null,this.mySplitMovementStopOnHorizontalMovementFailed=!1,this.mySplitMovementStopOnVerticalMovementFailed=!1,this.mySplitMovementStopReturnPreviousResults=!1}copy(e){}},ks=class{constructor(){this.myPositionOffsetLocal=p(),this.myRotationOffsetLocalQuat=w()}copy(e){}},Fs=class{constructor(){this.myVisualDebugEnabled=!1,this.myVisualDebugMovementEnabled=!1,this.myVisualDebugHorizontalMovementCheckEnabled=!1,this.myVisualDebugHorizontalPositionCheckEnabled=!1,this.myVisualDebugVerticalMovementCheckEnabled=!1,this.myVisualDebugVerticalPositionCheckEnabled=!1,this.myVisualDebugSlideEnabled=!1,this.myVisualDebugGroundInfoEnabled=!1,this.myVisualDebugCeilingInfoEnabled=!1,this.myVisualDebugResultsEnabled=!1}copy(e){}};tn.prototype.copy=function(e){this.myHeight=e.myHeight,this.myHorizontalCheckParams.copy(e.myHorizontalCheckParams),this.myVerticalCheckParams.copy(e.myVerticalCheckParams),this.myWallSlideParams.copy(e.myWallSlideParams),this.myGroundParams.copy(e.myGroundParams),this.myCeilingParams.copy(e.myCeilingParams),this.mySplitMovementParams.copy(e.mySplitMovementParams),this.myAdditionalParams.copy(e.myAdditionalParams),this.myDebugParams.copy(e.myDebugParams)};Is.prototype.copy=function(e){this.myHorizontalCheckConeRadius=e.myHorizontalCheckConeRadius,this.myHorizontalCheckConeHalfAngle=e.myHorizontalCheckConeHalfAngle,this.myHorizontalHeightCheckEnabled=e.myHorizontalHeightCheckEnabled,this.myHorizontalCheckFeetDistanceToIgnore=e.myHorizontalCheckFeetDistanceToIgnore,this.myHorizontalCheckHeadDistanceToIgnore=e.myHorizontalCheckHeadDistanceToIgnore,this.myHorizontalCheckFixedForwardEnabled=e.myHorizontalCheckFixedForwardEnabled,this.myHorizontalCheckFixedForward.vec3_copy(e.myHorizontalCheckFixedForward),this.myHorizontalMovementCheckEnabled=e.myHorizontalMovementCheckEnabled,this.myHorizontalMovementCheckRadialSteps=e.myHorizontalMovementCheckRadialSteps,this.myHorizontalMovementCheckSplitMovementEnabled=e.myHorizontalMovementCheckSplitMovementEnabled,this.myHorizontalMovementCheckSplitMovementMaxSteps=e.myHorizontalMovementCheckSplitMovementMaxSteps,this.myHorizontalMovementCheckSplitMovementMaxStepLength=e.myHorizontalMovementCheckSplitMovementMaxStepLength,this.myHorizontalMovementCheckSplitMovementMinStepLength=e.myHorizontalMovementCheckSplitMovementMinStepLength,this.myHorizontalMovementCheckGetBetterReferenceHit=e.myHorizontalMovementCheckGetBetterReferenceHit,this.myHorizontalMovementHorizontalRadialCheckEnabled=e.myHorizontalMovementHorizontalRadialCheckEnabled,this.myHorizontalMovementHorizontalDiagonalOutwardCheckEnabled=e.myHorizontalMovementHorizontalDiagonalOutwardCheckEnabled,this.myHorizontalMovementHorizontalDiagonalInwardCheckEnabled=e.myHorizontalMovementHorizontalDiagonalInwardCheckEnabled,this.myHorizontalMovementHorizontalStraightCheckEnabled=e.myHorizontalMovementHorizontalStraightCheckEnabled,this.myHorizontalMovementHorizontalStraightCentralCheckEnabled=e.myHorizontalMovementHorizontalStraightCentralCheckEnabled,this.myHorizontalMovementHeightCheckSteps=e.myHorizontalMovementHeightCheckSteps,this.myHorizontalMovementHeightVerticalCheckEnabled=e.myHorizontalMovementHeightVerticalCheckEnabled,this.myHorizontalMovementHeightHorizontalCheckEnabled=e.myHorizontalMovementHeightHorizontalCheckEnabled,this.myHorizontalMovementVerticalRadialDiagonalOutwardCheckEnabled=e.myHorizontalMovementVerticalRadialDiagonalOutwardCheckEnabled,this.myHorizontalMovementVerticalRadialDiagonalInwardCheckEnabled=e.myHorizontalMovementVerticalRadialDiagonalInwardCheckEnabled,this.myHorizontalMovementVerticalDiagonalOutwardUpwardCheckEnabled=e.myHorizontalMovementVerticalDiagonalOutwardUpwardCheckEnabled,this.myHorizontalMovementVerticalDiagonalOutwardDownwardCheckEnabled=e.myHorizontalMovementVerticalDiagonalOutwardDownwardCheckEnabled,this.myHorizontalMovementVerticalDiagonalInwardUpwardCheckEnabled=e.myHorizontalMovementVerticalDiagonalInwardUpwardCheckEnabled,this.myHorizontalMovementVerticalDiagonalInwardDownwardCheckEnabled=e.myHorizontalMovementVerticalDiagonalInwardDownwardCheckEnabled,this.myHorizontalMovementVerticalStraightCheckEnabled=e.myHorizontalMovementVerticalStraightCheckEnabled,this.myHorizontalMovementVerticalStraightCentralCheckEnabled=e.myHorizontalMovementVerticalStraightCentralCheckEnabled,this.myHorizontalMovementVerticalStraightDiagonalUpwardCheckEnabled=e.myHorizontalMovementVerticalStraightDiagonalUpwardCheckEnabled,this.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=e.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled,this.myHorizontalMovementVerticalStraightDiagonalDownwardCheckEnabled=e.myHorizontalMovementVerticalStraightDiagonalDownwardCheckEnabled,this.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled=e.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled,this.myHorizontalPositionCheckEnabled=e.myHorizontalPositionCheckEnabled,this.myHorizontalPositionCheckConeHalfSlices=e.myHorizontalPositionCheckConeHalfSlices,this.myHorizontalPositionHorizontalBorderCheckEnabled=e.myHorizontalPositionHorizontalBorderCheckEnabled,this.myHorizontalPositionHorizontalRadialCheckEnabled=e.myHorizontalPositionHorizontalRadialCheckEnabled,this.myHorizontalPositionHeightCheckSteps=e.myHorizontalPositionHeightCheckSteps,this.myHorizontalPositionHeightHorizontalCheckEnabled=e.myHorizontalPositionHeightHorizontalCheckEnabled,this.myHorizontalPositionHeightVerticalCheckEnabled=e.myHorizontalPositionHeightVerticalCheckEnabled,this.myHorizontalPositionVerticalStraightCheckEnabled=e.myHorizontalPositionVerticalStraightCheckEnabled,this.myHorizontalPositionVerticalStraightCentralCheckEnabled=e.myHorizontalPositionVerticalStraightCentralCheckEnabled,this.myHorizontalPositionVerticalRadialDiagonalOutwardCheckEnabled=e.myHorizontalPositionVerticalRadialDiagonalOutwardCheckEnabled,this.myHorizontalPositionVerticalRadialDiagonalInwardCheckEnabled=e.myHorizontalPositionVerticalRadialDiagonalInwardCheckEnabled,this.myHorizontalPositionVerticalBorderDiagonalOutwardCheckEnabled=e.myHorizontalPositionVerticalBorderDiagonalOutwardCheckEnabled,this.myHorizontalPositionVerticalBorderDiagonalInwardCheckEnabled=e.myHorizontalPositionVerticalBorderDiagonalInwardCheckEnabled,this.myHorizontalPositionVerticalRadialBorderDiagonalOutwardCheckEnabled=e.myHorizontalPositionVerticalRadialBorderDiagonalOutwardCheckEnabled,this.myHorizontalPositionVerticalRadialBorderDiagonalInwardCheckEnabled=e.myHorizontalPositionVerticalRadialBorderDiagonalInwardCheckEnabled,this.myHorizontalPositionVerticalCheckGetFarthestHit=e.myHorizontalPositionVerticalCheckGetFarthestHit,this.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHit=e.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHit,this.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHitKeepVerticalHitIfNoHorizontalHit=e.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHitKeepVerticalHitIfNoHorizontalHit,this.myHorizontalPositionVerticalCheckIgnoreHitsInsideCollision=e.myHorizontalPositionVerticalCheckIgnoreHitsInsideCollision,this.myHorizontalPositionVerticalCheckDirection=e.myHorizontalPositionVerticalCheckDirection,this.myHorizontalCheckBlockLayerFlags.setMask(e.myHorizontalCheckBlockLayerFlags.getMask()),this.myHorizontalCheckObjectsToIgnore.pp_copy(e.myHorizontalCheckObjectsToIgnore)};Bs.prototype.copy=function(e){this.myVerticalCheckCircumferenceRadius=e.myVerticalCheckCircumferenceRadius,this.myVerticalCheckCircumferenceSlices=e.myVerticalCheckCircumferenceSlices,this.myVerticalCheckCircumferenceCentralCheckEnabled=e.myVerticalCheckCircumferenceCentralCheckEnabled,this.myVerticalCheckCircumferenceRadialSteps=e.myVerticalCheckCircumferenceRadialSteps,this.myVerticalCheckCircumferenceRotationPerRadialStep=e.myVerticalCheckCircumferenceRotationPerRadialStep,this.myVerticalCheckFixedForwardEnabled=e.myVerticalCheckFixedForwardEnabled,this.myVerticalCheckFixedForward.vec3_copy(e.myVerticalCheckFixedForward),this.myVerticalMovementCheckEnabled=e.myVerticalMovementCheckEnabled,this.myVerticalMovementCheckReductionEnabled=e.myVerticalMovementCheckReductionEnabled,this.myVerticalMovementCheckPerformCheckOnBothSides=e.myVerticalMovementCheckPerformCheckOnBothSides,this.myVerticalPositionCheckEnabled=e.myVerticalPositionCheckEnabled,this.myVerticalCheckAllowHitsInsideCollisionIfOneValid=e.myVerticalCheckAllowHitsInsideCollisionIfOneValid,this.myVerticalCheckBlockLayerFlags.setMask(e.myVerticalCheckBlockLayerFlags.getMask()),this.myVerticalCheckObjectsToIgnore.pp_copy(e.myVerticalCheckObjectsToIgnore)};Ls.prototype.copy=function(e){this.myWallSlideEnabled=e.myWallSlideEnabled,this.myWallSlideMaxAttempts=e.myWallSlideMaxAttempts,this.myCheckBothWallSlideDirections=e.myCheckBothWallSlideDirections,this.myWallSlideFlickerPreventionMode=e.myWallSlideFlickerPreventionMode,this.myWallSlideFlickerPreventionCheckOnlyIfAlreadySliding=e.myWallSlideFlickerPreventionCheckOnlyIfAlreadySliding,this.myWallSlideFlickerPreventionForceCheckCounter=e.myWallSlideFlickerPreventionForceCheckCounter,this.my90DegreesWallSlideAdjustDirectionSign=e.my90DegreesWallSlideAdjustDirectionSign};$n.prototype.copy=function(e){this.mySurfaceSnapEnabled=e.mySurfaceSnapEnabled,this.mySurfaceSnapMaxDistance=e.mySurfaceSnapMaxDistance,this.mySurfacePopOutEnabled=e.mySurfacePopOutEnabled,this.mySurfacePopOutMaxDistance=e.mySurfacePopOutMaxDistance,this.mySurfaceAngleToIgnore=e.mySurfaceAngleToIgnore,this.mySurfaceAngleToIgnoreWithSurfacePerceivedAngle=e.mySurfaceAngleToIgnoreWithSurfacePerceivedAngle,this.myHorizontalMovementSurfaceAngleToIgnoreMaxVerticalDistance=e.myHorizontalMovementSurfaceAngleToIgnoreMaxVerticalDistance,this.myHorizontalPositionSurfaceAngleToIgnoreMaxVerticalDistance=e.myHorizontalPositionSurfaceAngleToIgnoreMaxVerticalDistance,this.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft=e.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft,this.myCollectSurfaceInfo=e.myCollectSurfaceInfo,this.myOnSurfaceMaxOutsideDistance=e.myOnSurfaceMaxOutsideDistance,this.myOnSurfaceMaxInsideDistance=e.myOnSurfaceMaxInsideDistance,this.myBaseInsideCollisionCheckEnabled=e.myBaseInsideCollisionCheckEnabled,this.myOnSurfaceIfBaseInsideCollision=e.myOnSurfaceIfBaseInsideCollision,this.myCollectSurfaceNormalMaxOutsideDistance=e.myCollectSurfaceNormalMaxOutsideDistance,this.myCollectSurfaceNormalMaxInsideDistance=e.myCollectSurfaceNormalMaxInsideDistance,this.myFindSurfaceDistanceMaxOutsideDistance=e.myFindSurfaceDistanceMaxOutsideDistance,this.myFindSurfaceDistanceMaxInsideDistance=e.myFindSurfaceDistanceMaxInsideDistance,this.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhill=e.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhill,this.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphill=e.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphill,this.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhillMaxSurfaceAngle=e.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhillMaxSurfaceAngle,this.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphillMaxSurfaceAngle=e.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphillMaxSurfaceAngle,this.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhillMaxSurfacePerceivedAngle=e.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhillMaxSurfacePerceivedAngle,this.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphillMaxSurfacePerceivedAngle=e.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphillMaxSurfacePerceivedAngle,this.myVerticalMovementAdjustHorizontalMovementOverSurfaceAngleDownhill=e.myVerticalMovementAdjustHorizontalMovementOverSurfaceAngleDownhill,this.myVerticalMovementAdjustHorizontalMovementOverSurfaceAngleDownhillMinSurfaceAngle=e.myVerticalMovementAdjustHorizontalMovementOverSurfaceAngleDownhillMinSurfaceAngle,this.myMovementMustStayOnSurface=e.myMovementMustStayOnSurface,this.myMovementMustStayOnSurfaceHitMaxAngle=e.myMovementMustStayOnSurfaceHitMaxAngle,this.myMovementMustStayOnIgnorableSurfaceAngleDownhill=e.myMovementMustStayOnIgnorableSurfaceAngleDownhill,this.myMovementMustStayOnSurfaceAngleDownhill=e.myMovementMustStayOnSurfaceAngleDownhill,this.myTeleportMustBeOnSurface=e.myTeleportMustBeOnSurface,this.myTeleportMustBeOnIgnorableSurfaceAngle=e.myTeleportMustBeOnIgnorableSurfaceAngle,this.myTeleportMustBeOnSurfaceAngle=e.myTeleportMustBeOnSurfaceAngle,this.myCheckTransformMustBeOnSurface=e.myCheckTransformMustBeOnSurface,this.myCheckTransformMustBeOnIgnorableSurfaceAngle=e.myCheckTransformMustBeOnIgnorableSurfaceAngle,this.myCheckTransformMustBeOnSurfaceAngle=e.myCheckTransformMustBeOnSurfaceAngle,this.myRecollectSurfaceInfoOnSurfaceCheckFailed=e.myRecollectSurfaceInfoOnSurfaceCheckFailed,this.myHorizontalMovementAllowExitAttemptWhenOnNotIgnorableSurfacePerceivedAngle=e.myHorizontalMovementAllowExitAttemptWhenOnNotIgnorableSurfacePerceivedAngle};Hs.prototype.copy=function(e){this.mySplitMovementEnabled=e.mySplitMovementEnabled,this.mySplitMovementMaxSteps=e.mySplitMovementMaxSteps,this.mySplitMovementMaxStepLength=e.mySplitMovementMaxStepLength,this.mySplitMovementMinStepLength=e.mySplitMovementMinStepLength,this.mySplitMovementStopOnHorizontalMovementFailed=e.mySplitMovementStopOnHorizontalMovementFailed,this.mySplitMovementStopOnVerticalMovementFailed=e.mySplitMovementStopOnVerticalMovementFailed,this.mySplitMovementStopReturnPreviousResults=e.mySplitMovementStopReturnPreviousResults};ks.prototype.copy=function(e){this.myPositionOffsetLocal.vec3_copy(e.myPositionOffsetLocal),this.myRotationOffsetLocalQuat.quat_copy(e.myRotationOffsetLocalQuat)};Fs.prototype.copy=function(e){this.myVisualDebugEnabled=e.myVisualDebugEnabled,this.myVisualDebugMovementEnabled=e.myVisualDebugMovementEnabled,this.myVisualDebugHorizontalMovementCheckEnabled=e.myVisualDebugHorizontalMovementCheckEnabled,this.myVisualDebugHorizontalPositionCheckEnabled=e.myVisualDebugHorizontalPositionCheckEnabled,this.myVisualDebugVerticalMovementCheckEnabled=e.myVisualDebugVerticalMovementCheckEnabled,this.myVisualDebugVerticalPositionCheckEnabled=e.myVisualDebugVerticalPositionCheckEnabled,this.myVisualDebugSlideEnabled=e.myVisualDebugSlideEnabled,this.myVisualDebugGroundInfoEnabled=e.myVisualDebugGroundInfoEnabled,this.myVisualDebugCeilingInfoEnabled=e.myVisualDebugCeilingInfoEnabled,this.myVisualDebugResultsEnabled=e.myVisualDebugResultsEnabled};var nn={VERY_LOW:0,LOW:1,MEDIUM:2,HIGH:3,VERY_HIGH:4},js=class{constructor(){this.myHeight=0,this.myRadius=0,this.myAccuracyLevel=nn.VERY_LOW,this.myIsPlayer=!1,this.myCheckOnlyFeet=!1,this.myMaxSpeed=0,this.myAverageFPS=72,this.myCanFly=!1,this.myShouldSlideAlongWall=!1,this.myCollectGroundInfo=!1,this.myShouldSnapOnGround=!1,this.myMaxDistanceToSnapOnGround=0,this.myMaxWalkableGroundAngle=0,this.myMaxWalkableGroundStepHeight=0,this.myShouldNotFallFromEdges=!1,this.myHorizontalCheckBlockLayerFlags=new Ve,this.myHorizontalCheckObjectsToIgnore=[],this.myVerticalCheckBlockLayerFlags=new Ve,this.myVerticalCheckObjectsToIgnore=[],this.myHorizontalCheckDebugEnabled=!1,this.myVerticalCheckDebugEnabled=!1}};function yb(i,e=new tn){return e.myHeight=i.myHeight,e.myHorizontalCheckParams.myHorizontalCheckConeRadius=i.myRadius,e.myVerticalCheckParams.myVerticalCheckCircumferenceRadius=i.myRadius/2,e.myVerticalCheckParams.myVerticalCheckFixedForwardEnabled=!0,e.myVerticalCheckParams.myVerticalCheckFixedForward.vec3_set(0,0,1),(!i.myCheckOnlyFeet||i.myCanFly)&&(e.myHorizontalCheckParams.myHorizontalHeightCheckEnabled=!0,e.myVerticalCheckParams.myVerticalPositionCheckEnabled=!0),e.myWallSlideParams.myWallSlideEnabled=i.myShouldSlideAlongWall,e.myHorizontalCheckParams.myHorizontalCheckFeetDistanceToIgnore=i.myMaxWalkableGroundStepHeight,e.myGroundParams.mySurfaceSnapMaxDistance=i.myMaxDistanceToSnapOnGround,e.myGroundParams.mySurfacePopOutMaxDistance=i.myMaxDistanceToSnapOnGround>0?i.myMaxDistanceToSnapOnGround:i.myRadius>.1?.1:.01,e.myGroundParams.mySurfacePopOutMaxDistance=Math.max(e.myGroundParams.mySurfacePopOutMaxDistance,e.myHorizontalCheckParams.myHorizontalCheckFeetDistanceToIgnore),e.myGroundParams.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft=i.myRadius*.75,e.myGroundParams.myCollectSurfaceInfo=i.myCollectGroundInfo||i.myMaxWalkableGroundAngle>0,e.myGroundParams.mySurfaceSnapEnabled=i.myShouldSnapOnGround,e.myGroundParams.mySurfacePopOutEnabled=!0,e.myGroundParams.mySurfaceAngleToIgnore=i.myMaxWalkableGroundAngle,e.myGroundParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngle=!0,e.myGroundParams.myOnSurfaceMaxOutsideDistance=.001,e.myGroundParams.myOnSurfaceMaxInsideDistance=.001,e.myGroundParams.myCollectSurfaceNormalMaxOutsideDistance=i.myRadius>.1?.1:.01,e.myGroundParams.myCollectSurfaceNormalMaxInsideDistance=e.myGroundParams.myCollectSurfaceNormalMaxOutsideDistance,e.myGroundParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhill=!0,e.myGroundParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphill=!0,i.myCanFly&&(e.myHorizontalCheckParams.myHorizontalCheckHeadDistanceToIgnore=e.myHorizontalCheckParams.myHorizontalCheckFeetDistanceToIgnore,e.myCeilingParams.myCollectSurfaceInfo=e.myGroundParams.myCollectSurfaceInfo,e.myCeilingParams.mySurfacePopOutEnabled=e.myGroundParams.mySurfacePopOutEnabled,e.myCeilingParams.mySurfaceAngleToIgnore=e.myGroundParams.mySurfaceAngleToIgnore,e.myCeilingParams.mySurfaceSnapMaxDistance=e.myGroundParams.mySurfaceSnapMaxDistance,e.myCeilingParams.mySurfacePopOutMaxDistance=e.myGroundParams.mySurfacePopOutMaxDistance,e.myCeilingParams.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft=e.myGroundParams.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft,e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngle=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngle,e.myCeilingParams.myOnSurfaceMaxOutsideDistance=e.myGroundParams.myOnSurfaceMaxOutsideDistance,e.myCeilingParams.myOnSurfaceMaxInsideDistance=e.myGroundParams.myOnSurfaceMaxInsideDistance,e.myCeilingParams.myCollectSurfaceNormalMaxOutsideDistance=e.myGroundParams.myCollectSurfaceNormalMaxOutsideDistance,e.myCeilingParams.myCollectSurfaceNormalMaxInsideDistance=e.myGroundParams.myCollectSurfaceNormalMaxInsideDistance,e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhill=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhill,e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphill=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphill),i.myShouldNotFallFromEdges&&(e.myGroundParams.myMovementMustStayOnSurface=!0,e.myGroundParams.myMovementMustStayOnSurfaceAngleDownhill=Math.max(60,e.myGroundParams.mySurfaceAngleToIgnore)),e.myHorizontalCheckParams.myHorizontalCheckBlockLayerFlags.copy(i.myHorizontalCheckBlockLayerFlags),e.myHorizontalCheckParams.myHorizontalCheckObjectsToIgnore.pp_copy(i.myHorizontalCheckObjectsToIgnore),e.myVerticalCheckParams.myVerticalCheckBlockLayerFlags.copy(i.myVerticalCheckBlockLayerFlags),e.myVerticalCheckParams.myVerticalCheckObjectsToIgnore.pp_copy(i.myVerticalCheckObjectsToIgnore),i.myHorizontalCheckDebugEnabled&&(e.myDebugParams.myVisualDebugEnabled=!0,e.myDebugParams.myVisualDebugHorizontalMovementCheckEnabled=!0,e.myDebugParams.myVisualDebugHorizontalPositionCheckEnabled=!0),i.myVerticalCheckDebugEnabled&&(e.myDebugParams.myVisualDebugEnabled=!0,e.myDebugParams.myVisualDebugVerticalMovementCheckEnabled=!0,e.myDebugParams.myVisualDebugVerticalPositionCheckEnabled=!0),i.myAccuracyLevel>=nn.VERY_LOW&&(e.myHorizontalCheckParams.myHorizontalCheckConeHalfAngle=60,e.myHorizontalCheckParams.myHorizontalMovementHeightVerticalCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalPositionHeightVerticalCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementCheckEnabled=!1,e.myHorizontalCheckParams.myHorizontalPositionCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalPositionCheckConeHalfSlices=1,e.myHorizontalCheckParams.myHorizontalPositionHeightCheckSteps=1,e.myHorizontalCheckParams.myHorizontalPositionHorizontalRadialCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalPositionVerticalStraightCheckEnabled=!0,e.myVerticalCheckParams.myVerticalCheckCircumferenceSlices=4,e.myVerticalCheckParams.myVerticalCheckCircumferenceCentralCheckEnabled=!0,e.myVerticalCheckParams.myVerticalCheckCircumferenceRadialSteps=1,e.myVerticalCheckParams.myVerticalMovementCheckEnabled=!0,e.myVerticalCheckParams.myVerticalMovementCheckReductionEnabled=!0,e.myVerticalCheckParams.myVerticalCheckAllowHitsInsideCollisionIfOneValid=!0,i.myIsPlayer&&(e.myWallSlideParams.myWallSlideMaxAttempts=2,e.myWallSlideParams.my90DegreesWallSlideAdjustDirectionSign=!0)),i.myAccuracyLevel>=nn.LOW&&(e.myHorizontalCheckParams.myHorizontalMovementCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementCheckRadialSteps=1,e.myHorizontalCheckParams.myHorizontalMovementHeightCheckSteps=1,e.myHorizontalCheckParams.myHorizontalMovementHorizontalStraightCentralCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=!0,e.myVerticalCheckParams.myVerticalCheckCircumferenceRadialSteps=2,e.myVerticalCheckParams.myVerticalCheckCircumferenceRotationPerRadialStep=180/e.myVerticalCheckParams.myVerticalCheckCircumferenceSlices,e.myWallSlideParams.myWallSlideMaxAttempts=2,e.myWallSlideParams.myCheckBothWallSlideDirections=!1,e.myWallSlideParams.myWallSlideFlickerPreventionMode=ws.NONE,e.myWallSlideParams.myWallSlideFlickerPreventionCheckOnlyIfAlreadySliding=!1,e.myWallSlideParams.myWallSlideFlickerPreventionForceCheckCounter=0,e.myWallSlideParams.my90DegreesWallSlideAdjustDirectionSign=!1),i.myAccuracyLevel>=nn.MEDIUM&&(e.myHorizontalCheckParams.myHorizontalMovementHeightHorizontalCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementHorizontalDiagonalOutwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalDiagonalOutwardUpwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalPositionCheckConeHalfSlices=2,e.myHorizontalCheckParams.myHorizontalPositionHeightHorizontalCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalPositionHorizontalBorderCheckEnabled=!0,e.myVerticalCheckParams.myVerticalMovementCheckPerformCheckOnBothSides=!0,e.myVerticalCheckParams.myVerticalCheckCircumferenceSlices=6,e.myVerticalCheckParams.myVerticalCheckCircumferenceRadialSteps=2,e.myVerticalCheckParams.myVerticalCheckCircumferenceRotationPerRadialStep=180/e.myVerticalCheckParams.myVerticalCheckCircumferenceSlices,e.myWallSlideParams.myWallSlideMaxAttempts=3,e.myWallSlideParams.my90DegreesWallSlideAdjustDirectionSign=!0,i.myIsPlayer&&(e.myWallSlideParams.myWallSlideFlickerPreventionMode=ws.USE_PREVIOUS_RESULTS,e.myWallSlideParams.myWallSlideFlickerPreventionCheckOnlyIfAlreadySliding=!0,e.myWallSlideParams.myWallSlideFlickerPreventionForceCheckCounter=4)),i.myAccuracyLevel>=nn.HIGH&&(e.myWallSlideParams.myWallSlideEnabled&&(e.myHorizontalCheckParams.myHorizontalMovementCheckGetBetterReferenceHit=!0,e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHit=!0,e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHitKeepVerticalHitIfNoHorizontalHit=!0),e.myHorizontalCheckParams.myHorizontalMovementHorizontalDiagonalInwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementHorizontalStraightCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementHorizontalStraightCentralCheckEnabled=!1,e.myHorizontalCheckParams.myHorizontalMovementVerticalDiagonalInwardUpwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalUpwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=!1,e.myVerticalCheckParams.myVerticalCheckCircumferenceSlices=8,e.myVerticalCheckParams.myVerticalCheckCircumferenceRadialSteps=2,e.myVerticalCheckParams.myVerticalCheckCircumferenceRotationPerRadialStep=180/e.myVerticalCheckParams.myVerticalCheckCircumferenceSlices,e.myWallSlideParams.myWallSlideMaxAttempts=4,i.myIsPlayer&&(e.myWallSlideParams.myCheckBothWallSlideDirections=!0),e.myGroundParams.myBaseInsideCollisionCheckEnabled=!0,e.myCeilingParams.myBaseInsideCollisionCheckEnabled=!0,i.myMaxSpeed/i.myAverageFPS>i.myRadius&&(e.mySplitMovementParams.mySplitMovementEnabled=!0,e.mySplitMovementParams.mySplitMovementMaxSteps=Math.ceil(i.myMaxSpeed/i.myAverageFPS/i.myRadius),e.mySplitMovementParams.mySplitMovementMinStepLength=i.myRadius*.75)),i.myAccuracyLevel>=nn.VERY_HIGH&&(e.myHorizontalCheckParams.myHorizontalMovementHeightCheckSteps=2,e.myHorizontalCheckParams.myHorizontalMovementHorizontalRadialCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalDiagonalOutwardDownwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalDiagonalInwardDownwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightCentralCheckEnabled=!1,e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalDownwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled=!1,e.myHorizontalCheckParams.myHorizontalPositionHeightCheckSteps=2,e.myHorizontalCheckParams.myHorizontalPositionVerticalRadialDiagonalOutwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalPositionVerticalBorderDiagonalOutwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHit=!0,e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHitKeepVerticalHitIfNoHorizontalHit=!0,e.myGroundParams.myRecollectSurfaceInfoOnSurfaceCheckFailed=!0,e.myCeilingParams.myRecollectSurfaceInfoOnSurfaceCheckFailed=e.myGroundParams.myRecollectSurfaceInfoOnSurfaceCheckFailed),e}function ub(i,e=new tn){return e.copy(i),e.myHorizontalCheckParams.myHorizontalCheckConeHalfAngle=180,e.myHorizontalCheckParams.myHorizontalPositionCheckConeHalfSlices=Math.round(e.myHorizontalCheckParams.myHorizontalCheckConeHalfAngle/i.myHorizontalCheckParams.myHorizontalCheckConeHalfAngle*i.myHorizontalCheckParams.myHorizontalPositionCheckConeHalfSlices),e.myHorizontalCheckParams.myHorizontalCheckFixedForwardEnabled=!0,e.myHorizontalCheckParams.myHorizontalCheckFixedForward.vec3_set(0,0,1),e}var rm={createSimplified:yb,createTeleportColliderSetupFromMovementColliderSetup:ub};var eo=class{constructor(e=m.getMainEngine()){this._myLastCheckRaycastsPerformed=0,this._myCurrentFrameRaycastsPerformed=0,this._myMaxFrameRaycastsPerformed=0,this.myEngine=e,Q.initBridge(this.myEngine)}update(e){this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),this._myCurrentFrameRaycastsPerformed=0,Q.getCollisionCheck(this.myEngine)._myTotalRaycasts=0}checkMovement(e,t,n,o,s=new Ue){Q.checkMovement(e,t,n,o,s,this.myEngine),this._myLastCheckRaycastsPerformed=Q.getCollisionCheck(this.myEngine)._myTotalRaycasts-this._myCurrentFrameRaycastsPerformed,this._myCurrentFrameRaycastsPerformed=Q.getCollisionCheck(this.myEngine)._myTotalRaycasts,this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),s.myDebugResults._myRaycastsPerformed=this._myLastCheckRaycastsPerformed}checkTeleportToPosition(e,t,n,o,s=new Ue){}checkTeleportToTransform(e,t,n,o,s=new Ue){Q.checkTeleportToTransform(e,t,n,o,s,this.myEngine),this._myLastCheckRaycastsPerformed=Q.getCollisionCheck(this.myEngine)._myTotalRaycasts-this._myCurrentFrameRaycastsPerformed,this._myCurrentFrameRaycastsPerformed=Q.getCollisionCheck(this.myEngine)._myTotalRaycasts,this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),s.myDebugResults._myRaycastsPerformed=this._myLastCheckRaycastsPerformed}checkTransform(e,t,n,o=new Ue){Q.checkTransform(e,t,n,o,this.myEngine),this._myLastCheckRaycastsPerformed=Q.getCollisionCheck(this.myEngine)._myTotalRaycasts-this._myCurrentFrameRaycastsPerformed,this._myCurrentFrameRaycastsPerformed=Q.getCollisionCheck(this.myEngine)._myTotalRaycasts,this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),o.myDebugResults._myRaycastsPerformed=this._myLastCheckRaycastsPerformed}updateSurfaceInfo(e,t,n,o=new Ue){let s=this._myCurrentFrameRaycastsPerformed;this.updateGroundInfo(e,t,n,o),this.updateCeilingInfo(e,t,n,o),this._myLastCheckRaycastsPerformed=Q.getCollisionCheck(this.myEngine)._myTotalRaycasts-s,this._myCurrentFrameRaycastsPerformed=Q.getCollisionCheck(this.myEngine)._myTotalRaycasts,this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),o.myDebugResults._myRaycastsPerformed=this._myLastCheckRaycastsPerformed}updateGroundInfo(e,t,n,o=new Ue){Q.updateGroundInfo(e,t,n,o,this.myEngine),this._myLastCheckRaycastsPerformed=Q.getCollisionCheck(this.myEngine)._myTotalRaycasts-this._myCurrentFrameRaycastsPerformed,this._myCurrentFrameRaycastsPerformed=Q.getCollisionCheck(this.myEngine)._myTotalRaycasts,this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),o.myDebugResults._myRaycastsPerformed=this._myLastCheckRaycastsPerformed}updateCeilingInfo(e,t,n,o=new Ue){Q.updateCeilingInfo(e,t,n,o,this.myEngine),this._myLastCheckRaycastsPerformed=Q.getCollisionCheck(this.myEngine)._myTotalRaycasts-this._myCurrentFrameRaycastsPerformed,this._myCurrentFrameRaycastsPerformed=Q.getCollisionCheck(this.myEngine)._myTotalRaycasts,this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),o.myDebugResults._myRaycastsPerformed=this._myLastCheckRaycastsPerformed}};eo.prototype.checkTeleportToPosition=function(){let i=G();return function(t,n,o,s,a){i.quat2_copy(n),i.quat2_setPosition(t),this.checkTeleportToTransform(i,n,o,s,a)}}();import{Component as IR}from"@wonderlandengine/api";var Oo=class extends IR{static TypeName="pp-character-collision-system";static Properties={};init(){this._myCharacterCollisionSystem=null,m.hasCharacterCollisionSystem(this.engine)||(this._myCharacterCollisionSystem=new eo(this.engine),m.setCharacterCollisionSystem(this._myCharacterCollisionSystem,this.engine))}update(e){this._myCharacterCollisionSystem!=null&&this._myCharacterCollisionSystem.update(e)}onDestroy(){this._myCharacterCollisionSystem!=null&&m.getCharacterCollisionSystem(this.engine)==this._myCharacterCollisionSystem&&m.removeCharacterCollisionSystem(this.engine)}};var to=class{constructor(e=m.getMainEngine()){this.mySessionChangeResyncEnabled=!1,this.myBlurEndResyncEnabled=!1,this.myBlurEndResyncRotation=!1,this.myResetTransformOnViewResetEnabled=!0,this.myNextEnterSessionResyncHeight=!1,this.myEnterSessionResyncHeight=!1,this.myExitSessionResyncHeight=!1,this.myExitSessionResyncVerticalAngle=!1,this.myExitSessionRemoveRightTilt=!1,this.myExitSessionAdjustMaxVerticalAngle=!1,this.myExitSessionMaxVerticalAngle=0,this.myHeightOffsetVRWithFloor=null,this.myHeightOffsetVRWithoutFloor=null,this.myHeightOffsetNonVR=null,this.myNextEnterSessionFloorHeight=null,this.myEnterSessionFloorHeight=null,this.myRotateFeetKeepUp=!1,this.myForeheadExtraHeight=0,this.myEngine=e,this.myDebugEnabled=!1}},se=class{constructor(e=new to){this._myParams=e,this._myCurrentHead=m.getPlayerObjects(this._myParams.myEngine).myHead,this._mySessionChangeResyncHeadTransform=null,this._myBlurRecoverHeadTransform=null,this._myCurrentHeadTransformLocalQuat=G(),this._myDelaySessionChangeResyncCounter=0,this._myDelayBlurEndResyncCounter=0,this._myDelayBlurEndResyncTimer=new te(5,!1),this._myVisibilityHidden=!1,this._mySessionActive=!1,this._mySessionBlurred=!1,this._myIsSyncedDelayCounter=0,this._myViewResetEventListener=null,this._myActive=!0,this._myDestroyed=!1,this._myResyncCounterFrames=3,this._myIsSyncedDelayCounterFrames=1}start(){this._updateHeightOffset(),O.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!0,this._myParams.myEngine)}setActive(e){this._myActive=e}getParams(){return this._myParams}paramsUpdated(){this._updateHeightOffset()}getPlayer(){return m.getPlayerObjects(this._myParams.myEngine).myPlayer}getHead(){return this._myCurrentHead}getHeightHead(){return this.getHeightEyes()+this._myParams.myForeheadExtraHeight}getHeightEyes(){}getTransformFeetQuat(e=G()){}getTransformHeadQuat(e=G()){return this.getHead().pp_getTransformQuat(e)}getPositionFeet(e=p()){}getPositionHead(e=p()){return this._myCurrentHead.pp_getPosition(e)}getRotationFeetQuat(e=w()){}getRotationHeadQuat(e=w()){return this.getHead().pp_getRotationQuat(e)}isSynced(){return this._myIsSyncedDelayCounter==0&&this._myDelaySessionChangeResyncCounter==0&&this._myDelayBlurEndResyncCounter==0&&!this._myDelayBlurEndResyncTimer.isRunning()&&!this._mySessionBlurred}setHeightHead(e,t=!1){if((!t||!this._mySessionActive)&&(this._myParams.myHeightOffsetNonVR=e),!t||this._mySessionActive){this._myParams.myHeightOffsetVRWithoutFloor=e,this._myParams.myHeightOffsetVRWithFloor==null&&(this._myParams.myHeightOffsetVRWithFloor=0);let n=O.isReferenceSpaceFloorBased(this._myParams.myEngine)||O.isDeviceEmulated();this._mySessionActive&&n?this._myParams.myHeightOffsetVRWithFloor=this._myParams.myHeightOffsetVRWithFloor+(e-this.getHeightHead()):this._mySessionActive||(this._myParams.myNextEnterSessionFloorHeight=e)}this._updateHeightOffset()}moveFeet(e){}moveHead(e){this.moveFeet(e)}teleportPositionHead(e){}teleportPositionFeet(e){}teleportPlayerToHeadTransformQuat(e){}rotateFeetQuat(e,t=null){}rotateHeadQuat(e){}canRotateFeet(){return!0}canRotateHead(){return!this._mySessionActive}setRotationFeetQuat(e,t=null){}setRotationHeadQuat(){}lookAtFeet(e,t=null,n=null){}lookToFeet(e,t=null,n=null){}lookAtHead(e,t=null){}lookToHead(e,t=null){}update(e){this._myIsSyncedDelayCounter!=0&&(this._myIsSyncedDelayCounter--,this._myIsSyncedDelayCounter=Math.max(0,this._myIsSyncedDelayCounter)),this._myDelaySessionChangeResyncCounter>0&&(this._myDelaySessionChangeResyncCounter--,this._myDelaySessionChangeResyncCounter==0&&(this._sessionChangeResync(),this._myIsSyncedDelayCounter=this._myIsSyncedDelayCounterFrames)),this._myDelayBlurEndResyncCounter>0&&!this._myDelayBlurEndResyncTimer.isRunning()&&(this._myDelayBlurEndResyncCounter--,this._myDelayBlurEndResyncCounter==0&&(this._blurEndResync(),this._myIsSyncedDelayCounter=this._myIsSyncedDelayCounterFrames)),this._myDelayBlurEndResyncTimer.isRunning()&&(this._myDelayBlurEndResyncCounter>0?this._myDelayBlurEndResyncCounter--:(this._myDelayBlurEndResyncTimer.update(e),this._myDelayBlurEndResyncTimer.isDone()&&(this._blurEndResync(),this._myIsSyncedDelayCounter=this._myIsSyncedDelayCounterFrames))),this.isSynced()&&this._myCurrentHead.pp_getTransformLocalQuat(this._myCurrentHeadTransformLocalQuat),this._myParams.myDebugEnabled&&m.isDebugEnabled(this._myParams.myEngine)&&this._debugUpdate(e)}_debugUpdate(e){m.getDebugVisualManager(this._myParams.myEngine).drawLineEnd(0,this.getPositionFeet(),this.getPositionHead(),F(1,0,0,1),.01),console.error(this.getHeightEyes())}destroy(){this._myDestroyed=!0,O.getReferenceSpace(this._myParams.myEngine)?.removeEventListener?.("reset",this._myViewResetEventListener),O.getSession(this._myParams.myEngine)?.removeEventListener("visibilitychange",this._myVisibilityChangeEventListener),O.unregisterSessionStartEndEventListeners(this,this._myParams.myEngine)}isDestroyed(){return this._myDestroyed}};se.prototype.getHeightEyes=function(){let i=p();return function(){return i=this._myCurrentHead.pp_getPosition(i),this._getPositionHeight(i)}}();se.prototype.getTransformFeetQuat=function(){let i=p(),e=w();return function(n=G()){return n.quat2_setPositionRotationQuat(this.getPositionFeet(i),this.getRotationFeetQuat(e)),n}}();se.prototype.getRotationFeetQuat=function(){let i=p(),e=p();return function(n=w()){i=m.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(i),e=this._myCurrentHead.pp_getForward(e);let o=e.vec3_angle(i),s=10;return o<s?e=this._myCurrentHead.pp_getDown(e):o>180-s&&(e=this._myCurrentHead.pp_getUp(e)),e=e.vec3_removeComponentAlongAxis(i,e),e.vec3_normalize(e),n.quat_setUp(i,e),n}}();se.prototype.getPositionFeet=function(){let i=p(),e=p();return function(n=p()){i=this._myCurrentHead.pp_getPosition(i);let o=this._getPositionHeight(i);return e=m.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(e),n=i.vec3_sub(e.vec3_scale(o,n),n),n}}();se.prototype.moveFeet=function(e){m.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_translate(e)};se.prototype.rotateFeetQuat=function(){let i=p(),e=p(),t=p(),n=w(),o=w(),s=w(),a=p(),l=w(),h=p(),_=p();return function(r,u=null){r.quat_getAngleRadians()<=1e-5||(t=this._myCurrentHead.pp_getPosition(t),i=m.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(i),e=r.quat_getAxis(e),!e.vec3_isOnAxis(i)&&(u==null&&this._myParams.myFeetRotationKeepUp||u)?(n=this.getRotationFeetQuat(n),o=n.quat_rotateQuat(r,o),a=o.quat_getForward(a),s.quat_copy(o),s.quat_setUp(i,a),l=n.quat_rotationToQuat(s,l)):l.quat_copy(r),m.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_rotateAroundQuat(l,t),h=this._myCurrentHead.pp_getPosition(h),_=t.vec3_sub(h,_),_.vec3_length()>1e-5&&this.moveFeet(_))}}();se.prototype.rotateHeadQuat=function(){let i=w(),e=p();return function(n){this.canRotateHead()&&(this._myCurrentHead.pp_rotateQuat(n),i=this._myCurrentHead.pp_getRotationQuat(i),m.getPlayerObjects(this._myParams.myEngine).myHead.pp_setRotationQuat(i),i=i.quat_rotateAxisRadians(Math.PI,i.quat_getUp(e),i),m.getPlayerObjects(this._myParams.myEngine).myCameraNonXR.pp_setRotationQuat(i))}}();se.prototype.setRotationFeetQuat=function(){let i=w(),e=w();return function(n,o=null){i=this.getRotationFeetQuat(i),e=i.quat_rotationToQuat(n,e),this.rotateFeetQuat(e,o)}}();se.prototype.setRotationHeadQuat=function(){let i=w(),e=w();return function(n){i=this.getRotationHeadQuat(i),e=i.quat_rotationToQuat(n,e),this.rotateHeadQuat(e)}}();se.prototype.teleportPositionHead=function(){let i=p(),e=p();return function(n){i=this._myCurrentHead.pp_getPosition(i),e=n.vec3_sub(i,e),this.moveFeet(e)}}();se.prototype.teleportPositionFeet=function(){let i=p(),e=p();return function(n){i=this.getPositionFeet(i),e=n.vec3_sub(i,e),this.moveFeet(e)}}();se.prototype.teleportPlayerToHeadTransformQuat=function(){let i=p(),e=p(),t=p(),n=p(),o=p(),s=p(),a=p(),l=w();return function(_){i=_.quat2_getPosition(i),e=m.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(e),t=m.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getPosition(t).vec3_removeComponentAlongAxis(e,t),n=i.vec3_removeComponentAlongAxis(e,n),o=n.vec3_sub(t,o),m.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_translate(o),s=m.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getForward(s),a=_.quat2_getForward(a),l=s.vec3_rotationToPivotedQuat(a,e,l),m.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_rotateQuat(l)}}();se.prototype.lookAtFeet=function(){let i=p(),e=p();return function(n,o=null,s=null){e=this.getPositionFeet(e),i=n.vec3_sub(e,i).vec3_normalize(i),this.lookToFeet(i,o,s)}}();se.prototype.lookToFeet=function(){let i=w();return function(t,n=null,o=null){i=this.getRotationFeetQuat(i),i.quat_setForward(t,n),this.setRotationFeetQuat(i,o)}}();se.prototype.lookAtHead=function(){let i=p(),e=p();return function(n,o=null){e=this.getPositionHead(e),i=n.vec3_sub(e,i).vec3_normalize(i),this.lookToHead(i,o)}}();se.prototype.lookToHead=function(){let i=w();return function(t,n=null){i=this.getRotationHeadQuat(i),i.quat_setForward(t,n),this.setRotationHeadQuat(i)}}();se.prototype._getPositionHeight=function(){let i=p(),e=p(),t=p();return function(o){i=m.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getPosition(i),e=m.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(e),t=o.vec3_sub(i,t).vec3_componentAlongAxis(e,t);let s=t.vec3_length();return e.vec3_isConcordant(t)||(s=-s),s}}();se.prototype._onXRSessionStart=function(){return function(e,t){this._myBlurRecoverHeadTransform=null,this._myVisibilityHidden=!1,this._myDelaySessionChangeResyncCounter=0,this._myDelayBlurEndResyncCounter=0,this._myDelayBlurEndResyncTimer.reset();let n=O.getReferenceSpace(this._myParams.myEngine);n.addEventListener!=null&&(this._myViewResetEventListener=this._onViewReset.bind(this),n.addEventListener("reset",this._myViewResetEventListener)),this._myVisibilityChangeEventListener=function(o){o.session.visibilityState!="visible"?(this._mySessionBlurred||this._onXRSessionBlurStart(o.session),this._myVisibilityHidden=t.visibilityState=="hidden"):(this._mySessionBlurred&&this._onXRSessionBlurEnd(o.session),this._myVisibilityHidden=!1)}.bind(this),t.addEventListener("visibilitychange",this._myVisibilityChangeEventListener),this._myParams.mySessionChangeResyncEnabled&&!e&&this._myActive?(this._myDelaySessionChangeResyncCounter==0&&(this._mySessionChangeResyncHeadTransform=this._getHeadTransformFromLocal(this._myCurrentHeadTransformLocalQuat)),this._myDelaySessionChangeResyncCounter=this._myResyncCounterFrames):(this._myDelaySessionChangeResyncCounter=0,this._mySessionChangeResyncHeadTransform=null),this._mySessionActive=!0,this._mySessionBlurred=!1,this._myActive&&this._updateHeightOffset()}}();se.prototype._onXRSessionEnd=function(){return function(e){if(this._myParams.mySessionChangeResyncEnabled&&this._myActive){if(this._myDelaySessionChangeResyncCounter==0){let t=this._getHeadTransformFromLocal(this._myCurrentHeadTransformLocalQuat);this._myBlurRecoverHeadTransform!=null&&(t=this._myBlurRecoverHeadTransform),this._mySessionChangeResyncHeadTransform=t}this._myDelaySessionChangeResyncCounter=this._myResyncCounterFrames}else this._myDelaySessionChangeResyncCounter=0,this._mySessionChangeResyncHeadTransform=null;this._myVisibilityChangeEventListener=null,this._myViewResetEventListener=null,this._myBlurRecoverHeadTransform=null,this._myVisibilityHidden=!1,this._myDelayBlurEndResyncCounter=0,this._myDelayBlurEndResyncTimer.reset(),this._mySessionActive=!1,this._mySessionBlurred=!1,this._myActive&&this._updateHeightOffset()}}();se.prototype._onXRSessionBlurStart=function(){return function(e){this._myActive&&(this._myParams.myBlurEndResyncEnabled&&this._myBlurRecoverHeadTransform==null&&this._mySessionActive?this._myDelaySessionChangeResyncCounter>0?this._myBlurRecoverHeadTransform=this._mySessionChangeResyncHeadTransform:this._myBlurRecoverHeadTransform=this._getHeadTransformFromLocal(this._myCurrentHeadTransformLocalQuat):(!this._mySessionActive||!this._myParams.myBlurEndResyncEnabled)&&(this._myBlurRecoverHeadTransform=null)),this._myDelayBlurEndResyncCounter=0,this._mySessionBlurred=!0}}();se.prototype._onXRSessionBlurEnd=function(){return function(e){this._myActive&&(this._myDelaySessionChangeResyncCounter==0?this._myParams.myBlurEndResyncEnabled&&this._myBlurRecoverHeadTransform!=null&&this._mySessionActive?(this._myDelayBlurEndResyncCounter=this._myResyncCounterFrames,this._myVisibilityHidden):(this._myBlurRecoverHeadTransform=null,this._myDelayBlurEndResyncCounter=0):(this._myDelaySessionChangeResyncCounter=this._myResyncCounterFrames,this._myBlurRecoverHeadTransform=null)),this._mySessionBlurred=!1}}();se.prototype._onViewReset=function(){return function(){this._myActive&&this._myParams.myResetTransformOnViewResetEnabled&&this._mySessionActive&&this.isSynced()&&this.teleportPlayerToHeadTransformQuat(this._getHeadTransformFromLocal(this._myCurrentHeadTransformLocalQuat))}}();se.prototype._blurEndResync=function(){let i=p(),e=p(),t=p(),n=p(),o=p(),s=p(),a=p(),l=p(),h=w();return function(){this._myBlurRecoverHeadTransform!=null&&(this._mySessionChangeResyncHeadTransform!=null?(this._myBlurRecoverHeadTransform=null,this._sessionChangeResync()):(i=m.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(i),e=this._myCurrentHead.pp_getPosition(e),t=this._myBlurRecoverHeadTransform.quat2_getPosition(t),n=e.vec3_removeComponentAlongAxis(i,n),o=t.vec3_removeComponentAlongAxis(i,o),s=o.vec3_sub(n,s),this.moveFeet(s),a=this._myBlurRecoverHeadTransform.quat2_getForward(a),l=this._myCurrentHead.pp_getForward(l),h=l.vec3_rotationToPivotedQuat(a,i,h),this._myParams.myBlurEndResyncRotation&&this.rotateFeetQuat(h),this._myBlurRecoverHeadTransform=null))}}();se.prototype._sessionChangeResync=function(){let i=p(),e=p(),t=w(),n=p(),o=p(),s=p(),a=p(),l=p(),h=p(),_=p(),y=p(),r=p(),u=p(),g=p(),P=p(),C=p(),f=w();return function(){if(this._myBlurRecoverHeadTransform==null&&this._mySessionChangeResyncHeadTransform!=null){if(this._mySessionActive){i=this._myCurrentHead.pp_getPosition(i),e=this._mySessionChangeResyncHeadTransform.quat2_getPosition(e),t=this._mySessionChangeResyncHeadTransform.quat2_getRotationQuat(t),n=m.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(n),o=i.vec3_removeComponentAlongAxis(n,o),s=e.vec3_removeComponentAlongAxis(n,s),a=s.vec3_sub(o,a),this.moveFeet(a);let M=O.isReferenceSpaceFloorBased(this._myParams.myEngine)||O.isDeviceEmulated();if(this._myParams.myEnterSessionResyncHeight||this._myParams.myNextEnterSessionResyncHeight){this._myParams.myNextEnterSessionResyncHeight=!1;let D=this._getPositionHeight(e),v=this._getPositionHeight(i);this._myParams.myHeightOffsetVRWithoutFloor=D+this._myParams.myForeheadExtraHeight,this._myParams.myHeightOffsetVRWithFloor==null&&(this._myParams.myHeightOffsetVRWithFloor=0),this._myParams.myHeightOffsetVRWithFloor=this._myParams.myHeightOffsetVRWithFloor+(D-v),this._updateHeightOffset()}else if(M&&(this._myParams.myNextEnterSessionFloorHeight!=null||this._myParams.myEnterSessionFloorHeight!=null)){let D=this._myParams.myNextEnterSessionFloorHeight!=null?this._myParams.myNextEnterSessionFloorHeight:this._myParams.myEnterSessionFloorHeight;D-=this._myParams.myForeheadExtraHeight;let v=this._getPositionHeight(i);this._myParams.myHeightOffsetVRWithFloor==null&&(this._myParams.myHeightOffsetVRWithFloor=0),this._myParams.myHeightOffsetVRWithFloor=this._myParams.myHeightOffsetVRWithFloor+(D-v),this._updateHeightOffset()}this._resyncHeadRotationForward(t)}else{if(n=m.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(n),e=this._mySessionChangeResyncHeadTransform.quat2_getPosition(e),s=e.vec3_removeComponentAlongAxis(n,s),y=m.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getPosition(y),r=s.vec3_add(y.vec3_componentAlongAxis(n,r),r),m.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_setPosition(r),m.getPlayerObjects(this._myParams.myEngine).myCameraNonXR.pp_resetPositionLocal(),this._myParams.myExitSessionResyncHeight){let M=this._getPositionHeight(e);this._myParams.myHeightOffsetNonVR=M+this._myParams.myForeheadExtraHeight,this._updateHeightOffset()}if(t=this._mySessionChangeResyncHeadTransform.quat2_getRotationQuat(t),this._myParams.myExitSessionRemoveRightTilt||this._myParams.myExitSessionAdjustMaxVerticalAngle||!this._myParams.myExitSessionResyncVerticalAngle){if(l=t.quat_getForward(l),h=t.quat_getUp(h),u=l.vec3_cross(n,u),u.vec3_normalize(u),!h.vec3_isConcordant(n)){let M=l.vec3_angle(n),D=45;(M>180-D||M<D)&&u.vec3_negate(u)}u.vec3_isZero(1e-6)&&(u=t.quat_getRight(u)),P=u.vec3_cross(l,P),P.vec3_normalize(P),C=P.vec3_cross(u,C),C.vec3_normalize(C),f.quat_fromAxes(u.vec3_negate(g),P,C),t.quat_copy(f)}if(this._myParams.myExitSessionAdjustMaxVerticalAngle||!this._myParams.myExitSessionResyncVerticalAngle){h=t.quat_getUp(h),_=t.quat_getRight(_);let M=Math.max(0,this._myParams.myExitSessionMaxVerticalAngle-1e-4);this._myParams.myExitSessionResyncVerticalAngle||(M=0);let D=Math.pp_angleClamp(h.vec3_angleSigned(n,_));if(Math.abs(D)>M){let v=(Math.abs(D)-M)*Math.pp_sign(D);t=t.quat_rotateAxis(v,_,t)}}this.setRotationHeadQuat(t)}this._mySessionActive&&(this._myParams.myNextEnterSessionFloorHeight=null,this._myFirstEnterSessionResyncDone=!0),this._mySessionChangeResyncHeadTransform=null}}}();se.prototype._resyncHeadRotationForward=function(){let i=p(),e=p(),t=p(),n=w();return function(s){i=m.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(i),e=s.quat_getForward(e),t=s.quat_getUp(t),n.quat_copy(s),n.quat_setUp(i,e),t.vec3_isConcordant(i)||n.quat_rotateAxis(180,i,n),this.setRotationFeetQuat(n)}}();se.prototype._updateHeightOffset=function(){return function(){this._mySessionActive?O.isDeviceEmulated()?this._setReferenceSpaceHeightOffset(0,0):O.isReferenceSpaceFloorBased(this._myParams.myEngine)?this._setReferenceSpaceHeightOffset(this._myParams.myHeightOffsetVRWithFloor,0):this._setReferenceSpaceHeightOffset(this._myParams.myHeightOffsetVRWithoutFloor,this._myParams.myForeheadExtraHeight):this._setReferenceSpaceHeightOffset(this._myParams.myHeightOffsetNonVR,this._myParams.myForeheadExtraHeight)}}();se.prototype._setReferenceSpaceHeightOffset=function(){let i=p();return function(t,n){t!=null&&(i=m.getPlayerObjects(this._myParams.myEngine).myReferenceSpace.pp_getPositionLocal(i),m.getPlayerObjects(this._myParams.myEngine).myReferenceSpace.pp_setPositionLocal([i[0],t-n,i[2]]))}}();se.prototype._getHeadTransformFromLocal=function(){return function(e){return this._myCurrentHead.pp_convertTransformLocalToWorldQuat(e)}}();Object.defineProperty(se.prototype,"_getPositionHeight",{enumerable:!1});Object.defineProperty(se.prototype,"_onXRSessionStart",{enumerable:!1});Object.defineProperty(se.prototype,"_onXRSessionEnd",{enumerable:!1});Object.defineProperty(se.prototype,"_onXRSessionBlurStart",{enumerable:!1});Object.defineProperty(se.prototype,"_onXRSessionBlurEnd",{enumerable:!1});Object.defineProperty(se.prototype,"_onViewReset",{enumerable:!1});Object.defineProperty(se.prototype,"_blurEndResync",{enumerable:!1});Object.defineProperty(se.prototype,"_sessionChangeResync",{enumerable:!1});Object.defineProperty(se.prototype,"_setReferenceSpaceHeightOffset",{enumerable:!1});var ce={BODY_COLLIDING:0,HEAD_COLLIDING:1,FAR:2,FLOATING:3},zs=class{constructor(e=m.getMainEngine()){this.myPlayerHeadManager=null,this.myMovementCollisionCheckParams=null,this.myTeleportCollisionCheckParams=null,this.myTeleportCollisionCheckParamsCopyFromMovement=!1,this.myTeleportCollisionCheckParamsCheck360=!1,this.myAlwaysSyncPositionWithReal=!1,this.myAlwaysSyncHeadPositionWithReal=!1,this.mySyncEnabledFlagMap=new Map,this.mySyncEnabledFlagMap.set(ce.BODY_COLLIDING,!0),this.mySyncEnabledFlagMap.set(ce.HEAD_COLLIDING,!0),this.mySyncEnabledFlagMap.set(ce.FAR,!0),this.mySyncEnabledFlagMap.set(ce.FLOATING,!0),this.mySyncPositionFlagMap=new Map,this.mySyncPositionFlagMap.set(ce.BODY_COLLIDING,!0),this.mySyncPositionFlagMap.set(ce.HEAD_COLLIDING,!1),this.mySyncPositionFlagMap.set(ce.FAR,!0),this.mySyncPositionFlagMap.set(ce.FLOATING,!0),this.mySyncPositionHeadFlagMap=new Map,this.mySyncPositionHeadFlagMap.set(ce.BODY_COLLIDING,!1),this.mySyncPositionHeadFlagMap.set(ce.HEAD_COLLIDING,!0),this.mySyncPositionHeadFlagMap.set(ce.FAR,!1),this.mySyncPositionHeadFlagMap.set(ce.FLOATING,!1),this.mySyncRotationFlagMap=new Map,this.mySyncRotationFlagMap.set(ce.BODY_COLLIDING,!1),this.mySyncRotationFlagMap.set(ce.HEAD_COLLIDING,!1),this.mySyncRotationFlagMap.set(ce.FAR,!1),this.mySyncRotationFlagMap.set(ce.FLOATING,!1),this.mySyncHeightFlagMap=new Map,this.mySyncHeightFlagMap.set(ce.BODY_COLLIDING,!1),this.mySyncHeightFlagMap.set(ce.HEAD_COLLIDING,!1),this.mySyncHeightFlagMap.set(ce.FAR,!1),this.mySyncHeightFlagMap.set(ce.FLOATING,!1),this.myIsLeaningValidAboveDistance=!1,this.myLeaningValidDistance=0,this.myIsFloatingValidIfVerticalMovement=!1,this.myIsFloatingValidIfVerticalMovementAndRealOnGround=!1,this.myIsFloatingValidIfRealOnGround=!1,this.myIsFloatingValidIfSteepGround=!1,this.myIsFloatingValidIfVerticalMovementAndSteepGround=!1,this.myFloatingSplitCheckEnabled=!1,this.myFloatingSplitCheckMaxLength=0,this.myFloatingSplitCheckMaxSteps=null,this.myFloatingSplitCheckStepEqualLength=!1,this.myFloatingSplitCheckStepEqualLengthMinLength=0,this.myMaxDistanceFromRealToSyncEnabled=!1,this.myMaxDistanceFromRealToSync=0,this.myHeadRadius=0,this.myHeadCollisionBlockLayerFlags=new Ve,this.myHeadCollisionObjectsToIgnore=[],this.myRotateOnlyIfSynced=!1,this.myResetRealResetRotationIfUpChanged=!0,this.myRealMovementAllowVerticalAdjustments=!1,this.myUpdateRealPositionValid=!1,this.myUpdatePositionValid=!1,this.myMinHeight=null,this.myMaxHeight=null,this.myIsBodyCollidingWhenHeightBelowValue=null,this.myIsBodyCollidingWhenHeightAboveValue=null,this.myIsBodyCollidingExtraCheckCallback=null,this.myIsLeaningExtraCheckCallback=null,this.myIsHoppingExtraCheckCallback=null,this.myIsFarExtraCheckCallback=null,this.myResetToValidOnEnterSession=!1,this.myResetToValidOnExitSession=!1,this.myAlwaysResetRealPositionNonVR=!1,this.myAlwaysResetRealRotationNonVR=!1,this.myAlwaysResetRealHeightNonVR=!1,this.myAlwaysResetRealPositionVR=!1,this.myAlwaysResetRealRotationVR=!1,this.myAlwaysResetRealHeightVR=!1,this.myNeverResetRealPositionNonVR=!1,this.myNeverResetRealRotationNonVR=!1,this.myNeverResetRealHeightNonVR=!1,this.myNeverResetRealPositionVR=!1,this.myNeverResetRealRotationVR=!1,this.myNeverResetRealHeightVR=!1,this.myResetRealOnMove=!1,this.myResetRealOnTeleport=!1,this.mySyncPositionDisabled=!1,this.myEngine=e,this.myDebugEnabled=!1}destroy(){this._myDestroyed=!0,O.unregisterSessionStartEndEventListeners(this,this._myParams.myEngine)}isDestroyed(){return this._myDestroyed}},tt=class{constructor(e){this._myParams=e,this._myRealMovementCollisionCheckParams=null,this._generateRealMovementParamsFromMovementParams(),this._myCollisionRuntimeParams=new de,this._myRealCollisionRuntimeParams=new de,this._myParams.myTeleportCollisionCheckParamsCopyFromMovement&&this._generateTeleportParamsFromMovementParams(),this._myHeadCollisionCheckParams=null,this._setupHeadCollisionCheckParams(),this._myValidPosition=p(),this._myValidRotationQuat=w(),this._myValidHeight=0,this._myValidPositionHead=p(),this._myIsBodyColliding=!1,this._myIsHeadColliding=!1,this._myIsLeaning=!1,this._myIsHopping=!1,this._myIsFar=!1,this._myLastValidMovementDirection=p(),this._myIsRealPositionValid=!1,this._myIsPositionValid=!1,this._myResetRealOnSynced=!1,this._myActive=!0,this._myDestroyed=!1}start(){this.resetToReal(!0),O.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this._myParams.myEngine)}getParams(){return this._myParams}setActive(e){this._myActive=e}update(e){}move(e,t=null,n=!1){}teleportPosition(e,t=null,n=!1){}teleportPositionRotationQuat(e,t,n=null,o=!1){}teleportTransformQuat(e,t=null,n=!1){}forceTeleportAndReset(e,t){this.teleportPositionRotationQuat(e,t,null,!0),this.resetReal(!0,!0)}rotateQuat(e){}setRotationQuat(e){}setHeight(e,t=!1){}getPlayer(){return this._myParams.myPlayerHeadManager.getPlayer()}getHead(){return this._myParams.myPlayerHeadManager.getHead()}getTransformQuat(e=G()){return e.quat2_setPositionRotationQuat(this.getPosition(this._myValidPosition),this.getRotationQuat(this._myValidRotationQuat))}getPosition(e=p()){return e.vec3_copy(this._myValidPosition)}getRotationQuat(e=w()){return e.quat_copy(this._myValidRotationQuat)}getPositionHead(e=p()){return e.vec3_copy(this._myValidPositionHead)}getTransformHeadQuat(e=G()){return e.quat2_setPositionRotationQuat(this.getPositionHead(this._myValidPositionHead),this.getRotationQuat(this._myValidRotationQuat))}getHeight(){return this._myValidHeight}getTransformRealQuat(e=G()){return this.getPlayerHeadManager().getTransformFeetQuat(e)}getTransformHeadRealQuat(e=G()){return this.getPlayerHeadManager().getTransformHeadQuat(e)}getPositionReal(e=p()){return this.getPlayerHeadManager().getPositionFeet(e)}getPositionHeadReal(e=p()){return this.getPlayerHeadManager().getPositionHead(e)}getRotationRealQuat(e=w()){return this.getPlayerHeadManager().getRotationFeetQuat(e)}getHeightReal(){return this._myParams.myPlayerHeadManager.getHeightHead()}isSynced(e=null){let t=this.isBodyColliding()&&(e==null||e.get(ce.BODY_COLLIDING)),n=this.isHeadColliding()&&(e==null||e.get(ce.HEAD_COLLIDING)),o=this.isFar()&&(e==null||e.get(ce.FAR)),s=this.isFloating()&&(e==null||e.get(ce.FLOATING));return!t&&!n&&!o&&!s}resetReal(e=!0,t=!1,n=!1,o=!0,s=!1){}updateReal(){this._updateReal(0)}resetToReal(e=!1,t=!1){e?this._myValidPosition=this.getPlayerHeadManager().getPlayer().pp_getPosition(this._myValidPosition):this._myValidPosition=this.getPositionReal(this._myValidPosition),this._myParams.myAlwaysSyncPositionWithReal||(this._myValidPositionHead=this.getPositionHeadReal(this._myValidPositionHead)),e?this._myValidRotationQuat=this.getPlayerHeadManager().getPlayer().pp_getRotationQuat(this._myValidRotationQuat):this._myValidRotationQuat=this.getRotationRealQuat(this._myValidRotationQuat),this._myValidHeight=Math.pp_clamp(this.getHeightReal(),this._myParams.myMinHeight,this._myParams.myMaxHeight),t&&this._updateReal(0)}resetHeadToReal(){this._myParams.myAlwaysSyncPositionWithReal||(this._myValidPositionHead=this.getPositionHeadReal(this._myValidPositionHead))}isBodyColliding(){return this._myIsBodyColliding}isHeadColliding(){return this._myIsHeadColliding}isFloating(){return this.isLeaning()||this.isHopping()}isLeaning(){return this._myIsLeaning}isHopping(){return this._myIsHopping}isFar(){return this._myIsFar}getDistanceToReal(){}getDistanceToRealHead(){}getPlayerHeadManager(){return this._myParams.myPlayerHeadManager}getMovementCollisionCheckParams(){return this._myParams.myMovementCollisionCheckParams}getTeleportCollisionCheckParams(){return this._myParams.myTeleportCollisionCheckParams}collisionCheckParamsUpdated(){this._myParams.myTeleportCollisionCheckParamsCopyFromMovement&&this._generateTeleportParamsFromMovementParams(),this._generateRealMovementParamsFromMovementParams()}isPositionValid(){return this._myIsPositionValid}isRealPositionValid(){return this._myIsRealPositionValid}getCollisionRuntimeParams(){return this._myCollisionRuntimeParams}getRealCollisionRuntimeParams(){return this._myRealCollisionRuntimeParams}_updateCollisionHeight(){let e=this.getHeight(),t=Math.pp_clamp(this.getHeightReal(),this._myParams.myMinHeight,this._myParams.myMaxHeight);this._myParams.myMovementCollisionCheckParams.myHeight=e,this._myParams.myTeleportCollisionCheckParams.myHeight=e,this._myRealMovementCollisionCheckParams.myHeight=t}_setupHeadCollisionCheckParams(){this._myHeadCollisionCheckParams=new et;let e=this._myHeadCollisionCheckParams;e.myRadius=this._myParams.myHeadRadius,e.myDistanceFromFeetToIgnore=0,e.myDistanceFromHeadToIgnore=0,e.mySplitMovementEnabled=!0,e.mySplitMovementMaxLength=.5,e.mySplitMovementMaxStepsEnabled=!0,e.mySplitMovementMaxSteps=2,e.mySplitMovementStopWhenHorizontalMovementCanceled=!0,e.mySplitMovementStopWhenVerticalMovementCanceled=!0,e.myHorizontalMovementCheckEnabled=!0,e.myHorizontalMovementRadialStepAmount=1,e.myHorizontalMovementCheckDiagonalOutward=!0,e.myHorizontalMovementCheckDiagonalInward=!0,e.myHorizontalMovementCheckVerticalDiagonalUpwardOutward=!0,e.myHorizontalMovementCheckVerticalDiagonalUpwardInward=!0,e.myHorizontalPositionCheckEnabled=!0,e.myHalfConeAngle=180,e.myHalfConeSliceAmount=3,e.myCheckConeBorder=!0,e.myCheckConeRay=!0,e.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision=!1,e.myHorizontalPositionCheckVerticalDirectionType=0,e.myHeight=e.myRadius,e.myPositionOffsetLocal.vec3_set(0,-e.myRadius/2,0),e.myCheckHeight=!0,e.myCheckHeightVerticalMovement=!0,e.myCheckHeightVerticalPosition=!0,e.myHeightCheckStepAmountMovement=2,e.myHeightCheckStepAmountPosition=2,e.myCheckHeightTopMovement=!0,e.myCheckHeightTopPosition=!0,e.myCheckVerticalStraight=!0,e.myCheckVerticalFixedForwardEnabled=!0,e.myCheckVerticalFixedForward=p(0,0,1),e.myCheckHorizontalFixedForwardEnabled=!0,e.myCheckHorizontalFixedForward=p(0,0,1),e.myVerticalMovementCheckEnabled=!0,e.myVerticalPositionCheckEnabled=!0,e.myGroundCircumferenceAddCenter=!0,e.myGroundCircumferenceSliceAmount=6,e.myGroundCircumferenceStepAmount=2,e.myGroundCircumferenceRotationPerStep=30,e.myFeetRadius=e.myRadius,e.myHorizontalBlockLayerFlags.copy(this._myParams.myHeadCollisionBlockLayerFlags),e.myHorizontalObjectsToIgnore.pp_copy(this._myParams.myHeadCollisionObjectsToIgnore),e.myVerticalBlockLayerFlags.copy(this._myParams.myHeadCollisionBlockLayerFlags),e.myVerticalObjectsToIgnore.pp_copy(this._myParams.myHeadCollisionObjectsToIgnore),e.myDebugEnabled=!1,e.myDebugHorizontalMovementEnabled=!0,e.myDebugHorizontalPositionEnabled=!1,e.myDebugVerticalMovementEnabled=!1,e.myDebugVerticalPositionEnabled=!1,e.myDebugSlidingEnabled=!1,e.myDebugGroundInfoEnabled=!1,e.myDebugCeilingInfoEnabled=!1,e.myDebugRuntimeParamsEnabled=!1,e.myDebugMovementEnabled=!1}_generateTeleportParamsFromMovementParams(){this._myParams.myTeleportCollisionCheckParams==null&&(this._myParams.myTeleportCollisionCheckParams=new et),this._myParams.myTeleportCollisionCheckParamsCheck360?this._myParams.myTeleportCollisionCheckParams=Os.generate360TeleportParamsFromMovementParams(this._myParams.myMovementCollisionCheckParams,this._myParams.myTeleportCollisionCheckParams):this._myParams.myTeleportCollisionCheckParams.copy(this._myParams.myMovementCollisionCheckParams)}_generateRealMovementParamsFromMovementParams(){this._myRealMovementCollisionCheckParams==null&&(this._myRealMovementCollisionCheckParams=new et);let e=this._myRealMovementCollisionCheckParams;e.copy(this._myParams.myMovementCollisionCheckParams),e.mySplitMovementEnabled=!0,e.mySplitMovementMaxLength=.5,e.mySplitMovementMaxStepsEnabled=!0,e.mySplitMovementMaxSteps=2,e.mySplitMovementStopWhenHorizontalMovementCanceled=!0,e.mySplitMovementStopWhenVerticalMovementCanceled=!0,e.mySlidingEnabled=!1,this._myParams.myRealMovementAllowVerticalAdjustments||(e.mySnapOnGroundEnabled=!1,e.mySnapOnCeilingEnabled=!1,e.myGroundPopOutEnabled=!1,e.myCeilingPopOutEnabled=!1,e.myAdjustVerticalMovementWithGroundAngleDownhill=!1,e.myAdjustVerticalMovementWithGroundAngleUphill=!1,e.myAdjustVerticalMovementWithCeilingAngleDownhill=!1,e.myAdjustVerticalMovementWithCeilingAngleUphill=!1,e.myAdjustHorizontalMovementWithGroundAngleDownhill=!1,e.myAdjustHorizontalMovementWithCeilingAngleDownhill=!1,e.myVerticalMovementReduceEnabled=!1),e.myIsOnGroundIfInsideHit=!0,e.myDebugEnabled=!1,e.myDebugHorizontalMovementEnabled=!1,e.myDebugHorizontalPositionEnabled=!1,e.myDebugVerticalMovementEnabled=!1,e.myDebugVerticalPositionEnabled=!1,e.myDebugSlidingEnabled=!1,e.myDebugGroundInfoEnabled=!0,e.myDebugCeilingInfoEnabled=!0,e.myDebugRuntimeParamsEnabled=!1,e.myDebugMovementEnabled=!1}_onXRSessionStart(e){this._myActive&&this._myParams.myResetToValidOnEnterSession&&(this._myResetRealOnSynced=!0)}_onXRSessionEnd(){this._myActive&&this._myParams.myResetToValidOnExitSession&&(this._myResetRealOnSynced=!0)}_debugUpdate(e){m.getDebugVisualManager(this._myParams.myEngine).drawPoint(0,this._myValidPosition,F(1,0,0,1),.05),m.getDebugVisualManager(this._myParams.myEngine).drawLineEnd(0,this._myValidPosition,this.getPositionReal(),F(1,0,0,1),.05),m.getDebugVisualManager(this._myParams.myEngine).drawLine(0,this._myValidPosition,this._myValidRotationQuat.quat_getForward(),.15,F(0,1,0,1),.025),m.getDebugVisualManager(this._myParams.myEngine).drawPoint(0,this._myValidPositionHead,F(1,1,0,1),.05)}destroy(){this._myDestroyed=!0,O.unregisterSessionStartEndEventListeners(this,this._myParams.myEngine)}isDestroyed(){return this._myDestroyed}};tt.prototype.getDistanceToReal=function(){let i=p(),e=p();return function(){return e=this.getPositionReal(e),e.vec3_distance(this.getPosition(i))}}();tt.prototype.getDistanceToRealHead=function(){let i=p(),e=p();return function(){return e=this.getPositionHeadReal(e),e.vec3_distance(this.getPositionHead(i))}}();tt.prototype.resetReal=function(){let i=p(),e=p(),t=p(),n=w();return function(s=!0,a=!1,l=!1,h=!0,_=!1){let y=this.getPlayerHeadManager();s&&y.teleportPositionFeet(this.getPosition(t)),i=this.getPlayerHeadManager().getRotationFeetQuat(n).quat_getUp(i),e=this.getRotationQuat(n).quat_getUp(e),(a||i.vec3_angle(e)>Math.PP_EPSILON_DEGREES&&this._myParams.myResetRealResetRotationIfUpChanged)&&y.setRotationFeetQuat(this.getRotationQuat(n),!1),l&&y.setHeightHead(this.getHeight(),!0),_&&this._updateReal(0),h&&this.resetHeadToReal()}}();tt.prototype.update=function(){let i=G(),e=new de,t=p(),n=p(),o=w();return function(a){if(this._updateReal(a),this._myResetRealOnSynced&&this.getPlayerHeadManager().isSynced()&&(this._myResetRealOnSynced=!1,O.isSessionActive(this._myParams.myEngine)?this.resetReal(!this._myParams.myNeverResetRealPositionVR,!this._myParams.myNeverResetRealRotationVR,!this._myParams.myNeverResetRealHeightVR,!0,!0):this.resetReal(!this._myParams.myNeverResetRealPositionNonVR,!this._myParams.myNeverResetRealRotationNonVR,!this._myParams.myNeverResetRealHeightNonVR,!0,!0)),this._myParams.myUpdatePositionValid){i=this.getTransformQuat(i),t=i.quat2_getUp(t),o=i.quat2_getRotationQuat(o),n=this._myLastValidMovementDirection.vec3_removeComponentAlongAxis(t,n),n.vec3_isZero(1e-5)||(n.vec3_normalize(n),o.quat_setForward(n),i.quat2_setRotationQuat(o));let l=this._myParams.myMovementCollisionCheckParams.myDebugEnabled;this._myParams.myMovementCollisionCheckParams.myDebugEnabled=!1,Q.getCollisionCheck(this._myParams.myEngine).positionCheck(!0,i,this._myParams.myMovementCollisionCheckParams,e),this._myParams.myMovementCollisionCheckParams.myDebugEnabled=l,this._myIsPositionValid=e.myIsPositionOk}this._myParams.myDebugEnabled&&m.isDebugEnabled(this._myParams.myEngine)&&this._debugUpdate(a)}}();tt.prototype._updateReal=function(){let i=p(),e=p(),t=p(),n=G(),o=new de,s=p(),a=p(),l=p(),h=p(),_=p(),y=p(),r=p(),u=p(),g=G(),P=p(),C=w();return function(S){if(this.getPlayerHeadManager().isSynced()){if(this._updateCollisionHeight(),this._myIsBodyColliding=!1,this._myIsHeadColliding=!1,this._myIsLeaning=!1,this._myIsHopping=!1,this._myIsFar=!1,i=this.getPositionReal(t).vec3_sub(this.getPosition(e),i),i.vec3_length()>1e-4&&(this._myLastValidMovementDirection=i.vec3_normalize(this._myLastValidMovementDirection)),this._myParams.mySyncEnabledFlagMap.get(ce.FAR)&&(this._myParams.myMaxDistanceFromRealToSyncEnabled&&i.vec3_length()>this._myParams.myMaxDistanceFromRealToSync?this._myIsFar=!0:this._myParams.myIsFarExtraCheckCallback!=null&&this._myParams.myIsFarExtraCheckCallback(this)&&(this._myIsFar=!0)),o.copy(this._myCollisionRuntimeParams),o.myIsOnGround=!0,n=this.getTransformQuat(n),s.vec3_copy(this._myValidPosition),this._myParams.mySyncEnabledFlagMap.get(ce.BODY_COLLIDING)&&(Q.getCollisionCheck(this._myParams.myEngine).move(i,n,this._myRealMovementCollisionCheckParams,o),!o.myHorizontalMovementCanceled&&!o.myVerticalMovementCanceled?Math.pp_clamp(this._myRealMovementCollisionCheckParams.myHeight,this._myParams.myIsBodyCollidingWhenHeightBelowValue,this._myParams.myIsBodyCollidingWhenHeightAboveValue)!=this._myRealMovementCollisionCheckParams.myHeight?this._myIsBodyColliding=!0:this._myParams.myIsBodyCollidingExtraCheckCallback!=null&&this._myParams.myIsBodyCollidingExtraCheckCallback(this)?this._myIsBodyColliding=!0:(this._myIsBodyColliding=!1,s.vec3_copy(o.myNewPosition)):this._myIsBodyColliding=!0),this._myParams.myAlwaysSyncPositionWithReal&&s.vec3_copy(t),this._myParams.mySyncEnabledFlagMap.get(ce.FLOATING)&&(this._myIsBodyColliding?i=t.vec3_sub(e,i):i=s.vec3_sub(e,i),o.copy(this._myCollisionRuntimeParams),g.quat2_setPositionRotationQuat(this._myValidPosition,this._myValidRotationQuat),Q.getCollisionCheck(this._myParams.myEngine).updateSurfaceInfo(g,this._myRealMovementCollisionCheckParams,o),o.myIsOnGround)){_=n.quat2_getUp(_),y=i.vec3_componentAlongAxis(_,y);let M=!y.vec3_isZero(1e-5);if(!M||!this._myParams.myIsFloatingValidIfVerticalMovement){let D=1;if(l.vec3_copy(i),!i.vec3_isZero(1e-5)&&this._myParams.myFloatingSplitCheckEnabled){let U=i.vec3_length()/this._myParams.myFloatingSplitCheckMaxSteps;if(!this._myParams.myFloatingSplitCheckStepEqualLength||U<this._myParams.myFloatingSplitCheckStepEqualLengthMinLength){let ye=this._myParams.myFloatingSplitCheckStepEqualLength?this._myParams.myFloatingSplitCheckStepEqualLengthMinLength:this._myParams.myFloatingSplitCheckMaxLength;D=Math.ceil(i.vec3_length()/ye),D>1&&(l=l.vec3_normalize(l).vec3_scale(ye,l),D=this._myParams.myFloatingSplitCheckMaxSteps!=null?Math.min(D,this._myParams.myFloatingSplitCheckMaxSteps):D),D=Math.max(1,D),D==1&&l.vec3_copy(i)}else D=this._myParams.myFloatingSplitCheckMaxSteps,D>1&&(l=l.vec3_normalize(l).vec3_scale(U,l))}let v=o.myGroundAngle<=this._myRealMovementCollisionCheckParams.myGroundAngleToIgnore+1e-4;r.vec3_zero(),u.vec3_copy(this._myValidPosition),o.copy(this._myCollisionRuntimeParams);let b=!1,x=!1,I=!1,L=!1;for(let U=0;U<D;U++)D==1||U!=D-1?h.vec3_copy(l):h=i.vec3_sub(r,h),u=u.vec3_add(h,u),g.quat2_setPositionRotationQuat(u,this._myValidRotationQuat),o.copy(this._myCollisionRuntimeParams),Q.getCollisionCheck(this._myParams.myEngine).updateSurfaceInfo(g,this._myRealMovementCollisionCheckParams,o),r=r.vec3_add(h,r),o.myIsOnGround?(o.myGroundAngle>this._myRealMovementCollisionCheckParams.myGroundAngleToIgnore+1e-4&&(L=!0),b&&(x=!0),U==D-1&&(I=!0)):b=!0;let k=L&&v&&!this._myParams.myIsFloatingValidIfSteepGround&&(!M||!this._myParams.myIsFloatingValidIfVerticalMovementAndSteepGround);if(b||k?x?this._myIsHopping=!0:this._myIsLeaning=!0:(this._myIsLeaning=!1,this._myIsHopping=!1,this._myParams.myIsLeaningExtraCheckCallback!=null&&this._myParams.myIsLeaningExtraCheckCallback(this)?this._myIsLeaning=!0:this._myParams.myIsHoppingExtraCheckCallback!=null&&this._myParams.myIsHoppingExtraCheckCallback(this)&&(this._myIsHopping=!0)),this._myIsLeaning){let U=i.vec3_length();this._myParams.myIsLeaningValidAboveDistance&&U>this._myParams.myLeaningValidDistance&&(this._myIsLeaning=!1)}(this._myIsLeaning||this._myIsHopping)&&(I&&this._myParams.myIsFloatingValidIfRealOnGround?(this._myIsLeaning=!1,this._myIsHopping=!1):I&&M&&this._myParams.myIsFloatingValidIfVerticalMovementAndRealOnGround&&(this._myIsLeaning=!1,this._myIsHopping=!1))}}if(i=this.getPositionHeadReal(t).vec3_sub(this.getPositionHead(e),i),o.reset(),n=this.getTransformHeadQuat(n),a.vec3_copy(this._myValidPositionHead),this._myParams.mySyncEnabledFlagMap.get(ce.HEAD_COLLIDING)&&(Q.getCollisionCheck(this._myParams.myEngine).move(i,n,this._myHeadCollisionCheckParams,o),!o.myHorizontalMovementCanceled&&!o.myVerticalMovementCanceled?(this._myIsHeadColliding=!1,a.vec3_copy(o.myNewPosition)):this._myIsHeadColliding=!0),this._myParams.myAlwaysSyncHeadPositionWithReal&&a.vec3_copy(t),(this.isSynced(this._myParams.mySyncPositionFlagMap)||this._myParams.myAlwaysSyncPositionWithReal)&&!this._myParams.mySyncPositionDisabled&&this._myValidPosition.vec3_copy(s),(this.isSynced(this._myParams.mySyncPositionHeadFlagMap)||this._myParams.myAlwaysSyncHeadPositionWithReal||this.isSynced(this._myParams.mySyncPositionFlagMap)&&this._myParams.myAlwaysSyncPositionWithReal)&&(this._myValidPositionHead=this.getPositionHeadReal(a)),this.isSynced(this._myParams.mySyncRotationFlagMap)&&(this._myValidRotationQuat=this.getRotationRealQuat(this._myValidRotationQuat)),this.isSynced(this._myParams.mySyncHeightFlagMap)&&(this._myValidHeight=this._myRealMovementCollisionCheckParams.myHeight,this._updateCollisionHeight()),this._myParams.myUpdateRealPositionValid){n=this.getTransformRealQuat(n),_=n.quat2_getUp(_),C=n.quat2_getRotationQuat(C),P=this._myLastValidMovementDirection.vec3_removeComponentAlongAxis(_,P),P.vec3_isZero(1e-5)||(P.vec3_normalize(P),C.quat_setForward(P),n.quat2_setRotationQuat(C));let M=this._myParams.myMovementCollisionCheckParams.myDebugEnabled;this._myParams.myMovementCollisionCheckParams.myDebugEnabled=!1,Q.getCollisionCheck(this._myParams.myEngine).positionCheck(!0,n,this._myParams.myMovementCollisionCheckParams,this._myRealCollisionRuntimeParams),this._myIsRealPositionValid=this._myRealCollisionRuntimeParams.myIsPositionOk,this._myParams.myMovementCollisionCheckParams.myDebugEnabled=M}}}}();tt.prototype.move=function(){let i=G(),e=p();return function(n,o=null,s=!1){i=this.getTransformQuat(i),Q.getCollisionCheck(this._myParams.myEngine).move(n,i,this._myParams.myMovementCollisionCheckParams,this._myCollisionRuntimeParams),o?.copy(this._myCollisionRuntimeParams),s?e.vec3_copy(n):e.vec3_copy(this._myCollisionRuntimeParams.myFixedMovement),e.vec3_isZero(1e-5)||(this._myValidPosition.vec3_add(e,this._myValidPosition),this.getPlayerHeadManager().moveFeet(e)),this._myParams.myResetRealOnMove&&(this.isSynced()||(O.isSessionActive(this._myParams.myEngine)?this.resetReal(!this._myParams.myNeverResetRealPositionVR,!this._myParams.myNeverResetRealRotationVR,!this._myParams.myNeverResetRealHeightVR,!0):this.resetReal(!this._myParams.myNeverResetRealPositionNonVR,!this._myParams.myNeverResetRealRotationNonVR,!this._myParams.myNeverResetRealHeightNonVR,!0)))}}();tt.prototype.teleportPosition=function(){let i=G();return function(e,t=null,n=!1){i=this.getTransformQuat(i),i.quat2_setPosition(e),this.teleportTransformQuat(i,t,n)}}();tt.prototype.teleportPositionRotationQuat=function(){let i=G();return function(t,n,o=null,s=!1){i=this.getTransformQuat(i),i.quat2_setPositionRotationQuat(t,n),this.teleportTransformQuat(i,o,s)}}();tt.prototype.teleportTransformQuat=function(){let i=p(),e=p(),t=w(),n=G(),o=p();return function(s,a=null,l=!1){i=this.getPosition(i),e=s.quat2_getPosition(e),t=s.quat2_getRotationQuat(t),n.quat2_setPositionRotationQuat(i,t),Q.getCollisionCheck(this._myParams.myEngine).teleport(e,n,this._myParams.myTeleportCollisionCheckParams,this._myCollisionRuntimeParams),a?.copy(this._myCollisionRuntimeParams),o.vec3_zero(),l?o=e.vec3_sub(i,o):this._myCollisionRuntimeParams.myTeleportCanceled||(o=this._myCollisionRuntimeParams.myFixedTeleportPosition.vec3_sub(i,o)),(!this._myCollisionRuntimeParams.myTeleportCanceled||l)&&(this._myValidRotationQuat.quat_copy(t),this.getPlayerHeadManager().setRotationFeetQuat(t)),o.vec3_isZero(1e-5)||(this._myValidPosition.vec3_add(o,this._myValidPosition),this.getPlayerHeadManager().moveFeet(o)),this._myParams.myResetRealOnTeleport&&(this.isSynced()||(O.isSessionActive(this._myParams.myEngine)?this.resetReal(!this._myParams.myNeverResetRealPositionVR,!this._myParams.myNeverResetRealRotationVR,!this._myParams.myNeverResetRealHeightVR,!0):this.resetReal(!this._myParams.myNeverResetRealPositionNonVR,!this._myParams.myNeverResetRealRotationNonVR,!this._myParams.myNeverResetRealHeightNonVR,!0)))}}();tt.prototype.rotateQuat=function(){return function(e){this._myValidRotationQuat.quat_rotateQuat(e,this._myValidRotationQuat),this.getPlayerHeadManager().rotateFeetQuat(e)}}();tt.prototype.setRotationQuat=function(){let i=w();return function(t){i=this._myValidRotationQuat.quat_rotationToQuat(t,i),this.rotateQuat(i)}}();tt.prototype.setHeight=function(){let i=G();return function(t,n=!1){let o=Math.pp_clamp(t,this._myParams.myMinHeight,this._myParams.myMaxHeight),s=this.getHeight();this._myValidHeight=o,this._updateCollisionHeight(),i=this.getTransformQuat(i),Q.getCollisionCheck(this._myParams.myEngine).positionCheck(!0,i,this._myParams.myMovementCollisionCheckParams,this._myCollisionRuntimeParams),this._myCollisionRuntimeParams.myIsPositionOk||n?this.getPlayerHeadManager().setHeightHead(this.getHeight(),!0):this._myValidHeight=s,this._updateCollisionHeight()}}();var Gs=class{constructor(e=m.getMainEngine()){this.myPlayerHeadManager=null,this.myMaxRotationSpeed=0,this.myIsSnapTurn=!1,this.mySnapTurnOnlyVR=!1,this.mySmoothSnapEnabled=!0,this.mySmoothSnapSpeedDegrees=240,this.myRotationMinStickIntensityThreshold=0,this.mySnapTurnActivateThreshold=0,this.mySnapTurnResetThreshold=0,this.myClampVerticalAngle=!0,this.myMaxVerticalAngle=0,this.myHandedness=A.RIGHT,this.myEngine=e}},gi=class{constructor(e){this._myParams=e,this._mySnapCharge=!1,this._mySmoothSnapHorizontalRunning=!1,this._mySmoothSnapHorizontalAngleToPerform=0,this._mySmoothSnapVerticalRunning=!1,this._mySmoothSnapVerticalAngleToPerform=0}start(){}stop(){this._mySmoothSnapHorizontalRunning=!1,this._mySmoothSnapHorizontalAngleToPerform=0,this._mySmoothSnapVerticalRunning=!1,this._mySmoothSnapVerticalAngleToPerform=0}getParams(){return this._myParams}update(e){this._rotateHeadHorizontally(e),this._myParams.myPlayerHeadManager.canRotateHead()&&this._rotateHeadVertically(e)}};gi.prototype._rotateHeadHorizontally=function(){let i=p(),e=w();return function(n){i=this._myParams.myPlayerHeadManager.getPlayer().pp_getUp(i),e.quat_identity();let o=m.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getAxesInfo(ne.THUMBSTICK).getAxes();if(!this._myParams.myIsSnapTurn||this._myParams.mySnapTurnOnlyVR&&!O.isSessionActive(this._myParams.myEngine)){if(Math.abs(o[0])>this._myParams.myRotationMinStickIntensityThreshold){let s=-o[0],a=Math.pp_lerp(0,this._myParams.myMaxRotationSpeed,Math.abs(s))*Math.pp_sign(s);e.quat_fromAxis(a*n,i)}}else if(!this._mySnapCharge)Math.abs(o.vec2_length())<this._myParams.mySnapTurnResetThreshold&&(this._mySnapCharge=!0);else if(!this._mySmoothSnapHorizontalRunning&&Math.abs(o[0])>this._myParams.mySnapTurnActivateThreshold){let s=-Math.pp_sign(o[0])*this._myParams.mySnapTurnAngle;this._myParams.mySmoothSnapEnabled?(this._mySmoothSnapHorizontalRunning=!0,this._mySmoothSnapHorizontalAngleToPerform=s):e.quat_fromAxis(s,i),this._mySnapCharge=!1}if(this._mySmoothSnapHorizontalRunning){let s=Math.pp_sign(this._mySmoothSnapHorizontalAngleToPerform)*(this._myParams.mySmoothSnapSpeedDegrees*n);Math.abs(s)>Math.abs(this._mySmoothSnapHorizontalAngleToPerform)-Math.PP_EPSILON&&(s=this._mySmoothSnapHorizontalAngleToPerform),e.quat_fromAxis(s,i),this._mySmoothSnapHorizontalAngleToPerform-=s,Math.abs(this._mySmoothSnapHorizontalAngleToPerform)<Math.PP_EPSILON&&(this._mySmoothSnapHorizontalRunning=!1,this._mySmoothSnapHorizontalAngleToPerform=0)}e.quat_getAngle()>Math.PP_EPSILON_DEGREES&&this._myParams.myPlayerTransformManager.rotateQuat(e)}}();gi.prototype._rotateHeadVertically=function(){let i=p(),e=p(),t=p(),n=p(),o=p(),s=p(),a=w();return function(h){let _=this._myParams.myPlayerHeadManager.getHead();i=_.pp_getForward(i),e=_.pp_getUp(e),t=this._myParams.myPlayerHeadManager.getPlayer().pp_getUp(t),n=t.vec3_negate(n),o=i.vec3_cross(t,o);let y=1;i.vec3_angle(t)<y?o=e.vec3_negate(o).vec3_cross(t,o):i.vec3_angle(n)<y?o=e.vec3_cross(t,o):e.vec3_isConcordant(t)||o.vec3_negate(o),o.vec3_normalize(o);let r=m.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getAxesInfo(ne.THUMBSTICK).getAxes(),u=0;if(!this._myParams.myIsSnapTurn||this._myParams.mySnapTurnOnlyVR&&!O.isSessionActive(this._myParams.myEngine)){if(Math.abs(r[1])>this._myParams.myRotationMinStickIntensityThreshold){let g=r[1];u=Math.pp_lerp(0,this._myParams.myMaxRotationSpeed,Math.abs(g))*Math.pp_sign(g)*h}}else if(!this._mySnapCharge)Math.abs(r.vec2_length())<this._myParams.mySnapTurnResetThreshold&&(this._mySnapCharge=!0);else if(!this._mySmoothSnapVerticalRunning&&Math.abs(r[1])>this._myParams.mySnapTurnActivateThreshold){u=Math.pp_sign(r[1])*this._myParams.mySnapTurnAngle;let g=Math.pp_angleClamp(e.vec3_angleSigned(t,o)),P=Math.round(g/this._myParams.mySnapTurnAngle),C=Math.pp_angleClamp(P*this._myParams.mySnapTurnAngle),f=-Math.pp_angleDistanceSigned(g,C);Math.abs(f)>1?Math.pp_sign(u)==Math.pp_sign(f)?u=f:u=-Math.pp_sign(f)*this._myParams.mySnapTurnAngle+f:Math.abs(f)>Math.PP_EPSILON_DEGREES&&(u+=f),this._myParams.mySmoothSnapEnabled&&(this._mySmoothSnapVerticalRunning=!0,this._mySmoothSnapVerticalAngleToPerform=u),this._mySnapCharge=!1}if(this._mySmoothSnapVerticalRunning&&(u=Math.pp_sign(this._mySmoothSnapVerticalAngleToPerform)*(this._myParams.mySmoothSnapSpeedDegrees*h),Math.abs(u)>Math.abs(this._mySmoothSnapVerticalAngleToPerform)-Math.PP_EPSILON&&(u=this._mySmoothSnapVerticalAngleToPerform),this._mySmoothSnapVerticalAngleToPerform-=u,Math.abs(this._mySmoothSnapVerticalAngleToPerform)<Math.PP_EPSILON&&(this._mySmoothSnapVerticalRunning=!1,this._mySmoothSnapVerticalAngleToPerform=0)),u!=0&&(a.quat_fromAxis(u,o),this._myParams.myPlayerHeadManager.rotateHeadQuat(a),this._myParams.myClampVerticalAngle)){let g=this._myParams.myMaxVerticalAngle-1e-4;s=_.pp_getUp(s);let P=Math.pp_angleClamp(s.vec3_angleSigned(t,o));if(Math.abs(P)>g){let C=(Math.abs(P)-g)*Math.pp_sign(P);a.quat_fromAxis(C,o),this._myParams.myPlayerHeadManager.rotateHeadQuat(a)}}}}();Object.defineProperty(gi.prototype,"_rotateHeadHorizontally",{enumerable:!1});Object.defineProperty(gi.prototype,"_rotateHeadVertically",{enumerable:!1});var Ns=class{constructor(){this.myIsFlying=!1,this.myGravitySpeed=0,this.myCollisionRuntimeParams=null,this.myIsTeleportDetecting=!1,this.myIsTeleporting=!1,this.myTeleportJustPerformed=!1}},on=class{constructor(e){this._myLocomotionRuntimeParams=e}getRuntimeParams(){return this._myLocomotionRuntimeParams}start(){}stop(){}canStop(){return!0}};import{PhysXComponent as LR}from"@wonderlandengine/api";var Us=class{constructor(e=m.getMainEngine()){this.myPlayerTransformManager=null,this.myEnabled=!0,this.myObscureObject=null,this.myObscureMaterial=null,this.myObscureRadius=0,this.myObscureFadeOutSeconds=.1,this.myObscureFadeInSeconds=.1,this.myObscureFadeEasingFunction=ue.linear,this.myDistanceToStartObscureWhenHeadColliding=0,this.myDistanceToStartObscureWhenBodyColliding=0,this.myDistanceToStartObscureWhenFloating=0,this.myDistanceToStartObscureWhenFar=0,this.myRelativeDistanceToMaxObscureWhenHeadColliding=0,this.myRelativeDistanceToMaxObscureWhenBodyColliding=0,this.myRelativeDistanceToMaxObscureWhenFloating=0,this.myRelativeDistanceToMaxObscureWhenFar=0,this.myObscureLevelRelativeDistanceEasingFunction=ue.linear,this.myEngine=e}},Ws=class{constructor(e){this._myParams=e,this._myObscureMaterial=null,this._myObscureParentObject=null,this._myCurrentObscureLevel=0,this._myTargetObscureLevel=0,this._myLastTargetObscureLevel=null,this._myLastIsFadingIn=null,this._myFadeTimer=new te(0,!1),this._myFSM=new ct,this._myFSM.addState("init"),this._myFSM.addState("inactive"),this._myFSM.addState("idle",this._idleUpdate.bind(this)),this._myFSM.addState("fading",this._fadingUpdate.bind(this)),this._myFSM.addTransition("init","inactive","end",this._setObscureLevel.bind(this,0)),this._myFSM.addTransition("inactive","idle","start"),this._myFSM.addTransition("idle","fading","fade",this._startFading.bind(this)),this._myFSM.addTransition("fading","idle","done",this._fadingDone.bind(this)),this._myFSM.addTransition("inactive","inactive","stop",this._setObscureLevel.bind(this,0)),this._myFSM.addTransition("idle","inactive","stop",this._setObscureLevel.bind(this,0)),this._myFSM.addTransition("fading","inactive","stop",this._setObscureLevel.bind(this,0)),this._myFSM.init("init"),this._setupVisuals(),this._myFSM.perform("end"),this._myDestroyed=!1}start(){this._myFSM.perform("start")}stop(){this._myFSM.perform("stop")}getParams(){return this._myParams}update(e){this._myObscureParentObject.pp_resetTransformLocal(),this._updateObscured(),this._myFSM.update(e),this._setObscureVisible(this.isObscured())}isStarted(){return!this._myFSM.isInState("inactive")}isObscured(){return this._myCurrentObscureLevel>0}isFading(){return this._myFSM.isInState("fading")}isFadingIn(){return this.isFading()&&this._myCurrentObscureLevel>this._myTargetObscureLevel}isFadingOut(){return this.isFading()&&this._myCurrentObscureLevel<=this._myTargetObscureLevel}getObscureLevel(){return this._myCurrentObscureLevel}getTargetObscureLevel(){return this._myTargetObscureLevel}getCurrentObscureLevel(){this._myCurrentObscureLevel}overrideObscureLevel(e,t=!1){this._myObscureLevelOverride=e,t&&this.isStarted()&&this._setObscureLevel(e)}resetObscureLevelOverride(){this._myObscureLevelOverride=null}_idleUpdate(e){Math.abs(this._myTargetObscureLevel-this._myCurrentObscureLevel)>Math.PP_EPSILON&&this._myFSM.perform("fade")}_fadingUpdate(e){if(Math.abs(this._myTargetObscureLevel-this._myCurrentObscureLevel)<=Math.PP_EPSILON){this._myFSM.perform("done");return}this._myLastTargetObscureLevel!=this._myTargetObscureLevel&&(this._refreshFadeTimer(),this._myLastTargetObscureLevel=this._myTargetObscureLevel),this._myFadeTimer.update(e);let t=this._myParams.myObscureFadeEasingFunction(this._myFadeTimer.getPercentage());this._myCurrentObscureLevel>this._myTargetObscureLevel?(t=Math.pp_clamp(1-t,0,1),t=Math.max(t,this._myTargetObscureLevel)):t=Math.min(t,this._myTargetObscureLevel),this._setObscureAlpha(t),this._myCurrentObscureLevel=t,(Math.abs(this._myTargetObscureLevel-this._myCurrentObscureLevel)<=Math.PP_EPSILON||this._myFadeTimer.isDone())&&this._myFSM.perform("done")}_startFading(){this._myLastTargetObscureLevel=null,this._myLastIsFadingIn=null}_fadingDone(){this._setObscureLevel(this._myTargetObscureLevel)}_refreshFadeTimer(){let e=this._myCurrentObscureLevel>this._myTargetObscureLevel;this._myLastIsFadingIn!=e&&this._setFadeTimerToObscureLevel(e),this._myLastIsFadingIn=e}_setFadeTimerToObscureLevel(e){let t=0,n=0,s=1/1e3;for(;t<1;)Math.abs(this._myParams.myObscureFadeEasingFunction(t)-this._myCurrentObscureLevel)<Math.abs(this._myParams.myObscureFadeEasingFunction(n)-this._myCurrentObscureLevel)&&(n=t),t+=s;Math.abs(this._myParams.myObscureFadeEasingFunction(1)-this._myCurrentObscureLevel)<Math.abs(this._myParams.myObscureFadeEasingFunction(n)-this._myCurrentObscureLevel)&&(n=1),e?(this._myFadeTimer.start(this._myParams.myObscureFadeInSeconds),this._myFadeTimer.setPercentage(Math.pp_clamp(1-n,0,1))):(this._myFadeTimer.start(this._myParams.myObscureFadeOutSeconds),this._myFadeTimer.setPercentage(Math.pp_clamp(n,0,1)))}_setObscureLevel(e){this._myTargetObscureLevel=e,this._myCurrentObscureLevel=e,this._setObscureAlpha(e),this._setObscureVisible(this.isObscured())}_setObscureAlpha(e){this._myParams.myObscureObject==null?xs.setAlpha(this._myObscureMaterial,e):xs.setObjectAlpha(this._myParams.myObscureObject,e)}_updateObscured(){if(this._myTargetObscureLevel=0,this._myParams.myEnabled)if(this._myObscureLevelOverride!=null)this._myTargetObscureLevel=this._myObscureLevelOverride;else{if(this._myParams.myPlayerTransformManager.isHeadColliding()){let t=this._myParams.myPlayerTransformManager.getDistanceToRealHead()-this._myParams.myDistanceToStartObscureWhenHeadColliding;if(t>=0){let n=Math.pp_clamp(t/this._myParams.myRelativeDistanceToMaxObscureWhenHeadColliding,0,1),o=this._myParams.myObscureLevelRelativeDistanceEasingFunction(n);this._myTargetObscureLevel=Math.max(this._myTargetObscureLevel,o)}}if(this._myParams.myPlayerTransformManager.isBodyColliding()){let t=this._myParams.myPlayerTransformManager.getDistanceToReal()-this._myParams.myDistanceToStartObscureWhenBodyColliding;if(t>=0){let n=Math.pp_clamp(t/this._myParams.myRelativeDistanceToMaxObscureWhenBodyColliding,0,1),o=this._myParams.myObscureLevelRelativeDistanceEasingFunction(n);this._myTargetObscureLevel=Math.max(this._myTargetObscureLevel,o)}}if(this._myParams.myPlayerTransformManager.isFloating()){let t=this._myParams.myPlayerTransformManager.getDistanceToReal()-this._myParams.myDistanceToStartObscureWhenFloating;if(t>=0){let n=Math.pp_clamp(t/this._myParams.myRelativeDistanceToMaxObscureWhenFloating,0,1),o=this._myParams.myObscureLevelRelativeDistanceEasingFunction(n);this._myTargetObscureLevel=Math.max(this._myTargetObscureLevel,o)}}if(this._myParams.myPlayerTransformManager.isFar()){let t=this._myParams.myPlayerTransformManager.getDistanceToReal()-this._myParams.myDistanceToStartObscureWhenFar;if(t>=0){let n=Math.pp_clamp(t/this._myParams.myRelativeDistanceToMaxObscureWhenFar,0,1),o=this._myParams.myObscureLevelRelativeDistanceEasingFunction(n);this._myTargetObscureLevel=Math.max(this._myTargetObscureLevel,o)}}}}_setupVisuals(){this._myObscureMaterial=null,this._myParams.myObscureMaterial!=null?this._myObscureMaterial=this._myParams.myObscureMaterial:(this._myObscureMaterial=m.getDefaultMaterials(this._myParams.myEngine).myFlatTransparentNoDepth.clone(),this._myObscureMaterial.color=F(0,0,0,1)),this._myObscureParentObject=m.getPlayerObjects(this._myParams.myEngine).myCauldron.pp_addObject();let e=new Ut(this._myParams.myEngine);e.myMesh=m.getDefaultMeshes(this._myParams.myEngine).myInvertedSphere,e.myMaterial=this._myParams.myObscureMaterial!=null?this._myParams.myObscureMaterial:this._myObscureMaterial,e.myParent=this._myObscureParentObject,e.myLocal=!0,e.myTransform.mat4_setScale(p(this._myParams.myObscureRadius,this._myParams.myObscureRadius,this._myParams.myObscureRadius)),this._myObscureVisual=new Wi(e),this._myParams.myObscureObject!=null&&(this._myParams.myObscureObject.pp_setParent(this._myObscureParentObject,!1),this._myParams.myObscureObject.pp_resetTransformLocal()),this._setObscureVisible(!1)}_setObscureVisible(e){this._myParams.myObscureObject==null?this._myObscureVisual.setVisible(e):(this._myObscureVisual.setVisible(!1),this._myParams.myObscureObject.pp_setActive(e)),e?this._myObscureParentObject.pp_setParent(this._myParams.myPlayerTransformManager.getHead(),!1):this._myObscureParentObject.pp_setParent(m.getPlayerObjects(this._myParams.myEngine)?.myCauldron,!1)}destroy(){this._myDestroyed=!0,this._myObscureVisual.destroy()}isDestroyed(){return this._myDestroyed}};var Qs=class{constructor(){this.myTeleportValidMaterial=null,this.myTeleportInvalidMaterial=null,this.myTeleportPositionObject=null,this.myTeleportPositionObjectRotateWithHead=!0,this.myTeleportParableLineEndOffset=.05,this.myTeleportParableMinVerticalDistanceToShowVerticalLine=.8,this.myTeleportParableShowVerticalLineMaxLength=.3,this.myTeleportParablePositionUpOffset=.05,this.myTeleportParablePositionVisualAlignOnSurface=!0,this.myVisualTeleportPositionLerpEnabled=!0,this.myVisualTeleportPositionLerpFactor=10,this.myVisualTeleportPositionMinDistanceToResetLerp=.005,this.myVisualTeleportPositionMinDistanceToLerp=.15,this.myVisualTeleportPositionMaxDistanceToLerp=5,this.myVisualTeleportPositionMinDistanceToCloseLerpFactor=.02,this.myVisualTeleportPositionCloseLerpFactor=30,this.myVisualTeleportPositionMinAngleDistanceToResetLerp=.1,this.myVisualTeleportPositionMinAngleDistanceToLerp=1,this.myVisualTeleportPositionMaxAngleDistanceToLerp=180}},Ri=class{constructor(e,t,n){this._myDetectionRuntimeParams=n,this._myTeleportParams=e,this._myTeleportRuntimeParams=t,this._myVisualTeleportTransformQuatReset=!0,this._myVisualTeleportTransformQuat=G(),this._myVisualTeleportTransformPositionLerping=!1,this._myVisualTeleportTransformRotationLerping=!1,this._setupVisuals(),this._myDestroyed=!1}start(){}end(){this._myVisualTeleportTransformQuatReset=!0,this._myVisualTeleportTransformPositionLerping=!1,this._myVisualTeleportTransformRotationLerping=!1,this._hideTeleportPosition()}update(e){this._myDetectionRuntimeParams.myTeleportDetectionValid?this._showTeleportPosition(e):(this._myVisualTeleportTransformQuatReset=!0,this._myVisualTeleportTransformPositionLerping=!1,this._myVisualTeleportTransformRotationLerping=!1,this._hideTeleportPosition())}_showTeleportPosition(e){this._hideTeleportPosition(),this._showTeleportParable(e)}_hideTeleportPosition(){for(let e of this._myValidVisualLines)e.setVisible(!1);for(let e of this._myInvalidVisualLines)e.setVisible(!1);this._myValidVisualPoint.setVisible(!1),this._myInvalidVisualPoint.setVisible(!1),this._myValidVisualVerticalArrow.setVisible(!1),this._myValidVisualTeleportPositionTorus.setVisible(!1),this._myValidVisualTeleportPositionTorusInner.setVisible(!1),this._myTeleportParams.myVisualizerParams.myTeleportPositionObject!=null&&this._myTeleportParams.myVisualizerParams.myTeleportPositionObject.pp_setActive(!1)}_addVisualLines(e){for(let t=0;t<e;t++){{let n=new Ze(this._myTeleportParams.myEngine);this._myTeleportParams.myVisualizerParams.myTeleportValidMaterial!=null?n.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportValidMaterial:n.myMaterial=this._myTeleportValidMaterial,this._myValidVisualLines.push(new St(n))}{let n=new Ze(this._myTeleportParams.myEngine);this._myTeleportParams.myVisualizerParams.myTeleportValidMaterial!=null?n.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportInvalidMaterial:n.myMaterial=this._myTeleportInvalidMaterial,this._myInvalidVisualLines.push(new St(n))}}}destroy(){this._myDestroyed=!0;for(let e of this._myValidVisualLines)e.destroy();for(let e of this._myInvalidVisualLines)e.destroy();this._myValidVisualPoint.destroy(),this._myInvalidVisualPoint.destroy(),this._myValidVisualVerticalArrow.destroy(),this._myValidVisualTeleportPositionTorus.destroy(),this._myValidVisualTeleportPositionTorusInner.destroy()}isDestroyed(){return this._myDestroyed}};Ri.prototype._setupVisuals=function(){let i=p();return function(){this._myTeleportValidMaterial=m.getDefaultMaterials(this._myTeleportParams.myEngine).myFlatOpaque.clone(),this._myTeleportValidMaterial.color=F(0,.5,1,1),this._myTeleportInvalidMaterial=m.getDefaultMaterials(this._myTeleportParams.myEngine).myFlatOpaque.clone(),this._myTeleportInvalidMaterial.color=F(.75,.05,0,1),this._myValidVisualLines=[],this._myInvalidVisualLines=[],this._addVisualLines(30);{let t=new vt(this._myTeleportParams.myEngine);this._myTeleportParams.myVisualizerParams.myTeleportValidMaterial!=null?t.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportValidMaterial:t.myMaterial=this._myTeleportValidMaterial,this._myValidVisualPoint=new ui(t)}{let t=new vt(this._myTeleportParams.myEngine);this._myTeleportParams.myVisualizerParams.myTeleportInvalidMaterial!=null?t.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportInvalidMaterial:t.myMaterial=this._myTeleportInvalidMaterial,this._myInvalidVisualPoint=new ui(t)}{let t=new ze(this._myTeleportParams.myEngine);this._myTeleportParams.myVisualizerParams.myTeleportValidMaterial!=null?t.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportValidMaterial:t.myMaterial=this._myTeleportValidMaterial,this._myValidVisualVerticalArrow=new yt(t)}this._myVisualTeleportPositionObject=m.getPlayerObjects(this._myTeleportParams.myEngine).myCauldron.pp_addObject();{let t=new Ot(this._myTeleportParams.myEngine);t.myRadius=.175,t.mySegmentsAmount=24,t.mySegmentThickness=.02,this._myTeleportParams.myVisualizerParams.myTeleportValidMaterial!=null?t.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportValidMaterial:t.myMaterial=this._myTeleportValidMaterial,t.myParent=this._myVisualTeleportPositionObject,t.myLocal=!0,this._myValidVisualTeleportPositionTorus=new hi(t)}{let t=new Ot(this._myTeleportParams.myEngine);t.myRadius=.04,t.mySegmentsAmount=24,t.mySegmentThickness=.02,this._myTeleportParams.myVisualizerParams.myTeleportValidMaterial!=null?t.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportValidMaterial:t.myMaterial=this._myTeleportValidMaterial,t.myParent=this._myVisualTeleportPositionObject,t.myLocal=!0;let n=this._myValidVisualTeleportPositionTorus.getParams(),o=(n.myRadius-n.mySegmentThickness/2)/2;i.vec3_set(0,0,o),t.myTransform.mat4_setPosition(i),this._myValidVisualTeleportPositionTorusInner=new hi(t)}this._myTeleportParams.myVisualizerParams.myTeleportPositionObject!=null&&(this._myTeleportParams.myVisualizerParams.myTeleportPositionObject.pp_setParent(this._myVisualTeleportPositionObject),this._myTeleportParams.myVisualizerParams.myTeleportPositionObject.pp_resetTransformLocal(),this._myTeleportParams.myVisualizerParams.myTeleportPositionObject.pp_setActive(!1)),this._hideTeleportPosition()}}();Ri.prototype._showTeleportParable=function(){let i=p(),e=p(),t=p(),n=p();return function(s){let a=Math.max(this._myDetectionRuntimeParams.myParableDistance-this._myTeleportParams.myVisualizerParams.myTeleportParableLineEndOffset),l=this._myDetectionRuntimeParams.myParable.getPositionIndexByDistance(a),h=this._myDetectionRuntimeParams.myParable.getDistance(l);l+1>this._myValidVisualLines.length&&this._addVisualLines(l+1,this._myValidVisualLines.length);for(let r=0;r<=l;r++){i=this._myDetectionRuntimeParams.myParable.getPosition(r,i),e=this._myDetectionRuntimeParams.myParable.getPosition(r+1,e);let u=this._myDetectionRuntimeParams.myTeleportPositionValid?this._myValidVisualLines[r]:this._myInvalidVisualLines[r],g=u.getParams();if(r==l){let P=Math.max(0,a-h);e=e.vec3_sub(i,e).vec3_normalize(e),e=i.vec3_add(e.vec3_scale(P,e),e)}g.setStartEnd(i,e),g.myThickness=.005,u.paramsUpdated(),u.setVisible(!0),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugShowEnabled&&m.isDebugEnabled(this._myTeleportParams.myEngine)&&m.getDebugVisualManager(this._myTeleportParams.myEngine).drawPoint(0,i,F(1,0,0,1),.01)}let _=this._myDetectionRuntimeParams.myTeleportPositionValid?this._myValidVisualPoint:this._myInvalidVisualPoint,y=_.getParams();if(y.myPosition.vec3_copy(e),y.myRadius=.01,_.paramsUpdated(),_.setVisible(!0),this._myDetectionRuntimeParams.myTeleportPositionValid){t=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(t),n=e.vec3_sub(this._myTeleportRuntimeParams.myTeleportPosition,n).vec3_componentAlongAxis(t,n);let r=n.vec3_length();if(r>=this._myTeleportParams.myVisualizerParams.myTeleportParableMinVerticalDistanceToShowVerticalLine){let u=Math.min(r-this._myTeleportParams.myVisualizerParams.myTeleportParableMinVerticalDistanceToShowVerticalLine,this._myTeleportParams.myVisualizerParams.myTeleportParableShowVerticalLineMaxLength),g=this._myValidVisualVerticalArrow.getParams();g.myStart.vec3_copy(e),g.myDirection=t.vec3_negate(g.myDirection),g.myLength=u,g.myThickness=.005,g.myArrowThickness=y.myRadius,g.myArrowLength=g.myArrowThickness*3.5/1.5,this._myValidVisualVerticalArrow.paramsUpdated(),this._myValidVisualVerticalArrow.setVisible(!0)}this._showTeleportParablePosition(s)}else this._myVisualTeleportTransformQuatReset=!0,this._myVisualTeleportTransformPositionLerping=!1,this._myVisualTeleportTransformRotationLerping=!1}}();Ri.prototype._showTeleportParablePosition=function(){let i=p(),e=G(),t=w(),n=p(),o=p(),s=p(),a=p(),l=p(),h=w(),_=G(),y=p(),r=w(),u=w();return function(P){if(i=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(i),e=this._myTeleportParams.myPlayerHeadManager.getTransformFeetQuat(e),t=e.quat2_getRotationQuat(t),t=t.quat_rotateAxis(this._myTeleportRuntimeParams.myTeleportRotationOnUp,i,t),a=this._myTeleportRuntimeParams.myTeleportPosition.vec3_add(i.vec3_scale(this._myTeleportParams.myVisualizerParams.myTeleportParablePositionUpOffset,a),a),l=t.quat_getForward(l),this._myTeleportParams.myVisualizerParams.myTeleportPositionObjectRotateWithHead||(n=this._myDetectionRuntimeParams.myParable.getPosition(0,n),o=this._myDetectionRuntimeParams.myParable.getPosition(1,o),s=o.vec3_sub(n,s).vec3_removeComponentAlongAxis(i,s),s.vec3_length()>Math.PP_EPSILON&&(l=s.vec3_normalize(l))),this._myTeleportParams.myVisualizerParams.myTeleportParablePositionVisualAlignOnSurface?h.quat_setUp(this._myDetectionRuntimeParams.myTeleportSurfaceNormal,l):h.quat_setUp(i,l),this._myVisualTeleportTransformQuat.quat2_setPositionRotationQuat(a,h),this._myVisualTeleportTransformQuatReset||!this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionLerpEnabled)this._myVisualTeleportPositionObject.pp_setTransformQuat(this._myVisualTeleportTransformQuat),this._myVisualTeleportTransformQuatReset=!1;else{_=this._myVisualTeleportPositionObject.pp_getTransformQuat(_),y=_.quat2_getPosition(y),r=_.quat2_getRotationQuat(r),r.quat_rotationToQuat(h,u);let C=y.vec3_distance(a),f=u.quat_getAngle();if((!this._myVisualTeleportTransformPositionLerping||C<this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMinDistanceToResetLerp)&&(C<this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMinDistanceToLerp||C>this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMaxDistanceToLerp))this._myVisualTeleportTransformPositionLerping=!1,y.vec3_copy(a);else{this._myVisualTeleportTransformPositionLerping=!0;let S=this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionLerpFactor*P;C<this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMinDistanceToCloseLerpFactor&&(S=this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionCloseLerpFactor*P),y.vec3_lerp(a,S,y)}if((!this._myVisualTeleportTransformRotationLerping||f<this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMinAngleDistanceToResetLerp)&&(f<this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMinAngleDistanceToLerp||C>this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMaxAngleDistanceToLerp))this._myVisualTeleportTransformRotationLerping=!1,r.quat_copy(h);else{let S=this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionLerpFactor*P;this._myVisualTeleportTransformRotationLerping=!0,r.quat_slerp(h,S,r)}_.quat2_setPositionRotationQuat(y,r),this._myVisualTeleportPositionObject.pp_setTransformQuat(_)}{let C=this._myValidVisualTeleportPositionTorus.getParams();C.myRadius=.175,C.mySegmentsAmount=24,C.mySegmentThickness=.02,this._myValidVisualTeleportPositionTorus.paramsUpdated()}{let C=this._myValidVisualTeleportPositionTorusInner.getParams();C.myRadius=.04,C.mySegmentsAmount=24,C.mySegmentThickness=.02,this._myValidVisualTeleportPositionTorusInner.paramsUpdated()}this._myTeleportParams.myVisualizerParams.myTeleportPositionObject==null?(this._myValidVisualTeleportPositionTorus.setVisible(!0),this._myValidVisualTeleportPositionTorusInner.setVisible(!0)):(this._myValidVisualTeleportPositionTorus.setVisible(!1),this._myValidVisualTeleportPositionTorusInner.setVisible(!1),this._myTeleportParams.myVisualizerParams.myTeleportPositionObject.pp_setActive(!0)),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugShowEnabled&&m.isDebugEnabled(this._myTeleportParams.myEngine)&&m.getDebugVisualManager(this._myTeleportParams.myEngine).drawPoint(0,this._myTeleportRuntimeParams.myTeleportPosition,F(0,0,1,1),.02)}}();var Ht=class{constructor(){this._myStartPosition=p(),this._myForward=p(),this._myUp=p(),this._mySpeed=0,this._myGravity=0,this._myStepLength=0}setStartPosition(e){this._myStartPosition.vec3_copy(e)}setForward(e){this._myForward.vec3_copy(e)}setUp(e){this._myUp.vec3_copy(e)}setSpeed(e){this._mySpeed=e}setGravity(e){this._myGravity=e}setStepLength(e){this._myStepLength=e}getPosition(e,t=p()){}getDistance(e){}getPositionIndexByDistance(e){}getPositionByDistance(e,t=p()){}getDistanceOverFlatDistance(e,t){}getFlatDistanceOverDistance(e){}};Ht.prototype.getPosition=function(){let i=p(),e=p();return function(n,o=p()){let a=this._myStepLength/this._mySpeed*n;return i=this._myForward.vec3_scale(this._mySpeed*a,i),i=i.vec3_add(this._myStartPosition,i),e=this._myUp.vec3_scale(this._myGravity*a*a/2,e),o=i.vec3_add(e,o),o}}();Ht.prototype.getDistance=function(){let i=p(),e=p();return function(n){let o=0;e.vec3_copy(this._myStartPosition);for(let s=1;s<=n;s++)i=this.getPosition(s,i),o+=i.vec3_distance(e),e.vec3_copy(i);return o}}();Ht.prototype.getPositionIndexByDistance=function(){let i=p(),e=p();return function(n){let o=0,s=0;for(e=this.getPosition(s,e);o<n;)i=this.getPosition(s+1,i),o+=i.vec3_distance(e),s++,e.vec3_copy(i);return Math.max(0,s-1)}}();Ht.prototype.getPositionByDistance=function(){let i=p(),e=p(),t=p();return function(o,s=p()){let a=0,l=0,h=!1;for(e=this.getPosition(l,e);!h;){if(i=this.getPosition(l+1,i),a+=i.vec3_distance(e),l++,a>o){let _=a-o;t=i.vec3_sub(e,t);let y=t.vec3_length()-_;t.vec3_normalize(t),s=e.vec3_add(t.vec3_scale(y,s),s),h=!0}e.vec3_copy(i)}return s}}();Ht.prototype.getDistanceOverFlatDistance=function(){let i=p(),e=p(),t=p(),n=p(),o=p(),s=p();return function(l,h){if(l<1e-5)return 0;let _=0,y=0;t=this._myStartPosition.vec3_removeComponentAlongAxis(this._myUp,t),n=this.getPosition(y,n);let r=0;for(;_<=h;){i=this.getPosition(y+1,i),_+=i.vec3_distance(n),y++,e=i.vec3_removeComponentAlongAxis(this._myUp,e),s=e.vec3_sub(t,s);let u=s.vec3_length();if(u>=l){let g=u-l;o=i.vec3_sub(n,o);let P=o.vec3_angleRadians(s),C=Math.cos(P),f=o.vec3_length();C!=0&&(f=g/Math.cos(P)),r=_-f;break}else r=_;n.vec3_copy(i)}return Math.min(h,r)}}();Ht.prototype.getFlatDistanceOverDistance=function(){let i=p(),e=p(),t=p();return function(o){return i=this.getPositionByDistance(o,i),e=i.vec3_removeComponentAlongAxis(this._myUp,e),t=this._myStartPosition.vec3_removeComponentAlongAxis(this._myUp,t),t.vec3_distance(e)}}();var Pt=class extends Zi{constructor(e,t,n){super(),this._myLocomotionRuntimeParams=n,this._myTeleportParams=e,this._myTeleportRuntimeParams=t,this._myTeleportAsMovementFailed=!1}};Pt.prototype._checkTeleport=function(){return function(e,t,n,o=null){Q.getCollisionCheck(this._myTeleportParams.myEngine).teleport(e,t,this._myTeleportParams.myCollisionCheckParams,n),o?.copy(n)}}();Pt.prototype._checkTeleportAsMovement=function(){let i=new de,e=w(),t=p(),n=p(),o=p(),s=w(),a=G(),l=p(),h=p(),_=p(),y=p(),r=p(),u=G();return function(P,C,f,S){if(t=C.quat2_getPosition(t),e=C.quat2_getRotationQuat(e),n=e.quat_getUp(n),o=P.vec3_sub(t,o).vec3_removeComponentAlongAxis(n,o),o.vec3_normalize(o),o.vec3_isZero(1e-5)&&(o=e.quat_getForward(o)),s.quat_setUp(n,o),a.quat2_setPositionRotationQuat(t,s),this._checkTeleport(P,a,f,S),!f.myTeleportCanceled){let M=!1;i.copy(f),h.vec3_copy(f.myNewPosition),l.vec3_copy(t);for(let D=0;D<this._myTeleportParams.myTeleportAsMovementMaxSteps;D++){if(_=h.vec3_sub(l,_),this._myTeleportParams.myTeleportAsMovementRemoveVerticalMovement&&(_=_.vec3_removeComponentAlongAxis(n,_)),this._myTeleportParams.myTeleportAsMovementExtraVerticalMovementPerMeter!=0){let b=_.vec3_length()*this._myTeleportParams.myTeleportAsMovementExtraVerticalMovementPerMeter;y=n.vec3_scale(b,y),_=_.vec3_add(y,_)}if(u.quat2_setPositionRotationQuat(l,e),Q.getCollisionCheck(this._myTeleportParams.myEngine).move(_,u,this._myTeleportParams.myCollisionCheckParams,i),!i.myHorizontalMovementCanceled&&!i.myVerticalMovementCanceled)if(r=h.vec3_sub(i.myNewPosition,r),r.vec3_length()<this._myTeleportParams.myTeleportAsMovementMaxDistanceFromTeleportPosition+1e-5){M=!0;break}else _.vec3_copy(r),l.vec3_copy(i.myNewPosition);else break}M||(f.myTeleportCanceled=!0),this._myTeleportAsMovementFailed=!M}}}();Pt.prototype._teleportToPosition=function(){let i=p(),e=G(),t=G(),n=w(),o=w();return function(a,l,h,_=!1){this._myTeleportAsMovementFailed=!1,i=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(i),e=this._myTeleportParams.myPlayerHeadManager.getTransformFeetQuat(e),n=e.quat2_getRotationQuat(n),l!=0&&(n=n.quat_rotateAxis(l,i,n)),t.quat2_setPositionRotationQuat(a,n),m.getGamepads(this._myTeleportParams.myEngine)[ie.getOppositeHandedness(this._myTeleportParams.myHandedness)].getButtonInfo(E.BOTTOM_BUTTON).isPressed()?(Q.getCollisionCheck(this._myTeleportParams.myEngine).positionCheck(!0,t,this._myTeleportParams.myCollisionCheckParams,h),this._myTeleportParams.myPlayerHeadManager.teleportPositionFeet(a),l!=0&&(o.quat_fromAxis(l,i),this._myTeleportParams.myPlayerHeadManager.rotateFeetQuat(o))):this._myTeleportParams.myPlayerTransformManager.teleportTransformQuat(t,h,_)}}();var qs=class{constructor(){this.myMaxDistance=0,this.myMaxHeightDifference=0,this.myGroundAngleToIgnoreUpward=0,this.myMustBeOnGround=!1,this.myTeleportBlockLayerFlags=new Ve,this.myTeleportFloorLayerFlags=new Ve,this.myParableForwardMinAngleToBeValidUp=30,this.myParableForwardMinAngleToBeValidDown=0,this.myTeleportParableStartReferenceObject=null,this.myTeleportParableStartPositionOffset=p(0,-.04,.08),this.myTeleportParableStartRotationOffset=p(30,0,0),this.myTeleportParableSpeed=15,this.myTeleportParableGravity=-30,this.myTeleportParableStepLength=.25,this.myRotationOnUpMinStickIntensity=.5,this.myRotationOnUpEnabled=!1,this.myTeleportFeetPositionMustBeVisible=!1,this.myTeleportHeadPositionMustBeVisible=!1,this.myTeleportHeadOrFeetPositionMustBeVisible=!1,this.myVisibilityCheckRadius=.05,this.myVisibilityCheckFeetPositionVerticalOffset=.1,this.myVisibilityCheckDistanceFromHitThreshold=.1,this.myVisibilityCheckCircumferenceSliceAmount=6,this.myVisibilityCheckCircumferenceStepAmount=1,this.myVisibilityCheckCircumferenceRotationPerStep=30,this.myVisibilityBlockLayerFlags=new Ve}},jr=class{constructor(){this.myTeleportDetectionValid=!1,this.myTeleportPositionValid=!1,this.myTeleportSurfaceNormal=p(),this.myParable=new Ht}},pt=class extends Pt{constructor(e,t,n){super(e,t,n),this._myDetectionRuntimeParams=new jr,this._myVisualizer=new Ri(this._myTeleportParams,this._myTeleportRuntimeParams,this._myDetectionRuntimeParams),this._myTeleportRotationOnUpNext=0,this._myDestroyed=!1}start(){this._myLocomotionRuntimeParams.myIsTeleportDetecting=!0,this._myTeleportRuntimeParams.myTeleportRotationOnUp=0,this._myTeleportRotationOnUpNext=0,this._myDetectionRuntimeParams.myParable.setSpeed(this._myTeleportParams.myDetectionParams.myTeleportParableSpeed),this._myDetectionRuntimeParams.myParable.setGravity(this._myTeleportParams.myDetectionParams.myTeleportParableGravity),this._myDetectionRuntimeParams.myParable.setStepLength(this._myTeleportParams.myDetectionParams.myTeleportParableStepLength),this._myTeleportParams.myPlayerTransformManager.resetReal(),this._myVisualizer.start()}end(){this._myLocomotionRuntimeParams.myIsTeleportDetecting=!1,this._myVisualizer.end()}update(e,t){this._detectTeleportPosition(),this._myVisualizer.update(e),this._confirmTeleport()?this._myDetectionRuntimeParams.myTeleportPositionValid?t.perform("teleport"):t.perform("cancel"):this._cancelTeleport()&&t.perform("cancel")}_confirmTeleport(){let e=!1;return O.isSessionActive(this._myTeleportParams.myEngine)?m.getGamepads(this._myTeleportParams.myEngine)[this._myTeleportParams.myHandedness].getAxesInfo(ne.THUMBSTICK).getAxes().vec2_length()<=this._myTeleportParams.myStickIdleThreshold&&(e=!0):m.getMouse(this._myTeleportParams.myEngine).isInsideView()&&(e=m.getMouse(this._myTeleportParams.myEngine).isButtonPressEnd(ci.MIDDLE)),e}_cancelTeleport(){let e=!1;return O.isSessionActive(this._myTeleportParams.myEngine)?e=m.getGamepads(this._myTeleportParams.myEngine)[this._myTeleportParams.myHandedness].getButtonInfo(E.THUMBSTICK).isPressed():e=m.getMouse(this._myTeleportParams.myEngine).isButtonPressEnd(ci.RIGHT)||!m.getMouse(this._myTeleportParams.myEngine).isInsideView(),e}_detectTeleportPosition(){O.isSessionActive(this._myTeleportParams.myEngine)?(this._detectTeleportRotationVR(),this._detectTeleportPositionVR()):(this._myTeleportRuntimeParams.myTeleportRotationOnUp=0,this._myTeleportRotationOnUpNext=0,this._detectTeleportPositionNonVR())}destroy(){this._myDestroyed=!0,this._myVisualizer.destroy()}isDestroyed(){return this._myDestroyed}};pt.prototype._detectTeleportPositionNonVR=function(){let i=p(),e=p(),t=p();return function(o){this._myDetectionRuntimeParams.myTeleportPositionValid=!1,this._myDetectionRuntimeParams.myTeleportDetectionValid=!0,t=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(t),m.getMouse(this._myTeleportParams.myEngine).getOriginWorld(i),m.getMouse(this._myTeleportParams.myEngine).getDirectionWorld(e),this._detectTeleportPositionParable(i,e,t)}}();pt.prototype._detectTeleportPositionVR=function(){let i=G(),e=G(),t=p(),n=p(),o=p(),s=p();return function(l){if(this._myDetectionRuntimeParams.myTeleportPositionValid=!1,this._myDetectionRuntimeParams.myTeleportDetectionValid=!1,this._myTeleportParams.myDetectionParams.myTeleportParableStartReferenceObject==null){let h=m.getPlayerObjects(this._myTeleportParams.myEngine).myHands[this._myTeleportParams.myHandedness];i.quat2_setPositionRotationDegrees(this._myTeleportParams.myDetectionParams.myTeleportParableStartPositionOffset,this._myTeleportParams.myDetectionParams.myTeleportParableStartRotationOffset),e=h.pp_convertTransformObjectToWorldQuat(i,e)}else this._myTeleportParams.myDetectionParams.myTeleportParableStartReferenceObject.pp_getTransformQuat(e);t=e.quat2_getPosition(t),n=e.quat2_getForward(n),o=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(o),s=o.vec3_negate(s),n.vec3_angle(o)>=this._myTeleportParams.myDetectionParams.myParableForwardMinAngleToBeValidUp&&n.vec3_angle(s)>=this._myTeleportParams.myDetectionParams.myParableForwardMinAngleToBeValidDown&&(this._myDetectionRuntimeParams.myTeleportDetectionValid=!0),this._myDetectionRuntimeParams.myTeleportDetectionValid&&this._detectTeleportPositionParable(t,n,o)}}();pt.prototype._detectTeleportPositionParable=function(){let i=p(),e=p(),t=p(),n=new ut,o=new ke,s=p(),a=p(),l=p(),h=p(),_=p(),y=p(),r=p(),u=new de,g=(P,C)=>P.pp_equals(C);return function(C,f,S){this._myDetectionRuntimeParams.myParable.setStartPosition(C),this._myDetectionRuntimeParams.myParable.setForward(f),this._myDetectionRuntimeParams.myParable.setUp(S);let M=1,D=0,v=0;e=this._myDetectionRuntimeParams.myParable.getPosition(M-1,e),n.myIgnoreHitsInsideCollision=!0,n.myBlockLayerFlags.setMask(this._myTeleportParams.myDetectionParams.myTeleportBlockLayerFlags.getMask()),n.myPhysics=m.getPhysics(this._myTeleportParams.myEngine),n.myObjectsToIgnore.pp_copy(this._myTeleportParams.myCollisionCheckParams.myHorizontalObjectsToIgnore);for(let U of this._myTeleportParams.myCollisionCheckParams.myVerticalObjectsToIgnore)n.myObjectsToIgnore.pp_pushUnique(U,g);let b=this._myTeleportParams.myDetectionParams.myMaxDistance*2;do i=this._myDetectionRuntimeParams.myParable.getPosition(M,i),n.myOrigin.vec3_copy(e),n.myDirection=i.vec3_sub(e,n.myDirection),n.myDistance=n.myDirection.vec3_length(),n.myDirection.vec3_normalize(n.myDirection),o=De.raycast(n,o),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugDetectEnabled&&m.isDebugEnabled(this._myTeleportParams.myEngine)&&m.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,o),e.vec3_copy(i),D=i.vec3_sub(C,i).vec3_removeComponentAlongAxis(S,i).vec3_length(),v=this._myDetectionRuntimeParams.myParable.getDistance(M),M++;while(D<=this._myTeleportParams.myDetectionParams.myMaxDistance&&v<=b&&!o.isColliding());let x=this._myDetectionRuntimeParams.myParable.getDistanceOverFlatDistance(this._myTeleportParams.myDetectionParams.myMaxDistance,b),I=v;(v>x||v>b)&&(I=Math.min(x,b)),this._myDetectionRuntimeParams.myParableDistance=I;let L=!1,k=100;if(o.isColliding()){let U=o.myHits.pp_first(),ye=v-(n.myDistance-U.myDistance);if(ye<=I&&(L=!0,this._myDetectionRuntimeParams.myParableDistance=ye,u.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(U,this._myTeleportRuntimeParams.myTeleportRotationOnUp,u),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(u.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(u.myGroundNormal),s.vec3_copy(U.myPosition),a.vec3_copy(U.myNormal),!this._myDetectionRuntimeParams.myTeleportPositionValid&&!this._myTeleportAsMovementFailed&&(l=U.myPosition.vec3_add(U.myNormal.vec3_scale(.01,l),l),h=S.vec3_negate(h),n.myOrigin.vec3_copy(l),n.myDirection.vec3_copy(h),n.myDistance=k,o=De.raycast(n,o),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugDetectEnabled&&m.isDebugEnabled(this._myTeleportParams.myEngine)&&m.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,o),o.isColliding()))){let le=o.myHits.pp_first();if(u.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(le,this._myTeleportRuntimeParams.myTeleportRotationOnUp,u),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(u.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(u.myGroundNormal),!this._myDetectionRuntimeParams.myTeleportPositionValid&&!this._myTeleportAsMovementFailed&&u.myTeleportCanceled&&u.myIsCollidingHorizontally&&(_=u.myHorizontalCollisionHit.myNormal.vec3_removeComponentAlongAxis(S,_),!_.vec3_isZero(1e-5))){_.vec3_normalize(_);let Te=this._myTeleportParams.myCollisionCheckParams.myRadius*1.1;if(n.myOrigin=l.vec3_add(_.vec3_scale(Te,n.myOrigin),n.myOrigin),n.myDirection.vec3_copy(h),n.myDistance=k,o=De.raycast(n,o),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugDetectEnabled&&m.isDebugEnabled(this._myTeleportParams.myEngine)&&(m.getDebugVisualManager(this._myTeleportParams.myEngine).drawPoint(0,n.myOrigin,F(0,0,0,1),.03),m.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,o)),o.isColliding()){let Be=o.myHits.pp_first();u.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(Be,this._myTeleportRuntimeParams.myTeleportRotationOnUp,u),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(u.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(u.myGroundNormal)}}if(!this._myDetectionRuntimeParams.myTeleportPositionValid&&!this._myTeleportAsMovementFailed&&(y=a.vec3_removeComponentAlongAxis(S,y),!y.vec3_isZero(1e-5))){y.vec3_normalize(y);let Te=this._myTeleportParams.myCollisionCheckParams.myRadius*1.1;if(n.myOrigin=l.vec3_add(y.vec3_scale(Te,n.myOrigin),n.myOrigin),n.myDirection.vec3_copy(h),n.myDistance=k,o=De.raycast(n,o),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugDetectEnabled&&m.isDebugEnabled(this._myTeleportParams.myEngine)&&(m.getDebugVisualManager(this._myTeleportParams.myEngine).drawPoint(0,n.myOrigin,F(0,0,0,1),.03),m.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,o)),o.isColliding()){let Be=o.myHits.pp_first();u.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(Be,this._myTeleportRuntimeParams.myTeleportRotationOnUp,u),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(u.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(u.myGroundNormal)}}if(!this._myDetectionRuntimeParams.myTeleportPositionValid&&!this._myTeleportAsMovementFailed&&(r=f.vec3_negate(r).vec3_removeComponentAlongAxis(S,r).vec3_normalize(r),!r.vec3_isZero(1e-5))){r.vec3_normalize(r);let Te=this._myTeleportParams.myCollisionCheckParams.myRadius*1.1;if(n.myOrigin=l.vec3_add(r.vec3_scale(Te,n.myOrigin),n.myOrigin),n.myDirection.vec3_copy(h),n.myDistance=k,o=De.raycast(n,o),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugDetectEnabled&&m.isDebugEnabled(this._myTeleportParams.myEngine)&&(m.getDebugVisualManager(this._myTeleportParams.myEngine).drawPoint(0,n.myOrigin,F(0,0,0,1),.03),m.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,o)),o.isColliding()){let Be=o.myHits.pp_first();u.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(Be,this._myTeleportRuntimeParams.myTeleportRotationOnUp,u),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(u.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(u.myGroundNormal)}}}}if(!L&&(t=this._myDetectionRuntimeParams.myParable.getPositionByDistance(this._myDetectionRuntimeParams.myParableDistance,t),l.vec3_copy(t),h=S.vec3_negate(h),n.myOrigin.vec3_copy(l),n.myDirection.vec3_copy(h),n.myDistance=k,o=De.raycast(n,o),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugDetectEnabled&&m.isDebugEnabled(this._myTeleportParams.myEngine)&&m.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,o),o.isColliding())){let U=o.myHits.pp_first();if(u.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(U,this._myTeleportRuntimeParams.myTeleportRotationOnUp,u),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(u.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(u.myGroundNormal),!this._myDetectionRuntimeParams.myTeleportPositionValid&&!this._myTeleportAsMovementFailed&&u.myTeleportCanceled&&u.myIsCollidingHorizontally&&(_=u.myHorizontalCollisionHit.myNormal.vec3_removeComponentAlongAxis(S,_),!_.vec3_isZero(1e-5))){_.vec3_normalize(_);let ye=this._myTeleportParams.myCollisionCheckParams.myRadius*1.1;if(n.myOrigin=l.vec3_add(_.vec3_scale(ye,n.myOrigin),n.myOrigin),n.myDirection.vec3_copy(h),n.myDistance=k,o=De.raycast(n,o),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugDetectEnabled&&m.isDebugEnabled(this._myTeleportParams.myEngine)&&(m.getDebugVisualManager(this._myTeleportParams.myEngine).drawPoint(0,n.myOrigin,F(0,0,0,1),.03),m.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,o)),o.isColliding()){let le=o.myHits.pp_first();u.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(le,this._myTeleportRuntimeParams.myTeleportRotationOnUp,u),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(u.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(u.myGroundNormal)}}if(!this._myDetectionRuntimeParams.myTeleportPositionValid&&!this._myTeleportAsMovementFailed&&(r=f.vec3_negate(r).vec3_removeComponentAlongAxis(S,r).vec3_normalize(r),!r.vec3_isZero(1e-5))){r.vec3_normalize(r);let ye=this._myTeleportParams.myCollisionCheckParams.myRadius*1.1;if(n.myOrigin=l.vec3_add(r.vec3_scale(ye,n.myOrigin),n.myOrigin),n.myDirection.vec3_copy(h),n.myDistance=k,o=De.raycast(n,o),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugDetectEnabled&&m.isDebugEnabled(this._myTeleportParams.myEngine)&&(m.getDebugVisualManager(this._myTeleportParams.myEngine).drawPoint(0,n.myOrigin,F(0,0,0,1),.03),m.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,o)),o.isColliding()){let le=o.myHits.pp_first();u.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(le,this._myTeleportRuntimeParams.myTeleportRotationOnUp,u),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(u.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(u.myGroundNormal)}}}}}();pt.prototype._detectTeleportRotationVR=function(){let i=p(),e=p(0,0,1),t=p(0,1,0);return function(o){let s=m.getGamepads(this._myTeleportParams.myEngine)[this._myTeleportParams.myHandedness].getAxesInfo(ne.THUMBSTICK).getAxes();s.vec2_length()>this._myTeleportParams.myDetectionParams.myRotationOnUpMinStickIntensity&&(this._myTeleportRuntimeParams.myTeleportRotationOnUp=this._myTeleportRotationOnUpNext,i.vec3_set(s[0],0,s[1]),this._myTeleportRotationOnUpNext=i.vec3_angleSigned(e,t)),this._myTeleportParams.myDetectionParams.myRotationOnUpEnabled||(this._myTeleportRuntimeParams.myTeleportRotationOnUp=0,this._myTeleportRotationOnUpNext=0)}}();pt.prototype._isTeleportHitValid=function(){let i=new ut,e=new ke,t=p(),n=(o,s)=>o.pp_equals(s);return function(s,a,l){let h=!1;if(this._myTeleportAsMovementFailed=!1,s.isValid()&&!s.myInsideCollision){t=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(t);let _=!0;if(s.myNormal.vec3_isConcordant(t)||_){i.myIgnoreHitsInsideCollision=!0,i.myBlockLayerFlags.setMask(this._myTeleportParams.myDetectionParams.myTeleportFloorLayerFlags.getMask()),i.myPhysics=m.getPhysics(this._myTeleportParams.myEngine),i.myObjectsToIgnore.pp_copy(this._myTeleportParams.myCollisionCheckParams.myHorizontalObjectsToIgnore);for(let r of this._myTeleportParams.myCollisionCheckParams.myVerticalObjectsToIgnore)i.myObjectsToIgnore.pp_pushUnique(r,n);let y=.01;i.myOrigin=s.myPosition.vec3_add(s.myNormal.vec3_scale(y,i.myOrigin),i.myOrigin),i.myDirection=s.myNormal.vec3_negate(i.myDirection),i.myDistance=y*1.25,i.myDirection.vec3_normalize(i.myDirection),e=De.raycast(i,e),e.isColliding()&&e.myHits.pp_first().myObject.pp_equals(s.myObject)&&(h=this._isTeleportPositionValid(s.myPosition,a,l))}}return h}}();pt.prototype._isTeleportPositionValid=function(){let i=p(),e=G(),t=w(),n=p(),o=p(),s=new de;return function(l,h,_){let y=!1;if(this._isTeleportPositionVisible(l)&&(i=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(i),e=this._myTeleportParams.myPlayerHeadManager.getTransformFeetQuat(e),n=e.quat2_getPosition(n),h!=0&&(t=e.quat2_getRotationQuat(t),t=t.quat_rotateAxis(h,i,t),e.quat2_setPositionRotationQuat(n,t)),l.vec3_sub(n,o).vec3_componentAlongAxis(i,o).vec3_length()<this._myTeleportParams.myDetectionParams.myMaxHeightDifference+1e-5)){let g=!1;if(s.copy(this._myLocomotionRuntimeParams.myCollisionRuntimeParams),this._myTeleportParams.myPerformTeleportAsMovement?this._checkTeleportAsMovement(l,e,s,_):this._checkTeleport(l,e,s,_),s.myTeleportCanceled||(g=!0),g&&(!this._myTeleportParams.myDetectionParams.myMustBeOnGround||s.myIsOnGround)){let P=!0;s.myNewPosition.vec3_isFartherAlongAxis(n,i)&&(P=s.myGroundAngle<this._myTeleportParams.myDetectionParams.myGroundAngleToIgnoreUpward+1e-4),P&&(y=!0)}}return y}}();import{MeshComponent as BR}from"@wonderlandengine/api";var Xs=class extends Pt{constructor(e,t,n){super(e,t,n),this._myBlinkSphere=m.getPlayerObjects(this._myTeleportParams.myEngine).myCauldron.pp_addObject(),this._myBlinkSphereMeshComponent=this._myBlinkSphere.pp_addComponent(BR),this._myBlinkSphereMeshComponent.mesh=m.getDefaultMeshes(this._myTeleportParams.myEngine).myInvertedSphere,this._myBlinkSphereMeshComponent.material=m.getDefaultMaterials(this._myTeleportParams.myEngine).myFlatTransparentNoDepth.clone(),this._myBlinkSphereMaterialColor=F(this._myTeleportParams.myTeleportParams.myBlinkSphereColor[0]/255,this._myTeleportParams.myTeleportParams.myBlinkSphereColor[1]/255,this._myTeleportParams.myTeleportParams.myBlinkSphereColor[2]/255,0),this._myBlinkSphereMeshComponent.material.color=this._myBlinkSphereMaterialColor,this._myBlinkSphere.pp_resetTransformLocal(),this._myBlinkSphere.pp_setScaleLocal(this._myTeleportParams.myTeleportParams.myBlinkSphereScale),this._myBlinkSphere.pp_setActive(!1),this._myFSM=new ct,this._myFSM.addState("init"),this._myFSM.addState("idle"),this._myFSM.addState("fade_out",this._fadeOutUpdate.bind(this)),this._myFSM.addState("wait",new Ss(this._myTeleportParams.myTeleportParams.myBlinkWaitSeconds,"done")),this._myFSM.addState("fade_in",this._fadeInUpdate.bind(this)),this._myFSM.addTransition("init","idle","start"),this._myFSM.addTransition("idle","fade_out","teleport",this._startFadeOut.bind(this)),this._myFSM.addTransition("fade_out","wait","done",this._teleport.bind(this)),this._myFSM.addTransition("wait","fade_in","done",this._startFadeIn.bind(this)),this._myFSM.addTransition("fade_in","idle","done",this._teleportDone.bind(this)),this._myFSM.addTransition("idle","idle","stop"),this._myFSM.addTransition("fade_out","idle","stop",this._stop.bind(this,!0)),this._myFSM.addTransition("wait","idle","stop",this._stop.bind(this,!1)),this._myFSM.addTransition("fade_in","idle","stop",this._stop.bind(this,!1)),this._myFSM.init("init"),this._myFSM.perform("start"),this._myFadeInTimer=new te(this._myTeleportParams.myTeleportParams.myBlinkFadeInSeconds),this._myFadeOutTimer=new te(this._myTeleportParams.myTeleportParams.myBlinkFadeOutSeconds),this._myFadeOutAlphaOverTime=new _i(0,1,0,1),this._myFadeInAlphaOverTime=new _i(1,0,0,1)}start(e){this._myParentFSM=e,this._myFSM.perform("teleport")}end(){this._myBlinkSphere.pp_setActive(!1),this._myBlinkSphere.pp_setParent(m.getPlayerObjects(this._myTeleportParams.myEngine).myCauldron,!1),this._myFSM.perform("stop")}update(e,t){this._myBlinkSphere.pp_setParent(this._myTeleportParams.myPlayerHeadManager.getHead(),!1),this._myBlinkSphere.pp_resetTransformLocal(),this._myFSM.update(e)}_startFadeOut(){this._myFadeOutTimer.start(),this._myBlinkSphereMaterialColor[3]=0,this._myBlinkSphereMeshComponent.material.color=this._myBlinkSphereMaterialColor,this._myBlinkSphere.pp_setActive(!0),this._myLocomotionRuntimeParams.myIsTeleporting=!0}_startFadeIn(){this._myFadeInTimer.start()}_fadeOutUpdate(e,t){this._myFadeOutTimer.update(e);let n=this._myFadeOutAlphaOverTime.get(this._myFadeOutTimer.getPercentage());this._myBlinkSphereMaterialColor[3]=n,this._myBlinkSphereMeshComponent.material.color=this._myBlinkSphereMaterialColor,this._myFadeOutTimer.isDone()&&t.perform("done")}_fadeInUpdate(e,t){this._myFadeInTimer.update(e);let n=this._myFadeInAlphaOverTime.get(this._myFadeInTimer.getPercentage());this._myBlinkSphereMaterialColor[3]=n,this._myBlinkSphereMeshComponent.material.color=this._myBlinkSphereMaterialColor,this._myFadeInTimer.isDone()&&t.perform("done")}_teleportDone(){this._myBlinkSphere.pp_setActive(!1),this._myParentFSM.performDelayed("done")}_stop(e){this._myBlinkSphere.pp_setActive(!1),e&&this._teleport()}_teleport(){this._myLocomotionRuntimeParams.myIsTeleporting=!1,this._myLocomotionRuntimeParams.myTeleportJustPerformed=!0,this._teleportToPosition(this._myTeleportRuntimeParams.myTeleportPosition,this._myTeleportRuntimeParams.myTeleportRotationOnUp,this._myLocomotionRuntimeParams.myCollisionRuntimeParams)}};var sn=class extends Pt{constructor(e,t,n){super(e,t,n),this._myFSM=new ct,this._myFSM.addState("init"),this._myFSM.addState("idle"),this._myFSM.addState("shifting",this._shiftingUpdate.bind(this)),this._myFSM.addTransition("init","idle","start"),this._myFSM.addTransition("idle","shifting","teleport",this._startShifting.bind(this)),this._myFSM.addTransition("shifting","idle","done",this._teleportDone.bind(this)),this._myFSM.addTransition("idle","idle","stop"),this._myFSM.addTransition("shifting","idle","stop",this._stop.bind(this)),this._myFSM.init("init"),this._myFSM.perform("start"),this._myShiftMovementTimer=new te(this._myTeleportParams.myTeleportParams.myShiftMovementSeconds),this._myShiftRotateTimer=new te(this._myTeleportParams.myTeleportParams.myShiftRotateSeconds,!1),this._myFeetStartPosition=p(),this._myCurrentRotationOnUp=0,this._myStartRotationOnUp=0}start(e){this._myParentFSM=e,this._myFSM.perform("teleport")}end(){this._myFSM.perform("stop")}update(e,t){this._myFSM.update(e)}_startShifting(){if(this._myTeleportParams.myPlayerTransformManager.getParams().mySyncPositionDisabled=!0,this._myLocomotionRuntimeParams.myIsTeleporting=!0,this._myFeetStartPosition=this._myTeleportParams.myPlayerHeadManager.getPositionFeet(this._myFeetStartPosition),this._myShiftMovementTimer.start(this._myTeleportParams.myTeleportParams.myShiftMovementSeconds),this._myTeleportParams.myTeleportParams.myShiftMovementSecondsMultiplierOverDistanceFunction){let e=this._myTeleportRuntimeParams.myTeleportPosition.vec3_distance(this._myFeetStartPosition),t=this._myTeleportParams.myTeleportParams.myShiftMovementSecondsMultiplierOverDistanceFunction(e);this._myShiftMovementTimer.start(this._myTeleportParams.myTeleportParams.myShiftMovementSeconds*t)}if(this._myShiftRotateTimer.reset(this._myTeleportParams.myTeleportParams.myShiftRotateSeconds),this._myTeleportParams.myTeleportParams.myShiftRotateSecondsMultiplierOverAngleFunction){let e=this._myTeleportParams.myTeleportParams.myShiftRotateSecondsMultiplierOverAngleFunction(Math.abs(this._myTeleportRuntimeParams.myTeleportRotationOnUp));this._myShiftRotateTimer.reset(this._myTeleportParams.myTeleportParams.myShiftRotateSeconds*e)}this._myStartRotationOnUp=this._myTeleportRuntimeParams.myTeleportRotationOnUp,this._myCurrentRotationOnUp=0}_stop(){this._teleport()}_teleportDone(){this._teleport(),this._myParentFSM.performDelayed("done")}_teleport(){this._myTeleportParams.myPlayerTransformManager.getParams().mySyncPositionDisabled=!1,this._myLocomotionRuntimeParams.myIsTeleporting=!1,this._myLocomotionRuntimeParams.myTeleportJustPerformed=!0,this._teleportToPosition(this._myTeleportRuntimeParams.myTeleportPosition,this._myStartRotationOnUp-this._myCurrentRotationOnUp,this._myLocomotionRuntimeParams.myCollisionRuntimeParams)}};sn.prototype._shiftingUpdate=function(){let i=p(),e=p();return function(n,o){if(this._myShiftMovementTimer.update(n),this._myShiftRotateTimer.update(n),this._myShiftRotateTimer.isDone()&&this._myShiftMovementTimer.isDone())o.perform("done");else{if(e.vec3_copy(this._myTeleportRuntimeParams.myTeleportPosition),this._myShiftMovementTimer.isStarted()||this._myShiftMovementTimer.isJustDone()){let a=this._myTeleportParams.myTeleportParams.myShiftMovementEasingFunction(this._myShiftMovementTimer.getPercentage());a>=this._myTeleportParams.myTeleportParams.myShiftRotateStartAfterMovementPercentage&&!this._myShiftRotateTimer.isStarted()&&(this._myShiftRotateTimer.start(),this._myShiftRotateTimer.update(n)),i=this._myTeleportRuntimeParams.myTeleportPosition.vec3_sub(this._myFeetStartPosition,i),i.vec3_scale(a,i),e=this._myFeetStartPosition.vec3_add(i,e)}let s=0;if(this._myShiftRotateTimer.isRunning()||this._myShiftRotateTimer.isJustDone()){let a=this._myTeleportParams.myTeleportParams.myShiftRotateEasingFunction(this._myShiftRotateTimer.getPercentage()),l=this._myStartRotationOnUp*a;s=l-this._myCurrentRotationOnUp,this._myCurrentRotationOnUp=l}this._teleportToPosition(e,s,this._myLocomotionRuntimeParams.myCollisionRuntimeParams,!0)}}}();Object.defineProperty(sn.prototype,"_shiftingUpdate",{enumerable:!1});var an={INSTANT:0,BLINK:1,SHIFT:2},Ks=class{constructor(){this.myTeleportType=an.SHIFT,this.myBlinkFadeOutSeconds=.1,this.myBlinkFadeInSeconds=.1,this.myBlinkWaitSeconds=.1,this.myBlinkSphereColor=p(),this.myBlinkSphereScale=.1,this.myShiftMovementSeconds=.15,this.myShiftMovementSecondsMultiplierOverDistanceFunction=null,this.myShiftMovementEasingFunction=ue.easeInOut,this.myShiftRotateSeconds=1,this.myShiftRotateSecondsMultiplierOverAngleFunction=null,this.myShiftRotateEasingFunction=ue.easeOut,this.myShiftRotateStartAfterMovementPercentage=.7,this.myShiftRotateSecondsMultiplierOverAngleFunction=function(e){return ue.easeOut(e/180)}}},Js=class extends Pt{constructor(e,t,n){super(e,t,n),this._myFSM=new ct,this._myFSM.addState("init"),this._myFSM.addState("idle"),this._myBlinkState=new Xs(e,t,n),this._myShiftState=new sn(e,t,n),this._myFSM.addState("instant_teleport",this._instantUpdate.bind(this)),this._myFSM.addState("blink_teleport",this._myBlinkState),this._myFSM.addState("shift_teleport",this._myShiftState),this._myFSM.addTransition("init","idle","start"),this._myFSM.addTransition("idle","instant_teleport","start_instant"),this._myFSM.addTransition("idle","blink_teleport","start_blink"),this._myFSM.addTransition("idle","shift_teleport","start_shift"),this._myFSM.addTransition("instant_teleport","idle","done",this._teleportDone.bind(this)),this._myFSM.addTransition("blink_teleport","idle","done",this._teleportDone.bind(this)),this._myFSM.addTransition("shift_teleport","idle","done",this._teleportDone.bind(this)),this._myFSM.addTransition("idle","idle","stop"),this._myFSM.addTransition("instant_teleport","idle","stop",this._instantStop.bind(this)),this._myFSM.addTransition("blink_teleport","idle","stop"),this._myFSM.addTransition("shift_teleport","idle","stop"),this._myFSM.init("init"),this._myFSM.perform("start")}start(e){switch(this._myParentFSM=e,this._myTeleportParams.myTeleportParams.myTeleportType){case an.INSTANT:this._myFSM.perform("start_instant");break;case an.BLINK:this._myFSM.perform("start_blink");break;case an.SHIFT:this._myFSM.perform("start_shift");break;default:this._myFSM.perform("start_instant")}}end(){}update(e,t){this._myFSM.update(e)}completeTeleport(){this._myFSM.perform("stop"),this._teleportToPosition(this._myTeleportRuntimeParams.myTeleportPosition,this._myTeleportRuntimeParams.myTeleportRotationOnUp,this._myLocomotionRuntimeParams.myCollisionRuntimeParams)}_instantUpdate(e,t){this._teleportToPosition(this._myTeleportRuntimeParams.myTeleportPosition,this._myTeleportRuntimeParams.myTeleportRotationOnUp,this._myLocomotionRuntimeParams.myCollisionRuntimeParams),this._myLocomotionRuntimeParams.myTeleportJustPerformed=!0,t.perform("done")}_instantStop(e){this._instantUpdate(0,e)}_teleportDone(){this._myTeleportParams.myPlayerTransformManager.resetReal(),this._myParentFSM.performDelayed("done")}};var Zs=class{constructor(e=m.getMainEngine()){this.myPlayerHeadManager=null,this.myCollisionCheckParams=null,this.myDetectionParams=new qs,this.myVisualizerParams=new Qs,this.myTeleportParams=new Ks,this.myHandedness=A.LEFT,this.myPerformTeleportAsMovement=!1,this.myTeleportAsMovementMaxDistanceFromTeleportPosition=.001,this.myTeleportAsMovementMaxSteps=2,this.myTeleportAsMovementRemoveVerticalMovement=!0,this.myTeleportAsMovementExtraVerticalMovementPerMeter=1,this.myStickIdleThreshold=.1,this.myAdjustPositionEveryFrame=!1,this.myGravityAcceleration=0,this.myMaxGravitySpeed=0,this.myEngine=e,this.myDebugEnabled=!1,this.myDebugDetectEnabled=!1,this.myDebugShowEnabled=!1,this.myDebugVisibilityEnabled=!1}},zr=class{constructor(){this.myTeleportPosition=p(),this.myTeleportRotationOnUp=0}},io=class extends on{constructor(e,t){super(t),this._myTeleportParams=e,this._myTeleportRuntimeParams=new zr,this._myStickIdleCharge=!0,this._myDetectionState=new pt(this._myTeleportParams,this._myTeleportRuntimeParams,this._myLocomotionRuntimeParams),this._myTeleportState=new Js(this._myTeleportParams,this._myTeleportRuntimeParams,this._myLocomotionRuntimeParams),this._myFSM=new ct,this._myFSM.addState("init"),this._myFSM.addState("idle",this._idleUpdate.bind(this)),this._myFSM.addState("detect",this._myDetectionState),this._myFSM.addState("teleport",this._myTeleportState),this._myFSM.addTransition("init","idle","start"),this._myFSM.addTransition("idle","detect","detect"),this._myFSM.addTransition("detect","teleport","teleport"),this._myFSM.addTransition("detect","idle","cancel"),this._myFSM.addTransition("teleport","idle","done"),this._myFSM.addTransition("idle","idle","stop"),this._myFSM.addTransition("detect","idle","stop"),this._myFSM.addTransition("teleport","idle","stop",this._completeTeleport.bind(this)),this._myFSM.init("init"),this._myFSM.perform("start"),this._myDestroyed=!1}start(){}stop(){this._myFSM.perform("stop")}canStop(){return this._myFSM.isInState("idle")}getParams(){return this._myTeleportParams}getTeleportRuntimeParams(){return this._myTeleportRuntimeParams}update(e){this._myLocomotionRuntimeParams.myTeleportJustPerformed=!1,this._myFSM.update(e),!this._myLocomotionRuntimeParams.myIsTeleporting&&(this._myTeleportParams.myAdjustPositionEveryFrame||this._myTeleportParams.myGravityAcceleration!=0)&&this._applyGravity(e),this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnGround&&(this._myLocomotionRuntimeParams.myIsFlying=!1)}_idleUpdate(e){this._startDetecting()&&this._myFSM.perform("detect")}_startDetecting(){let e=!1;if(!O.isSessionActive(this._myTeleportParams.myEngine))e=m.getMouse(this._myTeleportParams.myEngine).isButtonPressStart(ci.MIDDLE)&&m.getMouse(this._myTeleportParams.myEngine).isTargetingRenderCanvas();else{let t=m.getGamepads(this._myTeleportParams.myEngine)[this._myTeleportParams.myHandedness].getAxesInfo(ne.THUMBSTICK).getAxes();t.vec2_length()<=this._myTeleportParams.myStickIdleThreshold&&(this._myStickIdleCharge=!0),this._myStickIdleCharge&&t[1]>=.75&&(this._myStickIdleCharge=!1,e=!0)}return e}_completeTeleport(){this._myTeleportState.completeTeleport()}destroy(){this._myDestroyed=!0,this._myDetectionState.destroy()}isDestroyed(){return this._myDestroyed}};io.prototype._applyGravity=function(){let i=p(),e=p(),t=G();return function(o){i=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(i),e.vec3_zero(),!this._myLocomotionRuntimeParams.myIsFlying&&!this._myLocomotionRuntimeParams.myIsTeleporting?(this._myLocomotionRuntimeParams.myGravitySpeed+=this._myTeleportParams.myGravityAcceleration*o,Math.abs(this._myLocomotionRuntimeParams.myGravitySpeed)>Math.abs(this._myTeleportParams.myMaxGravitySpeed)&&(this._myLocomotionRuntimeParams.myGravitySpeed=Math.pp_sign(this._myTeleportParams.myGravityAcceleration)*Math.abs(this._myTeleportParams.myMaxGravitySpeed)),e=i.vec3_scale(this._myLocomotionRuntimeParams.myGravitySpeed*o,e)):this._myLocomotionRuntimeParams.myGravitySpeed=0,t=this._myTeleportParams.myPlayerHeadManager.getTransformFeetQuat(t),Q.getCollisionCheck(this._myTeleportParams.myEngine).move(e,t,this._myTeleportParams.myCollisionCheckParams,this._myLocomotionRuntimeParams.myCollisionRuntimeParams),this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myVerticalMovementCanceled||this._myTeleportParams.myPlayerHeadManager.teleportPositionFeet(this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myNewPosition),(this._myLocomotionRuntimeParams.myGravitySpeed>0&&this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnCeiling||this._myLocomotionRuntimeParams.myGravitySpeed<0&&this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnGround)&&(this._myLocomotionRuntimeParams.myGravitySpeed=0)}}();var Gr={HEAD:0,HAND:1,CUSTOM_OBJECT:2},lm={SMOOTH:0,TELEPORT:1},Ys=class{constructor(e=m.getMainEngine()){this.myDefaultLocomotionType=lm.SMOOTH,this.mySwitchLocomotionTypeShortcutEnabled=!0,this.myDefaultHeight=0,this.myMaxSpeed=0,this.myMaxRotationSpeed=0,this.myGravityAcceleration=0,this.myMaxGravitySpeed=0,this.myCharacterRadius=0,this.mySpeedSlowDownPercentageOnWallSlid=1,this.myIsSnapTurn=!1,this.mySnapTurnOnlyVR=!1,this.mySnapTurnAngle=0,this.mySnapTurnSpeedDegrees=0,this.myFlyEnabled=!1,this.myStartFlying=!1,this.myMinAngleToFlyUpNonVR=0,this.myMinAngleToFlyDownNonVR=0,this.myMinAngleToFlyUpVR=0,this.myMinAngleToFlyDownVR=0,this.myMinAngleToFlyRight=0,this.myMainHand=A.LEFT,this.myDirectionInvertForwardWhenUpsideDown=!0,this.myVRDirectionReferenceType=Gr.HEAD,this.myVRDirectionReferenceObject=null,this.myForeheadExtraHeight=0,this.myTeleportType=an.INSTANT,this.myTeleportMaxDistance=0,this.myTeleportMaxHeightDifference=0,this.myTeleportRotationOnUpEnabled=null,this.myTeleportValidMaterial=null,this.myTeleportInvalidMaterial=null,this.myTeleportPositionObject=null,this.myTeleportPositionObjectRotateWithHead=null,this.myTeleportParableStartReferenceObject=null,this.mySyncWithRealWorldPositionOnlyIfValid=!0,this.myViewOcclusionInsideWallsEnabled=!0,this.myColliderAccuracy=null,this.myColliderCheckOnlyFeet=!1,this.myColliderSlideAlongWall=!1,this.myColliderMaxWalkableGroundAngle=0,this.myColliderSnapOnGround=!1,this.myColliderMaxDistanceToSnapOnGround=0,this.myColliderMaxWalkableGroundStepHeight=0,this.myColliderPreventFallingFromEdges=!1,this.myDebugHorizontalEnabled=!1,this.myDebugVerticalEnabled=!1,this.myMoveThroughCollisionShortcutEnabled=!1,this.myMoveHeadShortcutEnabled=!1,this.myTripleSpeedShortcutEnabled=!1,this.myPhysicsBlockLayerFlags=new Ve,this.myEngine=e}},$s=class{constructor(e){this._myParams=e,this._myCollisionCheckParamsMovement=new et,this._setupCollisionCheckParamsMovement(),this._myCollisionCheckParamsTeleport=null,this._setupCollisionCheckParamsTeleport(),this._myCollisionRuntimeParams=new de,this._myMovementRuntimeParams=new Ns,this._myMovementRuntimeParams.myIsFlying=this._myParams.myStartFlying,this._myMovementRuntimeParams.myCollisionRuntimeParams=this._myCollisionRuntimeParams;{let t=new to(this._myParams.myEngine);t.mySessionChangeResyncEnabled=!0,t.myBlurEndResyncEnabled=!0,t.myBlurEndResyncRotation=!0,t.myEnterSessionResyncHeight=!1,t.myExitSessionResyncHeight=!1,t.myExitSessionResyncVerticalAngle=!0,t.myExitSessionRemoveRightTilt=!0,t.myExitSessionAdjustMaxVerticalAngle=!0,t.myExitSessionMaxVerticalAngle=90,t.myHeightOffsetVRWithFloor=0,t.myHeightOffsetVRWithoutFloor=this._myParams.myDefaultHeight,t.myHeightOffsetNonVR=this._myParams.myDefaultHeight,t.myForeheadExtraHeight=this._myParams.myForeheadExtraHeight,t.myFeetRotationKeepUp=!0,t.myDebugEnabled=!1,this._myPlayerHeadManager=new se(t)}{let t=new zs(this._myParams.myEngine);t.myPlayerHeadManager=this._myPlayerHeadManager,t.myMovementCollisionCheckParams=this._myCollisionCheckParamsMovement,t.myTeleportCollisionCheckParams=null,t.myTeleportCollisionCheckParamsCopyFromMovement=!0,t.myTeleportCollisionCheckParamsCheck360=!0,t.myHeadCollisionBlockLayerFlags.copy(t.myMovementCollisionCheckParams.myHorizontalBlockLayerFlags),t.myHeadCollisionBlockLayerFlags.add(t.myMovementCollisionCheckParams.myVerticalBlockLayerFlags),t.myHeadCollisionObjectsToIgnore.pp_copy(t.myMovementCollisionCheckParams.myHorizontalObjectsToIgnore);let n=(o,s)=>o.pp_equals(s);for(let o of t.myMovementCollisionCheckParams.myVerticalObjectsToIgnore)t.myHeadCollisionObjectsToIgnore.pp_pushUnique(o,n);t.myCollisionRuntimeParams=this._myCollisionRuntimeParams,t.myHeadRadius=.15,t.myAlwaysSyncPositionWithReal=!this._myParams.mySyncWithRealWorldPositionOnlyIfValid,t.myAlwaysSyncHeadPositionWithReal=!1,!this._myParams.myViewOcclusionInsideWallsEnabled&&!this._myParams.mySyncWithRealWorldPositionOnlyIfValid&&(t.mySyncEnabledFlagMap.set(ce.BODY_COLLIDING,!1),t.mySyncEnabledFlagMap.set(ce.HEAD_COLLIDING,!1),t.mySyncEnabledFlagMap.set(ce.FAR,!1),t.mySyncEnabledFlagMap.set(ce.FLOATING,!1),t.myAlwaysSyncHeadPositionWithReal=!this._myParams.mySyncWithRealWorldPositionOnlyIfValid),t.myMaxDistanceFromRealToSyncEnabled=!0,t.myMaxDistanceFromRealToSync=100,t.myIsFloatingValidIfVerticalMovement=!1,t.myIsFloatingValidIfVerticalMovementAndRealOnGround=!1,t.myIsFloatingValidIfSteepGround=!1,t.myIsFloatingValidIfVerticalMovementAndSteepGround=!1,t.myIsFloatingValidIfRealOnGround=!1,t.myIsLeaningValidAboveDistance=!0,t.myLeaningValidDistance=2,t.myFloatingSplitCheckEnabled=!0,t.myFloatingSplitCheckMaxLength=.2,t.myFloatingSplitCheckMaxSteps=5,t.myRealMovementAllowVerticalAdjustments=!1,t.myUpdateRealPositionValid=!1,t.myUpdatePositionValid=!1,t.myIsBodyCollidingWhenHeightBelowValue=null,t.myIsBodyCollidingWhenHeightAboveValue=null,t.myResetToValidOnEnterSession=!0,t.myResetToValidOnExitSession=!0,t.myAlwaysResetRealPositionNonVR=!0,t.myAlwaysResetRealRotationNonVR=!0,t.myAlwaysResetRealHeightNonVR=!0,t.myAlwaysResetRealPositionVR=!1,t.myAlwaysResetRealRotationVR=!1,t.myAlwaysResetRealHeightVR=!1,t.myNeverResetRealPositionNonVR=!1,t.myNeverResetRealRotationNonVR=!0,t.myNeverResetRealHeightNonVR=!1,t.myNeverResetRealPositionVR=!1,t.myNeverResetRealRotationVR=!1,t.myNeverResetRealHeightVR=!0,t.myResetRealOnMove=!1,t.myDebugEnabled=!1,this._myPlayerTransformManager=new tt(t)}{let t=new Us(this._myParams.myEngine);t.myPlayerTransformManager=this._myPlayerTransformManager,t.myEnabled=this._myParams.myViewOcclusionInsideWallsEnabled,t.myObscureObject=null,t.myObscureMaterial=null,t.myObscureRadius=.1,t.myObscureFadeOutSeconds=.25,t.myObscureFadeInSeconds=.25,t.myObscureFadeEasingFunction=ue.linear,t.myObscureLevelRelativeDistanceEasingFunction=ue.linear,t.myDistanceToStartObscureWhenBodyColliding=.75,t.myDistanceToStartObscureWhenHeadColliding=0,t.myDistanceToStartObscureWhenFloating=.75,t.myDistanceToStartObscureWhenFar=.75,t.myRelativeDistanceToMaxObscureWhenBodyColliding=.5,t.myRelativeDistanceToMaxObscureWhenHeadColliding=.1,t.myRelativeDistanceToMaxObscureWhenFloating=.5,t.myRelativeDistanceToMaxObscureWhenFar=.5,this._myPlayerObscureManager=new Ws(t)}{let t=new Gs(this._myParams.myEngine);t.myPlayerHeadManager=this._myPlayerHeadManager,t.myPlayerTransformManager=this._myPlayerTransformManager,t.myMaxRotationSpeed=this._myParams.myMaxRotationSpeed,t.myIsSnapTurn=this._myParams.myIsSnapTurn,t.mySnapTurnOnlyVR=this._myParams.mySnapTurnOnlyVR,t.mySnapTurnAngle=this._myParams.mySnapTurnAngle,this._myParams.mySnapTurnSpeedDegrees>Math.PP_EPSILON?(t.mySmoothSnapEnabled=!0,t.mySmoothSnapSpeedDegrees=this._myParams.mySnapTurnSpeedDegrees):t.mySmoothSnapEnabled=!1,t.myRotationMinStickIntensityThreshold=.1,t.mySnapTurnActivateThreshold=.5,t.mySnapTurnResetThreshold=.4,t.myClampVerticalAngle=!0,t.myMaxVerticalAngle=90,this._myPlayerLocomotionRotate=new gi(t),t.myHandedness=ie.getOppositeHandedness(this._myParams.myMainHand)}{{let t=new ea(this._myParams.myEngine);t.myPlayerHeadManager=this._myPlayerHeadManager,t.myPlayerTransformManager=this._myPlayerTransformManager,t.myCollisionCheckParams=this._myCollisionCheckParamsMovement,t.myHandedness=this._myParams.myMainHand,t.myMaxSpeed=this._myParams.myMaxSpeed,t.mySpeedSlowDownPercentageOnWallSlid=this._myParams.mySpeedSlowDownPercentageOnWallSlid,t.myMovementMinStickIntensityThreshold=.1,t.myFlyEnabled=this._myParams.myFlyEnabled,t.myMinAngleToFlyUpNonVR=this._myParams.myMinAngleToFlyUpNonVR,t.myMinAngleToFlyDownNonVR=this._myParams.myMinAngleToFlyDownNonVR,t.myMinAngleToFlyUpVR=this._myParams.myMinAngleToFlyUpVR,t.myMinAngleToFlyDownVR=this._myParams.myMinAngleToFlyDownVR,t.myMinAngleToFlyRight=this._myParams.myMinAngleToFlyRight,t.myGravityAcceleration=this._myParams.myGravityAcceleration,t.myMaxGravitySpeed=this._myParams.myMaxGravitySpeed,t.myDirectionInvertForwardWhenUpsideDown=this._myParams.myDirectionInvertForwardWhenUpsideDown,t.myVRDirectionReferenceType=this._myParams.myVRDirectionReferenceType,t.myVRDirectionReferenceObject=this._myParams.myVRDirectionReferenceObject,t.myMoveThroughCollisionShortcutEnabled=this._myParams.myMoveThroughCollisionShortcutEnabled,t.myMoveHeadShortcutEnabled=this._myParams.myMoveHeadShortcutEnabled,t.myTripleSpeedShortcutEnabled=this._myParams.myTripleSpeedShortcutEnabled,this._myPlayerLocomotionSmooth=new Zt(t,this._myMovementRuntimeParams)}{let t=new Zs(this._myParams.myEngine);t.myPlayerHeadManager=this._myPlayerHeadManager,t.myPlayerTransformManager=this._myPlayerTransformManager,t.myCollisionCheckParams=this._myCollisionCheckParamsTeleport,t.myHandedness=this._myParams.myMainHand,t.myDetectionParams.myMaxDistance=this._myParams.myTeleportMaxDistance,t.myDetectionParams.myMaxHeightDifference=this._myParams.myTeleportMaxHeightDifference,t.myDetectionParams.myGroundAngleToIgnoreUpward=this._myCollisionCheckParamsMovement.myGroundAngleToIgnore,t.myDetectionParams.myRotationOnUpEnabled=this._myParams.myTeleportRotationOnUpEnabled,t.myDetectionParams.myMustBeOnGround=!0,t.myDetectionParams.myTeleportBlockLayerFlags.copy(this._myParams.myPhysicsBlockLayerFlags),t.myDetectionParams.myTeleportFloorLayerFlags.copy(this._myParams.myPhysicsBlockLayerFlags),t.myDetectionParams.myTeleportFeetPositionMustBeVisible=!1,t.myDetectionParams.myTeleportHeadPositionMustBeVisible=!1,t.myDetectionParams.myTeleportHeadOrFeetPositionMustBeVisible=!0,t.myDetectionParams.myTeleportParableStartReferenceObject=this._myParams.myTeleportParableStartReferenceObject,t.myDetectionParams.myVisibilityBlockLayerFlags.copy(t.myDetectionParams.myTeleportBlockLayerFlags),t.myTeleportParams.myTeleportType=this._myParams.myTeleportType,t.myVisualizerParams.myTeleportPositionObject=this._myParams.myTeleportPositionObject,t.myVisualizerParams.myTeleportValidMaterial=this._myParams.myTeleportValidMaterial,t.myVisualizerParams.myTeleportInvalidMaterial=this._myParams.myTeleportInvalidMaterial,t.myVisualizerParams.myTeleportPositionObjectRotateWithHead=this._myParams.myTeleportPositionObjectRotateWithHead,t.myPerformTeleportAsMovement=!1,t.myTeleportAsMovementRemoveVerticalMovement=!0,t.myTeleportAsMovementExtraVerticalMovementPerMeter=-2,t.myGravityAcceleration=this._myParams.myGravityAcceleration,t.myMaxGravitySpeed=this._myParams.myMaxGravitySpeed,t.myDebugEnabled=!1,t.myDebugDetectEnabled=!0,t.myDebugShowEnabled=!0,t.myDebugVisibilityEnabled=!1,this._myPlayerLocomotionTeleport=new io(t,this._myMovementRuntimeParams)}}this._setupLocomotionMovementFSM(),this._myIdle=!1,this._myActive=!0,this._myStarted=!1,this._myDestroyed=!1}start(){this._fixAlmostUp(),this._myPlayerHeadManager.start(),this._myPlayerTransformManager.start(),this._myPlayerObscureManager.start(),this._myPlayerLocomotionRotate.start(),this._myParams.myDefaultLocomotionType==lm.SMOOTH?this._myLocomotionMovementFSM.perform("startSmooth"):this._myLocomotionMovementFSM.perform("startTeleport"),this._myStarted=!0;let e=this._myActive;this._myActive=!this._myActive,this.setActive(e)}setActive(e){this._myActive!=e&&(this._myActive=e,this._myStarted&&(this._myActive?(this._myPlayerObscureManager.start(),this._myIdle||this._myLocomotionMovementFSM.perform("resume")):(this._myLocomotionMovementFSM.perform("idle"),this._myPlayerObscureManager.stop())),this._myPlayerHeadManager.setActive(this._myActive),this._myPlayerTransformManager.setActive(this._myActive))}isStarted(){return this._myStarted}canStop(){let e=!1;return(this._myLocomotionMovementFSM.isInState("smooth")&&this._myPlayerLocomotionSmooth.canStop()||this._myLocomotionMovementFSM.isInState("teleport")&&this._myPlayerLocomotionTeleport.canStop())&&(e=!0),e}update(e){this._myPlayerHeadManager.update(e),this._myPlayerTransformManager.update(e),this._myParams.mySwitchLocomotionTypeShortcutEnabled&&m.getLeftGamepad(this._myParams.myEngine).getButtonInfo(E.THUMBSTICK).isPressEnd(2)&&(this._myLocomotionMovementFSM.isInState("smooth")&&this._myPlayerLocomotionSmooth.canStop()?this._myLocomotionMovementFSM.perform("next"):this._myLocomotionMovementFSM.isInState("teleport")&&this._myPlayerLocomotionTeleport.canStop()&&this._myLocomotionMovementFSM.perform("next")),this._myPlayerHeadManager.isSynced()&&(this._updateCollisionHeight(),this._myIdle||(this._myPlayerLocomotionRotate.update(e),this._myLocomotionMovementFSM.update(e))),this._myPlayerObscureManager.update(e)}setIdle(e){this._myIdle=e,e?this._myLocomotionMovementFSM.perform("idle"):this._myLocomotionMovementFSM.perform("resume")}getPlayerLocomotionSmooth(){return this._myPlayerLocomotionSmooth}getPlayerLocomotionTeleport(){return this._myPlayerLocomotionTeleport}getPlayerTransformManager(){return this._myPlayerTransformManager}getPlayerLocomotionRotate(){return this._myPlayerLocomotionRotate}getPlayerHeadManager(){return this._myPlayerHeadManager}getPlayerObscureManager(){return this._myPlayerObscureManager}_updateCollisionHeight(){this._myCollisionCheckParamsMovement.myHeight=this._myPlayerHeadManager.getHeightHead(),this._myCollisionCheckParamsMovement.myHeight<=1e-6&&(this._myCollisionCheckParamsMovement.myHeight=0),this._myCollisionCheckParamsTeleport.myHeight=this._myCollisionCheckParamsMovement.myHeight}_setupCollisionCheckParamsMovement(){let e=new js;e.myHeight=this._myParams.myDefaultHeight,e.myRadius=this._myParams.myCharacterRadius,e.myAccuracyLevel=this._myParams.myColliderAccuracy,e.myIsPlayer=!0,e.myCheckOnlyFeet=this._myParams.myColliderCheckOnlyFeet,e.myMaxSpeed=this._myParams.myMaxSpeed,e.myCanFly=this._myParams.myFlyEnabled,e.myShouldSlideAlongWall=this._myParams.myColliderSlideAlongWall,e.myCollectGroundInfo=!0,e.myMaxWalkableGroundAngle=this._myParams.myColliderMaxWalkableGroundAngle,e.myShouldSnapOnGround=this._myParams.myColliderSnapOnGround,e.myMaxDistanceToSnapOnGround=this._myParams.myColliderMaxDistanceToSnapOnGround,e.myMaxWalkableGroundStepHeight=this._myParams.myColliderMaxWalkableGroundStepHeight,e.myShouldNotFallFromEdges=this._myParams.myColliderPreventFallingFromEdges,e.myHorizontalCheckBlockLayerFlags.copy(this._myParams.myPhysicsBlockLayerFlags);let t=m.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getComponents(LR);for(let o of t)e.myHorizontalCheckObjectsToIgnore.pp_pushUnique(o.object,(s,a)=>s.pp_equals(a));e.myVerticalCheckBlockLayerFlags.copy(e.myHorizontalCheckBlockLayerFlags),e.myVerticalCheckObjectsToIgnore.pp_copy(e.myHorizontalCheckObjectsToIgnore),e.myHorizontalCheckDebugEnabled=this._myParams.myDebugHorizontalEnabled&&m.isDebugEnabled(this._myParams.myEngine),e.myVerticalCheckDebugEnabled=this._myParams.myDebugVerticalEnabled&&m.isDebugEnabled(this._myParams.myEngine);let n=rm.createSimplified(e);this._myCollisionCheckParamsMovement=Q.convertCharacterColliderSetupToCollisionCheckParams(n,this._myCollisionCheckParamsMovement,this._myParams.myEngine)}_setupCollisionCheckParamsTeleport(){this._myCollisionCheckParamsTeleport=Os.generate360TeleportParamsFromMovementParams(this._myCollisionCheckParamsMovement),this._myCollisionCheckParamsTeleport.myGroundAngleToIgnore=61,this._myCollisionCheckParamsTeleport.myTeleportMustBeOnIgnorableGroundAngle=!0,this._myCollisionCheckParamsTeleport.myTeleportMustBeOnGround=!0}_fixAlmostUp(){let e=p(0,1,0);if(m.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp().vec3_angle(e)<1){let o=m.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getForward().vec3_clone();o[1]=0;let a=p(0,0,1).vec3_angleSigned(o,e);m.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_resetRotation(),m.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_rotateAxis(a,e)}}_setupLocomotionMovementFSM(){this._myLocomotionMovementFSM=new ct,this._myLocomotionMovementFSM.addState("init"),this._myLocomotionMovementFSM.addState("smooth",e=>this._myPlayerLocomotionSmooth.update(e)),this._myLocomotionMovementFSM.addState("teleport",e=>this._myPlayerLocomotionTeleport.update(e)),this._myLocomotionMovementFSM.addState("idleSmooth"),this._myLocomotionMovementFSM.addState("idleTeleport"),this._myLocomotionMovementFSM.addTransition("init","smooth","startSmooth",function(){this._myPlayerLocomotionSmooth.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("init","teleport","startTeleport",function(){this._myPlayerLocomotionSmooth.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("smooth","teleport","next",function(){this._myPlayerLocomotionSmooth.stop(),this._myPlayerLocomotionTeleport.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("teleport","smooth","next",function(){this._myPlayerLocomotionTeleport.stop(),this._myPlayerLocomotionSmooth.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("smooth","idleSmooth","idle",function(){this._myPlayerLocomotionSmooth.stop()}.bind(this)),this._myLocomotionMovementFSM.addTransition("teleport","idleTeleport","idle",function(){this._myPlayerLocomotionTeleport.stop()}.bind(this)),this._myLocomotionMovementFSM.addTransition("idleSmooth","smooth","resume",function(){this._myPlayerLocomotionSmooth.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("idleTeleport","teleport","resume",function(){this._myPlayerLocomotionTeleport.start()}.bind(this)),this._myLocomotionMovementFSM.init("init")}destroy(){this._myDestroyed=!0,this._myPlayerHeadManager.destroy(),this._myPlayerLocomotionSmooth.destroy(),this._myPlayerTransformManager.destroy(),this._myPlayerObscureManager.destroy(),this._myPlayerLocomotionTeleport.destroy()}isDestroyed(){return this._myDestroyed}};var ea=class{constructor(e=m.getMainEngine()){this.myPlayerHeadManager=null,this.myPlayerTransformManager=null,this.myCollisionCheckParams=null,this.myMaxSpeed=0,this.mySpeedSlowDownPercentageOnWallSlid=1,this.myMovementMinStickIntensityThreshold=0,this.myFlyEnabled=!1,this.myMinAngleToFlyUpNonVR=0,this.myMinAngleToFlyDownNonVR=0,this.myMinAngleToFlyUpVR=0,this.myMinAngleToFlyDownVR=0,this.myMinAngleToFlyRight=0,this.myGravityAcceleration=0,this.myMaxGravitySpeed=0,this.myVRDirectionReferenceType=Gr.HEAD,this.myVRDirectionReferenceObject=null,this.myHandedness=A.LEFT,this.myMoveThroughCollisionShortcutEnabled=!1,this.myMoveHeadShortcutEnabled=!1,this.myTripleSpeedShortcutEnabled=!1,this.myEngine=e}},Zt=class extends on{constructor(e,t){super(t),this._myParams=e,this._myCurrentSpeed=0,this._myLastHorizontalMovement=p(),this._myDirectionReference=m.getPlayerObjects(this._myParams.myEngine).myHead,this._myStickIdleTimer=new te(.25,!1);let n=new Yi(this._myParams.myEngine);n.myAutoUpdateFlyForward=this._myParams.myFlyEnabled,n.myAutoUpdateFlyRight=this._myParams.myFlyEnabled,n.myMinAngleToFlyForwardUp=this._myParams.myMinAngleToFlyUpNonVR,n.myMinAngleToFlyForwardDown=this._myParams.myMinAngleToFlyDownNonVR,n.myMinAngleToFlyRightUp=this._myParams.myMinAngleToFlyRight,n.myMinAngleToFlyRightDown=this._myParams.myMinAngleToFlyRight,n.myInvertForwardWhenUpsideDown=this._myParams.myDirectionInvertForwardWhenUpsideDown;let o=new Yi(this._myParams.myEngine);o.myAutoUpdateFlyForward=this._myParams.myFlyEnabled,o.myAutoUpdateFlyRight=this._myParams.myFlyEnabled,o.myMinAngleToFlyForwardUp=this._myParams.myMinAngleToFlyUpVR,o.myMinAngleToFlyForwardDown=this._myParams.myMinAngleToFlyDownVR,o.myMinAngleToFlyRightUp=this._myParams.myMinAngleToFlyRight,o.myMinAngleToFlyRightDown=this._myParams.myMinAngleToFlyRight,o.myInvertForwardWhenUpsideDown=this._myParams.myDirectionInvertForwardWhenUpsideDown,this._myDirectionConverterNonVR=new Kt(n),this._myDirectionConverterVR=new Kt(o),this._myCurrentDirectionConverter=this._myDirectionConverterNonVR,this._myDestroyed=!1,O.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this._myParams.myEngine)}start(){this._myCurrentSpeed=0,this._myLastHorizontalMovement.vec3_zero()}getParams(){return this._myParams}getCurrentSpeed(){return this._myCurrentSpeed}getLastHorizontalSpeed(){return this._myLastHorizontalMovement}update(e){}destroy(){this._myDestroyed=!0,O.unregisterSessionStartEndEventListeners(this,this._myParams.myEngine)}isDestroyed(){return this._myDestroyed}};Zt.prototype.update=function(){let i=p(),e=p(),t=p(),n=p(),o=p(),s=G(),a=G();return function(h){this._myCurrentSpeed=0,this._myLastHorizontalMovement.vec3_zero(),i=this._myParams.myPlayerHeadManager.getPlayer().pp_getUp(i),e.vec3_zero();let _=m.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getAxesInfo(ne.THUMBSTICK).getAxes();_[0]=Math.abs(_[0])>this._myParams.myMovementMinStickIntensityThreshold?_[0]:0,_[1]=Math.abs(_[1])>this._myParams.myMovementMinStickIntensityThreshold?_[1]:0;let y=!1,r=this._myParams.myMaxSpeed;if(this._myParams.myTripleSpeedShortcutEnabled&&m.isDebugEnabled(this._myParams.myEngine)&&m.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(E.SELECT).isPressed()&&(r*=3),_.vec2_isZero())this._myStickIdleTimer.isRunning()&&(this._myStickIdleTimer.update(h),this._myStickIdleTimer.isDone()&&this._myCurrentDirectionConverter.resetFly());else if(this._myStickIdleTimer.start(),t=this._myCurrentDirectionConverter.convertTransformQuat(_,this._myDirectionReference.pp_getTransformQuat(a),i,t),!t.vec3_isZero()){this._myLocomotionRuntimeParams.myIsFlying=this._myLocomotionRuntimeParams.myIsFlying||t.vec3_componentAlongAxis(i,n).vec3_length()>1e-6,this._myLocomotionRuntimeParams.myIsFlying||(t=t.vec3_removeComponentAlongAxis(i,t));let u=_.vec2_length();if(this._myCurrentSpeed=Math.pp_lerp(0,r,u),this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsSliding&&this._myParams.mySpeedSlowDownPercentageOnWallSlid!=1){let g=this._myParams.mySpeedSlowDownPercentageOnWallSlid,P=Math.pp_mapToRange(Math.abs(this._myLocomotionRuntimeParams.myCollisionRuntimeParams.mySlidingMovementAngle),0,90,0,1);g=Math.pp_lerp(1,g,P),this._myCurrentSpeed=this._myCurrentSpeed*g}e=t.vec3_scale(this._myCurrentSpeed*h,e),y=!0}this._myParams.myFlyEnabled&&(m.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(E.TOP_BUTTON).isPressed()?(o=i.vec3_scale(r*h,o),e=e.vec3_add(o,e),this._myLocomotionRuntimeParams.myIsFlying=!0):m.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(E.BOTTOM_BUTTON).isPressed()&&(o=i.vec3_scale(-r*h,o),e=e.vec3_add(o,e),this._myLocomotionRuntimeParams.myIsFlying=!0),m.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(E.BOTTOM_BUTTON).isPressEnd(2)&&(this._myLocomotionRuntimeParams.myIsFlying=!1)),this._myParams.myMoveHeadShortcutEnabled&&m.isDebugEnabled(this._myParams.myEngine)&&m.getGamepads(this._myParams.myEngine)[ie.getOppositeHandedness(this._myParams.myHandedness)].getButtonInfo(E.THUMBSTICK).isPressed()?this._myParams.myPlayerTransformManager.getPlayerHeadManager().moveFeet(e):this._myParams.myMoveThroughCollisionShortcutEnabled&&m.isDebugEnabled(this._myParams.myEngine)&&m.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(E.THUMBSTICK).isPressed()?(this._myParams.myPlayerTransformManager.move(e,this._myLocomotionRuntimeParams.myCollisionRuntimeParams,!0),y&&this._myParams.myPlayerTransformManager.resetReal()):(this._myLocomotionRuntimeParams.myIsFlying?this._myLocomotionRuntimeParams.myGravitySpeed=0:(this._myLocomotionRuntimeParams.myGravitySpeed+=this._myParams.myGravityAcceleration*h,Math.abs(this._myLocomotionRuntimeParams.myGravitySpeed)>Math.abs(this._myParams.myMaxGravitySpeed)&&(this._myLocomotionRuntimeParams.myGravitySpeed=Math.pp_sign(this._myParams.myGravityAcceleration)*Math.abs(this._myParams.myMaxGravitySpeed)),o=i.vec3_scale(this._myLocomotionRuntimeParams.myGravitySpeed*h,o),e=e.vec3_add(o,e)),s=this._myParams.myPlayerTransformManager.getTransformQuat(s),this._myParams.myPlayerTransformManager.move(e,this._myLocomotionRuntimeParams.myCollisionRuntimeParams),y&&(this._myParams.myPlayerTransformManager.resetReal(),this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myFixedMovement.vec3_removeComponentAlongAxis(this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myOriginalUp,this._myLastHorizontalMovement)),(this._myLocomotionRuntimeParams.myGravitySpeed>0&&this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnCeiling||this._myLocomotionRuntimeParams.myGravitySpeed<0&&this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnGround)&&(this._myLocomotionRuntimeParams.myGravitySpeed=0)),this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnGround&&(this._myLocomotionRuntimeParams.myIsFlying=!1,this._myCurrentDirectionConverter.resetFly())}}();Zt.prototype._onXRSessionStart=function(){return function(e){switch(this._myParams.myVRDirectionReferenceType){case 0:this._myDirectionReference=m.getPlayerObjects(this._myParams.myEngine).myHead;break;case 1:this._myDirectionReference=m.getPlayerObjects(this._myParams.myEngine).myHands[this._myParams.myHandedness];break;case 2:this._myDirectionReference=this._myParams.myVRDirectionReferenceObject;break}this._myCurrentDirectionConverter=this._myDirectionConverterVR,this._myCurrentDirectionConverter.resetFly()}}();Zt.prototype._onXRSessionEnd=function(){return function(e){this._myDirectionReference=m.getPlayerObjects(this._myParams.myEngine).myHead,this._myCurrentDirectionConverter=this._myDirectionConverterNonVR,this._myCurrentDirectionConverter.resetFly()}}();Object.defineProperty(Zt.prototype,"_onXRSessionStart",{enumerable:!1});Object.defineProperty(Zt.prototype,"_onXRSessionEnd",{enumerable:!1});import{Component as HR,Property as ee}from"@wonderlandengine/api";var Io=class extends HR{static TypeName="pp-player-locomotion";static Properties={_myDefaultLocomotionType:ee.enum(["Smooth","Teleport"],"Smooth"),_mySwitchLocomotionTypeShortcutEnabled:ee.bool(!0),_myPhysicsBlockLayerFlags:ee.string("0, 0, 0, 0, 0, 0, 0, 0"),_myDefaultHeight:ee.float(1.75),_myCharacterRadius:ee.float(.3),_myMaxSpeed:ee.float(2),_myMaxRotationSpeed:ee.float(100),_myGravityAcceleration:ee.float(-20),_myMaxGravitySpeed:ee.float(-15),_mySpeedSlowDownPercentageOnWallSlid:ee.float(1),_myIsSnapTurn:ee.bool(!0),_mySnapTurnOnlyVR:ee.bool(!0),_mySnapTurnAngle:ee.float(30),_mySnapTurnSpeedDegrees:ee.float(0),_myFlyEnabled:ee.bool(!1),_myStartFlying:ee.bool(!1),_myMinAngleToFlyUpNonVR:ee.float(30),_myMinAngleToFlyDownNonVR:ee.float(50),_myMinAngleToFlyUpVR:ee.float(60),_myMinAngleToFlyDownVR:ee.float(1),_myMinAngleToFlyRight:ee.float(60),_myMainHand:ee.enum(["Left","Right"],"Left"),_myDirectionInvertForwardWhenUpsideDown:ee.bool(!0),_myVRDirectionReferenceType:ee.enum(["Head","Hand","Custom Object"],"Head"),_myVRDirectionReferenceObject:ee.object(),_myTeleportType:ee.enum(["Instant","Blink","Shift"],"Shift"),_myTeleportMaxDistance:ee.float(3),_myTeleportMaxHeightDifference:ee.float(1.25),_myTeleportRotationOnUpEnabled:ee.bool(!1),_myTeleportValidMaterial:ee.material(),_myTeleportInvalidMaterial:ee.material(),_myTeleportPositionObject:ee.object(),_myTeleportPositionObjectRotateWithHead:ee.bool(!0),_myTeleportParableStartReferenceObject:ee.object(),_mySyncWithRealWorldPositionOnlyIfValid:ee.bool(!0),_myViewOcclusionInsideWallsEnabled:ee.bool(!0),_myColliderAccuracy:ee.enum(["Very Low","Low","Medium","High","Very High"],"High"),_myColliderCheckOnlyFeet:ee.bool(!1),_myColliderSlideAlongWall:ee.bool(!0),_myColliderMaxWalkableGroundAngle:ee.float(30),_myColliderSnapOnGround:ee.bool(!0),_myColliderMaxDistanceToSnapOnGround:ee.float(.1),_myColliderMaxWalkableGroundStepHeight:ee.float(.1),_myColliderPreventFallingFromEdges:ee.bool(!1),_myDebugHorizontalEnabled:ee.bool(!1),_myDebugVerticalEnabled:ee.bool(!1),_myMoveThroughCollisionShortcutEnabled:ee.bool(!1),_myMoveHeadShortcutEnabled:ee.bool(!1),_myTripleSpeedShortcutEnabled:ee.bool(!1)};start(){Q.initBridge(this.engine);let e=new Ys(this.engine);e.myDefaultLocomotionType=this._myDefaultLocomotionType,e.mySwitchLocomotionTypeShortcutEnabled=this._mySwitchLocomotionTypeShortcutEnabled,e.myDefaultHeight=this._myDefaultHeight,e.myMaxSpeed=this._myMaxSpeed,e.myMaxRotationSpeed=this._myMaxRotationSpeed,e.myGravityAcceleration=this._myGravityAcceleration,e.myMaxGravitySpeed=this._myMaxGravitySpeed,e.myCharacterRadius=this._myCharacterRadius,e.mySpeedSlowDownPercentageOnWallSlid=this._mySpeedSlowDownPercentageOnWallSlid,e.myIsSnapTurn=this._myIsSnapTurn,e.mySnapTurnOnlyVR=this._mySnapTurnOnlyVR,e.mySnapTurnAngle=this._mySnapTurnAngle,e.mySnapTurnSpeedDegrees=this._mySnapTurnSpeedDegrees,e.myFlyEnabled=this._myFlyEnabled,e.myStartFlying=this._myStartFlying,e.myMinAngleToFlyUpNonVR=this._myMinAngleToFlyUpNonVR,e.myMinAngleToFlyDownNonVR=this._myMinAngleToFlyDownNonVR,e.myMinAngleToFlyUpVR=this._myMinAngleToFlyUpVR,e.myMinAngleToFlyDownVR=this._myMinAngleToFlyDownVR,e.myMinAngleToFlyRight=this._myMinAngleToFlyRight,e.myMainHand=ie.getHandednessByIndex(this._myMainHand),e.myDirectionInvertForwardWhenUpsideDown=this._myDirectionInvertForwardWhenUpsideDown,e.myVRDirectionReferenceType=this._myVRDirectionReferenceType,e.myVRDirectionReferenceObject=this._myVRDirectionReferenceObject,e.myForeheadExtraHeight=.1,e.myTeleportType=this._myTeleportType,e.myTeleportMaxDistance=this._myTeleportMaxDistance,e.myTeleportMaxHeightDifference=this._myTeleportMaxHeightDifference,e.myTeleportRotationOnUpEnabled=this._myTeleportRotationOnUpEnabled,e.myTeleportValidMaterial=this._myTeleportValidMaterial,e.myTeleportInvalidMaterial=this._myTeleportInvalidMaterial,e.myTeleportPositionObject=this._myTeleportPositionObject,e.myTeleportPositionObjectRotateWithHead=this._myTeleportPositionObjectRotateWithHead,e.myTeleportParableStartReferenceObject=this._myTeleportParableStartReferenceObject,e.mySyncWithRealWorldPositionOnlyIfValid=this._mySyncWithRealWorldPositionOnlyIfValid,e.myViewOcclusionInsideWallsEnabled=this._myViewOcclusionInsideWallsEnabled,e.myColliderAccuracy=this._myColliderAccuracy,e.myColliderCheckOnlyFeet=this._myColliderCheckOnlyFeet,e.myColliderSlideAlongWall=this._myColliderSlideAlongWall,e.myColliderMaxWalkableGroundAngle=this._myColliderMaxWalkableGroundAngle,e.myColliderSnapOnGround=this._myColliderSnapOnGround,e.myColliderMaxDistanceToSnapOnGround=this._myColliderMaxDistanceToSnapOnGround,e.myColliderMaxWalkableGroundStepHeight=this._myColliderMaxWalkableGroundStepHeight,e.myColliderPreventFallingFromEdges=this._myColliderPreventFallingFromEdges,e.myMoveThroughCollisionShortcutEnabled=this._myMoveThroughCollisionShortcutEnabled,e.myMoveHeadShortcutEnabled=this._myMoveHeadShortcutEnabled,e.myTripleSpeedShortcutEnabled=this._myTripleSpeedShortcutEnabled,e.myDebugHorizontalEnabled=this._myDebugHorizontalEnabled,e.myDebugVerticalEnabled=this._myDebugVerticalEnabled,e.myPhysicsBlockLayerFlags.copy(this._getPhysicsBlockLayersFlags()),this._myPlayerLocomotion=new $s(e),this._myStartCounter=1,this._myResetReal=!0}update(e){this._myStartCounter>0?(this._myStartCounter--,this._myStartCounter==0&&this._myPlayerLocomotion.start(),this._myPlayerLocomotion.getPlayerHeadManager().update(e)):(this._myResetReal&&(this._myResetReal=!1,this._myPlayerLocomotion.getPlayerTransformManager().resetReal(!0,!0)),Q.getCollisionCheck(this.engine)._myTotalRaycasts=0,this._myPlayerLocomotion.update(e))}getPlayerLocomotion(){return this._myPlayerLocomotion}onActivate(){this._myStartCounter==0&&this._myPlayerLocomotion!=null&&this._myPlayerLocomotion.setActive(!0)}onDeactivate(){this._myStartCounter==0&&this._myPlayerLocomotion!=null&&this._myPlayerLocomotion.setActive(!1)}_getPhysicsBlockLayersFlags(){let e=new Ve,t=[...this._myPhysicsBlockLayerFlags.split(",")];for(let n=0;n<t.length;n++)e.setFlagActive(n,t[n].trim()=="1");return e}onDestroy(){this._myPlayerLocomotion?.destroy()}};pt.prototype._isTeleportPositionVisible=function(){let i=p(),e=p(),t=p();return function(o){let s=!0;if(this._myTeleportParams.myDetectionParams.myTeleportFeetPositionMustBeVisible||this._myTeleportParams.myDetectionParams.myTeleportHeadPositionMustBeVisible||this._myTeleportParams.myDetectionParams.myTeleportHeadOrFeetPositionMustBeVisible){i=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(i);let a=!1,l=!1;if(this._myTeleportParams.myDetectionParams.myTeleportHeadOrFeetPositionMustBeVisible||this._myTeleportParams.myDetectionParams.myTeleportHeadPositionMustBeVisible){let h=this._myTeleportParams.myPlayerHeadManager.getHeightHead();t=o.vec3_add(i.vec3_scale(h,t),t),a=this._isPositionVisible(t)}else a=!0;this._myTeleportParams.myDetectionParams.myTeleportHeadOrFeetPositionMustBeVisible&&a?l=!0:this._myTeleportParams.myDetectionParams.myTeleportHeadOrFeetPositionMustBeVisible||this._myTeleportParams.myDetectionParams.myTeleportFeetPositionMustBeVisible&&a?(e=o.vec3_add(i.vec3_scale(this._myTeleportParams.myDetectionParams.myVisibilityCheckFeetPositionVerticalOffset,e),e),l=this._isPositionVisible(e)):l=!0,s=a&&l}return s}}();pt.prototype._isPositionVisible=function(){let i=p(),e=p(0,1,0),t=p(0,0,1),n=p(),o=p(),s=p(),a=p(),l=p(),h=p(),_=p(),y=new ut,r=new ke,u=(g,P)=>g.pp_equals(P);return function(P){let C=!0;i=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(i),o=this._myTeleportParams.myPlayerHeadManager.getHead().pp_getPosition(o),s=P.vec3_sub(o,s).vec3_normalize(s),n.vec3_copy(e),s.vec3_angle(e)<1e-4&&n.vec3_copy(t),a=s.vec3_cross(n,a),h=a.vec3_cross(s,h),l.vec3_copy(s),h.vec3_normalize(h),l.vec3_normalize(l);let S=this._getVisibilityCheckPositions(o,h,l),M=o.vec3_distance(P);for(let D of S){y.myOrigin.vec3_copy(D),y.myDirection.vec3_copy(l),y.myDistance=M,y.myPhysics=m.getPhysics(this._myTeleportParams.myEngine),y.myBlockLayerFlags.setMask(this._myTeleportParams.myDetectionParams.myVisibilityBlockLayerFlags.getMask()),y.myObjectsToIgnore.pp_copy(this._myTeleportParams.myCollisionCheckParams.myHorizontalObjectsToIgnore);for(let v of this._myTeleportParams.myCollisionCheckParams.myVerticalObjectsToIgnore)y.myObjectsToIgnore.pp_pushUnique(v,u);if(y.myIgnoreHitsInsideCollision=!0,r=De.raycast(y,r),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugVisibilityEnabled&&m.isDebugEnabled(this._myTeleportParams.myEngine)&&m.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,r),r.isColliding()){_=D.vec3_add(l.vec3_scale(M,_),_);let v=r.myHits.pp_first();if(this._myTeleportParams.myDetectionParams.myVisibilityCheckDistanceFromHitThreshold==0||v.myPosition.vec3_distance(_)>this._myTeleportParams.myDetectionParams.myVisibilityCheckDistanceFromHitThreshold+1e-5){C=!1;break}}}return C}}();pt.prototype._getVisibilityCheckPositions=function(){let i=[],e=[],t=0,n=function(){let s=null;for(;e.length<=t;)e.push(p());return s=e[t],t++,s},o=p();return function(a,l,h){i.length=0,t=0;{let u=n();u.vec3_copy(a),i.push(u)}let _=this._myTeleportParams.myDetectionParams.myVisibilityCheckRadius/this._myTeleportParams.myDetectionParams.myVisibilityCheckCircumferenceStepAmount,y=360/this._myTeleportParams.myDetectionParams.myVisibilityCheckCircumferenceSliceAmount,r=0;for(let u=0;u<this._myTeleportParams.myDetectionParams.myVisibilityCheckCircumferenceStepAmount;u++){let g=_*(u+1);o=l.vec3_rotateAxis(r,h,o);for(let P=0;P<this._myTeleportParams.myDetectionParams.myVisibilityCheckCircumferenceSliceAmount;P++){let C=n(),f=o.vec3_rotateAxis(y*P,h,C);i.push(a.vec3_add(f.vec3_scale(g,f),f))}r+=this._myTeleportParams.myDetectionParams.myVisibilityCheckCircumferenceRotationPerStep}return i}}();import{Collider as kR,CollisionComponent as FR,Component as wR,Property as ta}from"@wonderlandengine/api";import{CursorTarget as jR}from"@wonderlandengine/components";var ji=class extends wR{static TypeName="pp-finger-cursor";static Properties={_myHandedness:ta.enum(["Left","Right"],"Left"),_myMultipleClicksEnabled:ta.bool(!0),_myCollisionGroup:ta.int(1),_myCollisionSize:ta.float(.0125),_myCursorObject:ta.object(null)};init(){this._myLastTarget=null,this._myHandInputSource=null,this._myHandednessType=ie.getHandednessByIndex(this._myHandedness),this._myDoubleClickTimer=0,this._myTripleClickTimer=0,this._myMultipleClickObject=null,this._myMultipleClickDelay=.3}start(){this._myCursorParentObject=this.object.pp_addObject(),this._myCursorObject==null?this._myCursorObject=this._myCursorParentObject.pp_addObject():this._myCursorObject.pp_setParent(this._myCursorParentObject),this._myCollisionComponent=this._myCursorObject.pp_addComponent(FR),this._myCollisionComponent.collider=kR.Sphere,this._myCollisionComponent.group=1<<this._myCollisionGroup,this._myCollisionComponent.extents=p(this._myCollisionSize,this._myCollisionSize,this._myCollisionSize)}update(e){if(this._myDoubleClickTimer>0&&(this._myDoubleClickTimer-=e),this._myTripleClickTimer>0&&(this._myTripleClickTimer-=e),this._myCursorParentObject.pp_setTransformQuat(m.getPlayerObjects(this.engine).myReferenceSpace.pp_getTransformQuat()),this._updateHand(),this._myHandInputSource){let t=this._myCollisionComponent.queryOverlaps(),n=null;for(let o=0;o<t.length;++o){let a=t[o].object.pp_getComponent(jR);if(a&&(n==null||!a.isSurface)&&(n=a,!a.isSurface))break}n?n.equals(this._myLastTarget)||(this._targetTouchEnd(),this._myLastTarget=n,this._targetTouchStart()):this._targetTouchEnd()}else this._targetTouchEnd()}_targetTouchStart(){this._myLastTarget.onHover.notify(this._myLastTarget.object,this),this._myLastTarget.onDown.notify(this._myLastTarget.object,this)}_targetTouchEnd(){this._myLastTarget&&(this._myMultipleClicksEnabled&&this._myTripleClickTimer>0&&this._myMultipleClickObject&&this._myMultipleClickObject.pp_equals(this._myLastTarget.object)?(this._myLastTarget.onTripleClick.notify(this._myLastTarget.object,this),this._myTripleClickTimer=0):this._myMultipleClicksEnabled&&this._myDoubleClickTimer>0&&this._myMultipleClickObject&&this._myMultipleClickObject.pp_equals(this._myLastTarget.object)?(this._myLastTarget.onDoubleClick.notify(this._myLastTarget.object,this),this._myTripleClickTimer=this._myMultipleClickDelay,this._myDoubleClickTimer=0):(this._myLastTarget.onClick.notify(this._myLastTarget.object,this),this._myTripleClickTimer=0,this._myDoubleClickTimer=this._myMultipleClickDelay,this._myMultipleClickObject=this._myLastTarget.object),this._myLastTarget.onUp.notify(this._myLastTarget.object,this),this._myLastTarget.onUnhover.notify(this._myLastTarget.object,this),this._myLastTarget=null)}onActivate(){this._myCursorParentObject.pp_setActive(!0)}onDeactivate(){this._myCursorParentObject.pp_setActive(!1)}_updateHand(){if(this._myHandInputSource=ie.getInputSource(this._myHandednessType,lt.TRACKED_HAND,this.engine),this._myHandInputSource){let e=O.getFrame(this.engine).getJointPose(this._myHandInputSource.hand.get(ot.INDEX_FINGER_TIP),O.getReferenceSpace(this.engine));e&&(this._myCursorObject.pp_setRotationLocalQuat([e.transform.orientation.x,e.transform.orientation.y,e.transform.orientation.z,e.transform.orientation.w]),this._myCursorObject.pp_setPositionLocal([e.transform.position.x,e.transform.position.y,e.transform.position.z]))}}};import{Component as zR,Property as mm}from"@wonderlandengine/api";var Bo=class extends zR{static TypeName="pp-switch-hand-object";static Properties={_myHandedness:mm.enum(["Left","Right"],"Left"),_myGamepad:mm.object(),_myTrackedHand:mm.object()};start(){this._myHandednessType=ie.getHandednessByIndex(this._myHandedness),this._myFirstUpdate=!0,this._myCurrentInputSourceType=null}onActivate(){this._myFirstUpdate=!0}update(e){this._myFirstUpdate&&(this._myFirstUpdate=!1,this._start());let t=ie.getInputSourceTypeByHandedness(this._myHandednessType,this.engine);t!=null&&this._myCurrentInputSourceType!=t&&(this._myCurrentInputSourceType=t,t==lt.TRACKED_HAND?(this._myGamepad!=null&&this._myGamepad.pp_setActive(!1),this._myTrackedHand!=null&&this._myTrackedHand.pp_setActive(!0)):t==lt.GAMEPAD&&(this._myTrackedHand!=null&&this._myTrackedHand.pp_setActive(!1),this._myGamepad!=null&&this._myGamepad.pp_setActive(!0)))}_start(){this._myGamepad!=null&&this._myGamepad.pp_setActive(!1),this._myTrackedHand!=null&&this._myTrackedHand.pp_setActive(!1),this._myCurrentInputSourceType=null}};import{Component as GR,MeshComponent as NR,Property as Nr}from"@wonderlandengine/api";var xi=class extends GR{static TypeName="pp-tracked-hand-draw-joint";static Properties={_myHandedness:Nr.enum(["Left","Right"],"Left"),_myJointID:Nr.enum(["Wrist","Thumb Metacarpal","Thumb Phalanx Proximal","Thumb Phalanx Distal","Thumb Tip","Index Metacarpal","Index Phalanx Proximal","Index Phalanx Intermediate","Index Phalanx Distal","Index Tip","Middle Metacarpal","Middle Phalanx Proximal","Middle Phalanx Intermediate","Middle Phalanx Distal","Middle Tip","Ring Metacarpal","Ring Phalanx Proximal","Ring Phalanx Intermediate","Ring Phalanx Distal","Ring Tip","Pinky Metacarpal","Pinky Phalanx Proximal","Pinky Phalanx Intermediate","Pinky Phalanx Distal","Pinky Tip"],"Wrist"),_myJointMesh:Nr.mesh(),_myJointMaterial:Nr.material()};start(){this._myHandednessType=ie.getHandednessByIndex(this._myHandedness),this._myJointIDType=ie.getJointIDByIndex(this._myJointID),this._buildTrackedHandHierarchy()}update(e){}_buildTrackedHandHierarchy(){this._myJointMeshObject=this.object.pp_addObject();let e=this._myJointMeshObject.pp_addComponent(NR);e.mesh=this._myJointMesh,e.material=this._myJointMaterial,this._myJointMeshObject.pp_setScaleLocal(0)}};xi.prototype.update=function(){let i=G();return function(t){let n=m.getTrackedHandPose(this._myHandednessType,this.engine).getJointPose(this._myJointIDType);this._myJointMeshObject.pp_setTransformLocalQuat(n.getTransformQuat(i,null)),this._myJointMeshObject.pp_setScaleLocal(n.getJointRadius())}}();import{Component as UR,Property as Ur}from"@wonderlandengine/api";var Lo=class extends UR{static TypeName="pp-tracked-hand-draw-all-joints";static Properties={_myHandedness:Ur.enum(["Left","Right"],"Left"),_myHideMetacarpals:Ur.bool(!0),_myJointMesh:Ur.mesh(),_myJointMaterial:Ur.material()};start(){this._buildTrackedHandHierarchy()}_buildTrackedHandHierarchy(){this._myTrackedHandMeshObject=this.object.pp_addObject(),this._myJointMeshObjectList=[];for(let e in ot){let t=ot[e];if(!this._myHideMetacarpals||t!=ot.THUMB_METACARPAL&&t!=ot.INDEX_FINGER_METACARPAL&&t!=ot.MIDDLE_FINGER_METACARPAL&&t!=ot.RING_FINGER_METACARPAL&&t!=ot.PINKY_FINGER_METACARPAL){let n=this._myTrackedHandMeshObject.pp_addObject();this._myJointMeshObjectList[t]=n,n.pp_addComponent(xi,{_myHandedness:this._myHandedness,_myJointID:bn[e],_myJointMesh:this._myJointMesh,_myJointMaterial:this._myJointMaterial})}}}};import{Component as WR,Property as hb}from"@wonderlandengine/api";var vn=class extends WR{static TypeName="pp-tracked-hand-draw-skin";static Properties={_myHandedness:hb.enum(["Left","Right"],"Left"),_myHandSkin:hb.skin(null)};start(){this._myHandednessType=ie.getHandednessByIndex(this._myHandedness),this._prepareJoints()}update(e){}_prepareJoints(){this._myJoints=[];let e=this._myHandSkin.jointIds;for(let t=0;t<e.length;t++)this._myJoints[t]=c.wrapObject(e[t])}};vn.prototype.update=function(){let i=G();return function(t){for(let n=0;n<this._myJoints.length;n++){let o=this._myJoints[n],s=o.pp_getName(),a=m.getTrackedHandPose(this._myHandednessType,this.engine).getJointPose(s);o.pp_setTransformLocalQuat(a.getTransformQuat(i,null))}}}();import{Component as QR,Property as Ct}from"@wonderlandengine/api";var xn=class extends QR{static TypeName="pp-gamepad-mesh-animator";static Properties={_myHandedness:Ct.enum(["Left","Right"],"Left"),_mySelect:Ct.object(null),_mySqueeze:Ct.object(null),_myThumbstick:Ct.object(null),_myTopButton:Ct.object(null),_myBottomButton:Ct.object(null),_mySelectRotateAngle:Ct.float(15),_mySqueezeRotateAngle:Ct.float(11),_myThumbstickRotateAngle:Ct.float(15),_myThumbstickPressOffset:Ct.float(625e-6),_myTopButtonPressOffset:Ct.float(.0015),_myBottomButtonPressOffset:Ct.float(.0015),_myUsePressForSqueeze:Ct.bool(!1),_mySqueezePressOffset:Ct.float(.0015)};start(){let e=null;this._myHandedness==vi.LEFT?e=m.getLeftGamepad(this.engine):e=m.getRightGamepad(this.engine),this._mySelect!=null&&(this._mySelectOriginalRotation=this._mySelect.pp_getRotationLocalQuat(),this._mySelectOriginalLeft=this._mySelect.pp_getLeftLocal()),this._mySqueeze!=null&&(this._mySqueezeOriginalPosition=this._mySqueeze.pp_getPositionLocal(),this._mySqueezeOriginalRotation=this._mySqueeze.pp_getRotationLocalQuat(),this._mySqueezeOriginalLeft=this._mySqueeze.pp_getLeftLocal(),this._mySqueezeOriginalForward=this._mySqueeze.pp_getForwardLocal()),this._myThumbstick!=null&&(this._myThumbstickOriginalPosition=this._myThumbstick.pp_getPositionLocal(),this._myThumbstickOriginalRotation=this._myThumbstick.pp_getRotationLocalQuat(),this._myThumbstickOriginalLeft=this._myThumbstick.pp_getLeftLocal(),this._myThumbstickOriginalUp=this._myThumbstick.pp_getUpLocal(),this._myThumbstickOriginalForward=this._myThumbstick.pp_getForwardLocal()),this._myTopButton!=null&&(this._myTopButtonOriginalPosition=this._myTopButton.pp_getPositionLocal(),this._myTopButtonOriginalUp=this._myTopButton.pp_getUpLocal()),this._myBottomButton!=null&&(this._myBottomButtonOriginalPosition=this._myBottomButton.pp_getPositionLocal(),this._myBottomButtonOriginalUp=this._myBottomButton.pp_getUpLocal()),this._myThumbstick!=null&&(e.registerButtonEventListener(E.THUMBSTICK,ae.PRESS_START,this,this._thumbstickPressedStart.bind(this)),e.registerButtonEventListener(E.THUMBSTICK,ae.PRESS_END,this,this._thumbstickPressedEnd.bind(this))),this._myTopButton!=null&&(e.registerButtonEventListener(E.TOP_BUTTON,ae.PRESS_START,this,this._topButtonPressedStart.bind(this)),e.registerButtonEventListener(E.TOP_BUTTON,ae.PRESS_END,this,this._topButtonPressedEnd.bind(this))),this._myBottomButton!=null&&(e.registerButtonEventListener(E.BOTTOM_BUTTON,ae.PRESS_START,this,this._bottomButtonPressedStart.bind(this)),e.registerButtonEventListener(E.BOTTOM_BUTTON,ae.PRESS_END,this,this._bottomButtonPressedEnd.bind(this))),this._mySelect!=null&&e.registerButtonEventListener(E.SELECT,ae.VALUE_CHANGED,this,this._selectValueChanged.bind(this)),this._mySqueeze!=null&&e.registerButtonEventListener(E.SQUEEZE,ae.VALUE_CHANGED,this,this._squeezeValueChanged.bind(this)),this._myThumbstick!=null&&e.registerAxesEventListener(ne.THUMBSTICK,Qt.AXES_CHANGED,this,this._thumbstickValueChanged.bind(this))}_thumbstickPressedStart(){}_thumbstickPressedEnd(e,t){this._myThumbstick.pp_setPositionLocal(this._myThumbstickOriginalPosition)}_topButtonPressedStart(e,t){this._myTopButton.pp_translateAxisLocal(-this._myTopButtonPressOffset,this._myTopButtonOriginalUp)}_topButtonPressedEnd(e,t){this._myTopButton.pp_setPositionLocal(this._myTopButtonOriginalPosition)}_bottomButtonPressedStart(e,t){this._myBottomButton.pp_translateAxisLocal(-this._myBottomButtonPressOffset,this._myBottomButtonOriginalUp)}_bottomButtonPressedEnd(e,t){this._myBottomButton.pp_setPositionLocal(this._myBottomButtonOriginalPosition)}_selectValueChanged(e,t){this._mySelect.pp_setRotationLocalQuat(this._mySelectOriginalRotation),e.getValue()>1e-5&&this._mySelect.pp_rotateAxisLocal(this._mySelectRotateAngle*e.getValue(),this._mySelectOriginalLeft)}_squeezeValueChanged(e,t){if(this._mySqueeze.pp_setPositionLocal(this._mySqueezeOriginalPosition),this._mySqueeze.pp_setRotationLocalQuat(this._mySqueezeOriginalRotation),e.getValue()>1e-5)if(this._myUsePressForSqueeze){let n=this._mySqueezePressOffset;this._myHandedness==1&&(n*=-1),this._mySqueeze.pp_translateAxisLocal(n*e.getValue(),this._mySqueezeOriginalLeft)}else{let n=-this._mySqueezeRotateAngle;this._myHandedness==1&&(n*=-1),this._mySqueeze.pp_rotateAxisLocal(n*e.getValue(),this._mySqueezeOriginalForward)}}_thumbstickValueChanged(e,t){this._myThumbstick.pp_setRotationLocalQuat(this._myThumbstickOriginalRotation);let n=this._myThumbstickRotateAngle*e.myAxes[1],o=this._myThumbstickRotateAngle*e.myAxes[0];Math.abs(n)>1e-4&&this._myThumbstick.pp_rotateAxisLocal(n,this._myThumbstickOriginalLeft),Math.abs(o)>1e-4&&this._myThumbstick.pp_rotateAxisLocal(o,this._myThumbstickOriginalForward)}};xn.prototype._thumbstickPressedStart=function(){let i=p();return function(t,n){this._myThumbstickOriginalUp.vec3_scale(-this._myThumbstickPressOffset,i),this._myThumbstick.pp_translateLocal(i)}}();var Wr=.15,Qr=.15;function cb(i){Wr=i}function pb(i){Qr=i}function db(){return Wr}function _b(){return Qr}function gb(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let o of t)if(o.length==1)for(let s in E)o.push(E[s]);let n=!1;for(let o of t){let s=o[0];for(let a=1;a<o.length;a++){let l=o[a];if(s.getButtonInfo(l).isPressStart(e)){n=!0;break}}if(n)break}return n}function fb(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let s of t)if(s.length==1)for(let a in E)s.push(E[a]);let n=!0,o=!1;for(let s of t){let a=s[0];for(let l=1;l<s.length;l++){let h=s[l],_=a.getButtonInfo(h);if(!(_.myPressed&&(e==null||_.myMultiplePressStartCount==e)&&_.myTimePressed<Wr)){n=!1;break}_.isPressStart(e)&&(o=!0)}if(!n)break}return n&&o}function qR(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let o of t)if(o.length==1)for(let s in E)o.push(E[s]);let n=!1;for(let o of t){let s=o[0];for(let a=1;a<o.length;a++){let l=o[a];if(s.getButtonInfo(l).isPressEnd(e)){n=!0;break}}if(n)break}return n}function Tb(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let s of t)if(s.length==1)for(let a in E)s.push(E[a]);let n=!0,o=!1;for(let s of t){let a=s[0];for(let l=1;l<s.length;l++){let h=s[l],_=a.getButtonInfo(h);if(!(!_.myPressed&&(e==null||_.myMultiplePressEndCount==e)&&_.myTimeNotPressed<Wr)){n=!1;break}_.isPressEnd(e)&&(o=!0)}if(!n)break}return n&&o}function Pb(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let o of t)if(o.length==1)for(let s in E)o.push(E[s]);let n=!1;for(let o of t){let s=o[0];for(let a=1;a<o.length;a++){let l=o[a];if(s.getButtonInfo(l).isTouchStart(e)){n=!0;break}}if(n)break}return n}function Cb(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let s of t)if(s.length==1)for(let a in E)s.push(E[a]);let n=!0,o=!1;for(let s of t){let a=s[0];for(let l=1;l<s.length;l++){let h=s[l],_=a.getButtonInfo(h);if(!(_.myTouched&&(e==null||_.myMultipleTouchStartCount==e)&&_.myTimeTouched<Qr)){n=!1;break}_.isTouchStart(e)&&(o=!0)}if(!n)break}return n&&o}function bb(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let o of t)if(o.length==1)for(let s in E)o.push(E[s]);let n=!1;for(let o of t){let s=o[0];for(let a=1;a<o.length;a++){let l=o[a];if(s.getButtonInfo(l).isTouchEnd(e)){n=!0;break}}if(n)break}return n}function Sb(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let s of t)if(s.length==1)for(let a in E)s.push(E[a]);let n=!0,o=!1;for(let s of t){let a=s[0];for(let l=1;l<s.length;l++){let h=s[l],_=a.getButtonInfo(h);if(!(!_.myTouched&&(e==null||_.myMultipleTouchEndCount==e)&&_.myTimeNotTouched<Qr)){n=!1;break}_.isTouchEnd(e)&&(o=!0)}if(!n)break}return n&&o}var XR={setSimultaneousPressMaxDelay:cb,setSimultaneousTouchMaxDelay:pb,getSimultaneousPressMaxDelay:db,getSimultaneousTouchMaxDelay:_b,isAnyButtonPressStart:gb,areButtonsPressStart:fb,areButtonsPressEnd:Tb,isAnyButtonTouchStart:Pb,areButtonsTouchStart:Cb,isAnyButtonTouchEnd:bb,areButtonsTouchEnd:Sb};import{Alignment as KR,Component as JR,Justification as ZR,MeshComponent as YR,Property as We,TextComponent as $R}from"@wonderlandengine/api";var Ho=class extends JR{static TypeName="pp-gamepad-control-scheme";static Properties={_myShowOnStart:We.bool(!0),_myHandedness:We.enum(["Left","Right"],"Left"),_mySelectText:We.string(""),_mySqueezeText:We.string(""),_myThumbstickText:We.string(""),_myBottomButtonText:We.string(""),_myTopButtonText:We.string(""),_mySelect:We.object(null),_mySqueeze:We.object(null),_myThumbstick:We.object(null),_myBottomButton:We.object(null),_myTopButton:We.object(null),_myTextScaleMultiplier:We.float(1),_myTextOffsetMultiplier:We.float(1),_myLineLengthMultiplier:We.float(1),_myLineThicknessMultiplier:We.float(1),_myDistanceFromButtonsMultiplier:We.float(1),_myTextMaterial:We.material(),_myLineMaterial:We.material()};start(){this._myTextMaterialFinal=this._myTextMaterial!=null?this._myTextMaterial:m.getDefaultMaterials(this.engine).myText.clone(),this._myLineMaterialFinal=this._myLineMaterial!=null?this._myLineMaterial:m.getDefaultMaterials(this.engine).myFlatOpaque.clone(),this._myHandednessType=ie.getHandednessByIndex(this._myHandedness),this._myControlSchemeDirection=this._myHandednessType==A.LEFT?1:-1,this._myVisible=!1,this._mySetVisibleNextUpdate=!1,this._createControlScheme(),this.setVisible(this._myShowOnStart),this._myVisibleBackup=this._myVisible}update(e){this._mySetVisibleNextUpdate&&(this._mySetVisibleNextUpdate=!1,this.setVisible(!1),this.setVisible(this._myVisibleBackup))}onActivate(){this._mySetVisibleNextUpdate=!0}onDeactivate(){this._myVisibleBackup=this._myVisible,this.setVisible(!1)}isVisible(){return this._myVisible}setVisible(e){this._myVisible=e,this._myParentObject!=null&&(this._myParentObject.pp_setActive(this._myVisible),this._myVisible&&this._hideEmptySchemes())}setSelectText(e){this._mySelectText=e,this._mySelectTextComponent.text=this._mySelectText,this.setVisible(this._myVisible)}setSqueezeText(e){this._mySqueezeText=e,this._mySqueezeTextComponent.text=this._mySqueezeText,this.setVisible(this._myVisible)}setThumbstickText(e){this._myThumbstickText=e,this._myThumbstickTextComponent.text=this._myThumbstickText,this.setVisible(this._myVisible)}setBottomButtonText(e){this._myBottomButtonText=e,this._myBottomButtonTextComponent.text=this._myBottomButtonText,this.setVisible(this._myVisible)}setTopButtonText(e){this._myTopButtonText=e,this._myTopButtonTextComponent.text=this._myTopButtonText,this.setVisible(this._myVisible)}_createControlScheme(){this._myParentObject=this.object.pp_addObject();let e=.02*this._myDistanceFromButtonsMultiplier,t=.0935*this._myLineLengthMultiplier,n=this._myThumbstick;this._mySelectObject=this._myParentObject.pp_addObject(),this._mySelectTextComponent=this._addScheme(this._mySelect,n,p(0,0,e),p(t*this._myControlSchemeDirection,0,0),this._mySelectObject),this._mySelectTextComponent.text=this._mySelectText,this._mySqueezeObject=this._myParentObject.pp_addObject(),this._mySqueezeTextComponent=this._addScheme(this._mySqueeze,n,p(e*this._myControlSchemeDirection,0,0),p(t*this._myControlSchemeDirection,0,0),this._mySqueezeObject),this._mySqueezeTextComponent.text=this._mySqueezeText,this._myThumbstickObject=this._myParentObject.pp_addObject(),this._myThumbstickTextComponent=this._addScheme(this._myThumbstick,n,p(0,e,0),p(-t*this._myControlSchemeDirection,0,0),this._myThumbstickObject),this._myThumbstickTextComponent.text=this._myThumbstickText;let o=this._myThumbstick.pp_getPositionLocal(),s=this._myThumbstick.pp_getUpLocal();{let h=this._myBottomButton.pp_getPositionLocal().vec3_sub(o).vec3_valueAlongAxis(s);this._myBottomButtonObject=this._myParentObject.pp_addObject(),this._myBottomButtonTextComponent=this._addScheme(this._myBottomButton,n,p(0,e-h,0),p(0,0,-t),this._myBottomButtonObject),this._myBottomButtonTextComponent.text=this._myBottomButtonText}{let h=this._myTopButton.pp_getPositionLocal().vec3_sub(o).vec3_valueAlongAxis(s);this._myTopButtonObject=this._myParentObject.pp_addObject(),this._myTopButtonTextComponent=this._addScheme(this._myTopButton,n,p(0,e-h,0),p(-t*this._myControlSchemeDirection,0,0).vec3_rotateAxis(-45*this._myControlSchemeDirection,p(0,1,0)),this._myTopButtonObject),this._myTopButtonTextComponent.text=this._myTopButtonText}}_addScheme(e,t,n,o,s){let a=e.pp_getPositionLocal(),l=t.pp_getForwardLocal(),h=t.pp_getRightLocal(),_=t.pp_getUpLocal(),y=a.vec3_add(h.vec3_scale(n[0]));y.vec3_add(_.vec3_scale(n[1]),y),y.vec3_add(l.vec3_scale(n[2]),y);let r=y.vec3_add(h.vec3_scale(o[0]));r.vec3_add(_.vec3_scale(o[1]),r),r.vec3_add(l.vec3_scale(o[2]),r);let u=.01*this._myTextOffsetMultiplier,g=r.vec3_add(l.vec3_scale(-u));return this._addLine(y,r,s),this._addText(g,l,_,s)}_addLine(e,t,n){let o=t.vec3_sub(e),s=o.vec3_length();o.vec3_normalize(o);let a=n.pp_addObject(),l=a.pp_addObject(),h=l.pp_addComponent(YR);h.mesh=m.getDefaultMeshes(this.engine).myCylinder,h.material=this._myLineMaterialFinal,a.pp_setPositionLocal(e);let _=.001*this._myLineThicknessMultiplier;l.pp_scaleObject(p(_/2,s/2,_/2)),l.pp_setUpLocal(o),l.pp_translateObject(p(0,s/2,0))}_addText(e,t,n,o){let s=o.pp_addObject();s.pp_setPositionLocal(e),s.pp_lookToLocal(n,t),s.pp_scaleObject(.0935*this._myTextScaleMultiplier);let a=s.pp_addComponent($R);return a.alignment=KR.Center,a.justification=ZR.Top,a.material=this._myTextMaterialFinal,a}_hideEmptySchemes(){this._mySelectText.length==0&&this._mySelectObject.pp_setActive(!1),this._mySqueezeText.length==0&&this._mySqueezeObject.pp_setActive(!1),this._myThumbstickText.length==0&&this._myThumbstickObject.pp_setActive(!1),this._myBottomButtonText.length==0&&this._myBottomButtonObject.pp_setActive(!1),this._myTopButtonText.length==0&&this._myTopButtonObject.pp_setActive(!1)}};var no=class extends It{constructor(e,t){super(t),this._myVirtualGamepad=e,this._myButtonData=this._createButtonData(),this._myAxesData=this._createAxesData(),this._myHapticActuators=[]}isGamepadCoreActive(){return this._myVirtualGamepad.isVisible()}getButtonData(e){return this._myButtonData.myPressed=!1,this._myButtonData.myTouched=!1,this._myButtonData.myValue=0,this.isGamepadCoreActive()&&this._myVirtualGamepad.isButtonPressed(this.getHandedness(),e)&&(this._myButtonData.myPressed=!0,this._myButtonData.myTouched=!0,this._myButtonData.myValue=1),this._myButtonData}getAxesData(e){return this._myAxesData.vec2_zero(),this.isGamepadCoreActive()&&this._myVirtualGamepad.getAxes(this.getHandedness(),e,this._myAxesData),this._myAxesData}getHapticActuators(){return this._myHapticActuators}};var Oe={NONE:0,LABEL:1,IMAGE:2,DOT:3,CIRCLE:4,SQUARE:5,RING:6,FRAME:7},oo=class{constructor(){this.myBackgroundColor="",this.myBackgroundPressedColor="",this.myIconColor="",this.myIconPressedColor="",this.myIconType=Oe.NONE,this.myOverallHoveredBrightness=1,this.myLabel="",this.myLabelFontSize=0,this.myLabelFontFamily="",this.myLabelFontWeight="",this.myImageURL="",this.myImagePressedBrightness=1}},rn=class{constructor(e,t,n,o,s=m.getMainEngine()){this._myEngine=s,this._myParams=t,this._myIconContainerElement=null,this._myBackgroundElement=null,this._myIconElement=null,this._myPressed=!1,this._myMouseHover=!1,this._myMouseHoverEnabled=!0,this._myDestroyed=!1,this._build(e,n,o)}update(e){this._myPressed||!this._myMouseHover||!this._myMouseHoverEnabled?this._myIconContainerElement.style.filter="none":this._myIconContainerElement.style.filter="brightness("+this._myParams.myOverallHoveredBrightness+")"}reset(){this.setPressed(!1),this._myMouseHover=!1,this._myIconContainerElement.style.filter="none"}setPressed(e){this._myPressed!=e&&(this._myPressed=e,this._myPressed?(this._myBackgroundElement.style.fill=this._myParams.myBackgroundPressedColor,this._myIconElement!=null&&(this._myIconElement.style.strokeWidth.length>0?this._myIconElement.style.stroke=this._myParams.myIconPressedColor:this._myIconElement.style.fill=this._myParams.myIconPressedColor,this._myParams.myIconType==Oe.IMAGE&&(this._myIconElement.style.filter="brightness("+this._myParams.myImagePressedBrightness+")"))):(this._myBackgroundElement.style.fill=this._myParams.myBackgroundColor,this._myIconElement!=null&&(this._myIconElement.style.strokeWidth.length>0?this._myIconElement.style.stroke=this._myParams.myIconColor:this._myIconElement.style.fill=this._myParams.myIconColor,this._myParams.myIconType==Oe.IMAGE&&(this._myIconElement.style.filter="none"))))}onMouseEnter(){this._myMouseHover=!0}onMouseLeave(){this._myMouseHover=!1}setMouseHoverEnabled(e){this._myMouseHoverEnabled=e}_build(e,t,n){switch(this._myIconContainerElement=m.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","svg"),this._myIconContainerElement.style.position="absolute",this._myIconContainerElement.style.width="100%",this._myIconContainerElement.style.height="100%",e.appendChild(this._myIconContainerElement),this._myBackgroundElement=m.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","circle"),this._myBackgroundElement.setAttributeNS(null,"cx","50%"),this._myBackgroundElement.setAttributeNS(null,"cy","50%"),this._myBackgroundElement.setAttributeNS(null,"r","50%"),this._myBackgroundElement.style.fill=this._myParams.myBackgroundColor,this._myIconContainerElement.appendChild(this._myBackgroundElement),this._myParams.myIconType){case Oe.NONE:break;case Oe.LABEL:this._myIconElement=m.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","text"),this._myIconElement.setAttributeNS(null,"x","50%"),this._myIconElement.setAttributeNS(null,"y","50%"),this._myIconElement.style.textAlign="center",this._myIconElement.style.textAnchor="middle",this._myIconElement.style.dominantBaseline="central",this._myIconElement.style.alignmentBaseline="central",this._myIconElement.style.fontFamily=this._myParams.myLabelFontFamily,this._myIconElement.style.fontWeight=this._myParams.myLabelFontWeight,this._myIconElement.style.fontSize=this._createSizeValue(this._myParams.myLabelFontSize*n,t),this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconElement.textContent=this._myParams.myLabel,this._myIconContainerElement.appendChild(this._myIconElement);break;case Oe.IMAGE:this._myIconElement=m.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","image"),this._myIconElement.setAttributeNS(null,"x","0%"),this._myIconElement.setAttributeNS(null,"y","0%"),this._myIconElement.setAttribute("href",this._myParams.myImageURL),this._myIconElement.style.width="100%",this._myIconElement.style.height="100%",this._myIconElement.style.filter="none",this._myIconContainerElement.appendChild(this._myIconElement);break;case Oe.DOT:this._myIconElement=m.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","circle"),this._myIconElement.setAttributeNS(null,"cx","50%"),this._myIconElement.setAttributeNS(null,"cy","50%"),this._myIconElement.setAttributeNS(null,"r","17.5%"),this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconContainerElement.appendChild(this._myIconElement);break;case Oe.CIRCLE:this._myIconElement=m.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","circle"),this._myIconElement.setAttributeNS(null,"cx","50%"),this._myIconElement.setAttributeNS(null,"cy","50%"),this._myIconElement.setAttributeNS(null,"r","24%"),this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconContainerElement.appendChild(this._myIconElement);break;case Oe.SQUARE:this._myIconElement=m.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","rect"),this._myIconElement.setAttributeNS(null,"x","28%"),this._myIconElement.setAttributeNS(null,"y","28%"),this._myIconElement.setAttributeNS(null,"rx","10%"),this._myIconElement.setAttributeNS(null,"ry","10%"),this._myIconElement.setAttributeNS(null,"width","44%"),this._myIconElement.setAttributeNS(null,"height","44%"),this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconElement.style.transformOrigin="center",this._myIconContainerElement.appendChild(this._myIconElement);break;case Oe.RING:this._myIconElement=m.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","circle"),this._myIconElement.setAttributeNS(null,"cx","50%"),this._myIconElement.setAttributeNS(null,"cy","50%"),this._myIconElement.setAttributeNS(null,"r","20%"),this._myIconElement.style.fill="#00000000",this._myIconElement.style.stroke=this._myParams.myIconColor,this._myIconElement.style.strokeWidth="10%",this._myIconContainerElement.appendChild(this._myIconElement);break;case Oe.FRAME:this._myIconElement=m.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","rect"),this._myIconElement.setAttributeNS(null,"x","31.5%"),this._myIconElement.setAttributeNS(null,"y","31.5%"),this._myIconElement.setAttributeNS(null,"rx","10%"),this._myIconElement.setAttributeNS(null,"ry","10%"),this._myIconElement.setAttributeNS(null,"width","37%"),this._myIconElement.setAttributeNS(null,"height","37%"),this._myIconElement.style.fill="#00000000",this._myIconElement.style.stroke=this._myParams.myIconColor,this._myIconElement.style.strokeWidth="10%",this._myIconElement.style.transformOrigin="center",this._myIconContainerElement.appendChild(this._myIconElement);break}}_createSizeValue(e,t){return"min("+e.toFixed(3)+"vmax,"+(e*t).toFixed(3)+"vw)"}_invertColors(){this._myIconElement.style.strokeWidth.length>0?(this._myBackgroundElement.style.fill=this._myParams.myIconColor,this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconElement.style.stroke=this._myParams.myBackgroundColor):(this._myBackgroundElement.style.fill=this._myParams.myIconColor,this._myIconElement.style.fill=this._myParams.myBackgroundColor)}destroy(){this._myDestroyed=!0,this._myIconContainerElement.remove()}isDestroyed(){return this._myDestroyed}};var Mt=class{constructor(){this.myIconParams=new oo}},ia=class{constructor(){this.myBackgroundColor="",this.myMaxDistanceFromCenterMultiplier=1,this.myReleaseTransitionSeconds=.2,this.myMoveTransitionSeconds=0,this.myIncludeBackgroundToDetection=!1,this.myIconParams=new oo}},ln=class{constructor(e=m.getMainEngine()){this.myShowOnDesktop=!1,this.myShowOnMobile=!1,this.myShowOnHeadset=!1,this.myAutoUpdateVisibility=!1,this.myOpacity=1,this.myInterfaceScale=1,this.myMarginScale=1,this.myReleaseOnPointerLeave=!0,this.myStopPropagatingMouseDownEvents=!0,this.myButtonParams=[],this.myButtonParams[A.LEFT]=[],this.myButtonParams[A.RIGHT]=[],this.myButtonParams[A.LEFT][E.SELECT]=new Mt,this.myButtonParams[A.LEFT][E.SQUEEZE]=new Mt,this.myButtonParams[A.LEFT][E.THUMBSTICK]=new Mt,this.myButtonParams[A.LEFT][E.TOP_BUTTON]=new Mt,this.myButtonParams[A.LEFT][E.BOTTOM_BUTTON]=new Mt,this.myButtonParams[A.RIGHT][E.SELECT]=new Mt,this.myButtonParams[A.RIGHT][E.SQUEEZE]=new Mt,this.myButtonParams[A.RIGHT][E.THUMBSTICK]=new Mt,this.myButtonParams[A.RIGHT][E.TOP_BUTTON]=new Mt,this.myButtonParams[A.RIGHT][E.BOTTOM_BUTTON]=new Mt,this.myThumbstickParams=[],this.myThumbstickParams[A.LEFT]=[],this.myThumbstickParams[A.RIGHT]=[],this.myThumbstickParams[A.LEFT][ne.THUMBSTICK]=new ia,this.myThumbstickParams[A.RIGHT][ne.THUMBSTICK]=new ia,this.myButtonsOrder=[],this.myButtonsOrder[A.LEFT]=[null,null,null,null,null],this.myButtonsOrder[A.RIGHT]=[null,null,null,null,null],this.myThumbsticksOrder=[],this.myThumbsticksOrder[A.LEFT]=[null],this.myThumbsticksOrder[A.RIGHT]=[null],this.myValidPointerButtons=[],this.myMarginLeft=0,this.myMarginRight=0,this.myMarginBottom=0,this.myThumbstickSize=0,this.myButtonSize=0,this.myButtonsRingRadius=0,this.myButtonsRingStartAngle=0,this.myButtonsRingEndAngle=0,this.myFontSize=0,this.myMinSizeMultiplier=0,this.myDisableMouseHoverWhenPressed=!1,this.myEngine=e}defaultConfig(){this.myShowOnMobile=!0,this.myAutoUpdateVisibility=!0,this.myOpacity=.5;let e="#616161",t="#e0e0e0",n=.75,o=.75,s=!0;for(let a in this.myButtonParams)for(let l in this.myButtonParams[a]){let h=this.myButtonParams[a][l];h.myIconParams.myBackgroundColor=e,h.myIconParams.myBackgroundPressedColor=t,h.myIconParams.myIconColor=t,h.myIconParams.myIconPressedColor=e,h.myIconParams.myOverallHoveredBrightness=n}this.myButtonParams[A.LEFT][E.SQUEEZE].myIconParams.myIconType=Oe.SQUARE,this.myButtonParams[A.RIGHT][E.SQUEEZE].myIconParams.myIconType=Oe.SQUARE,this.myButtonParams[A.LEFT][E.SELECT].myIconParams.myIconType=Oe.FRAME,this.myButtonParams[A.RIGHT][E.SELECT].myIconParams.myIconType=Oe.FRAME,this.myButtonParams[A.LEFT][E.TOP_BUTTON].myIconParams.myIconType=Oe.CIRCLE,this.myButtonParams[A.RIGHT][E.TOP_BUTTON].myIconParams.myIconType=Oe.CIRCLE,this.myButtonParams[A.LEFT][E.BOTTOM_BUTTON].myIconParams.myIconType=Oe.RING,this.myButtonParams[A.RIGHT][E.BOTTOM_BUTTON].myIconParams.myIconType=Oe.RING,this.myButtonParams[A.LEFT][E.THUMBSTICK].myIconParams.myIconType=Oe.DOT,this.myButtonParams[A.RIGHT][E.THUMBSTICK].myIconParams.myIconType=Oe.DOT;for(let a in this.myThumbstickParams)for(let l in this.myThumbstickParams[a]){let h=this.myThumbstickParams[a][l];h.myBackgroundColor=e,h.myIconParams.myBackgroundColor=t,h.myIconParams.myBackgroundPressedColor=t,h.myIconParams.myIconColor=e,h.myIconParams.myIconPressedColor=e,h.myIconParams.myOverallHoveredBrightness=o,h.myIncludeBackgroundToDetection=s}this.myButtonsOrder[A.LEFT][0]=[A.LEFT,E.SQUEEZE],this.myButtonsOrder[A.LEFT][1]=[A.LEFT,E.SELECT],this.myButtonsOrder[A.LEFT][2]=[A.LEFT,E.TOP_BUTTON],this.myButtonsOrder[A.LEFT][3]=[A.LEFT,E.BOTTOM_BUTTON],this.myButtonsOrder[A.LEFT][4]=[A.LEFT,E.THUMBSTICK],this.myButtonsOrder[A.RIGHT][0]=[A.RIGHT,E.SQUEEZE],this.myButtonsOrder[A.RIGHT][1]=[A.RIGHT,E.SELECT],this.myButtonsOrder[A.RIGHT][2]=[A.RIGHT,E.TOP_BUTTON],this.myButtonsOrder[A.RIGHT][3]=[A.RIGHT,E.BOTTOM_BUTTON],this.myButtonsOrder[A.RIGHT][4]=[A.RIGHT,E.THUMBSTICK],this.myThumbsticksOrder[A.LEFT][0]=[A.LEFT,ne.THUMBSTICK],this.myThumbsticksOrder[A.RIGHT][0]=[A.RIGHT,ne.THUMBSTICK],this.myMarginLeft=3,this.myMarginRight=3,this.myMarginBottom=3,this.myThumbstickSize=15,this.myButtonSize=5,this.myButtonsRingRadius=12,this.myButtonsRingStartAngle=385,this.myButtonsRingEndAngle=245,this.myMinSizeMultiplier=5/3,this.myDisableMouseHoverWhenPressed=!0,this.myValidPointerButtons=[0]}};var na=class{constructor(e,t,n,o,s,a){this._myButtonElement=null,this._myButtonIcon=null,this._myButtonDetectionElement=null,this._myActive=!0,this._myPointerID=null,this._myPointerButton=null,this._myPressed=!1,this._myVirtualGamepadParams=t,this._myParams=this._myVirtualGamepadParams.myButtonParams[s][a],this._build(e,n,o),this._myPointerDownEventListener=this._onPointerDown.bind(this,this._myVirtualGamepadParams.myStopPropagatingPointerDownEvents),this._myPointerUpEventListener=this._onPointerUp.bind(this),this._myPointerLeaveEventListener=this._onPointerLeave.bind(this),this._myMouseEnterEventListener=this._onButtonEnter.bind(this),this._myMouseLeaveEventListener=this._onButtonLeave.bind(this),this._myButtonDetectionElement.addEventListener("pointerdown",this._myPointerDownEventListener),m.getBody(this._myVirtualGamepadParams.myEngine).addEventListener("pointerup",this._myPointerUpEventListener),this._myVirtualGamepadParams.myReleaseOnPointerLeave&&m.getBody(this._myVirtualGamepadParams.myEngine).addEventListener("pointerleave",this._myPointerLeaveEventListener),this._myButtonDetectionElement.addEventListener("mouseenter",this._myMouseEnterEventListener),this._myButtonDetectionElement.addEventListener("mouseleave",this._myMouseLeaveEventListener),this._myDestroyed=!1}isPressed(){return this._myActive&&this._myPressed}setActive(e){this._myActive!=e&&(this.reset(),this._myButtonIcon.reset()),this._myActive=e}setMouseHoverEnabled(e){this._myButtonIcon.setMouseHoverEnabled(e)}reset(){this._myButtonIcon.setPressed(!1),this._myPressed=!1,this._myPointerID=null,this._myPointerButton=null}update(e){this._myButtonIcon.update(e)}_onPointerDown(e,t){this._myActive&&(this._myPressed||this._myVirtualGamepadParams.myValidPointerButtons.pp_hasEqual(t.button)&&(e&&t.stopPropagation(),t.preventDefault(),this._myButtonIcon.setPressed(!0),this._myPointerID=t.pointerId,this._myPointerButton=t.button,this._myPressed=!0))}_onPointerUp(e){this._myActive&&this._myPressed&&this._myPointerID==e.pointerId&&(this._myPointerButton!=null&&this._myPointerButton!=e.button||this.reset())}_onPointerLeave(e){this._myActive&&this._myPointerID==e.pointerId&&this.reset()}_onButtonEnter(e){this._myActive&&this._myButtonIcon.onMouseEnter(e)}_onButtonLeave(e){this._myActive&&this._myButtonIcon.onMouseLeave(e)}_build(e,t,n){let o=this._myVirtualGamepadParams.myButtonSize*this._myVirtualGamepadParams.myInterfaceScale,s=this._myVirtualGamepadParams.myButtonsRingRadius*this._myVirtualGamepadParams.myInterfaceScale,a=this._myVirtualGamepadParams.myThumbstickSize*this._myVirtualGamepadParams.myInterfaceScale,l=this._myVirtualGamepadParams.myMarginBottom*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,h=this._myVirtualGamepadParams.myMarginLeft*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,_=this._myVirtualGamepadParams.myMarginRight*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,y=this._myVirtualGamepadParams.myButtonsRingStartAngle,r=this._myVirtualGamepadParams.myButtonsRingEndAngle,u=Math.max(1,this._myVirtualGamepadParams.myMinSizeMultiplier/this._myVirtualGamepadParams.myInterfaceScale),g=this._myVirtualGamepadParams.myButtonsOrder[A.LEFT].length,P=(r-y)/(g-1),C=Math.pp_angleClamp(y+P*n);t==A.RIGHT&&(C=270+(270-C),C=Math.pp_angleClamp(C,!0));let f=360-C;this._myButtonContainer=m.getDocument(this._myVirtualGamepadParams.myEngine).createElement("div"),this._myButtonContainer.style.position="absolute",this._myButtonContainer.style.width=this._createSizeValue(o,u),this._myButtonContainer.style.height=this._createSizeValue(o,u);let S=l+a/2-o/2;if(this._myButtonContainer.style.bottom=this._createSizeValue(S,u),t==A.LEFT){let b=h+a/2-o/2;this._myButtonContainer.style.left=this._createSizeValue(b,u)}else{let b=_+a/2-o/2;this._myButtonContainer.style.right=this._createSizeValue(b,u)}this._myButtonContainer.style.transform="rotate("+C+"deg) translateX("+this._createSizeValue(s,u)+")",e.appendChild(this._myButtonContainer),this._myButtonElement=m.getDocument(this._myVirtualGamepadParams.myEngine).createElement("div"),this._myButtonElement.style.position="absolute",this._myButtonElement.style.width="100%",this._myButtonElement.style.height="100%",this._myButtonElement.style.transform="rotate("+f+"deg)",this._myButtonContainer.appendChild(this._myButtonElement),this._myButtonIcon=new rn(this._myButtonElement,this._myParams.myIconParams,u,this._myVirtualGamepadParams.myInterfaceScale,this._myVirtualGamepadParams.myEngine);let M=m.getDocument(this._myVirtualGamepadParams.myEngine).createElement("div");M.style.position="absolute",M.style.width="100%",M.style.height="100%",M.style.transform="rotate("+f+"deg)",this._myButtonContainer.appendChild(M);let D=m.getDocument(this._myVirtualGamepadParams.myEngine).createElementNS("http://www.w3.org/2000/svg","svg");D.style.position="absolute",D.style.width="100%",D.style.height="100%",M.appendChild(D);let v=m.getDocument(this._myVirtualGamepadParams.myEngine).createElementNS("http://www.w3.org/2000/svg","circle");v.setAttributeNS(null,"cx","50%"),v.setAttributeNS(null,"cy","50%"),v.setAttributeNS(null,"r","50%"),v.style.fill="#00000000",D.appendChild(v),this._myButtonDetectionElement=v}_createSizeValue(e,t){return"min("+e.toFixed(3)+"vmax,"+(e*t).toFixed(3)+"vw)"}destroy(){this._myDestroyed=!0,this._myButtonDetectionElement.removeEventListener("pointerdown",this._myPointerDownEventListener),m.getBody(this._myVirtualGamepadParams.myEngine).removeEventListener("pointerup",this._myPointerUpEventListener),m.getBody(this._myVirtualGamepadParams.myEngine).removeEventListener("pointerleave",this._myPointerLeaveEventListener),this._myButtonDetectionElement.removeEventListener("mouseenter",this._myMouseEnterEventListener),this._myButtonDetectionElement.removeEventListener("mouseleave",this._myPointerUpEventLis_myMouseLeaveEventListenertener),this._myButtonIcon.destroy(),this._myButtonContainer.remove()}isDestroyed(){return this._myDestroyed}};var oa=class{constructor(e,t,n,o,s){this._myThumbstickElement=null,this._myThumbstickIcon=null,this._myThumbstickBackground=null,this._myThumbstickDetectionElement=null,this._myActive=!0,this._myPointerID=null,this._myPointerButton=null,this._myThumbstickDragStartPosition=Ce(),this._myAxes=Ce(),this._myPressed=!1,this._myVirtualGamepadParams=t,this._myParams=this._myVirtualGamepadParams.myThumbstickParams[o][s],this._build(e,n),this._myPointerDownEventListener=this._onPointerDown.bind(this,this._myVirtualGamepadParams.myStopPropagatingPointerDownEvents),this._myPointerUpEventListener=this._onPointerUp.bind(this),this._myPointerMoveEventListener=this._onPointerMove.bind(this),this._myPointerLeaveEventListener=this._onPointerLeave.bind(this),this._myMouseEnterEventListener=this._onThumbstickEnter.bind(this),this._myMouseLeaveEventListener=this._onThumbstickLeave.bind(this),this._myThumbstickDetectionElement.addEventListener("pointerdown",this._myPointerDownEventListener),m.getBody(this._myVirtualGamepadParams.myEngine).addEventListener("pointerup",this._myPointerUpEventListener),m.getBody(this._myVirtualGamepadParams.myEngine).addEventListener("pointermove",this._myPointerMoveEventListener),this._myVirtualGamepadParams.myReleaseOnPointerLeave&&m.getBody(this._myVirtualGamepadParams.myEngine).addEventListener("pointerleave",this._myPointerLeaveEventListener),this._myThumbstickDetectionElement.addEventListener("mouseenter",this._myMouseEnterEventListener),this._myThumbstickDetectionElement.addEventListener("mouseleave",this._myMouseLeaveEventListener),this._myDestroyed=!1}isPressed(){return this._myActive&&this._myPressed}getAxes(){return this._myAxes}setActive(e){this._myActive!=e&&(this.reset(),this._myThumbstickIcon.reset()),this._myActive=e}setMouseHoverEnabled(e){this._myThumbstickIcon.setMouseHoverEnabled(e)}reset(){this._myThumbstickIcon.setPressed(!1),this._myAxes[0]=0,this._myAxes[1]=0,this._myPressed=!1,this._myPointerID=null,this._myPointerButton=null,this._myThumbstickElement.style.transition="all "+this._myParams.myReleaseTransitionSeconds+"s ease 0s",this._myThumbstickElement.style.transform="translate(0px, 0px)"}update(e){this._myThumbstickIcon.update(e)}_onPointerDown(e,t){this._myActive&&(this._myPressed||this._myVirtualGamepadParams.myValidPointerButtons.pp_hasEqual(t.button)&&(e&&t.stopPropagation(),t.preventDefault(),this._myThumbstickIcon.setPressed(!0),this._myPointerID=t.pointerId,this._myPointerButton=t.button,this._myThumbstickDragStartPosition[0]=t.clientX,this._myThumbstickDragStartPosition[1]=t.clientY,this._myPressed=!0))}_onPointerUp(e){this._myActive&&this._myPressed&&this._myPointerID==e.pointerId&&(this._myPointerButton!=null&&this._myPointerButton!=e.button||this.reset())}_onPointerLeave(e){this._myActive&&this._myPointerID==e.pointerId&&this.reset()}_onThumbstickEnter(e){this._myThumbstickIcon.onMouseEnter(e)}_onThumbstickLeave(e){this._myThumbstickIcon.onMouseLeave(e)}_onPointerMove(e){if(!this._myActive||!this._myPressed||e.pointerId!=this._myPointerID)return;let t=e.clientX,n=e.clientY,s=this._myThumbstickBackground.getBoundingClientRect().width/2*this._myParams.myMaxDistanceFromCenterMultiplier,a=t-this._myThumbstickDragStartPosition[0],l=n-this._myThumbstickDragStartPosition[1],h=Math.atan2(l,a),_=Math.min(s,Math.hypot(a,l)),y=_*Math.cos(h),r=_*Math.sin(h);this._myThumbstickElement.style.transition="all "+this._myParams.myMoveTransitionSeconds+"s ease-out 0s",this._myThumbstickElement.style.transform="translate("+y+"px, "+r+"px)",this._myAxes[0]=y/s,this._myAxes[1]=-(r/s)}_build(e,t){let n=this._myVirtualGamepadParams.myThumbstickSize*this._myVirtualGamepadParams.myInterfaceScale,o=this._myVirtualGamepadParams.myMarginBottom*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,s=this._myVirtualGamepadParams.myMarginLeft*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,a=this._myVirtualGamepadParams.myMarginRight*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,l=Math.max(1,this._myVirtualGamepadParams.myMinSizeMultiplier/this._myVirtualGamepadParams.myInterfaceScale);this._myThumbstickContainer=m.getDocument(this._myVirtualGamepadParams.myEngine).createElement("div"),this._myThumbstickContainer.style.position="absolute",this._myThumbstickContainer.style.width=this._createSizeValue(n,l),this._myThumbstickContainer.style.height=this._createSizeValue(n,l),this._myThumbstickContainer.style.bottom=this._createSizeValue(o,l),t==A.LEFT?this._myThumbstickContainer.style.left=this._createSizeValue(s,l):this._myThumbstickContainer.style.right=this._createSizeValue(a,l),e.appendChild(this._myThumbstickContainer);let h=m.getDocument(this._myVirtualGamepadParams.myEngine).createElementNS("http://www.w3.org/2000/svg","svg");if(h.style.position="absolute",h.style.width="100%",h.style.height="100%",this._myThumbstickContainer.appendChild(h),this._myThumbstickBackground=m.getDocument(this._myVirtualGamepadParams.myEngine).createElementNS("http://www.w3.org/2000/svg","circle"),this._myThumbstickBackground.setAttributeNS(null,"cx","50%"),this._myThumbstickBackground.setAttributeNS(null,"cy","50%"),this._myThumbstickBackground.setAttributeNS(null,"r","48%"),this._myThumbstickBackground.style.fill=this._myParams.myBackgroundColor,h.appendChild(this._myThumbstickBackground),this._myThumbstickElement=m.getDocument(this._myVirtualGamepadParams.myEngine).createElement("div"),this._myThumbstickElement.style.position="absolute",this._myThumbstickElement.style.width="34%",this._myThumbstickElement.style.height="34%",this._myThumbstickElement.style.top="33%",this._myThumbstickElement.style.left="33%",this._myThumbstickContainer.appendChild(this._myThumbstickElement),this._myThumbstickIcon=new rn(this._myThumbstickElement,this._myParams.myIconParams,l,this._myVirtualGamepadParams.myScale,this._myVirtualGamepadParams.myEngine),this._myParams.myIncludeBackgroundToDetection){let _=m.getDocument(this._myVirtualGamepadParams.myEngine).createElementNS("http://www.w3.org/2000/svg","svg");_.style.position="absolute",_.style.width="100%",_.style.height="100%",this._myThumbstickContainer.appendChild(_);let y=m.getDocument(this._myVirtualGamepadParams.myEngine).createElementNS("http://www.w3.org/2000/svg","circle");y.setAttributeNS(null,"cx","50%"),y.setAttributeNS(null,"cy","50%"),y.setAttributeNS(null,"r","48%"),y.style.fill="#00000000",_.appendChild(y),this._myThumbstickDetectionElement=y}else{let _=m.getDocument(this._myVirtualGamepadParams.myEngine).createElement("div");_.style.position="absolute",_.style.width="34%",_.style.height="34%",_.style.top="33%",_.style.left="33%",this._myThumbstickContainer.appendChild(_);let y=m.getDocument(this._myVirtualGamepadParams.myEngine).createElementNS("http://www.w3.org/2000/svg","svg");y.style.position="absolute",y.style.width="100%",y.style.height="100%",_.appendChild(y);let r=m.getDocument(this._myVirtualGamepadParams.myEngine).createElementNS("http://www.w3.org/2000/svg","circle");r.setAttributeNS(null,"cx","50%"),r.setAttributeNS(null,"cy","50%"),r.setAttributeNS(null,"r","50%"),r.style.fill="#00000000",y.appendChild(r),this._myThumbstickDetectionElement=r}}_createSizeValue(e,t){return"min("+e.toFixed(3)+"vmax,"+(e*t).toFixed(3)+"vw)"}destroy(){this._myDestroyed=!0,this._myThumbstickDetectionElement.removeEventListener("pointerdown",this._myPointerDownEventListener),m.getBody(this._myVirtualGamepadParams.myEngine).removeEventListener("pointerup",this._myPointerUpEventListener),m.getBody(this._myVirtualGamepadParams.myEngine).removeEventListener("pointermove",this._myPointerMoveEventListener),m.getBody(this._myVirtualGamepadParams.myEngine).removeEventListener("pointerleave",this._myPointerLeaveEventListener),this._myThumbstickDetectionElement.removeEventListener("mouseenter",this._myMouseEnterEventListener),this._myThumbstickDetectionElement.removeEventListener("mouseleave",this._myPointerUpEventLis_myMouseLeaveEventListenertener),this._myThumbstickIcon.destroy(),this._myThumbstickContainer.remove()}isDestroyed(){return this._myDestroyed}};var sa=class{constructor(e=new ln){this._myParams=e,this._myVisible=!0,this._myVirtualGamepadContainer=null,this._myVirtualGamepadVirtualButtons=[],this._myVirtualGamepadVirtualButtons[A.LEFT]=[],this._myVirtualGamepadVirtualButtons[A.RIGHT]=[],this._myVirtualGamepadVirtualButtons[A.LEFT][E.SELECT]=null,this._myVirtualGamepadVirtualButtons[A.LEFT][E.SQUEEZE]=null,this._myVirtualGamepadVirtualButtons[A.LEFT][E.THUMBSTICK]=null,this._myVirtualGamepadVirtualButtons[A.LEFT][E.TOP_BUTTON]=null,this._myVirtualGamepadVirtualButtons[A.LEFT][E.BOTTOM_BUTTON]=null,this._myVirtualGamepadVirtualButtons[A.RIGHT][E.SELECT]=null,this._myVirtualGamepadVirtualButtons[A.RIGHT][E.SQUEEZE]=null,this._myVirtualGamepadVirtualButtons[A.RIGHT][E.THUMBSTICK]=null,this._myVirtualGamepadVirtualButtons[A.RIGHT][E.TOP_BUTTON]=null,this._myVirtualGamepadVirtualButtons[A.RIGHT][E.BOTTOM_BUTTON]=null,this._myButtonsAmount=this._myVirtualGamepadVirtualButtons[A.LEFT].length,this._myVirtualGamepadVirtualThumbsticks=[],this._myVirtualGamepadVirtualThumbsticks[A.LEFT]=[],this._myVirtualGamepadVirtualThumbsticks[A.RIGHT]=[],this._myVirtualGamepadVirtualThumbsticks[A.LEFT][ne.THUMBSTICK]=null,this._myVirtualGamepadVirtualThumbsticks[A.RIGHT][ne.THUMBSTICK]=null,this._myGestureStartEventListener=null,this._myDestroyed=!1}isVisible(){return this._myVisible}setVisible(e){if(this._myVisible!=e&&(this._myVisible=e,this._myVirtualGamepadContainer!=null)){this._myVisible?this._myVirtualGamepadContainer.style.display="block":this._myVirtualGamepadContainer.style.display="none";for(let t in this._myVirtualGamepadVirtualButtons)for(let n in this._myVirtualGamepadVirtualButtons[t]){let o=this._myVirtualGamepadVirtualButtons[t][n];o?.setActive(this._myVisible)}for(let t in this._myVirtualGamepadVirtualThumbsticks)for(let n in this._myVirtualGamepadVirtualThumbsticks[t]){let o=this._myVirtualGamepadVirtualThumbsticks[t][n];o?.setActive(this._myVisible)}}}isButtonPressed(e,t){if(!this._myVisible)return!1;let n=this._myVirtualGamepadVirtualButtons[e][t];return n!=null?n.isPressed():!1}getAxes(e,t,n=Ce(0,0)){if(!this._myVisible)return n;let o=this._myVirtualGamepadVirtualThumbsticks[e][t];return o!=null&&n.vec2_copy(o.getAxes()),n}start(){this._buildVirtualGamepad();let e=this._myVisible;this._myVisible=!this._myVisible,this.setVisible(e)}update(e){if(this._myParams.myAutoUpdateVisibility&&(O.isSessionActive(this._myParams.myEngine)&&O.isVRSupported(this._myParams.myEngine)?this.setVisible(!1):this._myParams.myShowOnDesktop&&ti.isDesktop()&&!O.isVRSupported(this._myParams.myEngine)?this.setVisible(!0):this._myParams.myShowOnHeadset&&ti.isDesktop()&&O.isVRSupported(this._myParams.myEngine)?this.setVisible(!0):this._myParams.myShowOnMobile&&ti.isMobile()?this.setVisible(!0):this.setVisible(!1)),this._myVisible){for(let t in this._myVirtualGamepadVirtualButtons)for(let n in this._myVirtualGamepadVirtualButtons[t]){let o=this._myVirtualGamepadVirtualButtons[t][n];o?.update(e)}for(let t in this._myVirtualGamepadVirtualThumbsticks)for(let n in this._myVirtualGamepadVirtualThumbsticks[t]){let o=this._myVirtualGamepadVirtualThumbsticks[t][n];o?.update(e)}this._setMouseHoverEnabled(!(this._myParams.myDisableMouseHoverWhenPressed&&this._isAnyElementPressed()))}}_buildVirtualGamepad(){this._setupDocumentBody(),this._myVirtualGamepadContainer=m.getDocument(this._myParams.myEngine).createElement("div"),this._myVirtualGamepadContainer.style.display="block",this._myVirtualGamepadContainer.style.opacity=this._myParams.myOpacity.toString(),m.getBody(this._myParams.myEngine).appendChild(this._myVirtualGamepadContainer);let e=m.getDocument(this._myParams.myEngine).createElement("div");this._myVirtualGamepadContainer.appendChild(e);let t=m.getDocument(this._myParams.myEngine).createElement("div");this._myVirtualGamepadContainer.appendChild(t);let n=this._myParams.myButtonsOrder[A.LEFT].length;for(let s=0;s<n;s++){if(this._myParams.myButtonsOrder[A.LEFT][s]!=null){let a=this._myParams.myButtonsOrder[A.LEFT][s][0],l=this._myParams.myButtonsOrder[A.LEFT][s][1];this._buildButton(e,A.LEFT,s,a,l)}if(this._myParams.myButtonsOrder[A.RIGHT][s]!=null){let a=this._myParams.myButtonsOrder[A.RIGHT][s][0],l=this._myParams.myButtonsOrder[A.RIGHT][s][1];this._buildButton(t,A.RIGHT,s,a,l)}}let o=this._myParams.myThumbsticksOrder[A.LEFT].length;for(let s=0;s<o;s++){if(this._myParams.myThumbsticksOrder[A.LEFT][s]!=null){let a=this._myParams.myThumbsticksOrder[A.LEFT][s][0],l=this._myParams.myThumbsticksOrder[A.LEFT][s][1];this._buildThumbstick(e,A.LEFT,a,l)}if(this._myParams.myThumbsticksOrder[A.RIGHT][s]!=null){let a=this._myParams.myThumbsticksOrder[A.RIGHT][s][0],l=this._myParams.myThumbsticksOrder[A.RIGHT][s][1];this._buildThumbstick(t,A.RIGHT,a,l)}}}_setupDocumentBody(){m.getBody(this._myParams.myEngine).style.overflow="hidden",m.getBody(this._myParams.myEngine).style.userSelect="none",m.getBody(this._myParams.myEngine).style.webkitUserSelect="none",m.getBody(this._myParams.myEngine).style.webkitTapHighlightColor="transparent",m.getBody(this._myParams.myEngine).style.touchAction="none",this._myGestureStartEventListener=function(e){e.preventDefault()},m.getDocument(this._myParams.myEngine).addEventListener("gesturestart",this._myGestureStartEventListener)}_buildButton(e,t,n,o,s){let a=new na(e,this._myParams,t,n,o,s);this._myVirtualGamepadVirtualButtons[o][s]=a}_buildThumbstick(e,t,n,o){let s=new oa(e,this._myParams,t,n,o);this._myVirtualGamepadVirtualThumbsticks[n][o]=s}_createSizeValue(e,t){return"min("+e.toFixed(3)+"vmax,"+(e*t).toFixed(3)+"vw)"}_isAnyElementPressed(){let e=!1;for(let t in this._myVirtualGamepadVirtualButtons)for(let n in this._myVirtualGamepadVirtualButtons[t]){let o=this._myVirtualGamepadVirtualButtons[t][n];if(o!=null&&o.isPressed()){e=!0;break}}if(!e)for(let t in this._myVirtualGamepadVirtualThumbsticks)for(let n in this._myVirtualGamepadVirtualThumbsticks[t]){let o=this._myVirtualGamepadVirtualThumbsticks[t][n];if(o!=null&&o.isPressed()){e=!0;break}}return e}_setMouseHoverEnabled(e){for(let t in this._myVirtualGamepadVirtualButtons)for(let n in this._myVirtualGamepadVirtualButtons[t]){let o=this._myVirtualGamepadVirtualButtons[t][n];o?.setMouseHoverEnabled(e)}for(let t in this._myVirtualGamepadVirtualThumbsticks)for(let n in this._myVirtualGamepadVirtualThumbsticks[t]){let o=this._myVirtualGamepadVirtualThumbsticks[t][n];o?.setMouseHoverEnabled(e)}}destroy(){this._myDestroyed=!0,m.getDocument(this._myParams.myEngine).removeEventListener("gesturestart",this._myGestureStartEventListener);for(let e in this._myVirtualGamepadVirtualButtons)for(let t in this._myVirtualGamepadVirtualButtons[e]){let n=this._myVirtualGamepadVirtualButtons[e][t];n?.destroy()}for(let e in this._myVirtualGamepadVirtualThumbsticks)for(let t in this._myVirtualGamepadVirtualThumbsticks[e]){let n=this._myVirtualGamepadVirtualThumbsticks[e][t];n?.destroy()}this._myVirtualGamepadContainer.remove()}isDestroyed(){return this._myDestroyed}};import{Component as eV,Property as J}from"@wonderlandengine/api";var ko=class extends eV{static TypeName="pp-virtual-gamepad";static Properties={_myShowOnDesktop:J.bool(!1),_myShowOnMobile:J.bool(!0),_myShowOnHeadset:J.bool(!1),_myAddToUniversalGamepad:J.bool(!0),_myOpacity:J.float(.5),_myIconColor:J.string("#e0e0e0"),_myBackgroundColor:J.string("#616161"),_myInterfaceScale:J.float(1),_myMarginScale:J.float(1),ADVANCED_PARAMS_BELOW:J.string(""),_myLabelFontSize:J.float(2),_myLabelFontFamily:J.string("sans-serif"),_myLabelFontWeight:J.string("bold"),_myImagePressedBrightness:J.float(.5),_myLeftSelectButtonVisible:J.bool(!0),_myLeftSelectButtonOrderIndex:J.int(1),_myLeftSelectButtonIconType:J.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Frame"),_myLeftSelectButtonIconLabelOrImageUrl:J.string(""),_myLeftSqueezeButtonVisible:J.bool(!0),_myLeftSqueezeButtonOrderIndex:J.int(0),_myLeftSqueezeButtonIconType:J.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Square"),_myLeftSqueezeButtonIconLabelOrImageUrl:J.string(""),_myLeftThumbstickButtonVisible:J.bool(!0),_myLeftThumbstickButtonOrderIndex:J.int(4),_myLeftThumbstickButtonIconType:J.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Dot"),_myLeftThumbstickButtonIconLabelOrImageUrl:J.string(""),_myLeftTopButtonVisible:J.bool(!0),_myLeftTopButtonOrderIndex:J.int(2),_myLeftTopButtonIconType:J.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Circle"),_myLeftTopButtonIconLabelOrImageUrl:J.string(""),_myLeftBottomButtonVisible:J.bool(!0),_myLeftBottomButtonOrderIndex:J.int(3),_myLeftBottomButtonIconType:J.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Ring"),_myLeftBottomButtonIconLabelOrImageUrl:J.string(""),_myRightSelectButtonVisible:J.bool(!0),_myRightSelectButtonOrderIndex:J.int(1),_myRightSelectButtonIconType:J.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Frame"),_myRightSelectButtonIconLabelOrImageUrl:J.string(""),_myRightSqueezeButtonVisible:J.bool(!0),_myRightSqueezeButtonOrderIndex:J.int(0),_myRightSqueezeButtonIconType:J.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Square"),_myRightSqueezeButtonIconLabelOrImageUrl:J.string(""),_myRightThumbstickButtonVisible:J.bool(!0),_myRightThumbstickButtonOrderIndex:J.int(4),_myRightThumbstickButtonIconType:J.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Dot"),_myRightThumbstickButtonIconLabelOrImageUrl:J.string(""),_myRightTopButtonVisible:J.bool(!0),_myRightTopButtonOrderIndex:J.int(2),_myRightTopButtonIconType:J.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Circle"),_myRightTopButtonIconLabelOrImageUrl:J.string(""),_myRightBottomButtonVisible:J.bool(!0),_myRightBottomButtonOrderIndex:J.int(3),_myRightBottomButtonIconType:J.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Ring"),_myRightBottomButtonIconLabelOrImageUrl:J.string("")};start(){let e=new ln(this.engine);e.defaultConfig();for(let t in e.myButtonParams)for(let n in e.myButtonParams[t]){let o=e.myButtonParams[t][n];o.myIconParams.myBackgroundColor=this._myBackgroundColor,o.myIconParams.myBackgroundPressedColor=this._myIconColor,o.myIconParams.myIconColor=this._myIconColor,o.myIconParams.myIconPressedColor=this._myBackgroundColor}for(let t in e.myThumbstickParams)for(let n in e.myThumbstickParams[t]){let o=e.myThumbstickParams[t][n];o.myBackgroundColor=this._myBackgroundColor,o.myIconParams.myBackgroundColor=this._myIconColor,o.myIconParams.myBackgroundPressedColor=this._myIconColor,o.myIconParams.myIconColor=this._myBackgroundColor,o.myIconParams.myIconPressedColor=this._myBackgroundColor}e.myOpacity=this._myOpacity,e.myInterfaceScale=this._myInterfaceScale,e.myMarginScale=this._myMarginScale,e.myShowOnDesktop=this._myShowOnDesktop,e.myShowOnMobile=this._myShowOnMobile,e.myShowOnHeadset=this._myShowOnHeadset,e.myShowOnDesktop||e.myShowOnMobile||e.myShowOnHeadset?e.myAutoUpdateVisibility=!0:e.myAutoUpdateVisibility=!1,this._advancedConfig(e),this._myVirtualGamepad=new sa(e),this._myVirtualGamepad.setVisible(!1),this._myVirtualGamepad.start(),this._myFirstUpdate=!0,this._myLeftVirtualGamepadGamepadCore=null,this._myRightVirtualGamepadGamepadCore=null}update(e){this._myFirstUpdate&&(this._myFirstUpdate=!1,this._myAddToUniversalGamepad&&(this._myLeftVirtualGamepadGamepadCore=new no(this._myVirtualGamepad,m.getLeftGamepad(this.engine).getGamepadCore("pp_left_xr_gamepad").getHandPose()),this._myRightVirtualGamepadGamepadCore=new no(this._myVirtualGamepad,m.getRightGamepad(this.engine).getGamepadCore("pp_right_xr_gamepad").getHandPose()),m.getLeftGamepad(this.engine).addGamepadCore("pp_left_virtual_gamepad",this._myLeftVirtualGamepadGamepadCore),m.getRightGamepad(this.engine).addGamepadCore("pp_right_virtual_gamepad",this._myRightVirtualGamepadGamepadCore))),this._myVirtualGamepad.update(e)}_advancedConfig(e){e.myButtonsOrder[A.LEFT]=[null,null,null,null,null],e.myButtonsOrder[A.RIGHT]=[null,null,null,null,null];{let t=e.myButtonParams[A.LEFT][E.SELECT];t.myIconParams.myIconType=this._myLeftSelectButtonIconType,t.myIconParams.myLabel=this._myLeftSelectIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myLeftSelectIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftSelectButtonVisible&&(e.myButtonsOrder[A.LEFT][this._myLeftSelectButtonOrderIndex]=[A.LEFT,E.SELECT])}{let t=e.myButtonParams[A.LEFT][E.SQUEEZE];t.myIconParams.myIconType=this._myLeftSqueezeButtonIconType,t.myIconParams.myLabel=this._myLeftSqueezeIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myLeftSqueezeIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftSqueezeButtonVisible&&(e.myButtonsOrder[A.LEFT][this._myLeftSqueezeButtonOrderIndex]=[A.LEFT,E.SQUEEZE])}{let t=e.myButtonParams[A.LEFT][E.THUMBSTICK];t.myIconParams.myIconType=this._myLeftThumbstickButtonIconType,t.myIconParams.myLabel=this._myLeftThumbstickButtonIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myLeftThumbstickButtonIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftThumbstickButtonVisible&&(e.myButtonsOrder[A.LEFT][this._myLeftThumbstickButtonOrderIndex]=[A.LEFT,E.THUMBSTICK])}{let t=e.myButtonParams[A.LEFT][E.TOP_BUTTON];t.myIconParams.myIconType=this._myLeftTopButtonIconType,t.myIconParams.myLabel=this._myLeftTopButtonIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myLeftTopButtonIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftTopButtonVisible&&(e.myButtonsOrder[A.LEFT][this._myLeftTopButtonOrderIndex]=[A.LEFT,E.TOP_BUTTON])}{let t=e.myButtonParams[A.LEFT][E.BOTTOM_BUTTON];t.myIconParams.myIconType=this._myLeftBottomButtonIconType,t.myIconParams.myLabel=this._myLeftBottomButtonIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myLeftBottomButtonIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftBottomButtonVisible&&(e.myButtonsOrder[A.LEFT][this._myLeftBottomButtonOrderIndex]=[A.LEFT,E.BOTTOM_BUTTON])}{let t=e.myButtonParams[A.RIGHT][E.SELECT];t.myIconParams.myIconType=this._myRightSelectButtonIconType,t.myIconParams.myLabel=this._myRightSelectIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myRightSelectIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightSelectButtonVisible&&(e.myButtonsOrder[A.RIGHT][this._myRightSelectButtonOrderIndex]=[A.RIGHT,E.SELECT])}{let t=e.myButtonParams[A.RIGHT][E.SQUEEZE];t.myIconParams.myIconType=this._myRightSqueezeButtonIconType,t.myIconParams.myLabel=this._myRightSqueezeIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myRightSqueezeIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightSqueezeButtonVisible&&(e.myButtonsOrder[A.RIGHT][this._myRightSqueezeButtonOrderIndex]=[A.RIGHT,E.SQUEEZE])}{let t=e.myButtonParams[A.RIGHT][E.THUMBSTICK];t.myIconParams.myIconType=this._myRightThumbstickButtonIconType,t.myIconParams.myLabel=this._myRightThumbstickButtonIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myRightThumbstickButtonIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightThumbstickButtonVisible&&(e.myButtonsOrder[A.RIGHT][this._myRightThumbstickButtonOrderIndex]=[A.RIGHT,E.THUMBSTICK])}{let t=e.myButtonParams[A.RIGHT][E.TOP_BUTTON];t.myIconParams.myIconType=this._myRightTopButtonIconType,t.myIconParams.myLabel=this._myRightTopButtonIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myRightTopButtonIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightTopButtonVisible&&(e.myButtonsOrder[A.RIGHT][this._myRightTopButtonOrderIndex]=[A.RIGHT,E.TOP_BUTTON])}{let t=e.myButtonParams[A.RIGHT][E.BOTTOM_BUTTON];t.myIconParams.myIconType=this._myRightBottomButtonIconType,t.myIconParams.myLabel=this._myRightBottomButtonIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myRightBottomButtonIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightBottomButtonVisible&&(e.myButtonsOrder[A.RIGHT][this._myRightBottomButtonOrderIndex]=[A.RIGHT,E.BOTTOM_BUTTON])}}onDestroy(){m.getLeftGamepad(this.engine)?.removeGamepadCore("pp_left_virtual_gamepad"),m.getRightGamepad(this.engine)?.removeGamepadCore("pp_right_virtual_gamepad"),this._myLeftVirtualGamepadGamepadCore.destroy(),this._myRightVirtualGamepadGamepadCore.destroy(),this._myVirtualGamepad.destroy()}};import{Component as tV,Property as vb}from"@wonderlandengine/api";var Fo=class extends tV{static TypeName="pp-set-player-height";static Properties={_myEyesHeight:vb.float(1.65),_mySetOnlyOnStart:vb.bool(!1)};start(){let e=this.object.pp_getPositionLocal();this.object.pp_setPositionLocal(p(e[0],this._myEyesHeight,e[2])),this._myHeightSetOnce=!1,O.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this.engine)}_onXRSessionStart(){if(this.active&&(!this._mySetOnlyOnStart||!this._myHeightSetOnce)){let e=this.object.pp_getPositionLocal();O.isReferenceSpaceFloorBased(this.engine)?this.object.pp_setPositionLocal(p(e[0],0,e[2])):O.isDeviceEmulated()?this.object.pp_setPositionLocal(p(e[0],0,e[2])):this.object.pp_setPositionLocal(p(e[0],this._myEyesHeight,e[2])),this._myHeightSetOnce=!0}}_onXRSessionEnd(){if(this.active&&!this._mySetOnlyOnStart){let e=this.object.pp_getPositionLocal();this.object.pp_setPositionLocal(p(e[0],this._myEyesHeight,e[2]))}}};import{Component as iV,Property as nV}from"@wonderlandengine/api";var Mn=class extends iV{static TypeName="pp-set-hand-local-transform";static Properties={_myHandedness:nV.enum(["Left","Right"],"Left")};start(){this._myHandednessType=ie.getHandednessByIndex(this._myHandedness),m.getHandPose(this._myHandednessType,this.engine).registerPoseUpdatedEventListener(this,this.onPoseUpdated.bind(this))}onPoseUpdated(){}onDestroy(){m.getHandPose(this._myHandednessType,this.engine)?.unregisterPoseUpdatedEventListener(this)}};Mn.prototype.onPoseUpdated=function(){let i=G();return function(t){this.active&&O.isSessionActive(this.engine)&&t.isValid()&&this.object.pp_setTransformLocalQuat(t.getTransformQuat(i,null))}}();import{Component as oV}from"@wonderlandengine/api";var zi=class extends oV{static TypeName="pp-set-head-local-transform";static Properties={};start(){m.getHeadPose(this.engine).registerPoseUpdatedEventListener(this,this.onPoseUpdated.bind(this))}update(e){}onPoseUpdated(){}onDestroy(){m.getHeadPose(this.engine)?.unregisterPoseUpdatedEventListener(this)}};zi.prototype.update=function(){let i=w(),e=p(),t=p();return function(o){if(!O.isSessionActive(this.engine)){let s=m.getPlayerObjects(this.engine).myCameraNonXR;i=s.pp_getRotationLocalQuat(i),m.isPoseForwardFixed(this.engine)&&i.quat_rotateAxisRadians(Math.PI,i.quat_getUp(e),i),this.object.pp_setPositionLocal(s.pp_getPositionLocal(t)),this.object.pp_setRotationLocalQuat(i)}}}();zi.prototype.onPoseUpdated=function(){let i=G();return function(t){this.active&&O.isSessionActive(this.engine)&&t.isValid()&&this.object.pp_setTransformLocalQuat(t.getTransformQuat(i,null))}}();import{Component as sV,Property as ym}from"@wonderlandengine/api";var Dn=class extends sV{static TypeName="pp-set-tracked-hand-joint-local-transform";static Properties={_myHandedness:ym.enum(["Left","Right"],"Left"),_mySetLocalScaleAsJointRadius:ym.bool(!1),_myJointID:ym.enum(["Wrist","Thumb Metacarpal","Thumb Phalanx Proximal","Thumb Phalanx Distal","Thumb Tip","Index Metacarpal","Index Phalanx Proximal","Index Phalanx Intermediate","Index Phalanx Distal","Index Tip","Middle Metacarpal","Middle Phalanx Proximal","Middle Phalanx Intermediate","Middle Phalanx Distal","Middle Tip","Ring Metacarpal","Ring Phalanx Proximal","Ring Phalanx Intermediate","Ring Phalanx Distal","Ring Tip","Pinky Metacarpal","Pinky Phalanx Proximal","Pinky Phalanx Intermediate","Pinky Phalanx Distal","Pinky Tip"],"Wrist")};start(){this._myHandednessType=ie.getHandednessByIndex(this._myHandedness),this._myJointIDType=ie.getJointIDByIndex(this._myJointID),m.getTrackedHandPose(this._myHandednessType,this.engine).getJointPose(this._myJointIDType).registerPoseUpdatedEventListener(this,this.onPoseUpdated.bind(this))}onPoseUpdated(){}onDestroy(){m.getTrackedHandPose(this._myHandednessType,this.engine)?.getJointPose(this._myJointIDType)?.unregisterPoseUpdatedEventListener(this)}};Dn.prototype.onPoseUpdated=function(){let i=G();return function(t){this.active&&O.isSessionActive(this.engine)&&t.isValid()&&(this.object.pp_setTransformLocalQuat(t.getTransformQuat(i,null)),this._mySetLocalScaleAsJointRadius&&this.object.pp_setScaleLocal(t.getJointRadius()))}}();import{Component as aV,Property as rV}from"@wonderlandengine/api";var wo=class extends aV{static TypeName="pp-copy-hand-transform";static Properties={_myHandedness:rV.enum(["Left","Right"],"Left")};init(){this._myHandednessType=ie.getHandednessByIndex(this._myHandedness)}update(e){let t=m.getPlayerObjects(this.engine).myHands[this._myHandednessType];this.object.pp_setTransformQuat(t.pp_getTransformQuat()),this.object.pp_setScale(t.pp_getScale())}};import{Component as lV}from"@wonderlandengine/api";var jo=class extends lV{static TypeName="pp-copy-head-transform";static Properties={};update(e){let t=m.getPlayerObjects(this.engine).myHead;this.object.pp_setTransformQuat(t.pp_getTransformQuat()),this.object.pp_setScale(t.pp_getScale())}};import{Component as mV}from"@wonderlandengine/api";var zo=class extends mV{static TypeName="pp-copy-player-transform";static Properties={};update(e){let t=m.getPlayerObjects(this.engine).myPlayer;this.object.pp_setTransformQuat(t.pp_getTransformQuat()),this.object.pp_setScale(t.pp_getScale())}};import{Component as yV}from"@wonderlandengine/api";var Go=class extends yV{static TypeName="pp-copy-reference-space-transform";static Properties={};update(e){let t=m.getPlayerObjects(this.engine).myReferenceSpace;this.object.pp_setTransformQuat(t.pp_getTransformQuat()),this.object.pp_setScale(t.pp_getScale())}};var W={NONE:null,LEFT:"left",RIGHT:"right"},Ae={NONE:null,GAMEPAD:0,TRACKED_HAND:1};import{Component as uV,MeshComponent as xb,Property as aa,ViewComponent as hV}from"@wonderlandengine/api";import{Cursor as Mb,CursorTarget as cV}from"@wonderlandengine/components";var En=class extends uV{static TypeName="pp-tool-cursor";static Properties={_myHandedness:aa.enum(["Left","Right"],"Left"),_myApplyDefaultCursorOffset:aa.bool(!0),_myPulseOnHover:aa.bool(!1),_myShowFingerCursor:aa.bool(!1),_myUpdatePointerCursorStyle:aa.bool(!0)};init(){this._myHandednessType=ie.getHandednessByIndex(this._myHandedness),this._myCursorPositionDefaultOffset=p(0,-.035,.05),this._myCursorRotationDefaultOffset=p(30,0,0),this._myCursorMeshScale=p(.0025,.0025,.0025),this._myCursorColor=F(255/255,255/255,255/255,1),this._myCursorTargetCollisionGroup=7,this._myStarted=!1}start(){if(m.isToolEnabled(this.engine)){this._myToolCursorObject=this.object.pp_addObject(),this._myCursorObjectXR=this._myToolCursorObject.pp_addObject(),this._myApplyDefaultCursorOffset&&(this._myCursorObjectXR.pp_setPositionLocal(this._myCursorPositionDefaultOffset),this._myCursorObjectXR.pp_rotateObject(this._myCursorRotationDefaultOffset));{this._myCursorMeshobject=this._myCursorObjectXR.pp_addObject(),this._myCursorMeshobject.pp_setScale(this._myCursorMeshScale);let n=this._myCursorMeshobject.pp_addComponent(xb);n.mesh=m.getDefaultMeshes(this.engine).mySphere,n.material=m.getDefaultMaterials(this.engine).myFlatOpaque.clone(),n.material.color=this._myCursorColor,this._myCursorComponentXR=this._myCursorObjectXR.pp_addComponent(Mb,{collisionGroup:this._myCursorTargetCollisionGroup,handedness:this._myHandedness+1,cursorObject:this._myCursorMeshobject,styleCursor:!1}),this._myCursorComponentXR.rayCastMode=0,this._myPulseOnHover&&this._myCursorComponentXR.globalTarget.onHover.add(this._pulseOnHover.bind(this),{id:this})}this._myCursorObjectNonXR=this._myToolCursorObject.pp_addObject(),this._myCursorComponentNonXR=this._myCursorObjectNonXR.pp_addComponent(Mb,{collisionGroup:this._myCursorTargetCollisionGroup,handedness:this._myHandedness+1,styleCursor:this._myUpdatePointerCursorStyle}),this._myCursorComponentNonXR.rayCastMode=0,this._myPulseOnHover&&this._myCursorComponentNonXR.globalTarget.onHover.add(this._pulseOnHover.bind(this),{id:this}),this._myCursorComponentNonXR.pp_setViewComponent(m.getPlayerObjects(this.engine).myCameraNonXR.pp_getComponent(hV));let e=null,t=.0125;if(this._myShowFingerCursor){e=this._myToolCursorObject.pp_addObject();let n=e.pp_addComponent(xb);n.mesh=m.getDefaultMeshes(this.engine).mySphere,n.material=m.getDefaultMaterials(this.engine).myFlatOpaque.clone(),n.material.color=this._myCursorColor,e.pp_setScale(t)}this._myFingerCursorObject=this._myToolCursorObject.pp_addObject(),this._myFingerCursorComponent=this._myFingerCursorObject.pp_addComponent(ji,{_myHandedness:this._myHandedness,_myMultipleClicksEnabled:!0,_myCollisionGroup:this._myCursorTargetCollisionGroup,_myCollisionSize:t,_myCursorObject:e}),this._myCursorComponentXR.active=!1,this._myCursorComponentNonXR.active=!1,this._myFingerCursorComponent.active=!1,this._myStarted=!0}}update(e){}_isUsingHand(){let e=!1;if(O.getSession(this.engine)&&O.getSession(this.engine).inputSources!=null)for(let t=0;t<O.getSession(this.engine).inputSources.length;t++){let n=O.getSession(this.engine).inputSources[t];if(n.hand&&n.handedness==this._myHandednessType){e=!0;break}}return e}_pulseOnHover(e){let t=e.pp_getComponent(cV);t&&!t.isSurface&&(this._myHandedness==0?m.getLeftGamepad(this.engine)!=null&&m.getLeftGamepad(this.engine).pulse(.4,0):m.getRightGamepad(this.engine)!=null&&m.getRightGamepad(this.engine).pulse(.4,0))}onDestroy(){this._myStarted&&(this._myCursorComponentXR.globalTarget.onHover.remove(this),this._myCursorComponentNonXR.globalTarget.onHover.remove(this))}};En.prototype.update=function(){let i=G();return function(t){if(m.isToolEnabled(this.engine)&&this._myStarted){let n=this._isUsingHand();this._myFingerCursorComponent.active=n,n?(this._myCursorComponentXR.active=!1,this._myCursorComponentNonXR.active=!1):O.isSessionActive(this.engine)?(this._myCursorComponentXR.active=!n,this._myCursorComponentNonXR.active=!1):(this._myCursorComponentNonXR.active=!n,this._myCursorComponentXR.active=!1,this._myCursorObjectNonXR.pp_setTransformQuat(m.getPlayerObjects(this.engine).myCameraNonXR.pp_getTransformQuat(i)))}}}();import{Alignment as Db,Collider as pV,Justification as Eb}from"@wonderlandengine/api";var re={DEBUG:0,WARN:1,ERROR:2,LOG:3,INFO:4,ASSERT:5},Ie={BROWSER_CONSOLE:0,CONSOLE_VR:1,WINDOW:2},ra={NEVER:0,ALWAYS:1,WHEN_HIDDEN:2},H={DEBUG:0,WARN:1,ERROR:2,LOG:3};var la=class{constructor(){this._setupBuildConfig(),this._setupRuntimeConfig()}_setupBuildConfig(){this.myBackgroundColor=F(46/255,46/255,46/255,1),this.myCursorTargetCollisionCollider=pV.Box,this.myCursorTargetCollisionGroup=7,this.myCursorTargetCollisionThickness=.001,this.myDefaultTextColor=F(255/255,255/255,255/255,1),this.myTextAlignment=Db.Center,this.myTextJustification=Eb.Middle,this.myTextColor=this.myDefaultTextColor,this.myMessageTypeColors=[],this.myMessageTypeColors[H.LOG]=this.myDefaultTextColor,this.myMessageTypeColors[H.ERROR]=F(255/255,40/255,40/255,1),this.myMessageTypeColors[H.WARN]=F(250/255,220/255,40/255,1),this.myMessageTypeColors[H.DEBUG]=F(60/255,200/255,255/255,1),this.myMessagesPanelPosition=p(0,.075,0),this.myMessagesBackgroundScale=p(.34,.15,1);{let e=.03,t=e*this.myMessagesBackgroundScale[0]/this.myMessagesBackgroundScale[1]*.8,n=-this.myMessagesBackgroundScale[0]+this.myMessagesBackgroundScale[0]*e,o=this.myMessagesBackgroundScale[1]-this.myMessagesBackgroundScale[1]*t;this.myMessagesTextsPanelPosition=p(n,o,.007)}this.myMessagesTextsPanelScale=p(.1,.1,.1),this.myMessagesTextStartString=`.
`,this.myMessagesTextAlignment=Db.Left,this.myMessagesTextJustification=Eb.Top,this.myMessagesTextPositions=[],this.myMessagesTextPositions[H.LOG]=p(0,0,2e-4),this.myMessagesTextPositions[H.ERROR]=p(0,0,0),this.myMessagesTextPositions[H.WARN]=p(0,0,0),this.myMessagesTextPositions[H.DEBUG]=p(0,0,0),this.myMessagesTextColors=[],this.myMessagesTextColors[H.LOG]=this.myMessageTypeColors[H.LOG],this.myMessagesTextColors[H.ERROR]=this.myMessageTypeColors[H.ERROR],this.myMessagesTextColors[H.WARN]=this.myMessageTypeColors[H.WARN],this.myMessagesTextColors[H.DEBUG]=this.myMessageTypeColors[H.DEBUG],this.myButtonsPanelPosition=p(0,-.11,.015),this.myButtonBackgroundScale=p(.04,.02,1),this.myButtonTextPosition=p(0,0,.007),this.myButtonTextScale=p(.18,.18,.18),this.myButtonCursorTargetPosition=p(0,0,0),this.myButtonCursorTargetPosition[2]=this.myButtonTextPosition[2],this.myButtonsCollisionCollider=this.myCursorTargetCollisionCollider,this.myButtonsCollisionGroup=this.myCursorTargetCollisionGroup,this.myButtonsCollisionExtents=this.myButtonBackgroundScale.pp_clone(),this.myButtonsCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myClearButtonTextLabel="clear",this.myUpButtonTextLabel="up",this.myDownButtonTextLabel="down",this.myFilterButtonsTextColors=[],this.myFilterButtonsTextColors[H.LOG]=this.myMessageTypeColors[H.LOG],this.myFilterButtonsTextColors[H.ERROR]=this.myMessageTypeColors[H.ERROR],this.myFilterButtonsTextColors[H.WARN]=this.myMessageTypeColors[H.WARN],this.myFilterButtonsTextColors[H.DEBUG]=this.myMessageTypeColors[H.DEBUG],this.myFilterButtonsTextLabel=[],this.myFilterButtonsTextLabel[H.LOG]="log",this.myFilterButtonsTextLabel[H.ERROR]="error",this.myFilterButtonsTextLabel[H.WARN]="warn",this.myFilterButtonsTextLabel[H.DEBUG]="debug";{let e=7,t=Math.max(.68,this.myButtonBackgroundScale[0]*e),n=2+3+4+4+1+2,o=Math.max((t-e*this.myButtonBackgroundScale[0]*2)/n,0),s=this.myButtonBackgroundScale[0],a=-t/2;this.myFilterButtonsPositions=[],this.myFilterButtonsPositions[H.LOG]=[a+o*2+s,0,0],this.myFilterButtonsPositions[H.ERROR]=[this.myFilterButtonsPositions[H.LOG][0]+s+o+s,0,0],this.myFilterButtonsPositions[H.WARN]=[this.myFilterButtonsPositions[H.ERROR][0]+s+o+s,0,0],this.myFilterButtonsPositions[H.DEBUG]=[this.myFilterButtonsPositions[H.WARN][0]+s+o+s,0,0],this.myClearButtonPosition=[this.myFilterButtonsPositions[H.DEBUG][0]+s+o*4+s,0,0],this.myUpButtonPosition=[this.myClearButtonPosition[0]+s+o*4+s,0,0],this.myDownButtonPosition=[this.myUpButtonPosition[0]+s+o+s,0,0]}this.myNotifyIconBackgroundScale=p(.01,.01,1),this.myNotifyIconPanelPositions=[],this.myNotifyIconPanelPositions[W.NONE]=p(0,0,0),this.myNotifyIconPanelPositions[W.NONE][0]=-this.myMessagesBackgroundScale[0]+this.myNotifyIconBackgroundScale[0]+.01,this.myNotifyIconPanelPositions[W.NONE][1]=-this.myMessagesBackgroundScale[1]+this.myNotifyIconBackgroundScale[1]+.01,this.myNotifyIconPanelPositions[W.NONE][2]=this.myMessagesTextsPanelPosition[2]-1e-5,this.myNotifyIconPanelPositions[W.LEFT]=this.myNotifyIconPanelPositions[W.NONE],this.myNotifyIconPanelPositions[W.RIGHT]=this.myNotifyIconPanelPositions[W.NONE],this.myNotifyIconCursorTargetPosition=p(0,0,0),this.myNotifyIconCursorTargetPosition[2]=this.myButtonsPanelPosition[2]+this.myButtonTextPosition[2]-this.myMessagesTextsPanelPosition[2],this.myNotifyIconCollisionExtents=this.myNotifyIconBackgroundScale.pp_clone(),this.myNotifyIconCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myNotifyIconColor=F(210/255,210/255,210/255,1),this.myPointerCollisionCollider=this.myCursorTargetCollisionCollider,this.myPointerCollisionGroup=this.myCursorTargetCollisionGroup;{let e=Math.abs(this.myMessagesPanelPosition[1]-this.myMessagesBackgroundScale[1]-(this.myButtonsPanelPosition[1]+this.myButtonBackgroundScale[1])),t=this.myMessagesBackgroundScale[1]+this.myButtonBackgroundScale[1]+e/2;this.myPointerCollisionExtents=p(this.myMessagesBackgroundScale[0],t,this.myCursorTargetCollisionThickness)}this.myPointerCursorTargetPosition=p(0,0,0),this.myPointerCursorTargetPosition[1]=this.myMessagesPanelPosition[1]+this.myMessagesBackgroundScale[1]-this.myPointerCollisionExtents[1],this.myPointerCursorTargetPosition[2]=this.myButtonsPanelPosition[2]+this.myButtonTextPosition[2]-1e-4}_setupRuntimeConfig(){this.myTabString="     ",this.myAssertStartString="Assertion failed:",this.myMaxCharactersPerLine=100,this.myMaxLineSplits=500,this.myMaxLines=22,this.myMaxMessages=2e3,this.myMaxMessagesDeletePad=2e3,this.myLinesBetweenMessages=1,this.myButtonHoverColor=F(150/255,150/255,150/255,1),this.myButtonDisabledTextColor=this.myBackgroundColor,this.myButtonDisabledBackgroundColor=F(110/255,110/255,110/255,1),this.myFilterButtonDisabledTextColor=this.myButtonDisabledTextColor,this.myFilterButtonDisabledBackgroundColor=this.myButtonDisabledBackgroundColor,this.myScrollDelay=.1,this.myScrollAmount=1,this.myScrollThumbstickHandedness=W.RIGHT,this.myScrollThumbstickDelay=.1,this.myScrollThumbstickMinThreshold=.2,this.myScrollThumbstickAmount=3,this.myPulseDelay=5,this.myPulseIntensity=.3,this.myPulseDuration=.085,this.myClearBrowserConsoleWhenClearPressed=!0,this.myGamepadScrollOnlyOnHover=!0}};import{CollisionComponent as so,MeshComponent as ao,TextComponent as ma}from"@wonderlandengine/api";import{CursorTarget as ro}from"@wonderlandengine/components";var ya=class{constructor(e=m.getMainEngine()){this._myEngine=e,this._myDestroyed=!1}build(e,t,n){this._myParentObject=e,this._myConfig=t,this._myParams=n,this._myPlaneMesh=m.getDefaultMeshes(this._myEngine).myDoubleSidedPlane,this._createSkeleton(),this._setTransforms(),this._addComponents(),this._setTransformForNonXR(),O.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this._myEngine)}setVisible(e){this.myPivotObject.pp_setActive(e)}_createSkeleton(){this.myPivotObject=this._myParentObject.pp_addObject(),this._createMessagesSkeleton(),this._createButtonsSkeleton(),this._createPointerSkeleton()}_createMessagesSkeleton(){this.myMessagesPanel=this.myPivotObject.pp_addObject(),this.myMessagesBackground=this.myMessagesPanel.pp_addObject(),this.myMessagesTextsPanel=this.myMessagesPanel.pp_addObject(),this.myMessagesTexts=[];for(let e in H)this.myMessagesTexts[H[e]]=this.myMessagesTextsPanel.pp_addObject();this.myNotifyIconPanel=this.myMessagesPanel.pp_addObject(),this.myNotifyIconBackground=this.myNotifyIconPanel.pp_addObject(),this.myNotifyIconCursorTarget=this.myNotifyIconPanel.pp_addObject()}_createButtonsSkeleton(){this.myButtonsPanel=this.myPivotObject.pp_addObject(),this.myFilterButtonsPanels=[],this.myFilterButtonsBackgrounds=[],this.myFilterButtonsTexts=[],this.myFilterButtonsCursorTargets=[];for(let e in H)this.myFilterButtonsPanels[H[e]]=this.myButtonsPanel.pp_addObject(),this.myFilterButtonsBackgrounds[H[e]]=this.myFilterButtonsPanels[H[e]].pp_addObject(),this.myFilterButtonsTexts[H[e]]=this.myFilterButtonsPanels[H[e]].pp_addObject(),this.myFilterButtonsCursorTargets[H[e]]=this.myFilterButtonsPanels[H[e]].pp_addObject();this.myClearButtonPanel=this.myButtonsPanel.pp_addObject(),this.myClearButtonBackground=this.myClearButtonPanel.pp_addObject(),this.myClearButtonText=this.myClearButtonPanel.pp_addObject(),this.myClearButtonCursorTarget=this.myClearButtonPanel.pp_addObject(),this.myUpButtonPanel=this.myButtonsPanel.pp_addObject(),this.myUpButtonBackground=this.myUpButtonPanel.pp_addObject(),this.myUpButtonText=this.myUpButtonPanel.pp_addObject(),this.myUpButtonCursorTarget=this.myUpButtonPanel.pp_addObject(),this.myDownButtonPanel=this.myButtonsPanel.pp_addObject(),this.myDownButtonBackground=this.myDownButtonPanel.pp_addObject(),this.myDownButtonText=this.myDownButtonPanel.pp_addObject(),this.myDownButtonCursorTarget=this.myDownButtonPanel.pp_addObject()}_createPointerSkeleton(){this.myPointerCursorTarget=this.myPivotObject.pp_addObject()}_setTransforms(){this.myPivotObject.pp_markDirty(),this._setMessagesTransforms(),this._setButtonsTransforms(),this._setPointerTransform()}_setMessagesTransforms(){this.myMessagesPanel.pp_setPositionLocal(this._myConfig.myMessagesPanelPosition),this.myMessagesBackground.pp_scaleObject(this._myConfig.myMessagesBackgroundScale),this.myMessagesTextsPanel.pp_setPositionLocal(this._myConfig.myMessagesTextsPanelPosition),this.myMessagesTextsPanel.pp_scaleObject(this._myConfig.myMessagesTextsPanelScale);for(let e in H)this.myMessagesTexts[H[e]].pp_setPositionLocal(this._myConfig.myMessagesTextPositions[H[e]]);this.myNotifyIconPanel.pp_setPositionLocal(this._myConfig.myNotifyIconPanelPositions[this._myParams.myHandedness]),this.myNotifyIconBackground.pp_scaleObject(this._myConfig.myNotifyIconBackgroundScale),this.myNotifyIconCursorTarget.pp_setPositionLocal(this._myConfig.myNotifyIconCursorTargetPosition)}_setButtonsTransforms(){this.myButtonsPanel.pp_setPositionLocal(this._myConfig.myButtonsPanelPosition);for(let e in H)this.myFilterButtonsPanels[H[e]].pp_setPositionLocal(this._myConfig.myFilterButtonsPositions[H[e]]),this.myFilterButtonsBackgrounds[H[e]].pp_scaleObject(this._myConfig.myButtonBackgroundScale),this.myFilterButtonsTexts[H[e]].pp_setPositionLocal(this._myConfig.myButtonTextPosition),this.myFilterButtonsTexts[H[e]].pp_scaleObject(this._myConfig.myButtonTextScale),this.myFilterButtonsCursorTargets[H[e]].pp_setPositionLocal(this._myConfig.myButtonCursorTargetPosition);this.myClearButtonPanel.pp_setPositionLocal(this._myConfig.myClearButtonPosition),this.myClearButtonBackground.pp_scaleObject(this._myConfig.myButtonBackgroundScale),this.myClearButtonText.pp_setPositionLocal(this._myConfig.myButtonTextPosition),this.myClearButtonText.pp_scaleObject(this._myConfig.myButtonTextScale),this.myClearButtonCursorTarget.pp_setPositionLocal(this._myConfig.myButtonCursorTargetPosition),this.myUpButtonPanel.pp_setPositionLocal(this._myConfig.myUpButtonPosition),this.myUpButtonBackground.pp_scaleObject(this._myConfig.myButtonBackgroundScale),this.myUpButtonText.pp_setPositionLocal(this._myConfig.myButtonTextPosition),this.myUpButtonText.pp_scaleObject(this._myConfig.myButtonTextScale),this.myUpButtonCursorTarget.pp_setPositionLocal(this._myConfig.myButtonCursorTargetPosition),this.myDownButtonPanel.pp_setPositionLocal(this._myConfig.myDownButtonPosition),this.myDownButtonBackground.pp_scaleObject(this._myConfig.myButtonBackgroundScale),this.myDownButtonText.pp_setPositionLocal(this._myConfig.myButtonTextPosition),this.myDownButtonText.pp_scaleObject(this._myConfig.myButtonTextScale),this.myDownButtonCursorTarget.pp_setPositionLocal(this._myConfig.myButtonCursorTargetPosition)}_setPointerTransform(){this.myPointerCursorTarget.pp_setPositionLocal(this._myConfig.myPointerCursorTargetPosition)}_addComponents(){this._addMessagesComponents(),this._addButtonsComponents(),this._addPointerComponents()}_addMessagesComponents(){let e=this.myMessagesBackground.pp_addComponent(ao);e.mesh=this._myPlaneMesh,e.material=this._myParams.myPlaneMaterial.clone(),e.material.color=this._myConfig.myBackgroundColor,this.myMessagesTextComponents=[];for(let t in H){let n=this.myMessagesTexts[H[t]].pp_addComponent(ma);n.alignment=this._myConfig.myMessagesTextAlignment,n.justification=this._myConfig.myMessagesTextJustification,n.material=this._myParams.myTextMaterial.clone(),n.material.color=this._myConfig.myMessagesTextColors[H[t]],n.lineSpacing=1.2,n.text=this._myConfig.myMessagesTextStartString,this.myMessagesTextComponents[H[t]]=n}this.myNotifyIconBackgroundComponent=this.myNotifyIconBackground.pp_addComponent(ao),this.myNotifyIconBackgroundComponent.mesh=this._myPlaneMesh,this.myNotifyIconBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myNotifyIconBackgroundComponent.material.color=this._myConfig.myNotifyIconColor,this.myNotifyIconCursorTargetComponent=this.myNotifyIconCursorTarget.pp_addComponent(ro),this.myNotifyIconCollisionComponent=this.myNotifyIconCursorTarget.pp_addComponent(so),this.myNotifyIconCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myNotifyIconCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myNotifyIconCollisionComponent.extents=this._myConfig.myNotifyIconCollisionExtents}_addButtonsComponents(){this.myFilterButtonsBackgroundComponents=[],this.myFilterButtonsTextComponents=[],this.myFilterButtonsCursorTargetComponents=[],this.myFilterButtonsCollisionComponents=[];for(let e in H){let t=this.myFilterButtonsBackgrounds[H[e]].pp_addComponent(ao);t.mesh=this._myPlaneMesh,t.material=this._myParams.myPlaneMaterial.clone(),t.material.color=this._myConfig.myBackgroundColor;let n=this.myFilterButtonsTexts[H[e]].pp_addComponent(ma);this._setupButtonTextComponent(n),n.material.color=this._myConfig.myFilterButtonsTextColors[H[e]],n.text=this._myConfig.myFilterButtonsTextLabel[H[e]];let o=this.myFilterButtonsCursorTargets[H[e]].pp_addComponent(ro),s=this.myFilterButtonsCursorTargets[H[e]].pp_addComponent(so);s.collider=this._myConfig.myButtonsCollisionCollider,s.group=1<<this._myConfig.myButtonsCollisionGroup,s.extents=this._myConfig.myButtonsCollisionExtents,this.myFilterButtonsBackgroundComponents[H[e]]=t,this.myFilterButtonsTextComponents[H[e]]=n,this.myFilterButtonsCursorTargetComponents[H[e]]=o,this.myFilterButtonsCollisionComponents[H[e]]=s}{let e=this.myClearButtonBackground.pp_addComponent(ao);e.mesh=this._myPlaneMesh,e.material=this._myParams.myPlaneMaterial.clone(),e.material.color=this._myConfig.myBackgroundColor;let t=this.myClearButtonText.pp_addComponent(ma);this._setupButtonTextComponent(t),t.text=this._myConfig.myClearButtonTextLabel;let n=this.myClearButtonCursorTarget.pp_addComponent(ro),o=this.myClearButtonCursorTarget.pp_addComponent(so);o.collider=this._myConfig.myButtonsCollisionCollider,o.group=1<<this._myConfig.myButtonsCollisionGroup,o.extents=this._myConfig.myButtonsCollisionExtents,this.myClearButtonBackgroundComponent=e,this.myClearButtonTextComponent=t,this.myClearButtonCursorTargetComponent=n,this.myClearButtonCollisionComponent=o}{let e=this.myUpButtonBackground.pp_addComponent(ao);e.mesh=this._myPlaneMesh,e.material=this._myParams.myPlaneMaterial.clone(),e.material.color=this._myConfig.myBackgroundColor;let t=this.myUpButtonText.pp_addComponent(ma);this._setupButtonTextComponent(t),t.text=this._myConfig.myUpButtonTextLabel;let n=this.myUpButtonCursorTarget.pp_addComponent(ro),o=this.myUpButtonCursorTarget.pp_addComponent(so);o.collider=this._myConfig.myButtonsCollisionCollider,o.group=1<<this._myConfig.myButtonsCollisionGroup,o.extents=this._myConfig.myButtonsCollisionExtents,this.myUpButtonBackgroundComponent=e,this.myUpButtonTextComponent=t,this.myUpButtonCursorTargetComponent=n,this.myUpButtonCollisionComponent=o}{let e=this.myDownButtonBackground.pp_addComponent(ao);e.mesh=this._myPlaneMesh,e.material=this._myParams.myPlaneMaterial.clone(),e.material.color=this._myConfig.myBackgroundColor;let t=this.myDownButtonText.pp_addComponent(ma);this._setupButtonTextComponent(t),t.text=this._myConfig.myDownButtonTextLabel;let n=this.myDownButtonCursorTarget.pp_addComponent(ro),o=this.myDownButtonCursorTarget.pp_addComponent(so);o.collider=this._myConfig.myButtonsCollisionCollider,o.group=1<<this._myConfig.myButtonsCollisionGroup,o.extents=this._myConfig.myButtonsCollisionExtents,this.myDownButtonBackgroundComponent=e,this.myDownButtonTextComponent=t,this.myDownButtonCursorTargetComponent=n,this.myDownButtonCollisionComponent=o}}_addPointerComponents(){this.myPointerCursorTargetComponent=this.myPointerCursorTarget.pp_addComponent(ro),this.myPointerCursorTargetComponent.isSurface=!0;let e=this.myPointerCursorTarget.pp_addComponent(so);e.collider=this._myConfig.myPointerCollisionCollider,e.group=1<<this._myConfig.myPointerCollisionGroup,e.extents=this._myConfig.myPointerCollisionExtents,this.myPointerCollisionComponent=e}_setupButtonTextComponent(e){e.alignment=this._myConfig.myTextAlignment,e.justification=this._myConfig.myTextJustification,e.material=this._myParams.myTextMaterial.clone(),e.material.color=this._myConfig.myTextColor,e.text=""}_onXRSessionStart(){this._setTransformForXR()}_onXRSessionEnd(){this._setTransformForNonXR()}_setTransformForXR(){this.myNotifyIconPanel.pp_setPositionLocal(this._myConfig.myNotifyIconPanelPositions[this._myParams.myHandedness])}_setTransformForNonXR(){this.myNotifyIconPanel.pp_setPositionLocal(this._myConfig.myNotifyIconPanelPositions[W.NONE])}destroy(){this._myDestroyed=!0,O.unregisterSessionStartEndEventListeners(this,this._myEngine)}isDestroyed(){return this._myDestroyed}};import{Emitter as Ib}from"@wonderlandengine/api";import{Alignment as dV,Collider as _V,Justification as gV}from"@wonderlandengine/api";var ua=class{constructor(e,t){this._setupBuildConfig(e,t),this._setupRuntimeConfig()}_setupBuildConfig(e,t){this.myBackgroundColor=F(46/255,46/255,46/255,1),this.myCursorTargetCollisionCollider=_V.Box,this.myCursorTargetCollisionGroup=7,this.myCursorTargetCollisionThickness=.001,this.myDefaultTextColor=F(255/255,255/255,255/255,1),this.myTextAlignment=dV.Center,this.myTextJustification=gV.Middle,this.myTextColor=this.myDefaultTextColor,this.myButtonTextScale=p(.18,.18,.18),this.myVisibilityButtonBackgroundScale=p(.015,.015,1),this.myVisibilityButtonTextPosition=p(0,0,.007),this.myVisibilityButtonTextScale=this.myButtonTextScale;let n=.01,o=this.myVisibilityButtonBackgroundScale[0]*(2*t)+n*t;this.myVisibilityButtonPosition=[],this.myVisibilityButtonPosition[W.NONE]={},this.myVisibilityButtonPosition[W.NONE].myPosition=p(-.3+o,-.205,.035),this.myVisibilityButtonPosition[W.LEFT]={},this.myVisibilityButtonPosition[W.LEFT].myPosition=p(-.2+o,.025,.015),this.myVisibilityButtonPosition[W.RIGHT]={},this.myVisibilityButtonPosition[W.RIGHT].myPosition=p(.2-o,.025,.015),this.myVisibilityButtonText=e,this.myVisibilityButtonCursorTargetPosition=p(0,0,0),this.myVisibilityButtonCursorTargetPosition[2]=this.myVisibilityButtonTextPosition[2],this.myVisibilityButtonCollisionExtents=this.myVisibilityButtonBackgroundScale.pp_clone(),this.myVisibilityButtonCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myFlagButtonBackgroundScale=p(.0125,.0125,1),this.myFlagButtonTextPosition=p(0,0,.007),this.myFlagButtonTextScale=p(.15,.15,.15);let s=.0075,a=0,l=this.myVisibilityButtonBackgroundScale[1]+this.myFlagButtonBackgroundScale[1]+s+this.myFlagButtonBackgroundScale[1]*(2*a)+s*a;this.myPinButtonPosition=[],this.myPinButtonPosition[W.NONE]={},this.myPinButtonPosition[W.NONE].myPosition=this.myVisibilityButtonPosition[W.NONE].myPosition.pp_clone(),this.myPinButtonPosition[W.NONE].myPosition[1]+=l,this.myPinButtonPosition[W.LEFT]={},this.myPinButtonPosition[W.LEFT].myPosition=this.myVisibilityButtonPosition[W.LEFT].myPosition.pp_clone(),this.myPinButtonPosition[W.LEFT].myPosition[1]+=l,this.myPinButtonPosition[W.RIGHT]={},this.myPinButtonPosition[W.RIGHT].myPosition=this.myVisibilityButtonPosition[W.RIGHT].myPosition.pp_clone(),this.myPinButtonPosition[W.RIGHT].myPosition[1]+=l,this.myPinButtonText="P",this.myPinButtonCursorTargetPosition=p(0,0,0),this.myPinButtonCursorTargetPosition[2]=this.myFlagButtonTextPosition[2],this.myPinButtonCollisionExtents=this.myFlagButtonBackgroundScale.pp_clone(),this.myPinButtonCollisionExtents[2]=this.myCursorTargetCollisionThickness}_setupRuntimeConfig(){this._initializeObjectsTransforms(),this.myButtonHoverColor=F(150/255,150/255,150/255,1),this.myButtonDisabledTextColor=this.myBackgroundColor,this.myButtonDisabledBackgroundColor=F(110/255,110/255,110/255,1)}_initializeObjectsTransforms(){this.myPivotObjectTransforms=this._createDefaultObjectTransforms(),this.myPivotObjectTransforms[Ae.GAMEPAD][W.LEFT].myRotation=w(-.645,.425,.25,.584),this.myPivotObjectTransforms[Ae.GAMEPAD][W.LEFT].myRotation.quat_normalize(this.myPivotObjectTransforms[Ae.GAMEPAD][W.LEFT].myRotation),this.myPivotObjectTransforms[Ae.GAMEPAD][W.RIGHT].myRotation=w(-.645,-.425,-.25,.584),this.myPivotObjectTransforms[Ae.GAMEPAD][W.RIGHT].myRotation.quat_normalize(this.myPivotObjectTransforms[Ae.GAMEPAD][W.RIGHT].myRotation),this.myPivotObjectTransforms[Ae.TRACKED_HAND][W.LEFT].myRotation=w(-.645,.425,.25,.584),this.myPivotObjectTransforms[Ae.TRACKED_HAND][W.LEFT].myRotation.quat_normalize(this.myPivotObjectTransforms[Ae.GAMEPAD][W.LEFT].myRotation),this.myPivotObjectTransforms[Ae.TRACKED_HAND][W.RIGHT].myRotation=w(-.645,-.425,-.25,.584),this.myPivotObjectTransforms[Ae.TRACKED_HAND][W.RIGHT].myRotation.quat_normalize(this.myPivotObjectTransforms[Ae.GAMEPAD][W.RIGHT].myRotation),this.myWidgetObjectTransforms=this._createDefaultObjectTransforms(),this.myWidgetObjectTransforms[Ae.GAMEPAD][W.LEFT].myPosition=p(.1,.23,-.02),this.myWidgetObjectTransforms[Ae.GAMEPAD][W.RIGHT].myPosition=p(.07,.23,-.02),this.myWidgetObjectTransforms[Ae.TRACKED_HAND][W.LEFT].myPosition=p(.1,.23,-.02),this.myWidgetObjectTransforms[Ae.TRACKED_HAND][W.RIGHT].myPosition=p(.07,.23,-.02),this._myPivotObjectDistanceFromHeadNonXR=.6}_createDefaultObjectTransforms(){let e=[];for(let t in Ae){let n=Ae[t];e[n]=[];for(let o in W){let s=W[o];e[n][s]={},e[n][s].myPosition=p(0,0,0),e[n][s].myRotation=w(0,0,0,1)}}return e}};import{CollisionComponent as Ab,MeshComponent as Rb,TextComponent as Vb}from"@wonderlandengine/api";import{CursorTarget as Ob}from"@wonderlandengine/components";var ha=class{constructor(e=m.getMainEngine()){this._myInputSourceType=null,this._myParentObject=null,this._myPinned=!1,this._myWidgetVisible=!0,this._myVisibilityButtonVisible=!0,this._myEngine=e,this._myDestroyed=!1}build(e,t,n){this._myParentObject=e,this._myConfig=t,this._myParams=n,this._myPlaneMesh=m.getDefaultMeshes(this._myEngine).myDoubleSidedPlane,this._createSkeleton(),this._setTransforms(),this._addComponents(),this._setTransformForNonXR(),O.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this._myEngine)}setWidgetVisible(e){this._myWidgetVisible=e,this.myFlagsButtonPanel.pp_setActive(e),e&&this._updateObjectsTransforms(!0)}setVisibilityButtonVisible(e){this._myVisibilityButtonVisible=e,this.myVisibilityButtonPanel.pp_setActive(e)}setPinned(e){e!=this._myPinned&&(this._myPinned=e,this._myPinned?this.myPivotObject.pp_setParent(m.getSceneObjects(this._myEngine).myTools):(this.myPivotObject.pp_setParent(this.myFixForwardObject),O.isSessionActive(this._myEngine)||this._setTransformForNonXR(),this._updateObjectsTransforms(!0)))}update(e){this._updateObjectsTransforms(!1)}_updateObjectsTransforms(e){if(O.isSessionActive(this._myEngine)){let t=ie.getInputSourceTypeByHandedness(this._myParams.myHandedness,this._myEngine);(t!=this._myInputSourceType||e)&&(this._myInputSourceType=t,this._myPinned||(this.myPivotObject.pp_setPositionLocal(this._myConfig.myPivotObjectTransforms[this._myInputSourceType][this._myParams.myHandedness].myPosition),this.myPivotObject.pp_resetRotationLocal(),this.myPivotObject.pp_rotateObjectQuat(this._myConfig.myPivotObjectTransforms[this._myInputSourceType][this._myParams.myHandedness].myRotation),this.myWidgetObject.pp_setPositionLocal(this._myConfig.myWidgetObjectTransforms[this._myInputSourceType][this._myParams.myHandedness].myPosition),this.myWidgetObject.pp_resetRotationLocal(),this.myWidgetObject.pp_rotateObjectQuat(this._myConfig.myWidgetObjectTransforms[this._myInputSourceType][this._myParams.myHandedness].myRotation),this.myVisibilityButtonPanel.pp_setPositionLocal(this._myConfig.myVisibilityButtonPosition[this._myParams.myHandedness].myPosition),this.myPinButtonPanel.pp_setPositionLocal(this._myConfig.myPinButtonPosition[this._myParams.myHandedness].myPosition)))}else this.myVisibilityButtonPanel.pp_setActive(this._myWidgetVisible||this._myVisibilityButtonVisible)}_createSkeleton(){this.myFixForwardObject=this._myParentObject.pp_addObject(),m.isPoseForwardFixed(this._myEngine)&&this.myFixForwardObject.pp_rotateObject(p(0,180,0)),this.myPivotObject=this.myFixForwardObject.pp_addObject(),this.myWidgetObject=this.myPivotObject.pp_addObject(),this.myVisibilityButtonPanel=this.myPivotObject.pp_addObject(),this.myVisibilityButtonBackground=this.myVisibilityButtonPanel.pp_addObject(),this.myVisibilityButtonText=this.myVisibilityButtonPanel.pp_addObject(),this.myVisibilityButtonCursorTarget=this.myVisibilityButtonPanel.pp_addObject(),this.myFlagsButtonPanel=this.myPivotObject.pp_addObject(),this.myPinButtonPanel=this.myFlagsButtonPanel.pp_addObject(),this.myPinButtonBackground=this.myPinButtonPanel.pp_addObject(),this.myPinButtonText=this.myPinButtonPanel.pp_addObject(),this.myPinButtonCursorTarget=this.myPinButtonPanel.pp_addObject(),this.myNonXRParentObject=m.getPlayerObjects(this._myEngine).myCameraNonXR.pp_addObject(),this.myNonXRParentObject.pp_translateLocal(p(0,0,-this._myConfig._myPivotObjectDistanceFromHeadNonXR)),this.myNonXRParentObject.pp_lookToLocal(p(0,0,1),p(0,1,0))}_setTransforms(){this.myPivotObject.pp_markDirty(),this.myVisibilityButtonPanel.pp_setPositionLocal(this._myConfig.myVisibilityButtonPosition[this._myParams.myHandedness].myPosition),this.myVisibilityButtonBackground.pp_scaleObject(this._myConfig.myVisibilityButtonBackgroundScale),this.myVisibilityButtonText.pp_setPositionLocal(this._myConfig.myVisibilityButtonTextPosition),this.myVisibilityButtonText.pp_scaleObject(this._myConfig.myVisibilityButtonTextScale),this.myVisibilityButtonCursorTarget.pp_setPositionLocal(this._myConfig.myVisibilityButtonCursorTargetPosition),this.myPinButtonPanel.pp_setPositionLocal(this._myConfig.myPinButtonPosition[this._myParams.myHandedness].myPosition),this.myPinButtonBackground.pp_scaleObject(this._myConfig.myFlagButtonBackgroundScale),this.myPinButtonText.pp_setPositionLocal(this._myConfig.myFlagButtonTextPosition),this.myPinButtonText.pp_scaleObject(this._myConfig.myFlagButtonTextScale),this.myPinButtonCursorTarget.pp_setPositionLocal(this._myConfig.myPinButtonCursorTargetPosition)}_addComponents(){this.myVisibilityButtonBackgroundComponent=this.myVisibilityButtonBackground.pp_addComponent(Rb),this.myVisibilityButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myVisibilityButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myVisibilityButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myVisibilityButtonTextComponent=this.myVisibilityButtonText.pp_addComponent(Vb),this._setupButtonTextComponent(this.myVisibilityButtonTextComponent),this.myVisibilityButtonTextComponent.text=this._myConfig.myVisibilityButtonText,this.myVisibilityButtonCursorTargetComponent=this.myVisibilityButtonCursorTarget.pp_addComponent(Ob),this.myVisibilityButtonCollisionComponent=this.myVisibilityButtonCursorTarget.pp_addComponent(Ab),this.myVisibilityButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myVisibilityButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myVisibilityButtonCollisionComponent.extents=this._myConfig.myVisibilityButtonCollisionExtents,this.myPinButtonBackgroundComponent=this.myPinButtonBackground.pp_addComponent(Rb),this.myPinButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPinButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myPinButtonBackgroundComponent.material.color=this._myConfig.myButtonDisabledBackgroundColor,this.myPinButtonTextComponent=this.myPinButtonText.pp_addComponent(Vb),this._setupButtonTextComponent(this.myPinButtonTextComponent),this.myPinButtonTextComponent.material.color=this._myConfig.myButtonDisabledTextColor,this.myPinButtonTextComponent.text=this._myConfig.myPinButtonText,this.myPinButtonCursorTargetComponent=this.myPinButtonCursorTarget.pp_addComponent(Ob),this.myPinButtonCollisionComponent=this.myPinButtonCursorTarget.pp_addComponent(Ab),this.myPinButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPinButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPinButtonCollisionComponent.extents=this._myConfig.myPinButtonCollisionExtents}_setupButtonTextComponent(e){e.alignment=this._myConfig.myTextAlignment,e.justification=this._myConfig.myTextJustification,e.material=this._myParams.myTextMaterial.clone(),e.material.color=this._myConfig.myTextColor,e.text=""}_onXRSessionStart(){this.myVisibilityButtonPanel.pp_setActive(this._myVisibilityButtonVisible),this._setTransformForXR()}_onXRSessionEnd(){this._setTransformForNonXR()}_setTransformForXR(){this.myFixForwardObject.pp_setParent(this._myParentObject),this.myFixForwardObject.pp_resetTransformLocal(),m.isPoseForwardFixed(this._myEngine)&&this.myFixForwardObject.pp_rotateObject(p(0,180,0)),this._updateObjectsTransforms(!0)}_setTransformForNonXR(){this._myPinned||(this.myFixForwardObject.pp_setParent(this.myNonXRParentObject),this.myFixForwardObject.pp_resetTransformLocal(),this.myPivotObject.pp_setPositionLocal(this._myConfig.myPivotObjectTransforms[Ae.NONE][W.NONE].myPosition),this.myPivotObject.pp_resetRotationLocal(),this.myPivotObject.pp_rotateObjectQuat(this._myConfig.myPivotObjectTransforms[Ae.NONE][W.NONE].myRotation),this.myWidgetObject.pp_setPositionLocal(this._myConfig.myWidgetObjectTransforms[Ae.NONE][W.NONE].myPosition),this.myWidgetObject.pp_resetRotationLocal(),this.myWidgetObject.pp_rotateObjectQuat(this._myConfig.myWidgetObjectTransforms[Ae.NONE][W.NONE].myRotation),this.myVisibilityButtonPanel.pp_setPositionLocal(this._myConfig.myVisibilityButtonPosition[W.NONE].myPosition),this.myPinButtonPanel.pp_setPositionLocal(this._myConfig.myPinButtonPosition[W.NONE].myPosition))}destroy(){this._myDestroyed=!0,O.unregisterSessionStartEndEventListeners(this,this._myEngine)}isDestroyed(){return this._myDestroyed}};var mn=class{constructor(){this.myHandedness=W.NONE,this.myPlaneMaterial=null,this.myTextMaterial=null}},yn=class{constructor(e,t,n=m.getMainEngine()){this._myWidgetVisible=!0,this._myPinned=!1,this._myConfig=new ua(e,t),this._myParams=null,this._myUI=new ha(n),this._myShowVisibilityButton=!1,this._myWidgetVisibleChangedEmitter=new Ib,this._myPinChangedEmitter=new Ib,this._myDestroyed=!0}getWidgetObject(){return this._myUI.myWidgetObject}setVisible(e){this._myWidgetVisible=!e,this._toggleVisibility(!1,!0)}isVisible(){return this._myWidgetVisible}toggleVisibility(){this._toggleVisibility(!1,!0)}togglePin(){this._togglePin(!1)}registerWidgetVisibleChangedEventListener(e,t){this._myWidgetVisibleChangedEmitter.add(t,{id:e})}unregisterWidgetVisibleChangedEventListener(e){this._myWidgetVisibleChangedEmitter.remove(e)}registerPinChangedEventListener(e,t){this._myPinChangedEmitter.add(t,{id:e})}unregisterPinChangedEventListener(e){this._myPinChangedEmitter.remove(e)}start(e,t){this._myParams=t,this._myUI.build(e,this._myConfig,t),this._myUI.setVisibilityButtonVisible(t.myShowVisibilityButton),this._myShowVisibilityButton=t.myShowVisibilityButton,t.myShowOnStart||this._toggleVisibility(!1,!1),this._addListeners()}update(e){this._myUI.update(e)}_addListeners(){let e=this._myUI;e.myPinButtonCursorTargetComponent.onClick.add(this._togglePin.bind(this,!0)),e.myPinButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myPinButtonBackgroundComponent.material)),e.myPinButtonCursorTargetComponent.onUnhover.add(this._pinUnhover.bind(this,e.myPinButtonBackgroundComponent.material)),e.myVisibilityButtonCursorTargetComponent.onClick.add(this._toggleVisibility.bind(this,!0,!0)),e.myVisibilityButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myVisibilityButtonBackgroundComponent.material)),e.myVisibilityButtonCursorTargetComponent.onUnhover.add(this._visibilityUnhover.bind(this,e.myVisibilityButtonBackgroundComponent.material))}_toggleVisibility(e,t){this._myWidgetVisible=!this._myWidgetVisible,this._myUI.setWidgetVisible(this._myWidgetVisible);let n=this._myUI.myVisibilityButtonTextComponent.material,o=this._myUI.myVisibilityButtonBackgroundComponent.material;this._myWidgetVisible?(n.color=this._myConfig.myDefaultTextColor,e||(o.color=this._myConfig.myBackgroundColor)):(n.color=this._myConfig.myButtonDisabledTextColor,e||(o.color=this._myConfig.myButtonDisabledBackgroundColor)),t&&this._myWidgetVisibleChangedEmitter.notify(this._myWidgetVisible),this._myUI.setVisibilityButtonVisible(this._myShowVisibilityButton)}_togglePin(e){if(this._myWidgetVisible){this._myPinned=!this._myPinned,this._myUI.setPinned(this._myPinned);let t=this._myUI.myPinButtonTextComponent.material,n=this._myUI.myPinButtonBackgroundComponent.material;this._myPinned?(t.color=this._myConfig.myDefaultTextColor,e||(n.color=this._myConfig.myBackgroundColor)):(t.color=this._myConfig.myButtonDisabledTextColor,e||(n.color=this._myConfig.myButtonDisabledBackgroundColor)),this._myPinChangedEmitter.notify(this._myPinned)}}_genericHover(e){e.color=this._myConfig.myButtonHoverColor}_visibilityUnhover(e){this._myWidgetVisible?e.color=this._myConfig.myBackgroundColor:e.color=this._myConfig.myButtonDisabledBackgroundColor}_pinUnhover(e){this._myPinned?e.color=this._myConfig.myBackgroundColor:e.color=this._myConfig.myButtonDisabledBackgroundColor}destroy(){this._myDestroyed=!0,this._myUI!=null&&this._myUI.destroy()}isDestroyed(){return this._myDestroyed}};var ca=class extends mn{constructor(){super(),this.myOverrideBrowserConsole=!1,this.myShowOnStart=!1,this.myShowVisibilityButton=!1,this.myPulseOnNewMessage=ra.NEVER,this.myResetBrowserConsoleOriginalFunctionsOnDestroy=!0}},pa=class{constructor(e,t){this.myType=e,this.myLines=t,this._myOriginalText=t.join(`
`),this._myMessagesCount=1}hasSameInfo(e){return this._myOriginalText==e._myOriginalText&&this.myType==e.myType}increaseCount(){this._myMessagesCount+=1;let e="(x".concat(this._myMessagesCount).concat(") "),t=this._myOriginalText;t=e.concat(t),this.myLines=t.split(`
`)}},da=class{constructor(e=m.getMainEngine()){this._myWidgetFrame=new yn("C",0,e),this._myWidgetFrame.registerWidgetVisibleChangedEventListener(this,this._widgetVisibleChanged.bind(this)),this._myConfig=new la,this._myParams=null,this._myUI=new ya(e),this._myMessages=[],this._myOldBrowserConsole=[],this._myOldConsoleVR=[],this._myTypeFilters=[];for(let t in H)this._myTypeFilters[H[t]]=!1;this._myScrollUp=!1,this._myScrollDown=!1,this._myScrollOffset=0,this._myScrollTimer=0,this._myScrollThumbstickTimer=0,this._myPulseTimer=0,this._myGamepadScrollEnabled=!0,this._myConfig.myGamepadScrollOnlyOnHover&&(this._myGamepadScrollEnabled=!1),this._myErrorEventListener=null,this._myUnhandledRejectionEventListener=null,this._myConsolePrintAddMessageEnabled=!0,this._myConsolePrintUpdateTextEnabled=!0,this._myConsolePrintAddMessageEnabledReset=!1,this._myConsolePrintUpdateTextEnabledReset=!1,this._myTextDirty=!1,this._myEngine=e,this._myDestroyed=!1}setVisible(e){this._myWidgetFrame.setVisible(e)}isVisible(){return this._myWidgetFrame.isVisible()}start(e,t){this._myLeftGamepad=m.getLeftGamepad(this._myEngine),this._myRightGamepad=m.getRightGamepad(this._myEngine),this._myParams=t,this._myWidgetFrame.start(e,t),this._myUI.build(this._myWidgetFrame.getWidgetObject(),this._myConfig,t),this._myUI.setVisible(this._myWidgetFrame.isVisible()),this._setNotifyIconActive(!1),this._addListeners(),this._overrideConsolesFunctions()}update(e){this._myWidgetFrame.update(e),this._myWidgetFrame.isVisible()&&(this._myConsolePrintAddMessageEnabledReset&&(this._myConsolePrintAddMessageEnabledReset=!1,this._myConsolePrintAddMessageEnabled=!0),this._myConsolePrintUpdateTextEnabledReset&&(this._myConsolePrintUpdateTextEnabledReset=!1,this._myConsolePrintUpdateTextEnabled=!0),this._myTextDirty&&(this._myTextDirty=!1,this._updateAllTexts()),this._updateScroll(e)),this._updateGamepadsExtraActions(e)}_overrideConsolesFunctions(){this._myOldBrowserConsole[re.LOG]=console.log,this._myOldBrowserConsole[re.ERROR]=console.error,this._myOldBrowserConsole[re.WARN]=console.warn,this._myOldBrowserConsole[re.INFO]=console.info,this._myOldBrowserConsole[re.DEBUG]=console.debug,this._myOldBrowserConsole[re.ASSERT]=console.assert,this._myOldBrowserConsoleClear=console.clear,this._myParams.myOverrideBrowserConsole&&(console.log=this._consolePrint.bind(this,re.LOG,Ie.BROWSER_CONSOLE),console.error=this._consolePrint.bind(this,re.ERROR,Ie.BROWSER_CONSOLE),console.warn=this._consolePrint.bind(this,re.WARN,Ie.BROWSER_CONSOLE),console.info=this._consolePrint.bind(this,re.INFO,Ie.BROWSER_CONSOLE),console.debug=this._consolePrint.bind(this,re.DEBUG,Ie.BROWSER_CONSOLE),console.assert=this._consolePrint.bind(this,re.ASSERT,Ie.BROWSER_CONSOLE),console.clear=this._clearConsole.bind(this,!0,Ie.BROWSER_CONSOLE),this._myErrorEventListener=function(e){e.error!=null?this._consolePrint(re.ERROR,Ie.WINDOW,"Uncaught",e.error.stack):this._consolePrint(re.ERROR,Ie.WINDOW,"Uncaught",e.message)}.bind(this),this._myUnhandledRejectionEventListener=function(e){this._consolePrint(re.ERROR,Ie.WINDOW,"Uncaught (in promise)",e.reason)}.bind(this),m.getWindow(this._myEngine).addEventListener("error",this._myErrorEventListener),m.getWindow(this._myEngine).addEventListener("unhandledrejection",this._myUnhandledRejectionEventListener)),this._myOldConsoleVR[re.LOG]=m.getConsoleVR(this._myEngine).log,this._myOldConsoleVR[re.ERROR]=m.getConsoleVR(this._myEngine).error,this._myOldConsoleVR[re.WARN]=m.getConsoleVR(this._myEngine).warn,this._myOldConsoleVR[re.INFO]=m.getConsoleVR(this._myEngine).info,this._myOldConsoleVR[re.DEBUG]=m.getConsoleVR(this._myEngine).debug,this._myOldConsoleVR[re.ASSERT]=m.getConsoleVR(this._myEngine).assert,this._myOldConsoleVRClear=m.getConsoleVR(this._myEngine).clear,m.getConsoleVR(this._myEngine).log=this._consolePrint.bind(this,re.LOG,Ie.CONSOLE_VR),m.getConsoleVR(this._myEngine).error=this._consolePrint.bind(this,re.ERROR,Ie.CONSOLE_VR),m.getConsoleVR(this._myEngine).warn=this._consolePrint.bind(this,re.WARN,Ie.CONSOLE_VR),m.getConsoleVR(this._myEngine).info=this._consolePrint.bind(this,re.INFO,Ie.CONSOLE_VR),m.getConsoleVR(this._myEngine).debug=this._consolePrint.bind(this,re.DEBUG,Ie.CONSOLE_VR),m.getConsoleVR(this._myEngine).assert=this._consolePrint.bind(this,re.ASSERT,Ie.CONSOLE_VR),m.getConsoleVR(this._myEngine).clear=this._clearConsole.bind(this,!0,Ie.CONSOLE_VR)}_updateText(e){let t="";if(!this._myTypeFilters[e]){let n=0,o=this._myMessages.length-1,s=Math.round(this._myScrollOffset);for(;o>=0&&n<this._myConfig.myMaxLines;){let a=this._myMessages[o];if(this._myTypeFilters[a.myType]){o-=1;continue}let l=a.myLines.length,h=0;if(s>0){let y=0;o!=this._myMessages.length-1&&(y=this._myConfig.myLinesBetweenMessages),s>=l+y?(s-=l+y,h=l+y):(h=s,s=0)}if(o!=this._myMessages.length-1){let y=this._myConfig.myLinesBetweenMessages-Math.max(this._myConfig.myLinesBetweenMessages-h,0),r=this._myConfig.myLinesBetweenMessages-y;n+r>this._myConfig.myMaxLines&&(r=this._myMaxLines-n);for(let u=0;u<r;u++)t=`
`.concat(t);n+=r,h-=y}let _=l-h;if(n+_>this._myConfig.myMaxLines&&(_=this._myConfig.myMaxLines-n),_>0)if(a.myType==e)t=a.myLines.slice(l-_-h,l-h).join(`
`).concat(`
`).concat(t),n+=_;else{for(let y=0;y<_;y++)t=`
`.concat(t);n+=_}o-=1}}t=this._myConfig.myMessagesTextStartString.concat(t);try{this._myConsolePrintUpdateTextEnabled=!1,this._myUI.myMessagesTextComponents[e].text=t,this._myConsolePrintUpdateTextEnabled=!0}catch(n){throw this._myConsolePrintUpdateTextEnabledReset=!0,n}}_consolePrint(e,t,...n){if(this._myConsolePrintAddMessageEnabled&&(e!=re.ASSERT||n.length>0&&!n[0])){try{let o=this._argsToMessage(e,...n);this._addMessage(o),this._myMessages.length>=this._myConfig.myMaxMessages+this._myConfig.myMaxMessagesDeletePad&&(this._myMessages=this._myMessages.slice(this._myMessages.length-this._myConfig.myMaxMessages),this._clampScrollOffset())}catch(o){this._myConsolePrintAddMessageEnabled=!1,this._myConsolePrintAddMessageEnabledReset=!0,this._myTextDirty=!0;try{let s="An error occurred while trying to add a new message to the Console VR Widget",a=new pa(H.ERROR,[s]);this._myMessages.push(a),Ee.error(this._myEngine,s)}catch{}throw o}this._myConsolePrintUpdateTextEnabled?(this._updateAllTexts(),this._pulseGamepad()):this._myTextDirty=!0}switch(t){case Ie.BROWSER_CONSOLE:this._myOldBrowserConsole[e].apply(console,n);break;case Ie.CONSOLE_VR:this._myOldConsoleVR[e].apply(m.getConsoleVR(this._myEngine),n);break;default:this._myOldBrowserConsole[e].apply(console,n);break}}_argsToMessage(e,...t){e==re.ASSERT&&(t=t.slice(1),t.splice(0,0,this._myConfig.myAssertStartString));let n=this._consoleFunctionToMessageType(e),o=this._formatArgs(...t),s=this._splitLongLines(o);return n==H.INFO?n=H.LOG:(n==H.EXCEPTION||n==H.ASSERT)&&(n=H.ERROR),new pa(n,s)}_consoleFunctionToMessageType(e){let t=H.LOG;return e<re.INFO?t=e:e==re.INFO?t=H.LOG:t=H.ERROR,t}_formatArgs(...e){let t=[];for(let o=0;o<e.length;o++)e[o]===void 0?t.push("undefined"):t.push(this._stringifyItem(e[o]));return t.join(" ")}_stringifyItem(e){let t=null;if(e instanceof Error)t=e.stack;else if(typeof e=="object"){let n=2;try{t=JSON.stringify(e,this._jsonReplacer.bind(this),n)}catch{let s=new WeakSet;t=JSON.stringify(e,function(a,l){if(typeof l=="object"&&l!==null){if(s.has(l))return"<stringify error: object already stringified>";s.add(l)}return this._jsonReplacer(a,l)}.bind(this),n)}t=t.replaceAll('"[',"["),t=t.replaceAll("'[","["),t=t.replaceAll(']"',"]"),t=t.replaceAll("]'","]")}else t=e;return t}_splitLongLines(e){let t=e.split(`
`),n=[];for(let o=0;o<t.length;o++){let s=t[o];if(s.length>this._myConfig.myMaxCharactersPerLine){let a=this._getSpacesAtStart(s),l=this._myConfig.myTabString.concat(a),h=0;for(;s.length>this._myConfig.myMaxCharactersPerLine&&h<this._myConfig.myMaxLineSplits;){let _=s.substr(0,this._myConfig.myMaxCharactersPerLine-1),y=s.substr(this._myConfig.myMaxCharactersPerLine-1);y=l.concat(y),n.push(_),s=y,h++}n.push(s)}else n.push(s)}return n}_getSpacesAtStart(e){let t="",n=0;for(;n<e.length&&e[n]==" ";)t=t.concat(" "),n++;return t}_addMessage(e){let t=!1;if(this._myMessages.length>0){let n=this._myMessages[this._myMessages.length-1];n.hasSameInfo(e)&&(n.increaseCount(),t=!0)}t||this._myMessages.push(e),this._adjustScrollOffsetAfterMessageAdded(e,t),this._updateNotifyIcon(e)}_adjustScrollOffsetAfterMessageAdded(e,t){!t&&!this._myTypeFilters[e.myType]&&this._myScrollOffset>0&&(this._myScrollOffset+=e.myLines.length+this._myConfig.myLinesBetweenMessages)}_updateAllTexts(){if(this._myWidgetFrame.isVisible())for(let e in H)this._updateText(H[e])}_updateNotifyIcon(e){!this._myTypeFilters[e.myType]&&this._myScrollOffset>0&&this._setNotifyIconActive(!0)}_updateScroll(e){if(this._myScrollUp)for(this._myScrollTimer+=e;this._myScrollTimer>this._myConfig.myScrollDelay;)this._myScrollTimer-=this._myConfig.myScrollDelay,this._myScrollOffset+=this._myConfig.myScrollAmount;else if(this._myScrollDown)for(this._myScrollTimer+=e;this._myScrollTimer>this._myConfig.myScrollDelay;)this._myScrollTimer-=this._myConfig.myScrollDelay,this._myScrollOffset-=this._myConfig.myScrollAmount;this._clampScrollOffset(),(this._myScrollUp||this._myScrollDown)&&this._updateAllTexts(),this._myScrollOffset==0&&this._setNotifyIconActive(!1)}_clampScrollOffset(){let e=this._getMaxScrollOffset();this._myScrollOffset=Math.pp_clamp(this._myScrollOffset,0,e)}_getMaxScrollOffset(){return Math.max(this._getLinesCount()-this._myConfig.myMaxLines,0)}_getLinesCount(){let e=0;for(let t of this._myMessages)this._myTypeFilters[t.myType]||(e+=t.myLines.length+this._myConfig.myLinesBetweenMessages);return e-=this._myConfig.myLinesBetweenMessages,e=Math.max(e,0),e}_addListeners(){let e=this._myUI;for(let t in H){let n=e.myFilterButtonsCursorTargetComponents[H[t]],o=e.myFilterButtonsBackgroundComponents[H[t]].material,s=e.myFilterButtonsTextComponents[H[t]].material;n.onSingleClick.add(this._toggleFilter.bind(this,H[t],s)),n.onDoubleClick.add(this._filterAllButOne.bind(this,H[t],s)),n.onTripleClick.add(this._resetFilters.bind(this,H[t])),n.onHover.add(this._filterHover.bind(this,H[t],o)),n.onUnhover.add(this._filterUnhover.bind(this,H[t],o))}{let t=e.myClearButtonCursorTargetComponent,n=e.myClearButtonBackgroundComponent.material;t.onClick.add(this._clearConsole.bind(this,!1,null)),t.onHover.add(this._genericHover.bind(this,n)),t.onUnhover.add(this._genericUnhover.bind(this,n))}{let t=e.myUpButtonCursorTargetComponent,n=e.myUpButtonBackgroundComponent.material;t.onDoubleClick.add(this._instantScrollUp.bind(this,!0)),t.onDown.add(this._setScrollUp.bind(this,!0)),t.onDownOnHover.add(this._setScrollUp.bind(this,!0)),t.onUp.add(this._setScrollUp.bind(this,!1)),t.onUnhover.add(this._setScrollUp.bind(this,!1)),t.onHover.add(this._genericHover.bind(this,n)),t.onUnhover.add(this._genericUnhover.bind(this,n))}{let t=e.myDownButtonCursorTargetComponent,n=e.myDownButtonBackgroundComponent.material;t.onDoubleClick.add(this._instantScrollDown.bind(this)),t.onDown.add(this._setScrollDown.bind(this,!0)),t.onDownOnHover.add(this._setScrollDown.bind(this,!0)),t.onUp.add(this._setScrollDown.bind(this,!1)),t.onUnhover.add(this._setScrollDown.bind(this,!1)),t.onHover.add(this._genericHover.bind(this,n)),t.onUnhover.add(this._genericUnhover.bind(this,n))}{let t=e.myNotifyIconCursorTargetComponent,n=e.myNotifyIconBackgroundComponent.material;t.onClick.add(this._instantScrollDown.bind(this)),t.onHover.add(this._genericHover.bind(this,n)),t.onUnhover.add(this._notifyIconUnhover.bind(this))}e.myPointerCursorTargetComponent.onHover.add(this._setGamepadScrollEnabled.bind(this,!0)),e.myPointerCursorTargetComponent.onUnhover.add(this._setGamepadScrollEnabled.bind(this,!1))}_resetFilters(e){if(this._myWidgetFrame.isVisible()){for(let t in H){let n=this._myUI.myFilterButtonsBackgroundComponents[H[t]].material,o=this._myUI.myFilterButtonsTextComponents[H[t]].material;this._myTypeFilters[H[t]]=!1,o.color=this._myConfig.myMessageTypeColors[H[t]],H[t]!=e&&(n.color=this._myConfig.myBackgroundColor)}this._clampScrollOffset(),this._updateAllTexts()}}_filterAllButOne(e){if(this._myWidgetFrame.isVisible()){for(let t in H){let n=this._myUI.myFilterButtonsBackgroundComponents[H[t]].material,o=this._myUI.myFilterButtonsTextComponents[H[t]].material;H[t]!=e?(this._myTypeFilters[H[t]]=!0,n.color=this._myConfig.myFilterButtonDisabledBackgroundColor,o.color=this._myConfig.myFilterButtonDisabledTextColor):(this._myTypeFilters[H[t]]=!1,o.color=this._myConfig.myMessageTypeColors[e])}this._clampScrollOffset(),this._updateAllTexts()}}_toggleFilter(e,t){this._myWidgetFrame.isVisible()&&(this._myTypeFilters[e]=!this._myTypeFilters[e],this._myTypeFilters[e]?t.color=this._myConfig.myFilterButtonDisabledTextColor:t.color=this._myConfig.myMessageTypeColors[e],this._clampScrollOffset(),this._updateAllTexts())}_clearConsole(e=!1,t=null){if(this._myWidgetFrame.isVisible()||e)if(this._myMessages=[],this._clampScrollOffset(),this._updateAllTexts(),e)switch(t){case Ie.BROWSER_CONSOLE:this._myOldBrowserConsoleClear.apply(console);break;case Ie.CONSOLE_VR:this._myOldConsoleVRClear.apply(m.getConsoleVR(this._myEngine));break;default:break}else this._myConfig.myClearBrowserConsoleWhenClearPressed&&Ee.clear(this._myEngine)}_setScrollUp(e){(this._myWidgetFrame.isVisible()||!e)&&(e&&(this._myScrollTimer=0),this._myScrollUp=e)}_setScrollDown(e){(this._myWidgetFrame.isVisible()||!e)&&(e&&(this._myScrollTimer=0),this._myScrollDown=e)}_instantScrollUp(){this._myWidgetFrame.isVisible()&&(this._myScrollOffset=this._getMaxScrollOffset(),this._updateAllTexts())}_instantScrollDown(){this._myWidgetFrame.isVisible()&&(this._myScrollOffset=0,this._setNotifyIconActive(!1),this._updateAllTexts())}_setNotifyIconActive(e){this._myUI.myNotifyIconPanel.pp_setActive(e&&this._myWidgetFrame.isVisible())}_notifyIconUnhover(){let e=this._myUI.myNotifyIconBackgroundComponent.material;e.color=this._myConfig.myNotifyIconColor}_filterHover(e,t){this._genericHover(t)}_filterUnhover(e,t){this._myTypeFilters[e]?t.color=this._myConfig.myFilterButtonDisabledBackgroundColor:t.color=this._myConfig.myBackgroundColor}_genericHover(e){e.color=this._myConfig.myButtonHoverColor}_genericUnhover(e){e.color=this._myConfig.myBackgroundColor}_updateGamepadsExtraActions(e){this._myLeftGamepad&&this._myRightGamepad&&((this._myLeftGamepad.getButtonInfo(E.THUMBSTICK).isPressStart()&&this._myRightGamepad.getButtonInfo(E.THUMBSTICK).isPressed()||this._myRightGamepad.getButtonInfo(E.THUMBSTICK).isPressStart()&&this._myLeftGamepad.getButtonInfo(E.THUMBSTICK).isPressed())&&this._toggleVisibility(),this._myPulseTimer=Math.max(this._myPulseTimer-e,0),this._updateScrollWithThumbstick(e))}_toggleVisibility(){this._myWidgetFrame.toggleVisibility()}_widgetVisibleChanged(e){this._myUI.setVisible(e),e&&this._updateAllTexts()}_updateScrollWithThumbstick(e){if(this._myWidgetFrame.isVisible()&&this._myGamepadScrollEnabled){let t=Ce(0,0);if(this._myConfig.myScrollThumbstickHandedness==W.LEFT?t=this._myLeftGamepad.getAxesInfo(ne.THUMBSTICK).myAxes:this._myConfig.myScrollThumbstickHandedness==W.RIGHT&&(t=this._myRightGamepad.getAxesInfo(ne.THUMBSTICK).myAxes),Math.abs(t[1])>this._myConfig.myScrollThumbstickMinThreshold){for(this._myScrollThumbstickTimer+=e;this._myScrollThumbstickTimer>this._myConfig.myScrollThumbstickDelay;){this._myScrollThumbstickTimer-=this._myConfig.myScrollThumbstickDelay;let n=(Math.abs(t[1])-this._myConfig.myScrollThumbstickMinThreshold)/(1-this._myConfig.myScrollThumbstickMinThreshold);this._myScrollOffset+=Math.sign(t[1])*n*this._myConfig.myScrollThumbstickAmount}this._clampScrollOffset(),this._updateAllTexts()}else this._myScrollThumbstickTimer=0}}_pulseGamepad(){if(this._myLeftGamepad&&this._myRightGamepad){let e=this._myParams.myPulseOnNewMessage;(e==ra.ALWAYS||!this._myWidgetFrame.isVisible()&&e==ra.WHEN_HIDDEN)&&this._myPulseTimer==0&&(this._myParams.myHandedness==W.RIGHT?this._myRightGamepad.pulse(this._myConfig.myPulseIntensity,this._myConfig.myPulseDuration):this._myLeftGamepad.pulse(this._myConfig.myPulseIntensity,this._myConfig.myPulseDuration),this._myPulseTimer=this._myConfig.myPulseDelay)}}_isSimpleArray(e){if(this._isSpecialSimpleArray(e))return!0;if(Array.isArray(e)){let t=!0;for(let n of e)if(n instanceof Object){t=!1;break}return t}return!1}_isSpecialSimpleArray(e){return e&&e.constructor&&(e.constructor.name=="Uint8ClampedArray"||e.constructor.name=="Uint8Array"||e.constructor.name=="Uint16Array"||e.constructor.name=="Uint32Array"||e.constructor.name=="Int8Array"||e.constructor.name=="Int16Array"||e.constructor.name=="Int32Array"||e.constructor.name=="Float32Array"||e.constructor.name=="Float64Array")}_setGamepadScrollEnabled(e){this._myGamepadScrollEnabled=e,this._myConfig.myGamepadScrollOnlyOnHover||(this._myGamepadScrollEnabled=!0)}_jsonReplacer(e,t){if(t instanceof Map)return Array.from(t.entries());if(this._isSimpleArray(t)){let n=t;if(this._isSpecialSimpleArray(n)){let s=[];for(let a=0;a<n.length;a++)s[a]=n[a];n=s}let o=JSON.stringify(n);return o=o.split(",").join(", "),o}else return t}destroy(){this._myDestroyed=!0,m.getWindow(this._myEngine).removeEventListener("error",this._myErrorEventListener),m.getWindow(this._myEngine).removeEventListener("unhandledrejection",this._myUnhandledRejectionEventListener),this._myUI.destroy(),this._myWidgetFrame.destroy(),this._myParams.myResetBrowserConsoleOriginalFunctionsOnDestroy?(console.log=Ee.getLog(this._myEngine),console.error=Ee.getError(this._myEngine),console.warn=Ee.getWarn(this._myEngine),console.info=Ee.getInfo(this._myEngine),console.debug=Ee.getDebug(this._myEngine),console.assert=Ee.getAssert(this._myEngine),console.clear=Ee.getClear(this._myEngine)):(console.log=this._myOldBrowserConsole[re.LOG],console.error=this._myOldBrowserConsole[re.ERROR],console.warn=this._myOldBrowserConsole[re.WARN],console.info=this._myOldBrowserConsole[re.INFO],console.debug=this._myOldBrowserConsole[re.DEBUG],console.assert=this._myOldBrowserConsole[re.ASSERT],console.clear=this._myOldBrowserConsoleClear)}isDestroyed(){return this._myDestroyed}};import{Component as fV,Property as _a}from"@wonderlandengine/api";var No=class extends fV{static TypeName="pp-console-vr-tool";static Properties={_myHandedness:_a.enum(["None","Left","Right"],"None"),_myOverrideBrowserConsole:_a.bool(!0),_myShowOnStart:_a.bool(!1),_myShowVisibilityButton:_a.bool(!1),_myPulseOnNewMessage:_a.enum(["Never","Always","When Hidden"],"Never")};start(){if(this._myStarted=!1,m.isToolEnabled(this.engine)){this.object.pp_addComponent(ri),this._myWidget=new da(this.engine);let e=new ca(this.engine);e.myHandedness=[null,"left","right"][this._myHandedness],e.myOverrideBrowserConsole=this._myOverrideBrowserConsole,e.myShowOnStart=this._myShowOnStart,e.myShowVisibilityButton=this._myShowVisibilityButton,e.myPulseOnNewMessage=this._myPulseOnNewMessage,e.myPlaneMaterial=m.getDefaultMaterials(this.engine).myFlatOpaque.clone(),e.myTextMaterial=m.getDefaultMaterials(this.engine).myText.clone(),this._myWidget.start(this.object,e),this._myWidgetVisibleBackup=null,this._myStarted=!0}}update(e){m.isToolEnabled(this.engine)?this._myStarted&&(this._myWidgetVisibleBackup!=null&&(this._myWidget.setVisible(!1),this._myWidget.setVisible(this._myWidgetVisibleBackup),this._myWidgetVisibleBackup=null),this._myWidget.update(e)):this._myStarted&&(this._myWidgetVisibleBackup==null&&(this._myWidgetVisibleBackup=this._myWidget.isVisible()),this._myWidget.isVisible()&&this._myWidget.setVisible(!1))}onDeactivate(){this._myStarted&&(this._myWidgetVisibleBackup==null&&(this._myWidgetVisibleBackup=this._myWidget.isVisible()),this._myWidget.isVisible()&&this._myWidget.setVisible(!1))}onDestroy(){this._myStarted&&this._myWidget.destroy()}};import{Emitter as TV}from"@wonderlandengine/api";var un=new WeakMap,hn=new WeakMap;function Bb(i,e=m.getMainEngine()){if(un.has(e))for(let t of un.get(e).values())t(i)}function Lb(i=m.getMainEngine()){if(hn.has(i))for(let e of hn.get(i).values())e()}function Hb(i=null,e=!1,t=null,n=null,o=m.getMainEngine()){if(i==null||i.length==0)m.getNavigator(o).clipboard&&m.getNavigator(o).clipboard.readText().then(function(s){m.getEasyTuneVariables(o).fromJSON(s,e),He.refreshWidget(o),t?.(),console.log("Easy Tune Variables Imported from: clipboard"),console.log(s)},function(){n?.(),console.error("An error occurred while importing the easy tune variables from: clipboard")}).catch(function(s){n?.(),console.error("An error occurred while importing the easy tune variables from: clipboard"),console.error(s)});else{let s=Gb(i,o);fetch(s).then(function(a){a.ok?a.text().then(function(l){m.getEasyTuneVariables(o).fromJSON(l,e),He.refreshWidget(o),t?.(),console.log("Easy Tune Variables Imported from:",s),console.log(l)},function(l){n?.(),console.error("An error occurred while importing the easy tune variables from:",s),console.error(l)}):(n?.(),console.error("An error occurred while importing the easy tune variables from:",s),console.error(a))},function(a){n?.(),console.error("An error occurred while importing the easy tune variables from:",s),console.error(a)}).catch(function(a){n?.(),console.error("An error occurred while importing the easy tune variables from:",s),console.error(a)})}He.refreshWidget(o)}function kb(i=null,e=null,t=null,n=m.getMainEngine()){let o=m.getEasyTuneVariables(n).toJSON();if(i==null||i.length==0)m.getNavigator(n).clipboard&&m.getNavigator(n).clipboard.writeText(o).then(function(){e?.(),console.log("Easy Tune Variables Exported to: clipboard"),console.log(o)},function(){t?.(),console.error("An error occurred while exporting the easy tune variables to: clipboard")}).catch(function(s){t?.(),console.error("An error occurred while exporting the easy tune variables to: clipboard"),console.error(s)});else{let s=Gb(i,n);fetch(s,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:o}).then(function(a){a.ok?(e?.(),console.log("Easy Tune Variables Exported to:",s),console.log(o)):(t?.(),console.error("An error occurred while exporting the easy tune variables to:",s),console.error(a))},function(a){t?.(),console.error("An error occurred while exporting the easy tune variables to:",s),console.error(a)}).catch(function(a){t?.(),console.error("An error occurred while exporting the easy tune variables to:",s),console.error(a)})}}function Fb(i,e,t=m.getMainEngine()){un.has(t)||un.set(t,new Map),un.get(t).set(i,e)}function wb(i,e=m.getMainEngine()){un.has(e)&&un.get(e).delete(i)}function jb(i,e,t=m.getMainEngine()){hn.has(t)||hn.set(t,new Map),hn.get(t).set(i,e)}function zb(i,e=m.getMainEngine()){hn.has(e)&&hn.get(e).delete(i)}var He={setWidgetCurrentVariable:Bb,refreshWidget:Lb,importVariables:Hb,exportVariables:kb,addSetWidgetCurrentVariableCallback:Fb,removeSetWidgetCurrentVariableCallback:wb,addRefreshWidgetCallback:jb,removeRefreshWidgetCallback:zb},Gb=function(){let i=new RegExp("\\{.+?\\}","g");return function(t,n=m.getMainEngine()){let o=t.match(i);if(o==null||o.length==0)return t;for(let l=0;l<o.length;l++)o[l]=o[l].replace("{",""),o[l]=o[l].replace("}","");let s=new URL(m.getDocument(n).location).searchParams,a=t;for(let l of o){let h=s.get(l);h!=null&&(a=a.replace("{"+l+"}",h))}return a}}();var Yt={NONE:0,NUMBER:1,BOOL:2,TRANSFORM:3},ga=class i{constructor(e,t,n=null,o=!0,s=m.getMainEngine()){this._myName=e,this._myType=t,this._myValue=null,this._myDefaultValue=null,this._myShowOnWidget=o,this._myWidgetCurrentVariable=!1,this._myValueChangedEmitter=new TV,this._myEngine=s,n!=null&&this.registerValueChangedEventListener(this,n)}getName(){return this._myName}getType(){return this._myType}isWidgetCurrentVariable(){return this._myWidgetCurrentVariable}setWidgetCurrentVariable(e){this._myWidgetCurrentVariable=e}getValue(){return this._myValue}setValue(e,t=!1){let n=this._myValue!=e;this._myValue=e,t&&i.prototype.setDefaultValue.call(this,e),He.refreshWidget(this._myEngine),n&&this._myValueChangedEmitter.notify(this.getValue(),this)}getDefaultValue(){return this._myDefaultValue}setDefaultValue(e){this._myDefaultValue=e}shouldShowOnWidget(){return this._myShowOnWidget}setShowOnWidget(e){this._myShowOnWidget=e}fromJSON(e,t=!1){this.setValue(JSON.parse(e),t)}toJSON(){return JSON.stringify(this.getValue())}registerValueChangedEventListener(e,t){this._myValueChangedEmitter.add(t,{id:e})}unregisterValueChangedEventListener(e){this._myValueChangedEmitter.remove(e)}},cn=class i extends ga{constructor(e,t,n,o,s,a){super(e,t,o,s,a),i.prototype.setValue.call(this,n,!0)}setValue(e,t=!1){let n=this._myValue!=null&&!this._myValue.pp_equals(e);this._myValue==null?this._myValue=e.pp_clone():this._myValue.pp_copy(e),t&&i.prototype.setDefaultValue.call(this,e),He.refreshWidget(this._myEngine),n&&this._myValueChangedEmitter.notify(this.getValue(),this)}setDefaultValue(e){this._myDefaultValue==null?this._myDefaultValue=e.pp_clone():this._myDefaultValue.pp_copy(e)}},fi=class extends cn{constructor(e,t,n,o,s=3,a=1,l=null,h=null,_=!1,y){super(e,Yt.NUMBER,t,n,o,y),this._myDecimalPlaces=s,this._myStepPerSecond=a,this._myDefaultStepPerSecond=this._myStepPerSecond,this._myMin=l,this._myMax=h,this._myEditAllValuesTogether=_,this._clampValue(!0)}setMax(e){this._myMax=e,this._clampValue(!1)}setMin(e){this._myMin=e,this._clampValue(!1)}_clampValue(e){let t=this._myValue.vec_clamp(this._myMin,this._myMax);if(!e){let n=this.getDefaultValue().vec_clamp(this._myMin,this._myMax);!n.vec_equals(this.getDefaultValue(),1e-5)&&cn.prototype.setDefaultValue.call(this,n)}cn.prototype.setValue.call(this,t,e)}},Vi=class extends fi{constructor(e,t,n,o,s,a,l,h,_){super(e,[t],n,o,s,a,l,h,_),this._myTempValue=[0],this._myTempDefaultValue=[0]}getValue(){return super.getValue()[0]}setValue(e,t=!1){this._myTempValue[0]=e,super.setValue(this._myTempValue,t)}getDefaultValue(){return super.getDefaultValue()[0]}setDefaultValue(e){this._myTempDefaultValue[0]=e,super.setDefaultValue(this._myTempValue)}},fa=class extends Vi{constructor(e,t,n,o,s,a,l,h){super(e,t,n,o,0,s,a,l,h)}},Ti=class extends fi{constructor(e,t,n,o,s,a,l,h,_){let y=t.pp_clone();for(let r=0;r<t.length;r++)y[r]=Math.round(y[r]);super(e,y,n,o,0,s,a!=null?Math.round(a):null,l!=null?Math.round(l):l,h,_)}},qr=class extends cn{constructor(e,t,n,o,s){super(e,Yt.BOOL,t,n,o,s)}},um=class extends qr{constructor(e,t,n,o,s){super(e,[t],n,o,s),this._myTempValue=[0],this._myTempDefaultValue=[0]}getValue(){return super.getValue()[0]}setValue(e,t=!1){this._myTempValue[0]=e,super.setValue(this._myTempValue,t)}getDefaultValue(){return super.getDefaultValue()[0]}setDefaultValue(e){this._myTempDefaultValue[0]=e,super.setDefaultValue(this._myTempValue)}},Ta=class i extends ga{constructor(e,t,n,o,s=!0,a=3,l=1,h=50,_=1,y){super(e,Yt.TRANSFORM,n,o,y),this._myDecimalPlaces=a,this._myPosition=t.mat4_getPosition(),this._myRotation=t.mat4_getRotationDegrees(),this._myScale=t.mat4_getScale();let r=Math.pow(10,this._myDecimalPlaces);for(let u=0;u<3;u++)this._myScale[u]=Math.max(this._myScale[u],1/r);this._myScaleAsOne=s,this._myPositionStepPerSecond=l,this._myRotationStepPerSecond=h,this._myScaleStepPerSecond=_,this._myDefaultPosition=this._myPosition.vec3_clone(),this._myDefaultRotation=this._myRotation.vec3_clone(),this._myDefaultScale=this._myScale.vec3_clone(),this._myDefaultPositionStepPerSecond=this._myPositionStepPerSecond,this._myDefaultRotationStepPerSecond=this._myRotationStepPerSecond,this._myDefaultScaleStepPerSecond=this._myScaleStepPerSecond,this._myTransform=be(),this._myTransform.mat4_setPositionRotationDegreesScale(this._myPosition,this._myRotation,this._myScale),this._myTempTransform=be()}getValue(){return this._myTransform.mat4_setPositionRotationDegreesScale(this._myPosition,this._myRotation,this._myScale),this._myTransform}setValue(e,t=!1){this._myTempTransform.mat4_setPositionRotationDegreesScale(this._myPosition,this._myRotation,this._myScale),e.mat4_getPosition(this._myPosition),e.mat4_getRotationDegrees(this._myRotation),e.mat4_getScale(this._myScale),this._myTransform.mat4_setPositionRotationDegreesScale(this._myPosition,this._myRotation,this._myScale);let n=!this._myTempTransform.pp_equals(this._myTransform);t&&i.prototype.setDefaultValue.call(this,e),He.refreshWidget(this._myEngine),n&&this._myValueChangedEmitter.notify(this.getValue(),this)}setDefaultValue(e){this._myDefaultPosition=e.mat4_getPosition(),this._myDefaultRotation=e.mat4_getRotationDegrees(),this._myDefaultScale=e.mat4_getScale()}fromJSON(e,t=!1){this.setValue(JSON.parse(e),t)}toJSON(){return this.getValue().vec_toString()}};import{Component as MV,Property as Pi}from"@wonderlandengine/api";import{Emitter as PV}from"@wonderlandengine/api";var Pa=class{constructor(){this.myVariablesImportCallback=null,this.myVariablesExportCallback=null}},kt=class{constructor(e){this._myConfig=null,this._myUI=null,this._myParams=e,this._myVariable=null,this._myVisible=!0,this._myScrollVariableRequestEmitter=new PV,this._myAppendToVariableName="",this._myScrollVariableActive=!1,this._myScrollDirection=0,this._myScrollVariableTimer=0,this._myHasScrolled=!1,this._myResetImportLabelTimer=new te(0,!1),this._myResetExportLabelTimer=new te(0,!1),this._myDestroyed=!1}setVisible(e){e&&this._refreshUI(),this._myUI.setVisible(e),this._myVisible=e}setEasyTuneVariable(e,t){this._myVariable=e,typeof t<"u"?this._myAppendToVariableName=t:this._myAppendToVariableName="",this._setEasyTuneVariableHook(),this._refreshUI()}isScrollVariableActive(){return this._myScrollVariableActive}getScrollVariableDirection(){return this._myScrollDirection}setScrollVariableActive(e,t){this._myScrollVariableActive=e,this._myScrollDirection=t,this._myScrollVariableTimer=this._myConfig.myScrollVariableDelay,this._myHasScrolled=!1}getWidget(){return this}syncWidget(e){e!=null?(e._myResetImportLabelTimer.isRunning()?this._myResetImportLabelTimer.start(e._myResetImportLabelTimer.getTimeLeft()):this._myResetImportLabelTimer.reset(),e._myResetExportLabelTimer.isRunning()?this._myResetExportLabelTimer.start(e._myResetExportLabelTimer.getTimeLeft()):this._myResetExportLabelTimer.reset(),this._myUI.myImportButtonTextComponent.text=e._myUI.myImportButtonTextComponent.text,this._myUI.myExportButtonTextComponent.text=e._myUI.myExportButtonTextComponent.text,this.setScrollVariableActive(e.isScrollVariableActive(),e.getScrollVariableDirection())):(this._myResetImportLabelTimer.reset(),this._myUI.myImportButtonTextComponent.text=this._myConfig.myImportButtonText,this._myResetExportLabelTimer.reset(),this._myUI.myExportButtonTextComponent.text=this._myConfig.myExportButtonText)}onImportSuccess(){this._myUI.myImportButtonTextComponent.text=this._myConfig.myImportSuccessButtonText,this._myResetImportLabelTimer.start(this._myConfig.myImportExportResetLabelSeconds)}onImportFailure(){this._myUI.myImportButtonTextComponent.text=this._myConfig.myImportFailureButtonText,this._myResetImportLabelTimer.start(this._myConfig.myImportExportResetLabelSeconds)}onExportSuccess(){this._myUI.myExportButtonTextComponent.text=this._myConfig.myExportSuccessButtonText,this._myResetExportLabelTimer.start(this._myConfig.myImportExportResetLabelSeconds)}onExportFailure(){this._myUI.myExportButtonTextComponent.text=this._myConfig.myExportFailureButtonText,this._myResetExportLabelTimer.start(this._myConfig.myImportExportResetLabelSeconds)}registerScrollVariableRequestEventListener(e,t){this._myScrollVariableRequestEmitter.add(t,{id:e})}unregisterScrollVariableRequestEventListener(e){this._myScrollVariableRequestEmitter.remove(e)}start(e,t){this._myConfig.build(),this._myResetImportLabelTimer.setDuration(this._myConfig.myImportExportResetLabelSeconds),this._myResetExportLabelTimer.setDuration(this._myConfig.myImportExportResetLabelSeconds),this._myUI.build(e,this._myConfig,t),this._myUI.setImportExportButtonsVisible(t.myShowVariablesImportExportButtons),this._startHook(e,t),this._addListeners()}update(e){this._isActive()&&(this._updateHook(e),this._updateScrollVariable(e),this._updateImportExportLabel(e))}_setEasyTuneVariableHook(){}_refreshUIHook(){}_startHook(e,t){}_addListenersHook(){}_updateHook(e){}_refreshUI(){if(this._myVariable){if(this._myVariable.getName()!=null)this._myUI.myVariableLabelTextComponent.text=this._myVariable.getName().concat(this._myAppendToVariableName);else{let e="Unknown";this._myUI.myVariableLabelTextComponent.text=e.concat(this._myAppendToVariableName)}this._refreshUIHook()}}_updateScrollVariable(e){this._myScrollVariableActive&&(this._myScrollVariableTimer<=0?(this._scrollVariableRequest(this._myScrollDirection),this._myScrollVariableTimer=this._myConfig.myScrollVariableDelay,this._myHasScrolled=!0):this._myScrollVariableTimer-=e)}_updateImportExportLabel(e){this._myResetImportLabelTimer.isRunning(e)&&(this._myResetImportLabelTimer.update(e),this._myResetImportLabelTimer.isDone()&&(this._myResetImportLabelTimer.reset(),this._myUI.myImportButtonTextComponent.text=this._myConfig.myImportButtonText)),this._myResetExportLabelTimer.isRunning(e)&&(this._myResetExportLabelTimer.update(e),this._myResetExportLabelTimer.isDone()&&(this._myResetExportLabelTimer.reset(),this._myUI.myExportButtonTextComponent.text=this._myConfig.myExportButtonText))}_isActive(){return this._myVisible&&this._myVariable}_addListeners(){let e=this._myUI;e.myNextButtonCursorTargetComponent.onDown.add(this._setScrollVariableActive.bind(this,!0,1,!1)),e.myNextButtonCursorTargetComponent.onDownOnHover.add(this._setScrollVariableActive.bind(this,!0,1,!1)),e.myNextButtonCursorTargetComponent.onUpWithDown.add(this._setScrollVariableActive.bind(this,!1,0,!1)),e.myNextButtonCursorTargetComponent.onUpWithNoDown.add(this._setScrollVariableActive.bind(this,!1,0,!0)),e.myNextButtonCursorTargetComponent.onUnhover.add(this._setScrollVariableActive.bind(this,!1,0,!0)),e.myNextButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myNextButtonBackgroundComponent.material)),e.myNextButtonCursorTargetComponent.onUnhover.add(this._genericUnhover.bind(this,e.myNextButtonBackgroundComponent.material)),e.myPreviousButtonCursorTargetComponent.onDown.add(this._setScrollVariableActive.bind(this,!0,-1,!1)),e.myPreviousButtonCursorTargetComponent.onDownOnHover.add(this._setScrollVariableActive.bind(this,!0,-1,!1)),e.myPreviousButtonCursorTargetComponent.onUpWithDown.add(this._setScrollVariableActive.bind(this,!1,0,!1)),e.myPreviousButtonCursorTargetComponent.onUpWithNoDown.add(this._setScrollVariableActive.bind(this,!1,0,!0)),e.myPreviousButtonCursorTargetComponent.onUnhover.add(this._setScrollVariableActive.bind(this,!1,0,!0)),e.myPreviousButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myPreviousButtonBackgroundComponent.material)),e.myPreviousButtonCursorTargetComponent.onUnhover.add(this._genericUnhover.bind(this,e.myPreviousButtonBackgroundComponent.material)),e.myImportButtonCursorTargetComponent.onUpWithDown.add(this._importVariables.bind(this)),e.myImportButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myImportButtonBackgroundComponent.material)),e.myImportButtonCursorTargetComponent.onUnhover.add(this._genericUnhover.bind(this,e.myImportButtonBackgroundComponent.material)),e.myExportButtonCursorTargetComponent.onUpWithDown.add(this._exportVariables.bind(this)),e.myExportButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myExportButtonBackgroundComponent.material)),e.myExportButtonCursorTargetComponent.onUnhover.add(this._genericUnhover.bind(this,e.myExportButtonBackgroundComponent.material)),this._addListenersHook()}_setScrollVariableActive(e,t,n){if(this._isActive()||!e){let o=!e&&!this._myHasScrolled&&!n,s=this._myScrollDirection;this.setScrollVariableActive(e,t),o&&this._scrollVariableRequest(s)}}_scrollVariableRequest(e){this._isActive()&&e!=0&&this._myScrollVariableRequestEmitter.notify(e)}_genericHover(e){e.color=this._myConfig.myButtonHoverColor}_genericUnhover(e){e.color=this._myConfig.myBackgroundColor}_importVariables(){this._myUI.myImportButtonTextComponent.text==this._myConfig.myImportButtonText&&(this._myUI.myImportButtonTextComponent.text=this._myConfig.myImportingButtonText,this._myResetImportLabelTimer.reset(),this._myParams.myVariablesImportCallback())}_exportVariables(){this._myUI.myExportButtonTextComponent.text==this._myConfig.myExportButtonText&&(this._myUI.myExportButtonTextComponent.text=this._myConfig.myExportingButtonText,this._myResetExportLabelTimer.reset(),this._myParams.myVariablesExportCallback())}destroy(){this._myDestroyed=!0,this._myUI!=null&&this._myUI.destroy()}isDestroyed(){return this._myDestroyed}};import{Emitter as CV}from"@wonderlandengine/api";var pn=class{constructor(e,t,n=m.getMainEngine()){this._myGamepad=t,this._myParentObject=null,this._myParams=e,this._myEasyTuneParams=null,this._myWidgets=new Map,this._myVariable=null,this._myVisible=!0,this._myAppendToVariableName=null,this._myScrollVariableRequestEmitter=new CV,this._myCurrentArraySize=null,this._myEngine=n,this._myDestroyed=!1}setEasyTuneVariable(e,t){this._myVariable=e,this._myCurrentArraySize=this._myVariable.getValue().length,this._myAppendToVariableName=t,this._myWidgets.has(this._myCurrentArraySize)||this._createWidget(this._myCurrentArraySize);let n=this._myWidgets.get(this._myCurrentArraySize);n&&n.setEasyTuneVariable(e,t),this.setVisible(this._myVisible)}setVisible(e){for(let t of this._myWidgets.values())t.setVisible(!1);if(this._myVariable){this._sizeChangedCheck();let t=this._myWidgets.get(this._myCurrentArraySize);t&&t.setVisible(e)}this._myVisible=e}isScrollVariableActive(){let e=this._myWidgets.get(this._myCurrentArraySize);return e?e.isScrollVariableActive():!1}getScrollVariableDirection(){let e=this._myWidgets.get(this._myCurrentArraySize);return e?e.getScrollVariableDirection():0}setScrollVariableActive(e,t){let n=this._myWidgets.get(this._myCurrentArraySize);n&&n.setScrollVariableActive(e,t)}getWidget(){return this._myWidgets.get(this._myCurrentArraySize)}registerScrollVariableRequestEventListener(e,t){this._myScrollVariableRequestEmitter.add(t,{id:e})}unregisterScrollVariableRequestEventListener(e){this._myScrollVariableRequestEmitter.remove(e)}start(e,t){this._myParentObject=e,this._myEasyTuneParams=t,this._createWidget(1),this._myVariable&&this.setEasyTuneVariable(this._myVariable,this._myAppendToVariableName)}update(e){if(this._isActive()){this._sizeChangedCheck();let t=this._myWidgets.get(this._myCurrentArraySize);t&&t.update(e)}}onImportSuccess(){let e=this._myWidgets.get(this._myCurrentArraySize);e&&e.onImportSuccess()}onImportFailure(){let e=this._myWidgets.get(this._myCurrentArraySize);e&&e.onImportFailure()}onExportSuccess(){let e=this._myWidgets.get(this._myCurrentArraySize);e&&e.onExportSuccess()}onExportFailure(){let e=this._myWidgets.get(this._myCurrentArraySize);e&&e.onExportFailure()}_isActive(){return this._myVisible&&this._myVariable}_scrollVariableRequest(e){this._myScrollVariableRequestEmitter.notify(e)}_createWidget(e){this._myWidgets.set(e,this._getEasyTuneArrayWidget(e)),this._myWidgets.get(e).start(this._myParentObject,this._myEasyTuneParams),this._myWidgets.get(e).setVisible(!1),this._myWidgets.get(e).registerScrollVariableRequestEventListener(this,this._scrollVariableRequest.bind(this))}_sizeChangedCheck(){this._myVariable.getValue().length!=this._myCurrentArraySize&&this.setEasyTuneVariable(this._myVariable,this._myAppendToVariableName)}_getEasyTuneArrayWidget(e){return null}destroy(){this._myDestroyed=!0;for(let e of this._myWidgets.values())e.destroy()}isDestroyed(){return this._myDestroyed}};import{Alignment as bV,Collider as SV,Justification as vV}from"@wonderlandengine/api";var Ft=class{constructor(){}build(){this._setupBuildConfig(),this._setupRuntimeConfig()}_getBackPanelMaxY(){return this.myDisplayPanelPosition[1]+this.myVariableLabelPanelPosition[1]+this.mySideButtonBackgroundScale[1]+this._mySideButtonDistanceFromBorder*1.25}_getBackPanelMinY(){return this.myDisplayPanelPosition[1]-this._mySideButtonDistanceFromBorder*1.25-this.mySideButtonBackgroundScale[1]}_getBackPanelMaxX(){return this._mySideButtonPanelHalfWidth}_getBackPanelMinX(){return-this._mySideButtonPanelHalfWidth}_getPivotZOffset(){return 0}_setupBuildConfigHook(){}_setupRuntimeConfigHook(){}_setupBuildConfig(){this.myBackgroundColor=F(46/255,46/255,46/255,1),this.myCursorTargetCollisionCollider=SV.Box,this.myCursorTargetCollisionGroup=7,this.myCursorTargetCollisionThickness=.001,this.myDefaultTextColor=F(255/255,255/255,255/255,1),this.myTextAlignment=bV.Center,this.myTextJustification=vV.Middle,this.myTextColor=this.myDefaultTextColor,this.myLabelTextScale=p(.18,.18,.18),this.myButtonTextScale=p(.18,.18,.18),this._myPanelZOffset=.01,this._myColliderZOffset=.017,this._mySideButtonDistanceFromBorder=.0125,this._mySideButtonPanelHalfWidth=.2,this.myPivotObjectPositions=[],this.myPivotObjectPositions[W.NONE]=p(0,0,this._getPivotZOffset()),this.myPivotObjectPositions[W.LEFT]=p(-.04,.02,this._getPivotZOffset()),this.myPivotObjectPositions[W.RIGHT]=p(-.08,.02,this._getPivotZOffset()),this.mySideButtonBackgroundScale=p(.015,.015,1),this.mySideButtonTextScale=this.myButtonTextScale,this.mySideButtonTextPosition=p(0,0,.007),this.mySideButtonCursorTargetPosition=p(0,0,0),this.mySideButtonCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.mySideButtonCollisionExtents=this.mySideButtonBackgroundScale.pp_clone(),this.mySideButtonCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myLeftSideButtonPosition=p(0,0,-1e-5),this.myLeftSideButtonPosition[0]=-this._mySideButtonPanelHalfWidth+this.mySideButtonBackgroundScale[0]+this._mySideButtonDistanceFromBorder,this.myRightSideButtonPosition=p(0,0,-1e-5),this.myRightSideButtonPosition[0]=-this.myLeftSideButtonPosition[0],this.myDisplayPanelPosition=p(0,.1,0),this.myVariableLabelPanelPosition=p(0,.025,this._myPanelZOffset),this.myVariableLabelTextScale=this.myLabelTextScale,this.myVariableLabelCursorTargetPosition=p(0,0,0),this.myVariableLabelCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myVariableLabelCollisionExtents=p(.065,.0175,1),this.myVariableLabelCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myNextButtonText=">",this.myPreviousButtonText="<",this._setupBuildConfigHook();{let e=this._getBackPanelMaxX(),t=this._getBackPanelMinX(),n=this._getBackPanelMaxY(),o=this._getBackPanelMinY();this.myBackPanelPosition=[(e+t)/2,(n+o)/2,0],this.myBackBackgroundScale=[(e-t)/2,(n-o)/2,1],this.myBackBackgroundColor=F(70/255,70/255,70/255,1)}this.myImportExportButtonBackgroundScale=p(.04,.02,1),this.myImportExportButtonTextScale=this.myButtonTextScale,this.myImportExportButtonTextPosition=p(0,0,.007),this.myImportExportPanelPosition=[0,this._getBackPanelMaxY()+this._mySideButtonDistanceFromBorder+this.myImportExportButtonBackgroundScale[1],this._myPanelZOffset],this.myImportExportButtonCursorTargetPosition=p(0,0,0),this.myImportExportButtonCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myImportExportButtonCollisionExtents=this.myImportExportButtonBackgroundScale.pp_clone(),this.myImportExportButtonCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myImportButtonText="Import",this.myExportButtonText="Export",this.myImportExportResetLabelSeconds=2,this.myImportingButtonText="...",this.myImportSuccessButtonText="Done",this.myImportFailureButtonText="Error",this.myExportingButtonText="...",this.myExportSuccessButtonText="Done",this.myExportFailureButtonText="Error",this.myImportButtonPosition=p(0,0,-1e-5),this.myImportButtonPosition[0]=-this.myImportExportButtonBackgroundScale[0]-this._mySideButtonDistanceFromBorder/2,this.myExportButtonPosition=p(0,0,-1e-5),this.myExportButtonPosition[0]=-this.myImportButtonPosition[0],this.myPointerCollisionExtents=this.myBackBackgroundScale.pp_clone(),this.myPointerCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myPointerCursorTargetPosition=this.myBackPanelPosition.pp_clone(),this.myPointerCursorTargetPosition[2]=this._myColliderZOffset-1e-4}_setupRuntimeConfig(){this.myButtonHoverColor=F(150/255,150/255,150/255,1),this.myScrollVariableDelay=.5,this._setupRuntimeConfigHook()}};var Ca=class extends Ft{constructor(e){super(),this.myArraySize=e}_getBackPanelMinY(){let e=this.myValuePanelsPositions[this.myArraySize-1]?this.myValuePanelsPositions[this.myArraySize-1][1]:0;return super._getBackPanelMinY()+this.myValuesPanelPosition[1]+e}_getPivotZOffset(){return .00802713}_setupBuildConfigHook(){this.myIncreaseButtonText="+",this.myDecreaseButtonText="-",this._myValuePanelDistanceFromVariableLabelPanel=.055,this._myDistanceBetweenValues=this.mySideButtonBackgroundScale[1]*2+.015,this.myValuesPanelPosition=[0,this.myVariableLabelPanelPosition[1]-this._myValuePanelDistanceFromVariableLabelPanel,this._myPanelZOffset],this.myValueTextScale=p(.4,.4,.4),this.myValueCursorTargetPosition=p(0,0,0),this.myValueCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myValueCollisionExtents=p(.065,.02,1),this.myValueCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myValuePanelsPositions=[],this.myValuePanelsPositions[0]=p(0,0,0);for(let e=1;e<this.myArraySize;e++)this.myValuePanelsPositions[e]=this.myValuePanelsPositions[e-1].pp_clone(),this.myValuePanelsPositions[e][1]-=this._myDistanceBetweenValues}_setupRuntimeConfigHook(){this.myTextHoverScaleMultiplier=p(1.1,1.1,1.1),this.myThumbstickToggleThreshold=.6,this.myButtonEditDelay=0}};import{CollisionComponent as hm,MeshComponent as Nb,TextComponent as cm}from"@wonderlandengine/api";import{CursorTarget as pm}from"@wonderlandengine/components";import{CollisionComponent as lo,MeshComponent as ba,TextComponent as Sa}from"@wonderlandengine/api";import{CursorTarget as va}from"@wonderlandengine/components";var wt=class{constructor(e=m.getMainEngine()){this._myEngine=e,this._myDestroyed=!1}build(e,t,n){this._myParentObject=e,this._myConfig=t,this._myParams=n,this._myImportExportButtonsVisible=!0,this._myPlaneMesh=m.getDefaultMeshes(this._myEngine).myDoubleSidedPlane,this._buildHook(),this._createSkeleton(),this._setTransforms(),this._addComponents(),this._setTransformForNonXR(),O.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this._myEngine)}setVisible(e){this.myPivotObject.pp_setActive(e),e&&this.setImportExportButtonsVisible(this._myImportExportButtonsVisible),this._setVisibleHook(e)}setImportExportButtonsVisible(e){this._myImportExportButtonsVisible=e,this.myImportExportPanel.pp_setActive(this._myImportExportButtonsVisible)}_buildHook(){}_setVisibleHook(e){}_createSkeletonHook(){}_setTransformHook(){}_addComponentsHook(){}_createSkeleton(){this.myPivotObject=this._myParentObject.pp_addObject(),this.myBackPanel=this.myPivotObject.pp_addObject(),this.myBackBackground=this.myBackPanel.pp_addObject(),this.myDisplayPanel=this.myPivotObject.pp_addObject(),this.myVariableLabelPanel=this.myDisplayPanel.pp_addObject(),this.myVariableLabelText=this.myVariableLabelPanel.pp_addObject(),this.myVariableLabelCursorTarget=this.myVariableLabelPanel.pp_addObject(),this.myNextButtonPanel=this.myVariableLabelPanel.pp_addObject(),this.myNextButtonBackground=this.myNextButtonPanel.pp_addObject(),this.myNextButtonText=this.myNextButtonPanel.pp_addObject(),this.myNextButtonCursorTarget=this.myNextButtonPanel.pp_addObject(),this.myPreviousButtonPanel=this.myVariableLabelPanel.pp_addObject(),this.myPreviousButtonBackground=this.myPreviousButtonPanel.pp_addObject(),this.myPreviousButtonText=this.myPreviousButtonPanel.pp_addObject(),this.myPreviousButtonCursorTarget=this.myPreviousButtonPanel.pp_addObject(),this.myImportExportPanel=this.myPivotObject.pp_addObject(),this.myImportButtonPanel=this.myImportExportPanel.pp_addObject(),this.myImportButtonBackground=this.myImportButtonPanel.pp_addObject(),this.myImportButtonText=this.myImportButtonPanel.pp_addObject(),this.myImportButtonCursorTarget=this.myImportButtonPanel.pp_addObject(),this.myExportButtonPanel=this.myImportExportPanel.pp_addObject(),this.myExportButtonBackground=this.myExportButtonPanel.pp_addObject(),this.myExportButtonText=this.myExportButtonPanel.pp_addObject(),this.myExportButtonCursorTarget=this.myExportButtonPanel.pp_addObject(),this.myPointerCursorTarget=this.myPivotObject.pp_addObject(),this._createSkeletonHook()}_setTransforms(){this.myPivotObject.pp_setPositionLocal(this._myConfig.myPivotObjectPositions[this._myParams.myHandedness]),this.myBackPanel.pp_setPositionLocal(this._myConfig.myBackPanelPosition),this.myBackBackground.pp_scaleObject(this._myConfig.myBackBackgroundScale),this.myDisplayPanel.pp_setPositionLocal(this._myConfig.myDisplayPanelPosition),this.myVariableLabelPanel.pp_setPositionLocal(this._myConfig.myVariableLabelPanelPosition),this.myVariableLabelText.pp_scaleObject(this._myConfig.myVariableLabelTextScale),this.myVariableLabelCursorTarget.pp_setPositionLocal(this._myConfig.myVariableLabelCursorTargetPosition),this.myNextButtonPanel.pp_setPositionLocal(this._myConfig.myRightSideButtonPosition),this.myNextButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myNextButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myNextButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myNextButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myPreviousButtonPanel.pp_setPositionLocal(this._myConfig.myLeftSideButtonPosition),this.myPreviousButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myPreviousButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myPreviousButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myPreviousButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myImportExportPanel.pp_setPositionLocal(this._myConfig.myImportExportPanelPosition),this.myImportButtonPanel.pp_setPositionLocal(this._myConfig.myImportButtonPosition),this.myImportButtonBackground.pp_scaleObject(this._myConfig.myImportExportButtonBackgroundScale),this.myImportButtonText.pp_setPositionLocal(this._myConfig.myImportExportButtonTextPosition),this.myImportButtonText.pp_scaleObject(this._myConfig.myImportExportButtonTextScale),this.myImportButtonCursorTarget.pp_setPositionLocal(this._myConfig.myImportExportButtonCursorTargetPosition),this.myExportButtonPanel.pp_setPositionLocal(this._myConfig.myExportButtonPosition),this.myExportButtonBackground.pp_scaleObject(this._myConfig.myImportExportButtonBackgroundScale),this.myExportButtonText.pp_setPositionLocal(this._myConfig.myImportExportButtonTextPosition),this.myExportButtonText.pp_scaleObject(this._myConfig.myImportExportButtonTextScale),this.myExportButtonCursorTarget.pp_setPositionLocal(this._myConfig.myImportExportButtonCursorTargetPosition),this.myPointerCursorTarget.pp_setPositionLocal(this._myConfig.myPointerCursorTargetPosition),this._setTransformHook()}_addComponents(){this.myBackBackgroundComponent=this.myBackBackground.pp_addComponent(ba),this.myBackBackgroundComponent.mesh=this._myPlaneMesh,this.myBackBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myBackBackgroundComponent.material.color=this._myConfig.myBackBackgroundColor,this.myVariableLabelTextComponent=this.myVariableLabelText.pp_addComponent(Sa),this._setupTextComponent(this.myVariableLabelTextComponent),this.myVariableLabelTextComponent.text=" ",this.myVariableLabelCursorTargetComponent=this.myVariableLabelCursorTarget.pp_addComponent(va),this.myVariableLabelCollisionComponent=this.myVariableLabelCursorTarget.pp_addComponent(lo),this.myVariableLabelCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myVariableLabelCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myVariableLabelCollisionComponent.extents=this._myConfig.myVariableLabelCollisionExtents,this.myNextButtonBackgroundComponent=this.myNextButtonBackground.pp_addComponent(ba),this.myNextButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myNextButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myNextButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myNextButtonTextComponent=this.myNextButtonText.pp_addComponent(Sa),this._setupTextComponent(this.myNextButtonTextComponent),this.myNextButtonTextComponent.text=this._myConfig.myNextButtonText,this.myNextButtonCursorTargetComponent=this.myNextButtonCursorTarget.pp_addComponent(va),this.myNextButtonCollisionComponent=this.myNextButtonCursorTarget.pp_addComponent(lo),this.myNextButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myNextButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myNextButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myPreviousButtonBackgroundComponent=this.myPreviousButtonBackground.pp_addComponent(ba),this.myPreviousButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPreviousButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myPreviousButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myPreviousButtonTextComponent=this.myPreviousButtonText.pp_addComponent(Sa),this._setupTextComponent(this.myPreviousButtonTextComponent),this.myPreviousButtonTextComponent.text=this._myConfig.myPreviousButtonText,this.myPreviousButtonCursorTargetComponent=this.myPreviousButtonCursorTarget.pp_addComponent(va),this.myPreviousButtonCollisionComponent=this.myPreviousButtonCursorTarget.pp_addComponent(lo),this.myPreviousButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPreviousButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPreviousButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myImportButtonBackgroundComponent=this.myImportButtonBackground.pp_addComponent(ba),this.myImportButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myImportButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myImportButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myImportButtonTextComponent=this.myImportButtonText.pp_addComponent(Sa),this._setupTextComponent(this.myImportButtonTextComponent),this.myImportButtonTextComponent.text=this._myConfig.myImportButtonText,this.myImportButtonCursorTargetComponent=this.myImportButtonCursorTarget.pp_addComponent(va),this.myImportButtonCollisionComponent=this.myImportButtonCursorTarget.pp_addComponent(lo),this.myImportButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myImportButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myImportButtonCollisionComponent.extents=this._myConfig.myImportExportButtonCollisionExtents,this.myExportButtonBackgroundComponent=this.myExportButtonBackground.pp_addComponent(ba),this.myExportButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myExportButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myExportButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myExportButtonTextComponent=this.myExportButtonText.pp_addComponent(Sa),this._setupTextComponent(this.myExportButtonTextComponent),this.myExportButtonTextComponent.text=this._myConfig.myExportButtonText,this.myExportButtonCursorTargetComponent=this.myExportButtonCursorTarget.pp_addComponent(va),this.myExportButtonCollisionComponent=this.myExportButtonCursorTarget.pp_addComponent(lo),this.myExportButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myExportButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myExportButtonCollisionComponent.extents=this._myConfig.myImportExportButtonCollisionExtents,this.myPointerCollisionComponent=this.myPointerCursorTarget.pp_addComponent(lo),this.myPointerCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPointerCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPointerCollisionComponent.extents=this._myConfig.myPointerCollisionExtents,this._addComponentsHook()}_setupTextComponent(e){e.alignment=this._myConfig.myTextAlignment,e.justification=this._myConfig.myTextJustification,e.material=this._myParams.myTextMaterial.clone(),e.material.color=this._myConfig.myTextColor,e.text=""}_onXRSessionStart(){this._setTransformForXR()}_onXRSessionEnd(){this._setTransformForNonXR()}_setTransformForXR(){this.myPivotObject.pp_setPositionLocal(this._myConfig.myPivotObjectPositions[this._myParams.myHandedness])}_setTransformForNonXR(){this.myPivotObject.pp_setPositionLocal(this._myConfig.myPivotObjectPositions[W.NONE])}destroy(){this._myDestroyed=!0,O.unregisterSessionStartEndEventListeners(this,this._myEngine)}isDestroyed(){return this._myDestroyed}};var xa=class extends wt{constructor(e){super(e)}setAdditionalButtonsVisible(e){this._myAdditionalButtonsVisible=e;for(let t=0;t<this._myConfig.myArraySize;t++)this.myValueIncreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible),this.myValueDecreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible)}_buildHook(){this._myAdditionalButtonsVisible=!0}_createSkeletonHook(){this.myValuesPanel=this.myDisplayPanel.pp_addObject(),this.myValuePanels=[],this.myValueTexts=[],this.myValueCursorTargets=[],this.myValueIncreaseButtonPanels=[],this.myValueIncreaseButtonBackgrounds=[],this.myValueIncreaseButtonTexts=[],this.myValueIncreaseButtonCursorTargets=[],this.myValueDecreaseButtonPanels=[],this.myValueDecreaseButtonBackgrounds=[],this.myValueDecreaseButtonTexts=[],this.myValueDecreaseButtonCursorTargets=[];for(let e=0;e<this._myConfig.myArraySize;e++)this.myValuePanels[e]=this.myValuesPanel.pp_addObject(),this.myValueTexts[e]=this.myValuePanels[e].pp_addObject(),this.myValueCursorTargets[e]=this.myValuePanels[e].pp_addObject(),this.myValueIncreaseButtonPanels[e]=this.myValuePanels[e].pp_addObject(),this.myValueIncreaseButtonBackgrounds[e]=this.myValueIncreaseButtonPanels[e].pp_addObject(),this.myValueIncreaseButtonTexts[e]=this.myValueIncreaseButtonPanels[e].pp_addObject(),this.myValueIncreaseButtonCursorTargets[e]=this.myValueIncreaseButtonPanels[e].pp_addObject(),this.myValueDecreaseButtonPanels[e]=this.myValuePanels[e].pp_addObject(),this.myValueDecreaseButtonBackgrounds[e]=this.myValueDecreaseButtonPanels[e].pp_addObject(),this.myValueDecreaseButtonTexts[e]=this.myValueDecreaseButtonPanels[e].pp_addObject(),this.myValueDecreaseButtonCursorTargets[e]=this.myValueDecreaseButtonPanels[e].pp_addObject()}_setTransformHook(){this.myValuesPanel.pp_setPositionLocal(this._myConfig.myValuesPanelPosition);for(let e=0;e<this._myConfig.myArraySize;e++)this.myValuePanels[e].pp_setPositionLocal(this._myConfig.myValuePanelsPositions[e]),this.myValueTexts[e].pp_scaleObject(this._myConfig.myValueTextScale),this.myValueCursorTargets[e].pp_setPositionLocal(this._myConfig.myValueCursorTargetPosition),this.myValueIncreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myRightSideButtonPosition),this.myValueIncreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myValueIncreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myValueIncreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myValueIncreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myValueDecreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myLeftSideButtonPosition),this.myValueDecreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myValueDecreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myValueDecreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myValueDecreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition)}_addComponentsHook(){this.myValueTextComponents=[],this.myValueCursorTargetComponents=[],this.myValueCollisionComponents=[],this.myValueIncreaseButtonBackgroundComponents=[],this.myValueIncreaseButtonTextComponents=[],this.myValueIncreaseButtonCursorTargetComponents=[],this.myValueIncreaseButtonCollisionComponents=[],this.myValueDecreaseButtonBackgroundComponents=[],this.myValueDecreaseButtonTextComponents=[],this.myValueDecreaseButtonCursorTargetComponents=[],this.myValueDecreaseButtonCollisionComponents=[];for(let e=0;e<this._myConfig.myArraySize;e++)this.myValueTextComponents[e]=this.myValueTexts[e].pp_addComponent(cm),this._setupTextComponent(this.myValueTextComponents[e]),this.myValueTextComponents[e].text=" ",this.myValueCursorTargetComponents[e]=this.myValueCursorTargets[e].pp_addComponent(pm),this.myValueCollisionComponents[e]=this.myValueCursorTargets[e].pp_addComponent(hm),this.myValueCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myValueCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myValueCollisionComponents[e].extents=this._myConfig.myValueCollisionExtents,this.myValueIncreaseButtonBackgroundComponents[e]=this.myValueIncreaseButtonBackgrounds[e].pp_addComponent(Nb),this.myValueIncreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myValueIncreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myValueIncreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myValueIncreaseButtonTextComponents[e]=this.myValueIncreaseButtonTexts[e].pp_addComponent(cm),this._setupTextComponent(this.myValueIncreaseButtonTextComponents[e]),this.myValueIncreaseButtonTextComponents[e].text=this._myConfig.myIncreaseButtonText,this.myValueIncreaseButtonCursorTargetComponents[e]=this.myValueIncreaseButtonCursorTargets[e].pp_addComponent(pm),this.myValueIncreaseButtonCollisionComponents[e]=this.myValueIncreaseButtonCursorTargets[e].pp_addComponent(hm),this.myValueIncreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myValueIncreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myValueIncreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents,this.myValueDecreaseButtonBackgroundComponents[e]=this.myValueDecreaseButtonBackgrounds[e].pp_addComponent(Nb),this.myValueDecreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myValueDecreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myValueDecreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myValueDecreaseButtonTextComponents[e]=this.myValueDecreaseButtonTexts[e].pp_addComponent(cm),this._setupTextComponent(this.myValueDecreaseButtonTextComponents[e]),this.myValueDecreaseButtonTextComponents[e].text=this._myConfig.myDecreaseButtonText,this.myValueDecreaseButtonCursorTargetComponents[e]=this.myValueDecreaseButtonCursorTargets[e].pp_addComponent(pm),this.myValueDecreaseButtonCollisionComponents[e]=this.myValueDecreaseButtonCursorTargets[e].pp_addComponent(hm),this.myValueDecreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myValueDecreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myValueDecreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents}_setVisibleHook(e){e&&this.setAdditionalButtonsVisible(this._myAdditionalButtonsVisible)}};var Ma=class extends kt{constructor(e,t,n,o=m.getMainEngine()){super(e),this._myNonArray=t==null,this._myArraySize=this._myNonArray?1:t,this._myConfig=new Ca(this._myArraySize),this._myUI=new xa(o),this._myGamepad=n,this._myValueEditIndex=0,this._myValueButtonEditIntensity=0,this._myValueButtonEditIntensityTimer=0,this._myValueEditEnabled=!1,this._myTempValue=[],this._myTempNonArrayValue=[0],this._myTempNonArrayDefaultValue=[0]}_refreshUIHook(){for(let e=0;e<this._myArraySize;e++)this._myUI.myValueTextComponents[e].text=this._getVariableValue()[e]?"true":"false"}_startHook(e,t){this._myUI.setAdditionalButtonsVisible(t.myShowAdditionalButtons)}_setEasyTuneVariableHook(){this._myVariable!=null&&this._myTempValue.pp_copy(this._getVariableValue())}_updateHook(e){this._updateValue(e)}_updateValue(e){let t=0;this._myGamepad&&(t=this._myGamepad.getAxesInfo(ne.THUMBSTICK).myAxes[1]);let n=0;this._myValueEditEnabled?n=t:this._myValueButtonEditIntensity!=0&&(this._myValueButtonEditIntensityTimer<=0?n=this._myValueButtonEditIntensity:this._myValueButtonEditIntensityTimer-=e),this._myValueEditIndex>=0&&this._myValueEditIndex<this._getVariableValue().length&&Math.abs(n)>this._myConfig.myThumbstickToggleThreshold&&(this._myTempValue.pp_copy(this._getVariableValue()),this._myTempValue[this._myValueEditIndex]=n>0,this._setVariableValue(this._myTempValue),this._refreshUI())}_addListenersHook(){let e=this._myUI;e.myVariableLabelCursorTargetComponent.onClick.add(this._resetAllValues.bind(this)),e.myVariableLabelCursorTargetComponent.onHover.add(this._genericTextHover.bind(this,e.myVariableLabelText)),e.myVariableLabelCursorTargetComponent.onUnhover.add(this._genericTextUnhover.bind(this,e.myVariableLabelText,this._myConfig.myVariableLabelTextScale));for(let t=0;t<this._myArraySize;t++)e.myValueIncreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,t,1)),e.myValueIncreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,t,1)),e.myValueIncreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,t,0)),e.myValueIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,t,0)),e.myValueDecreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,t,-1)),e.myValueDecreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,t,-1)),e.myValueDecreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,t,0)),e.myValueDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,t,0)),e.myValueIncreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myValueIncreaseButtonBackgroundComponents[t].material)),e.myValueIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnhover.bind(this,e.myValueIncreaseButtonBackgroundComponents[t].material)),e.myValueDecreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myValueDecreaseButtonBackgroundComponents[t].material)),e.myValueDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnhover.bind(this,e.myValueDecreaseButtonBackgroundComponents[t].material)),e.myValueCursorTargetComponents[t].onClick.add(this._resetValue.bind(this,t)),e.myValueCursorTargetComponents[t].onHover.add(this._setValueEditEnabled.bind(this,t,e.myValueTexts[t],!0)),e.myValueCursorTargetComponents[t].onUnhover.add(this._setValueEditEnabled.bind(this,t,e.myValueTexts[t],!1))}_setValueEditIntensity(e,t){(this._isActive()||t==0)&&(t!=0&&(this._myValueButtonEditIntensityTimer=this._myConfig.myButtonEditDelay,this._myValueEditIndex=e),this._myValueButtonEditIntensity=t)}_setValueEditEnabled(e,t,n){(this._isActive()||!n)&&(n?(this._myValueEditIndex=e,t.pp_scaleObject(this._myConfig.myTextHoverScaleMultiplier)):t.pp_setScaleLocal(this._myConfig.myValueTextScale),this._myValueEditEnabled=n)}_resetValue(e){this._isActive()&&(this._myTempValue.pp_copy(this._getVariableValue()),this._myTempValue[e]=this._getVariableDefaultValue()[e],this._setVariableValue(this._myTempValue),this._myUI.myValueTextComponents[e].text=this._getVariableValue()[e]?"true":"false")}_resetAllValues(){for(let e=0;e<this._myArraySize;e++)this._resetValue(e)}_genericTextHover(e){e.pp_scaleObject(this._myConfig.myTextHoverScaleMultiplier)}_genericTextUnhover(e,t){e.pp_setScaleLocal(t)}_getVariableValue(){return this._myNonArray?(this._myTempNonArrayValue[0]=this._myVariable.getValue(),this._myTempNonArrayValue):this._myVariable.getValue()}_getVariableDefaultValue(){return this._myNonArray?(this._myTempNonArrayDefaultValue[0]=this._myVariable.getDefaultValue(),this._myTempNonArrayDefaultValue):this._myVariable.getDefaultValue()}_setVariableValue(e){this._myNonArray?this._myVariable.setValue(e[0]):this._myVariable.setValue(this._myTempValue)}};var Da=class extends pn{_getEasyTuneArrayWidget(e){return new Ma(this._myParams,e,this._myGamepad,this._myEngine)}};var Ea=class{constructor(){this._setupRuntimeConfig()}_setupRuntimeConfig(){this.myGamepadHandedness=W.RIGHT,this.myScrollVariableDelay=.5,this.myScrollVariableMinXThreshold=.6,this.myScrollVariableMaxYThreshold=.25,this.myScrollVariableButtonID=null,this.myRefreshVariablesDelay=null}};var Aa=class extends Ft{_getBackPanelMinY(){return super._getBackPanelMinY()+this.myTypeNotSupportedPanelPosition[1]}_getPivotZOffset(){return .00804713}_setupBuildConfigHook(){this.myTypeNotSupportedPanelPosition=p(0,-.03,this._myPanelZOffset),this.myTypeNotSupportedTextScale=p(.275,.275,.275),this.myTypeNotSupportedText="Type Not Supported"}};import{TextComponent as xV}from"@wonderlandengine/api";var Ra=class extends wt{constructor(e){super(e)}_createSkeletonHook(){this.myTypeNotSupportedPanel=this.myDisplayPanel.pp_addObject(),this.myTypeNotSupportedText=this.myTypeNotSupportedPanel.pp_addObject(),this.myTypeNotSupportedCursorTarget=this.myTypeNotSupportedPanel.pp_addObject()}_setTransformHook(){this.myTypeNotSupportedPanel.pp_setPositionLocal(this._myConfig.myTypeNotSupportedPanelPosition),this.myTypeNotSupportedText.pp_scaleObject(this._myConfig.myTypeNotSupportedTextScale)}_addComponentsHook(){this.myTypeNotSupportedTextComponent=this.myTypeNotSupportedText.pp_addComponent(xV),this._setupTextComponent(this.myTypeNotSupportedTextComponent),this.myTypeNotSupportedTextComponent.text=this._myConfig.myTypeNotSupportedText}};var Va=class extends kt{constructor(e,t=m.getMainEngine()){super(e),this._myConfig=new Aa,this._myUI=new Ra(t)}};var Oa=class extends Ft{constructor(e){super(),this.myArraySize=e}_getBackPanelMinY(){return this.myStepPanelPosition[1]-this._mySideButtonDistanceFromBorder*1.25-this.mySideButtonBackgroundScale[1]}_getPivotZOffset(){return .00803713}_setupBuildConfigHook(){this.myIncreaseButtonText="+",this.myDecreaseButtonText="-",this._myValuePanelDistanceFromVariableLabelPanel=.055,this._myDistanceBetweenValues=this.mySideButtonBackgroundScale[1]*2+.015,this.myValuesPanelPosition=[0,this.myVariableLabelPanelPosition[1]-this._myValuePanelDistanceFromVariableLabelPanel,this._myPanelZOffset],this.myValueTextScale=p(.4,.4,.4),this.myValueCursorTargetPosition=p(0,0,0),this.myValueCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myValueCollisionExtents=p(.065,.02,1),this.myValueCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myValuePanelsPositions=[],this.myValuePanelsPositions[0]=p(0,0,0);for(let t=1;t<this.myArraySize;t++)this.myValuePanelsPositions[t]=this.myValuePanelsPositions[t-1].pp_clone(),this.myValuePanelsPositions[t][1]-=this._myDistanceBetweenValues;let e=this.myValuePanelsPositions[this.myArraySize-1]?this.myValuePanelsPositions[this.myArraySize-1][1]:0;this.myStepPanelPosition=[0,this.myDisplayPanelPosition[1]+this.myValuesPanelPosition[1]+e-this._myValuePanelDistanceFromVariableLabelPanel,this._myPanelZOffset],this.myStepTextScale=this.myLabelTextScale,this.myStepStartString="Step: ",this.myStepCursorTargetPosition=p(0,0,0),this.myStepCursorTargetPosition[2]=this._myColliderZOffset-this.myStepPanelPosition[2],this.myStepCollisionExtents=p(.065,.0175,1),this.myStepCollisionExtents[2]=this.myCursorTargetCollisionThickness}_setupRuntimeConfigHook(){this.myTextHoverScaleMultiplier=p(1.1,1.1,1.1),this.myEditThumbstickMinThreshold=.35,this.myStepMultiplierStepPerSecond=2.25,this.myButtonEditDelay=0}};import{CollisionComponent as mo,MeshComponent as Xr,TextComponent as yo}from"@wonderlandengine/api";import{CursorTarget as uo}from"@wonderlandengine/components";var Ia=class extends wt{constructor(e){super(e)}setAdditionalButtonsVisible(e){this._myAdditionalButtonsVisible=e;for(let t=0;t<this._myConfig.myArraySize;t++)this.myValueIncreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible),this.myValueDecreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible);this.myStepIncreaseButtonPanel.pp_setActive(this._myAdditionalButtonsVisible),this.myStepDecreaseButtonPanel.pp_setActive(this._myAdditionalButtonsVisible)}_buildHook(){this._myAdditionalButtonsVisible=!0}_createSkeletonHook(){this.myValuesPanel=this.myDisplayPanel.pp_addObject(),this.myValuePanels=[],this.myValueTexts=[],this.myValueCursorTargets=[],this.myValueIncreaseButtonPanels=[],this.myValueIncreaseButtonBackgrounds=[],this.myValueIncreaseButtonTexts=[],this.myValueIncreaseButtonCursorTargets=[],this.myValueDecreaseButtonPanels=[],this.myValueDecreaseButtonBackgrounds=[],this.myValueDecreaseButtonTexts=[],this.myValueDecreaseButtonCursorTargets=[];for(let e=0;e<this._myConfig.myArraySize;e++)this.myValuePanels[e]=this.myValuesPanel.pp_addObject(),this.myValueTexts[e]=this.myValuePanels[e].pp_addObject(),this.myValueCursorTargets[e]=this.myValuePanels[e].pp_addObject(),this.myValueIncreaseButtonPanels[e]=this.myValuePanels[e].pp_addObject(),this.myValueIncreaseButtonBackgrounds[e]=this.myValueIncreaseButtonPanels[e].pp_addObject(),this.myValueIncreaseButtonTexts[e]=this.myValueIncreaseButtonPanels[e].pp_addObject(),this.myValueIncreaseButtonCursorTargets[e]=this.myValueIncreaseButtonPanels[e].pp_addObject(),this.myValueDecreaseButtonPanels[e]=this.myValuePanels[e].pp_addObject(),this.myValueDecreaseButtonBackgrounds[e]=this.myValueDecreaseButtonPanels[e].pp_addObject(),this.myValueDecreaseButtonTexts[e]=this.myValueDecreaseButtonPanels[e].pp_addObject(),this.myValueDecreaseButtonCursorTargets[e]=this.myValueDecreaseButtonPanels[e].pp_addObject();this.myStepPanel=this.myPivotObject.pp_addObject(),this.myStepText=this.myStepPanel.pp_addObject(),this.myStepCursorTarget=this.myStepPanel.pp_addObject(),this.myStepIncreaseButtonPanel=this.myStepPanel.pp_addObject(),this.myStepIncreaseButtonBackground=this.myStepIncreaseButtonPanel.pp_addObject(),this.myStepIncreaseButtonText=this.myStepIncreaseButtonPanel.pp_addObject(),this.myStepIncreaseButtonCursorTarget=this.myStepIncreaseButtonPanel.pp_addObject(),this.myStepDecreaseButtonPanel=this.myStepPanel.pp_addObject(),this.myStepDecreaseButtonBackground=this.myStepDecreaseButtonPanel.pp_addObject(),this.myStepDecreaseButtonText=this.myStepDecreaseButtonPanel.pp_addObject(),this.myStepDecreaseButtonCursorTarget=this.myStepDecreaseButtonPanel.pp_addObject()}_setTransformHook(){this.myValuesPanel.pp_setPositionLocal(this._myConfig.myValuesPanelPosition);for(let e=0;e<this._myConfig.myArraySize;e++)this.myValuePanels[e].pp_setPositionLocal(this._myConfig.myValuePanelsPositions[e]),this.myValueTexts[e].pp_scaleObject(this._myConfig.myValueTextScale),this.myValueCursorTargets[e].pp_setPositionLocal(this._myConfig.myValueCursorTargetPosition),this.myValueIncreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myRightSideButtonPosition),this.myValueIncreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myValueIncreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myValueIncreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myValueIncreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myValueDecreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myLeftSideButtonPosition),this.myValueDecreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myValueDecreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myValueDecreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myValueDecreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition);this.myStepPanel.pp_setPositionLocal(this._myConfig.myStepPanelPosition),this.myStepText.pp_scaleObject(this._myConfig.myStepTextScale),this.myStepCursorTarget.pp_setPositionLocal(this._myConfig.myStepCursorTargetPosition),this.myStepIncreaseButtonPanel.pp_setPositionLocal(this._myConfig.myRightSideButtonPosition),this.myStepIncreaseButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myStepIncreaseButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myStepIncreaseButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myStepIncreaseButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myStepDecreaseButtonPanel.pp_setPositionLocal(this._myConfig.myLeftSideButtonPosition),this.myStepDecreaseButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myStepDecreaseButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myStepDecreaseButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myStepDecreaseButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition)}_addComponentsHook(){this.myValueTextComponents=[],this.myValueCursorTargetComponents=[],this.myValueCollisionComponents=[],this.myValueIncreaseButtonBackgroundComponents=[],this.myValueIncreaseButtonTextComponents=[],this.myValueIncreaseButtonCursorTargetComponents=[],this.myValueIncreaseButtonCollisionComponents=[],this.myValueDecreaseButtonBackgroundComponents=[],this.myValueDecreaseButtonTextComponents=[],this.myValueDecreaseButtonCursorTargetComponents=[],this.myValueDecreaseButtonCollisionComponents=[];for(let e=0;e<this._myConfig.myArraySize;e++)this.myValueTextComponents[e]=this.myValueTexts[e].pp_addComponent(yo),this._setupTextComponent(this.myValueTextComponents[e]),this.myValueTextComponents[e].text=" ",this.myValueCursorTargetComponents[e]=this.myValueCursorTargets[e].pp_addComponent(uo),this.myValueCollisionComponents[e]=this.myValueCursorTargets[e].pp_addComponent(mo),this.myValueCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myValueCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myValueCollisionComponents[e].extents=this._myConfig.myValueCollisionExtents,this.myValueIncreaseButtonBackgroundComponents[e]=this.myValueIncreaseButtonBackgrounds[e].pp_addComponent(Xr),this.myValueIncreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myValueIncreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myValueIncreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myValueIncreaseButtonTextComponents[e]=this.myValueIncreaseButtonTexts[e].pp_addComponent(yo),this._setupTextComponent(this.myValueIncreaseButtonTextComponents[e]),this.myValueIncreaseButtonTextComponents[e].text=this._myConfig.myIncreaseButtonText,this.myValueIncreaseButtonCursorTargetComponents[e]=this.myValueIncreaseButtonCursorTargets[e].pp_addComponent(uo),this.myValueIncreaseButtonCollisionComponents[e]=this.myValueIncreaseButtonCursorTargets[e].pp_addComponent(mo),this.myValueIncreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myValueIncreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myValueIncreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents,this.myValueDecreaseButtonBackgroundComponents[e]=this.myValueDecreaseButtonBackgrounds[e].pp_addComponent(Xr),this.myValueDecreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myValueDecreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myValueDecreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myValueDecreaseButtonTextComponents[e]=this.myValueDecreaseButtonTexts[e].pp_addComponent(yo),this._setupTextComponent(this.myValueDecreaseButtonTextComponents[e]),this.myValueDecreaseButtonTextComponents[e].text=this._myConfig.myDecreaseButtonText,this.myValueDecreaseButtonCursorTargetComponents[e]=this.myValueDecreaseButtonCursorTargets[e].pp_addComponent(uo),this.myValueDecreaseButtonCollisionComponents[e]=this.myValueDecreaseButtonCursorTargets[e].pp_addComponent(mo),this.myValueDecreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myValueDecreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myValueDecreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents;this.myStepTextComponent=this.myStepText.pp_addComponent(yo),this._setupTextComponent(this.myStepTextComponent),this.myStepTextComponent.text=" ",this.myStepCursorTargetComponent=this.myStepCursorTarget.pp_addComponent(uo),this.myStepCollisionComponent=this.myStepCursorTarget.pp_addComponent(mo),this.myStepCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myStepCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myStepCollisionComponent.extents=this._myConfig.myStepCollisionExtents,this.myStepIncreaseButtonBackgroundComponent=this.myStepIncreaseButtonBackground.pp_addComponent(Xr),this.myStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myStepIncreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myStepIncreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myStepIncreaseButtonTextComponent=this.myStepIncreaseButtonText.pp_addComponent(yo),this._setupTextComponent(this.myStepIncreaseButtonTextComponent),this.myStepIncreaseButtonTextComponent.text=this._myConfig.myIncreaseButtonText,this.myStepIncreaseButtonCursorTargetComponent=this.myStepIncreaseButtonCursorTarget.pp_addComponent(uo),this.myStepIncreaseButtonCollisionComponent=this.myStepIncreaseButtonCursorTarget.pp_addComponent(mo),this.myStepIncreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myStepIncreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myStepIncreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myStepDecreaseButtonBackgroundComponent=this.myStepDecreaseButtonBackground.pp_addComponent(Xr),this.myStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myStepDecreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myStepDecreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myStepDecreaseButtonTextComponent=this.myStepDecreaseButtonText.pp_addComponent(yo),this._setupTextComponent(this.myStepDecreaseButtonTextComponent),this.myStepDecreaseButtonTextComponent.text=this._myConfig.myDecreaseButtonText,this.myStepDecreaseButtonCursorTargetComponent=this.myStepDecreaseButtonCursorTarget.pp_addComponent(uo),this.myStepDecreaseButtonCollisionComponent=this.myStepDecreaseButtonCursorTarget.pp_addComponent(mo),this.myStepDecreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myStepDecreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myStepDecreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents}_setVisibleHook(e){e&&this.setAdditionalButtonsVisible(this._myAdditionalButtonsVisible)}};var Ba=class extends kt{constructor(e,t,n,o=m.getMainEngine()){super(e),this._myGamepad=n,this._myNonArray=t==null,this._myArraySize=this._myNonArray?1:t,this._myConfig=new Oa(this._myArraySize),this._myUI=new Ia(o),this._myValueEditIndex=-1,this._myValueButtonEditIntensity=0,this._myValueButtonEditIntensityTimer=0,this._myStepButtonEditIntensity=0,this._myStepButtonEditIntensityTimer=0,this._myValueEditEnabled=!1,this._myStepEditEnabled=!1,this._myValueRealValue=0,this._myStepMultiplierValue=0,this._myStepFastEdit=!1,this._myTempValue=[],this._myTempNonArrayValue=[0],this._myTempNonArrayDefaultValue=[0]}_refreshUIHook(){for(let e=0;e<this._myArraySize;e++)this._myUI.myValueTextComponents[e].text=this._getVariableValue()[e].toFixed(this._myVariable._myDecimalPlaces);this._myUI.myStepTextComponent.text=this._myConfig.myStepStartString.concat(this._myVariable._myStepPerSecond)}_startHook(e,t){this._myUI.setAdditionalButtonsVisible(t.myShowAdditionalButtons)}_setEasyTuneVariableHook(){this._myVariable!=null&&this._myTempValue.pp_copy(this._getVariableValue())}_updateHook(e){this._updateValue(e)}_updateValue(e){let t=0;if(this._myGamepad){let s=this._myGamepad.getAxesInfo(ne.THUMBSTICK).myAxes[1];if(Math.abs(s)>this._myConfig.myEditThumbstickMinThreshold){let a=(Math.abs(s)-this._myConfig.myEditThumbstickMinThreshold)/(1-this._myConfig.myEditThumbstickMinThreshold);t=Math.sign(s)*a}}let n=0;if(this._myValueEditEnabled?n=t:this._myValueButtonEditIntensity!=0&&(this._myValueButtonEditIntensityTimer<=0?n=this._myValueButtonEditIntensity:this._myValueButtonEditIntensityTimer-=e),this._myValueEditIndex>=0&&this._myValueEditIndex<this._getVariableValue().length)if(n!=0){let s=n*this._myVariable._myStepPerSecond*e;this._myValueRealValue+=s,this._myVariable._myMin!=null&&this._myVariable._myMax!=null?this._myValueRealValue=Math.pp_clamp(this._myValueRealValue,this._myVariable._myMin,this._myVariable._myMax):this._myVariable._myMin!=null?this._myValueRealValue=Math.max(this._myValueRealValue,this._myVariable._myMin):this._myVariable._myMax!=null&&(this._myValueRealValue=Math.min(this._myValueRealValue,this._myVariable._myMax));let a=Math.pow(10,this._myVariable._myDecimalPlaces);if(this._myTempValue.pp_copy(this._getVariableValue()),this._myVariable._myEditAllValuesTogether){let h=Math.round(this._myValueRealValue*a+Number.EPSILON)/a-this._myTempValue[this._myValueEditIndex];for(let _=0;_<this._myArraySize;_++)this._myTempValue[_]=Math.round((this._myTempValue[_]+h)*a+Number.EPSILON)/a,this._myVariable._myMin!=null&&this._myVariable._myMax!=null?this._myTempValue[_]=Math.pp_clamp(this._myTempValue[_],this._myVariable._myMin,this._myVariable._myMax):this._myVariable._myMin!=null?this._myTempValue[_]=Math.max(this._myTempValue[_],this._myVariable._myMin):this._myVariable._myMax!=null&&(this._myTempValue[_]=Math.min(this._myTempValue[_],this._myVariable._myMax)),this._myUI.myValueTextComponents[_].text=this._myTempValue[_].toFixed(this._myVariable._myDecimalPlaces)}else this._myTempValue[this._myValueEditIndex]=Math.round(this._myValueRealValue*a+Number.EPSILON)/a,this._myVariable._myMin!=null&&this._myVariable._myMax!=null?this._myTempValue[this._myValueEditIndex]=Math.pp_clamp(this._myTempValue[this._myValueEditIndex],this._myVariable._myMin,this._myVariable._myMax):this._myVariable._myMin!=null?this._myTempValue[this._myValueEditIndex]=Math.max(this._myTempValue[this._myValueEditIndex],this._myVariable._myMin):this._myVariable._myMax!=null&&(this._myTempValue[this._myValueEditIndex]=Math.min(this._myTempValue[this._myValueEditIndex],this._myVariable._myMax)),this._myUI.myValueTextComponents[this._myValueEditIndex].text=this._myTempValue[this._myValueEditIndex].toFixed(this._myVariable._myDecimalPlaces);this._setVariableValue(this._myTempValue)}else this._myValueRealValue=this._getVariableValue()[this._myValueEditIndex];let o=0;if(this._myStepEditEnabled?o=t:this._myStepButtonEditIntensity!=0&&(this._myStepButtonEditIntensityTimer<=0?o=this._myStepButtonEditIntensity:this._myStepButtonEditIntensityTimer-=e),o!=0){let s=0;this._myStepFastEdit?(s=Math.sign(o)*1,this._myStepFastEdit=!1):s=o*this._myConfig.myStepMultiplierStepPerSecond*e,this._myStepMultiplierValue+=s,Math.abs(this._myStepMultiplierValue)>=1&&(Math.sign(this._myStepMultiplierValue)>0?(this._myStepMultiplierValue-=1,this._changeStep(this._myVariable._myStepPerSecond*10)):(this._myStepMultiplierValue+=1,this._changeStep(this._myVariable._myStepPerSecond*.1)))}else this._myStepMultiplierValue=0,this._myStepFastEdit=!0}_addListenersHook(){let e=this._myUI;e.myVariableLabelCursorTargetComponent.onClick.add(this._resetAllValues.bind(this)),e.myVariableLabelCursorTargetComponent.onHover.add(this._genericTextHover.bind(this,e.myVariableLabelText)),e.myVariableLabelCursorTargetComponent.onUnhover.add(this._genericTextUnhover.bind(this,e.myVariableLabelText,this._myConfig.myVariableLabelTextScale));for(let t=0;t<this._myArraySize;t++)e.myValueIncreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,t,1)),e.myValueIncreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,t,1)),e.myValueIncreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,t,0)),e.myValueIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,t,0)),e.myValueDecreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,t,-1)),e.myValueDecreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,t,-1)),e.myValueDecreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,t,0)),e.myValueDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,t,0)),e.myValueIncreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myValueIncreaseButtonBackgroundComponents[t].material)),e.myValueIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnhover.bind(this,e.myValueIncreaseButtonBackgroundComponents[t].material)),e.myValueDecreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myValueDecreaseButtonBackgroundComponents[t].material)),e.myValueDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnhover.bind(this,e.myValueDecreaseButtonBackgroundComponents[t].material)),e.myValueCursorTargetComponents[t].onClick.add(this._resetValue.bind(this,t)),e.myValueCursorTargetComponents[t].onHover.add(this._setValueEditEnabled.bind(this,t,e.myValueTexts[t],!0)),e.myValueCursorTargetComponents[t].onUnhover.add(this._setValueEditEnabled.bind(this,t,e.myValueTexts[t],!1));e.myStepCursorTargetComponent.onClick.add(this._resetStep.bind(this)),e.myStepCursorTargetComponent.onHover.add(this._setStepEditEnabled.bind(this,e.myStepText,!0)),e.myStepCursorTargetComponent.onUnhover.add(this._setStepEditEnabled.bind(this,e.myStepText,!1)),e.myStepIncreaseButtonCursorTargetComponent.onDown.add(this._setStepEditIntensity.bind(this,1)),e.myStepIncreaseButtonCursorTargetComponent.onDownOnHover.add(this._setStepEditIntensity.bind(this,1)),e.myStepIncreaseButtonCursorTargetComponent.onUp.add(this._setStepEditIntensity.bind(this,0)),e.myStepIncreaseButtonCursorTargetComponent.onUnhover.add(this._setStepEditIntensity.bind(this,0)),e.myStepDecreaseButtonCursorTargetComponent.onDown.add(this._setStepEditIntensity.bind(this,-1)),e.myStepDecreaseButtonCursorTargetComponent.onDownOnHover.add(this._setStepEditIntensity.bind(this,-1)),e.myStepDecreaseButtonCursorTargetComponent.onUp.add(this._setStepEditIntensity.bind(this,0)),e.myStepDecreaseButtonCursorTargetComponent.onUnhover.add(this._setStepEditIntensity.bind(this,0)),e.myStepIncreaseButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myStepIncreaseButtonBackgroundComponent.material)),e.myStepIncreaseButtonCursorTargetComponent.onUnhover.add(this._genericUnhover.bind(this,e.myStepIncreaseButtonBackgroundComponent.material)),e.myStepDecreaseButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myStepDecreaseButtonBackgroundComponent.material)),e.myStepDecreaseButtonCursorTargetComponent.onUnhover.add(this._genericUnhover.bind(this,e.myStepDecreaseButtonBackgroundComponent.material))}_setValueEditIntensity(e,t){(this._isActive()||t==0)&&(t!=0&&(this._myValueButtonEditIntensityTimer=this._myConfig.myButtonEditDelay,this._myValueRealValue=this._getVariableValue()[e],this._myValueEditIndex=e),this._myValueButtonEditIntensity=t)}_setStepEditIntensity(e){(this._isActive()||e==0)&&(e!=0&&(this._myStepButtonEditIntensityTimer=this._myConfig.myButtonEditDelay),this._myStepButtonEditIntensity=e)}_setValueEditEnabled(e,t,n){(this._isActive()||!n)&&(n?(this._myValueRealValue=this._getVariableValue()[e],this._myValueEditIndex=e,t.pp_scaleObject(this._myConfig.myTextHoverScaleMultiplier)):t.pp_setScaleLocal(this._myConfig.myValueTextScale),this._myValueEditEnabled=n)}_setStepEditEnabled(e,t){(this._isActive()||!t)&&(t?e.pp_scaleObject(this._myConfig.myTextHoverScaleMultiplier):e.pp_setScaleLocal(this._myConfig.myStepTextScale),this._myStepEditEnabled=t)}_resetValue(e){this._isActive()&&(this._myTempValue.pp_copy(this._getVariableValue()),this._myTempValue[e]=this._getVariableDefaultValue()[e],this._setVariableValue(this._myTempValue),this._myUI.myValueTextComponents[e].text=this._getVariableValue()[e].toFixed(this._myVariable._myDecimalPlaces))}_resetAllValues(){for(let e=0;e<this._myArraySize;e++)this._resetValue(e)}_resetStep(){this._isActive()&&this._changeStep(this._myVariable._myDefaultStepPerSecond)}_changeStep(e){e=Math.pp_roundDecimal(e,10),this._myVariable._myStepPerSecond=e,this._myUI.myStepTextComponent.text=this._myConfig.myStepStartString.concat(this._myVariable._myStepPerSecond)}_genericTextHover(e){e.pp_scaleObject(this._myConfig.myTextHoverScaleMultiplier)}_genericTextUnhover(e,t){e.pp_setScaleLocal(t)}_getVariableValue(){return this._myNonArray?(this._myTempNonArrayValue[0]=this._myVariable.getValue(),this._myTempNonArrayValue):this._myVariable.getValue()}_getVariableDefaultValue(){return this._myNonArray?(this._myTempNonArrayDefaultValue[0]=this._myVariable.getDefaultValue(),this._myTempNonArrayDefaultValue):this._myVariable.getDefaultValue()}_setVariableValue(e){this._myNonArray?this._myVariable.setValue(e[0]):this._myVariable.setValue(this._myTempValue)}};var La=class extends pn{_getEasyTuneArrayWidget(e){return new Ba(this._myParams,e,this._myGamepad,this._myEngine)}};var Ha=class extends Ft{_getBackPanelMinY(){return super._getBackPanelMinY()+this.myPositionPanelPosition[1]+this.myStepPanelPosition[1]}_getBackPanelMaxX(){return this.myDisplayPanelPosition[0]+this.myRotationPanelPosition[0]+this.myIncreaseButtonPosition[0]+this.mySideButtonBackgroundScale[0]+this._mySideButtonDistanceFromBorder}_getBackPanelMinX(){return this.myDisplayPanelPosition[0]+this.myScalePanelPosition[0]+this.myDecreaseButtonPosition[0]-this.mySideButtonBackgroundScale[0]-this._mySideButtonDistanceFromBorder}_getPivotZOffset(){return .00805713}_setupBuildConfigHook(){this.myIncreaseButtonText="+",this.myDecreaseButtonText="-",this.myDecreaseButtonPosition=p(-.13,0,-1e-5),this.myIncreaseButtonPosition=p(-this.myDecreaseButtonPosition[0],0,-1e-5);let e=Math.abs(this.myIncreaseButtonPosition[0])+Math.abs(this.myRightSideButtonPosition[0]),t=.045;this.myPositionPanelPosition=[0,this.myVariableLabelPanelPosition[1]-t,this._myPanelZOffset],this.myRotationPanelPosition=[this.myPositionPanelPosition[0]+e,this.myVariableLabelPanelPosition[1]-t,this._myPanelZOffset],this.myScalePanelPosition=[this.myPositionPanelPosition[0]-e,this.myVariableLabelPanelPosition[1]-t,this._myPanelZOffset],this.myPositionText="Position",this.myRotationText="Rotation",this.myScaleText="Scale",this.myComponentLabelTextScale=this.myLabelTextScale,this.myComponentLabelCursorTargetPosition=p(0,0,0),this.myComponentLabelCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myComponentLabelCollisionExtents=p(.065,.0175,1),this.myComponentLabelCollisionExtents[2]=this.myCursorTargetCollisionThickness,this._myValuePanelDistanceFromVariableLabelPanel=.055,this._myDistanceBetweenValues=this.mySideButtonBackgroundScale[1]*2+.015,this.myValueTextScale=p(.4,.4,.4),this.myValueCursorTargetPosition=p(0,0,0),this.myValueCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myValueCollisionExtents=p(.065,.02,1),this.myValueCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myValuePanelsPositions=[],this.myValuePanelsPositions[0]=p(0,-this._myValuePanelDistanceFromVariableLabelPanel,0);for(let o=1;o<3;o++)this.myValuePanelsPositions[o]=this.myValuePanelsPositions[o-1].pp_clone(),this.myValuePanelsPositions[o][1]-=this._myDistanceBetweenValues;let n=this.myValuePanelsPositions[2][1];this.myStepPanelPosition=[0,n-this._myValuePanelDistanceFromVariableLabelPanel,0],this.myStepTextScale=this.myLabelTextScale,this.myStepStartString="Step: ",this.myStepCursorTargetPosition=p(0,0,0),this.myStepCursorTargetPosition[2]=this._myColliderZOffset-this.myStepPanelPosition[2],this.myStepCollisionExtents=p(.065,.0175,1),this.myStepCollisionExtents[2]=this.myCursorTargetCollisionThickness}_setupRuntimeConfigHook(){this.myTextHoverScaleMultiplier=p(1.1,1.1,1.1),this.myEditThumbstickMinThreshold=.35,this.myStepMultiplierStepPerSecond=2.25,this.myButtonEditDelay=0}};import{CollisionComponent as _e,MeshComponent as Xe,TextComponent as ge}from"@wonderlandengine/api";import{CursorTarget as fe}from"@wonderlandengine/components";var ka=class extends wt{constructor(e){super(e)}setAdditionalButtonsVisible(e){this._myAdditionalButtonsVisible=e;for(let t=0;t<3;t++)this.myPositionIncreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible),this.myPositionDecreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible);this.myPositionStepIncreaseButtonPanel.pp_setActive(this._myAdditionalButtonsVisible),this.myPositionStepDecreaseButtonPanel.pp_setActive(this._myAdditionalButtonsVisible);for(let t=0;t<3;t++)this.myRotationIncreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible),this.myRotationDecreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible);this.myRotationStepIncreaseButtonPanel.pp_setActive(this._myAdditionalButtonsVisible),this.myRotationStepDecreaseButtonPanel.pp_setActive(this._myAdditionalButtonsVisible);for(let t=0;t<3;t++)this.myScaleIncreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible),this.myScaleDecreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible);this.myScaleStepIncreaseButtonPanel.pp_setActive(this._myAdditionalButtonsVisible),this.myScaleStepDecreaseButtonPanel.pp_setActive(this._myAdditionalButtonsVisible)}_buildHook(){this._myAdditionalButtonsVisible=!0}_createSkeletonHook(){this.myPositionPanel=this.myDisplayPanel.pp_addObject(),this.myPositionLabelText=this.myPositionPanel.pp_addObject(),this.myPositionLabelCursorTarget=this.myPositionPanel.pp_addObject(),this.myPositionPanels=[],this.myPositionTexts=[],this.myPositionCursorTargets=[],this.myPositionIncreaseButtonPanels=[],this.myPositionIncreaseButtonBackgrounds=[],this.myPositionIncreaseButtonTexts=[],this.myPositionIncreaseButtonCursorTargets=[],this.myPositionDecreaseButtonPanels=[],this.myPositionDecreaseButtonBackgrounds=[],this.myPositionDecreaseButtonTexts=[],this.myPositionDecreaseButtonCursorTargets=[];for(let e=0;e<3;e++)this.myPositionPanels[e]=this.myPositionPanel.pp_addObject(),this.myPositionTexts[e]=this.myPositionPanels[e].pp_addObject(),this.myPositionCursorTargets[e]=this.myPositionPanels[e].pp_addObject(),this.myPositionIncreaseButtonPanels[e]=this.myPositionPanels[e].pp_addObject(),this.myPositionIncreaseButtonBackgrounds[e]=this.myPositionIncreaseButtonPanels[e].pp_addObject(),this.myPositionIncreaseButtonTexts[e]=this.myPositionIncreaseButtonPanels[e].pp_addObject(),this.myPositionIncreaseButtonCursorTargets[e]=this.myPositionIncreaseButtonPanels[e].pp_addObject(),this.myPositionDecreaseButtonPanels[e]=this.myPositionPanels[e].pp_addObject(),this.myPositionDecreaseButtonBackgrounds[e]=this.myPositionDecreaseButtonPanels[e].pp_addObject(),this.myPositionDecreaseButtonTexts[e]=this.myPositionDecreaseButtonPanels[e].pp_addObject(),this.myPositionDecreaseButtonCursorTargets[e]=this.myPositionDecreaseButtonPanels[e].pp_addObject();this.myRotationPanel=this.myDisplayPanel.pp_addObject(),this.myRotationLabelText=this.myRotationPanel.pp_addObject(),this.myRotationLabelCursorTarget=this.myRotationPanel.pp_addObject(),this.myRotationPanels=[],this.myRotationTexts=[],this.myRotationCursorTargets=[],this.myRotationIncreaseButtonPanels=[],this.myRotationIncreaseButtonBackgrounds=[],this.myRotationIncreaseButtonTexts=[],this.myRotationIncreaseButtonCursorTargets=[],this.myRotationDecreaseButtonPanels=[],this.myRotationDecreaseButtonBackgrounds=[],this.myRotationDecreaseButtonTexts=[],this.myRotationDecreaseButtonCursorTargets=[];for(let e=0;e<3;e++)this.myRotationPanels[e]=this.myRotationPanel.pp_addObject(),this.myRotationTexts[e]=this.myRotationPanels[e].pp_addObject(),this.myRotationCursorTargets[e]=this.myRotationPanels[e].pp_addObject(),this.myRotationIncreaseButtonPanels[e]=this.myRotationPanels[e].pp_addObject(),this.myRotationIncreaseButtonBackgrounds[e]=this.myRotationIncreaseButtonPanels[e].pp_addObject(),this.myRotationIncreaseButtonTexts[e]=this.myRotationIncreaseButtonPanels[e].pp_addObject(),this.myRotationIncreaseButtonCursorTargets[e]=this.myRotationIncreaseButtonPanels[e].pp_addObject(),this.myRotationDecreaseButtonPanels[e]=this.myRotationPanels[e].pp_addObject(),this.myRotationDecreaseButtonBackgrounds[e]=this.myRotationDecreaseButtonPanels[e].pp_addObject(),this.myRotationDecreaseButtonTexts[e]=this.myRotationDecreaseButtonPanels[e].pp_addObject(),this.myRotationDecreaseButtonCursorTargets[e]=this.myRotationDecreaseButtonPanels[e].pp_addObject();this.myScalePanel=this.myDisplayPanel.pp_addObject(),this.myScaleLabelText=this.myScalePanel.pp_addObject(),this.myScaleLabelCursorTarget=this.myScalePanel.pp_addObject(),this.myScalePanels=[],this.myScaleTexts=[],this.myScaleCursorTargets=[],this.myScaleIncreaseButtonPanels=[],this.myScaleIncreaseButtonBackgrounds=[],this.myScaleIncreaseButtonTexts=[],this.myScaleIncreaseButtonCursorTargets=[],this.myScaleDecreaseButtonPanels=[],this.myScaleDecreaseButtonBackgrounds=[],this.myScaleDecreaseButtonTexts=[],this.myScaleDecreaseButtonCursorTargets=[];for(let e=0;e<3;e++)this.myScalePanels[e]=this.myScalePanel.pp_addObject(),this.myScaleTexts[e]=this.myScalePanels[e].pp_addObject(),this.myScaleCursorTargets[e]=this.myScalePanels[e].pp_addObject(),this.myScaleIncreaseButtonPanels[e]=this.myScalePanels[e].pp_addObject(),this.myScaleIncreaseButtonBackgrounds[e]=this.myScaleIncreaseButtonPanels[e].pp_addObject(),this.myScaleIncreaseButtonTexts[e]=this.myScaleIncreaseButtonPanels[e].pp_addObject(),this.myScaleIncreaseButtonCursorTargets[e]=this.myScaleIncreaseButtonPanels[e].pp_addObject(),this.myScaleDecreaseButtonPanels[e]=this.myScalePanels[e].pp_addObject(),this.myScaleDecreaseButtonBackgrounds[e]=this.myScaleDecreaseButtonPanels[e].pp_addObject(),this.myScaleDecreaseButtonTexts[e]=this.myScaleDecreaseButtonPanels[e].pp_addObject(),this.myScaleDecreaseButtonCursorTargets[e]=this.myScaleDecreaseButtonPanels[e].pp_addObject();this.myPositionStepPanel=this.myPositionPanel.pp_addObject(),this.myPositionStepText=this.myPositionStepPanel.pp_addObject(),this.myPositionStepCursorTarget=this.myPositionStepPanel.pp_addObject(),this.myPositionStepIncreaseButtonPanel=this.myPositionStepPanel.pp_addObject(),this.myPositionStepIncreaseButtonBackground=this.myPositionStepIncreaseButtonPanel.pp_addObject(),this.myPositionStepIncreaseButtonText=this.myPositionStepIncreaseButtonPanel.pp_addObject(),this.myPositionStepIncreaseButtonCursorTarget=this.myPositionStepIncreaseButtonPanel.pp_addObject(),this.myPositionStepDecreaseButtonPanel=this.myPositionStepPanel.pp_addObject(),this.myPositionStepDecreaseButtonBackground=this.myPositionStepDecreaseButtonPanel.pp_addObject(),this.myPositionStepDecreaseButtonText=this.myPositionStepDecreaseButtonPanel.pp_addObject(),this.myPositionStepDecreaseButtonCursorTarget=this.myPositionStepDecreaseButtonPanel.pp_addObject(),this.myRotationStepPanel=this.myRotationPanel.pp_addObject(),this.myRotationStepText=this.myRotationStepPanel.pp_addObject(),this.myRotationStepCursorTarget=this.myRotationStepPanel.pp_addObject(),this.myRotationStepIncreaseButtonPanel=this.myRotationStepPanel.pp_addObject(),this.myRotationStepIncreaseButtonBackground=this.myRotationStepIncreaseButtonPanel.pp_addObject(),this.myRotationStepIncreaseButtonText=this.myRotationStepIncreaseButtonPanel.pp_addObject(),this.myRotationStepIncreaseButtonCursorTarget=this.myRotationStepIncreaseButtonPanel.pp_addObject(),this.myRotationStepDecreaseButtonPanel=this.myRotationStepPanel.pp_addObject(),this.myRotationStepDecreaseButtonBackground=this.myRotationStepDecreaseButtonPanel.pp_addObject(),this.myRotationStepDecreaseButtonText=this.myRotationStepDecreaseButtonPanel.pp_addObject(),this.myRotationStepDecreaseButtonCursorTarget=this.myRotationStepDecreaseButtonPanel.pp_addObject(),this.myScaleStepPanel=this.myScalePanel.pp_addObject(),this.myScaleStepText=this.myScaleStepPanel.pp_addObject(),this.myScaleStepCursorTarget=this.myScaleStepPanel.pp_addObject(),this.myScaleStepIncreaseButtonPanel=this.myScaleStepPanel.pp_addObject(),this.myScaleStepIncreaseButtonBackground=this.myScaleStepIncreaseButtonPanel.pp_addObject(),this.myScaleStepIncreaseButtonText=this.myScaleStepIncreaseButtonPanel.pp_addObject(),this.myScaleStepIncreaseButtonCursorTarget=this.myScaleStepIncreaseButtonPanel.pp_addObject(),this.myScaleStepDecreaseButtonPanel=this.myScaleStepPanel.pp_addObject(),this.myScaleStepDecreaseButtonBackground=this.myScaleStepDecreaseButtonPanel.pp_addObject(),this.myScaleStepDecreaseButtonText=this.myScaleStepDecreaseButtonPanel.pp_addObject(),this.myScaleStepDecreaseButtonCursorTarget=this.myScaleStepDecreaseButtonPanel.pp_addObject()}_setTransformHook(){this.myPositionPanel.pp_setPositionLocal(this._myConfig.myPositionPanelPosition),this.myPositionLabelText.pp_scaleObject(this._myConfig.myComponentLabelTextScale),this.myPositionLabelCursorTarget.pp_setPositionLocal(this._myConfig.myComponentLabelCursorTargetPosition);for(let e=0;e<3;e++)this.myPositionPanels[e].pp_setPositionLocal(this._myConfig.myValuePanelsPositions[e]),this.myPositionTexts[e].pp_scaleObject(this._myConfig.myValueTextScale),this.myPositionCursorTargets[e].pp_setPositionLocal(this._myConfig.myValueCursorTargetPosition),this.myPositionIncreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myIncreaseButtonPosition),this.myPositionIncreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myPositionIncreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myPositionIncreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myPositionIncreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myPositionDecreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myDecreaseButtonPosition),this.myPositionDecreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myPositionDecreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myPositionDecreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myPositionDecreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition);this.myRotationPanel.pp_setPositionLocal(this._myConfig.myRotationPanelPosition),this.myRotationLabelText.pp_scaleObject(this._myConfig.myComponentLabelTextScale),this.myRotationLabelCursorTarget.pp_setPositionLocal(this._myConfig.myComponentLabelCursorTargetPosition);for(let e=0;e<3;e++)this.myRotationPanels[e].pp_setPositionLocal(this._myConfig.myValuePanelsPositions[e]),this.myRotationTexts[e].pp_scaleObject(this._myConfig.myValueTextScale),this.myRotationCursorTargets[e].pp_setPositionLocal(this._myConfig.myValueCursorTargetPosition),this.myRotationIncreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myIncreaseButtonPosition),this.myRotationIncreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myRotationIncreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myRotationIncreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myRotationIncreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myRotationDecreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myDecreaseButtonPosition),this.myRotationDecreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myRotationDecreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myRotationDecreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myRotationDecreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition);this.myScalePanel.pp_setPositionLocal(this._myConfig.myScalePanelPosition),this.myScaleLabelText.pp_scaleObject(this._myConfig.myComponentLabelTextScale),this.myScaleLabelCursorTarget.pp_setPositionLocal(this._myConfig.myComponentLabelCursorTargetPosition);for(let e=0;e<3;e++)this.myScalePanels[e].pp_setPositionLocal(this._myConfig.myValuePanelsPositions[e]),this.myScaleTexts[e].pp_scaleObject(this._myConfig.myValueTextScale),this.myScaleCursorTargets[e].pp_setPositionLocal(this._myConfig.myValueCursorTargetPosition),this.myScaleIncreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myIncreaseButtonPosition),this.myScaleIncreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myScaleIncreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myScaleIncreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myScaleIncreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myScaleDecreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myDecreaseButtonPosition),this.myScaleDecreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myScaleDecreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myScaleDecreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myScaleDecreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition);this.myPositionStepPanel.pp_setPositionLocal(this._myConfig.myStepPanelPosition),this.myPositionStepText.pp_scaleObject(this._myConfig.myStepTextScale),this.myPositionStepCursorTarget.pp_setPositionLocal(this._myConfig.myStepCursorTargetPosition),this.myPositionStepIncreaseButtonPanel.pp_setPositionLocal(this._myConfig.myIncreaseButtonPosition),this.myPositionStepIncreaseButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myPositionStepIncreaseButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myPositionStepIncreaseButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myPositionStepIncreaseButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myPositionStepDecreaseButtonPanel.pp_setPositionLocal(this._myConfig.myDecreaseButtonPosition),this.myPositionStepDecreaseButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myPositionStepDecreaseButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myPositionStepDecreaseButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myPositionStepDecreaseButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myRotationStepPanel.pp_setPositionLocal(this._myConfig.myStepPanelPosition),this.myRotationStepText.pp_scaleObject(this._myConfig.myStepTextScale),this.myRotationStepCursorTarget.pp_setPositionLocal(this._myConfig.myStepCursorTargetPosition),this.myRotationStepIncreaseButtonPanel.pp_setPositionLocal(this._myConfig.myIncreaseButtonPosition),this.myRotationStepIncreaseButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myRotationStepIncreaseButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myRotationStepIncreaseButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myRotationStepIncreaseButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myRotationStepDecreaseButtonPanel.pp_setPositionLocal(this._myConfig.myDecreaseButtonPosition),this.myRotationStepDecreaseButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myRotationStepDecreaseButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myRotationStepDecreaseButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myRotationStepDecreaseButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myScaleStepPanel.pp_setPositionLocal(this._myConfig.myStepPanelPosition),this.myScaleStepText.pp_scaleObject(this._myConfig.myStepTextScale),this.myScaleStepCursorTarget.pp_setPositionLocal(this._myConfig.myStepCursorTargetPosition),this.myScaleStepIncreaseButtonPanel.pp_setPositionLocal(this._myConfig.myIncreaseButtonPosition),this.myScaleStepIncreaseButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myScaleStepIncreaseButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myScaleStepIncreaseButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myScaleStepIncreaseButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myScaleStepDecreaseButtonPanel.pp_setPositionLocal(this._myConfig.myDecreaseButtonPosition),this.myScaleStepDecreaseButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myScaleStepDecreaseButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myScaleStepDecreaseButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myScaleStepDecreaseButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition)}_addComponentsHook(){this.myPositionLabelTextComponent=this.myPositionLabelText.pp_addComponent(ge),this._setupTextComponent(this.myPositionLabelTextComponent),this.myPositionLabelTextComponent.text=this._myConfig.myPositionText,this.myPositionLabelCursorTargetComponent=this.myPositionLabelCursorTarget.pp_addComponent(fe),this.myPositionLabelCollisionComponent=this.myPositionLabelCursorTarget.pp_addComponent(_e),this.myPositionLabelCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionLabelCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionLabelCollisionComponent.extents=this._myConfig.myComponentLabelCollisionExtents,this.myPositionTextComponents=[],this.myPositionCursorTargetComponents=[],this.myPositionCollisionComponents=[],this.myPositionIncreaseButtonBackgroundComponents=[],this.myPositionIncreaseButtonTextComponents=[],this.myPositionIncreaseButtonCursorTargetComponents=[],this.myPositionIncreaseButtonCollisionComponents=[],this.myPositionDecreaseButtonBackgroundComponents=[],this.myPositionDecreaseButtonTextComponents=[],this.myPositionDecreaseButtonCursorTargetComponents=[],this.myPositionDecreaseButtonCollisionComponents=[];for(let e=0;e<3;e++)this.myPositionTextComponents[e]=this.myPositionTexts[e].pp_addComponent(ge),this._setupTextComponent(this.myPositionTextComponents[e]),this.myPositionTextComponents[e].text=" ",this.myPositionCursorTargetComponents[e]=this.myPositionCursorTargets[e].pp_addComponent(fe),this.myPositionCollisionComponents[e]=this.myPositionCursorTargets[e].pp_addComponent(_e),this.myPositionCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionCollisionComponents[e].extents=this._myConfig.myValueCollisionExtents,this.myPositionIncreaseButtonBackgroundComponents[e]=this.myPositionIncreaseButtonBackgrounds[e].pp_addComponent(Xe),this.myPositionIncreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myPositionIncreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myPositionIncreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myPositionIncreaseButtonTextComponents[e]=this.myPositionIncreaseButtonTexts[e].pp_addComponent(ge),this._setupTextComponent(this.myPositionIncreaseButtonTextComponents[e]),this.myPositionIncreaseButtonTextComponents[e].text=this._myConfig.myIncreaseButtonText,this.myPositionIncreaseButtonCursorTargetComponents[e]=this.myPositionIncreaseButtonCursorTargets[e].pp_addComponent(fe),this.myPositionIncreaseButtonCollisionComponents[e]=this.myPositionIncreaseButtonCursorTargets[e].pp_addComponent(_e),this.myPositionIncreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionIncreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionIncreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents,this.myPositionDecreaseButtonBackgroundComponents[e]=this.myPositionDecreaseButtonBackgrounds[e].pp_addComponent(Xe),this.myPositionDecreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myPositionDecreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myPositionDecreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myPositionDecreaseButtonTextComponents[e]=this.myPositionDecreaseButtonTexts[e].pp_addComponent(ge),this._setupTextComponent(this.myPositionDecreaseButtonTextComponents[e]),this.myPositionDecreaseButtonTextComponents[e].text=this._myConfig.myDecreaseButtonText,this.myPositionDecreaseButtonCursorTargetComponents[e]=this.myPositionDecreaseButtonCursorTargets[e].pp_addComponent(fe),this.myPositionDecreaseButtonCollisionComponents[e]=this.myPositionDecreaseButtonCursorTargets[e].pp_addComponent(_e),this.myPositionDecreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionDecreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionDecreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents;this.myRotationLabelTextComponent=this.myRotationLabelText.pp_addComponent(ge),this._setupTextComponent(this.myRotationLabelTextComponent),this.myRotationLabelTextComponent.text=this._myConfig.myRotationText,this.myRotationLabelCursorTargetComponent=this.myRotationLabelCursorTarget.pp_addComponent(fe),this.myRotationLabelCollisionComponent=this.myRotationLabelCursorTarget.pp_addComponent(_e),this.myRotationLabelCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationLabelCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationLabelCollisionComponent.extents=this._myConfig.myComponentLabelCollisionExtents,this.myRotationTextComponents=[],this.myRotationCursorTargetComponents=[],this.myRotationCollisionComponents=[],this.myRotationIncreaseButtonBackgroundComponents=[],this.myRotationIncreaseButtonTextComponents=[],this.myRotationIncreaseButtonCursorTargetComponents=[],this.myRotationIncreaseButtonCollisionComponents=[],this.myRotationDecreaseButtonBackgroundComponents=[],this.myRotationDecreaseButtonTextComponents=[],this.myRotationDecreaseButtonCursorTargetComponents=[],this.myRotationDecreaseButtonCollisionComponents=[];for(let e=0;e<3;e++)this.myRotationTextComponents[e]=this.myRotationTexts[e].pp_addComponent(ge),this._setupTextComponent(this.myRotationTextComponents[e]),this.myRotationTextComponents[e].text=" ",this.myRotationCursorTargetComponents[e]=this.myRotationCursorTargets[e].pp_addComponent(fe),this.myRotationCollisionComponents[e]=this.myRotationCursorTargets[e].pp_addComponent(_e),this.myRotationCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationCollisionComponents[e].extents=this._myConfig.myValueCollisionExtents,this.myRotationIncreaseButtonBackgroundComponents[e]=this.myRotationIncreaseButtonBackgrounds[e].pp_addComponent(Xe),this.myRotationIncreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myRotationIncreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myRotationIncreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myRotationIncreaseButtonTextComponents[e]=this.myRotationIncreaseButtonTexts[e].pp_addComponent(ge),this._setupTextComponent(this.myRotationIncreaseButtonTextComponents[e]),this.myRotationIncreaseButtonTextComponents[e].text=this._myConfig.myIncreaseButtonText,this.myRotationIncreaseButtonCursorTargetComponents[e]=this.myRotationIncreaseButtonCursorTargets[e].pp_addComponent(fe),this.myRotationIncreaseButtonCollisionComponents[e]=this.myRotationIncreaseButtonCursorTargets[e].pp_addComponent(_e),this.myRotationIncreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationIncreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationIncreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents,this.myRotationDecreaseButtonBackgroundComponents[e]=this.myRotationDecreaseButtonBackgrounds[e].pp_addComponent(Xe),this.myRotationDecreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myRotationDecreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myRotationDecreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myRotationDecreaseButtonTextComponents[e]=this.myRotationDecreaseButtonTexts[e].pp_addComponent(ge),this._setupTextComponent(this.myRotationDecreaseButtonTextComponents[e]),this.myRotationDecreaseButtonTextComponents[e].text=this._myConfig.myDecreaseButtonText,this.myRotationDecreaseButtonCursorTargetComponents[e]=this.myRotationDecreaseButtonCursorTargets[e].pp_addComponent(fe),this.myRotationDecreaseButtonCollisionComponents[e]=this.myRotationDecreaseButtonCursorTargets[e].pp_addComponent(_e),this.myRotationDecreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationDecreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationDecreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents;this.myScaleLabelTextComponent=this.myScaleLabelText.pp_addComponent(ge),this._setupTextComponent(this.myScaleLabelTextComponent),this.myScaleLabelTextComponent.text=this._myConfig.myScaleText,this.myScaleLabelCursorTargetComponent=this.myScaleLabelCursorTarget.pp_addComponent(fe),this.myScaleLabelCollisionComponent=this.myScaleLabelCursorTarget.pp_addComponent(_e),this.myScaleLabelCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleLabelCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleLabelCollisionComponent.extents=this._myConfig.myComponentLabelCollisionExtents,this.myScaleTextComponents=[],this.myScaleCursorTargetComponents=[],this.myScaleCollisionComponents=[],this.myScaleIncreaseButtonBackgroundComponents=[],this.myScaleIncreaseButtonTextComponents=[],this.myScaleIncreaseButtonCursorTargetComponents=[],this.myScaleIncreaseButtonCollisionComponents=[],this.myScaleDecreaseButtonBackgroundComponents=[],this.myScaleDecreaseButtonTextComponents=[],this.myScaleDecreaseButtonCursorTargetComponents=[],this.myScaleDecreaseButtonCollisionComponents=[];for(let e=0;e<3;e++)this.myScaleTextComponents[e]=this.myScaleTexts[e].pp_addComponent(ge),this._setupTextComponent(this.myScaleTextComponents[e]),this.myScaleTextComponents[e].text=" ",this.myScaleCursorTargetComponents[e]=this.myScaleCursorTargets[e].pp_addComponent(fe),this.myScaleCollisionComponents[e]=this.myScaleCursorTargets[e].pp_addComponent(_e),this.myScaleCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleCollisionComponents[e].extents=this._myConfig.myValueCollisionExtents,this.myScaleIncreaseButtonBackgroundComponents[e]=this.myScaleIncreaseButtonBackgrounds[e].pp_addComponent(Xe),this.myScaleIncreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myScaleIncreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myScaleIncreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myScaleIncreaseButtonTextComponents[e]=this.myScaleIncreaseButtonTexts[e].pp_addComponent(ge),this._setupTextComponent(this.myScaleIncreaseButtonTextComponents[e]),this.myScaleIncreaseButtonTextComponents[e].text=this._myConfig.myIncreaseButtonText,this.myScaleIncreaseButtonCursorTargetComponents[e]=this.myScaleIncreaseButtonCursorTargets[e].pp_addComponent(fe),this.myScaleIncreaseButtonCollisionComponents[e]=this.myScaleIncreaseButtonCursorTargets[e].pp_addComponent(_e),this.myScaleIncreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleIncreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleIncreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents,this.myScaleDecreaseButtonBackgroundComponents[e]=this.myScaleDecreaseButtonBackgrounds[e].pp_addComponent(Xe),this.myScaleDecreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myScaleDecreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myScaleDecreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myScaleDecreaseButtonTextComponents[e]=this.myScaleDecreaseButtonTexts[e].pp_addComponent(ge),this._setupTextComponent(this.myScaleDecreaseButtonTextComponents[e]),this.myScaleDecreaseButtonTextComponents[e].text=this._myConfig.myDecreaseButtonText,this.myScaleDecreaseButtonCursorTargetComponents[e]=this.myScaleDecreaseButtonCursorTargets[e].pp_addComponent(fe),this.myScaleDecreaseButtonCollisionComponents[e]=this.myScaleDecreaseButtonCursorTargets[e].pp_addComponent(_e),this.myScaleDecreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleDecreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleDecreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents;this.myPositionStepTextComponent=this.myPositionStepText.pp_addComponent(ge),this._setupTextComponent(this.myPositionStepTextComponent),this.myPositionStepTextComponent.text=" ",this.myPositionStepCursorTargetComponent=this.myPositionStepCursorTarget.pp_addComponent(fe),this.myPositionStepCollisionComponent=this.myPositionStepCursorTarget.pp_addComponent(_e),this.myPositionStepCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionStepCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionStepCollisionComponent.extents=this._myConfig.myStepCollisionExtents,this.myPositionStepIncreaseButtonBackgroundComponent=this.myPositionStepIncreaseButtonBackground.pp_addComponent(Xe),this.myPositionStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPositionStepIncreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myPositionStepIncreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myPositionStepIncreaseButtonTextComponent=this.myPositionStepIncreaseButtonText.pp_addComponent(ge),this._setupTextComponent(this.myPositionStepIncreaseButtonTextComponent),this.myPositionStepIncreaseButtonTextComponent.text=this._myConfig.myIncreaseButtonText,this.myPositionStepIncreaseButtonCursorTargetComponent=this.myPositionStepIncreaseButtonCursorTarget.pp_addComponent(fe),this.myPositionStepIncreaseButtonCollisionComponent=this.myPositionStepIncreaseButtonCursorTarget.pp_addComponent(_e),this.myPositionStepIncreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionStepIncreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionStepIncreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myPositionStepDecreaseButtonBackgroundComponent=this.myPositionStepDecreaseButtonBackground.pp_addComponent(Xe),this.myPositionStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPositionStepDecreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myPositionStepDecreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myPositionStepDecreaseButtonTextComponent=this.myPositionStepDecreaseButtonText.pp_addComponent(ge),this._setupTextComponent(this.myPositionStepDecreaseButtonTextComponent),this.myPositionStepDecreaseButtonTextComponent.text=this._myConfig.myDecreaseButtonText,this.myPositionStepDecreaseButtonCursorTargetComponent=this.myPositionStepDecreaseButtonCursorTarget.pp_addComponent(fe),this.myPositionStepDecreaseButtonCollisionComponent=this.myPositionStepDecreaseButtonCursorTarget.pp_addComponent(_e),this.myPositionStepDecreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionStepDecreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionStepDecreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myRotationStepTextComponent=this.myRotationStepText.pp_addComponent(ge),this._setupTextComponent(this.myRotationStepTextComponent),this.myRotationStepTextComponent.text=" ",this.myRotationStepCursorTargetComponent=this.myRotationStepCursorTarget.pp_addComponent(fe),this.myRotationStepCollisionComponent=this.myRotationStepCursorTarget.pp_addComponent(_e),this.myRotationStepCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationStepCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationStepCollisionComponent.extents=this._myConfig.myStepCollisionExtents,this.myRotationStepIncreaseButtonBackgroundComponent=this.myRotationStepIncreaseButtonBackground.pp_addComponent(Xe),this.myRotationStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myRotationStepIncreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myRotationStepIncreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myRotationStepIncreaseButtonTextComponent=this.myRotationStepIncreaseButtonText.pp_addComponent(ge),this._setupTextComponent(this.myRotationStepIncreaseButtonTextComponent),this.myRotationStepIncreaseButtonTextComponent.text=this._myConfig.myIncreaseButtonText,this.myRotationStepIncreaseButtonCursorTargetComponent=this.myRotationStepIncreaseButtonCursorTarget.pp_addComponent(fe),this.myRotationStepIncreaseButtonCollisionComponent=this.myRotationStepIncreaseButtonCursorTarget.pp_addComponent(_e),this.myRotationStepIncreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationStepIncreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationStepIncreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myRotationStepDecreaseButtonBackgroundComponent=this.myRotationStepDecreaseButtonBackground.pp_addComponent(Xe),this.myRotationStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myRotationStepDecreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myRotationStepDecreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myRotationStepDecreaseButtonTextComponent=this.myRotationStepDecreaseButtonText.pp_addComponent(ge),this._setupTextComponent(this.myRotationStepDecreaseButtonTextComponent),this.myRotationStepDecreaseButtonTextComponent.text=this._myConfig.myDecreaseButtonText,this.myRotationStepDecreaseButtonCursorTargetComponent=this.myRotationStepDecreaseButtonCursorTarget.pp_addComponent(fe),this.myRotationStepDecreaseButtonCollisionComponent=this.myRotationStepDecreaseButtonCursorTarget.pp_addComponent(_e),this.myRotationStepDecreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationStepDecreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationStepDecreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myScaleStepTextComponent=this.myScaleStepText.pp_addComponent(ge),this._setupTextComponent(this.myScaleStepTextComponent),this.myScaleStepTextComponent.text=" ",this.myScaleStepCursorTargetComponent=this.myScaleStepCursorTarget.pp_addComponent(fe),this.myScaleStepCollisionComponent=this.myScaleStepCursorTarget.pp_addComponent(_e),this.myScaleStepCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleStepCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleStepCollisionComponent.extents=this._myConfig.myStepCollisionExtents,this.myScaleStepIncreaseButtonBackgroundComponent=this.myScaleStepIncreaseButtonBackground.pp_addComponent(Xe),this.myScaleStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myScaleStepIncreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myScaleStepIncreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myScaleStepIncreaseButtonTextComponent=this.myScaleStepIncreaseButtonText.pp_addComponent(ge),this._setupTextComponent(this.myScaleStepIncreaseButtonTextComponent),this.myScaleStepIncreaseButtonTextComponent.text=this._myConfig.myIncreaseButtonText,this.myScaleStepIncreaseButtonCursorTargetComponent=this.myScaleStepIncreaseButtonCursorTarget.pp_addComponent(fe),this.myScaleStepIncreaseButtonCollisionComponent=this.myScaleStepIncreaseButtonCursorTarget.pp_addComponent(_e),this.myScaleStepIncreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleStepIncreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleStepIncreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myScaleStepDecreaseButtonBackgroundComponent=this.myScaleStepDecreaseButtonBackground.pp_addComponent(Xe),this.myScaleStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myScaleStepDecreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myScaleStepDecreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myScaleStepDecreaseButtonTextComponent=this.myScaleStepDecreaseButtonText.pp_addComponent(ge),this._setupTextComponent(this.myScaleStepDecreaseButtonTextComponent),this.myScaleStepDecreaseButtonTextComponent.text=this._myConfig.myDecreaseButtonText,this.myScaleStepDecreaseButtonCursorTargetComponent=this.myScaleStepDecreaseButtonCursorTarget.pp_addComponent(fe),this.myScaleStepDecreaseButtonCollisionComponent=this.myScaleStepDecreaseButtonCursorTarget.pp_addComponent(_e),this.myScaleStepDecreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleStepDecreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleStepDecreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents}_addStepComponents(){this.myPositionStepTextComponent=this.myPositionStepText.pp_addComponent(ge),this._setupTextComponent(this.myPositionStepTextComponent),this.myPositionStepTextComponent.text=" ",this.myPositionStepCursorTargetComponent=this.myPositionStepCursorTarget.pp_addComponent(fe),this.myPositionStepCollisionComponent=this.myPositionStepCursorTarget.pp_addComponent(_e),this.myPositionStepCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionStepCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionStepCollisionComponent.extents=this._myConfig.myStepCollisionExtents,this.myPositionStepIncreaseButtonBackgroundComponent=this.myPositionStepIncreaseButtonBackground.pp_addComponent(Xe),this.myPositionStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPositionStepIncreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myPositionStepIncreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myPositionStepIncreaseButtonTextComponent=this.myPositionStepIncreaseButtonText.pp_addComponent(ge),this._setupTextComponent(this.myPositionStepIncreaseButtonTextComponent),this.myPositionStepIncreaseButtonTextComponent.text=this._myConfig.myIncreaseButtonText,this.myPositionStepIncreaseButtonCursorTargetComponent=this.myPositionStepIncreaseButtonCursorTarget.pp_addComponent(fe),this.myPositionStepIncreaseButtonCollisionComponent=this.myPositionStepIncreaseButtonCursorTarget.pp_addComponent(_e),this.myPositionStepIncreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionStepIncreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionStepIncreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myPositionStepDecreaseButtonBackgroundComponent=this.myPositionStepDecreaseButtonBackground.pp_addComponent(Xe),this.myPositionStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPositionStepDecreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myPositionStepDecreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myPositionStepDecreaseButtonTextComponent=this.myPositionStepDecreaseButtonText.pp_addComponent(ge),this._setupTextComponent(this.myPositionStepDecreaseButtonTextComponent),this.myPositionStepDecreaseButtonTextComponent.text=this._myConfig.myDecreaseButtonText,this.myPositionStepDecreaseButtonCursorTargetComponent=this.myPositionStepDecreaseButtonCursorTarget.pp_addComponent(fe),this.myPositionStepDecreaseButtonCollisionComponent=this.myPositionStepDecreaseButtonCursorTarget.pp_addComponent(_e),this.myPositionStepDecreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionStepDecreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionStepDecreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myRotationStepTextComponent=this.myRotationStepText.pp_addComponent(ge),this._setupTextComponent(this.myRotationStepTextComponent),this.myRotationStepTextComponent.text=" ",this.myRotationStepCursorTargetComponent=this.myRotationStepCursorTarget.pp_addComponent(fe),this.myRotationStepCollisionComponent=this.myRotationStepCursorTarget.pp_addComponent(_e),this.myRotationStepCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationStepCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationStepCollisionComponent.extents=this._myConfig.myStepCollisionExtents,this.myRotationStepIncreaseButtonBackgroundComponent=this.myRotationStepIncreaseButtonBackground.pp_addComponent(Xe),this.myRotationStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myRotationStepIncreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myRotationStepIncreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myRotationStepIncreaseButtonTextComponent=this.myRotationStepIncreaseButtonText.pp_addComponent(ge),this._setupTextComponent(this.myRotationStepIncreaseButtonTextComponent),this.myRotationStepIncreaseButtonTextComponent.text=this._myConfig.myIncreaseButtonText,this.myRotationStepIncreaseButtonCursorTargetComponent=this.myRotationStepIncreaseButtonCursorTarget.pp_addComponent(fe),this.myRotationStepIncreaseButtonCollisionComponent=this.myRotationStepIncreaseButtonCursorTarget.pp_addComponent(_e),this.myRotationStepIncreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationStepIncreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationStepIncreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myRotationStepDecreaseButtonBackgroundComponent=this.myRotationStepDecreaseButtonBackground.pp_addComponent(Xe),this.myRotationStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myRotationStepDecreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myRotationStepDecreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myRotationStepDecreaseButtonTextComponent=this.myRotationStepDecreaseButtonText.pp_addComponent(ge),this._setupTextComponent(this.myRotationStepDecreaseButtonTextComponent),this.myRotationStepDecreaseButtonTextComponent.text=this._myConfig.myDecreaseButtonText,this.myRotationStepDecreaseButtonCursorTargetComponent=this.myRotationStepDecreaseButtonCursorTarget.pp_addComponent(fe),this.myRotationStepDecreaseButtonCollisionComponent=this.myRotationStepDecreaseButtonCursorTarget.pp_addComponent(_e),this.myRotationStepDecreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationStepDecreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationStepDecreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myScaleStepTextComponent=this.myScaleStepText.pp_addComponent(ge),this._setupTextComponent(this.myScaleStepTextComponent),this.myScaleStepTextComponent.text=" ",this.myScaleStepCursorTargetComponent=this.myScaleStepCursorTarget.pp_addComponent(fe),this.myScaleStepCollisionComponent=this.myScaleStepCursorTarget.pp_addComponent(_e),this.myScaleStepCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleStepCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleStepCollisionComponent.extents=this._myConfig.myStepCollisionExtents,this.myScaleStepIncreaseButtonBackgroundComponent=this.myScaleStepIncreaseButtonBackground.pp_addComponent(Xe),this.myScaleStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myScaleStepIncreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myScaleStepIncreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myScaleStepIncreaseButtonTextComponent=this.myScaleStepIncreaseButtonText.pp_addComponent(ge),this._setupTextComponent(this.myScaleStepIncreaseButtonTextComponent),this.myScaleStepIncreaseButtonTextComponent.text=this._myConfig.myIncreaseButtonText,this.myScaleStepIncreaseButtonCursorTargetComponent=this.myScaleStepIncreaseButtonCursorTarget.pp_addComponent(fe),this.myScaleStepIncreaseButtonCollisionComponent=this.myScaleStepIncreaseButtonCursorTarget.pp_addComponent(_e),this.myScaleStepIncreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleStepIncreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleStepIncreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myScaleStepDecreaseButtonBackgroundComponent=this.myScaleStepDecreaseButtonBackground.pp_addComponent(Xe),this.myScaleStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myScaleStepDecreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myScaleStepDecreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myScaleStepDecreaseButtonTextComponent=this.myScaleStepDecreaseButtonText.pp_addComponent(ge),this._setupTextComponent(this.myScaleStepDecreaseButtonTextComponent),this.myScaleStepDecreaseButtonTextComponent.text=this._myConfig.myDecreaseButtonText,this.myScaleStepDecreaseButtonCursorTargetComponent=this.myScaleStepDecreaseButtonCursorTarget.pp_addComponent(fe),this.myScaleStepDecreaseButtonCollisionComponent=this.myScaleStepDecreaseButtonCursorTarget.pp_addComponent(_e),this.myScaleStepDecreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleStepDecreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleStepDecreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents}};var Fa=class extends kt{constructor(e,t,n=m.getMainEngine()){super(e),this._myGamepad=t,this._myConfig=new Ha,this._myUI=new ka(n),this._myValueButtonEditIntensity=0,this._myValueButtonEditIntensityTimer=0,this._myStepButtonEditIntensity=0,this._myStepButtonEditIntensityTimer=0,this._myValueEditEnabled=!1,this._myStepEditEnabled=!1,this._myValueRealValue=0,this._myComponentStepValue=0,this._myStepMultiplierValue=0,this._myStepFastEdit=!1,this._myValueEditIndex=-1,this._myComponentIndex=0,this._myStepIndex=0,this._myTempTransformValue=be(),this._myTempPositionValue=p(),this._myTempRotationValue=p(),this._myTempScaleValue=p()}_refreshUIHook(){for(let e=0;e<3;e++)this._myUI.myPositionTextComponents[e].text=this._myVariable._myPosition[e].toFixed(this._myVariable._myDecimalPlaces);this._myUI.myPositionStepTextComponent.text=this._myConfig.myStepStartString.concat(this._myVariable._myPositionStepPerSecond);for(let e=0;e<3;e++)this._myUI.myRotationTextComponents[e].text=this._myVariable._myRotation[e].toFixed(this._myVariable._myDecimalPlaces);this._myUI.myRotationStepTextComponent.text=this._myConfig.myStepStartString.concat(this._myVariable._myRotationStepPerSecond);for(let e=0;e<3;e++)this._myUI.myScaleTextComponents[e].text=this._myVariable._myScale[e].toFixed(this._myVariable._myDecimalPlaces);this._myUI.myScaleStepTextComponent.text=this._myConfig.myStepStartString.concat(this._myVariable._myScaleStepPerSecond)}_startHook(e,t){this._myUI.setAdditionalButtonsVisible(t.myShowAdditionalButtons)}_setEasyTuneVariableHook(){this._myVariable!=null&&(this._myTempPositionValue.pp_copy(this._myVariable._myPosition),this._myTempRotationValue.pp_copy(this._myVariable._myRotation),this._myTempScaleValue.pp_copy(this._myVariable._myScale))}_updateHook(e){this._updateValue(e)}_updateValue(e){let t=0;if(this._myGamepad){let s=this._myGamepad.getAxesInfo(ne.THUMBSTICK).myAxes[1];if(Math.abs(s)>this._myConfig.myEditThumbstickMinThreshold){let a=(Math.abs(s)-this._myConfig.myEditThumbstickMinThreshold)/(1-this._myConfig.myEditThumbstickMinThreshold);t=Math.sign(s)*a}}let n=0;if(this._myValueEditEnabled?n=t:this._myValueButtonEditIntensity!=0&&(this._myValueButtonEditIntensityTimer<=0?n=this._myValueButtonEditIntensity:this._myValueButtonEditIntensityTimer-=e),this._myValueEditIndex>=0&&this._myValueEditIndex<3)if(n!=0){this._myTempPositionValue.pp_copy(this._myVariable._myPosition),this._myTempRotationValue.pp_copy(this._myVariable._myRotation),this._myTempScaleValue.pp_copy(this._myVariable._myScale);let s=n*this._myComponentStepValue*e;this._myValueRealValue+=s;let a=Math.pow(10,this._myVariable._myDecimalPlaces);switch(this._myComponentIndex){case 0:this._myTempPositionValue[this._myValueEditIndex]=Math.round(this._myValueRealValue*a+Number.EPSILON)/a,this._myUI.myPositionTextComponents[this._myValueEditIndex].text=this._myTempPositionValue[this._myValueEditIndex].toFixed(this._myVariable._myDecimalPlaces);break;case 1:if(this._myValueRealValue>180){for(;this._myValueRealValue>180;)this._myValueRealValue-=180;this._myValueRealValue=-180+this._myValueRealValue}if(this._myValueRealValue<-180){for(;this._myValueRealValue<-180;)this._myValueRealValue+=180;this._myValueRealValue=180-this._myValueRealValue}this._myTempRotationValue[this._myValueEditIndex]=Math.round(this._myValueRealValue*a+Number.EPSILON)/a,this._myUI.myRotationTextComponents[this._myValueEditIndex].text=this._myTempRotationValue[this._myValueEditIndex].toFixed(this._myVariable._myDecimalPlaces);break;case 2:if(this._myValueRealValue<=0&&(this._myValueRealValue=1/a),this._myVariable._myScaleAsOne){let h=Math.round(this._myValueRealValue*a+Number.EPSILON)/a-this._myTempScaleValue[this._myValueEditIndex];for(let _=0;_<3;_++)this._myTempScaleValue[_]=Math.round((this._myTempScaleValue[_]+h)*a+Number.EPSILON)/a,this._myTempScaleValue[_]=Math.max(this._myTempScaleValue[_],1/a),this._myUI.myScaleTextComponents[_].text=this._myTempScaleValue[_].toFixed(this._myVariable._myDecimalPlaces)}else this._myTempScaleValue[this._myValueEditIndex]=Math.round(this._myValueRealValue*a+Number.EPSILON)/a,this._myTempScaleValue[this._myValueEditIndex]=Math.max(this._myTempScaleValue[this._myValueEditIndex],1/a),this._myUI.myScaleTextComponents[this._myValueEditIndex].text=this._myTempScaleValue[this._myValueEditIndex].toFixed(this._myVariable._myDecimalPlaces);break}this._myTempTransformValue.mat4_setPositionRotationDegreesScale(this._myTempPositionValue,this._myTempRotationValue,this._myTempScaleValue),this._myVariable.setValue(this._myTempTransformValue)}else switch(this._myComponentIndex){case 0:this._myValueRealValue=this._myVariable._myPosition[this._myValueEditIndex];break;case 1:this._myValueRealValue=this._myVariable._myRotation[this._myValueEditIndex];break;case 2:this._myValueRealValue=this._myVariable._myScale[this._myValueEditIndex];break}let o=0;if(this._myStepEditEnabled?o=t:this._myStepButtonEditIntensity!=0&&(this._myStepButtonEditIntensityTimer<=0?o=this._myStepButtonEditIntensity:this._myStepButtonEditIntensityTimer-=e),o!=0){let s=0;if(this._myStepFastEdit?(s=Math.sign(o)*1,this._myStepFastEdit=!1):s=o*this._myConfig.myStepMultiplierStepPerSecond*e,this._myStepMultiplierValue+=s,Math.abs(this._myStepMultiplierValue)>=1){let a=0;switch(this._myStepIndex){case 0:a=this._myVariable._myPositionStepPerSecond;break;case 1:a=this._myVariable._myRotationStepPerSecond;break;case 2:a=this._myVariable._myScaleStepPerSecond;break;default:a=0}Math.sign(this._myStepMultiplierValue)>0?(this._myStepMultiplierValue-=1,this._changeStep(this._myStepIndex,a*10)):(this._myStepMultiplierValue+=1,this._changeStep(this._myStepIndex,a*.1))}}else this._myStepMultiplierValue=0,this._myStepFastEdit=!0}_addListenersHook(){let e=this._myUI;e.myVariableLabelCursorTargetComponent.onClick.add(this._resetAllValues.bind(this)),e.myVariableLabelCursorTargetComponent.onHover.add(this._genericTextHover.bind(this,e.myVariableLabelText)),e.myVariableLabelCursorTargetComponent.onUnhover.add(this._genericTextUnhover.bind(this,e.myVariableLabelText,this._myConfig.myVariableLabelTextScale)),e.myPositionLabelCursorTargetComponent.onClick.add(this._resetComponentValues.bind(this,0)),e.myPositionLabelCursorTargetComponent.onHover.add(this._genericTextHover.bind(this,e.myPositionLabelText)),e.myPositionLabelCursorTargetComponent.onUnhover.add(this._genericTextUnhover.bind(this,e.myPositionLabelText,this._myConfig.myComponentLabelTextScale));for(let t=0;t<3;t++)e.myPositionIncreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,0,t,1)),e.myPositionIncreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,0,t,1)),e.myPositionIncreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,0,t,0)),e.myPositionIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,0,t,0)),e.myPositionDecreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,0,t,-1)),e.myPositionDecreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,0,t,-1)),e.myPositionDecreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,0,t,0)),e.myPositionDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,0,t,0)),e.myPositionIncreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myPositionIncreaseButtonBackgroundComponents[t].material)),e.myPositionIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnhover.bind(this,e.myPositionIncreaseButtonBackgroundComponents[t].material)),e.myPositionDecreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myPositionDecreaseButtonBackgroundComponents[t].material)),e.myPositionDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnhover.bind(this,e.myPositionDecreaseButtonBackgroundComponents[t].material)),e.myPositionCursorTargetComponents[t].onClick.add(this._resetValue.bind(this,0,t)),e.myPositionCursorTargetComponents[t].onHover.add(this._setValueEditEnabled.bind(this,0,t,e.myPositionTexts[t],!0)),e.myPositionCursorTargetComponents[t].onUnhover.add(this._setValueEditEnabled.bind(this,0,t,e.myPositionTexts[t],!1));e.myRotationLabelCursorTargetComponent.onClick.add(this._resetComponentValues.bind(this,1)),e.myRotationLabelCursorTargetComponent.onHover.add(this._genericTextHover.bind(this,e.myRotationLabelText)),e.myRotationLabelCursorTargetComponent.onUnhover.add(this._genericTextUnhover.bind(this,e.myRotationLabelText,this._myConfig.myComponentLabelTextScale));for(let t=0;t<3;t++)e.myRotationIncreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,1,t,1)),e.myRotationIncreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,1,t,1)),e.myRotationIncreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,1,t,0)),e.myRotationIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,1,t,0)),e.myRotationDecreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,1,t,-1)),e.myRotationDecreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,1,t,-1)),e.myRotationDecreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,1,t,0)),e.myRotationDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,1,t,0)),e.myRotationIncreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myRotationIncreaseButtonBackgroundComponents[t].material)),e.myRotationIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnhover.bind(this,e.myRotationIncreaseButtonBackgroundComponents[t].material)),e.myRotationDecreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myRotationDecreaseButtonBackgroundComponents[t].material)),e.myRotationDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnhover.bind(this,e.myRotationDecreaseButtonBackgroundComponents[t].material)),e.myRotationCursorTargetComponents[t].onClick.add(this._resetValue.bind(this,1,t)),e.myRotationCursorTargetComponents[t].onHover.add(this._setValueEditEnabled.bind(this,1,t,e.myRotationTexts[t],!0)),e.myRotationCursorTargetComponents[t].onUnhover.add(this._setValueEditEnabled.bind(this,1,t,e.myRotationTexts[t],!1));e.myScaleLabelCursorTargetComponent.onClick.add(this._resetComponentValues.bind(this,2)),e.myScaleLabelCursorTargetComponent.onHover.add(this._genericTextHover.bind(this,e.myScaleLabelText)),e.myScaleLabelCursorTargetComponent.onUnhover.add(this._genericTextUnhover.bind(this,e.myScaleLabelText,this._myConfig.myComponentLabelTextScale));for(let t=0;t<3;t++)e.myScaleIncreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,2,t,1)),e.myScaleIncreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,2,t,1)),e.myScaleIncreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,2,t,0)),e.myScaleIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,2,t,0)),e.myScaleDecreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,2,t,-1)),e.myScaleDecreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,2,t,-1)),e.myScaleDecreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,2,t,0)),e.myScaleDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,2,t,0)),e.myScaleIncreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myScaleIncreaseButtonBackgroundComponents[t].material)),e.myScaleIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnhover.bind(this,e.myScaleIncreaseButtonBackgroundComponents[t].material)),e.myScaleDecreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myScaleDecreaseButtonBackgroundComponents[t].material)),e.myScaleDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnhover.bind(this,e.myScaleDecreaseButtonBackgroundComponents[t].material)),e.myScaleCursorTargetComponents[t].onClick.add(this._resetValue.bind(this,2,t)),e.myScaleCursorTargetComponents[t].onHover.add(this._setValueEditEnabled.bind(this,2,t,e.myScaleTexts[t],!0)),e.myScaleCursorTargetComponents[t].onUnhover.add(this._setValueEditEnabled.bind(this,2,t,e.myScaleTexts[t],!1));e.myPositionStepCursorTargetComponent.onClick.add(this._resetStep.bind(this,0)),e.myPositionStepCursorTargetComponent.onHover.add(this._setStepEditEnabled.bind(this,0,e.myPositionStepText,!0)),e.myPositionStepCursorTargetComponent.onUnhover.add(this._setStepEditEnabled.bind(this,0,e.myPositionStepText,!1)),e.myPositionStepIncreaseButtonCursorTargetComponent.onDown.add(this._setStepEditIntensity.bind(this,0,1)),e.myPositionStepIncreaseButtonCursorTargetComponent.onDownOnHover.add(this._setStepEditIntensity.bind(this,0,1)),e.myPositionStepIncreaseButtonCursorTargetComponent.onUp.add(this._setStepEditIntensity.bind(this,0,0)),e.myPositionStepIncreaseButtonCursorTargetComponent.onUnhover.add(this._setStepEditIntensity.bind(this,0,0)),e.myPositionStepDecreaseButtonCursorTargetComponent.onDown.add(this._setStepEditIntensity.bind(this,0,-1)),e.myPositionStepDecreaseButtonCursorTargetComponent.onDownOnHover.add(this._setStepEditIntensity.bind(this,0,-1)),e.myPositionStepDecreaseButtonCursorTargetComponent.onUp.add(this._setStepEditIntensity.bind(this,0,0)),e.myPositionStepDecreaseButtonCursorTargetComponent.onUnhover.add(this._setStepEditIntensity.bind(this,0,0)),e.myPositionStepIncreaseButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myPositionStepIncreaseButtonBackgroundComponent.material)),e.myPositionStepIncreaseButtonCursorTargetComponent.onUnhover.add(this._genericUnhover.bind(this,e.myPositionStepIncreaseButtonBackgroundComponent.material)),e.myPositionStepDecreaseButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myPositionStepDecreaseButtonBackgroundComponent.material)),e.myPositionStepDecreaseButtonCursorTargetComponent.onUnhover.add(this._genericUnhover.bind(this,e.myPositionStepDecreaseButtonBackgroundComponent.material)),e.myRotationStepCursorTargetComponent.onClick.add(this._resetStep.bind(this,1)),e.myRotationStepCursorTargetComponent.onHover.add(this._setStepEditEnabled.bind(this,1,e.myRotationStepText,!0)),e.myRotationStepCursorTargetComponent.onUnhover.add(this._setStepEditEnabled.bind(this,1,e.myRotationStepText,!1)),e.myRotationStepIncreaseButtonCursorTargetComponent.onDown.add(this._setStepEditIntensity.bind(this,1,1)),e.myRotationStepIncreaseButtonCursorTargetComponent.onDownOnHover.add(this._setStepEditIntensity.bind(this,1,1)),e.myRotationStepIncreaseButtonCursorTargetComponent.onUp.add(this._setStepEditIntensity.bind(this,1,0)),e.myRotationStepIncreaseButtonCursorTargetComponent.onUnhover.add(this._setStepEditIntensity.bind(this,1,0)),e.myRotationStepDecreaseButtonCursorTargetComponent.onDown.add(this._setStepEditIntensity.bind(this,1,-1)),e.myRotationStepDecreaseButtonCursorTargetComponent.onDownOnHover.add(this._setStepEditIntensity.bind(this,1,-1)),e.myRotationStepDecreaseButtonCursorTargetComponent.onUp.add(this._setStepEditIntensity.bind(this,1,0)),e.myRotationStepDecreaseButtonCursorTargetComponent.onUnhover.add(this._setStepEditIntensity.bind(this,1,0)),e.myRotationStepIncreaseButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myRotationStepIncreaseButtonBackgroundComponent.material)),e.myRotationStepIncreaseButtonCursorTargetComponent.onUnhover.add(this._genericUnhover.bind(this,e.myRotationStepIncreaseButtonBackgroundComponent.material)),e.myRotationStepDecreaseButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myRotationStepDecreaseButtonBackgroundComponent.material)),e.myRotationStepDecreaseButtonCursorTargetComponent.onUnhover.add(this._genericUnhover.bind(this,e.myRotationStepDecreaseButtonBackgroundComponent.material)),e.myScaleStepCursorTargetComponent.onClick.add(this._resetStep.bind(this,2)),e.myScaleStepCursorTargetComponent.onHover.add(this._setStepEditEnabled.bind(this,2,e.myScaleStepText,!0)),e.myScaleStepCursorTargetComponent.onUnhover.add(this._setStepEditEnabled.bind(this,2,e.myScaleStepText,!1)),e.myScaleStepIncreaseButtonCursorTargetComponent.onDown.add(this._setStepEditIntensity.bind(this,2,1)),e.myScaleStepIncreaseButtonCursorTargetComponent.onDownOnHover.add(this._setStepEditIntensity.bind(this,2,1)),e.myScaleStepIncreaseButtonCursorTargetComponent.onUp.add(this._setStepEditIntensity.bind(this,2,0)),e.myScaleStepIncreaseButtonCursorTargetComponent.onUnhover.add(this._setStepEditIntensity.bind(this,2,0)),e.myScaleStepDecreaseButtonCursorTargetComponent.onDown.add(this._setStepEditIntensity.bind(this,2,-1)),e.myScaleStepDecreaseButtonCursorTargetComponent.onDownOnHover.add(this._setStepEditIntensity.bind(this,2,-1)),e.myScaleStepDecreaseButtonCursorTargetComponent.onUp.add(this._setStepEditIntensity.bind(this,2,0)),e.myScaleStepDecreaseButtonCursorTargetComponent.onUnhover.add(this._setStepEditIntensity.bind(this,2,0)),e.myScaleStepIncreaseButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myScaleStepIncreaseButtonBackgroundComponent.material)),e.myScaleStepIncreaseButtonCursorTargetComponent.onUnhover.add(this._genericUnhover.bind(this,e.myScaleStepIncreaseButtonBackgroundComponent.material)),e.myScaleStepDecreaseButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myScaleStepDecreaseButtonBackgroundComponent.material)),e.myScaleStepDecreaseButtonCursorTargetComponent.onUnhover.add(this._genericUnhover.bind(this,e.myScaleStepDecreaseButtonBackgroundComponent.material))}_setValueEditIntensity(e,t,n){if(this._isActive()||n==0){if(n!=0){switch(e){case 0:this._myValueRealValue=this._myVariable._myPosition[t],this._myComponentStepValue=this._myVariable._myPositionStepPerSecond;break;case 1:this._myValueRealValue=this._myVariable._myRotation[t],this._myComponentStepValue=this._myVariable._myRotationStepPerSecond;break;case 2:this._myValueRealValue=this._myVariable._myScale[t],this._myComponentStepValue=this._myVariable._myScaleStepPerSecond;break}this._myValueButtonEditIntensityTimer=this._myConfig.myButtonEditDelay,this._myValueEditIndex=t,this._myComponentIndex=e}this._myValueButtonEditIntensity=n}}_setStepEditIntensity(e,t){(this._isActive()||t==0)&&(t!=0&&(this._myStepButtonEditIntensityTimer=this._myConfig.myButtonEditDelay),this._myStepButtonEditIntensity=t,this._myStepIndex=e)}_setValueEditEnabled(e,t,n,o){if(this._isActive()||!o){if(o){switch(e){case 0:this._myValueRealValue=this._myVariable._myPosition[t],this._myComponentStepValue=this._myVariable._myPositionStepPerSecond;break;case 1:this._myValueRealValue=this._myVariable._myRotation[t],this._myComponentStepValue=this._myVariable._myRotationStepPerSecond;break;case 2:this._myValueRealValue=this._myVariable._myScale[t],this._myComponentStepValue=this._myVariable._myScaleStepPerSecond;break}this._myValueEditIndex=t,this._myComponentIndex=e,n.pp_scaleObject(this._myConfig.myTextHoverScaleMultiplier)}else n.pp_setScaleLocal(this._myConfig.myValueTextScale);this._myValueEditEnabled=o}}_setStepEditEnabled(e,t,n){(this._isActive()||!n)&&(n?t.pp_scaleObject(this._myConfig.myTextHoverScaleMultiplier):t.pp_setScaleLocal(this._myConfig.myStepTextScale),this._myStepEditEnabled=n,this._myStepIndex=e)}_resetValue(e,t){if(this._isActive()){switch(this._myTempPositionValue.pp_copy(this._myVariable._myPosition),this._myTempRotationValue.pp_copy(this._myVariable._myRotation),this._myTempScaleValue.pp_copy(this._myVariable._myScale),e){case 0:this._myTempPositionValue[t]=this._myVariable._myDefaultPosition[t],this._myUI.myPositionTextComponents[t].text=this._myTempPositionValue[t].toFixed(this._myVariable._myDecimalPlaces);break;case 1:this._myTempRotationValue[t]=this._myVariable._myDefaultRotation[t],this._myUI.myRotationTextComponents[t].text=this._myTempRotationValue[t].toFixed(this._myVariable._myDecimalPlaces);break;case 2:this._myTempScaleValue[t]=this._myVariable._myDefaultScale[t],this._myUI.myScaleTextComponents[t].text=this._myTempScaleValue[t].toFixed(this._myVariable._myDecimalPlaces);break}this._myTempTransformValue.mat4_setPositionRotationDegreesScale(this._myTempPositionValue,this._myTempRotationValue,this._myTempScaleValue),this._myVariable.setValue(this._myTempTransformValue)}}_resetAllValues(){for(let e=0;e<3;e++)this._resetComponentValues(e)}_resetComponentValues(e){for(let t=0;t<3;t++)this._resetValue(e,t)}_resetStep(e){if(this._isActive()){let t=0;switch(e){case 0:t=this._myVariable._myDefaultPositionStepPerSecond;break;case 1:t=this._myVariable._myDefaultRotationStepPerSecond;break;case 2:t=this._myVariable._myDefaultScaleStepPerSecond;break;default:t=0}this._changeStep(e,t)}}_changeStep(e,t){switch(t=Math.pp_roundDecimal(t,10),e){case 0:this._myVariable._myPositionStepPerSecond=t,this._myUI.myPositionStepTextComponent.text=this._myConfig.myStepStartString.concat(this._myVariable._myPositionStepPerSecond);break;case 1:this._myVariable._myRotationStepPerSecond=t,this._myUI.myRotationStepTextComponent.text=this._myConfig.myStepStartString.concat(this._myVariable._myRotationStepPerSecond);break;case 2:this._myVariable._myScaleStepPerSecond=t,this._myUI.myScaleStepTextComponent.text=this._myConfig.myStepStartString.concat(this._myVariable._myScaleStepPerSecond);break}}_genericTextHover(e){e.pp_scaleObject(this._myConfig.myTextHoverScaleMultiplier)}_genericTextUnhover(e,t){e.pp_setScaleLocal(t)}};var wa=class extends mn{constructor(){super(),this.myShowOnStart=!1,this.myShowVisibilityButton=!1,this.myShowAdditionalButtons=!1,this.myGamepadScrollVariableEnabled=!1,this.myShowVariablesImportExportButtons=!1,this.myVariablesImportCallback=null,this.myVariablesExportCallback=null}},ja=class{constructor(e=m.getMainEngine()){this._myStarted=!1,this._myStartVariable=null,this._myWidgetFrame=new yn("E",1,e),this._myWidgetFrame.registerWidgetVisibleChangedEventListener(this,this._widgetVisibleChanged.bind(this)),this._myConfig=new Ea,this._myParams=null,this._myWidgets=[],this._myEasyTuneVariables=null,this._myEasyTuneLastSize=0,this._myVariableNames=null,this._myCurrentWidget=null,this._myCurrentVariable=null,this._myScrollVariableTimer=0,this._myGamepad=null,this._myRefreshVariablesTimer=0,this._myDirty=!1,this._myEngine=e,this._myDestroyed=!1}setCurrentVariable(e){this._myStarted?this._myEasyTuneVariables.has(e)?(this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(e),this._selectCurrentWidget()):console.warn("Can't change easy tune current variable to inexistent variable:",e):this._myStartVariable=e}refresh(){this._myWidgetFrame.isVisible()&&(this._myDirty=!0)}setVisible(e){this._myWidgetFrame.setVisible(e)}isVisible(){return this._myWidgetFrame.isVisible()}start(e,t,n){this._myRightGamepad=m.getRightGamepad(this._myEngine),this._myLeftGamepad=m.getLeftGamepad(this._myEngine),this._myConfig.myGamepadHandedness==W.RIGHT?this._myGamepad=this._myRightGamepad:this._myConfig.myGamepadHandedness==W.LEFT&&(this._myGamepad=this._myLeftGamepad),this._myStarted=!0,this._myParams=t,this._myWidgetFrame.start(e,t),this._myEasyTuneVariables=n,this._myEasyTuneLastSize=this.getValidEasyTuneVariablesLength(),this._myVariableNames=this.getValidEasyTuneVariablesNames(),this.getValidEasyTuneVariablesLength()>0&&(this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(this._myVariableNames[0])),this._myStartVariable!=null&&(this._myEasyTuneVariables.has(this._myStartVariable)?this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(this._myStartVariable):console.warn("Can't change easy tune current variable to inexistent variable:",this._myStartVariable)),this._initializeWidgets()}update(e){this._myWidgetFrame.update(e),(this.getValidEasyTuneVariablesLength()!=this._myEasyTuneLastSize||this._myDirty)&&this._refreshEasyTuneVariables(),this._myWidgetFrame.isVisible()&&this.getValidEasyTuneVariablesLength()>0&&(this._myConfig.myRefreshVariablesDelay!=null&&(this._myRefreshVariablesTimer+=e,this._myRefreshVariablesTimer>this._myConfig.myRefreshVariablesDelay&&(this._myRefreshVariablesTimer=0,this._refreshEasyTuneVariables())),this._myCurrentWidget&&this._myCurrentWidget.update(e),this._myParams.myGamepadScrollVariableEnabled&&this._updateGamepadScrollVariable(e)),this._updateGamepadWidgetVisibility(),this._updateWidgetCurrentVariable()}_initializeWidgets(){let e=new Pa;e.myVariablesImportCallback=this._importVariables.bind(this),e.myVariablesExportCallback=this._exportVariables.bind(this),this._myWidgets[Yt.NONE]=new Va(e,this._myEngine),this._myWidgets[Yt.NUMBER]=new La(e,this._myGamepad,this._myEngine),this._myWidgets[Yt.BOOL]=new Da(e,this._myGamepad,this._myEngine),this._myWidgets[Yt.TRANSFORM]=new Fa(e,this._myGamepad,this._myEngine);for(let t of this._myWidgets)t!=null&&(t.start(this._myWidgetFrame.getWidgetObject(),this._myParams),t.setVisible(!1),t.registerScrollVariableRequestEventListener(this,this._scrollVariable.bind(this)));this._selectCurrentWidget()}_selectCurrentWidget(){if(this.getValidEasyTuneVariablesLength()<=0)return;this._myCurrentVariable==null&&(this._myVariableNames=this.getValidEasyTuneVariablesNames(),this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(this._myVariableNames[0]));let e=null;this._myCurrentWidget!=null&&(e=this._myCurrentWidget.getWidget()),this._myCurrentVariable.getType()in this._myWidgets?this._myCurrentWidget=this._myWidgets[this._myCurrentVariable.getType()]:this._myCurrentWidget=this._myWidgets[Yt.NONE],this._myCurrentWidget.setEasyTuneVariable(this._myCurrentVariable,this._createIndexString()),this._myCurrentWidget.getWidget().syncWidget(e),e?.setVisible(!1),this._myCurrentWidget.setVisible(this._myWidgetFrame.isVisible())}_refreshEasyTuneVariables(){this._myVariableNames=this.getValidEasyTuneVariablesNames(),this._myEasyTuneLastSize=this.getValidEasyTuneVariablesLength(),this.getValidEasyTuneVariablesLength()>0?(this._myCurrentVariable&&this._myVariableNames.pp_hasEqual(this._myCurrentVariable.getName())?this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(this._myCurrentVariable.getName()):this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(this._myVariableNames[0]),this._selectCurrentWidget()):(this._myCurrentVariable=null,this._myCurrentWidget&&(this._myCurrentWidget.setVisible(!1),this._myCurrentWidget=null)),this._myDirty=!1}_updateGamepadWidgetVisibility(){this._myGamepad&&(this._myGamepad.getButtonInfo(E.BOTTOM_BUTTON).isPressStart()&&this._myGamepad.getButtonInfo(E.TOP_BUTTON).isPressed()||this._myGamepad.getButtonInfo(E.TOP_BUTTON).isPressStart()&&this._myGamepad.getButtonInfo(E.BOTTOM_BUTTON).isPressed())&&this._toggleVisibility()}_toggleVisibility(){this._myWidgetFrame.toggleVisibility()}_widgetVisibleChanged(e){for(let t of this._myWidgets)t?.setVisible(!1);this._myCurrentWidget&&(this.getValidEasyTuneVariablesLength()>0?this._myCurrentWidget.setVisible(e):this._myCurrentWidget.setVisible(!1)),e&&this._refreshEasyTuneVariables()}_updateGamepadScrollVariable(e){if(this._myGamepad&&(!this._myConfig.myScrollVariableButtonID||this._myGamepad.getButtonInfo(this._myConfig.myScrollVariableButtonID).isPressed())){let t=this._myGamepad.getAxesInfo(ne.THUMBSTICK).myAxes[0],n=this._myGamepad.getAxesInfo(ne.THUMBSTICK).myAxes[1];if(Math.abs(t)>this._myConfig.myScrollVariableMinXThreshold&&Math.abs(n)<this._myConfig.myScrollVariableMaxYThreshold)for(this._myScrollVariableTimer+=e;this._myScrollVariableTimer>this._myConfig.myScrollVariableDelay;)this._myScrollVariableTimer-=this._myConfig.myScrollVariableDelay,this._scrollVariable(Math.sign(t));else this._myScrollVariableTimer=this._myConfig.myScrollVariableDelay}else this._myScrollVariableTimer=this._myConfig.myScrollVariableDelay}_scrollVariable(e){if(this.getValidEasyTuneVariablesLength()<=0)return;let t=this._getVariableIndex(this._myCurrentVariable);if(t>=0){let n=((t+e)%this._myVariableNames.length+this._myVariableNames.length)%this._myVariableNames.length;this._myEasyTuneVariables.has(this._myVariableNames[n])?(this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(this._myVariableNames[n]),this._selectCurrentWidget()):this._refreshEasyTuneVariables()}else this._refreshEasyTuneVariables()}_createIndexString(){let e=" (",t=(this._getVariableIndex(this._myCurrentVariable)+1).toString(),n=this.getValidEasyTuneVariablesLength().toString();for(;t.length<n.length;)t="0".concat(t);return e=e.concat(t).concat(" - ").concat(n).concat(")"),e}_getVariableIndex(e){return this._myVariableNames.indexOf(e.getName())}_updateWidgetCurrentVariable(){for(let e of this._myEasyTuneVariables.getEasyTuneVariablesList())e.setWidgetCurrentVariable(!1);this._myWidgetFrame.isVisible()&&this._myCurrentVariable&&this._myCurrentVariable.setWidgetCurrentVariable(!0)}_importVariables(){this._myParams.myVariablesImportCallback(this._onImportSuccess.bind(this),this._onImportFailure.bind(this))}_exportVariables(){this._myParams.myVariablesExportCallback(this._onExportSuccess.bind(this),this._onExportFailure.bind(this))}_onImportSuccess(){this._myCurrentWidget&&this._myCurrentWidget.onImportSuccess()}_onImportFailure(){this._myCurrentWidget&&this._myCurrentWidget.onImportFailure()}_onExportSuccess(){this._myCurrentWidget&&this._myCurrentWidget.onExportSuccess()}_onExportFailure(){this._myCurrentWidget&&this._myCurrentWidget.onExportFailure()}destroy(){this._myDestroyed=!0;for(let e of this._myWidgets)e.destroy();this._myWidgetFrame.destroy()}isDestroyed(){return this._myDestroyed}getValidEasyTuneVariablesLength(){return this.getValidEasyTuneVariablesNames().length}getValidEasyTuneVariablesNames(){let e=this._myEasyTuneVariables.getEasyTuneVariablesNames(),t=[];for(let n of e)this._myEasyTuneVariables.getEasyTuneVariable(n).shouldShowOnWidget()&&t.push(n);return t}};var Uo=class extends MV{static TypeName="pp-easy-tune-tool";static Properties={_myHandedness:Pi.enum(["None","Left","Right"],"None"),_myShowOnStart:Pi.bool(!1),_myShowVisibilityButton:Pi.bool(!1),_myGamepadScrollVariableEnabled:Pi.bool(!0),_myShowVariablesImportExportButtons:Pi.bool(!1),_myVariablesImportURL:Pi.string(""),_myVariablesExportURL:Pi.string(""),_myImportVariablesOnStart:Pi.bool(!1),_myResetVariablesDefaultValueOnImport:Pi.bool(!1)};init(){this.object.pp_addComponent(li),this._myWidget=new ja(this.engine),He.addSetWidgetCurrentVariableCallback(this,function(e){this._myWidget.setCurrentVariable(e)}.bind(this),this.engine),He.addRefreshWidgetCallback(this,function(){this._myWidget.refresh()}.bind(this),this.engine),this._myStarted=!1}start(){if(m.isToolEnabled(this.engine)){let e=new wa;e.myHandedness=[null,"left","right"][this._myHandedness],e.myShowOnStart=this._myShowOnStart,e.myShowVisibilityButton=this._myShowVisibilityButton,e.myShowAdditionalButtons=!0,e.myGamepadScrollVariableEnabled=this._myGamepadScrollVariableEnabled,e.myPlaneMaterial=m.getDefaultMaterials(this.engine).myFlatOpaque.clone(),e.myTextMaterial=m.getDefaultMaterials(this.engine).myText.clone(),e.myShowVariablesImportExportButtons=this._myShowVariablesImportExportButtons,e.myVariablesImportCallback=function(t,n){He.importVariables(this._myVariablesImportURL,this._myResetVariablesDefaultValueOnImport,t,n,this.engine)}.bind(this),e.myVariablesExportCallback=function(t,n){He.exportVariables(this._myVariablesExportURL,t,n,this.engine)}.bind(this),this._myWidget.start(this.object,e,m.getEasyTuneVariables(this.engine)),this._myWidgetVisibleBackup=null,this._myStarted=!0,this._myFirstUpdate=!0}}update(e){m.isToolEnabled(this.engine)?this._myStarted&&(this._myFirstUpdate&&(this._myFirstUpdate=!1,this._myImportVariablesOnStart&&He.importVariables(this._myVariablesImportURL,this._myResetVariablesDefaultValueOnImport,void 0,void 0,this.engine)),this._myWidgetVisibleBackup!=null&&(this._myWidget.setVisible(!1),this._myWidget.setVisible(this._myWidgetVisibleBackup),this._myWidgetVisibleBackup=null),this._myWidget.update(e)):this._myStarted&&(this._myWidgetVisibleBackup==null&&(this._myWidgetVisibleBackup=this._myWidget.isVisible()),this._myWidget.isVisible()&&this._myWidget.setVisible(!1))}onDeactivate(){this._myStarted&&(this._myWidgetVisibleBackup==null&&(this._myWidgetVisibleBackup=this._myWidget.isVisible()),this._myWidget.isVisible()&&this._myWidget.setVisible(!1))}onDestroy(){this._myWidget.destroy(),He.removeSetWidgetCurrentVariableCallback(this,this.engine),He.removeRefreshWidgetCallback(this,this.engine)}};import{Component as DV,Property as Ub}from"@wonderlandengine/api";var Wo=class extends DV{static TypeName="pp-easy-tune-import-variables";static Properties={_myVariablesImportURL:Ub.string(""),_myResetVariablesDefaultValueOnImport:Ub.bool(!0)};start(){this._myFirstUpdate=!0}update(e){this._myFirstUpdate&&(this._myFirstUpdate=!1,He.importVariables(this._myVariablesImportURL,this._myResetVariablesDefaultValueOnImport,void 0,void 0,this.engine))}};var it=class{constructor(e,t,n,o,s=m.getMainEngine()){this._myObject=e,this._myUseTuneTarget=o,this._mySetAsWidgetCurrentVariable=n,this._myEasyObject=this._myObject,this._myUseTuneTarget&&(this._myEasyObject=m.getEasyTuneTarget(s)),this._myPrevEasyObject=null;let a=this._getVariableNamePrefix();if(t==""){let l=this._myObject.pp_getName();l!=""?this._myEasyTuneVariableName=a.concat(l):this._myEasyTuneVariableName=a.concat(this._myObject.pp_getID())}else this._myEasyTuneVariableName=a.concat(t);this._myEngine=s}start(){let e=this._createEasyTuneVariable(this._myEasyTuneVariableName);m.getEasyTuneVariables(this._myEngine).add(e),this._mySetAsWidgetCurrentVariable&&He.setWidgetCurrentVariable(this._myEasyTuneVariableName,this._myEngine)}update(e){if(m.getEasyTuneVariables(this._myEngine).isWidgetCurrentVariable(this._myEasyTuneVariableName)){if(this._myUseTuneTarget&&(this._myEasyObject=m.getEasyTuneTarget(this._myEngine)),this._myPrevEasyObject!=this._myEasyObject)if(this._myPrevEasyObject=this._myEasyObject,this._myEasyObject){let t=this._getObjectValue(this._myEasyObject);m.getEasyTuneVariables(this._myEngine).set(this._myEasyTuneVariableName,t,!0)}else{let t=this._getDefaultValue();m.getEasyTuneVariables(this._myEngine).set(this._myEasyTuneVariableName,t,!0)}this._myEasyObject&&this._updateObjectValue(this._myEasyObject,m.getEasyTuneVariables(this._myEngine).get(this._myEasyTuneVariableName))}}};import{LightComponent as Wb}from"@wonderlandengine/api";var za=class extends it{constructor(e,t,n,o){super(e,t,n,o)}_getVariableNamePrefix(){return"Light Attenuation "}_createEasyTuneVariable(e){return new Vi(e,this._getDefaultValue(),null,!0,3,.01,0,1)}_getObjectValue(e){return this._getLightAttenuation(e)}_getDefaultValue(){return 0}_updateObjectValue(e,t){let n=t,o=e.pp_getComponent(Wb);o&&(o.color[3]=n)}_getLightAttenuation(e){let t=this._getDefaultValue(),n=e.pp_getComponent(Wb);return n&&(t=n.color[3]),t}};import{LightComponent as Qb}from"@wonderlandengine/api";var Ga=class extends it{constructor(e,t,n,o,s,a){super(t,n,o,s,a),this._myColorModel=e}_getVariableNamePrefix(){let e=null;return this._myColorModel==0?e="Light RGB ":e="Light HSV ",e}_createEasyTuneVariable(e){return new Ti(e,this._getDefaultValue(),null,!0,100,0,255)}_getObjectValue(e){let t=null,n=this._getLightColor(e);return n?this._myColorModel==0?t=he.rgbCodeToHuman(n):t=he.hsvCodeToHuman(he.rgbToHSV(n)):t=this._getDefaultValue(),t}_getDefaultValue(){return p()}_updateObjectValue(e,t){let n=t;this._myColorModel==0?n=he.rgbHumanToCode(n):n=he.hsvToRGB(he.hsvHumanToCode(n));let o=e.pp_getComponent(Qb);if(o!=null&&(o.color[0]=n[0],o.color[1]=n[1],o.color[2]=n[2]),m.getRightGamepad(this._myEngine).getButtonInfo(E.TOP_BUTTON).isPressStart()&&m.getLeftGamepad(this._myEngine).getButtonInfo(E.TOP_BUTTON).isPressed()||m.getLeftGamepad(this._myEngine).getButtonInfo(E.TOP_BUTTON).isPressStart()&&m.getRightGamepad(this._myEngine).getButtonInfo(E.TOP_BUTTON).isPressed()){let s=he.color1To255(he.rgbToHSV(n)),a=he.color1To255(n);console.log("RGB:",a.vec_toString(0),"- HSV:",s.vec_toString(0))}}_getLightColor(e){let t=null,n=e.pp_getComponent(Qb);return n&&(t=n.color.slice(0,3)),t}};import{MeshComponent as EV}from"@wonderlandengine/api";var Na=class extends it{constructor(e,t,n,o,s,a,l){super(n,o,s,a,l),this._myColorModel=e,this._myColorType=t,this._myColorVariableNames=["color","diffuseColor","ambientColor","specularColor","emissiveColor","fogColor","ambientFactor"]}_getVariableNamePrefix(){let e=null;return this._myColorModel==0?e="Mesh RGB ":e="Mesh HSV ",e}_createEasyTuneVariable(e){return this._myColorType==6?new fi(e,this._getDefaultValue(),null,!0,3,.1,0,1):new Ti(e,this._getDefaultValue(),null,!0,100,0,255)}_getObjectValue(e){let t=null,n=this._getMeshMaterial(e);return n?this._myColorType!=6?(t=n[this._myColorVariableNames[this._myColorType]].pp_clone(),this._myColorModel==0?t=he.rgbCodeToHuman(t):t=he.hsvCodeToHuman(he.rgbToHSV(t))):t=[n[this._myColorVariableNames[this._myColorType]]]:t=this._getDefaultValue(),t}_getDefaultValue(){return this._myColorType==6?[0]:F()}_updateObjectValue(e,t){let n=t;this._myColorType!=6&&(this._myColorModel==0?n=he.rgbHumanToCode(n):n=he.hsvToRGB(he.hsvHumanToCode(n)));let o=this._getMeshMaterial(e);if(o&&(o[this._myColorVariableNames[this._myColorType]]=n),this._myColorType!=6&&(m.getRightGamepad(this._myEngine).getButtonInfo(E.TOP_BUTTON).isPressStart()&&m.getLeftGamepad(this._myEngine).getButtonInfo(E.TOP_BUTTON).isPressed()||m.getLeftGamepad(this._myEngine).getButtonInfo(E.TOP_BUTTON).isPressStart()&&m.getRightGamepad(this._myEngine).getButtonInfo(E.TOP_BUTTON).isPressed())){let s=he.color1To255(he.rgbToHSV(n)),a=he.color1To255(n);console.log("RGB:",a.vec_toString(0),"- HSV:",s.vec_toString(0))}}_getMeshMaterial(e){let t=null,n=e.pp_getComponent(EV);return n&&(t=n.material),t}};var Ua=class extends it{constructor(e,t,n,o,s,a,l){super(n,o,s,a,l),this._myLocal=e,this._myScaleAsOne=t}_getVariableNamePrefix(){return"Scale "}_createEasyTuneVariable(e){return new fi(e,this._getDefaultValue(),null,!0,3,1,.001,null,this._myScaleAsOne)}_getObjectValue(e){return this._myLocal?e.pp_getScaleLocal():e.pp_getScale()}_getDefaultValue(){return p(1,1,1)}_updateObjectValue(e,t){this._myLocal?e.pp_setScaleLocal(t):e.pp_setScale(t)}};var Wa=class extends it{constructor(e,t,n,o,s,a,l){super(n,o,s,a,l),this._myLocal=e,this._myScaleAsOne=t}_getVariableNamePrefix(){return"Transform "}_createEasyTuneVariable(e){return new Ta(e,this._getDefaultValue(),null,!0,this._myScaleAsOne,3)}_getObjectValue(e){return this._myLocal?e.pp_getTransformLocal():e.pp_getTransform()}_getDefaultValue(){return be()}_updateObjectValue(e,t){this._myLocal?e.pp_setTransformLocal(t):e.pp_setTransform(t)}};import{MeshComponent as AV}from"@wonderlandengine/api";var Qa=class extends it{constructor(e,t,n,o,s){super(e,t,n,o,s)}_getVariableNamePrefix(){let e=null;return this._myColorModel==0,e="Mesh AF ",e}_createEasyTuneVariable(e){return new Vi(e,this._getDefaultValue(),null,!0,3,.1,0,1)}_getObjectValue(e){let t=null,n=this._getMeshMaterial(e);return n?t=n.ambientFactor:t=this._getDefaultValue(),t}_getDefaultValue(){return 0}_updateObjectValue(e,t){let n=t,o=this._getMeshMaterial(e);o&&(o.ambientFactor=n)}_getMeshMaterial(e){let t=null,n=e.pp_getComponent(AV);return n&&(t=n.material),t}};import{TextComponent as RV}from"@wonderlandengine/api";var qa=class extends it{constructor(e,t,n,o,s,a,l){super(n,o,s,a,l),this._myColorModel=e,this._myColorType=t,this._myColorVariableNames=["color","effectColor"]}_getVariableNamePrefix(){let e=null;return this._myColorModel==0?e="Text RGB ":e="Text HSV ",e}_createEasyTuneVariable(e){return new Ti(e,this._getDefaultValue(),null,!0,100,0,255)}_getObjectValue(e){let t=null,n=this._getTextMaterial(e);return n?(t=n[this._myColorVariableNames[this._myColorType]].pp_clone(),this._myColorModel==0?t=he.rgbCodeToHuman(t):t=he.hsvCodeToHuman(he.rgbToHSV(t))):t=this._getDefaultValue(),t}_getDefaultValue(){return F()}_updateObjectValue(e,t){let n=t;this._myColorModel==0?n=he.rgbHumanToCode(n):n=he.hsvToRGB(he.hsvHumanToCode(n));let o=this._getTextMaterial(e);if(o&&(o[this._myColorVariableNames[this._myColorType]]=n),m.getRightGamepad(this._myEngine).getButtonInfo(E.TOP_BUTTON).isPressStart()&&m.getLeftGamepad(this._myEngine).getButtonInfo(E.TOP_BUTTON).isPressed()||m.getLeftGamepad(this._myEngine).getButtonInfo(E.TOP_BUTTON).isPressStart()&&m.getRightGamepad(this._myEngine).getButtonInfo(E.TOP_BUTTON).isPressed()){let s=he.color1To255(he.rgbToHSV(n)),a=he.color1To255(n);console.log("RGB:",a.vec_toString(0),"- HSV:",s.vec_toString(0))}}_getTextMaterial(e){let t=null,n=e.pp_getComponent(RV);return n&&(t=n.material),t}};import{Component as VV,Property as dm}from"@wonderlandengine/api";var Qo=class extends VV{static TypeName="pp-easy-light-attenuation";static Properties={_myVariableName:dm.string(""),_mySetAsWidgetCurrentVariable:dm.bool(!1),_myUseTuneTarget:dm.bool(!1)};init(){this._myEasyObjectTuner=null,m.isToolEnabled(this.engine)&&(this._myEasyObjectTuner=new za(this.object,this._myVariableName,this._mySetAsWidgetCurrentVariable,this._myUseTuneTarget))}start(){m.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.start()}update(e){m.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.update(e)}};import{Component as OV,Property as Kr}from"@wonderlandengine/api";var qo=class extends OV{static TypeName="pp-easy-light-color";static Properties={_myVariableName:Kr.string(""),_mySetAsWidgetCurrentVariable:Kr.bool(!1),_myUseTuneTarget:Kr.bool(!1),_myColorModel:Kr.enum(["RGB","HSV"],"HSV")};init(){this._myEasyObjectTuner=null,m.isToolEnabled(this.engine)&&(this._myEasyObjectTuner=new Ga(this._myColorModel,this.object,this._myVariableName,this._mySetAsWidgetCurrentVariable,this._myUseTuneTarget))}start(){m.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.start()}update(e){m.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.update(e)}};import{Component as IV,Property as _m}from"@wonderlandengine/api";var Xo=class extends IV{static TypeName="pp-easy-mesh-ambient-factor";static Properties={_myVariableName:_m.string(""),_myUseTuneTarget:_m.bool(!1),_mySetAsWidgetCurrentVariable:_m.bool(!1)};init(){this._myEasyObjectTuner=null,m.isToolEnabled(this.engine)&&(this._myEasyObjectTuner=new Qa(this.object,this._myVariableName,this._mySetAsWidgetCurrentVariable,this._myUseTuneTarget))}start(){m.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.start()}update(e){m.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.update(e)}pp_clone(e){return j.cloneDefault(this,e)}};import{Component as BV,Property as Xa}from"@wonderlandengine/api";var Ko=class extends BV{static TypeName="pp-easy-mesh-color";static Properties={_myVariableName:Xa.string(""),_myUseTuneTarget:Xa.bool(!1),_mySetAsWidgetCurrentVariable:Xa.bool(!1),_myColorModel:Xa.enum(["RGB","HSV"],"HSV"),_myColorType:Xa.enum(["Color","Diffuse Color","Ambient Color","Specular Color","Emissive Color","Fog Color","Ambient Factor"],"Color")};init(){this._myEasyObjectTuner=null,m.isToolEnabled(this.engine)&&(this._myEasyObjectTuner=new Na(this._myColorModel,this._myColorType,this.object,this._myVariableName,this._mySetAsWidgetCurrentVariable,this._myUseTuneTarget))}start(){m.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.start()}update(e){m.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.update(e)}pp_clone(e){return j.cloneDefault(this,e)}};import{Component as LV,Property as Ka}from"@wonderlandengine/api";var Jo=class extends LV{static TypeName="pp-easy-scale";static Properties={_myVariableName:Ka.string(""),_mySetAsWidgetCurrentVariable:Ka.bool(!1),_myUseTuneTarget:Ka.bool(!1),_myLocal:Ka.bool(!1),_myScaleAsOne:Ka.bool(!0)};init(){this._myEasyObjectTuner=null,m.isToolEnabled(this.engine)&&(this._myEasyObjectTuner=new Ua(this._myLocal,this._myScaleAsOne,this.object,this._myVariableName,this._mySetAsWidgetCurrentVariable,this._myUseTuneTarget))}start(){m.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.start()}update(e){m.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.update(e)}};import{Component as HV,Property as qb}from"@wonderlandengine/api";var Zo=class extends HV{static TypeName="pp-easy-set-tune-target-child-number";static Properties={_myVariableName:qb.string(""),_mySetAsWidgetCurrentVariable:qb.bool(!1)};start(){if(m.isToolEnabled(this.engine)){this._myEasyTuneVariableName="Target Child ",this._myVariableName==""?this._myEasyTuneVariableName=this._myEasyTuneVariableName.concat(this.object.pp_getID()):this._myEasyTuneVariableName=this._myEasyTuneVariableName.concat(this._myVariableName);let e=this.object.pp_getChildren().length,t=1,n=e;e==0&&(t=0,n=0),m.getEasyTuneVariables(this.engine).add(new fa(this._myEasyTuneVariableName,0,null,!0,10,t,n)),this._mySetAsWidgetCurrentVariable&&He.setWidgetCurrentVariable(this._myEasyTuneVariableName,this.engine),this._myCurrentChildIndex=-1,this._myCurrentChildrenCount=e,this._myEasyTuneTarget=null}}update(e){if(m.isToolEnabled(this.engine)&&m.getEasyTuneVariables(this.engine).isWidgetCurrentVariable(this._myEasyTuneVariableName)){let t=this.object.pp_getChildren().length;if(t!=this._myCurrentChildrenCount){this._myCurrentChildrenCount=t;let o=1,s=t;t==0&&(o=0,s=0);let a=m.getEasyTuneVariables(this.engine).getEasyTuneVariable(this._myEasyTuneVariableName);a.setMin(o),a.setMax(s)}let n=m.getEasyTuneVariables(this.engine).get(this._myEasyTuneVariableName);n!=this._myCurrentChildIndex&&(n==0&&this._myCurrentChildIndex!=-1?(m.getEasyTuneTarget(this.engine)==this._myEasyTuneTarget&&m.removeEasyTuneTarget(this.engine),this._myEasyTuneTarget=null):n>0&&(this._myEasyTuneTarget=this.object.pp_getChildren()[n-1],m.setEasyTuneTarget(this._myEasyTuneTarget,this.engine)),this._myCurrentChildIndex=n)}}};import{Component as kV}from"@wonderlandengine/api";var Yo=class extends kV{static TypeName="pp-easy-set-tune-target-grab";static Properties={};start(){this._myGrabber=null,m.isToolEnabled(this.engine)&&(this._myGrabber=this.object.pp_getComponent(wi),this._myEasyTuneTarget=null)}_onRelease(e,t){m.isToolEnabled(this.engine)&&(this._myEasyTuneTarget=t.object,m.setEasyTuneTarget(this._myEasyTuneTarget,this.engine))}_onGrab(e,t){m.isToolEnabled(this.engine)&&(m.getEasyTuneTarget(this.engine)==this._myEasyTuneTarget&&m.removeEasyTuneTarget(this.engine),this._myEasyTuneTarget=null)}onActivate(){this._myGrabber!=null&&this._myGrabber.registerThrowEventListener(this,this._onRelease.bind(this))}onDeactivate(){this._myGrabber!=null&&this._myGrabber.unregisterThrowEventListener(this)}};import{Component as FV,Property as Ja}from"@wonderlandengine/api";var $o=class extends FV{static TypeName="pp-easy-text-color";static Properties={_myVariableName:Ja.string(""),_mySetAsWidgetCurrentVariable:Ja.bool(!1),_myUseTuneTarget:Ja.bool(!1),_myColorModel:Ja.enum(["RGB","HSV"],"HSV"),_myColorType:Ja.enum(["Color","Effect Color"],"Color")};init(){this._myEasyObjectTuner=null,m.isToolEnabled(this.engine)&&(this._myEasyObjectTuner=new qa(this._myColorModel,this._myColorType,this.object,this._myVariableName,this._mySetAsWidgetCurrentVariable,this._myUseTuneTarget))}start(){m.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.start()}update(e){m.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.update(e)}};import{Component as wV,Property as Za}from"@wonderlandengine/api";var es=class extends wV{static TypeName="pp-easy-transform";static Properties={_myVariableName:Za.string(""),_mySetAsWidgetCurrentVariable:Za.bool(!1),_myUseTuneTarget:Za.bool(!1),_myLocal:Za.bool(!0),_myScaleAsOne:Za.bool(!0)};init(){this._myEasyObjectTuner=null,m.isToolEnabled(this.engine)&&(this._myEasyObjectTuner=new Wa(this._myLocal,this._myScaleAsOne,this.object,this._myVariableName,this._mySetAsWidgetCurrentVariable,this._myUseTuneTarget))}start(){m.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.start()}update(e){m.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.update(e)}pp_clone(e){return j.cloneDefault(this,e)}};export{ki as AddPPToWindowComponent,Bi as AddWLToWindowComponent,So as AdjustHierarchyPhysXScaleComponent,hR as AnalyticsUtils,X as ArrayUtils,ns as AudioEvent,os as AudioManager,ii as AudioManagerComponent,Gi as AudioPlayer,An as AudioSetup,WA as AudioUtils,cs as BaseGamepad,Ge as BasePose,xt as BasePoseParams,To as BenchmarkMaxPhysXComponent,Po as BenchmarkMaxVisibleTrianglesComponent,ti as BrowserUtils,Vo as CADisplayLeaderboardComponent,Vs as CADummyServer,Fe as CAError,pe as CAUtils,ks as CharacterColliderAdditionalParams,Fs as CharacterColliderDebugParams,Is as CharacterColliderHorizontalCheckParams,mb as CharacterColliderHorizontalPositionVerticalCheckDirection,tn as CharacterColliderSetup,nn as CharacterColliderSetupSimplifiedCreationAccuracyLevel,js as CharacterColliderSetupSimplifiedCreationParams,rm as CharacterColliderSetupUtils,ws as CharacterColliderSlideFlickerPreventionMode,Hs as CharacterColliderSplitMovementParams,$n as CharacterColliderSurfaceParams,Bs as CharacterColliderVerticalCheckParams,Ls as CharacterColliderWallSlideParams,Kn as CharacterCollisionCheckTransformResults,Ai as CharacterCollisionCheckType,Zn as CharacterCollisionDebugResults,Yn as CharacterCollisionInternalResults,Ei as CharacterCollisionMovementResults,Ue as CharacterCollisionResults,Jn as CharacterCollisionSplitMovementResults,$i as CharacterCollisionSurfaceInfo,en as CharacterCollisionSurfaceResults,eo as CharacterCollisionSystem,Oo as CharacterCollisionSystemComponent,Xn as CharacterCollisionTeleportResults,qn as CharacterCollisionTransformResults,Qn as CharacterCollisionWallSlideResults,Vn as ClassicGamepadCore,Co as ClearConsoleOnXRSessionStartComponent,jt as CloneParams,N as CollisionCheck,Q as CollisionCheckBridge,et as CollisionCheckParams,Os as CollisionCheckUtils,de as CollisionRuntimeParams,he as ColorUtils,j as ComponentUtils,Ee as ConsoleOriginalFunctions,fs as ConsoleVR,No as ConsoleVRToolComponent,da as ConsoleVRWidget,la as ConsoleVRWidgetConfig,re as ConsoleVRWidgetConsoleFunction,pa as ConsoleVRWidgetMessage,H as ConsoleVRWidgetMessageType,ca as ConsoleVRWidgetParams,ra as ConsoleVRWidgetPulseOnNewMessage,Ie as ConsoleVRWidgetSender,ya as ConsoleVRWidgetUI,wo as CopyHandTransformComponent,jo as CopyHeadTransformComponent,zo as CopyPlayerTransformComponent,Go as CopyReferenceSpaceTransformComponent,co as CustomCloneParams,Do as DebugArrayFunctionsPerformanceAnalyzerComponent,Un as DebugFunctionPerformanceAnalysisResults,Nn as DebugFunctionsOverwriter,Gn as DebugFunctionsOverwriterParams,As as DebugFunctionsPerformanceAnalysisResultsLogger,Es as DebugFunctionsPerformanceAnalysisResultsLoggerParams,Ds as DebugFunctionsPerformanceAnalyzer,mt as DebugFunctionsPerformanceAnalyzerComponent,Wn as DebugFunctionsPerformanceAnalyzerParams,Lt as DebugFunctionsPerformanceAnalyzerSortOrder,ls as DebugManager,si as DebugManagerComponent,Eo as DebugPPArrayCreationPerformanceAnalyzerComponent,Mo as DebugPPFunctionsPerformanceAnalyzerComponent,xo as DebugTransformComponent,Di as DebugVisualManager,Ro as DebugWLComponentsFunctionsPerformanceAnalyzerComponent,Ao as DebugWLFunctionsPerformanceAnalyzerComponent,zt as DeepCloneParams,is as DefaultResources,Dr as DefaultResourcesMaterials,Mr as DefaultResourcesMeshes,Cn as DefaultWLComponentCloneCallbacks,Kt as Direction2DTo3DConverter,Yi as Direction2DTo3DConverterParams,nr as EPSILON,km as EPSILON_DEGREES,Hm as EPSILON_SQUARED,ue as EasingFunction,za as EasyLightAttenuation,Qo as EasyLightAttenuationComponent,Ga as EasyLightColor,qo as EasyLightColorComponent,Qa as EasyMeshAmbientFactor,Xo as EasyMeshAmbientFactorComponent,Na as EasyMeshColor,Ko as EasyMeshColorComponent,it as EasyObjectTuner,Ua as EasyScale,Jo as EasyScaleComponent,Yo as EasySetTuneTargeetGrabComponent,Zo as EasySetTuneTargetChildNumberComponent,qa as EasyTextColor,$o as EasyTextColorComponent,Wa as EasyTransform,es as EasyTransformComponent,pn as EasyTuneBaseArrayWidgetSelector,kt as EasyTuneBaseWidget,Ft as EasyTuneBaseWidgetConfig,Pa as EasyTuneBaseWidgetParams,wt as EasyTuneBaseWidgetUI,um as EasyTuneBool,qr as EasyTuneBoolArray,Ma as EasyTuneBoolArrayWidget,Ca as EasyTuneBoolArrayWidgetConfig,Da as EasyTuneBoolArrayWidgetSelector,xa as EasyTuneBoolArrayWidgetUI,Wo as EasyTuneImportVariablesComponent,fa as EasyTuneInt,Ti as EasyTuneIntArray,Va as EasyTuneNoneWidget,Aa as EasyTuneNoneWidgetConfig,Ra as EasyTuneNoneWidgetUI,Vi as EasyTuneNumber,fi as EasyTuneNumberArray,Ba as EasyTuneNumberArrayWidget,Oa as EasyTuneNumberArrayWidgetConfig,La as EasyTuneNumberArrayWidgetSelector,Ia as EasyTuneNumberArrayWidgetUI,Uo as EasyTuneToolComponent,Ta as EasyTuneTransform,Fa as EasyTuneTransformWidget,Ha as EasyTuneTransformWidgetConfig,ka as EasyTuneTransformWidgetUI,He as EasyTuneUtils,ga as EasyTuneVariable,cn as EasyTuneVariableArray,Yt as EasyTuneVariableType,Ts as EasyTuneVariables,ja as EasyTuneWidget,Ea as EasyTuneWidgetConfig,wa as EasyTuneWidgetParams,Li as EnableDebugComponent,Hi as EnableToolComponent,ct as FSM,ji as FingerCursorComponent,Qt as GamepadAxesEvent,ne as GamepadAxesID,ys as GamepadAxesInfo,ae as GamepadButtonEvent,E as GamepadButtonID,ms as GamepadButtonInfo,Ho as GamepadControlSchemeComponent,It as GamepadCore,xn as GamepadMeshAnimatorComponent,us as GamepadPulseInfo,XR as GamepadUtils,ps as GamepadsManager,mi as GetDefaultResourcesComponent,yi as GetSceneObjectsComponent,m as Globals,Fi as GrabbableComponent,wi as GrabberHandComponent,Xi as HandPose,qi as HandPoseParams,A as Handedness,vi as HandednessIndex,ds as HeadPose,Xl as HowlerAudioPlayer,ri as InitConsoleVRComponent,li as InitEasyTuneVariablesComponent,gs as InputManager,ai as InputManagerComponent,lt as InputSourceType,ie as InputUtils,im as IntOverFactor,nm as IntRangeOverFactor,Y as JSUtils,$ as KeyID,hs as Keyboard,On as KeyboardGamepadCore,K as Mat3Utils,R as Mat4Utils,xs as MaterialUtils,B as MathUtils,Pn as MeshCreationParams,Si as MeshCreationTriangleParams,Tn as MeshCreationVertexParams,Re as MeshUtils,_s as Mouse,ci as MouseButtonID,go as MuteEverythingComponent,_i as NumberOverFactor,Fr as NumberRangeOverFactor,Ui as ObjectPool,ss as ObjectPoolManager,ni as ObjectPoolManagerComponent,Ni as ObjectPoolParams,c as ObjectUtils,_o as PPGatewayComponent,Cs as PerformDelayedMode,di as PerformMode,Xt as PhysicsCollisionCollector,Ve as PhysicsLayerFlags,De as PhysicsUtils,se as PlayerHeadManager,to as PlayerHeadManagerParams,$s as PlayerLocomotion,Io as PlayerLocomotionComponent,Gr as PlayerLocomotionDirectionReferenceType,on as PlayerLocomotionMovement,Ns as PlayerLocomotionMovementRuntimeParams,Ys as PlayerLocomotionParams,gi as PlayerLocomotionRotate,Gs as PlayerLocomotionRotateParams,Zt as PlayerLocomotionSmooth,ea as PlayerLocomotionSmoothParams,io as PlayerLocomotionTeleport,qs as PlayerLocomotionTeleportDetectionParams,jr as PlayerLocomotionTeleportDetectionRuntimeParams,pt as PlayerLocomotionTeleportDetectionState,Ri as PlayerLocomotionTeleportDetectionVisualizer,Qs as PlayerLocomotionTeleportDetectionVisualizerParams,Ht as PlayerLocomotionTeleportParable,Zs as PlayerLocomotionTeleportParams,zr as PlayerLocomotionTeleportRuntimeParams,Pt as PlayerLocomotionTeleportState,Xs as PlayerLocomotionTeleportTeleportBlinkState,Ks as PlayerLocomotionTeleportTeleportParams,sn as PlayerLocomotionTeleportTeleportShiftState,Js as PlayerLocomotionTeleportTeleportState,an as PlayerLocomotionTeleportTeleportType,lm as PlayerLocomotionType,xr as PlayerObjects,Ws as PlayerObscureManager,Us as PlayerObscureManagerParams,tt as PlayerTransformManager,zs as PlayerTransformManagerParams,ce as PlayerTransformManagerSyncFlag,xe as PluginUtils,V as Quat2Utils,T as QuatUtils,st as RaycastHit,ut as RaycastParams,ke as RaycastResults,Zl as SaveManager,Bt as SaveUtils,ts as SceneObjects,Z as SceneUtils,bo as SetActiveComponent,Mn as SetHandLocalTransformComponent,zi as SetHeadLocalTransformComponent,Fo as SetPlayerHeightComponent,Dn as SetTrackedHandJointLocalTransformComponent,vo as ShowFPSComponent,Fn as SkipStateFunction,fo as SpatialAudioListenerComponent,Zi as State,wn as StateData,Bo as SwitchHandObjectComponent,uR as TextUtils,te as Timer,Ss as TimerState,En as ToolCursorComponent,W as ToolHandedness,Ae as ToolInputSourceType,Lo as TrackedHandDrawAllJointsComponent,xi as TrackedHandDrawJointComponent,vn as TrackedHandDrawSkinComponent,ot as TrackedHandJointID,bn as TrackedHandJointIDIndex,Ln as TrackedHandJointPose,Hn as TrackedHandPose,Ki as TrackedHandPoseParams,$l as Transition,jn as TransitionData,Bn as UniversalGamepad,nt as Vec2Utils,d as Vec3Utils,Nt as Vec4Utils,gt as VecUtils,sa as VirtualGamepad,Mt as VirtualGamepadButtonParams,ko as VirtualGamepadComponent,no as VirtualGamepadGamepadCore,rn as VirtualGamepadIcon,oo as VirtualGamepadIconParams,Oe as VirtualGamepadIconType,ln as VirtualGamepadParams,ia as VirtualGamepadThumbstickParams,na as VirtualGamepadVirtualButton,oa as VirtualGamepadVirtualThumbstick,yt as VisualArrow,ze as VisualArrowParams,Me as VisualElementType,St as VisualLine,Ze as VisualLineParams,Qi as VisualManager,oi as VisualManagerComponent,Wi as VisualMesh,Ut as VisualMeshParams,ui as VisualPoint,vt as VisualPointParams,as as VisualRaycast,Wt as VisualRaycastParams,rs as VisualResources,Ar as VisualResourcesMaterials,Rn as VisualText,Vt as VisualTextParams,hi as VisualTorus,Ot as VisualTorusParams,Mi as VisualTransform,At as VisualTransformParams,yn as WidgetFrame,ua as WidgetFrameConfig,ha as WidgetFrameUI,mn as WidgetParams,In as XRGamepadCore,O as XRUtils,Fy as add,zd as addComponent,ml as addEngine,jb as addRefreshWidgetCallback,Fb as addSetWidgetCurrentVariableCallback,Iy as angle,$m as angleClamp,ey as angleClampDegrees,ty as angleClampRadians,By as angleDegrees,qm as angleDistance,Xm as angleDistanceDegrees,Km as angleDistanceRadians,Jm as angleDistanceSigned,Zm as angleDistanceSignedDegrees,Ym as angleDistanceSignedRadians,Zy as anglePivoted,Yy as anglePivotedDegrees,$y as anglePivotedRadians,eu as anglePivotedSigned,tu as anglePivotedSignedDegrees,iu as anglePivotedSignedRadians,Ly as angleRadians,Xy as angleSigned,Ky as angleSignedDegrees,Jy as angleSignedRadians,Tb as areButtonsPressEnd,fb as areButtonsPressStart,Sb as areButtonsTouchEnd,Cb as areButtonsTouchStart,UP as assert,Wf as ceil,tb as checkMovement,ib as checkTeleportToTransform,nb as checkTransform,oT as cleanObjectProperties,fT as cloneCollision,FT as cloneDefault,gT as cloneMesh,PT as clonePhysX,kT as clonePostProcess,TT as cloneText,dC as color1To255,pC as color255To1,su as componentAlongAxis,lb as convertCharacterColliderSetupToCollisionCheckParams,ab as convertCharacterCollisionResultsToCollisionRuntimeParams,rb as convertCollisionRuntimeParamsToCharacterCollisionResults,bd as convertDirectionLocalToObject,_d as convertDirectionLocalToWorld,Pd as convertDirectionObjectToLocal,hd as convertDirectionObjectToWorld,Mu as convertDirectionToLocal,Eu as convertDirectionToLocalMatrix,Ru as convertDirectionToLocalQuat,xu as convertDirectionToWorld,Du as convertDirectionToWorldMatrix,Au as convertDirectionToWorldQuat,fd as convertDirectionWorldToLocal,pd as convertDirectionWorldToObject,Cd as convertPositionLocalToObject,dd as convertPositionLocalToWorld,Td as convertPositionObjectToLocal,ud as convertPositionObjectToWorld,Pu as convertPositionToLocal,bu as convertPositionToLocalMatrix,vu as convertPositionToLocalQuat,Tu as convertPositionToWorld,Cu as convertPositionToWorldMatrix,Su as convertPositionToWorldQuat,gd as convertPositionWorldToLocal,cd as convertPositionWorldToObject,Fd as convertTransformLocalToObject,wd as convertTransformLocalToObjectMatrix,jd as convertTransformLocalToObjectQuat,Ad as convertTransformLocalToWorld,Rd as convertTransformLocalToWorldMatrix,Vd as convertTransformLocalToWorldQuat,Ld as convertTransformObjectToLocal,Hd as convertTransformObjectToLocalMatrix,kd as convertTransformObjectToLocalQuat,Sd as convertTransformObjectToWorld,vd as convertTransformObjectToWorldMatrix,xd as convertTransformObjectToWorldQuat,Od as convertTransformWorldToLocal,Id as convertTransformWorldToLocalMatrix,Bd as convertTransformWorldToLocalQuat,Md as convertTransformWorldToObject,Dd as convertTransformWorldToObjectMatrix,Ed as convertTransformWorldToObjectQuat,lu as copyComponentAlongAxis,nT as copyObjectProperties,dT as createPlane,yb as createSimplified,ub as createTeleportColliderSetupFromMovementColliderSetup,Ny as cross,NP as debug,Vu as degreesAddRotation,Ou as degreesAddRotationDegrees,Bu as degreesAddRotationQuat,Iu as degreesAddRotationRadians,wu as degreesToMatrix,ou as degreesToQuat,J_ as destroy,Hy as distance,ky as distanceSquared,jy as div,sT as doesObjectPropertyUseAccessors,zy as dot,cP as exitSession,kb as exportVariables,ly as find,yy as findAll,cy as findAllEqual,uy as findAllIndexes,dy as findAllIndexesEqual,hy as findEqual,my as findIndex,py as findIndexEqual,sy as first,Uf as floor,$u as fromAxis,eh as fromAxisDegrees,th as fromAxisRadians,nh as fromDegrees,My as fromMatrix,Oy as fromQuat,ih as fromRadians,_h as fromTwistSwing,ZC as generate360TeleportParamsFromMovementParams,qu as getAngle,Xu as getAngleDegrees,Ku as getAngleRadians,JP as getAssert,fm as getAudioManager,Nh as getAxesLocal,Gh as getAxesWorld,Qu as getAxis,Ju as getAxisScaled,Zu as getAxisScaledDegrees,Yu as getAxisScaledRadians,qh as getBackwardLocal,Qh as getBackwardWorld,Sm as getBody,Rg as getCanvas,zg as getCharacterCollisionSystem,G_ as getChildren,DT as getClassFromType,ZP as getClear,zT as getCloneCallback,WT as getClonePostProcessCallback,YC as getCollisionCheck,gg as getComponentBreadth,Kd as getComponentChildren,fg as getComponentDepth,Qd as getComponentDescendants,qd as getComponentDescendantsBreadth,Xd as getComponentDescendantsDepth,Nd as getComponentHierarchy,Ud as getComponentHierarchyBreadth,Wd as getComponentHierarchyDepth,ag as getComponentObjects,Gd as getComponentSelf,sg as getComponentsAmountMapChildren,og as getComponentsAmountMapDescendants,ng as getComponentsAmountMapHierarchy,ig as getComponentsAmountMapSelf,Tg as getComponentsBreadth,n_ as getComponentsChildren,Pg as getComponentsDepth,e_ as getComponentsDescendants,t_ as getComponentsDescendantsBreadth,i_ as getComponentsDescendantsDepth,Zd as getComponentsHierarchy,Yd as getComponentsHierarchyBreadth,$d as getComponentsHierarchyDepth,rg as getComponentsObjects,Jd as getComponentsSelf,Tf as getConsoleVR,KP as getDebug,pl as getDebugManager,Hg as getDebugVisualManager,Lf as getDefaultMaterials,Bf as getDefaultMeshes,dr as getDefaultResources,qT as getDefaultWLComponentCloneCallback,w_ as getDescendants,j_ as getDescendantsBreadth,z_ as getDescendantsDepth,tl as getDocument,Zh as getDownLocal,Jh as getDownWorld,zC as getDummyServer,Df as getEasyTuneTarget,Sf as getEasyTuneVariables,Q_ as getEngine,Eg as getEngines,QP as getError,Wh as getForwardLocal,Uh as getForwardWorld,yP as getFrame,Zg as getGamepad,Yg as getGamepads,Jg as getGamepadsManager,nf as getHandPose,of as getHandPoses,vP as getHandednessByIndex,tf as getHeadPose,H_ as getHierarchy,k_ as getHierarchyBreadth,F_ as getHierarchyDepth,q_ as getID,XP as getInfo,qe as getInputManager,xP as getInputSource,DP as getInputSourceType,MP as getInputSourceTypeByHandedness,RT as getJavascriptComponentClass,VT as getJavascriptComponentClassesByIndex,AT as getJavascriptComponentInstances,BT as getJavascriptComponentTypeFromIndex,OT as getJavascriptComponentTypeIndex,IT as getJavascriptComponentTypeIndexes,AP as getJointIDByIndex,Kg as getKeyboard,HP as getLayerFlagsNames,UC as getLeaderboard,WC as getLeaderboardDummy,$g as getLeftGamepad,sf as getLeftHandPose,$h as getLeftLocal,mf as getLeftTrackedHandPose,Yh as getLeftWorld,WP as getLog,Gt as getMainEngine,Xg as getMouse,U_ as getName,bm as getNavigator,xg as getObjectByIDBreadth,L_ as getObjectByIDChildren,Mg as getObjectByIDDepth,O_ as getObjectByIDDescendants,I_ as getObjectByIDDescendantsBreadth,B_ as getObjectByIDDescendantsDepth,A_ as getObjectByIDHierarchy,R_ as getObjectByIDHierarchyBreadth,V_ as getObjectByIDHierarchyDepth,ug as getObjectByIDObjects,Cg as getObjectByNameBreadth,C_ as getObjectByNameChildren,bg as getObjectByNameDepth,f_ as getObjectByNameDescendants,T_ as getObjectByNameDescendantsBreadth,P_ as getObjectByNameDescendantsDepth,d_ as getObjectByNameHierarchy,__ as getObjectByNameHierarchyBreadth,g_ as getObjectByNameHierarchyDepth,mg as getObjectByNameObjects,$f as getObjectFromPath,eT as getObjectNameFromPath,tT as getObjectParentFromPath,vm as getObjectPoolManager,Kf as getObjectProperty,Xf as getObjectPropertyDescriptor,qf as getObjectPropertyNames,Zf as getObjectPropertyOwnParent,Yf as getObjectPropertyOwnParents,Qf as getObjectPrototypes,pg as getObjects,dg as getObjectsBreadth,hg as getObjectsByIDObjects,Sg as getObjectsByNameBreadth,E_ as getObjectsByNameChildren,vg as getObjectsByNameDepth,x_ as getObjectsByNameDescendants,M_ as getObjectsByNameDescendantsBreadth,D_ as getObjectsByNameDescendantsDepth,b_ as getObjectsByNameHierarchy,S_ as getObjectsByNameHierarchyBreadth,v_ as getObjectsByNameHierarchyDepth,yg as getObjectsByNameObjects,_g as getObjectsDepth,EP as getOppositeHandedness,yd as getParent,Ag as getPhysics,wf as getPlayerObjects,Th as getPositionLocal,fh as getPositionWorld,lP as getReferenceSpace,mP as getReferenceSpaceType,ef as getRightGamepad,af as getRightHandPose,tc as getRightLocal,yf as getRightTrackedHandPose,ec as getRightWorld,Mh as getRotationLocal,Dh as getRotationLocalDegrees,Ah as getRotationLocalMatrix,Rh as getRotationLocalQuat,Eh as getRotationLocalRadians,Ph as getRotationMatrix,Ch as getRotationWorld,bh as getRotationWorldDegrees,vh as getRotationWorldMatrix,xh as getRotationWorldQuat,Sh as getRotationWorldRadians,NC as getSDK,Oh as getScaleLocal,Vh as getScaleWorld,hl as getScene,bl as getSceneObjects,N_ as getSelf,aP as getSession,rP as getSessionMode,db as getSimultaneousPressMaxDelay,_b as getSimultaneousTouchMaxDelay,ch as getSwing,ph as getSwingFromTwist,rf as getTrackedHandPose,lf as getTrackedHandPoses,Ih as getTransform,wh as getTransformLocal,jh as getTransformLocalMatrix,zh as getTransformLocalQuat,Bh as getTransformMatrix,Lh as getTransformQuat,Hh as getTransformWorld,kh as getTransformWorldMatrix,Fh as getTransformWorldQuat,hh as getTwist,dh as getTwistFromSwing,MT as getTypeFromTypeOrClass,Kh as getUpLocal,Xh as getUpWorld,XC as getUser,KC as getUserDummy,Om as getVisualManager,Em as getVisualResources,Vg as getWASM,xT as getWLJavascriptComponentTypes,vT as getWLNativeComponentTypes,qP as getWarn,$a as getWindow,Og as getXR,Cm as hasAudioManager,Ug as hasCharacterCollisionSystem,GT as hasCloneCallback,HT as hasClonePostProcess,QT as hasClonePostProcessCallback,bf as hasConsoleVR,jg as hasDebugEnabled,Lg as hasDebugManager,If as hasDefaultResources,XT as hasDefaultWLComponentCloneCallback,Rf as hasEasyTuneTarget,Mf as hasEasyTuneVariables,ul as hasEngine,ry as hasEqual,qg as hasInputManager,Dm as hasObjectPoolManager,pf as hasPoseForwardFixed,Ff as hasSceneObjects,ff as hasToolEnabled,p_ as hasUniformScaleLocal,c_ as hasUniformScaleWorld,Lm as hasVisualManager,Vm as hasVisualResources,hC as hsvCodeToHuman,cC as hsvHumanToCode,mC as hsvToRGB,Hb as importVariables,GP as info,xl as initArrayExtension,cT as initArrayExtensionProtoype,eb as initBridge,zl as initComponentMods,Fl as initCursorComponentMod,RP as initCursorComponentModPrototype,wl as initCursorTargetComponentMod,VP as initCursorTargetComponentModPrototype,Dg as initEngine,Ol as initJSExtensions,Il as initJSPlugins,Rl as initMathExtension,ZT as initMathExtensionStatic,jl as initMouseLookComponentMod,OP as initMouseLookComponentModPrototype,Vl as initNumberExtension,YT as initNumberExtensionPrototype,Bl as initObjectExtension,$T as initObjectExtensionProtoype,Ql as initPP,Ul as initPlugins,Ll as initSceneExtension,eP as initSceneExtensionPrototype,Hl as initWLExtensions,Gl as initWLMods,Nl as initWLPlugins,hT as injectProperties,bP as isARSupported,vC as isAnalyticsEnabled,qR as isAnyButtonPressEnd,gb as isAnyButtonPressStart,bb as isAnyButtonTouchEnd,Pb as isAnyButtonTouchStart,yT as isClass,rT as isClassByName,mu as isConcordant,DC as isDataLogEnabled,kg as isDebugEnabled,iP as isDesktop,SP as isDeviceEmulated,VC as isErrorsLogEnabled,AC as isEventsLogEnabled,yu as isFartherAlongAxis,mT as isFunction,aT as isFunctionByName,iy as isInsideAngleRange,ny as isInsideAngleRangeDegrees,oy as isInsideAngleRangeRadians,nP as isLocalhost,tP as isMobile,uT as isObject,lT as isObjectByName,gu as isOnAxis,fu as isOnPlane,eC as isPlaybackBlocked,uf as isPoseForwardFixed,hP as isReferenceSpaceFloorBased,ET as isRegistered,GC as isSDKAvailable,uP as isSessionActive,uu as isToTheRight,df as isToolEnabled,K_ as isTransformChanged,jC as isUseDummyServerOnError,wC as isUseDummyServerOnSDKMissing,CP as isVRSupported,CT as isWLComponent,ST as isWLJavascriptComponent,bT as isWLNativeComponent,LT as isWLNativeComponentRegistered,PP as isXRSupported,ay as last,qy as lengthSigned,oC as load,rC as loadBool,aC as loadNumber,sC as loadString,nd as lookAt,sd as lookAtLocal,od as lookAtWorld,ad as lookTo,ld as lookToLocal,rd as lookToWorld,pT as makeDoubleSided,jm as mapToRange,X_ as markDirty,cE as mat3_create,be as mat4_create,Gy as negate,oP as openLink,sP as openLinkOnClick,iT as overwriteObjectProperty,Wu as perpendicularRandom,cu as projectOnAxis,pu as projectOnAxisAlongAxis,du as projectOnPlane,_u as projectOnPlaneAlongAxis,Cy as pushUnique,G as quat2_create,w as quat_create,Lu as radiansAddRotation,Hu as radiansAddRotationDegrees,Fu as radiansAddRotationQuat,ku as radiansAddRotationRadians,ju as radiansToMatrix,nu as radiansToQuat,zm as random,Nm as randomBool,Gm as randomInt,Wm as randomPick,Um as randomSign,Qm as randomUUID,kP as raycast,Lb as refreshWidget,Wl as registerPPComponents,_P as registerSessionEndEventListener,fP as registerSessionStartEndEventListeners,pP as registerSessionStartEventListener,$r as registerWLComponents,fy as removeAll,Py as removeAllEqual,gy as removeAllIndexes,Pm as removeAudioManager,Ng as removeCharacterCollisionSystem,jT as removeCloneCallback,UT as removeClonePostProcessCallback,ru as removeComponentAlongAxis,Cf as removeConsoleVR,wg as removeDebugEnabled,Bg as removeDebugManager,Of as removeDefaultResources,JT as removeDefaultWLComponentCloneCallbacks,Af as removeEasyTuneTarget,xf as removeEasyTuneVariables,yl as removeEngine,Ty as removeEqual,_y as removeIndex,Qg as removeInputManager,ll as removeMainEngine,Mm as removeObjectPoolManager,cf as removePoseForwardFixed,zb as removeRefreshWidgetCallback,kf as removeSceneObjects,wb as removeSetWidgetCurrentVariableCallback,gf as removeToolEnabled,Bm as removeVisualManager,Rm as removeVisualResources,Z_ as reserveObjects,tg as reserveObjectsChildren,eg as reserveObjectsDescendants,$_ as reserveObjectsHierarchy,Y_ as reserveObjectsSelf,jc as resetPosition,Gc as resetPositionLocal,zc as resetPositionWorld,Nc as resetRotation,Wc as resetRotationLocal,Uc as resetRotationWorld,Qc as resetScale,Xc as resetScaleLocal,qc as resetScaleWorld,Kc as resetTransform,Zc as resetTransformLocal,Jc as resetTransformWorld,yC as rgbCodeToHuman,uC as rgbHumanToCode,lC as rgbToHSV,Jp as rotateAroundAxisLocal,Zp as rotateAroundAxisLocalDegrees,Yp as rotateAroundAxisLocalRadians,$p as rotateAroundAxisObject,ed as rotateAroundAxisObjectDegrees,td as rotateAroundAxisObjectRadians,qp as rotateAroundAxisWorld,Xp as rotateAroundAxisWorldDegrees,Kp as rotateAroundAxisWorldRadians,kp as rotateAroundLocal,Fp as rotateAroundLocalDegrees,jp as rotateAroundLocalMatrix,zp as rotateAroundLocalQuat,wp as rotateAroundLocalRadians,Vp as rotateAroundMatrix,Gp as rotateAroundObject,Np as rotateAroundObjectDegrees,Wp as rotateAroundObjectMatrix,Qp as rotateAroundObjectQuat,Up as rotateAroundObjectRadians,Op as rotateAroundWorld,Ip as rotateAroundWorldDegrees,Lp as rotateAroundWorldMatrix,Hp as rotateAroundWorldQuat,Bp as rotateAroundWorldRadians,xp as rotateAxisLocal,Mp as rotateAxisLocalDegrees,Dp as rotateAxisLocalRadians,Ep as rotateAxisObject,Ap as rotateAxisObjectDegrees,Rp as rotateAxisObjectRadians,bp as rotateAxisWorld,Sp as rotateAxisWorldDegrees,vp as rotateAxisWorldRadians,hp as rotateLocal,cp as rotateLocalDegrees,dp as rotateLocalMatrix,_p as rotateLocalQuat,pp as rotateLocalRadians,ap as rotateMatrix,gp as rotateObject,fp as rotateObjectDegrees,Pp as rotateObjectMatrix,Cp as rotateObjectQuat,Tp as rotateObjectRadians,rp as rotateWorld,lp as rotateWorldDegrees,yp as rotateWorldMatrix,up as rotateWorldQuat,mp as rotateWorldRadians,lh as rotationAroundAxis,mh as rotationAroundAxisDegrees,uh as rotationAroundAxisQuat,yh as rotationAroundAxisRadians,zu as rotationToPivoted,Gu as rotationToPivotedDegrees,Uu as rotationToPivotedQuat,Nu as rotationToPivotedRadians,Nf as round,wm as roundDecimal,nC as save,id as scaleObject,OC as sendData,IC as sendEvent,o_ as setActive,h_ as setActiveChildren,m_ as setActiveDescendants,y_ as setActiveDescendantsBreadth,u_ as setActiveDescendantsDepth,a_ as setActiveHierarchy,r_ as setActiveHierarchyBreadth,l_ as setActiveHierarchyDepth,lg as setActiveObjects,s_ as setActiveSelf,_C as setAlpha,SC as setAnalyticsEnabled,Tm as setAudioManager,fc as setAxesLocal,gc as setAxesWorld,bc as setBackwardLocal,Cc as setBackwardWorld,Gg as setCharacterCollisionSystem,wT as setCloneCallback,NT as setClonePostProcessCallback,bC as setClonedMaterials,$C as setCollisionCheck,Pf as setConsoleVR,MC as setDataLogEnabled,Fg as setDebugEnabled,Ig as setDebugManager,Vf as setDefaultResources,KT as setDefaultWLComponentCloneCallbacks,Mc as setDownLocal,xc as setDownWorld,FC as setDummyServer,Ef as setEasyTuneTarget,vf as setEasyTuneVariables,RC as setErrorsLogEnabled,EC as setEventsLogEnabled,Pc as setForwardLocal,Tc as setForwardWorld,Wg as setInputManager,LP as setLayerFlagsNames,Ec as setLeftLocal,Dc as setLeftWorld,rl as setMainEngine,W_ as setName,gC as setObjectAlpha,TC as setObjectClonedMaterials,CC as setObjectFogColor,fC as setObjectMaterial,xm as setObjectPoolManager,Jf as setObjectProperty,PC as setObjectSpecularColor,md as setParent,hf as setPoseForwardFixed,nc as setPositionLocal,Ay as setPositionRotationDegreesScale,Vy as setPositionRotationQuatScale,Ry as setPositionRotationRadiansScale,Ey as setPositionRotationScale,ic as setPositionWorld,Rc as setRightLocal,Ac as setRightWorld,yc as setRotationLocal,uc as setRotationLocalDegrees,cc as setRotationLocalMatrix,pc as setRotationLocalQuat,hc as setRotationLocalRadians,oc as setRotationMatrix,sc as setRotationWorld,ac as setRotationWorldDegrees,lc as setRotationWorldMatrix,mc as setRotationWorldQuat,rc as setRotationWorldRadians,_c as setScaleLocal,dc as setScaleWorld,Hf as setSceneObjects,xC as setSendAnalyticsCallback,cb as setSimultaneousPressMaxDelay,pb as setSimultaneousTouchMaxDelay,_f as setToolEnabled,Vc as setTransform,kc as setTransformLocal,Fc as setTransformLocalMatrix,wc as setTransformLocalQuat,Oc as setTransformMatrix,Ic as setTransformQuat,Bc as setTransformWorld,Lc as setTransformWorldMatrix,Hc as setTransformWorldQuat,vc as setUpLocal,Sc as setUpWorld,kC as setUseDummyServerOnError,HC as setUseDummyServerOnSDKMissing,Im as setVisualManager,Am as setVisualResources,Bb as setWidgetCurrentVariable,Fm as sign,hu as signTo,wy as sub,oh as subRotation,sh as subRotationDegrees,rh as subRotationQuat,ah as subRotationRadians,QC as submitScore,qC as submitScoreDummy,Wy as transformMat3,Qy as transformMat4,Uy as transformQuat,Yc as translate,ip as translateAxis,op as translateAxisLocal,sp as translateAxisObject,np as translateAxisWorld,ep as translateLocal,tp as translateObject,$c as translateWorld,gP as unregisterSessionEndEventListener,TP as unregisterSessionStartEndEventListeners,dP as unregisterSessionStartEventListener,by as unshiftUnique,sb as updateCeilingInfo,ob as updateGroundInfo,au as valueAlongAxis,Ce as vec2_create,p as vec3_create,F as vec4_create,cg as wrapObject};
//# sourceMappingURL=wle_pp_bundle.js.map
