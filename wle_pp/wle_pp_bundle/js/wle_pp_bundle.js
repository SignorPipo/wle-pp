var pm=Object.defineProperty;var Vb=(i,e,t)=>e in i?pm(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var _t=(i,e)=>{for(var t in e)pm(i,t,{get:e[t],enumerable:!0})};var R=(i,e,t)=>(Vb(i,typeof e!="symbol"?e+"":e,t),t);var Ul={};_t(Ul,{AddPPToWindowComponent:()=>_i,AddWLToWindowComponent:()=>ci,AdjustHierarchyPhysXScaleComponent:()=>sn,ArrayUtils:()=>K,AudioEvent:()=>ys,AudioManager:()=>us,AudioManagerComponent:()=>Zt,AudioPlayer:()=>kn,AudioSetup:()=>ji,AudioUtils:()=>EA,BaseGamepad:()=>_s,BasePose:()=>Ge,BasePoseParams:()=>Mt,BenchmarkMaxPhysXComponent:()=>en,BenchmarkMaxVisibleTrianglesComponent:()=>tn,BrowserUtils:()=>Jn,CADisplayLeaderboardComponent:()=>cn,CADummyServer:()=>Vs,CAError:()=>we,CAUtils:()=>de,CharacterColliderAdditionalParams:()=>Fs,CharacterColliderDebugParams:()=>ws,CharacterColliderHorizontalCheckParams:()=>Bs,CharacterColliderHorizontalPositionVerticalCheckDirection:()=>qC,CharacterColliderSetup:()=>to,CharacterColliderSetupSimplifiedCreationAccuracyLevel:()=>io,CharacterColliderSetupSimplifiedCreationParams:()=>zs,CharacterColliderSetupUtils:()=>nm,CharacterColliderSlideFlickerPreventionMode:()=>js,CharacterColliderSplitMovementParams:()=>ks,CharacterColliderSurfaceParams:()=>Qo,CharacterColliderVerticalCheckParams:()=>Ls,CharacterColliderWallSlideParams:()=>Hs,CharacterCollisionCheckTransformResults:()=>No,CharacterCollisionCheckType:()=>Qi,CharacterCollisionDebugResults:()=>Wo,CharacterCollisionInternalResults:()=>Uo,CharacterCollisionMovementResults:()=>Ui,CharacterCollisionResults:()=>Ue,CharacterCollisionSplitMovementResults:()=>Go,CharacterCollisionSurfaceInfo:()=>$n,CharacterCollisionSurfaceResults:()=>eo,CharacterCollisionSystem:()=>qo,CharacterCollisionSystemComponent:()=>pn,CharacterCollisionTeleportResults:()=>zo,CharacterCollisionTransformResults:()=>jo,CharacterCollisionWallSlideResults:()=>wo,ClassicGamepadCore:()=>xo,ClearConsoleOnXRSessionStartComponent:()=>nn,CloneParams:()=>Xt,CollisionCheck:()=>G,CollisionCheckBridge:()=>q,CollisionCheckParams:()=>st,CollisionCheckUtils:()=>Is,CollisionRuntimeParams:()=>_e,ColorUtils:()=>ce,ComponentUtils:()=>z,ConsoleOriginalFunctions:()=>Ee,ConsoleVR:()=>Cs,ConsoleVRToolComponent:()=>xn,ConsoleVRWidget:()=>_a,ConsoleVRWidgetConfig:()=>ma,ConsoleVRWidgetConsoleFunction:()=>le,ConsoleVRWidgetMessage:()=>da,ConsoleVRWidgetMessageType:()=>k,ConsoleVRWidgetParams:()=>pa,ConsoleVRWidgetPulseOnNewMessage:()=>la,ConsoleVRWidgetSender:()=>Be,ConsoleVRWidgetUI:()=>ua,CopyHandTransformComponent:()=>Cn,CopyHeadTransformComponent:()=>bn,CopyPlayerTransformComponent:()=>Sn,CopyReferenceSpaceTransformComponent:()=>vn,CustomCloneParams:()=>as,DebugArrayFunctionsPerformanceAnalyzerComponent:()=>mn,DebugFunctionPerformanceAnalysisResults:()=>ko,DebugFunctionsOverwriter:()=>Ho,DebugFunctionsOverwriterParams:()=>Lo,DebugFunctionsPerformanceAnalysisResultsLogger:()=>Rs,DebugFunctionsPerformanceAnalysisResultsLoggerParams:()=>As,DebugFunctionsPerformanceAnalyzer:()=>Zn,DebugFunctionsPerformanceAnalyzerComponent:()=>$e,DebugFunctionsPerformanceAnalyzerParams:()=>Fo,DebugFunctionsPerformanceAnalyzerSortOrder:()=>Gt,DebugManager:()=>ps,DebugManagerComponent:()=>ei,DebugPPArrayCreationPerformanceAnalyzerComponent:()=>yn,DebugPPFunctionsPerformanceAnalyzerComponent:()=>ln,DebugTransformComponent:()=>rn,DebugVisualManager:()=>Ni,DebugWLComponentsFunctionsPerformanceAnalyzerComponent:()=>hn,DebugWLFunctionsPerformanceAnalyzerComponent:()=>un,DeepCloneParams:()=>Kt,DefaultResources:()=>ms,DefaultResourcesMaterials:()=>Mr,DefaultResourcesMeshes:()=>xr,DefaultWLComponentCloneCallbacks:()=>bo,Direction2DTo3DConverter:()=>ri,Direction2DTo3DConverterParams:()=>Yn,EPSILON:()=>ir,EPSILON_DEGREES:()=>Bm,EPSILON_SQUARED:()=>Im,EasingFunction:()=>he,EasyLightAttenuation:()=>ja,EasyLightAttenuationComponent:()=>En,EasyLightColor:()=>za,EasyLightColorComponent:()=>An,EasyMeshAmbientFactor:()=>Ua,EasyMeshAmbientFactorComponent:()=>Rn,EasyMeshColor:()=>Na,EasyMeshColorComponent:()=>On,EasyObjectTuner:()=>rt,EasyScale:()=>Ga,EasyScaleComponent:()=>Vn,EasySetTuneTargeetGrabComponent:()=>Bn,EasySetTuneTargetChildNumberComponent:()=>In,EasyTextColor:()=>Qa,EasyTextColorComponent:()=>Ln,EasyTransform:()=>Wa,EasyTransformComponent:()=>Hn,EasyTuneBaseArrayWidgetSelector:()=>po,EasyTuneBaseWidget:()=>Ut,EasyTuneBaseWidgetConfig:()=>Qt,EasyTuneBaseWidgetParams:()=>Ta,EasyTuneBaseWidgetUI:()=>qt,EasyTuneBool:()=>rm,EasyTuneBoolArray:()=>Gr,EasyTuneBoolArrayWidget:()=>xa,EasyTuneBoolArrayWidgetConfig:()=>Pa,EasyTuneBoolArrayWidgetSelector:()=>Ma,EasyTuneBoolArrayWidgetUI:()=>va,EasyTuneImportVariablesComponent:()=>Dn,EasyTuneInt:()=>fa,EasyTuneIntArray:()=>Ei,EasyTuneNoneWidget:()=>Ra,EasyTuneNoneWidgetConfig:()=>Ea,EasyTuneNoneWidgetUI:()=>Aa,EasyTuneNumber:()=>Xi,EasyTuneNumberArray:()=>Di,EasyTuneNumberArrayWidget:()=>Ia,EasyTuneNumberArrayWidgetConfig:()=>Oa,EasyTuneNumberArrayWidgetSelector:()=>Ba,EasyTuneNumberArrayWidgetUI:()=>Va,EasyTuneToolComponent:()=>Mn,EasyTuneTransform:()=>co,EasyTuneTransformWidget:()=>ka,EasyTuneTransformWidgetConfig:()=>La,EasyTuneTransformWidgetUI:()=>Ha,EasyTuneUtils:()=>ke,EasyTuneVariable:()=>ho,EasyTuneVariableArray:()=>mi,EasyTuneVariableType:()=>yi,EasyTuneVariables:()=>bs,EasyTuneWidget:()=>wa,EasyTuneWidgetConfig:()=>Da,EasyTuneWidgetParams:()=>Fa,EnableDebugComponent:()=>pi,EnableToolComponent:()=>di,FSM:()=>it,FingerCursorComponent:()=>Ti,GamepadAxesEvent:()=>si,GamepadAxesID:()=>oe,GamepadAxesInfo:()=>Gn,GamepadButtonEvent:()=>re,GamepadButtonID:()=>E,GamepadButtonInfo:()=>Nn,GamepadControlSchemeComponent:()=>fn,GamepadCore:()=>zt,GamepadMeshAnimatorComponent:()=>Hi,GamepadPulseInfo:()=>Wn,GamepadUtils:()=>RR,GamepadsManager:()=>gs,GetDefaultResourcesComponent:()=>Lt,GetSceneObjectsComponent:()=>Ht,Globals:()=>r,GrabbableComponent:()=>gi,GrabberHandComponent:()=>fi,HandPose:()=>Qn,HandPoseParams:()=>Un,Handedness:()=>A,HandednessIndex:()=>Bi,HeadPose:()=>fs,HowlerAudioPlayer:()=>Ql,InitConsoleVRComponent:()=>It,InitEasyTuneVariablesComponent:()=>Bt,InputManager:()=>Ps,InputManagerComponent:()=>Vt,InputSourceType:()=>Ye,InputUtils:()=>ie,IntOverFactor:()=>Yl,IntRangeOverFactor:()=>$l,JSUtils:()=>$,KeyID:()=>ee,Keyboard:()=>ds,KeyboardGamepadCore:()=>Mo,Mat3Utils:()=>Y,Mat4Utils:()=>O,MaterialUtils:()=>Es,MathUtils:()=>L,MeshCreationParams:()=>Co,MeshCreationTriangleParams:()=>Ii,MeshCreationVertexParams:()=>Po,MeshUtils:()=>Oe,Mouse:()=>Ts,MouseButtonID:()=>Gi,MuteEverythingComponent:()=>Yi,NumberOverFactor:()=>xi,NumberRangeOverFactor:()=>Br,ObjectPool:()=>wn,ObjectPoolManager:()=>hs,ObjectPoolManagerComponent:()=>Yt,ObjectPoolParams:()=>Fn,ObjectUtils:()=>y,PPGatewayComponent:()=>Zi,PerformDelayedMode:()=>vs,PerformMode:()=>vi,PhysicsCollisionCollector:()=>Si,PhysicsLayerFlags:()=>Ve,PhysicsUtils:()=>De,PlayerHeadManager:()=>ae,PlayerHeadManagerParams:()=>Xo,PlayerLocomotion:()=>ea,PlayerLocomotionComponent:()=>dn,PlayerLocomotionDirectionReferenceType:()=>Fr,PlayerLocomotionMovement:()=>no,PlayerLocomotionMovementRuntimeParams:()=>Ws,PlayerLocomotionParams:()=>$s,PlayerLocomotionRotate:()=>Mi,PlayerLocomotionRotateParams:()=>Gs,PlayerLocomotionSmooth:()=>li,PlayerLocomotionSmoothParams:()=>ta,PlayerLocomotionTeleport:()=>Ko,PlayerLocomotionTeleportDetectionParams:()=>Xs,PlayerLocomotionTeleportDetectionRuntimeParams:()=>Hr,PlayerLocomotionTeleportDetectionState:()=>dt,PlayerLocomotionTeleportDetectionVisualizer:()=>qi,PlayerLocomotionTeleportDetectionVisualizerParams:()=>qs,PlayerLocomotionTeleportParable:()=>Wt,PlayerLocomotionTeleportParams:()=>Ys,PlayerLocomotionTeleportRuntimeParams:()=>kr,PlayerLocomotionTeleportState:()=>bt,PlayerLocomotionTeleportTeleportBlinkState:()=>Ks,PlayerLocomotionTeleportTeleportParams:()=>Js,PlayerLocomotionTeleportTeleportShiftState:()=>oo,PlayerLocomotionTeleportTeleportState:()=>Zs,PlayerLocomotionTeleportTeleportType:()=>so,PlayerLocomotionType:()=>om,PlayerObjects:()=>vr,PlayerObscureManager:()=>Qs,PlayerObscureManagerParams:()=>Us,PlayerTransformManager:()=>at,PlayerTransformManagerParams:()=>Ns,PlayerTransformManagerSyncFlag:()=>pe,PluginUtils:()=>xe,Quat2Utils:()=>V,QuatUtils:()=>T,RaycastHit:()=>mt,RaycastParams:()=>ct,RaycastResults:()=>Fe,SaveManager:()=>Kl,SaveUtils:()=>Nt,SceneObjects:()=>ls,SceneUtils:()=>Z,SetActiveComponent:()=>on,SetHandLocalTransformComponent:()=>ki,SetHeadLocalTransformComponent:()=>Pi,SetPlayerHeightComponent:()=>Pn,SetTrackedHandJointLocalTransformComponent:()=>Fi,ShowFPSComponent:()=>an,SkipStateFunction:()=>Vo,SpatialAudioListenerComponent:()=>$i,State:()=>Kn,StateData:()=>Io,SwitchHandObjectComponent:()=>_n,TextUtils:()=>XA,Timer:()=>ne,TimerState:()=>Ms,ToolCursorComponent:()=>wi,ToolHandedness:()=>U,ToolInputSourceType:()=>Re,TrackedHandDrawAllJointsComponent:()=>gn,TrackedHandDrawJointComponent:()=>ti,TrackedHandDrawSkinComponent:()=>Li,TrackedHandJointID:()=>lt,TrackedHandJointIDIndex:()=>So,TrackedHandJointPose:()=>Ao,TrackedHandPose:()=>Ro,TrackedHandPoseParams:()=>qn,Transition:()=>Zl,TransitionData:()=>Bo,UniversalGamepad:()=>Eo,Vec2Utils:()=>ft,Vec3Utils:()=>p,Vec4Utils:()=>Vi,VecUtils:()=>Tt,VirtualGamepad:()=>aa,VirtualGamepadButtonParams:()=>Dt,VirtualGamepadComponent:()=>Tn,VirtualGamepadGamepadCore:()=>Jo,VirtualGamepadIcon:()=>ao,VirtualGamepadIconParams:()=>Zo,VirtualGamepadIconType:()=>Ie,VirtualGamepadParams:()=>ro,VirtualGamepadThumbstickParams:()=>na,VirtualGamepadVirtualButton:()=>oa,VirtualGamepadVirtualThumbstick:()=>sa,VisualArrow:()=>tt,VisualArrowParams:()=>Ne,VisualElementType:()=>Me,VisualLine:()=>ht,VisualLineParams:()=>et,VisualManager:()=>zn,VisualManagerComponent:()=>$t,VisualMesh:()=>Ci,VisualMeshParams:()=>ii,VisualPoint:()=>kt,VisualPointParams:()=>xt,VisualRaycast:()=>jn,VisualRaycastParams:()=>ni,VisualResources:()=>cs,VisualResourcesMaterials:()=>Dr,VisualText:()=>zi,VisualTextParams:()=>Ft,VisualTorus:()=>jt,VisualTorusParams:()=>wt,VisualTransform:()=>oi,VisualTransformParams:()=>Rt,WidgetFrame:()=>mo,WidgetFrameConfig:()=>ha,WidgetFrameUI:()=>ca,WidgetParams:()=>lo,XRGamepadCore:()=>Do,XRUtils:()=>I,add:()=>Ly,addComponent:()=>Fd,addEngine:()=>sl,addRefreshWidgetCallback:()=>vb,addSetWidgetCurrentVariableCallback:()=>bb,angle:()=>Ry,angleClamp:()=>Jm,angleClampDegrees:()=>Zm,angleClampRadians:()=>Ym,angleDegrees:()=>Oy,angleDistance:()=>Wm,angleDistanceDegrees:()=>Um,angleDistanceRadians:()=>Qm,angleDistanceSigned:()=>qm,angleDistanceSignedDegrees:()=>Xm,angleDistanceSignedRadians:()=>Km,anglePivoted:()=>Xy,anglePivotedDegrees:()=>Ky,anglePivotedRadians:()=>Jy,anglePivotedSigned:()=>Zy,anglePivotedSignedDegrees:()=>Yy,anglePivotedSignedRadians:()=>$y,angleRadians:()=>Vy,angleSigned:()=>Uy,angleSignedDegrees:()=>Qy,angleSignedRadians:()=>qy,areButtonsPressEnd:()=>nb,areButtonsPressStart:()=>ib,areButtonsTouchEnd:()=>rb,areButtonsTouchStart:()=>sb,assert:()=>LP,ceil:()=>Nf,checkMovement:()=>wC,checkTeleportToTransform:()=>jC,checkTransform:()=>zC,cleanObjectProperties:()=>tT,cloneCollision:()=>dT,cloneDefault:()=>LT,cloneMesh:()=>pT,clonePhysX:()=>gT,clonePostProcess:()=>BT,cloneText:()=>_T,color1To255:()=>aC,color255To1:()=>sC,componentAlongAxis:()=>iu,convertCharacterColliderSetupToCollisionCheckParams:()=>QC,convertCharacterCollisionResultsToCollisionRuntimeParams:()=>WC,convertCollisionRuntimeParamsToCharacterCollisionResults:()=>UC,convertDirectionLocalToObject:()=>Td,convertDirectionLocalToWorld:()=>cd,convertDirectionObjectToLocal:()=>gd,convertDirectionObjectToWorld:()=>md,convertDirectionToLocal:()=>Su,convertDirectionToLocalMatrix:()=>xu,convertDirectionToLocalQuat:()=>Du,convertDirectionToWorld:()=>bu,convertDirectionToWorldMatrix:()=>vu,convertDirectionToWorldQuat:()=>Mu,convertDirectionWorldToLocal:()=>dd,convertDirectionWorldToObject:()=>ud,convertPositionLocalToObject:()=>fd,convertPositionLocalToWorld:()=>hd,convertPositionObjectToLocal:()=>_d,convertPositionObjectToWorld:()=>ld,convertPositionToLocal:()=>gu,convertPositionToLocalMatrix:()=>Tu,convertPositionToLocalQuat:()=>Cu,convertPositionToWorld:()=>_u,convertPositionToWorldMatrix:()=>fu,convertPositionToWorldQuat:()=>Pu,convertPositionWorldToLocal:()=>pd,convertPositionWorldToObject:()=>yd,convertTransformLocalToObject:()=>Ld,convertTransformLocalToObjectMatrix:()=>Hd,convertTransformLocalToObjectQuat:()=>kd,convertTransformLocalToWorld:()=>Md,convertTransformLocalToWorldMatrix:()=>Dd,convertTransformLocalToWorldQuat:()=>Ed,convertTransformObjectToLocal:()=>Vd,convertTransformObjectToLocalMatrix:()=>Id,convertTransformObjectToLocalQuat:()=>Bd,convertTransformObjectToWorld:()=>Pd,convertTransformObjectToWorldMatrix:()=>Cd,convertTransformObjectToWorldQuat:()=>bd,convertTransformWorldToLocal:()=>Ad,convertTransformWorldToLocalMatrix:()=>Rd,convertTransformWorldToLocalQuat:()=>Od,convertTransformWorldToObject:()=>Sd,convertTransformWorldToObjectMatrix:()=>vd,convertTransformWorldToObjectQuat:()=>xd,copyComponentAlongAxis:()=>su,copyObjectProperties:()=>eT,createPlane:()=>hT,createSimplified:()=>XC,createTeleportColliderSetupFromMovementColliderSetup:()=>KC,cross:()=>jy,debug:()=>BP,degreesAddRotation:()=>Eu,degreesAddRotationDegrees:()=>Au,degreesAddRotationQuat:()=>Ou,degreesAddRotationRadians:()=>Ru,degreesToMatrix:()=>Hu,degreesToQuat:()=>tu,destroy:()=>q_,distance:()=>Iy,distanceSquared:()=>By,div:()=>ky,doesObjectPropertyUseAccessors:()=>iT,dot:()=>Fy,exitSession:()=>sP,exportVariables:()=>Cb,find:()=>sy,findAll:()=>ry,findAllEqual:()=>yy,findAllIndexes:()=>ly,findAllIndexesEqual:()=>hy,findEqual:()=>my,findIndex:()=>ay,findIndexEqual:()=>uy,first:()=>iy,floor:()=>zf,fromAxis:()=>Ju,fromAxisDegrees:()=>Zu,fromAxisRadians:()=>Yu,fromDegrees:()=>eh,fromMatrix:()=>Sy,fromQuat:()=>Ay,fromRadians:()=>$u,fromTwistSwing:()=>ch,generate360TeleportParamsFromMovementParams:()=>LC,getAngle:()=>Wu,getAngleDegrees:()=>Uu,getAngleRadians:()=>Qu,getAssert:()=>zP,getAudioManager:()=>dm,getAxesLocal:()=>jh,getAxesWorld:()=>wh,getAxis:()=>Gu,getAxisScaled:()=>qu,getAxisScaledDegrees:()=>Xu,getAxisScaledRadians:()=>Ku,getBackwardLocal:()=>Wh,getBackwardWorld:()=>Gh,getBody:()=>Pm,getCanvas:()=>Dg,getCharacterCollisionSystem:()=>Fg,getChildren:()=>w_,getClassFromType:()=>vT,getClear:()=>NP,getCloneCallback:()=>FT,getClonePostProcessCallback:()=>NT,getCollisionCheck:()=>HC,getComponentBreadth:()=>pg,getComponentChildren:()=>Qd,getComponentDepth:()=>dg,getComponentDescendants:()=>Gd,getComponentDescendantsBreadth:()=>Wd,getComponentDescendantsDepth:()=>Ud,getComponentHierarchy:()=>jd,getComponentHierarchyBreadth:()=>zd,getComponentHierarchyDepth:()=>Nd,getComponentObjects:()=>ng,getComponentSelf:()=>wd,getComponentsAmountMapChildren:()=>ig,getComponentsAmountMapDescendants:()=>tg,getComponentsAmountMapHierarchy:()=>eg,getComponentsAmountMapSelf:()=>$_,getComponentsBreadth:()=>_g,getComponentsChildren:()=>e_,getComponentsDepth:()=>gg,getComponentsDescendants:()=>Zd,getComponentsDescendantsBreadth:()=>Yd,getComponentsDescendantsDepth:()=>$d,getComponentsHierarchy:()=>Xd,getComponentsHierarchyBreadth:()=>Kd,getComponentsHierarchyDepth:()=>Jd,getComponentsObjects:()=>og,getComponentsSelf:()=>qd,getConsoleVR:()=>_f,getDebug:()=>jP,getDebugManager:()=>yl,getDebugVisualManager:()=>Ig,getDefaultMaterials:()=>Vf,getDefaultMeshes:()=>Of,getDefaultResources:()=>pr,getDefaultWLComponentCloneCallback:()=>WT,getDescendants:()=>H_,getDescendantsBreadth:()=>k_,getDescendantsDepth:()=>F_,getDocument:()=>Zr,getDownLocal:()=>Xh,getDownWorld:()=>qh,getDummyServer:()=>xC,getEasyTuneTarget:()=>vf,getEasyTuneVariables:()=>Pf,getEngine:()=>G_,getEngines:()=>xg,getError:()=>kP,getForwardLocal:()=>Nh,getForwardWorld:()=>zh,getFrame:()=>iP,getGamepad:()=>Xg,getGamepads:()=>Kg,getGamepadsManager:()=>qg,getHandPose:()=>$g,getHandPoses:()=>ef,getHandednessByIndex:()=>_P,getHeadPose:()=>Yg,getHierarchy:()=>I_,getHierarchyBreadth:()=>B_,getHierarchyDepth:()=>L_,getID:()=>W_,getInfo:()=>wP,getInputManager:()=>Xe,getInputSource:()=>gP,getInputSourceType:()=>TP,getInputSourceTypeByHandedness:()=>fP,getJavascriptComponentClass:()=>DT,getJavascriptComponentClassesByIndex:()=>ET,getJavascriptComponentInstances:()=>MT,getJavascriptComponentTypeFromIndex:()=>OT,getJavascriptComponentTypeIndex:()=>AT,getJavascriptComponentTypeIndexes:()=>RT,getJointIDByIndex:()=>CP,getKeyboard:()=>Qg,getLayerFlagsNames:()=>DP,getLeaderboard:()=>EC,getLeaderboardDummy:()=>AC,getLeftGamepad:()=>Jg,getLeftHandPose:()=>tf,getLeftLocal:()=>Jh,getLeftTrackedHandPose:()=>af,getLeftWorld:()=>Kh,getLog:()=>HP,getMainEngine:()=>Jt,getMouse:()=>Ug,getName:()=>z_,getNavigator:()=>Tm,getObjectByIDBreadth:()=>bg,getObjectByIDChildren:()=>V_,getObjectByIDDepth:()=>Sg,getObjectByIDDescendants:()=>A_,getObjectByIDDescendantsBreadth:()=>R_,getObjectByIDDescendantsDepth:()=>O_,getObjectByIDHierarchy:()=>M_,getObjectByIDHierarchyBreadth:()=>D_,getObjectByIDHierarchyDepth:()=>E_,getObjectByIDObjects:()=>lg,getObjectByNameBreadth:()=>fg,getObjectByNameChildren:()=>f_,getObjectByNameDepth:()=>Tg,getObjectByNameDescendants:()=>d_,getObjectByNameDescendantsBreadth:()=>__,getObjectByNameDescendantsDepth:()=>g_,getObjectByNameHierarchy:()=>h_,getObjectByNameHierarchyBreadth:()=>c_,getObjectByNameHierarchyDepth:()=>p_,getObjectByNameObjects:()=>ag,getObjectFromPath:()=>Jf,getObjectNameFromPath:()=>Zf,getObjectParentFromPath:()=>Yf,getObjectPoolManager:()=>Cm,getObjectProperty:()=>Qf,getObjectPropertyDescriptor:()=>Uf,getObjectPropertyNames:()=>Wf,getObjectPropertyOwnParent:()=>Xf,getObjectPropertyOwnParents:()=>Kf,getObjectPrototypes:()=>Gf,getObjects:()=>ug,getObjectsBreadth:()=>hg,getObjectsByIDObjects:()=>mg,getObjectsByNameBreadth:()=>Pg,getObjectsByNameChildren:()=>x_,getObjectsByNameDepth:()=>Cg,getObjectsByNameDescendants:()=>b_,getObjectsByNameDescendantsBreadth:()=>S_,getObjectsByNameDescendantsDepth:()=>v_,getObjectsByNameHierarchy:()=>T_,getObjectsByNameHierarchyBreadth:()=>P_,getObjectsByNameHierarchyDepth:()=>C_,getObjectsByNameObjects:()=>rg,getObjectsDepth:()=>cg,getOppositeHandedness:()=>PP,getParent:()=>rd,getPhysics:()=>Mg,getPlayerObjects:()=>Hf,getPositionLocal:()=>_h,getPositionWorld:()=>dh,getReferenceSpace:()=>eP,getReferenceSpaceType:()=>tP,getRightGamepad:()=>Zg,getRightHandPose:()=>nf,getRightLocal:()=>Yh,getRightTrackedHandPose:()=>rf,getRightWorld:()=>Zh,getRotationLocal:()=>Sh,getRotationLocalDegrees:()=>vh,getRotationLocalMatrix:()=>Mh,getRotationLocalQuat:()=>Dh,getRotationLocalRadians:()=>xh,getRotationMatrix:()=>gh,getRotationWorld:()=>fh,getRotationWorldDegrees:()=>Th,getRotationWorldMatrix:()=>Ch,getRotationWorldQuat:()=>bh,getRotationWorldRadians:()=>Ph,getSDK:()=>DC,getScaleLocal:()=>Ah,getScaleWorld:()=>Eh,getScene:()=>ll,getSceneObjects:()=>fl,getSelf:()=>j_,getSession:()=>YT,getSessionMode:()=>$T,getSimultaneousPressMaxDelay:()=>$C,getSimultaneousTouchMaxDelay:()=>eb,getSwing:()=>yh,getSwingFromTwist:()=>uh,getTrackedHandPose:()=>of,getTrackedHandPoses:()=>sf,getTransform:()=>Rh,getTransformLocal:()=>Hh,getTransformLocalMatrix:()=>kh,getTransformLocalQuat:()=>Fh,getTransformMatrix:()=>Oh,getTransformQuat:()=>Vh,getTransformWorld:()=>Ih,getTransformWorldMatrix:()=>Bh,getTransformWorldQuat:()=>Lh,getTwist:()=>mh,getTwistFromSwing:()=>hh,getTypeFromTypeOrClass:()=>ST,getUpLocal:()=>Qh,getUpWorld:()=>Uh,getUser:()=>VC,getUserDummy:()=>IC,getVisualManager:()=>Am,getVisualResources:()=>xm,getWASM:()=>Eg,getWLJavascriptComponentTypes:()=>bT,getWLNativeComponentTypes:()=>CT,getWarn:()=>FP,getWindow:()=>Ya,getXR:()=>Ag,hasAudioManager:()=>fm,hasCharacterCollisionSystem:()=>zg,hasCloneCallback:()=>wT,hasClonePostProcess:()=>IT,hasClonePostProcessCallback:()=>GT,hasConsoleVR:()=>Tf,hasDebugEnabled:()=>kg,hasDebugManager:()=>Vg,hasDefaultResources:()=>Rf,hasDefaultWLComponentCloneCallback:()=>UT,hasEasyTuneTarget:()=>Df,hasEasyTuneVariables:()=>Sf,hasEngine:()=>rl,hasEqual:()=>oy,hasInputManager:()=>Wg,hasObjectPoolManager:()=>vm,hasPoseForwardFixed:()=>uf,hasSceneObjects:()=>Lf,hasToolEnabled:()=>df,hasUniformScaleLocal:()=>u_,hasUniformScaleWorld:()=>y_,hasVisualManager:()=>Vm,hasVisualResources:()=>Em,hsvCodeToHuman:()=>nC,hsvHumanToCode:()=>oC,hsvToRGB:()=>eC,importVariables:()=>Pb,info:()=>IP,initArrayExtension:()=>Cl,initArrayExtensionProtoype:()=>yT,initBridge:()=>FC,initComponentMods:()=>kl,initCursorComponentMod:()=>Bl,initCursorComponentModPrototype:()=>bP,initCursorTargetComponentMod:()=>Ll,initCursorTargetComponentModPrototype:()=>SP,initEngine:()=>vg,initJSExtensions:()=>El,initJSPlugins:()=>Al,initMathExtension:()=>Ml,initMathExtensionStatic:()=>XT,initMouseLookComponentMod:()=>Hl,initMouseLookComponentModPrototype:()=>vP,initNumberExtension:()=>Dl,initNumberExtensionPrototype:()=>KT,initObjectExtension:()=>Rl,initObjectExtensionProtoype:()=>JT,initPP:()=>Nl,initPlugins:()=>jl,initSceneExtension:()=>Ol,initSceneExtensionPrototype:()=>ZT,initWLExtensions:()=>Vl,initWLMods:()=>Fl,initWLPlugins:()=>wl,injectProperties:()=>mT,isARSupported:()=>pP,isAnyButtonPressEnd:()=>AR,isAnyButtonPressStart:()=>tb,isAnyButtonTouchEnd:()=>ab,isAnyButtonTouchStart:()=>ob,isClass:()=>rT,isClassByName:()=>oT,isConcordant:()=>au,isDebugEnabled:()=>Bg,isDesktop:()=>dC,isDeviceEmulated:()=>dP,isFartherAlongAxis:()=>ru,isFunction:()=>aT,isFunctionByName:()=>nT,isInsideAngleRange:()=>$m,isInsideAngleRangeDegrees:()=>ey,isInsideAngleRangeRadians:()=>ty,isMobile:()=>pC,isObject:()=>lT,isObjectByName:()=>sT,isOnAxis:()=>pu,isOnPlane:()=>du,isPlaybackBlocked:()=>UP,isPoseForwardFixed:()=>lf,isReferenceSpaceFloorBased:()=>oP,isRegistered:()=>xT,isSDKAvailable:()=>MC,isSessionActive:()=>nP,isToTheRight:()=>lu,isToolEnabled:()=>hf,isTransformChanged:()=>Q_,isUseDummyServerOnError:()=>vC,isUseDummyServerOnSDKMissing:()=>SC,isVRSupported:()=>cP,isWLComponent:()=>fT,isWLJavascriptComponent:()=>PT,isWLNativeComponent:()=>TT,isWLNativeComponentRegistered:()=>VT,isXRSupported:()=>hP,last:()=>ny,lengthSigned:()=>Wy,load:()=>KP,loadBool:()=>YP,loadNumber:()=>ZP,loadString:()=>JP,lookAt:()=>ed,lookAtLocal:()=>id,lookAtWorld:()=>td,lookTo:()=>nd,lookToLocal:()=>sd,lookToWorld:()=>od,makeDoubleSided:()=>uT,mapToRange:()=>km,markDirty:()=>U_,mat3_create:()=>KD,mat4_create:()=>be,negate:()=>wy,openLink:()=>_C,openLinkOnClick:()=>gC,overwriteObjectProperty:()=>$f,perpendicularRandom:()=>Nu,projectOnAxis:()=>yu,projectOnAxisAlongAxis:()=>uu,projectOnPlane:()=>hu,projectOnPlaneAlongAxis:()=>cu,pushUnique:()=>fy,quat2_create:()=>N,quat_create:()=>j,radiansAddRotation:()=>Vu,radiansAddRotationDegrees:()=>Iu,radiansAddRotationQuat:()=>Lu,radiansAddRotationRadians:()=>Bu,radiansToMatrix:()=>ku,radiansToQuat:()=>eu,random:()=>Fm,randomBool:()=>jm,randomInt:()=>wm,randomPick:()=>Nm,randomSign:()=>zm,randomUUID:()=>Gm,raycast:()=>EP,refreshWidget:()=>Tb,registerPPComponents:()=>zl,registerSessionEndEventListener:()=>lP,registerSessionStartEndEventListeners:()=>yP,registerSessionStartEventListener:()=>aP,registerWLComponents:()=>Kr,removeAll:()=>dy,removeAllEqual:()=>gy,removeAllIndexes:()=>py,removeAudioManager:()=>gm,removeCharacterCollisionSystem:()=>jg,removeCloneCallback:()=>kT,removeClonePostProcessCallback:()=>zT,removeComponentAlongAxis:()=>ou,removeConsoleVR:()=>ff,removeDebugEnabled:()=>Hg,removeDebugManager:()=>Og,removeDefaultResources:()=>Af,removeDefaultWLComponentCloneCallbacks:()=>qT,removeEasyTuneTarget:()=>Mf,removeEasyTuneVariables:()=>bf,removeEngine:()=>al,removeEqual:()=>_y,removeIndex:()=>cy,removeInputManager:()=>Gg,removeMainEngine:()=>ol,removeObjectPoolManager:()=>Sm,removePoseForwardFixed:()=>yf,removeRefreshWidgetCallback:()=>xb,removeSceneObjects:()=>Bf,removeSetWidgetCurrentVariableCallback:()=>Sb,removeToolEnabled:()=>pf,removeVisualManager:()=>Om,removeVisualResources:()=>Dm,reserveObjects:()=>X_,reserveObjectsChildren:()=>Y_,reserveObjectsDescendants:()=>Z_,reserveObjectsHierarchy:()=>J_,reserveObjectsSelf:()=>K_,resetPosition:()=>kc,resetPositionLocal:()=>wc,resetPositionWorld:()=>Fc,resetRotation:()=>jc,resetRotationLocal:()=>Nc,resetRotationWorld:()=>zc,resetScale:()=>Gc,resetScaleLocal:()=>Uc,resetScaleWorld:()=>Wc,resetTransform:()=>Qc,resetTransformLocal:()=>Xc,resetTransformWorld:()=>qc,rgbCodeToHuman:()=>tC,rgbHumanToCode:()=>iC,rgbToHSV:()=>$P,rotateAroundAxisLocal:()=>qp,rotateAroundAxisLocalDegrees:()=>Xp,rotateAroundAxisLocalRadians:()=>Kp,rotateAroundAxisObject:()=>Jp,rotateAroundAxisObjectDegrees:()=>Zp,rotateAroundAxisObjectRadians:()=>Yp,rotateAroundAxisWorld:()=>Wp,rotateAroundAxisWorldDegrees:()=>Up,rotateAroundAxisWorldRadians:()=>Qp,rotateAroundLocal:()=>Bp,rotateAroundLocalDegrees:()=>Lp,rotateAroundLocalMatrix:()=>kp,rotateAroundLocalQuat:()=>Fp,rotateAroundLocalRadians:()=>Hp,rotateAroundMatrix:()=>Ep,rotateAroundObject:()=>wp,rotateAroundObjectDegrees:()=>jp,rotateAroundObjectMatrix:()=>Np,rotateAroundObjectQuat:()=>Gp,rotateAroundObjectRadians:()=>zp,rotateAroundWorld:()=>Ap,rotateAroundWorldDegrees:()=>Rp,rotateAroundWorldMatrix:()=>Vp,rotateAroundWorldQuat:()=>Ip,rotateAroundWorldRadians:()=>Op,rotateAxisLocal:()=>bp,rotateAxisLocalDegrees:()=>Sp,rotateAxisLocalRadians:()=>vp,rotateAxisObject:()=>xp,rotateAxisObjectDegrees:()=>Mp,rotateAxisObjectRadians:()=>Dp,rotateAxisWorld:()=>Tp,rotateAxisWorldDegrees:()=>Pp,rotateAxisWorldRadians:()=>Cp,rotateLocal:()=>mp,rotateLocalDegrees:()=>yp,rotateLocalMatrix:()=>hp,rotateLocalQuat:()=>cp,rotateLocalRadians:()=>up,rotateMatrix:()=>np,rotateObject:()=>pp,rotateObjectDegrees:()=>dp,rotateObjectMatrix:()=>gp,rotateObjectQuat:()=>fp,rotateObjectRadians:()=>_p,rotateWorld:()=>op,rotateWorldDegrees:()=>sp,rotateWorldMatrix:()=>rp,rotateWorldQuat:()=>lp,rotateWorldRadians:()=>ap,rotationAroundAxis:()=>sh,rotationAroundAxisDegrees:()=>ah,rotationAroundAxisQuat:()=>lh,rotationAroundAxisRadians:()=>rh,rotationToPivoted:()=>Fu,rotationToPivotedDegrees:()=>wu,rotationToPivotedQuat:()=>zu,rotationToPivotedRadians:()=>ju,round:()=>jf,roundDecimal:()=>Hm,save:()=>XP,scaleObject:()=>$p,setActive:()=>t_,setActiveChildren:()=>m_,setActiveDescendants:()=>a_,setActiveDescendantsBreadth:()=>r_,setActiveDescendantsDepth:()=>l_,setActiveHierarchy:()=>n_,setActiveHierarchyBreadth:()=>o_,setActiveHierarchyDepth:()=>s_,setActiveObjects:()=>sg,setActiveSelf:()=>i_,setAlpha:()=>rC,setAudioManager:()=>_m,setAxesLocal:()=>dc,setAxesWorld:()=>pc,setBackwardLocal:()=>Tc,setBackwardWorld:()=>fc,setCharacterCollisionSystem:()=>wg,setCloneCallback:()=>HT,setClonePostProcessCallback:()=>jT,setClonedMaterials:()=>cC,setCollisionCheck:()=>kC,setConsoleVR:()=>gf,setDebugEnabled:()=>Lg,setDebugManager:()=>Rg,setDefaultResources:()=>Ef,setDefaultWLComponentCloneCallbacks:()=>QT,setDownLocal:()=>Sc,setDownWorld:()=>bc,setDummyServer:()=>bC,setEasyTuneTarget:()=>xf,setEasyTuneVariables:()=>Cf,setForwardLocal:()=>gc,setForwardWorld:()=>_c,setInputManager:()=>Ng,setLayerFlagsNames:()=>MP,setLeftLocal:()=>xc,setLeftWorld:()=>vc,setMainEngine:()=>nl,setName:()=>N_,setObjectAlpha:()=>lC,setObjectClonedMaterials:()=>yC,setObjectFogColor:()=>hC,setObjectMaterial:()=>mC,setObjectPoolManager:()=>bm,setObjectProperty:()=>qf,setObjectSpecularColor:()=>uC,setParent:()=>ad,setPoseForwardFixed:()=>mf,setPositionLocal:()=>ec,setPositionRotationDegreesScale:()=>My,setPositionRotationQuatScale:()=>Ey,setPositionRotationRadiansScale:()=>Dy,setPositionRotationScale:()=>xy,setPositionWorld:()=>$h,setRightLocal:()=>Dc,setRightWorld:()=>Mc,setRotationLocal:()=>rc,setRotationLocalDegrees:()=>lc,setRotationLocalMatrix:()=>yc,setRotationLocalQuat:()=>uc,setRotationLocalRadians:()=>mc,setRotationMatrix:()=>tc,setRotationWorld:()=>ic,setRotationWorldDegrees:()=>nc,setRotationWorldMatrix:()=>sc,setRotationWorldQuat:()=>ac,setRotationWorldRadians:()=>oc,setScaleLocal:()=>cc,setScaleWorld:()=>hc,setSceneObjects:()=>If,setSimultaneousPressMaxDelay:()=>ZC,setSimultaneousTouchMaxDelay:()=>YC,setToolEnabled:()=>cf,setTransform:()=>Ec,setTransformLocal:()=>Bc,setTransformLocalMatrix:()=>Lc,setTransformLocalQuat:()=>Hc,setTransformMatrix:()=>Ac,setTransformQuat:()=>Rc,setTransformWorld:()=>Oc,setTransformWorldMatrix:()=>Vc,setTransformWorldQuat:()=>Ic,setUpLocal:()=>Cc,setUpWorld:()=>Pc,setUseDummyServerOnError:()=>CC,setUseDummyServerOnSDKMissing:()=>PC,setVisualManager:()=>Rm,setVisualResources:()=>Mm,setWidgetCurrentVariable:()=>fb,sign:()=>Lm,signTo:()=>mu,sub:()=>Hy,subRotation:()=>th,subRotationDegrees:()=>ih,subRotationQuat:()=>oh,subRotationRadians:()=>nh,submitScore:()=>RC,submitScoreDummy:()=>OC,transformMat3:()=>Ny,transformMat4:()=>Gy,transformQuat:()=>zy,translate:()=>Kc,translateAxis:()=>$c,translateAxisLocal:()=>tp,translateAxisObject:()=>ip,translateAxisWorld:()=>ep,translateLocal:()=>Zc,translateObject:()=>Yc,translateWorld:()=>Jc,unregisterSessionEndEventListener:()=>mP,unregisterSessionStartEndEventListeners:()=>uP,unregisterSessionStartEventListener:()=>rP,unshiftUnique:()=>Ty,updateCeilingInfo:()=>GC,updateGroundInfo:()=>NC,valueAlongAxis:()=>nu,vec2_create:()=>Ae,vec3_create:()=>c,vec4_create:()=>F,wrapObject:()=>yg});import{ARCamera8thwall as Ib,Cursor as Bb,CursorTarget as Lb,DebugObject as Hb,DeviceOrientationLook as kb,FingerCursor as Fb,FixedFoveation as wb,HandTracking as jb,HitTestLocation as zb,HowlerAudioListener as Nb,HowlerAudioSource as Gb,ImageTexture as Wb,MouseLookComponent as Ub,PlayerHeight as Qb,TargetFramerate as qb,TeleportComponent as Xb,Trail as Kb,TwoJointIkSolver as Jb,VideoTexture as Zb,VrModeActiveSwitch as Yb,Vrm as $b,WasdControlsComponent as eS}from"@wonderlandengine/components";function Kr(i){i.registerComponent(Ib,Bb,Lb,Hb,kb,Fb,wb,jb,zb,Nb,Gb,Wb,Ub,Qb,qb,Xb,Kb,Jb,Zb,Yb,$b,eS)}import{AnimationComponent as bl,CollisionComponent as Pr,InputComponent as Sl,LightComponent as vl,MeshComponent as Cr,PhysXComponent as br,TextComponent as Sr,ViewComponent as xl}from"@wonderlandengine/api";import{ARCamera8thwall as eE,Anchor as tE,Cursor as iE,CursorTarget as nE,DebugObject as oE,DeviceOrientationLook as sE,FingerCursor as aE,FixedFoveation as rE,HandTracking as lE,HitTestLocation as mE,HowlerAudioListener as yE,HowlerAudioSource as uE,ImageTexture as hE,MouseLookComponent as cE,PlaneDetection as pE,PlayerHeight as dE,TargetFramerate as _E,TeleportComponent as gE,Trail as fE,TwoJointIkSolver as TE,VideoTexture as PE,VrModeActiveSwitch as CE,Vrm as bE,WasdControlsComponent as SE}from"@wonderlandengine/components";var Jr={};_t(Jr,{getAudioManager:()=>dm,hasAudioManager:()=>fm,removeAudioManager:()=>gm,setAudioManager:()=>_m});var Za=new WeakMap;function dm(i=r.getMainEngine()){return Za.get(i)}function _m(i,e=r.getMainEngine()){Za.set(e,i)}function gm(i=r.getMainEngine()){Za.delete(i)}function fm(i=r.getMainEngine()){return Za.has(i)}var Yr={};_t(Yr,{getBody:()=>Pm,getDocument:()=>Zr,getNavigator:()=>Tm,getWindow:()=>Ya});function Ya(i=r.getMainEngine()){return window}function Tm(i=r.getMainEngine()){return Ya(i).navigator}function Zr(i=r.getMainEngine()){return Ya(i).document}function Pm(i=r.getMainEngine()){return Zr(i).body}var $r={};_t($r,{getObjectPoolManager:()=>Cm,hasObjectPoolManager:()=>vm,removeObjectPoolManager:()=>Sm,setObjectPoolManager:()=>bm});var $a=new WeakMap;function Cm(i=r.getMainEngine()){return $a.get(i)}function bm(i,e=r.getMainEngine()){$a.set(e,i)}function Sm(i=r.getMainEngine()){$a.delete(i)}function vm(i=r.getMainEngine()){return $a.has(i)}var el={};_t(el,{getVisualManager:()=>Am,getVisualResources:()=>xm,hasVisualManager:()=>Vm,hasVisualResources:()=>Em,removeVisualManager:()=>Om,removeVisualResources:()=>Dm,setVisualManager:()=>Rm,setVisualResources:()=>Mm});var er=new WeakMap,tr=new WeakMap;function xm(i=r.getMainEngineinEngine()){return er.get(i)}function Mm(i,e=r.getMainEngine()){er.set(e,i)}function Dm(i=r.getMainEngine()){er.delete(i)}function Em(i=r.getMainEngine()){return er.has(i)}function Am(i=r.getMainEngine()){return tr.get(i)}function Rm(i,e=r.getMainEngine()){tr.set(e,i)}function Om(i=r.getMainEngine()){tr.delete(i)}function Vm(i=r.getMainEngine()){return tr.has(i)}var ml={};_t(ml,{addEngine:()=>sl,getCanvas:()=>Dg,getEngines:()=>xg,getMainEngine:()=>Jt,getPhysics:()=>Mg,getRoot:()=>RD,getScene:()=>ll,getWASM:()=>Eg,getXR:()=>Ag,hasEngine:()=>rl,initEngine:()=>vg,removeEngine:()=>al,removeMainEngine:()=>ol,setMainEngine:()=>nl});var he={linear:i=>i,easeIn:i=>i*i*i,easeOut:i=>(i-1)*(i-1)*(i-1)+1,easeInOut:i=>i<.5?4*i*i*i:(i-1)*(2*i-2)*(2*i-2)+1},ir=1e-6,Im=ir*ir,Bm=1e-5;function tS(i,e,t){let n=e??-Number.MAX_VALUE,o=t??Number.MAX_VALUE,s=Math.min(n,o),a=Math.max(n,o);return Math.min(Math.max(i,s),a)}function Lm(i,e=1){let t=Math.sign(i);return t==0&&(t=Math.sign(e)),t}function iS(i){return i*(180/Math.PI)}function nS(i){return i*(Math.PI/180)}function Hm(i,e){let t=Math.pow(10,e);return i=Math.round(i*t)/t,i}function km(i,e,t,n,o){if(e==t)return n;let s=L.clamp(i,e,t);if(s==e)return n;if(s==t)return o;let a=n+(o-n)/(t-e)*(s-e);return L.clamp(a,n,o)}function Fm(i=0,e=1){return Math.random()*(e-i)+i}function wm(i,e){let t=Math.min(i,e),n=Math.max(i,e);return Math.floor(Math.random()*(n-t+1)+t)}function jm(){return L.randomInt(0,1)==0}function zm(){return Math.random()<.5?1:-1}function Nm(...i){let e=null;if(i.length>0)if(i.length==1&&i[0].length!=null){if(i[0].length>0){let t=L.randomInt(0,i[0].length-1);e=i[0][t]}}else{let t=L.randomInt(0,i.length-1);e=i[t]}return e}var Gm=function(){let i=new Uint8Array(1),e=1e7+"-"+1e3+"-"+4e3+"-"+8e3+"-"+1e11,t=new RegExp("[018]","g"),n=o=>((o^crypto.getRandomValues(i)[0]&15)>>o/4).toString(16);return function(){let s="";return crypto.randomUUID!=null?s=crypto.randomUUID():s=e.replace(t,n),s}}();function oS(i,e,t){return t<=0?i:t>=1?e:t*(e-i)+i}function sS(i,e,t,n=he.linear){let o=n(t);return L.lerp(i,e,o)}function Wm(i,e){return L.angleDistanceDegrees(i,e)}function Um(i,e){return Math.abs(L.angleDistanceSignedDegrees(i,e))}function Qm(i,e){return Math.abs(L.angleDistanceSignedRadians(i,e))}function qm(i,e){return L.angleDistanceSignedDegrees(i,e)}function Xm(i,e){let t=L.angleClampDegrees(i,!0),n=L.angleClampDegrees(e,!0),o=n-t;return n-t>180?o=n-t-360:n-t<-180&&(o=n-t+360),o}function Km(i,e){return L.toRadians(L.angleDistanceSignedDegrees(L.toDegrees(i),L.toDegrees(e)))}function Jm(i,e=!1){return L.angleClampDegrees(i,e)}function Zm(i,e=!1){let t=i%360;return t<0&&(t+=360),e||t>180&&(t-=360),t}function Ym(i,e=!1){return L.toRadians(L.angleClampDegrees(L.toDegrees(i),e))}function $m(i,e,t,n=!1){return L.isInsideAngleRangeDegrees(i,e,t,n)}function ey(i,e,t,n=!1){let o=!1,s=L.angleClampDegrees(i,!0),a=L.angleClampDegrees(e,!0),l=L.angleClampDegrees(t,!0);if(n&&L.angleDistanceSignedDegrees(a,l)<0){let u=a;a=l,l=u}return a<l?o=s>=a&&s<=l:o=s>=a||s<=l,o}function ty(i,e,t,n=!1){return L.isInsideAngleRangeDegrees(L.toDegrees(i),L.toDegrees(e),L.toDegrees(t),n)}var L={EPSILON:ir,EPSILON_SQUARED:Im,EPSILON_DEGREES:Bm,clamp:tS,sign:Lm,toDegrees:iS,toRadians:nS,roundDecimal:Hm,mapToRange:km,random:Fm,randomInt:wm,randomBool:jm,randomSign:zm,randomPick:Nm,randomUUID:Gm,lerp:oS,interpolate:sS,angleDistance:Wm,angleDistanceDegrees:Um,angleDistanceRadians:Qm,angleDistanceSigned:qm,angleDistanceSignedDegrees:Xm,angleDistanceSignedRadians:Km,angleClamp:Jm,angleClampDegrees:Zm,angleClampRadians:Ym,isInsideAngleRange:$m,isInsideAngleRangeDegrees:ey,isInsideAngleRangeRadians:ty};import{mat3 as tl,quat as pM}from"gl-matrix";import{mat3 as gx,quat as Ze}from"gl-matrix";function iy(i){return i.length>0?i[0]:void 0}function ny(i){return i.length>0?i[i.length-1]:void 0}function aS(i,e){return K.find(i,e)!=null}function oy(i,e,t=null){return K.findEqual(i,e,t)!=null}function sy(i,e){let t,n=i.findIndex(e);return n>=0&&(t=i[n]),t}function ay(i,e){return i.findIndex(e)}function ry(i,e){return i.filter(e)}function ly(i,e){let t=[];for(let n=0;n<i.length;n++){let o=i[n];e(o)&&t.push(n)}return t}function my(i,e,t=null){if(t==null){let o=K.findIndexEqual(i,e);return o<0?void 0:i[o]}let n;for(let o=0;o<i.length;o++){let s=i[o];if(t(s,e)){n=s;break}}return n}function yy(i,e,t=null){if(t==null)return Py(i,e,!1);let n=[];for(let o=0;o<i.length;o++){let s=i[o];t(s,e)&&n.push(s)}return n}function uy(i,e,t=null){if(t==null)return i.indexOf(e);let n=-1;for(let o=0;o<i.length;o++){let s=i[o];if(t(s,e)){n=o;break}}return n}function hy(i,e,t=null){if(t==null)return Py(i,e,!0);let n=[];for(let o=0;o<i.length;o++){let s=i[o];t(s,e)&&n.push(o)}return n}function cy(i,e){let t;if(e>=0&&e<i.length){let n=i.splice(e,1);n.length==1&&(t=n[0])}return t}function py(i,e){let t=[];for(let n of e){let o=K.removeIndex(i,n);o!==void 0&&t.push(o)}return t}function rS(i,e){let t,n=i.findIndex(e);return n>=0&&(t=K.removeIndex(i,n)),t}function dy(i,e){let t=[],n;do n=K.remove(i,e),n!==void 0&&t.push(n);while(n!==void 0);return t}function _y(i,e,t=null){return K.removeIndex(i,K.findIndexEqual(i,e,t))}function gy(i,e,t=null){return K.removeAllIndexes(i,K.findAllIndexesEqual(i,e,t))}function fy(i,e,t=null){let n=i.length;return K.hasEqual(i,e,t)||(n=i.push(e)),n}function Ty(i,e,t=null){let n=i.length;return K.hasEqual(i,e,t)||(n=i.unshift(e)),n}function lS(i,e,t=null){for(;e.length>i.length;)e.pop();for(let n=0;n<i.length;n++)t==null?e[n]=i[n]:e[n]=t(e[n],i[n]);return e}function mS(i,e=null){if(e==null)return i.slice(0);let t=null;switch(i.constructor.name){case"Array":t=new Array(i.length);break;case"Uint8ClampedArray":t=new Uint8ClampedArray(i.length);break;case"Uint8Array":t=new Uint8Array(i.length);break;case"Uint16Array":t=new Uint16Array(i.length);break;case"Uint32Array":t=new Uint32Array(i.length);break;case"Int8Array":t=new Int8Array(i.length);break;case"Int16Array":t=new Int16Array(i.length);break;case"Int32Array":t=new Int32Array(i.length);break;case"Float32Array":t=new Float32Array(i.length);break;case"Float64Array":t=new Float64Array(i.length);break;default:t=new Array(i.length),console.error("Cloned array type not supported!");break}for(let n=0;n<i.length;n++)t[n]=K.cloneCallback(i[n]);return t}function yS(i,e,t=null){let n=!0;if(e!=null&&i.length==e.length){for(let o=0;o<i.length;o++)if(t!=null&&!t(i[o],e[o])||t==null&&i[o]!=e[o]){n=!1;break}}else n=!1;return n}function uS(i){return i.length=0,i}var K={first:iy,last:ny,has:aS,hasEqual:oy,find:sy,findIndex:ay,findAll:ry,findAllIndexes:ly,findEqual:my,findAllEqual:yy,findIndexEqual:uy,findAllIndexesEqual:hy,removeIndex:cy,removeAllIndexes:py,remove:rS,removeAll:dy,removeEqual:_y,removeAllEqual:gy,pushUnique:fy,unshiftUnique:Ty,copy:lS,clone:mS,equals:yS,clear:uS};function Py(i,e,t){let n=[],o=-1;for(;(o=i.indexOf(e,o+1))>=0;)n.push(t?o:i[o]);return n}import{vec3 as He}from"gl-matrix";import{mat4 as vt}from"gl-matrix";import{mat4 as hS,quat2 as gt}from"gl-matrix";function Cy(i,e,t,n,o,s,a,l){let u=gt.create();return i!==void 0&&by(u,i,e,t,n,o,s,a,l),u}function by(i,e,t,n,o,s,a,l,u){return t===void 0?gt.set(i,e,e,e,e,e,e,e,e):gt.set(i,e,t,n,o,s,a,l,u),i}function cS(i,e=V.create()){return gt.normalize(e,i),e}function pS(i,e=V.create()){return gt.invert(e,i),e}function dS(i,e=V.create()){return gt.conjugate(e,i),e}function _S(i,e){return gt.copy(e,i),e}function gS(i){return gt.identity(i),i}function fS(i,e=p.create()){return gt.getTranslation(e,i),e}function TS(i,e){return V.getRotationDegrees(i,e)}var PS=function(){let i=X();return function(t,n=p.create()){return T.toDegrees(V.getRotationQuat(t,i),n),n}}(),CS=function(){let i=X();return function(t,n=p.create()){return T.toRadians(V.getRotationQuat(t,i),n),n}}();function bS(i,e=T.create()){return T.copy(i,e),e}var SS=function(){let i=X();return function(t,n){return V.getRotationQuat(t,i),V.setPositionRotationQuat(t,n,i),t}}();function vS(i,e){return V.setRotationDegrees(i,e)}var xS=function(){let i=W();return function(t,n){return V.getPosition(t,i),V.setPositionRotationDegrees(t,i,n),t}}(),MS=function(){let i=W();return function(t,n){return V.getPosition(t,i),V.setPositionRotationRadians(t,i,n),t}}(),DS=function(){let i=W();return function(t,n){return V.getPosition(t,i),V.setPositionRotationQuat(t,i,n),t}}();function ES(i,e,t){return V.setPositionRotationDegrees(i,e,t)}var AS=function(){let i=X();return function(t,n,o){return p.degreesToQuat(o,i),V.setPositionRotationQuat(t,n,i),t}}(),RS=function(){let i=X();return function(t,n,o){return p.radiansToQuat(o,i),V.setPositionRotationQuat(t,n,i),t}}();function OS(i,e,t){return gt.fromRotationTranslation(i,t,e),i}function VS(i,e=L.EPSILON){return Math.abs(V.lengthSquared(i)-1)<e}function IS(i){return gt.length(i)}function BS(i){return gt.squaredLength(i)}function LS(i,e,t=V.create()){return gt.mul(t,i,e),t}function HS(i,e=[p.create(),p.create(),p.create()]){return V.getLeft(i,e[0]),V.getUp(i,e[1]),V.getForward(i,e[2]),e}var kS=function(){let i=At();return function(t,n=p.create()){return T.toMatrix(t,i),p.set(n,i[6],i[7],i[8]),n}}();function FS(i,e){return e=V.getForward(i,e),p.negate(e,e),e}var wS=function(){let i=At();return function(t,n=p.create()){return T.toMatrix(t,i),p.set(n,i[0],i[1],i[2]),n}}();function jS(i,e){return e=V.getLeft(i,e),p.negate(e,e),e}var zS=function(){let i=At();return function(t,n=p.create()){return T.toMatrix(t,i),p.set(n,i[3],i[4],i[5]),n}}();function NS(i,e){return e=V.getUp(i,e),p.negate(e,e),e}function GS(i,e,t=V.create()){return V.mul(e,i,t),t}var WS=function(){let i=Cy();return function(t,n,o=V.create()){return V.conjugate(n,i),V.mul(i,t,o),o}}();function US(i,e,t,n){return V.rotateAxisDegrees(i,e,t,n)}function QS(i,e,t,n){return V.rotateAxisRadians(i,L.toRadians(e),t,n)}var qS=function(){let i=X();return function(t,n,o,s=V.create()){return V.getRotationQuat(t,i),T.rotateAxisRadians(i,n,o,i),V.copy(t,s),V.setRotationQuat(s,i),s}}();function XS(i,e=O.create()){return hS.fromQuat2(e,i),e}function Sy(i,e=V.create()){return O.toQuat(i,e),e}function KS(i,e,t,n=V.create()){return t<=0?(V.copy(i,n),n):t>=1?(V.copy(e,n),n):(gt.lerp(n,i,e,t),n)}function JS(i,e,t,n=he.linear,o=V.create()){let s=n(t);return V.lerp(i,e,s,o)}var ZS=function(){let i=W(),e=W(),t=W(),n=X(),o=X(),s=X();return function(l,u,_,m=V.create()){return _<=0?(V.copy(l,m),m):_>=1?(V.copy(u,m),m):(V.getPosition(l,i),V.getPosition(u,e),V.getRotationQuat(l,n),V.getRotationQuat(u,o),p.lerp(i,e,_,t),T.slerp(n,o,_,s),V.setPositionRotationQuat(m,t,s),m)}}();function YS(i,e,t,n=he.linear,o=V.create()){let s=n(t);return V.slerp(i,e,s,o)}var V={create:Cy,set:by,normalize:cS,invert:pS,conjugate:dS,copy:_S,identity:gS,getPosition:fS,getRotation:TS,getRotationDegrees:PS,getRotationRadians:CS,getRotationQuat:bS,setPosition:SS,setRotation:vS,setRotationDegrees:xS,setRotationRadians:MS,setRotationQuat:DS,setPositionRotation:ES,setPositionRotationDegrees:AS,setPositionRotationRadians:RS,setPositionRotationQuat:OS,isNormalized:VS,length:IS,lengthSquared:BS,mul:LS,getAxes:HS,getForward:kS,getBackward:FS,getLeft:wS,getRight:jS,getUp:zS,getDown:NS,toWorld:GS,toLocal:WS,rotateAxis:US,rotateAxisDegrees:QS,rotateAxisRadians:qS,toMatrix:XS,fromMatrix:Sy,lerp:KS,interpolate:JS,slerp:ZS,sinterpolate:YS};function Ri(i,e,t,n,o,s,a,l,u,_,m,h,d,g,P,C){let f=vt.create();return i!==void 0&&vy(f,i,e,t,n,o,s,a,l,u,_,m,h,d,g,P,C),f}function vy(i,e,t,n,o,s,a,l,u,_,m,h,d,g,P,C,f){return t===void 0?vt.set(i,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e):vt.set(i,e,t,n,o,s,a,l,u,_,m,h,d,g,P,C,f),i}function $S(i,e){return vt.copy(e,i),e}function ev(i){return vt.identity(i),i}function tv(i,e=O.create()){return vt.invert(e,i),e}function iv(i,e,t=O.create()){return vt.mul(t,i,e),t}function nv(i,e,t=O.create()){return vt.scale(t,i,e),t}function ov(i,e=O.create()){return O.copy(i,e),e}function sv(i,e=p.create()){return vt.getTranslation(e,i),e}function av(i,e=p.create()){return O.getRotationDegrees(i,e)}var rv=function(){let i=X();return function(t,n=p.create()){return O.getRotationQuat(t,i),T.toDegrees(i,n),n}}(),lv=function(){let i=X();return function(t,n=p.create()){return O.getRotationQuat(t,i),T.toRadians(i,n),n}}(),mv=function(){let i=W(),e=Ri(),t=W(),n=W();return Oi(n,1,1,1),function(s,a=T.create()){return O.getScale(s,i),p.div(n,i,t),O.scale(s,t,e),vt.getRotation(a,e),a}}();function yv(i,e=p.create()){return vt.getScaling(e,i),e}function uv(i,e){return i[12]=e[0],i[13]=e[1],i[14]=e[2],i}function hv(i,e){return O.setRotationDegrees(i,e),i}var cv=function(){let i=X();return function(t,n){return O.setRotationQuat(t,p.degreesToQuat(n,i)),t}}(),pv=function(){let i=W();return function(t,n){return O.setRotationDegrees(t,p.toDegrees(n,i)),t}}(),dv=function(){let i=W(),e=W();return function(n,o){return O.getPosition(n,i),O.getScale(n,e),O.setPositionRotationQuatScale(n,i,o,e),n}}(),_v=function(){let i=W();return function(t,n){return O.getScale(t,i),p.div(n,i,i),O.scale(t,i,t),t}}();function xy(i,e,t,n){return O.setPositionRotationDegreesScale(i,e,t,n),i}var My=function(){let i=X();return function(t,n,o,s){return O.setPositionRotationQuatScale(t,n,p.degreesToQuat(o,i),s),t}}(),Dy=function(){let i=W();return function(t,n,o,s){return O.setPositionRotationDegreesScale(t,n,p.toDegrees(o,i),s),t}}();function Ey(i,e,t,n){return vt.fromRotationTranslationScale(i,t,e,n),i}function gv(i,e,t){return O.setPositionRotationDegrees(i,e,t),i}var fv=function(){let i=X();return function(t,n,o){return O.setPositionRotationQuat(t,n,p.degreesToQuat(o,i)),t}}(),Tv=function(){let i=W();return function(t,n,o){return O.setPositionRotationDegrees(t,n,p.toDegrees(o,i)),t}}();function Pv(i,e,t){return vt.fromRotationTranslation(i,t,e),i}function Cv(i,e=[p.create(),p.create(),p.create()]){return O.getLeft(i,e[0]),O.getUp(i,e[1]),O.getForward(i,e[2]),e}function bv(i,e=p.create()){return p.set(e,i[8],i[9],i[10]),p.normalize(e,e),e}function Sv(i,e){return e=O.getForward(i,e),p.negate(e,e),e}function vv(i,e=p.create()){return p.set(e,i[0],i[1],i[2]),p.normalize(e,e),e}function xv(i,e){return e=O.getLeft(i,e),p.negate(e,e),e}function Mv(i,e=p.create()){return p.set(e,i[4],i[5],i[6]),p.normalize(e,e),e}function Dv(i,e){return e=O.getUp(i,e),p.negate(e,e),e}var Ev=function(){let i=Ri(),e=W(),t=W(),n=W(),o=W();return Oi(o,1,1,1),function(a,l,u=O.create()){return O.hasUniformScale(l)?O.mul(l,a,u):(p.set(e,a[12],a[13],a[14]),p.convertPositionToWorldMatrix(e,l,e),O.getScale(l,t),p.div(o,t,n),O.scale(l,n,i),O.mul(i,a,u),O.scale(u,t,u),u[12]=e[0],u[13]=e[1],u[14]=e[2],u[15]=1),u}}(),Av=function(){let i=Ri(),e=W(),t=W(),n=W(),o=W();return Oi(o,1,1,1),function(a,l,u=O.create()){return O.hasUniformScale(l)?(O.invert(l,i),O.mul(i,a,u)):(p.set(e,a[12],a[13],a[14]),p.convertPositionToLocalMatrix(e,l,e),O.getScale(l,t),p.div(o,t,n),O.scale(l,n,i),O.invert(i,i),O.mul(i,a,u),O.scale(u,n,u),u[12]=e[0],u[13]=e[1],u[14]=e[2],u[15]=1),u}}(),Rv=function(){let i=W();return function(t){return O.getScale(t,i),Math.abs(i[0]-i[1])<L.EPSILON&&Math.abs(i[1]-i[2])<L.EPSILON&&Math.abs(i[0]-i[2])<L.EPSILON}}(),Ov=function(){let i=W(),e=X();return function(n,o=V.create()){return O.getPosition(n,i),O.getRotationQuat(n,e),V.setPositionRotationQuat(o,i,e),o}}();function Ay(i,e=O.create()){return V.toMatrix(i,e),e}var O={create:Ri,set:vy,copy:$S,identity:ev,invert:tv,mul:iv,scale:nv,clone:ov,getPosition:sv,getRotation:av,getRotationDegrees:rv,getRotationRadians:lv,getRotationQuat:mv,getScale:yv,setPosition:uv,setRotation:hv,setRotationDegrees:cv,setRotationRadians:pv,setRotationQuat:dv,setScale:_v,setPositionRotationScale:xy,setPositionRotationDegreesScale:My,setPositionRotationRadiansScale:Dy,setPositionRotationQuatScale:Ey,setPositionRotation:gv,setPositionRotationDegrees:fv,setPositionRotationRadians:Tv,setPositionRotationQuat:Pv,getAxes:Cv,getForward:bv,getBackward:Sv,getLeft:vv,getRight:xv,getUp:Mv,getDown:Dv,toWorld:Ev,toLocal:Av,hasUniformScale:Rv,toQuat:Ov,fromQuat:Ay};function W(i,e,t){let n=He.create();return i!==void 0&&Oi(n,i,e,t),n}function Oi(i,e,t,n){return t===void 0?He.set(i,e,e,e):He.set(i,e,t,n),i}function Vv(i,e=p.create()){return He.normalize(e,i),e}function Iv(i,e){return He.copy(e,i),e}function Bv(i,e=p.create()){return p.copy(i,e),e}function Lv(i){return He.zero(i),i}function Ry(i,e){return p.angleDegrees(i,e)}function Oy(i,e){return L.toDegrees(p.angleRadians(i,e))}function Vy(i,e){let t=i[0],n=i[1],o=i[2],s=e[0],a=e[1],l=e[2],u=t*t+n*n+o*o,_=s*s+a*a+l*l,m=u*_,h=0;if(m>L.EPSILON_SQUARED){let d=Math.sqrt(m),g=p.dot(i,e)/d;h=Math.acos(L.clamp(g,-1,1))}return h}function Hv(i,e,t=0){let n=i.length==e.length;return n&&(n&&=Math.abs(i[0]-e[0])<=t,n&&=Math.abs(i[1]-e[1])<=t,n&&=Math.abs(i[2]-e[2])<=t),n}function kv(i){return He.length(i)}function Fv(i){return He.squaredLength(i)}function Iy(i,e){return He.dist(i,e)}function By(i,e){return He.squaredDistance(i,e)}function Ly(i,e,t=p.create()){return He.add(t,i,e),t}function Hy(i,e,t=p.create()){return He.sub(t,i,e),t}function wv(i,e,t=p.create()){return He.mul(t,i,e),t}function ky(i,e,t=p.create()){return He.div(t,i,e),t}function jv(i,e,t=p.create()){return He.scale(t,i,e),t}function Fy(i,e){return He.dot(i,e)}function wy(i,e=p.create()){return He.negate(e,i),e}function jy(i,e,t=p.create()){return He.cross(t,i,e),t}function zy(i,e,t=p.create()){return He.transformQuat(t,i,e),t}function Ny(i,e,t=p.create()){return He.transformMat3(t,i,e),t}function Gy(i,e,t=p.create()){return He.transformMat4(t,i,e),t}function Wy(i,e){let t=p.length(i);return p.isConcordant(i,e)||(t*=-1),t}function Uy(i,e,t){return p.angleSignedDegrees(i,e,t)}function Qy(i,e,t){return L.toDegrees(p.angleSignedRadians(i,e,t))}var qy=function(){let i=W();return function(t,n,o){p.cross(t,n,i);let s=p.angleRadians(t,n);return p.isConcordant(i,o)||(s=-s),s}}();function Xy(i,e,t){return p.anglePivotedDegrees(i,e,t)}function Ky(i,e,t){return L.toDegrees(p.anglePivotedRadians(i,e,t))}var Jy=function(){let i=W(),e=W();return function(n,o,s){return i=p.removeComponentAlongAxis(n,s,i),e=p.removeComponentAlongAxis(o,s,e),p.angleRadians(i,e)}}();function Zy(i,e,t){return p.anglePivotedSignedDegrees(i,e,t)}function Yy(i,e,t){return L.toDegrees(p.anglePivotedSignedRadians(i,e,t))}var $y=function(){let i=W(),e=W();return function(n,o,s){return i=p.removeComponentAlongAxis(n,s,i),e=p.removeComponentAlongAxis(o,s,e),p.angleSignedRadians(i,e,s)}}();function zv(i,e=p.create()){return p.set(e,L.toRadians(i[0]),L.toRadians(i[1]),L.toRadians(i[2])),e}function Nv(i,e=p.create()){return p.set(e,L.toDegrees(i[0]),L.toDegrees(i[1]),L.toDegrees(i[2])),e}function Gv(i,e){return p.degreesToQuat(i,e)}function eu(i,e=T.create()){return T.fromRadians(i,e),e}function tu(i,e=T.create()){return T.fromDegrees(i,e),e}function Wv(i,e=L.EPSILON){return Math.abs(p.lengthSquared(i)-1)<e}function Uv(i,e=0){return p.lengthSquared(i)<=e*e}function iu(i,e,t=p.create()){let n=p.dot(i,e);return p.copy(e,t),p.scale(t,n,t),t}function nu(i,e){return p.dot(i,e)}var ou=function(){let i=W();return function(t,n,o=p.create()){return p.componentAlongAxis(t,n,i),p.sub(t,i,o),o}}(),su=function(){let i=W();return function(t,n,o,s=p.create()){return p.removeComponentAlongAxis(n,o,s),p.componentAlongAxis(t,o,i),p.add(s,i,s),s}}();function au(i,e){return p.dot(i,e)>=0}function ru(i,e,t){return p.valueAlongAxis(i,t)>p.valueAlongAxis(e,t)}function lu(i,e,t){return p.signTo(i,e,t)>=0}var mu=function(){let i=W(),e=W();return function(n,o,s,a=1){p.removeComponentAlongAxis(n,s,i),p.removeComponentAlongAxis(o,s,e);let l=p.angleSigned(n,o,s);return l>0?1:l==0?a:-1}}();function yu(i,e,t=p.create()){return p.componentAlongAxis(i,e,t),t}var uu=function(){let i=W(),e=W(),t=W();return function(o,s,a,l=p.create()){if(p.isOnAxis(o,s)||p.isOnAxis(a,s))p.copy(o,l);else if(p.cross(a,s,i),p.normalize(i,i),p.removeComponentAlongAxis(o,i,l),!p.isOnAxis(l,s)){p.projectOnAxis(l,s,e),p.sub(e,l,e),p.isConcordant(e,a)?p.copy(a,t):p.negate(a,t);let u=p.angleRadians(t,e),_=p.length(e)/Math.cos(u);p.scale(t,_,t),p.add(l,t,l),p.projectOnAxis(l,s,l)}return l}}();function hu(i,e,t=p.create()){return p.removeComponentAlongAxis(i,e,t),t}var cu=function(){let i=W(),e=W();return function(n,o,s,a=p.create()){if(p.isOnPlane(n,o)||p.isOnPlane(s,o))p.copy(n,a);else{p.copy(n,a),p.projectOnPlane(a,o,i),p.sub(i,a,i),p.isConcordant(i,s)?p.copy(s,e):p.negate(s,e);let l=p.angleRadians(e,i),u=p.length(i)/Math.cos(l);p.scale(e,u,e),p.add(a,e,a),p.projectOnPlane(a,o,a)}return a}}();function pu(i,e){let t=p.angle(i,e);return Math.abs(t)<L.EPSILON_DEGREES||Math.abs(t-180)<L.EPSILON_DEGREES}function du(i,e){let t=p.angle(i,e);return Math.abs(t-90)<L.EPSILON_DEGREES}function Qv(i,e,t){return p.rotateDegrees(i,e,t)}var qv=function(){let i=W();return function(t,n,o){return p.rotateAroundDegrees(t,n,i,o)}}(),Xv=function(){let i=W();return function(t,n,o){return p.rotateAroundRadians(t,n,i,o)}}(),Kv=function(){let i=W();return function(t,n,o){return p.rotateAroundQuat(t,n,i,o)}}();function Jv(i,e,t,n){return p.rotateAxisDegrees(i,e,t,n)}var Zv=function(){let i=W();return function(t,n,o,s){return p.rotateAroundAxisDegrees(t,n,o,i,s)}}(),Yv=function(){let i=W();return function(t,n,o,s){return p.rotateAroundAxisRadians(t,n,o,i,s)}}();function $v(i,e,t,n){return p.rotateAroundDegrees(i,e,t,n)}var ex=function(){let i=X();return function(t,n,o,s=p.create()){return p.degreesToQuat(n,i),p.rotateAroundQuat(t,i,o,s)}}(),tx=function(){let i=X();return function(t,n,o,s=p.create()){return p.radiansToQuat(n,i),p.rotateAroundQuat(t,i,o,s)}}();function ix(i,e,t,n=p.create()){return p.sub(i,t,n),p.transformQuat(n,e,n),p.add(n,t,n),n}function nx(i,e,t,n,o){return p.rotateAroundAxisDegrees(i,e,t,n,o)}function ox(i,e,t,n,o){return p.rotateAroundAxisRadians(i,L.toRadians(e),t,n,o)}var sx=function(){let i=X();return function(t,n,o,s,a=p.create()){return T.fromAxisRadians(n,o,i),p.rotateAroundQuat(t,i,s,a)}}();function _u(i,e,t){return p.convertPositionToWorldMatrix(i,e,t)}function gu(i,e,t){return p.convertPositionToLocalMatrix(i,e,t)}function fu(i,e,t=p.create()){return p.transformMat4(i,e,t),t}var Tu=function(){let i=Ri();return function(t,n,o=p.create()){return O.invert(n,i),p.transformMat4(t,i,o),o}}(),Pu=function(){let i=Ri(),e=W(),t=X(),n=W();return Oi(n,1,1,1),function(s,a,l=p.create()){return V.getPosition(a,e),V.getRotationQuat(a,t),O.setPositionRotationQuatScale(i,e,t,n),p.convertPositionToWorldMatrix(s,i,l)}}(),Cu=function(){let i=Ri(),e=W(),t=X(),n=W();return Oi(n,1,1,1),function(s,a,l=p.create()){return V.getPosition(a,e),V.getRotationQuat(a,t),O.setPositionRotationQuatScale(i,e,t,n),p.convertPositionToLocalMatrix(s,i,l)}}();function bu(i,e,t){return p.convertDirectionToWorldMatrix(i,e,t)}function Su(i,e,t){return p.convertDirectionToLocalMatrix(i,e,t)}var vu=function(){let i=X();return function(t,n,o=p.create()){return O.getRotationQuat(n,i),p.transformQuat(t,i,o),o}}(),xu=function(){let i=X();return function(t,n,o=p.create()){return O.getRotationQuat(n,i),T.conjugate(i,i),p.transformQuat(t,i,o),o}}(),Mu=function(){let i=X();return function(t,n,o=p.create()){return V.getRotationQuat(n,i),p.transformQuat(t,i,o),o}}(),Du=function(){let i=X();return function(t,n,o=p.create()){return V.getRotationQuat(n,i),T.conjugate(i,i),p.transformQuat(t,i,o),o}}();function ax(i,e,t){return p.degreesAddRotation(i,e,t)}function rx(i,e,t){return p.degreesAddRotationDegrees(i,e,t)}function lx(i,e,t){return p.degreesAddRotationRadians(i,e,t)}function mx(i,e,t){return p.degreesAddRotationQuat(i,e,t)}function Eu(i,e,t){return p.degreesAddRotationDegrees(i,e,t)}var Au=function(){let i=X();return function(t,n,o=p.create()){return p.degreesToQuat(t,i),T.toDegrees(T.addRotationDegrees(i,n,i),o)}}(),Ru=function(){let i=X();return function(t,n,o=p.create()){return p.degreesToQuat(t,i),T.toDegrees(T.addRotationRadians(i,n,i),o)}}(),Ou=function(){let i=X();return function(t,n,o=p.create()){return p.degreesToQuat(t,i),T.toDegrees(T.addRotationQuat(i,n,i),o)}}();function Vu(i,e,t){return p.radiansAddRotationDegrees(i,e,t)}var Iu=function(){let i=X();return function(t,n,o=p.create()){return p.radiansToQuat(t,i),T.toRadians(T.addRotationDegrees(i,n,i),o)}}(),Bu=function(){let i=X();return function(t,n,o=p.create()){return p.radiansToQuat(t,i),T.toRadians(T.addRotationRadians(i,n,i),o)}}(),Lu=function(){let i=X();return function(t,n,o=p.create()){return p.radiansToQuat(t,i),T.toRadians(T.addRotationQuat(i,n,i),o)}}();function yx(i,e=Y.create()){return p.degreesToMatrix(i,e)}var Hu=function(){let i=X();return function(t,n=Y.create()){return p.degreesToQuat(t,i),T.toMatrix(i,n)}}(),ku=function(){let i=X();return function(t,n=Y.create()){return p.radiansToQuat(t,i),T.toMatrix(i,n)}}();function ux(i,e,t){return p.rotationToDegrees(i,e,t)}var hx=function(){let i=X();return function(t,n,o=p.create()){return p.rotationToQuat(t,n,i),T.toDegrees(i,o),o}}(),cx=function(){let i=X();return function(t,n,o=p.create()){return p.rotationToQuat(t,n,i),T.toRadians(i,o),o}}(),px=function(){let i=W();return function(t,n,o=T.create()){p.cross(t,n,i),p.normalize(i,i);let s=p.angleSigned(t,n,i);return T.fromAxisRadians(s,i,o),o}}();function Fu(i,e,t,n){return p.rotationToPivotedDegrees(i,e,t,n)}var wu=function(){let i=X();return function(t,n,o,s=p.create()){return p.rotationToPivotedQuat(t,n,o,i),T.toDegrees(i,s),s}}(),ju=function(){let i=X();return function(t,n,o,s=p.create()){return p.rotationToPivotedQuat(t,n,o,i),T.toRadians(i,s),s}}(),zu=function(){let i=W(),e=W(),t=W();return function(o,s,a,l=T.create()){p.removeComponentAlongAxis(o,a,i),p.removeComponentAlongAxis(s,a,e),p.cross(i,e,t),p.normalize(t,t);let u=p.angleSignedRadians(i,e,t);return T.fromAxisRadians(u,t,l),l}}();function dx(i,e,t,n=p.create()){return t<=0?(p.copy(i,n),n):t>=1?(p.copy(e,n),n):(He.lerp(n,i,e,t),n)}function _x(i,e,t,n=he.linear,o=p.create()){let s=n(t);return p.lerp(i,e,s,o)}var Nu=function(){let i=W();return function(t,n=p.create()){if(p.isZero(t))return p.zero(n);p.copy(t,i);let o=!1;for(let s=0;s<3;s++)t[s]==0&&o++;return o==2?i[0]==0?i[0]=1:i[1]==0?i[1]=1:i[2]==0&&(i[2]=1):i[0]!=0?i[0]=-i[0]:i[1]!=0?i[1]=-i[1]:i[2]!=0&&(i[2]=-i[2]),p.cross(i,t,n),n}}(),p={create:W,set:Oi,normalize:Vv,copy:Iv,clone:Bv,zero:Lv,angle:Ry,angleDegrees:Oy,angleRadians:Vy,equals:Hv,length:kv,lengthSquared:Fv,distance:Iy,distanceSquared:By,add:Ly,sub:Hy,mul:wv,div:ky,scale:jv,dot:Fy,negate:wy,cross:jy,transformQuat:zy,transformMat3:Ny,transformMat4:Gy,lengthSigned:Wy,angleSigned:Uy,angleSignedDegrees:Qy,angleSignedRadians:qy,anglePivoted:Xy,anglePivotedDegrees:Ky,anglePivotedRadians:Jy,anglePivotedSigned:Zy,anglePivotedSignedDegrees:Yy,anglePivotedSignedRadians:$y,toRadians:zv,toDegrees:Nv,toQuat:Gv,radiansToQuat:eu,degreesToQuat:tu,isNormalized:Wv,isZero:Uv,componentAlongAxis:iu,valueAlongAxis:nu,removeComponentAlongAxis:ou,copyComponentAlongAxis:su,isConcordant:au,isFartherAlongAxis:ru,isToTheRight:lu,signTo:mu,projectOnAxis:yu,projectOnAxisAlongAxis:uu,projectOnPlane:hu,projectOnPlaneAlongAxis:cu,isOnAxis:pu,isOnPlane:du,rotate:Qv,rotateDegrees:qv,rotateRadians:Xv,rotateQuat:Kv,rotateAxis:Jv,rotateAxisDegrees:Zv,rotateAxisRadians:Yv,rotateAround:$v,rotateAroundDegrees:ex,rotateAroundRadians:tx,rotateAroundQuat:ix,rotateAroundAxis:nx,rotateAroundAxisDegrees:ox,rotateAroundAxisRadians:sx,convertPositionToWorld:_u,convertPositionToLocal:gu,convertPositionToWorldMatrix:fu,convertPositionToLocalMatrix:Tu,convertPositionToWorldQuat:Pu,convertPositionToLocalQuat:Cu,convertDirectionToWorld:bu,convertDirectionToLocal:Su,convertDirectionToWorldMatrix:vu,convertDirectionToLocalMatrix:xu,convertDirectionToWorldQuat:Mu,convertDirectionToLocalQuat:Du,addRotation:ax,addRotationDegrees:rx,addRotationRadians:lx,addRotationQuat:mx,degreesAddRotation:Eu,degreesAddRotationDegrees:Au,degreesAddRotationRadians:Ru,degreesAddRotationQuat:Ou,radiansAddRotation:Vu,radiansAddRotationDegrees:Iu,radiansAddRotationRadians:Bu,radiansAddRotationQuat:Lu,toMatrix:yx,degreesToMatrix:Hu,radiansToMatrix:ku,rotationTo:ux,rotationToDegrees:hx,rotationToRadians:cx,rotationToQuat:px,rotationToPivoted:Fu,rotationToPivotedDegrees:wu,rotationToPivotedRadians:ju,rotationToPivotedQuat:zu,lerp:dx,interpolate:_x,perpendicularRandom:Nu};function X(i,e,t,n){let o=Ze.create();return i!==void 0&&T.set(o,i,e,t,n),o}function fx(i,e,t,n,o){return t===void 0?Ze.set(i,e,e,e,e):Ze.set(i,e,t,n,o),i}function Tx(i,e=T.create()){return Ze.normalize(e,i),e}function Px(i,e){return Ze.copy(e,i),e}function Cx(i,e=T.create()){return T.copy(i,e),e}function bx(i){return Ze.identity(i),i}function Sx(i){return Ze.length(i)}function vx(i){return Ze.squaredLength(i)}function xx(i,e=T.create()){return Ze.invert(e,i),e}function Mx(i,e=T.create()){return Ze.conjugate(e,i),e}function Dx(i,e,t=T.create()){return Ze.mul(t,i,e),t}var Gu=function(){let i=W(0,0,0);return function(t,n=p.create()){return Ze.getAxisAngle(n,t)<=L.EPSILON&&p.copy(i,n),n}}();function Wu(i){return T.getAngleDegrees(i)}function Uu(i){let e=T.getAngleRadians(i);return L.toDegrees(e)}var Qu=function(){let i=W();return function(t){return Ze.getAxisAngle(i,t)}}();function qu(i,e=p.create()){return T.getAxisScaledDegrees(i,e)}function Xu(i,e=p.create()){T.getAxis(i,e);let t=T.getAngleDegrees(i);return p.scale(e,t,e),e}var Ku=function(){let i=W(0,0,0);return function(t,n=p.create()){T.getAxis(t,n);let o=T.getAngleRadians(t);return o<=L.EPSILON?p.copy(i,n):p.scale(n,o,n),n}}();function Ex(i,e=[p.create(),p.create(),p.create()]){return T.getLeft(i,e[0]),T.getUp(i,e[1]),T.getForward(i,e[2]),e}var Ax=function(){let i=At();return function(t,n=p.create()){return T.toMatrix(t,i),p.set(n,i[6],i[7],i[8]),n}}();function Rx(i,e){return e=T.getForward(i,e),p.negate(e,e),e}var Ox=function(){let i=At();return function(t,n=p.create()){return T.toMatrix(t,i),p.set(n,i[0],i[1],i[2]),n}}();function Vx(i,e){return e=T.getLeft(i,e),p.negate(e,e),e}var Ix=function(){let i=At();return function(t,n=p.create()){return T.toMatrix(t,i),p.set(n,i[3],i[4],i[5]),n}}();function Bx(i,e){return e=T.getUp(i,e),p.negate(e,e),e}function Lx(i,e,t,n){return n!=null?T.setForward(i,n,t,e):t!=null?T.setUp(i,t,n,e):T.setLeft(i,e,t,n)}function Hx(i,e,t=null,n=null){return fo(i,[n,t,e],[2,1,0])}var kx=function(){let i=W();return function(t,n,o=null,s=null){return p.negate(n,i),fo(t,[s,o,i],[2,1,0])}}();function Fx(i,e,t=null,n=null){return fo(i,[n,e,t],[1,2,0])}var wx=function(){let i=W();return function(t,n,o=null,s=null){return p.negate(n,i),fo(t,[s,i,o],[1,2,0])}}();function jx(i,e,t=null,n=null){return fo(i,[e,t,n],[0,1,2])}var zx=function(){let i=W();return function(t,n,o=null,s=null){return p.negate(n,i),fo(t,[i,o,s],[0,1,2])}}();function Nx(i,e,t=T.create()){return T.mul(e,i,t),t}var Gx=function(){let i=X();return function(t,n,o=T.create()){return T.conjugate(n,i),T.mul(i,t,o),o}}();function Ju(i,e,t=T.create()){return T.fromAxisDegrees(i,e,t)}function Zu(i,e,t=T.create()){return T.fromAxisRadians(L.toRadians(i),e,t),t}function Yu(i,e,t=T.create()){return Ze.setAxisAngle(t,e,i),t}var Wx=function(){let i=At();return function(t,n,o,s=T.create()){return Y.fromAxes(t,n,o,i),Y.toQuat(i,s)}}(),$u=function(){let i=W();return function(t,n=T.create()){return p.toDegrees(t,i),T.fromDegrees(i,n)}}();function eh(i,e=T.create()){return Ze.fromEuler(e,i[0],i[1],i[2]),e}var Ux=function(){let i=At();return function(t,n=p.create()){return T.toMatrix(t,i),n[1]=Math.asin(-L.clamp(i[2],-1,1)),Math.abs(i[2])<1-L.EPSILON?(n[0]=Math.atan2(i[5],i[8]),n[2]=Math.atan2(i[1],i[0])):(n[0]=0,n[2]=Math.atan2(-i[3],i[4])),n}}();function Qx(i,e=p.create()){return T.toRadians(i,e),p.toDegrees(e,e),e}function qx(i,e=L.EPSILON){return Math.abs(T.lengthSquared(i)-1)<e}function Xx(i,e,t){return T.addRotationDegrees(i,e,t)}var Kx=function(){let i=X();return function(t,n,o){return p.degreesToQuat(n,i),T.addRotationQuat(t,i,o)}}(),Jx=function(){let i=X();return function(t,n,o){return p.radiansToQuat(n,i),T.addRotationQuat(t,i,o)}}();function Zx(i,e,t=T.create()){return T.mul(e,i,t),t}function th(i,e,t){return T.subRotationDegrees(i,e,t)}var ih=function(){let i=X();return function(t,n,o){return p.degreesToQuat(n,i),T.subRotationQuat(t,i,o)}}(),nh=function(){let i=X();return function(t,n,o){return p.radiansToQuat(n,i),T.subRotationQuat(t,i,o)}}(),oh=function(){let i=X();return function(t,n,o=T.create()){return T.invert(n,i),T.mul(t,i,o),o}}();function Yx(i,e,t){return T.rotationToDegrees(i,e,t)}var $x=function(){let i=X();return function(t,n,o){return p.degreesToQuat(n,i),T.rotationToQuat(t,i,o)}}(),eM=function(){let i=X();return function(t,n,o){return p.radiansToQuat(n,i),T.rotationToQuat(t,i,o)}}();function tM(i,e,t){return T.normalize(T.subRotationQuat(e,i,t),t)}function sh(i,e,t){return T.rotationAroundAxisDegrees(i,e,t)}var ah=function(){let i=X();return function(t,n,o=p.create()){return T.rotationAroundAxisQuat(t,n,i),T.toDegrees(i,o)}}(),rh=function(){let i=X();return function(t,n,o=p.create()){return T.rotationAroundAxisQuat(t,n,i),T.toRadians(i,o)}}();function lh(i,e,t=T.create()){return T.getTwist(i,e,t)}var mh=function(){let i=W(),e=W(),t=X();return function(o,s,a=T.create()){i[0]=o[0],i[1]=o[1],i[2]=o[2];let l=p.dot(s,i);return p.scale(s,l,e),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=o[3],T.normalize(t,t),l<0&&(t[0]=-t[0],t[1]=-t[1],t[2]=-t[2],t[3]=-t[3]),T.copy(t,a)}}(),yh=function(){let i=X();return function(t,n,o=T.create()){return T.getTwist(t,n,i),T.getSwingFromTwist(t,i,o),o}}();function uh(i,e,t=T.create()){return T.subRotationQuat(i,e,t)}var hh=function(){let i=X();return function(t,n,o=T.create()){return T.conjugate(n,i),T.addRotationQuat(t,i,o),o}}();function ch(i,e,t=T.create()){return T.addRotationQuat(i,e,t)}function iM(i,e=Y.create()){return gx.fromQuat(e,i),e}function nM(i,e,t){return T.rotateDegrees(i,e,t)}function oM(i,e,t){return T.addRotationDegrees(i,e,t)}function sM(i,e,t){return T.addRotationRadians(i,e,t)}function aM(i,e,t){return T.addRotationQuat(i,e,t)}function rM(i,e,t,n){return T.rotateAxisDegrees(i,e,t,n)}var lM=function(){let i=X();return function(t,n,o,s){return T.fromAxisDegrees(n,o,i),T.rotateQuat(t,i,s)}}(),mM=function(){let i=X();return function(t,n,o,s){return T.fromAxisRadians(n,o,i),T.rotateQuat(t,i,s)}}();function yM(i,e,t,n=T.create()){return t<=0?(T.copy(i,n),n):t>=1?(T.copy(e,n),n):(Ze.lerp(n,i,e,t),n)}function uM(i,e,t,n=he.linear,o=T.create()){let s=n(t);return T.lerp(i,e,s,o)}function hM(i,e,t,n=T.create()){return t<=0?(T.copy(i,n),n):t>=1?(T.copy(e,n),n):(Ze.slerp(n,i,e,t),n)}function cM(i,e,t,n=he.linear,o=T.create()){let s=n(t);return T.slerp(i,e,s,o)}var T={create:X,set:fx,normalize:Tx,copy:Px,clone:Cx,identity:bx,length:Sx,lengthSquared:vx,invert:xx,conjugate:Mx,mul:Dx,getAxis:Gu,getAngle:Wu,getAngleDegrees:Uu,getAngleRadians:Qu,getAxisScaled:qu,getAxisScaledDegrees:Xu,getAxisScaledRadians:Ku,getAxes:Ex,getForward:Ax,getBackward:Rx,getLeft:Ox,getRight:Vx,getUp:Ix,getDown:Bx,setAxes:Lx,setForward:Hx,setBackward:kx,setUp:Fx,setDown:wx,setLeft:jx,setRight:zx,toWorld:Nx,toLocal:Gx,fromAxis:Ju,fromAxisDegrees:Zu,fromAxisRadians:Yu,fromAxes:Wx,fromRadians:$u,fromDegrees:eh,toRadians:Ux,toDegrees:Qx,isNormalized:qx,addRotation:Xx,addRotationDegrees:Kx,addRotationRadians:Jx,addRotationQuat:Zx,subRotation:th,subRotationDegrees:ih,subRotationRadians:nh,subRotationQuat:oh,rotationTo:Yx,rotationToDegrees:$x,rotationToRadians:eM,rotationToQuat:tM,rotationAroundAxis:sh,rotationAroundAxisDegrees:ah,rotationAroundAxisRadians:rh,rotationAroundAxisQuat:lh,getTwist:mh,getSwing:yh,getSwingFromTwist:uh,getTwistFromSwing:hh,fromTwistSwing:ch,toMatrix:iM,rotate:nM,rotateDegrees:oM,rotateRadians:sM,rotateQuat:aM,rotateAxis:rM,rotateAxisDegrees:lM,rotateAxisRadians:mM,lerp:yM,interpolate:uM,slerp:hM,sinterpolate:cM},fo=function(){let i=[W(),W(),W()],e=[[1,-1,1],[1,1,-1],[-1,1,-1]],t=W(),n=W(),o=W(),s=W(),a=W(),l=At(),u=X();return function(m,h,d){let g=h[d[0]],P=h[d[1]],C=h[d[2]];if(g==null||p.isZero(g,L.EPSILON))return;let f=!1;P!=null&&p.angleRadians(g,P)>L.EPSILON&&(f=!0);let S=!1;if(C!=null&&p.angleRadians(g,C)>L.EPSILON&&(S=!0),f||S){let M=null,D=null,v=null;f?(M=P,D=1,v=2):(M=C,D=2,v=1);let b=e[d[0]];p.cross(g,M,i[v]),p.scale(i[v],b[d[v]],i[v]),p.cross(g,i[v],i[D]),p.scale(i[D],b[d[D]],i[D]),p.cross(i[1],i[2],i[0]),p.scale(i[0],b[d[0]],i[0]),p.normalize(i[K.findIndexEqual(d,0)],t),p.normalize(i[K.findIndexEqual(d,1)],n),p.normalize(i[K.findIndexEqual(d,2)],o),Y.set(l,t[0],t[1],t[2],n[0],n[1],n[2],o[0],o[1],o[2]),Y.toQuat(l,u),T.copy(u,m)}else{d[0]==0?T.getLeft(m,s):d[0]==1?T.getUp(m,s):T.getForward(m,s);let M=p.angleRadians(g,s);M>L.EPSILON&&(p.cross(s,g,a),p.normalize(a,a),p.isZero(a)&&p.perpendicularRandom(s,a),T.fromAxisRadians(M,a,u),T.rotateQuat(m,u,m))}return m}}();function At(i,e,t,n,o,s,a,l,u){let _=tl.create();return i!==void 0&&ph(_,i,e,t,n,o,s,a,l,u),_}function ph(i,e,t,n,o,s,a,l,u,_){return t===void 0?tl.set(i,e,e,e,e,e,e,e,e,e):tl.set(i,e,t,n,o,s,a,l,u,_),i}var dM=function(){let i=X();return function(t,n=p.create()){return Y.toQuat(t,i),T.toDegrees(i,n),n}}(),_M=function(){let i=X();return function(t,n=p.create()){return Y.toQuat(t,i),T.toRadians(i,n),n}}();function gM(i,e=T.create()){return pM.fromMat3(e,i),e}function fM(i,e,t,n=Y.create()){return Y.set(n,i[0],i[1],i[2],e[0],e[1],e[2],t[0],t[1],t[2]),n}var Y={create:At,set:ph,toDegrees:dM,toRadians:_M,toQuat:gM,fromAxes:fM};var Xt=class{constructor(){this.myIgnoreNonCloneable=!1,this.myIgnoreComponents=!1,this.myIgnoreChildren=!1,this.myComponentsToIgnore=[],this.myComponentsToInclude=[],this.myIgnoreComponentCallback=null,this.myChildrenToIgnore=[],this.myChildrenToInclude=[],this.myIgnoreChildCallback=null,this.myUseDefaultComponentClone=!1,this.myUseDefaultComponentCloneAsFallback=!1,this.myDefaultComponentCloneAutoStartIfNotActive=!0,this.myComponentDeepCloneParams=new Kt,this.myComponentCustomCloneParams=new as}};function TM(i,e){return y.getPositionWorld(i,e)}function dh(i,e=p.create()){return i.getPositionWorld(e),e}function _h(i,e=p.create()){return i.getPositionLocal(e),e}function PM(i,e){return y.getRotationWorld(i,e)}function CM(i,e){return y.getRotationWorldDegrees(i,e)}function bM(i,e){return y.getRotationWorldRadians(i,e)}function gh(i,e){return y.getRotationWorldMatrix(i,e)}function SM(i,e){return y.getRotationWorldQuat(i,e)}function fh(i,e){return y.getRotationWorldDegrees(i,e)}function Th(i,e){return e=y.getRotationWorldRadians(i,e),e=p.toDegrees(e,e),e}var Ph=function(){let i=T.create();return function(t,n=p.create()){return y.getRotationWorldQuat(t,i),T.toRadians(i,n),n}}(),Ch=function(){let i=T.create();return function(t,n=Y.create()){return y.getRotationWorldQuat(t,i),T.toMatrix(i,n),n}}();function bh(i,e=T.create()){return i.getRotationWorld(e),e}function Sh(i,e){return y.getRotationLocalDegrees(i,e)}function vh(i,e){return e=y.getRotationLocalRadians(i,e),e=p.toDegrees(e,e),e}var xh=function(){let i=T.create();return function(t,n=p.create()){return y.getRotationLocalQuat(t,i),T.toRadians(i,n),n}}(),Mh=function(){let i=T.create();return function(t,n=Y.create()){return y.getRotationLocalQuat(t,i),T.toMatrix(i,n),n}}();function Dh(i,e=T.create()){return i.getRotationLocal(e),e}function vM(i,e){return y.getScaleWorld(i,e)}function Eh(i,e=p.create()){return i.getScalingWorld(e),e}function Ah(i,e=p.create()){return i.getScalingLocal(e),e}function Rh(i,e){return y.getTransformWorld(i,e)}function Oh(i,e){return y.getTransformWorldMatrix(i,e)}function Vh(i,e){return y.getTransformWorldQuat(i,e)}function Ih(i,e){return y.getTransformWorldMatrix(i,e)}var Bh=function(){let i=V.create(),e=p.create();return function(n,o=O.create()){return y.getTransformWorldQuat(n,i),y.getScaleWorld(n,e),O.fromQuat(i,o),O.scale(o,e,o),o}}();function Lh(i,e=V.create()){return i.getTransformWorld(e),e}function Hh(i,e){return y.getTransformLocalMatrix(i,e)}var kh=function(){let i=V.create(),e=p.create();return function(n,o=O.create()){return y.getTransformLocalQuat(n,i),y.getScaleLocal(n,e),O.fromQuat(i,o),O.scale(o,e,o),o}}();function Fh(i,e=V.create()){return i.getTransformLocal(e),e}function xM(i,e){return y.getAxesWorld(i,e)}function wh(i,e=[p.create(),p.create(),p.create()]){return y.getLeftWorld(i,e[0]),y.getUpWorld(i,e[1]),y.getForwardWorld(i,e[2]),e}function jh(i,e=[p.create(),p.create(),p.create()]){return y.getLeftLocal(i,e[0]),y.getUpLocal(i,e[1]),y.getForwardLocal(i,e[2]),e}function MM(i,e){return y.getForwardWorld(i,e)}var zh=function(){let i=Y.create();return function(t,n=p.create()){return y.getRotationWorldMatrix(t,i),n[0]=i[6],n[1]=i[7],n[2]=i[8],n}}(),Nh=function(){let i=Y.create();return function(t,n=p.create()){return y.getRotationLocalMatrix(t,i),n[0]=i[6],n[1]=i[7],n[2]=i[8],n}}();function DM(i,e){return y.getBackwardWorld(i,e)}var Gh=function(){let i=Y.create();return function(t,n=p.create()){return y.getRotationWorldMatrix(t,i),n[0]=-i[6],n[1]=-i[7],n[2]=-i[8],n}}(),Wh=function(){let i=Y.create();return function(t,n=p.create()){return y.getRotationLocalMatrix(t,i),n[0]=-i[6],n[1]=-i[7],n[2]=-i[8],n}}();function EM(i,e){return y.getUpWorld(i,e)}var Uh=function(){let i=Y.create();return function(t,n=p.create()){return y.getRotationWorldMatrix(t,i),n[0]=i[3],n[1]=i[4],n[2]=i[5],n}}(),Qh=function(){let i=Y.create();return function(t,n=p.create()){return y.getRotationLocalMatrix(t,i),n[0]=i[3],n[1]=i[4],n[2]=i[5],n}}();function AM(i,e){return y.getDownWorld(i,e)}var qh=function(){let i=Y.create();return function(t,n=p.create()){return y.getRotationWorldMatrix(t,i),n[0]=-i[3],n[1]=-i[4],n[2]=-i[5],n}}(),Xh=function(){let i=Y.create();return function(t,n=p.create()){return y.getRotationLocalMatrix(t,i),n[0]=-i[3],n[1]=-i[4],n[2]=-i[5],n}}();function RM(i,e){return y.getLeftWorld(i,e)}var Kh=function(){let i=Y.create();return function(t,n=p.create()){return y.getRotationWorldMatrix(t,i),n[0]=i[0],n[1]=i[1],n[2]=i[2],n}}(),Jh=function(){let i=Y.create();return function(t,n=p.create()){return y.getRotationLocalMatrix(t,i),n[0]=i[0],n[1]=i[1],n[2]=i[2],n}}();function OM(i,e){return y.getRightWorld(i,e)}var Zh=function(){let i=Y.create();return function(t,n=p.create()){return y.getRotationWorldMatrix(t,i),n[0]=-i[0],n[1]=-i[1],n[2]=-i[2],n}}(),Yh=function(){let i=Y.create();return function(t,n=p.create()){return y.getRotationLocalMatrix(t,i),n[0]=-i[0],n[1]=-i[1],n[2]=-i[2],n}}();function VM(i,e){y.setPositionWorld(i,e)}function $h(i,e){i.setTranslationWorld(e)}function ec(i,e){i.setTranslationLocal(e)}function IM(i,e){y.setRotationWorld(i,e)}function BM(i,e){y.setRotationWorldDegrees(i,e)}function LM(i,e){y.setRotationWorldRadians(i,e)}function tc(i,e){y.setRotationWorldMatrix(i,e)}function HM(i,e){y.setRotationWorldQuat(i,e)}function ic(i,e){y.setRotationWorldDegrees(i,e)}var nc=function(){let i=T.create();return function(t,n){p.degreesToQuat(n,i),y.setRotationWorldQuat(t,i)}}(),oc=function(){let i=p.create();return function(t,n){i=p.toDegrees(n,i),y.setRotationWorldDegrees(t,i)}}(),sc=function(){let i=T.create();return function(t,n){Y.toQuat(n,i),y.setRotationWorldQuat(t,i)}}();function ac(i,e){i.setRotationWorld(e)}function rc(i,e){y.setRotationLocalDegrees(i,e)}var lc=function(){let i=T.create();return function(t,n){p.degreesToQuat(n,i),y.setRotationLocalQuat(t,i)}}(),mc=function(){let i=p.create();return function(t,n){i=p.toDegrees(n,i),y.setRotationLocalDegrees(t,i)}}(),yc=function(){let i=T.create();return function(t,n){Y.toQuat(n,i),y.setRotationLocalQuat(t,i)}}();function uc(i,e){i.setRotationLocal(e)}function kM(i,e){y.setScaleWorld(i,e)}var hc=function(){let i=p.create();return function(t,n){isNaN(n)?t.setScalingWorld(n):(p.set(i,n),t.setScalingWorld(i))}}(),cc=function(){let i=p.create();return function(t,n){isNaN(n)?t.setScalingLocal(n):(p.set(i,n),t.setScalingLocal(i))}}();function FM(i,e,t,n){y.setAxesWorld(i,e,t,n)}function pc(i,e,t,n){n!=null?y.setForwardWorld(i,n,t,e):t!=null?y.setUpWorld(i,t,n,e):y.setLeftWorld(i,e,t,n)}function dc(i,e,t,n){n!=null?y.setForwardLocal(i,n,t,e):t!=null?y.setUpLocal(i,t,n,e):y.setLeftLocal(i,e,t,n)}function wM(i,e,t,n){y.setForwardWorld(i,e,t,n)}var _c=function(){let i=T.create();return function(t,n,o=null,s=null){y.getRotationWorldQuat(t,i),T.setForward(i,n,o,s),y.setRotationWorldQuat(t,i)}}(),gc=function(){let i=T.create();return function(t,n,o=null,s=null){y.getRotationLocalQuat(t,i),T.setForward(i,n,o,s),y.setRotationLocalQuat(t,i)}}();function jM(i,e,t,n){y.setBackwardWorld(i,e,t,n)}var fc=function(){let i=T.create();return function(t,n,o=null,s=null){y.getRotationWorldQuat(t,i),T.setBackward(i,n,o,s),y.setRotationWorldQuat(t,i)}}(),Tc=function(){let i=T.create();return function(t,n,o=null,s=null){y.getRotationLocalQuat(t,i),T.setBackward(i,n,o,s),y.setRotationLocalQuat(t,i)}}();function zM(i,e,t,n){y.setUpWorld(i,e,t,n)}var Pc=function(){let i=T.create();return function(t,n,o=null,s=null){y.getRotationWorldQuat(t,i),T.setUp(i,n,o,s),y.setRotationWorldQuat(t,i)}}(),Cc=function(){let i=T.create();return function(t,n,o=null,s=null){y.getRotationLocalQuat(t,i),T.setUp(i,n,o,s),y.setRotationLocalQuat(t,i)}}();function NM(i,e,t,n){y.setDownWorld(i,e,t,n)}var bc=function(){let i=T.create();return function(t,n,o=null,s=null){y.getRotationWorldQuat(t,i),T.setDown(i,n,o,s),y.setRotationWorldQuat(t,i)}}(),Sc=function(){let i=T.create();return function(t,n,o=null,s=null){y.getRotationLocalQuat(t,i),T.setDown(i,n,o,s),y.setRotationLocalQuat(t,i)}}();function GM(i,e,t,n){y.setLeftWorld(i,e,t,n)}var vc=function(){let i=T.create();return function(t,n,o=null,s=null){y.getRotationWorldQuat(t,i),T.setLeft(i,n,o,s),y.setRotationWorldQuat(t,i)}}(),xc=function(){let i=T.create();return function(t,n,o=null,s=null){y.getRotationLocalQuat(t,i),T.setLeft(i,n,o,s),y.setRotationLocalQuat(t,i)}}();function WM(i,e,t,n){y.setRightWorld(i,e,t,n)}var Mc=function(){let i=T.create();return function(t,n,o=null,s=null){y.getRotationWorldQuat(t,i),T.setRight(i,n,o,s),y.setRotationWorldQuat(t,i)}}(),Dc=function(){let i=T.create();return function(t,n,o=null,s=null){y.getRotationLocalQuat(t,i),T.setRight(i,n,o,s),y.setRotationLocalQuat(t,i)}}();function Ec(i,e){y.setTransformWorld(i,e)}function Ac(i,e){y.setTransformWorldMatrix(i,e)}function Rc(i,e){y.setTransformWorldQuat(i,e)}function Oc(i,e){return y.setTransformWorldMatrix(i,e)}var Vc=function(){let i=p.create(),e=T.create(),t=p.create(),n=O.create(),o=p.create(),s=p.create(1);return function(l,u){O.getPosition(u,i),O.getScale(u,t),p.div(s,t,o),O.scale(u,o,n),O.getRotationQuat(n,e),T.normalize(e,e),y.setScaleWorld(l,t),y.setRotationWorldQuat(l,e),y.setPositionWorld(l,i)}}();function Ic(i,e){i.setTransformWorld(e)}function Bc(i,e){return y.setTransformLocalMatrix(i,e)}var Lc=function(){let i=p.create(),e=T.create(),t=p.create(),n=O.create(),o=p.create(),s=p.create(1);return function(l,u){O.getPosition(u,i),O.getScale(u,t),p.div(s,t,o),O.scale(u,o,n),O.getRotationQuat(n,e),T.normalize(e,e),y.setScaleLocal(l,t),y.setRotationLocalQuat(l,e),y.setPositionLocal(l,i)}}();function Hc(i,e){i.setTransformLocal(e)}function kc(i){y.resetPositionWorld(i)}var Fc=function(){let i=p.create();return function(t){y.setPositionWorld(t,i)}}(),wc=function(){let i=p.create();return function(t){y.setPositionLocal(t,i)}}();function jc(i){y.resetRotationWorld(i)}var zc=function(){let i=T.create();return function(t){y.setRotationWorldQuat(t,i)}}(),Nc=function(){let i=T.create();return function(t){y.setRotationLocalQuat(t,i)}}();function Gc(i){y.resetScaleWorld(i)}var Wc=function(){let i=p.create(1);return function(t){y.setScaleWorld(t,i)}}(),Uc=function(){let i=p.create(1);return function(t){y.setScaleLocal(t,i)}}();function Qc(i){y.resetTransformWorld(i)}function qc(i){y.resetScaleWorld(i),y.resetRotationWorld(i),y.resetPositionWorld(i)}function Xc(i){y.resetScaleLocal(i),y.resetRotationLocal(i),y.resetPositionLocal(i)}function Kc(i,e){y.translateWorld(i,e)}function Jc(i,e){i.translateWorld(e)}function Zc(i,e){i.translate(e)}function Yc(i,e){i.translateObject(e)}function $c(i,e,t){y.translateAxisWorld(i,e,t)}var ep=function(){let i=p.create();return function(t,n,o){p.scale(o,n,i),y.translateWorld(t,i)}}(),tp=function(){let i=p.create();return function(t,n,o){p.scale(o,n,i),y.translateLocal(t,i)}}(),ip=function(){let i=p.create();return function(t,n,o){p.scale(o,n,i),y.translateObject(t,i)}}();function UM(i,e){y.rotateWorld(i,e)}function QM(i,e){y.rotateWorldDegrees(i,e)}function qM(i,e){y.rotateWorldRadians(i,e)}function np(i,e){y.rotateWorldMatrix(i,e)}function XM(i,e){y.rotateWorldQuat(i,e)}function op(i,e){y.rotateWorldDegrees(i,e)}var sp=function(){let i=T.create();return function(t,n){p.degreesToQuat(n,i),y.rotateWorldQuat(t,i)}}(),ap=function(){let i=p.create();return function(t,n){i=p.toDegrees(n,i),y.rotateWorldDegrees(t,i)}}(),rp=function(){let i=T.create();return function(t,n){Y.toQuat(n,i),T.normalize(i,i),y.rotateWorldQuat(t,i)}}(),lp=function(){let i=T.create();return function(t,n){y.getRotationWorldQuat(t,i),T.mul(n,i,i),T.normalize(i,i),y.setRotationWorldQuat(t,i)}}();function mp(i,e){y.rotateLocalDegrees(i,e)}var yp=function(){let i=T.create();return function(t,n){p.degreesToQuat(n,i),y.rotateLocalQuat(t,i)}}(),up=function(){let i=p.create();return function(t,n){i=p.toDegrees(n,i),y.rotateLocalDegrees(t,i)}}(),hp=function(){let i=T.create();return function(t,n){Y.toQuat(n,i),T.normalize(i,i),y.rotateLocalQuat(t,i)}}(),cp=function(){let i=T.create();return function(t,n){y.getRotationLocalQuat(t,i),T.mul(n,i,i),T.normalize(i,i),y.setRotationLocalQuat(t,i)}}();function pp(i,e){y.rotateObjectDegrees(i,e)}var dp=function(){let i=T.create();return function(t,n){p.degreesToQuat(n,i),y.rotateObjectQuat(t,i)}}(),_p=function(){let i=p.create();return function(t,n){i=p.toDegrees(n,i),y.rotateObjectDegrees(t,i)}}(),gp=function(){let i=T.create();return function(t,n){Y.toQuat(n,i),T.normalize(i,i),y.rotateObjectQuat(t,i)}}();function fp(i,e){i.rotateObject(e)}function KM(i,e,t){y.rotateAxisWorld(i,e,t)}function JM(i,e,t){y.rotateAxisWorldDegrees(i,e,t)}function ZM(i,e,t){y.rotateAxisWorldRadians(i,e,t)}function Tp(i,e,t){y.rotateAxisWorldDegrees(i,e,t)}function Pp(i,e,t){y.rotateAxisWorldRadians(i,L.toRadians(e),t)}var Cp=function(){let i=T.create();return function(t,n,o){T.fromAxisRadians(n,o,i),y.rotateWorldQuat(t,i)}}();function bp(i,e,t){y.rotateAxisLocalDegrees(i,e,t)}function Sp(i,e,t){y.rotateAxisLocalRadians(i,L.toRadians(e),t)}var vp=function(){let i=T.create();return function(t,n,o){T.fromAxisRadians(n,o,i),y.rotateLocalQuat(t,i)}}();function xp(i,e,t){y.rotateAxisObjectDegrees(i,e,t)}function Mp(i,e,t){y.rotateAxisObjectRadians(i,L.toRadians(e),t)}var Dp=function(){let i=T.create();return function(t,n,o){T.fromAxisRadians(n,o,i),y.rotateObjectQuat(t,i)}}();function YM(i,e,t){y.rotateAroundWorld(i,e,t)}function $M(i,e,t){y.rotateAroundWorldDegrees(i,e,t)}function eD(i,e,t){y.rotateAroundWorldRadians(i,e,t)}function Ep(i,e,t){y.rotateAroundWorldMatrix(i,e,t)}function tD(i,e,t){y.rotateAroundWorldQuat(i,e,t)}function Ap(i,e,t){y.rotateAroundWorldDegrees(i,e,t)}var Rp=function(){let i=T.create();return function(t,n,o){p.degreesToQuat(n,i),y.rotateAroundWorldQuat(t,i,o)}}(),Op=function(){let i=p.create();return function(t,n,o){i=p.toDegrees(n,i),y.rotateAroundWorldDegrees(t,i,o)}}(),Vp=function(){let i=T.create();return function(t,n,o){Y.toQuat(n,i),T.normalize(i,i),y.rotateAroundWorldQuat(t,i,o)}}(),Ip=function(){let i=p.create();return function(t,n,o){T.getAxis(n,i);let s=T.getAngleRadians(n);y.rotateAroundAxisWorldRadians(t,s,i,o)}}();function Bp(i,e,t){y.rotateAroundLocalDegrees(i,e,t)}var Lp=function(){let i=T.create();return function(t,n,o){p.degreesToQuat(n,i),y.rotateAroundLocalQuat(t,i,o)}}(),Hp=function(){let i=p.create();return function(t,n,o){i=p.toDegrees(n,i),y.rotateAroundLocalDegrees(t,i,o)}}(),kp=function(){let i=T.create();return function(t,n,o){Y.toQuat(n,i),T.normalize(i,i),y.rotateAroundLocalQuat(t,i,o)}}(),Fp=function(){let i=p.create();return function(t,n,o){T.getAxis(n,i);let s=T.getAngleRadians(n);y.rotateAroundAxisLocalRadians(t,s,i,o)}}();function wp(i,e,t){y.rotateAroundObjectDegrees(i,e,t)}var jp=function(){let i=T.create();return function(t,n,o){p.degreesToQuat(n,i),y.rotateAroundObjectQuat(t,i,o)}}(),zp=function(){let i=p.create();return function(t,n,o){i=p.toDegrees(n,i),y.rotateAroundObjectDegrees(t,i,o)}}(),Np=function(){let i=T.create();return function(t,n,o){Y.toQuat(n,i),T.normalize(i,i),y.rotateAroundObjectQuat(t,i,o)}}(),Gp=function(){let i=p.create();return function(t,n,o){T.getAxis(n,i);let s=T.getAngleRadians(n);y.rotateAroundAxisObjectRadians(t,s,i,o)}}();function iD(i,e,t,n){y.rotateAroundAxisWorld(i,e,t,n)}function nD(i,e,t,n){y.rotateAroundAxisWorldDegrees(i,e,t,n)}function oD(i,e,t,n){y.rotateAroundAxisWorldRadians(i,e,t,n)}function Wp(i,e,t,n){y.rotateAroundAxisWorldDegrees(i,e,t,n)}function Up(i,e,t,n){y.rotateAroundAxisWorldRadians(i,L.toRadians(e),t,n)}var Qp=function(){let i=V.create(),e=V.create(),t=V.create(),n=T.create();return function(s,a,l,u){V.setPositionRotationQuat(i,u,n),y.getTransformWorldQuat(s,t),V.conjugate(i,e),V.mul(e,t,t),V.rotateAxisRadians(i,a,l,i),V.mul(i,t,t),y.setTransformWorldQuat(s,t)}}();function qp(i,e,t,n){y.rotateAroundAxisLocalDegrees(i,e,t,n)}function Xp(i,e,t,n){y.rotateAroundAxisLocalRadians(i,L.toRadians(e),t,n)}var Kp=function(){let i=p.create(),e=p.create();return function(n,o,s,a){y.convertPositionLocalToWorld(n,a,i),y.convertDirectionLocalToWorld(n,s,e),y.rotateAroundAxisWorldRadians(n,o,e,i)}}();function Jp(i,e,t,n){y.rotateAroundAxisObjectDegrees(i,e,t,n)}function Zp(i,e,t,n){y.rotateAroundAxisObjectRadians(i,L.toRadians(e),t,n)}var Yp=function(){let i=p.create(),e=p.create();return function(n,o,s,a){y.convertPositionObjectToWorld(n,a,i),y.convertDirectionObjectToWorld(n,s,e),y.rotateAroundAxisWorldRadians(n,o,e,i)}}(),$p=function(){let i=p.create();return function(t,n){isNaN(n)?t.scale(n):(p.set(i,n),t.scale(i))}}();function ed(i,e,t){y.lookAtWorld(i,e,t)}var td=function(){let i=p.create();return function(t,n,o){y.getPositionWorld(t,i),p.sub(n,i,i),y.lookToWorld(t,i,o)}}(),id=function(){let i=p.create();return function(t,n,o){y.getPositionLocal(t,i),p.sub(n,i,i),y.lookToLocal(t,i,o)}}();function nd(i,e,t){y.lookToWorld(i,e,t)}var od=function(){let i=p.create();return function(t,n,o=y.getUpWorld(t,i)){y.setForwardWorld(t,n,o)}}(),sd=function(){let i=p.create();return function(t,n,o=y.getUpLocal(t,i)){y.setForwardLocal(t,n,o)}}(),ad=function(){let i=p.create(),e=T.create(),t=p.create();return function(o,s,a=!0){a?(y.getPositionWorld(o,i),y.getRotationWorldQuat(o,e),y.getScaleWorld(o,t),o.parent=s,y.setScaleWorld(o,t),y.setRotationWorldQuat(o,e),y.setPositionWorld(o,i)):o.parent=s}}();function rd(i){return i.parent}var ld=function(){let i=O.create();return function(t,n,o=p.create()){return y.getTransformWorldMatrix(t,i),p.transformMat4(n,i,o),o}}(),md=function(){let i=T.create();return function(t,n,o=p.create()){return y.getRotationWorldQuat(t,i),p.transformQuat(n,i,o),o}}(),yd=function(){let i=O.create();return function(t,n,o=p.create()){return y.getTransformWorldMatrix(t,i),O.invert(i,i),p.transformMat4(n,i,o),o}}(),ud=function(){let i=T.create();return function(t,n,o=p.create()){return y.getRotationWorldQuat(t,i),T.conjugate(i,i),p.transformQuat(n,i,o),o}}();function hd(i,e,t=p.create()){return y.getParent(i)?y.convertPositionObjectToWorld(y.getParent(i),e,t):p.copy(e,t),t}function cd(i,e,t=p.create()){return y.getParent(i)?y.convertDirectionObjectToWorld(y.getParent(i),e,t):p.copy(e,t),t}function pd(i,e,t=p.create()){return y.getParent(i)?y.convertPositionWorldToObject(y.getParent(i),e,t):p.copy(e,t),t}function dd(i,e,t=p.create()){return y.getParent(i)?y.convertDirectionWorldToObject(y.getParent(i),e,t):p.copy(e,t),t}function _d(i,e,t=p.create()){return y.convertPositionObjectToWorld(i,e,t),y.convertPositionWorldToLocal(i,t,t),t}function gd(i,e,t=p.create()){return y.convertDirectionObjectToWorld(i,e,t),y.convertDirectionWorldToLocal(i,t,t),t}function fd(i,e,t=p.create()){return y.convertPositionLocalToWorld(i,e,t),y.convertPositionWorldToObject(i,t,t),t}function Td(i,e,t=p.create()){return y.convertDirectionLocalToWorld(i,e,t),y.convertDirectionWorldToObject(i,t,t),t}function Pd(i,e,t){return y.convertTransformObjectToWorldMatrix(i,e,t)}var Cd=function(){let i=O.create(),e=p.create(),t=p.create(),n=p.create(),o=p.create(1);return function(a,l,u=O.create()){return y.getTransformWorldMatrix(a,i),y.hasUniformScaleWorld(a)?O.mul(i,l,u):(p.set(e,l[12],l[13],l[14]),y.convertPositionObjectToWorld(a,e,e),O.getScale(i,t),p.div(o,t,n),O.scale(i,n,i),O.mul(i,l,u),O.scale(u,t,u),u[12]=e[0],u[13]=e[1],u[14]=e[2],u[15]=1),u}}(),bd=function(){let i=p.create(),e=T.create();return function(n,o,s=V.create()){return y.getRotationWorldQuat(n,e),T.mul(e,o,e),V.getPosition(o,i),y.convertPositionObjectToWorld(n,i,i),V.setPositionRotationQuat(s,i,e),s}}();function Sd(i,e,t){return y.convertTransformWorldToObjectMatrix(i,e,t)}var vd=function(){let i=O.create(),e=p.create(),t=p.create(),n=p.create(),o=p.create(1);return function(a,l,u=O.create()){return y.getTransformWorldMatrix(a,i),y.hasUniformScaleWorld(a)?(O.invert(i,i),O.mul(i,l,u)):(p.set(e,l[12],l[13],l[14]),y.convertPositionWorldToObject(a,e,e),O.getScale(i,t),p.div(o,t,n),O.scale(i,n,i),O.invert(i,i),O.mul(i,l,u),O.scale(u,n,u),u[12]=e[0],u[13]=e[1],u[14]=e[2],u[15]=1),u}}(),xd=function(){let i=p.create(),e=T.create();return function(n,o,s=V.create()){return y.getRotationWorldQuat(n,e),T.conjugate(e,e),T.mul(e,o,e),V.getPosition(o,i),y.convertPositionWorldToObject(n,i,i),V.setPositionRotationQuat(s,i,e),s}}();function Md(i,e,t){return y.convertTransformLocalToWorldMatrix(i,e,t)}function Dd(i,e,t=O.create()){return y.getParent(i)?y.convertTransformObjectToWorldMatrix(y.getParent(i),e,t):O.copy(e,t),t}function Ed(i,e,t=V.create()){return y.getParent(i)?y.convertTransformObjectToWorldQuat(y.getParent(i),e,t):V.copy(e,t),t}function Ad(i,e,t){return y.convertTransformWorldToLocalMatrix(i,e,t)}function Rd(i,e,t=O.create()){return y.getParent(i)?y.convertTransformWorldToObjectMatrix(y.getParent(i),e,t):O.copy(e,t),t}function Od(i,e,t=V.create()){return y.getParent(i)?y.convertTransformWorldToObjectQuat(y.getParent(i),e,t):V.copy(e,t),t}function Vd(i,e,t){return y.convertTransformObjectToLocalMatrix(i,e,t)}function Id(i,e,t=O.create()){return y.convertTransformObjectToWorldMatrix(i,e,t),y.convertTransformWorldToLocalMatrix(i,t,t),t}function Bd(i,e,t=V.create()){return y.convertTransformObjectToWorldQuat(i,e,t),y.convertTransformWorldToLocalQuat(i,t,t),t}function Ld(i,e,t){return y.convertTransformLocalToObjectMatrix(i,e,t)}function Hd(i,e,t=O.create()){return y.convertTransformLocalToWorldMatrix(i,e,t),y.convertTransformWorldToObjectMatrix(i,t,t),t}function kd(i,e,t=V.create()){return y.convertTransformLocalToWorldQuat(i,e,t),y.convertTransformWorldToObjectQuat(i,t,t),t}function Fd(i,e,t,n=null){let o=null;return typeof t=="boolean"?(o={},o.active=t):(o=t,n!=null&&(o==null&&(o={}),o.active=n)),i.addComponent(e,o)}function sD(i,e,t=0){return y.getComponentHierarchy(i,e,t)}function wd(i,e,t=0){return i.getComponent(e,t)}function jd(i,e,t=0){return y.getComponentHierarchyBreadth(i,e,t)}function zd(i,e,t=0){let n=y.getHierarchyBreadth(i);return y.getComponentObjects(n,e,t)}function Nd(i,e,t=0){let n=y.getHierarchyDepth(i);return y.getComponentObjects(n,e,t)}function Gd(i,e,t=0){return y.getComponentDescendantsBreadth(i,e,t)}function Wd(i,e,t=0){let n=y.getDescendantsBreadth(i);return y.getComponentObjects(n,e,t)}function Ud(i,e,t=0){let n=y.getDescendantsDepth(i);return y.getComponentObjects(n,e,t)}function Qd(i,e,t=0){let n=y.getChildren(i);return y.getComponentObjects(n,e,t)}function aD(i,e){return y.getComponentsHierarchy(i,e)}function qd(i,e){return i.getComponents(e)}function Xd(i,e){return y.getComponentsHierarchyBreadth(i,e)}function Kd(i,e){let t=y.getHierarchyBreadth(i);return y.getComponentsObjects(t,e)}function Jd(i,e){let t=y.getHierarchyDepth(i);return y.getComponentsObjects(t,e)}function Zd(i,e){return y.getComponentsDescendantsBreadth(i,e)}function Yd(i,e){let t=y.getDescendantsBreadth(i);return y.getComponentsObjects(t,e)}function $d(i,e){let t=y.getDescendantsDepth(i);return y.getComponentsObjects(t,e)}function e_(i,e){let t=y.getChildren(i);return y.getComponentsObjects(t,e)}function t_(i,e){y.setActiveHierarchy(i,e)}function i_(i,e){i.active=e}function n_(i,e){y.setActiveHierarchyBreadth(i,e)}function o_(i,e){let t=y.getHierarchyBreadth(i);y.setActiveObjects(t,e)}function s_(i,e){let t=y.getHierarchyDepth(i);y.setActiveObjects(t,e)}function a_(i,e){y.setActiveDescendantsBreadth(i,e)}function r_(i,e){let t=y.getDescendantsBreadth(i);y.setActiveObjects(t,e)}function l_(i,e){let t=y.getDescendantsDepth(i);y.setActiveObjects(t,e)}function m_(i,e){let t=y.getChildren(i);y.setActiveObjects(t,e)}function rD(i){return y.hasUniformScaleWorld(i)}var y_=function(){let i=p.create();return function(t){return y.getScaleWorld(t,i),Math.abs(i[0]-i[1])<L.EPSILON&&Math.abs(i[1]-i[2])<L.EPSILON&&Math.abs(i[0]-i[2])<L.EPSILON}}(),u_=function(){let i=p.create();return function(t){return y.getScaleLocal(t,i),Math.abs(i[0]-i[1])<L.EPSILON&&Math.abs(i[1]-i[2])<L.EPSILON&&Math.abs(i[0]-i[2])<L.EPSILON}}(),lD=function(){let i=p.create(),e=V.create();return function(n,o=new Xt){let s=null;if(y.isCloneable(n,o)){let a=[];a.push([y.getParent(n),n]);let l=[];for(;a.length>0;){let m=a.shift(),h=m[0],d=m[1],g=h!=null?y.addObject(h):Z.addObject(r.getScene(y.getEngine(n)));if(y.setName(g,y.getName(d)),y.setScaleLocal(g,y.getScaleLocal(d,i)),y.setTransformLocalQuat(g,y.getTransformLocalQuat(d,e)),o.myIgnoreComponents||l.push([d,g]),!o.myIgnoreChildren)for(let P of y.getChildren(d)){let C=!1;o.myChildrenToInclude.length>0?C=o.myChildrenToInclude.find(f=>y.equals(f,P))!=null:C=o.myChildrenToIgnore.find(f=>y.equals(f,P))==null,C&&o.myIgnoreChildCallback!=null&&(C=!o.myIgnoreChildCallback(P)),C&&a.push([g,P])}s==null&&(s=g)}let u=[];for(;l.length>0;){let m=l.shift(),h=m[0],d=m[1],g=y.getComponentsSelf(h);for(let P of g)if(z.isCloneable(P.type,o.myUseDefaultComponentClone||o.myUseDefaultComponentCloneAsFallback,y.getEngine(n))){let C=!1;o.myComponentsToInclude.length>0?C=o.myComponentsToInclude.indexOf(P.type)!=-1:C=o.myComponentsToIgnore.indexOf(P.type)==-1,C&&o.myIgnoreComponentCallback!=null&&(C=!o.myIgnoreComponentCallback(P)),C&&u.push([P,d])}}let _=[];for(;u.length>0;){let m=u.shift(),h=m[0],d=m[1],g=null;o.myUseDefaultComponentClone?g=z.cloneDefault(h,d,o.myDefaultComponentCloneAutoStartIfNotActive):g=z.clone(h,d,o.myComponentDeepCloneParams,o.myComponentCustomCloneParams,o.myUseDefaultComponentCloneAsFallback,o.myDefaultComponentCloneAutoStartIfNotActive),g!=null&&z.hasClonePostProcess(h.type,y.getEngine(n))&&_.push([h,g])}for(;_.length>0;){let m=_.shift(),h=m[0],d=m[1];z.clonePostProcess(h,d,o.myComponentDeepCloneParams,o.myComponentCustomCloneParams)}}return s}}();function mD(i,e=new Xt){if(e.myIgnoreNonCloneable||e.myIgnoreComponents||e.myUseDefaultComponentClone||e.myUseDefaultComponentCloneAsFallback)return!0;let t=!0,n=[];for(n.push(i);t&&n.length>0;){let o=n.shift(),s=y.getComponentsSelf(o);for(let a of s){let l=!1;if(e.myComponentsToInclude.length>0?l=e.myComponentsToInclude.indexOf(a.type)!=-1:l=e.myComponentsToIgnore.indexOf(a.type)==-1,l&&e.myIgnoreComponentCallback!=null&&(l=!e.myIgnoreComponentCallback(a)),l&&!z.isCloneable(a.type,!1,y.getEngine(i))){t=!1;break}}if(t&&!e.myIgnoreChildren)for(let a of y.getChildren(o)){let l=!1;e.myChildrenToInclude.length>0?l=e.myChildrenToInclude.find(u=>y.equals(u,a))!=null:l=e.myChildrenToIgnore.find(u=>y.equals(u,a))==null,l&&e.myIgnoreChildCallback!=null&&(l=!e.myIgnoreChildCallback(a)),l&&n.push(a)}}return t}function yD(i){return y.toStringCompact(i)}var uD=function(){let i="    ",e=`
`,t="{",n="}",o="name: ",s="id: ",a="components: ",l="type: ",u="children: ",_="[",m="]",h=_,d=m,g=",",P=e.concat(i,i);return function(f){let S="";S=S.concat(t,e);let M=y.getComponentsSelf(f),D=y.getChildren(f),v=y.getName(f);if(M.length>0||D.length>0||v.length>0?S=S.concat(i,s,y.getID(f),g,e):S=S.concat(i,s,y.getID(f),e),v.length>0&&(M.length>0||D.length>0?S=S.concat(i,o,y.getName(f),g,e):S=S.concat(i,o,y.getName(f),e)),M.length>0){S=S.concat(i,a,e,i,_,e);for(let b=0;b<M.length;b++){let x=M[b];S=S.concat(i,i,t,e),S=S.concat(i,i,i,l,x.type,g,e),S=S.concat(i,i,i,s,x._id,g,e),S=S.concat(i,i,n),b!=M.length-1?S=S.concat(g,e):S=S.concat(e)}D.length>0?S=S.concat(i,m,g,e):S=S.concat(i,m,e)}if(D.length>0){S=S.concat(i,u,e,i,h,e);for(let b=0;b<D.length;b++){let x=D[b],B=y.toStringExtended(x);B=B.replaceAll(e,P),B=i.concat(i,B),S=S.concat(B),b!=D.length-1?S=S.concat(g,e):S=S.concat(e)}S=S.concat(i,d,e)}return S=S.concat(n),S}}(),hD=function(){let i="    ",e=`
`,t="<none>",n="name: ",o="components: ",s=", ",a=e.concat(i);return function(u){let _="",m=y.getName(u);m.length>0?_=_.concat(n,m):_=_.concat(n,t);let h=y.getComponentsSelf(u);if(h.length>0){_=_.concat(s,o);for(let g=0;g<h.length;g++){let P=h[g];_=_.concat(P.type),g!=h.length-1&&(_=_.concat(s))}}let d=y.getChildren(u);if(d.length>0){_=_.concat(e);for(let g=0;g<d.length;g++){let P=d[g],C=y.toStringCompact(P);C=C.replaceAll(e,a),C=i.concat(C),_=_.concat(C),g!=d.length-1&&(_=_.concat(e))}}return _}}();function cD(i,e,t=!1,n=0){return y.getObjectByNameHierarchy(i,e,t,n)}function h_(i,e,t=!1,n=0){return y.getObjectByNameHierarchyBreadth(i,e,t,n)}function c_(i,e,t=!1,n=0){let o=y.getHierarchyBreadth(i);return y.getObjectByNameObjects(o,e,t,n)}function p_(i,e,t=!1,n=0){let o=y.getHierarchyDepth(i);return y.getObjectByNameObjects(o,e,t,n)}function d_(i,e,t=!1,n=0){return y.getObjectByNameDescendantsBreadth(i,e,t,n)}function __(i,e,t=!1,n=0){let o=y.getDescendantsBreadth(i);return y.getObjectByNameObjects(o,e,t,n)}function g_(i,e,t=!1,n=0){let o=y.getDescendantsDepth(i);return y.getObjectByNameObjects(o,e,t,n)}function f_(i,e,t=!1,n=0){let o=y.getChildren(i);return y.getObjectByNameObjects(o,e,t,n)}function pD(i,e,t=!1){return y.getObjectsByNameHierarchy(i,e,t)}function T_(i,e,t=!1){return y.getObjectsByNameHierarchyBreadth(i,e,t)}function P_(i,e,t=!1){let n=y.getHierarchyBreadth(i);return y.getObjectsByNameObjects(n,e,t)}function C_(i,e,t=!1){let n=y.getHierarchyDepth(i);return y.getObjectsByNameObjects(n,e,t)}function b_(i,e,t=!1){return y.getObjectsByNameDescendantsBreadth(i,e,t)}function S_(i,e,t=!1){let n=y.getDescendantsBreadth(i);return y.getObjectsByNameObjects(n,e,t)}function v_(i,e,t=!1){let n=y.getDescendantsDepth(i);return y.getObjectsByNameObjects(n,e,t)}function x_(i,e,t=!1){let n=y.getChildren(i);return y.getObjectsByNameObjects(n,e,t)}function dD(i,e){return y.getObjectByIDHierarchy(i,e)}function M_(i,e){return y.getObjectByIDHierarchyBreadth(i,e)}function D_(i,e){let t=y.getHierarchyBreadth(i);return y.getObjectByIDObjects(t,e)}function E_(i,e){let t=y.getHierarchyDepth(i);return y.getObjectByIDObjects(t,e)}function A_(i,e){return y.getObjectByIDDescendantsBreadth(i,e)}function R_(i,e){let t=y.getDescendantsBreadth(i);return y.getObjectByIDObjects(t,e)}function O_(i,e){let t=y.getDescendantsDepth(i);return y.getObjectByIDObjects(t,e)}function V_(i,e){let t=y.getChildren(i);return y.getObjectByIDObjects(t,e)}function I_(i){return y.getHierarchyBreadth(i)}function B_(i){let e=y.getDescendantsBreadth(i);return e.unshift(i),e}function L_(i){let e=y.getDescendantsDepth(i);return e.unshift(i),e}function H_(i){return y.getDescendantsBreadth(i)}function k_(i){let e=[],t=y.getChildren(i);for(;t.length>0;){let n=t.shift();e.push(n);for(let o of y.getChildren(n))t.push(o)}return e}function F_(i){let e=[],t=y.getChildren(i);for(let n of t){e.push(n);let o=y.getDescendantsDepth(n);o.length>0&&e.push(...o)}return e}function w_(i){return i.children}function j_(i){return i}function _D(i){return r.getScene(y.getEngine(i)).addObject(i)}function z_(i){return i.name}function N_(i,e){i.name=e}function G_(i){return i.engine}function W_(i){return i.objectId}function U_(i){return i.setDirty()}function Q_(i){return i.changed}function gD(i,e){return i.equals(e)}function q_(i){return i.destroy()}function X_(i,e){y.reserveObjectsHierarchy(i,e)}function K_(i,e){let t=y.getComponentsAmountMapSelf(i);nr(e,t,r.getScene(y.getEngine(i)))}function J_(i,e){let t=y.getComponentsAmountMapHierarchy(i);nr(e,t,r.getScene(y.getEngine(i)))}function Z_(i,e){let t=y.getComponentsAmountMapDescendants(i);nr(e,t,r.getScene(y.getEngine(i)))}function Y_(i,e){let t=y.getComponentsAmountMapChildren(i);nr(e,t,r.getScene(y.getEngine(i)))}function fD(i,e=new Map){return y.getComponentsAmountMapHierarchy(i,e)}function $_(i,e=new Map){let t=e.get("object");t==null&&(t=0),t+=1,e.set("object",t);let n=y.getComponentsSelf(i);for(let o of n){let s=o.type,a=e.get(s);a==null&&(a=0),a+=1,e.set(s,a)}return e}function eg(i,e=new Map){let t=y.getHierarchy(i);for(let n of t)y.getComponentsAmountMapSelf(n,e);return e}function tg(i,e=new Map){let t=y.getDescendants(i);for(let n of t)y.getComponentsAmountMapSelf(n,e);return e}function ig(i,e=new Map){let t=y.getChildren(i);for(let n of t)y.getComponentsAmountMapSelf(n,e);return e}function ng(i,e,t=0){let n=null;for(let o of i)if(n=o.getComponent(e,t),n!=null)break;return n}function og(i,e){let t=[];for(let n of i)t.push(...n.getComponents(e));return t}function sg(i,e){for(let t of i)t.active=e}function ag(i,e,t=!1,n=0){let o=null,s=n;for(let a of i){let l=y.getName(a);if(!t&&l==e||t&&l.match(e)!=null){if(s==0){o=a;break}s--}}return o}function rg(i,e,t=!1){let n=[];for(let o of i){let s=y.getName(o);(!t&&s==e||t&&s.match(e)!=null)&&n.push(o)}return n}function lg(i,e,t=0){let n=null,o=t;for(let s of i)if(y.getID(s)==e){if(o==0){n=s;break}o--}return n}function mg(i,e){let t=[];for(let n of i)y.getID(n)==e&&t.push(n);return t}function yg(i,e=r.getMainEngine()){return e.wrapObject(i)}var y={getPosition:TM,getPositionWorld:dh,getPositionLocal:_h,getRotation:PM,getRotationDegrees:CM,getRotationRadians:bM,getRotationMatrix:gh,getRotationQuat:SM,getRotationWorld:fh,getRotationWorldDegrees:Th,getRotationWorldRadians:Ph,getRotationWorldMatrix:Ch,getRotationWorldQuat:bh,getRotationLocal:Sh,getRotationLocalDegrees:vh,getRotationLocalRadians:xh,getRotationLocalMatrix:Mh,getRotationLocalQuat:Dh,getScale:vM,getScaleWorld:Eh,getScaleLocal:Ah,getTransform:Rh,getTransformMatrix:Oh,getTransformQuat:Vh,getTransformWorld:Ih,getTransformWorldMatrix:Bh,getTransformWorldQuat:Lh,getTransformLocal:Hh,getTransformLocalMatrix:kh,getTransformLocalQuat:Fh,getAxes:xM,getAxesWorld:wh,getAxesLocal:jh,getForward:MM,getForwardWorld:zh,getForwardLocal:Nh,getBackward:DM,getBackwardWorld:Gh,getBackwardLocal:Wh,getUp:EM,getUpWorld:Uh,getUpLocal:Qh,getDown:AM,getDownWorld:qh,getDownLocal:Xh,getLeft:RM,getLeftWorld:Kh,getLeftLocal:Jh,getRight:OM,getRightWorld:Zh,getRightLocal:Yh,setPosition:VM,setPositionWorld:$h,setPositionLocal:ec,setRotation:IM,setRotationDegrees:BM,setRotationRadians:LM,setRotationMatrix:tc,setRotationQuat:HM,setRotationWorld:ic,setRotationWorldDegrees:nc,setRotationWorldRadians:oc,setRotationWorldMatrix:sc,setRotationWorldQuat:ac,setRotationLocal:rc,setRotationLocalDegrees:lc,setRotationLocalRadians:mc,setRotationLocalMatrix:yc,setRotationLocalQuat:uc,setScale:kM,setScaleWorld:hc,setScaleLocal:cc,setAxes:FM,setAxesWorld:pc,setAxesLocal:dc,setForward:wM,setForwardWorld:_c,setForwardLocal:gc,setBackward:jM,setBackwardWorld:fc,setBackwardLocal:Tc,setUp:zM,setUpWorld:Pc,setUpLocal:Cc,setDown:NM,setDownWorld:bc,setDownLocal:Sc,setLeft:GM,setLeftWorld:vc,setLeftLocal:xc,setRight:WM,setRightWorld:Mc,setRightLocal:Dc,setTransform:Ec,setTransformMatrix:Ac,setTransformQuat:Rc,setTransformWorld:Oc,setTransformWorldMatrix:Vc,setTransformWorldQuat:Ic,setTransformLocal:Bc,setTransformLocalMatrix:Lc,setTransformLocalQuat:Hc,resetPosition:kc,resetPositionWorld:Fc,resetPositionLocal:wc,resetRotation:jc,resetRotationWorld:zc,resetRotationLocal:Nc,resetScale:Gc,resetScaleWorld:Wc,resetScaleLocal:Uc,resetTransform:Qc,resetTransformWorld:qc,resetTransformLocal:Xc,translate:Kc,translateWorld:Jc,translateLocal:Zc,translateObject:Yc,translateAxis:$c,translateAxisWorld:ep,translateAxisLocal:tp,translateAxisObject:ip,rotate:UM,rotateDegrees:QM,rotateRadians:qM,rotateMatrix:np,rotateQuat:XM,rotateWorld:op,rotateWorldDegrees:sp,rotateWorldRadians:ap,rotateWorldMatrix:rp,rotateWorldQuat:lp,rotateLocal:mp,rotateLocalDegrees:yp,rotateLocalRadians:up,rotateLocalMatrix:hp,rotateLocalQuat:cp,rotateObject:pp,rotateObjectDegrees:dp,rotateObjectRadians:_p,rotateObjectMatrix:gp,rotateObjectQuat:fp,rotateAxis:KM,rotateAxisDegrees:JM,rotateAxisRadians:ZM,rotateAxisWorld:Tp,rotateAxisWorldDegrees:Pp,rotateAxisWorldRadians:Cp,rotateAxisLocal:bp,rotateAxisLocalDegrees:Sp,rotateAxisLocalRadians:vp,rotateAxisObject:xp,rotateAxisObjectDegrees:Mp,rotateAxisObjectRadians:Dp,rotateAround:YM,rotateAroundDegrees:$M,rotateAroundRadians:eD,rotateAroundMatrix:Ep,rotateAroundQuat:tD,rotateAroundWorld:Ap,rotateAroundWorldDegrees:Rp,rotateAroundWorldRadians:Op,rotateAroundWorldMatrix:Vp,rotateAroundWorldQuat:Ip,rotateAroundLocal:Bp,rotateAroundLocalDegrees:Lp,rotateAroundLocalRadians:Hp,rotateAroundLocalMatrix:kp,rotateAroundLocalQuat:Fp,rotateAroundObject:wp,rotateAroundObjectDegrees:jp,rotateAroundObjectRadians:zp,rotateAroundObjectMatrix:Np,rotateAroundObjectQuat:Gp,rotateAroundAxis:iD,rotateAroundAxisDegrees:nD,rotateAroundAxisRadians:oD,rotateAroundAxisWorld:Wp,rotateAroundAxisWorldDegrees:Up,rotateAroundAxisWorldRadians:Qp,rotateAroundAxisLocal:qp,rotateAroundAxisLocalDegrees:Xp,rotateAroundAxisLocalRadians:Kp,rotateAroundAxisObject:Jp,rotateAroundAxisObjectDegrees:Zp,rotateAroundAxisObjectRadians:Yp,scaleObject:$p,lookAt:ed,lookAtWorld:td,lookAtLocal:id,lookTo:nd,lookToWorld:od,lookToLocal:sd,setParent:ad,getParent:rd,convertPositionObjectToWorld:ld,convertDirectionObjectToWorld:md,convertPositionWorldToObject:yd,convertDirectionWorldToObject:ud,convertPositionLocalToWorld:hd,convertDirectionLocalToWorld:cd,convertPositionWorldToLocal:pd,convertDirectionWorldToLocal:dd,convertPositionObjectToLocal:_d,convertDirectionObjectToLocal:gd,convertPositionLocalToObject:fd,convertDirectionLocalToObject:Td,convertTransformObjectToWorld:Pd,convertTransformObjectToWorldMatrix:Cd,convertTransformObjectToWorldQuat:bd,convertTransformWorldToObject:Sd,convertTransformWorldToObjectMatrix:vd,convertTransformWorldToObjectQuat:xd,convertTransformLocalToWorld:Md,convertTransformLocalToWorldMatrix:Dd,convertTransformLocalToWorldQuat:Ed,convertTransformWorldToLocal:Ad,convertTransformWorldToLocalMatrix:Rd,convertTransformWorldToLocalQuat:Od,convertTransformObjectToLocal:Vd,convertTransformObjectToLocalMatrix:Id,convertTransformObjectToLocalQuat:Bd,convertTransformLocalToObject:Ld,convertTransformLocalToObjectMatrix:Hd,convertTransformLocalToObjectQuat:kd,addComponent:Fd,getComponent:sD,getComponentSelf:wd,getComponentHierarchy:jd,getComponentHierarchyBreadth:zd,getComponentHierarchyDepth:Nd,getComponentDescendants:Gd,getComponentDescendantsBreadth:Wd,getComponentDescendantsDepth:Ud,getComponentChildren:Qd,getComponents:aD,getComponentsSelf:qd,getComponentsHierarchy:Xd,getComponentsHierarchyBreadth:Kd,getComponentsHierarchyDepth:Jd,getComponentsDescendants:Zd,getComponentsDescendantsBreadth:Yd,getComponentsDescendantsDepth:$d,getComponentsChildren:e_,setActive:t_,setActiveSelf:i_,setActiveHierarchy:n_,setActiveHierarchyBreadth:o_,setActiveHierarchyDepth:s_,setActiveDescendants:a_,setActiveDescendantsBreadth:r_,setActiveDescendantsDepth:l_,setActiveChildren:m_,hasUniformScale:rD,hasUniformScaleWorld:y_,hasUniformScaleLocal:u_,clone:lD,isCloneable:mD,toString:yD,toStringExtended:uD,toStringCompact:hD,getObjectByName:cD,getObjectByNameHierarchy:h_,getObjectByNameHierarchyBreadth:c_,getObjectByNameHierarchyDepth:p_,getObjectByNameDescendants:d_,getObjectByNameDescendantsBreadth:__,getObjectByNameDescendantsDepth:g_,getObjectByNameChildren:f_,getObjectsByName:pD,getObjectsByNameHierarchy:T_,getObjectsByNameHierarchyBreadth:P_,getObjectsByNameHierarchyDepth:C_,getObjectsByNameDescendants:b_,getObjectsByNameDescendantsBreadth:S_,getObjectsByNameDescendantsDepth:v_,getObjectsByNameChildren:x_,getObjectByID:dD,getObjectByIDHierarchy:M_,getObjectByIDHierarchyBreadth:D_,getObjectByIDHierarchyDepth:E_,getObjectByIDDescendants:A_,getObjectByIDDescendantsBreadth:R_,getObjectByIDDescendantsDepth:O_,getObjectByIDChildren:V_,getHierarchy:I_,getHierarchyBreadth:B_,getHierarchyDepth:L_,getDescendants:H_,getDescendantsBreadth:k_,getDescendantsDepth:F_,getChildren:w_,getSelf:j_,addObject:_D,getName:z_,setName:N_,getEngine:G_,getID:W_,markDirty:U_,isTransformChanged:Q_,equals:gD,destroy:q_,reserveObjects:X_,reserveObjectsSelf:K_,reserveObjectsHierarchy:J_,reserveObjectsDescendants:Z_,reserveObjectsChildren:Y_,getComponentsAmountMap:fD,getComponentsAmountMapSelf:$_,getComponentsAmountMapHierarchy:eg,getComponentsAmountMapDescendants:tg,getComponentsAmountMapChildren:ig,getComponentObjects:ng,getComponentsObjects:og,setActiveObjects:sg,getObjectByNameObjects:ag,getObjectsByNameObjects:rg,getObjectByIDObjects:lg,getObjectsByIDObjects:mg,wrapObject:yg};function nr(i,e,t){let n=e.get("object")*i;e.delete("object");let o={};for(let[s,a]of e.entries())o[s]=a*i;t.reserveObjects(n,o)}function TD(i){return y.wrapObject(0,i.engine)}function PD(i){return y.addObject(Z.getRoot(i))}function ug(i){return Z.getObjectsBreadth(i)}function hg(i){return y.getHierarchyBreadth(Z.getRoot(i))}function cg(i){return y.getHierarchyDepth(Z.getRoot(i))}function CD(i,e,t=0){return Z.getComponentBreadth(i,e,t)}function pg(i,e,t=0){return y.getComponentHierarchyBreadth(Z.getRoot(i),e,t)}function dg(i,e,t=0){return y.getComponentHierarchyDepth(Z.getRoot(i),e,t)}function bD(i,e){return Z.getComponentsBreadth(i,e)}function _g(i,e){return y.getComponentsHierarchyBreadth(Z.getRoot(i),e)}function gg(i,e){return y.getComponentsHierarchyDepth(Z.getRoot(i),e)}function SD(i,e,t=!1,n=0){return Z.getObjectByNameBreadth(i,e,t,n)}function fg(i,e,t=!1,n=0){return y.getObjectByNameHierarchyBreadth(Z.getRoot(i),e,t,n)}function Tg(i,e,t=!1,n=0){return y.getObjectByNameHierarchyDepth(Z.getRoot(i),e,t,n)}function vD(i,e,t=!1){return Z.getObjectsByNameBreadth(i,e,t)}function Pg(i,e,t=!1){return y.getObjectsByNameHierarchyBreadth(Z.getRoot(i),e,t)}function Cg(i,e,t=!1){return y.getObjectsByNameHierarchyDepth(Z.getRoot(i),e,t)}function xD(i,e){return Z.getObjectByIDBreadth(i,e)}function bg(i,e){return y.getObjectByIDHierarchyBreadth(Z.getRoot(i),e)}function Sg(i,e){return y.getObjectByIDHierarchyDepth(Z.getRoot(i),e)}function MD(i){return Z.toStringCompact(i)}function DD(i){return y.toStringCompact(Z.getRoot(i))}function ED(i){return y.toStringExtended(Z.getRoot(i))}function AD(i,e=new Map){return y.getComponentsAmountMap(Z.getRoot(i),e)}var Z={getRoot:TD,addObject:PD,getObjects:ug,getObjectsBreadth:hg,getObjectsDepth:cg,getComponent:CD,getComponentBreadth:pg,getComponentDepth:dg,getComponents:bD,getComponentsBreadth:_g,getComponentsDepth:gg,getObjectByName:SD,getObjectByNameBreadth:fg,getObjectByNameDepth:Tg,getObjectsByName:vD,getObjectsByNameBreadth:Pg,getObjectsByNameDepth:Cg,getObjectByID:xD,getObjectByIDBreadth:bg,getObjectByIDDepth:Sg,toString:MD,toStringCompact:DD,toStringExtended:ED,getComponentsAmountMap:AD};var il=null,rs=[];function vg(i){i!=null&&(sl(i),Jt()==null&&nl(i))}function Jt(){return il}function nl(i){rl(i)&&(il=i)}function ol(){il=null}function xg(){return rs}function sl(i){al(i),rs.push(i)}function al(i){let e=rs.indexOf(i);e>=0&&(rs.splice(e,1),Jt()==i&&ol())}function rl(i){return rs.indexOf(i)>=0}function ll(i=Jt()){let e=null;return i!=null&&(e=i.scene),e}function RD(i=Jt()){let e=null,t=ll(i);return t!=null&&(e=Z.getRoot(t)),e}function Mg(i=Jt()){let e=null;return i!=null&&(e=i.physics),e}function Dg(i=Jt()){let e=null;return i!=null&&(e=i.canvas),e}function Eg(i=Jt()){let e=null;return i!=null&&(e=i.wasm),e}function Ag(i=Jt()){let e=null;return i!=null&&(e=i.xr),e}var ul={};_t(ul,{getDebugManager:()=>yl,getDebugVisualManager:()=>Ig,hasDebugEnabled:()=>kg,hasDebugManager:()=>Vg,isDebugEnabled:()=>Bg,removeDebugEnabled:()=>Hg,removeDebugManager:()=>Og,setDebugEnabled:()=>Lg,setDebugManager:()=>Rg});var or=new WeakMap,sr=new WeakMap;function yl(i=r.getMainEngine()){return or.get(i)}function Rg(i,e=r.getMainEngine()){or.set(e,i)}function Og(i=r.getMainEngine()){or.delete(i)}function Vg(i=r.getMainEngine()){return or.has(i)}function Ig(i=r.getMainEngine()){let e=yl(i);return e!=null?e.getDebugVisualManager():null}function Bg(i=r.getMainEngine()){return sr.get(i)}function Lg(i,e=r.getMainEngine()){sr.set(e,i)}function Hg(i=r.getMainEngine()){sr.delete(i)}function kg(i=r.getMainEngine()){return sr.has(i)}var hl={};_t(hl,{getCharacterCollisionSystem:()=>Fg,hasCharacterCollisionSystem:()=>zg,removeCharacterCollisionSystem:()=>jg,setCharacterCollisionSystem:()=>wg});var ar=new WeakMap;function Fg(i=r.getMainEngine()){return ar.get(i)}function wg(i,e=r.getMainEngine()){ar.set(e,i)}function jg(i=r.getMainEngine()){ar.delete(i)}function zg(i=r.getMainEngine()){return ar.has(i)}var cl={};_t(cl,{getGamepad:()=>Xg,getGamepads:()=>Kg,getGamepadsManager:()=>qg,getHandPose:()=>$g,getHandPoses:()=>ef,getHeadPose:()=>Yg,getInputManager:()=>Xe,getKeyboard:()=>Qg,getLeftGamepad:()=>Jg,getLeftHandPose:()=>tf,getLeftTrackedHandPose:()=>af,getMouse:()=>Ug,getRightGamepad:()=>Zg,getRightHandPose:()=>nf,getRightTrackedHandPose:()=>rf,getTrackedHandPose:()=>of,getTrackedHandPoses:()=>sf,hasInputManager:()=>Wg,hasPoseForwardFixed:()=>uf,isPoseForwardFixed:()=>lf,removeInputManager:()=>Gg,removePoseForwardFixed:()=>yf,setInputManager:()=>Ng,setPoseForwardFixed:()=>mf});var rr=new WeakMap,lr=new WeakMap;function Xe(i=r.getMainEngine()){return rr.get(i)}function Ng(i,e=r.getMainEngine()){rr.set(e,i)}function Gg(i=r.getMainEngine()){rr.delete(i)}function Wg(i=r.getMainEngine()){return rr.has(i)}function Ug(i=r.getMainEngine()){let e=Xe(i);return e!=null?e.getMouse():null}function Qg(i=r.getMainEngine()){let e=Xe(i);return e!=null?e.getKeyboard():null}function qg(i=r.getMainEngine()){let e=Xe(i);return e!=null?e.getGamepadsManager():null}function Xg(i,e=r.getMainEngine()){let t=Xe(e);return t!=null?t.getGamepadsManager().getGamepad(i):null}function Kg(i=r.getMainEngine()){let e=Xe(i);return e!=null?e.getGamepadsManager().getGamepads():null}function Jg(i=r.getMainEngine()){let e=Xe(i);return e!=null?e.getGamepadsManager().getLeftGamepad():null}function Zg(i=r.getMainEngine()){let e=Xe(i);return e!=null?e.getGamepadsManager().getRightGamepad():null}function Yg(i=r.getMainEngine()){let e=Xe(i);return e!=null?e.getHeadPose():null}function $g(i,e=r.getMainEngine()){let t=Xe(e);return t!=null?t.getHandPose(i):null}function ef(i=r.getMainEngine()){let e=Xe(i);return e!=null?e.getHandPoses():null}function tf(i=r.getMainEngine()){let e=Xe(i);return e!=null?e.getLeftHandPose():null}function nf(i=r.getMainEngine()){let e=Xe(i);return e!=null?e.getRightHandPose():null}function of(i,e=r.getMainEngine()){let t=Xe(e);return t!=null?t.getTrackedHandPose(i):null}function sf(i=r.getMainEngine()){let e=Xe(i);return e!=null?e.getTrackedHandPoses():null}function af(i=r.getMainEngine()){let e=Xe(i);return e!=null?e.getLeftTrackedHandPose():null}function rf(i=r.getMainEngine()){let e=Xe(i);return e!=null?e.getRightTrackedHandPose():null}function lf(i=r.getMainEngine()){return lr.get(i)}function mf(i,e=r.getMainEngine()){lr.set(e,i)}function yf(i=r.getMainEngine()){lr.delete(i)}function uf(i=r.getMainEngine()){return lr.has(i)}var pl={};_t(pl,{hasToolEnabled:()=>df,isToolEnabled:()=>hf,removeToolEnabled:()=>pf,setToolEnabled:()=>cf});var mr=new WeakMap;function hf(i=r.getMainEngine()){return mr.get(i)}function cf(i,e=r.getMainEngine()){mr.set(e,i)}function pf(i=r.getMainEngine()){mr.delete(i)}function df(i=r.getMainEngine()){return mr.has(i)}var dl={};_t(dl,{getConsoleVR:()=>_f,hasConsoleVR:()=>Tf,removeConsoleVR:()=>ff,setConsoleVR:()=>gf});var yr=new WeakMap;function _f(i=r.getMainEngine()){return yr.get(i)}function gf(i,e=r.getMainEngine()){yr.set(e,i)}function ff(i=r.getMainEngine()){yr.delete(i)}function Tf(i=r.getMainEngine()){return yr.has(i)}var _l={};_t(_l,{getEasyTuneTarget:()=>vf,getEasyTuneVariables:()=>Pf,hasEasyTuneTarget:()=>Df,hasEasyTuneVariables:()=>Sf,removeEasyTuneTarget:()=>Mf,removeEasyTuneVariables:()=>bf,setEasyTuneTarget:()=>xf,setEasyTuneVariables:()=>Cf});var ur=new WeakMap,hr=new WeakMap;function Pf(i=r.getMainEngine()){return ur.get(i)}function Cf(i,e=r.getMainEngine()){ur.set(e,i)}function bf(i=r.getMainEngine()){ur.delete(i)}function Sf(i=r.getMainEngine()){return ur.has(i)}function vf(i=r.getMainEngine()){return hr.get(i)}function xf(i,e=r.getMainEngine()){hr.set(e,i)}function Mf(i=r.getMainEngine()){hr.delete(i)}function Df(i=r.getMainEngine()){return hr.has(i)}var gl={};_t(gl,{getDefaultMaterials:()=>Vf,getDefaultMeshes:()=>Of,getDefaultResources:()=>pr,hasDefaultResources:()=>Rf,removeDefaultResources:()=>Af,setDefaultResources:()=>Ef});var cr=new WeakMap;function pr(i=r.getMainEngine()){return cr.get(i)}function Ef(i,e=r.getMainEngine()){cr.set(e,i)}function Af(i=r.getMainEngine()){cr.delete(i)}function Rf(i=r.getMainEngine()){return cr.has(i)}function Of(i=r.getMainEngine()){let e=pr(i);return e!=null?e.myMeshes:null}function Vf(i=r.getMainEngine()){let e=pr(i);return e!=null?e.myMaterials:null}var Tl={};_t(Tl,{getPlayerObjects:()=>Hf,getSceneObjects:()=>fl,hasSceneObjects:()=>Lf,removeSceneObjects:()=>Bf,setSceneObjects:()=>If});var dr=new WeakMap;function fl(i=r.getMainEngine()){return dr.get(i)}function If(i,e=r.getMainEngine()){dr.set(e,i)}function Bf(i=r.getMainEngine()){dr.delete(i)}function Lf(i=r.getMainEngine()){return dr.has(i)}function Hf(i=r.getMainEngine()){let e=fl(i);return e!=null?e.myPlayerObjects:null}var r={...ml,...Tl,...gl,...Jr,...el,...ul,...Yr,...$r,...hl,...cl,...pl,...dl,..._l};import{MeshComponent as cT,TextComponent as $D}from"@wonderlandengine/api";import{Mesh as fr,MeshAttribute as Ce,MeshIndexType as Tr}from"@wonderlandengine/api";import{vec2 as Ji}from"gl-matrix";function Pl(i,e){let t=Ji.create();return i!==void 0&&kf(t,i,e),t}function kf(i,e,t){return t===void 0?Ji.set(i,e,e):Ji.set(i,e,t),i}function OD(i){return Ji.length(i)}function VD(i,e=Pl()){return Ji.normalize(e,i),e}function ID(i,e){return Ji.copy(e,i),e}function BD(i,e=Pl()){return ft.copy(i,e),e}function LD(i){return Ji.zero(i),i}function HD(i,e=0){return ft.length(i)<=e}var ft={create:Pl,set:kf,length:OD,normalize:VD,copy:ID,clone:BD,zero:LD,isZero:HD};import{vec4 as _r}from"gl-matrix";function Ff(i,e,t,n){let o=_r.create();return i!==void 0&&wf(o,i,e,t,n),o}function wf(i,e,t,n,o){return t===void 0?_r.set(i,e,e,e,e):_r.set(i,e,t,n,o),i}function kD(i,e){return _r.copy(e,i),e}function FD(i,e=Ff()){return Vi.copy(i,e),e}var Vi={create:Ff,set:wf,copy:kD,clone:FD};function wD(i,e=null){e=To(i,e);for(let t=0;t<e.length;t++)e[t]=0;return e}function jD(i,e=0){let t=!0;for(let n=0;n<i.length&&t;n++)t=t&&Math.abs(i[n])<=e;return t}function zD(i,e,t=null){t=To(i,t);for(let n=0;n<t.length;n++)t[n]=t[n]*e;return t}function jf(i,e=null){e=To(i,e);for(let t=0;t<e.length;t++)e[t]=Math.round(e[t]);return e}function zf(i,e=null){e=To(i,e);for(let t=0;t<e.length;t++)e[t]=Math.floor(e[t]);return e}function Nf(i,e=null){e=To(i,e);for(let t=0;t<e.length;t++)e[t]=Math.ceil(e[t]);return e}function ND(i,e,t,n=null){n=To(i,n);let o=e??-Number.MAX_VALUE,s=t??Number.MAX_VALUE,a=Math.min(o,s),l=Math.max(o,s);for(let u=0;u<n.length;u++)n[u]=L.clamp(n[u],a,l);return n}function GD(i,e,t=0){let n=i.length==e.length;for(let o=0;o<i.length&&n;o++)n=n&&Math.abs(i[o]-e[o])<=t;return n}function WD(i,e=null){return gr(i,e)}function UD(i,e=4){let t=gr(i,e);console.log(t)}function QD(i,e=4){let t=gr(i,e);console.error(t)}function qD(i,e=4){let t=gr(i,e);console.warn(t)}var Tt={zero:wD,isZero:jD,scale:zD,round:jf,floor:zf,ceil:Nf,clamp:ND,equals:GD,toString:WD,log:UD,error:QD,warn:qD};function gr(i,e){let t="[";for(let n=0;n<i.length;n++)n!=0&&(t=t.concat(", ")),e!=null?t=t.concat(i[n].toFixed(e)):t=t.concat(i[n].toString());return t=t.concat("]"),t}function To(i,e){return e==null?e=K.clone(i):e!=i&&K.copy(i,e),e}function Gf(i){let e=[];e.push(i);let t=Object.getPrototypeOf(i);for(;t!=null;)K.pushUnique(e,t),t=Object.getPrototypeOf(t);let n=[i];for(;n.length>0;){let o=n.shift();o!=null&&(K.pushUnique(e,o),K.pushUnique(n,Object.getPrototypeOf(o)),K.pushUnique(n,o.prototype))}return e}function Wf(i){let e=[],t=$.getObjectPrototypes(i);for(let n of t)if(n!=null){let o=Object.getOwnPropertyNames(n);for(let s of o)K.pushUnique(e,s)}return e}function Uf(i,e){let t=null,n=$.getObjectPropertyOwnParent(i,e);return n!=null&&(t=Object.getOwnPropertyDescriptor(n,e)),t}function Qf(i,e){let t,n=$.getObjectPropertyDescriptor(i,e);return n!=null&&(n.get!=null?t=n.get.bind(i)():t=n.value),t}function qf(i,e,t){let n=$.getObjectPropertyDescriptor(e,t),o=!1;if(n!=null&&n.set!=null&&(o=!0,n.set.bind(e)(i)),!o){let s=$.getObjectPropertyOwnParent(e,t);s==null&&(s=e),Object.defineProperty(s,t,{value:i})}}function Xf(i,e){let t=null,n=$.getObjectPropertyOwnParents(i,e);return n.length>0&&(t=n[0]),t}function Kf(i,e){let t=[],n=$.getObjectPrototypes(i);for(let o of n){let s=Object.getOwnPropertyNames(o);K.hasEqual(s,e)&&t.push(o)}return t}function Jf(i,e=r.getWindow()){let t=null,n=$.getObjectNameFromPath(i);return n!=null&&(t=$.getObjectProperty($.getObjectParentFromPath(i,e),n)),t}function Zf(i){let e=null;if(i!=null){let t=i.split(".");t.length>0&&(e=t[t.length-1])}return e}function Yf(i,e=r.getWindow()){let t=i.split("."),n=e;for(let o=0;o<t.length-1;o++)n=$.getObjectProperty(n,t[o]);return n}function $f(i,e,t,n=!0,o=!1,s=!1){let a=!1;try{let l=$.getObjectPropertyOwnParent(e,t);if(l!=null){let u=Object.getOwnPropertyDescriptor(l,t);if(u!=null){let _=$.getObjectProperty(l,t);$.copyObjectProperties(_,i,!0,o,s);let m=e;n&&(m=l),Object.defineProperty(m,t,{value:i,enumerable:u.enumerable,writable:u.writable,configurable:u.configurable}),a=!0}else Object.defineProperty(e,t,{value:i}),a=!0}else Object.defineProperty(e,t,{value:i}),a=!0}catch{s&&console.error("Property:",t,"of:",e,"can't be overwritten.")}return a}function eT(i,e,t=!1,n=!1,o=!1){if(i!=null){t&&$.cleanObjectProperties(e),Object.setPrototypeOf(e,Object.getPrototypeOf(i));let s=Object.getOwnPropertyNames(i);for(let a of s)try{let l=Object.getOwnPropertyDescriptor(i,a);Object.defineProperty(e,a,{value:l.value,enumerable:l.enumerable,writable:l.writable,configurable:l.configurable})}catch{o&&console.error("Property:",a,"of:",i.name,"can't be overwritten.")}n&&XD(i,e)}}function tT(i){let e=Object.getOwnPropertyNames(i);K.pushUnique(e,"__proto__");for(let t of e){try{Object.defineProperty(i,t,{value:void 0})}catch{}try{delete i[t]}catch{}}Object.setPrototypeOf(i,null)}function iT(i,e){let t=!1,n=$.getObjectPropertyDescriptor(i,e);return n!=null&&(n.get!=null||n.set!=null)&&(t=!0),t}function nT(i,e){let t=!1,n=$.getObjectProperty(i,e);return n!=null&&(t=$.isFunction(n)&&!$.isClassByName(i,e)),t}function oT(i,e){let t=!1,n=$.getObjectProperty(i,e);return n!=null&&(t=$.isClass(n)&&e!="constructor"),t}function sT(i,e){let t=!1,n=$.getObjectProperty(i,e);return n!=null&&(t=$.isObject(n)),t}function aT(i){return typeof i=="function"&&!$.isClass(i)}var rT=function(){let i=new RegExp("^class");return function(t){return typeof t=="function"&&t.prototype!=null&&typeof t.prototype.constructor=="function"&&t.toString!=null&&typeof t.toString=="function"&&t.toString()?.match(i)!=null}}();function lT(i){return typeof i=="object"}var $={getObjectPrototypes:Gf,getObjectPropertyNames:Wf,getObjectPropertyDescriptor:Uf,getObjectProperty:Qf,setObjectProperty:qf,getObjectPropertyOwnParent:Xf,getObjectPropertyOwnParents:Kf,getObjectFromPath:Jf,getObjectNameFromPath:Zf,getObjectParentFromPath:Yf,overwriteObjectProperty:$f,copyObjectProperties:eT,cleanObjectProperties:tT,doesObjectPropertyUseAccessors:iT,isFunctionByName:nT,isClassByName:oT,isObjectByName:sT,isFunction:aT,isClass:rT,isObject:lT};function XD(i,e){try{if(typeof e=="function"&&typeof i=="function"){let t=["toString","toLocaleString","valueOf"];for(let n of t){let o=$.getObjectPropertyDescriptor(i,n);if(o!=null&&o.value!=null&&o.value==Object[n]){let s=Object[n].bind(i)(),a=function(){return s};$.overwriteObjectProperty(a,e,n,!1,!1)}}}}catch{}}function mT(i,e,t=!0,n=!0,o=!0,s=!0,a=!1,l=null,u=[]){let _=Object.getOwnPropertyNames(i);for(let m of _){if(u.includes(m))continue;let h=t,d=n,g=o;if(s){let S=Object.getOwnPropertyDescriptor(e,m);S!=null&&(h=S.enumerable,d=S.writable,g=S.configurable)}let P=m;l!=null&&(P.length>0&&P[0]==P[0].toUpperCase()?P=l.toUpperCase()+P:P=l+P);let C=Object.getOwnPropertyDescriptor(i,m);if(C!=null&&(C.get!=null||C.set!=null))Object.defineProperty(e,P,{get:C.get,set:C.set,enumerable:h,configurable:g});else{let S=i[m];if(a&&$.isFunction(S)){let M=i[m];S=function(){return M(this,...arguments)},Object.defineProperty(S,"name",{value:P})}Object.defineProperty(e,P,{value:S,enumerable:h,writable:d,configurable:g})}}}var xe={injectProperties:mT};function Cl(){yT()}function Ae(i,e){return ft.create(...arguments)}function c(i,e,t){return p.create(...arguments)}function F(i,e,t,n){return Vi.create(...arguments)}function j(i,e,t,n){return T.create(...arguments)}function N(i,e,t,n,o,s,a,l){return V.create(...arguments)}function KD(i,e,t,n,o,s,a,l,u){return Y.create(...arguments)}function be(i,e,t,n,o,s,a,l,u,_,m,h,d,g,P,C){return O.create(...arguments)}function yT(){let i={};i.pp_first=function(){return K.first(this,...arguments)},i.pp_last=function(){return K.last(this,...arguments)},i.pp_has=function(h){return K.has(this,...arguments)},i.pp_hasEqual=function(h,d=null){return K.hasEqual(this,...arguments)},i.pp_find=function(h){return K.find(this,...arguments)},i.pp_findIndex=function(h){return K.findIndex(this,...arguments)},i.pp_findAll=function(h){return K.findAll(this,...arguments)},i.pp_findAllIndexes=function(h){return K.findAllIndexes(this,...arguments)},i.pp_findEqual=function(h,d=null){return K.findEqual(this,...arguments)},i.pp_findAllEqual=function(h,d=null){return K.findAllEqual(this,...arguments)},i.pp_findIndexEqual=function(h,d=null){return K.findIndexEqual(this,...arguments)},i.pp_findAllIndexesEqual=function(h,d=null){return K.findAllIndexesEqual(this,...arguments)},i.pp_removeIndex=function(h){return K.removeIndex(this,...arguments)},i.pp_removeAllIndexes=function(h){return K.removeAllIndexes(this,...arguments)},i.pp_remove=function(h){return K.remove(this,...arguments)},i.pp_removeAll=function(h){return K.removeAll(this,...arguments)},i.pp_removeEqual=function(h,d=null){return K.removeEqual(this,...arguments)},i.pp_removeAllEqual=function(h,d=null){return K.removeAllEqual(this,...arguments)},i.pp_pushUnique=function(h,d=null){return K.pushUnique(this,...arguments)},i.pp_unshiftUnique=function(h,d=null){return K.unshiftUnique(this,...arguments)},i.pp_copy=function(h,d=null){return K.copy(h,this,d)},i.pp_clone=function(h=null){return K.clone(this,...arguments)},i.pp_equals=function(h,d=null){return K.equals(this,...arguments)},i.pp_clear=function(){return K.clear(this,...arguments)};let e={};e.vec_zero=function(h=null){return Tt.zero(this,...arguments)},e.vec_isZero=function(h=0){return Tt.isZero(this,...arguments)},e.vec_scale=function(h,d=null){return Tt.scale(this,...arguments)},e.vec_round=function(h=null){return Tt.round(this,...arguments)},e.vec_floor=function(h=null){return Tt.floor(this,...arguments)},e.vec_ceil=function(h=null){return Tt.ceil(this,...arguments)},e.vec_clamp=function(h,d,g=null){return Tt.clamp(this,...arguments)},e.vec_equals=function(h,d=0){return Tt.equals(this,...arguments)},e.vec_toString=function(h=null){return Tt.toString(this,...arguments)},e.vec_log=function(h=4){return Tt.log(this,...arguments)},e.vec_error=function(h=4){return Tt.error(this,...arguments)},e.vec_warn=function(h=4){return Tt.warn(this,...arguments)};let t={};t.vec2_set=function(h,d){return ft.set(this,...arguments)},t.vec2_length=function(){return ft.length(this,...arguments)},t.vec2_normalize=function(h=ft.create()){return ft.normalize(this,...arguments)},t.vec2_copy=function(h){return ft.copy(h,this)},t.vec2_clone=function(h=ft.create()){return ft.clone(this,...arguments)},t.vec2_zero=function(){return ft.zero(this,...arguments)},t.vec2_isZero=function(h=0){return ft.isZero(this,...arguments)};let n={};n.vec3_set=function(h,d,g){return p.set(this,...arguments)},n.vec3_normalize=function(h=p.create()){return p.normalize(this,...arguments)},n.vec3_copy=function(h){return p.copy(h,this)},n.vec3_clone=function(h=p.create()){return p.clone(this,...arguments)},n.vec3_zero=function(){return p.zero(this,...arguments)},n.vec3_angle=function(h){return p.angle(this,...arguments)},n.vec3_angleDegrees=function(h){return p.angleDegrees(this,...arguments)},n.vec3_angleRadians=function(h){return p.angleRadians(this,...arguments)},n.vec3_equals=function(h,d=0){return p.equals(this,...arguments)},n.vec3_length=function(){return p.length(this,...arguments)},n.vec3_lengthSquared=function(){return p.lengthSquared(this,...arguments)},n.vec3_distance=function(h){return p.distance(this,...arguments)},n.vec3_distanceSquared=function(h){return p.distanceSquared(this,...arguments)},n.vec3_add=function(h,d=p.create()){return p.add(this,...arguments)},n.vec3_sub=function(h,d=p.create()){return p.sub(this,...arguments)},n.vec3_mul=function(h,d=p.create()){return p.mul(this,...arguments)},n.vec3_div=function(h,d=p.create()){return p.div(this,...arguments)},n.vec3_scale=function(h,d=p.create()){return p.scale(this,...arguments)},n.vec3_dot=function(h){return p.dot(this,...arguments)},n.vec3_negate=function(h=p.create()){return p.negate(this,...arguments)},n.vec3_cross=function(h,d=p.create()){return p.cross(this,...arguments)},n.vec3_transformQuat=function(h,d=p.create()){return p.transformQuat(this,...arguments)},n.vec3_transformMat3=function(h,d=p.create()){return p.transformMat3(this,...arguments)},n.vec3_transformMat4=function(h,d=p.create()){return p.transformMat4(this,...arguments)},n.vec3_lengthSigned=function(h){return p.lengthSigned(this,...arguments)},n.vec3_angleSigned=function(h,d){return p.angleSigned(this,...arguments)},n.vec3_angleSignedDegrees=function(h,d){return p.angleSignedDegrees(this,...arguments)},n.vec3_angleSignedRadians=function(h,d){return p.angleSignedRadians(this,...arguments)},n.vec3_anglePivoted=function(h,d){return p.anglePivoted(this,...arguments)},n.vec3_anglePivotedDegrees=function(h,d){return p.anglePivotedDegrees(this,...arguments)},n.vec3_anglePivotedRadians=function(h,d){return p.anglePivotedRadians(this,...arguments)},n.vec3_anglePivotedSigned=function(h,d){return p.anglePivotedSigned(this,...arguments)},n.vec3_anglePivotedSignedDegrees=function(h,d){return p.anglePivotedSignedDegrees(this,...arguments)},n.vec3_anglePivotedSignedRadians=function(h,d){return p.anglePivotedSignedRadians(this,...arguments)},n.vec3_toRadians=function(h=p.create()){return p.toRadians(this,...arguments)},n.vec3_toDegrees=function(h=p.create()){return p.toDegrees(this,...arguments)},n.vec3_toQuat=function(h){return p.toQuat(this,...arguments)},n.vec3_radiansToQuat=function(h=T.create()){return p.radiansToQuat(this,...arguments)},n.vec3_degreesToQuat=function(h=T.create()){return p.degreesToQuat(this,...arguments)},n.vec3_isNormalized=function(h=L.EPSILON){return p.isNormalized(this,...arguments)},n.vec3_isZero=function(h=0){return p.isZero(this,...arguments)},n.vec3_componentAlongAxis=function(h,d=p.create()){return p.componentAlongAxis(this,...arguments)},n.vec3_valueAlongAxis=function(h){return p.valueAlongAxis(this,...arguments)},n.vec3_removeComponentAlongAxis=function(h,d=p.create()){return p.removeComponentAlongAxis(this,...arguments)},n.vec3_copyComponentAlongAxis=function(h,d,g=p.create()){return p.copyComponentAlongAxis(h,this,d,g)},n.vec3_isConcordant=function(h){return p.isConcordant(this,...arguments)},n.vec3_isFartherAlongAxis=function(h,d){return p.isFartherAlongAxis(this,...arguments)},n.vec3_isToTheRight=function(h,d){return p.isToTheRight(this,...arguments)},n.vec3_signTo=function(h,d,g=1){return p.signTo(this,...arguments)},n.vec3_projectOnAxis=function(h,d=p.create()){return p.projectOnAxis(this,...arguments)},n.vec3_projectOnAxisAlongAxis=function(h,d,g=p.create()){return p.projectOnAxisAlongAxis(this,...arguments)},n.vec3_projectOnPlane=function(h,d=p.create()){return p.projectOnPlane(this,...arguments)},n.vec3_projectOnPlaneAlongAxis=function(h,d,g=p.create()){return p.projectOnPlaneAlongAxis(this,...arguments)},n.vec3_isOnAxis=function(h){return p.isOnAxis(this,...arguments)},n.vec3_isOnPlane=function(h){return p.isOnPlane(this,...arguments)},n.vec3_rotate=function(h,d){return p.rotate(this,...arguments)},n.vec3_rotateDegrees=function(h,d){return p.rotateDegrees(this,...arguments)},n.vec3_rotateRadians=function(h,d){return p.rotateRadians(this,...arguments)},n.vec3_rotateQuat=function(h,d){return p.rotateQuat(this,...arguments)},n.vec3_rotateAxis=function(h,d,g){return p.rotateAxis(this,...arguments)},n.vec3_rotateAxisDegrees=function(h,d,g){return p.rotateAxisDegrees(this,...arguments)},n.vec3_rotateAxisRadians=function(h,d,g){return p.rotateAxisRadians(this,...arguments)},n.vec3_rotateAround=function(h,d,g){return p.rotateAround(this,...arguments)},n.vec3_rotateAroundDegrees=function(h,d,g=p.create()){return p.rotateAroundDegrees(this,...arguments)},n.vec3_rotateAroundRadians=function(h,d,g=p.create()){return p.rotateAroundRadians(this,...arguments)},n.vec3_rotateAroundQuat=function(h,d,g=p.create()){return p.rotateAroundQuat(this,...arguments)},n.vec3_rotateAroundAxis=function(h,d,g,P){return p.rotateAroundAxis(this,...arguments)},n.vec3_rotateAroundAxisDegrees=function(h,d,g,P){return p.rotateAroundAxisDegrees(this,...arguments)},n.vec3_rotateAroundAxisRadians=function(h,d,g,P=p.create()){return p.rotateAroundAxisRadians(this,...arguments)},n.vec3_convertPositionToWorld=function(h,d){return p.convertPositionToWorld(this,...arguments)},n.vec3_convertPositionToLocal=function(h,d){return p.convertPositionToLocal(this,...arguments)},n.vec3_convertPositionToWorldMatrix=function(h,d=p.create()){return p.convertPositionToWorldMatrix(this,...arguments)},n.vec3_convertPositionToLocalMatrix=function(h,d=p.create()){return p.convertPositionToLocalMatrix(this,...arguments)},n.vec3_convertPositionToWorldQuat=function(h,d=p.create()){return p.convertPositionToWorldQuat(this,...arguments)},n.vec3_convertPositionToLocalQuat=function(h,d=p.create()){return p.convertPositionToLocalQuat(this,...arguments)},n.vec3_convertDirectionToWorld=function(h,d){return p.convertDirectionToWorld(this,...arguments)},n.vec3_convertDirectionToLocal=function(h,d){return p.convertDirectionToLocal(this,...arguments)},n.vec3_convertDirectionToWorldMatrix=function(h,d=p.create()){return p.convertDirectionToWorldMatrix(this,...arguments)},n.vec3_convertDirectionToLocalMatrix=function(h,d=p.create()){return p.convertDirectionToLocalMatrix(this,...arguments)},n.vec3_convertDirectionToWorldQuat=function(h,d=p.create()){return p.convertDirectionToWorldQuat(this,...arguments)},n.vec3_convertDirectionToLocalQuat=function(h,d=p.create()){return p.convertDirectionToLocalQuat(this,...arguments)},n.vec3_addRotation=function(h,d){return p.addRotation(this,...arguments)},n.vec3_addRotationDegrees=function(h,d){return p.addRotationDegrees(this,...arguments)},n.vec3_addRotationRadians=function(h,d){return p.addRotationRadians(this,...arguments)},n.vec3_addRotationQuat=function(h,d){return p.addRotationQuat(this,...arguments)},n.vec3_degreesAddRotation=function(h,d){return p.degreesAddRotation(this,...arguments)},n.vec3_degreesAddRotationDegrees=function(h,d=p.create()){return p.degreesAddRotationDegrees(this,...arguments)},n.vec3_degreesAddRotationRadians=function(h,d=p.create()){return p.degreesAddRotationRadians(this,...arguments)},n.vec3_degreesAddRotationQuat=function(h,d=p.create()){return p.degreesAddRotationQuat(this,...arguments)},n.vec3_radiansAddRotation=function(h,d){return p.radiansAddRotation(this,...arguments)},n.vec3_radiansAddRotationDegrees=function(h,d=p.create()){return p.radiansAddRotationDegrees(this,...arguments)},n.vec3_radiansAddRotationRadians=function(h,d=p.create()){return p.radiansAddRotationRadians(this,...arguments)},n.vec3_radiansAddRotationQuat=function(h,d=p.create()){return p.radiansAddRotationQuat(this,...arguments)},n.vec3_toMatrix=function(h=Y.create()){return p.toMatrix(this,...arguments)},n.vec3_degreesToMatrix=function(h=Y.create()){return p.degreesToMatrix(this,...arguments)},n.vec3_radiansToMatrix=function(h=Y.create()){return p.radiansToMatrix(this,...arguments)},n.vec3_rotationTo=function(h,d){return p.rotationTo(this,...arguments)},n.vec3_rotationToDegrees=function(h,d=p.create()){return p.rotationToDegrees(this,...arguments)},n.vec3_rotationToRadians=function(h,d=p.create()){return p.rotationToRadians(this,...arguments)},n.vec3_rotationToQuat=function(h,d=T.create()){return p.rotationToQuat(this,...arguments)},n.vec3_rotationToPivoted=function(h,d,g){return p.rotationToPivoted(this,...arguments)},n.vec3_rotationToPivotedDegrees=function(h,d,g=p.create()){return p.rotationToPivotedDegrees(this,...arguments)},n.vec3_rotationToPivotedRadians=function(h,d,g=p.create()){return p.rotationToPivotedRadians(this,...arguments)},n.vec3_rotationToPivotedQuat=function(h,d,g=T.create()){return p.rotationToPivotedQuat(this,...arguments)},n.vec3_lerp=function(h,d,g=p.create()){return p.lerp(this,...arguments)},n.vec3_interpolate=function(h,d,g=he.linear,P=p.create()){return p.interpolate(this,...arguments)},n.vec3_perpendicularRandom=function(h=p.create()){return p.perpendicularRandom(this,...arguments)};let o={};o.vec4_set=function(h,d,g,P){return Vi.set(this,...arguments)},o.vec4_copy=function(h){return Vi.copy(h,this)},o.vec4_clone=function(h=Vi.create()){return Vi.clone(this,...arguments)};let s={};s.quat_set=function(h,d,g,P){return T.set(this,...arguments)},s.quat_normalize=function(h=T.create()){return T.normalize(this,...arguments)},s.quat_copy=function(h){return T.copy(h,this)},s.quat_clone=function(h=T.create()){return T.clone(this,...arguments)},s.quat_identity=function(){return T.identity(this,...arguments)},s.quat_length=function(){return T.length(this,...arguments)},s.quat_lengthSquared=function(){return T.lengthSquared(this,...arguments)},s.quat_invert=function(h=T.create()){return T.invert(this,...arguments)},s.quat_conjugate=function(h=T.create()){return T.conjugate(this,...arguments)},s.quat_mul=function(h,d=T.create()){return T.mul(this,...arguments)},s.quat_getAxis=function(h=p.create()){return T.getAxis(this,...arguments)},s.quat_getAngle=function(){return T.getAngle(this,...arguments)},s.quat_getAngleDegrees=function(){return T.getAngleDegrees(this,...arguments)},s.quat_getAngleRadians=function(){return T.getAngleRadians(this,...arguments)},s.quat_getAxisScaled=function(h=p.create()){return T.getAxisScaled(this,...arguments)},s.quat_getAxisScaledDegrees=function(h=p.create()){return T.getAxisScaledDegrees(this,...arguments)},s.quat_getAxisScaledRadians=function(h=p.create()){return T.getAxisScaledRadians(this,...arguments)},s.quat_getAxes=function(h=[p.create(),p.create(),p.create()]){return T.getAxes(this,...arguments)},s.quat_getForward=function(h=p.create()){return T.getForward(this,...arguments)},s.quat_getBackward=function(h){return T.getBackward(this,...arguments)},s.quat_getLeft=function(h=p.create()){return T.getLeft(this,...arguments)},s.quat_getRight=function(h){return T.getRight(this,...arguments)},s.quat_getUp=function(h=p.create()){return T.getUp(this,...arguments)},s.quat_getDown=function(h){return T.getDown(this,...arguments)},s.quat_setAxes=function(h,d,g){return T.setAxes(this,...arguments)},s.quat_setForward=function(h,d=null,g=null){return T.setForward(this,...arguments)},s.quat_setBackward=function(h,d=null,g=null){return T.setBackward(this,...arguments)},s.quat_setUp=function(h,d=null,g=null){return T.setUp(this,...arguments)},s.quat_setDown=function(h,d=null,g=null){return T.setDown(this,...arguments)},s.quat_setLeft=function(h,d=null,g=null){return T.setLeft(this,...arguments)},s.quat_setRight=function(h,d=null,g=null){return T.setRight(this,...arguments)},s.quat_toWorld=function(h,d=T.create()){return T.toWorld(this,...arguments)},s.quat_toLocal=function(h,d=T.create()){return T.toLocal(this,...arguments)},s.quat_fromAxis=function(h,d){return T.fromAxis(h,d,this)},s.quat_fromAxisDegrees=function(h,d){return T.fromAxisDegrees(h,d,this)},s.quat_fromAxisRadians=function(h,d){return T.fromAxisRadians(h,d,this)},s.quat_fromAxes=function(h,d,g){return T.fromAxes(h,d,g,this)},s.quat_fromRadians=function(h){return T.fromRadians(h,this)},s.quat_fromDegrees=function(h){return T.fromDegrees(h,this)},s.quat_toRadians=function(h=p.create()){return T.toRadians(this,...arguments)},s.quat_toDegrees=function(h=p.create()){return T.toDegrees(this,...arguments)},s.quat_isNormalized=function(h=L.EPSILON){return T.isNormalized(this,...arguments)},s.quat_addRotation=function(h,d){return T.addRotation(this,...arguments)},s.quat_addRotationDegrees=function(h,d){return T.addRotationDegrees(this,...arguments)},s.quat_addRotationRadians=function(h,d){return T.addRotationRadians(this,...arguments)},s.quat_addRotationQuat=function(h,d=T.create()){return T.addRotationQuat(this,...arguments)},s.quat_subRotation=function(h,d){return T.subRotation(this,...arguments)},s.quat_subRotationDegrees=function(h,d){return T.subRotationDegrees(this,...arguments)},s.quat_subRotationRadians=function(h,d){return T.subRotationRadians(this,...arguments)},s.quat_subRotationQuat=function(h,d=T.create()){return T.subRotationQuat(this,...arguments)},s.quat_rotationTo=function(h,d){return T.rotationTo(this,...arguments)},s.quat_rotationToDegrees=function(h,d){return T.rotationToDegrees(this,...arguments)},s.quat_rotationToRadians=function(h,d){return T.rotationToRadians(this,...arguments)},s.quat_rotationToQuat=function(h,d){return T.rotationToQuat(this,...arguments)},s.quat_rotationAroundAxis=function(h,d){return T.rotationAroundAxis(this,...arguments)},s.quat_rotationAroundAxisDegrees=function(h,d=p.create()){return T.rotationAroundAxisDegrees(this,...arguments)},s.quat_rotationAroundAxisRadians=function(h,d=p.create()){return T.rotationAroundAxisRadians(this,...arguments)},s.quat_rotationAroundAxisQuat=function(h,d=T.create()){return T.rotationAroundAxisQuat(this,...arguments)},s.quat_getTwist=function(h,d=T.create()){return T.getTwist(this,...arguments)},s.quat_getSwing=function(h,d=T.create()){return T.getSwing(this,...arguments)},s.quat_getSwingFromTwist=function(h,d=T.create()){return T.getSwingFromTwist(this,...arguments)},s.quat_getTwistFromSwing=function(h,d=T.create()){return T.getTwistFromSwing(this,...arguments)},s.quat_fromTwistSwing=function(h,d){return T.fromTwistSwing(h,d,this)},s.quat_toMatrix=function(h=Y.create()){return T.toMatrix(this,...arguments)},s.quat_rotate=function(h,d){return T.rotate(this,...arguments)},s.quat_rotateDegrees=function(h,d){return T.rotateDegrees(this,...arguments)},s.quat_rotateRadians=function(h,d){return T.rotateRadians(this,...arguments)},s.quat_rotateQuat=function(h,d){return T.rotateQuat(this,...arguments)},s.quat_rotateAxis=function(h,d,g){return T.rotateAxis(this,...arguments)},s.quat_rotateAxisDegrees=function(h,d,g){return T.rotateAxisDegrees(this,...arguments)},s.quat_rotateAxisRadians=function(h,d,g){return T.rotateAxisRadians(this,...arguments)},s.quat_lerp=function(h,d,g=T.create()){return T.lerp(this,...arguments)},s.quat_interpolate=function(h,d,g=he.linear,P=T.create()){return T.interpolate(this,...arguments)},s.quat_slerp=function(h,d,g=T.create()){return T.slerp(this,...arguments)},s.quat_sinterpolate=function(h,d,g=he.linear,P=T.create()){return T.sinterpolate(this,...arguments)};let a={};a.quat2_set=function(h,d,g,P,C,f,S,M){return V.set(this,...arguments)},a.quat2_normalize=function(h=V.create()){return V.normalize(this,...arguments)},a.quat2_invert=function(h=V.create()){return V.invert(this,...arguments)},a.quat2_conjugate=function(h=V.create()){return V.conjugate(this,...arguments)},a.quat2_copy=function(h){return V.copy(h,this)},a.quat2_identity=function(){return V.identity(this,...arguments)},a.quat2_getPosition=function(h=p.create()){return V.getPosition(this,...arguments)},a.quat2_getRotation=function(h){return V.getRotation(this,...arguments)},a.quat2_getRotationDegrees=function(h=p.create()){return V.getRotationDegrees(this,...arguments)},a.quat2_getRotationRadians=function(h=p.create()){return V.getRotationRadians(this,...arguments)},a.quat2_getRotationQuat=function(h=T.create()){return V.getRotationQuat(this,...arguments)},a.quat2_setPosition=function(h){return V.setPosition(this,...arguments)},a.quat2_setRotation=function(h){return V.setRotation(this,...arguments)},a.quat2_setRotationDegrees=function(h){return V.setRotationDegrees(this,...arguments)},a.quat2_setRotationRadians=function(h){return V.setRotationRadians(this,...arguments)},a.quat2_setRotationQuat=function(h){return V.setRotationQuat(this,...arguments)},a.quat2_setPositionRotation=function(h,d){return V.setPositionRotation(this,...arguments)},a.quat2_setPositionRotationDegrees=function(h,d){return V.setPositionRotationDegrees(this,...arguments)},a.quat2_setPositionRotationRadians=function(h,d){return V.setPositionRotationRadians(this,...arguments)},a.quat2_setPositionRotationQuat=function(h,d){return V.setPositionRotationQuat(this,...arguments)},a.quat2_isNormalized=function(h=L.EPSILON){return V.isNormalized(this,...arguments)},a.quat2_length=function(){return V.length(this,...arguments)},a.quat2_lengthSquared=function(){return V.lengthSquared(this,...arguments)},a.quat2_mul=function(h,d=V.create()){return V.mul(this,...arguments)},a.quat2_getAxes=function(h=[p.create(),p.create(),p.create()]){return V.getAxes(this,...arguments)},a.quat2_getForward=function(h=p.create()){return V.getForward(this,...arguments)},a.quat2_getBackward=function(h){return V.getBackward(this,...arguments)},a.quat2_getLeft=function(h=p.create()){return V.getLeft(this,...arguments)},a.quat2_getRight=function(h){return V.getRight(this,...arguments)},a.quat2_getUp=function(h=p.create()){return V.getUp(this,...arguments)},a.quat2_getDown=function(h){return V.getDown(this,...arguments)},a.quat2_toWorld=function(h,d=V.create()){return V.toWorld(this,...arguments)},a.quat2_toLocal=function(h,d=V.create()){return V.toLocal(this,...arguments)},a.quat2_rotateAxis=function(h,d,g){return V.rotateAxis(this,...arguments)},a.quat2_rotateAxisDegrees=function(h,d,g){return V.rotateAxisDegrees(this,...arguments)},a.quat2_rotateAxisRadians=function(h,d,g=V.create()){return V.rotateAxisRadians(this,...arguments)},a.quat2_toMatrix=function(h=O.create()){return V.toMatrix(this,...arguments)},a.quat2_fromMatrix=function(h){return V.fromMatrix(h,this)},a.quat2_lerp=function(h,d,g=V.create()){return V.lerp(this,...arguments)},a.quat2_interpolate=function(h,d,g=he.linear,P=V.create()){return V.interpolate(this,...arguments)},a.quat2_slerp=function(h,d,g=V.create()){return V.slerp(this,...arguments)},a.quat2_sinterpolate=function(h,d,g=he.linear,P=V.create()){return V.sinterpolate(this,...arguments)};let l={};l.mat3_set=function(h,d,g,P,C,f,S,M,D){return Y.set(this,...arguments)},l.mat3_toDegrees=function(h=p.create()){return Y.toDegrees(this,...arguments)},l.mat3_toRadians=function(h=p.create()){return Y.toRadians(this,...arguments)},l.mat3_toQuat=function(h=T.create()){return Y.toQuat(this,...arguments)},l.mat3_fromAxes=function(h,d,g){return Y.fromAxes(h,d,g,this)};let u={};u.mat4_set=function(h,d,g,P,C,f,S,M,D,v,b,x,B,H,w,Q){return O.set(this,...arguments)},u.mat4_copy=function(h){return O.copy(h,this)},u.mat4_identity=function(){return O.identity(this,...arguments)},u.mat4_invert=function(h=O.create()){return O.invert(this,...arguments)},u.mat4_mul=function(h,d=O.create()){return O.mul(this,...arguments)},u.mat4_scale=function(h,d=O.create()){return O.scale(this,...arguments)},u.mat4_clone=function(h=O.create()){return O.clone(this,...arguments)},u.mat4_getPosition=function(h=p.create()){return O.getPosition(this,...arguments)},u.mat4_getRotation=function(h=p.create()){return O.getRotation(this,...arguments)},u.mat4_getRotationDegrees=function(h=p.create()){return O.getRotationDegrees(this,...arguments)},u.mat4_getRotationRadians=function(h=p.create()){return O.getRotationRadians(this,...arguments)},u.mat4_getRotationQuat=function(h=T.create()){return O.getRotationQuat(this,...arguments)},u.mat4_getScale=function(h=p.create()){return O.getScale(this,...arguments)},u.mat4_setPosition=function(h){return O.setPosition(this,...arguments)},u.mat4_setRotation=function(h){return O.setRotation(this,...arguments)},u.mat4_setRotationDegrees=function(h){return O.setRotationDegrees(this,...arguments)},u.mat4_setRotationRadians=function(h){return O.setRotationRadians(this,...arguments)},u.mat4_setRotationQuat=function(h){return O.setRotationQuat(this,...arguments)},u.mat4_setScale=function(h){return O.setScale(this,...arguments)},u.mat4_setPositionRotationScale=function(h,d,g){return O.setPositionRotationScale(this,...arguments)},u.mat4_setPositionRotationDegreesScale=function(h,d,g){return O.setPositionRotationDegreesScale(this,...arguments)},u.mat4_setPositionRotationRadiansScale=function(h,d,g){return O.setPositionRotationRadiansScale(this,...arguments)},u.mat4_setPositionRotationQuatScale=function(h,d,g){return O.setPositionRotationQuatScale(this,...arguments)},u.mat4_setPositionRotation=function(h,d){return O.setPositionRotation(this,...arguments)},u.mat4_setPositionRotationDegrees=function(h,d){return O.setPositionRotationDegrees(this,...arguments)},u.mat4_setPositionRotationRadians=function(h,d){return O.setPositionRotationRadians(this,...arguments)},u.mat4_setPositionRotationQuat=function(h,d){return O.setPositionRotationQuat(this,...arguments)},u.mat4_getAxes=function(h=[p.create(),p.create(),p.create()]){return O.getAxes(this,...arguments)},u.mat4_getForward=function(h=p.create()){return O.getForward(this,...arguments)},u.mat4_getBackward=function(h){return O.getBackward(this,...arguments)},u.mat4_getLeft=function(h=p.create()){return O.getLeft(this,...arguments)},u.mat4_getRight=function(h){return O.getRight(this,...arguments)},u.mat4_getUp=function(h=p.create()){return O.getUp(this,...arguments)},u.mat4_getDown=function(h){return O.getDown(this,...arguments)},u.mat4_toWorld=function(h,d=O.create()){return O.toWorld(this,...arguments)},u.mat4_toLocal=function(h,d=O.create()){return O.toLocal(this,...arguments)},u.mat4_hasUniformScale=function(){return O.hasUniformScale(this,...arguments)},u.mat4_toQuat=function(h=V.create()){return O.toQuat(this,...arguments)},u.mat4_fromQuat=function(h){return O.fromQuat(h,this)};let _=[Array.prototype,Uint8ClampedArray.prototype,Uint8Array.prototype,Uint16Array.prototype,Uint32Array.prototype,Int8Array.prototype,Int16Array.prototype,Int32Array.prototype,Float32Array.prototype,Float64Array.prototype];for(let m of _)xe.injectProperties(i,m,!1,!0,!0),xe.injectProperties(e,m,!1,!0,!0),xe.injectProperties(t,m,!1,!0,!0),xe.injectProperties(n,m,!1,!0,!0),xe.injectProperties(o,m,!1,!0,!0),xe.injectProperties(s,m,!1,!0,!0),xe.injectProperties(a,m,!1,!0,!0),xe.injectProperties(l,m,!1,!0,!0),xe.injectProperties(u,m,!1,!0,!0),xe.injectProperties(i,m,!1,!0,!0)}var Po=class{constructor(){this.myPosition=null,this.myTextureCoordinates=null,this.myNormal=null,this.myColor=null}},Ii=class{constructor(){this.myIndexes=new Uint32Array(3)}},Co=class{constructor(e=r.getMainEngine()){this.myVertexes=[],this.myTriangles=[],this.myEngine=e}};function JD(i){let e=[];for(let _ of i.myTriangles)e.push(_.myIndexes[0]),e.push(_.myIndexes[1]),e.push(_.myIndexes[2]);let t=new Uint32Array(e.length);t.pp_copy(e);let n=i.myVertexes.length,o=new fr(i.myEngine,{vertexCount:n,indexData:t,indexType:Tr.UnsignedInt}),s=null,a=null,l=null,u=null;try{s=o.attribute(Ce.Position)}catch{s=null}try{a=o.attribute(Ce.TextureCoordinate)}catch{a=null}try{l=o.attribute(Ce.Normal)}catch{l=null}try{u=o.attribute(Ce.Color)}catch{u=null}for(let _=0;_<i.myVertexes.length;_++){let m=i.myVertexes[_];s!=null&&m.myPosition&&s.set(_,m.myPosition),a!=null&&m.myTextureCoordinates&&a.set(_,m.myTextureCoordinates),l!=null&&m.myNormal&&l.set(_,m.myNormal),u!=null&&m.myColor&&u.set(_,m.myColor)}return o}var ZD=function(){let i=c(),e=Ae(),t=c(),n=F();return function(s){if(s==null)return null;let a=s.indexData.pp_clone(),l=new fr(s.engine,{vertexCount:s.vertexCount,indexData:a,indexType:Tr.UnsignedInt}),u=null,_=null,m=null,h=null,d=null,g=null,P=null,C=null;try{u=s.attribute(Ce.Position),d=l.attribute(Ce.Position)}catch{u=null,d=null}try{_=s.attribute(Ce.TextureCoordinate),g=l.attribute(Ce.TextureCoordinate)}catch{_=null,g=null}try{m=s.attribute(Ce.Normal),P=l.attribute(Ce.Normal)}catch{m=null,P=null}try{h=s.attribute(Ce.Color),C=l.attribute(Ce.Color)}catch{h=null,C=null}for(let f=0;f<s.vertexCount;f++)u!=null&&d!=null&&d.set(f,u.get(f,i)),_!=null&&g!=null&&g.set(f,_.get(f,e)),m!=null&&P!=null&&P.set(f,m.get(f,t)),h!=null&&C!=null&&C.set(f,h.get(f,n));return l}}(),YD=function(){let i=c(),e=Ae(),t=c(),n=F();return function(s){if(s==null)return null;let a=new Uint32Array(s.indexData.length);for(let f=0;f<s.indexData.length/3;f++)a[f*3+0]=s.indexData[f*3+2],a[f*3+1]=s.indexData[f*3+1],a[f*3+2]=s.indexData[f*3+0];let l=new fr(s.engine,{vertexCount:s.vertexCount,indexData:a,indexType:Tr.UnsignedInt}),u=null,_=null,m=null,h=null,d=null,g=null,P=null,C=null;try{u=s.attribute(Ce.Position),d=l.attribute(Ce.Position)}catch{u=null,d=null}try{_=s.attribute(Ce.TextureCoordinate),g=l.attribute(Ce.TextureCoordinate)}catch{_=null,g=null}try{m=s.attribute(Ce.Normal),P=l.attribute(Ce.Normal)}catch{m=null,P=null}try{h=s.attribute(Ce.Color),C=l.attribute(Ce.Color)}catch{h=null,C=null}for(let f=0;f<s.vertexCount;f++)u!=null&&d!=null&&d.set(f,u.get(f,i)),_!=null&&g!=null&&g.set(f,_.get(f,e)),m!=null&&P!=null&&(m.get(f,t),t.vec3_negate(t),P.set(f,t)),h!=null&&C!=null&&C.set(f,h.get(f,n));return l}}(),uT=function(){let i=c(),e=Ae(),t=c(),n=F();return function(s){if(s==null)return null;let a=new Uint32Array(s.indexData.length*2);for(let f=0;f<a.length/3;f++)a[f*3*2+0]=s.indexData[f*3+0]*2,a[f*3*2+1]=s.indexData[f*3+1]*2,a[f*3*2+2]=s.indexData[f*3+2]*2,a[f*3*2+3]=s.indexData[f*3+2]*2+1,a[f*3*2+4]=s.indexData[f*3+1]*2+1,a[f*3*2+5]=s.indexData[f*3+0]*2+1;let l=new fr(s.engine,{vertexCount:s.vertexCount*2,indexData:a,indexType:Tr.UnsignedInt}),u=null,_=null,m=null,h=null,d=null,g=null,P=null,C=null;try{u=s.attribute(Ce.Position),d=l.attribute(Ce.Position)}catch{u=null,d=null}try{_=s.attribute(Ce.TextureCoordinate),g=l.attribute(Ce.TextureCoordinate)}catch{_=null,g=null}try{m=s.attribute(Ce.Normal),P=l.attribute(Ce.Normal)}catch{m=null,P=null}try{h=s.attribute(Ce.Color),C=l.attribute(Ce.Color)}catch{h=null,C=null}for(let f=0;f<s.vertexCount;f++){if(u!=null&&d!=null&&(d.set(f*2,u.get(f,i)),d.set(f*2+1,u.get(f,i))),_!=null&&g!=null&&(g.set(f*2,_.get(f,e)),g.set(f*2+1,_.get(f,e))),m!=null&&P!=null){m.get(f,t),P.set(f*2,t);let S=t.vec3_negate();P.set(f*2+1,S)}h!=null&&C!=null&&(C.set(f*2,h.get(f,n)),C.set(f*2+1,h.get(f,n)))}return l}}();function hT(i=r.getMainEngine()){let e=4,t=new Co(i);for(let a=0;a<e;++a){let l=new Po;l.myPosition=new c,l.myPosition[0]=-1+(a&1)*2,l.myPosition[1]=-1+((a&2)>>1)*2,l.myPosition[2]=0,l.myTextureCoordinates=new Ae,l.myTextureCoordinates[0]=a&1,l.myTextureCoordinates[1]=(a&2)>>1,l.myNormal=new c,l.myNormal[0]=0,l.myNormal[1]=0,l.myNormal[2]=1,t.myVertexes.push(l)}let n=new Ii;n.myIndexes[0]=0,n.myIndexes[1]=1,n.myIndexes[2]=2;let o=new Ii;return o.myIndexes[0]=2,o.myIndexes[1]=1,o.myIndexes[2]=3,t.myTriangles.push(n),t.myTriangles.push(o),Oe.create(t)}var Oe={create:JD,clone:ZD,invert:YD,makeDoubleSided:uT,createPlane:hT};function pT(i,e,t=new Kt,n=null){let o=z.cloneDefault(i,e,!0);return t.isDeepCloneComponentVariable(cT.TypeName,"material")&&(o.material=i.material.clone()),t.isDeepCloneComponentVariable(cT.TypeName,"mesh")&&(o.mesh=Oe.clone(i.mesh)),o}function dT(i,e,t=new Kt,n=null){return z.cloneDefault(i,e)}function _T(i,e,t=new Kt,n=null){let o=z.cloneDefault(i,e);return t.isDeepCloneComponentVariable($D.TypeName,"material")&&(o.material=i.material.clone()),o}function gT(i,e,t=new Kt,n=null){return z.cloneDefault(i,e)}var bo={cloneMesh:pT,cloneCollision:dT,cloneText:_T,clonePhysX:gT};var ui=new WeakMap,hi=new WeakMap,Kt=class{constructor(){this._myDeepCloneComponents=!1,this._myDeepCloneOverrideComponentsMap=new Map,this._myDeepCloneOverrideComponentsVariablesMap=new Map}setDeepCloneComponents(e){this._myDeepCloneComponents=e}setDeepCloneComponent(e,t){this._myDeepCloneOverrideComponentsMap.set(e,t)}setDeepCloneComponentVariable(e,t,n){let o=null;this._myDeepCloneOverrideComponentsVariablesMap.has(e)||this._myDeepCloneOverrideComponentsVariablesMap.set(e,new Map),o=this._myDeepCloneOverrideComponentsVariablesMap.get(e),o.set(t,n)}isDeepCloneComponent(e){let t=this._myDeepCloneOverrideComponentsMap.get(e);return t??this._myDeepCloneComponents}isDeepCloneComponentVariable(e,t){let n=this._myDeepCloneOverrideComponentsVariablesMap.get(e);if(n!=null){let o=n.get(t);if(o!=null)return o}return this.isDeepCloneComponent(e)}},as=class{constructor(){this._myParams=new Map}addParam(e,t){this._myParams.set(e,t)}removeParam(e){this._myParams.delete(e)}getParam(e){this._myParams.get(e)}hasParam(e){this._myParams.has(e)}};function fT(i){return z.isWLNativeComponent(i)||z.isWLJavascriptComponent(i)}function TT(i){let e=!1,t=z.getTypeFromTypeOrClass(i);return z.getWLNativeComponentTypes().includes(t)&&(e=!0),e}function PT(i){let e=!1,t=z.getTypeFromTypeOrClass(i);return z.getWLJavascriptComponentTypes().includes(t)&&(e=!0),e}function CT(){return ME}function bT(){return DE}function ST(i){if(i==null)return;let e=i;return i.TypeName!=null&&(e=i.TypeName),e}function vT(i,e=r.getMainEngine()){let t=null;if(z.isWLNativeComponent(i)){if(z.isWLNativeComponentRegistered(i,e))switch(i){case bl.TypeName:t=bl;break;case Pr.TypeName:t=Pr;break;case Sl.TypeName:t=Sl;break;case vl.TypeName:t=vl;break;case Cr.TypeName:t=Cr;break;case br.TypeName:t=br;break;case Sr.TypeName:t=Sr;break;case xl.TypeName:t=xl;break;default:t=null}}else t=z.getJavascriptComponentClass(i,e);return t}function xT(i,e=r.getMainEngine()){let t=z.getTypeFromTypeOrClass(i);return z.getClassFromType(t,e)!=null}function MT(i=r.getMainEngine()){return r.getWASM(i)._components}function DT(i,e=r.getMainEngine()){return z.getJavascriptComponentClassesByIndex(e)[z.getJavascriptComponentTypeIndex(i,e)]}function ET(i=r.getMainEngine()){return r.getWASM(i)._componentTypes}function AT(i,e=r.getMainEngine()){let t=z.getTypeFromTypeOrClass(i);return z.getJavascriptComponentTypeIndexes(e)[t]}function RT(i=r.getMainEngine()){return r.getWASM(i)._componentTypeIndices}function OT(i,e=r.getMainEngine()){let t=null,n=z.getJavascriptComponentClassesByIndex(e)[i];return n!=null&&(t=n.TypeName),t}function VT(i,e=r.getMainEngine()){let t=r.getWASM(e),n=z.getTypeFromTypeOrClass(i);return t._wl_get_component_manager_index(t.tempUTF8(n))>=0}function vE(i,e=!1,t=r.getMainEngine()){let n=z.getTypeFromTypeOrClass(i);return e||z.hasCloneCallback(n,t)||z.getClassFromType(n,t)?.prototype.pp_clone!=null}function IT(i,e=r.getMainEngine()){let t=z.getTypeFromTypeOrClass(i);return z.hasClonePostProcessCallback(t,e)||z.getClassFromType(t,e)?.prototype.pp_clonePostProcess!=null}function xE(i,e,t,n,o=!1,s=!0){let a=null,l=z.getCloneCallback(i.type,y.getEngine(i.object));return l!=null?a=l(i,e,t,n):i.pp_clone!=null?a=i.pp_clone(e,t,n):o&&(a=z.cloneDefault(i,e,s)),a}function BT(i,e,t,n){let o=z.getClonePostProcessCallback(i.type,y.getEngine(i.object));return o!=null?o(i,e,t,n):i.pp_clonePostProcess!=null&&i.pp_clonePostProcess(e,t,n),e}function LT(i,e,t=!0){let n=y.addComponent(e,i.type,i);return t&&!n.active&&(n.active=!0,n.active=!1),n}function HT(i,e,t=r.getMainEngine()){let n=z.getTypeFromTypeOrClass(i);ui.has(t)||ui.set(t,new Map),ui.get(t).set(n,e)}function kT(i,e=r.getMainEngine()){let t=z.getTypeFromTypeOrClass(i);ui.has(e)&&ui.get(e).delete(t)}function FT(i,e=r.getMainEngine()){let t=null,n=z.getTypeFromTypeOrClass(i);return ui.has(e)&&(t=ui.get(e).get(n)),t}function wT(i,e=r.getMainEngine()){let t=!1,n=z.getTypeFromTypeOrClass(i);return ui.has(e)&&(t=ui.get(e).has(n)),t}function jT(i,e,t=r.getMainEngine()){let n=z.getTypeFromTypeOrClass(i);hi.has(t)||hi.set(t,new Map),hi.get(t).set(n,e)}function zT(i,e=r.getMainEngine()){let t=z.getTypeFromTypeOrClass(i);hi.has(e)&&hi.get(e).delete(t)}function NT(i,e=r.getMainEngine()){let t=null,n=z.getTypeFromTypeOrClass(i);return hi.has(e)&&(t=hi.get(e).get(n)),t}function GT(i,e=r.getMainEngine()){let t=!1,n=z.getTypeFromTypeOrClass(i);return hi.has(e)&&(t=hi.get(e).has(n)),t}function WT(i){let e=null;switch(z.getTypeFromTypeOrClass(i)){case Cr.TypeName:e=bo.cloneMesh;break;case Pr.TypeName:e=bo.cloneCollision;break;case Sr.TypeName:e=bo.cloneText;break;case br.TypeName:e=bo.clonePhysX;break;default:e=null}return e}function UT(i){return z.getDefaultWLComponentCloneCallback(i)!=null}function QT(i=r.getMainEngine()){for(let e of z.getWLNativeComponentTypes()){let t=z.getDefaultWLComponentCloneCallback(e);t!=null&&z.setCloneCallback(e,t,i)}for(let e of z.getWLJavascriptComponentTypes()){let t=z.getDefaultWLComponentCloneCallback(e);t!=null&&z.setCloneCallback(e,t,i)}}function qT(i=r.getMainEngine()){for(let e of z.getWLNativeComponentTypes()){let t=z.getDefaultWLComponentCloneCallback(e);t!=null&&z.getCloneCallback(e,i)==t&&z.removeCloneCallback(e,i)}for(let e of z.getWLNativeComponentTypes()){let t=z.getDefaultWLComponentCloneCallback(e);t!=null&&z.getCloneCallback(e,i)==t&&z.removeCloneCallback(e,i)}}var z={isWLComponent:fT,isWLNativeComponent:TT,isWLJavascriptComponent:PT,getWLNativeComponentTypes:CT,getWLJavascriptComponentTypes:bT,getTypeFromTypeOrClass:ST,getClassFromType:vT,isRegistered:xT,getJavascriptComponentInstances:MT,getJavascriptComponentClass:DT,getJavascriptComponentClassesByIndex:ET,getJavascriptComponentTypeIndex:AT,getJavascriptComponentTypeIndexes:RT,getJavascriptComponentTypeFromIndex:OT,isWLNativeComponentRegistered:VT,isCloneable:vE,hasClonePostProcess:IT,clone:xE,clonePostProcess:BT,cloneDefault:LT,setCloneCallback:HT,removeCloneCallback:kT,getCloneCallback:FT,hasCloneCallback:wT,setClonePostProcessCallback:jT,removeClonePostProcessCallback:zT,getClonePostProcessCallback:NT,hasClonePostProcessCallback:GT,setDefaultWLComponentCloneCallbacks:QT,removeDefaultWLComponentCloneCallbacks:qT,getDefaultWLComponentCloneCallback:WT,hasDefaultWLComponentCloneCallback:UT},ME=[bl.TypeName,Pr.TypeName,Sl.TypeName,vl.TypeName,Cr.TypeName,br.TypeName,Sr.TypeName,xl.TypeName],DE=[eE.TypeName,tE.TypeName,iE.TypeName,nE.TypeName,oE.TypeName,sE.TypeName,aE.TypeName,rE.TypeName,lE.TypeName,mE.TypeName,yE.TypeName,uE.TypeName,hE.TypeName,cE.TypeName,pE.TypeName,dE.TypeName,_E.TypeName,gE.TypeName,fE.TypeName,TE.TypeName,PE.TypeName,CE.TypeName,bE.TypeName,SE.TypeName];function Ml(){XT()}function XT(){let i={};Object.defineProperty(i,"PP_EPSILON",{get(){return L.EPSILON},set(e){L.EPSILON=e}}),Object.defineProperty(i,"PP_EPSILON_SQUARED",{get(){return L.EPSILON_SQUARED},set(e){L.EPSILON=e}}),Object.defineProperty(i,"PP_EPSILON_DEGREES",{get(){return L.EPSILON_DEGREES},set(e){L.EPSILON=e}}),i.pp_clamp=function(t,n,o){return L.clamp(...arguments)},i.pp_sign=function(t,n=1){return L.sign(...arguments)},i.pp_toDegrees=function(t){return L.toDegrees(...arguments)},i.pp_toRadians=function(t){return L.toRadians(...arguments)},i.pp_roundDecimal=function(t,n){return L.roundDecimal(...arguments)},i.pp_mapToRange=function(t,n,o,s,a){return L.mapToRange(...arguments)},i.pp_random=function(t=0,n=1){return L.random(...arguments)},i.pp_randomInt=function(t,n){return L.randomInt(...arguments)},i.pp_randomBool=function(){return L.randomBool(...arguments)},i.pp_randomSign=function(){return L.randomSign(...arguments)},i.pp_randomPick=function(...t){return L.randomPick(...arguments)},i.pp_randomUUID=function(){return L.randomUUID(...arguments)},i.pp_lerp=function(t,n,o){return L.lerp(...arguments)},i.pp_interpolate=function(t,n,o,s=he.linear){return L.interpolate(...arguments)},i.pp_angleDistance=function(t,n){return L.angleDistance(...arguments)},i.pp_angleDistanceDegrees=function(t,n){return L.angleDistanceDegrees(...arguments)},i.pp_angleDistanceRadians=function(t,n){return L.angleDistanceRadians(...arguments)},i.pp_angleDistanceSigned=function(t,n){return L.angleDistanceSigned(...arguments)},i.pp_angleDistanceSignedDegrees=function(t,n){return L.angleDistanceSignedDegrees(...arguments)},i.pp_angleDistanceSignedRadians=function(t,n){return L.angleDistanceSignedRadians(...arguments)},i.pp_angleClamp=function(t,n=!1){return L.angleClamp(...arguments)},i.pp_angleClampDegrees=function(t,n=!1){return L.angleClampDegrees(...arguments)},i.pp_angleClampRadians=function(t,n=!1){return L.angleClampRadians(...arguments)},i.pp_isInsideAngleRange=function(t,n,o,s=!1){return L.isInsideAngleRange(...arguments)},i.pp_isInsideAngleRangeDegrees=function(t,n,o,s=!1){return L.isInsideAngleRangeDegrees(...arguments)},i.pp_isInsideAngleRangeRadians=function(t,n,o,s=!1){return L.isInsideAngleRangeRadians(...arguments)},xe.injectProperties(i,Math,!1,!0,!0)}function Dl(i){KT()}function KT(){let i={};i.get=function(){return this.valueOf()},xe.injectProperties(i,Number.prototype,!1,!0,!0)}function El(){Ml(),Cl(),Dl()}function Al(i){El(i)}import{Object3D as EE}from"@wonderlandengine/api";function Rl(){JT()}function JT(){let i={};i.pp_getPosition=function(t){return y.getPosition(this,...arguments)},i.pp_getPositionWorld=function(t=p.create()){return y.getPositionWorld(this,...arguments)},i.pp_getPositionLocal=function(t=p.create()){return y.getPositionLocal(this,...arguments)},i.pp_getRotation=function(t){return y.getRotation(this,...arguments)},i.pp_getRotationDegrees=function(t){return y.getRotationDegrees(this,...arguments)},i.pp_getRotationRadians=function(t){return y.getRotationRadians(this,...arguments)},i.pp_getRotationMatrix=function(t){return y.getRotationMatrix(this,...arguments)},i.pp_getRotationQuat=function(t){return y.getRotationQuat(this,...arguments)},i.pp_getRotationWorld=function(t){return y.getRotationWorld(this,...arguments)},i.pp_getRotationWorldDegrees=function(t){return y.getRotationWorldDegrees(this,...arguments)},i.pp_getRotationWorldRadians=function(t=p.create()){return y.getRotationWorldRadians(this,...arguments)},i.pp_getRotationWorldMatrix=function(t=Y.create()){return y.getRotationWorldMatrix(this,...arguments)},i.pp_getRotationWorldQuat=function(t=T.create()){return y.getRotationWorldQuat(this,...arguments)},i.pp_getRotationLocal=function(t){return y.getRotationLocal(this,...arguments)},i.pp_getRotationLocalDegrees=function(t){return y.getRotationLocalDegrees(this,...arguments)},i.pp_getRotationLocalRadians=function(t=p.create()){return y.getRotationLocalRadians(this,...arguments)},i.pp_getRotationLocalMatrix=function(t=Y.create()){return y.getRotationLocalMatrix(this,...arguments)},i.pp_getRotationLocalQuat=function(t=T.create()){return y.getRotationLocalQuat(this,...arguments)},i.pp_getScale=function(t){return y.getScale(this,...arguments)},i.pp_getScaleWorld=function(t=p.create()){return y.getScaleWorld(this,...arguments)},i.pp_getScaleLocal=function(t=p.create()){return y.getScaleLocal(this,...arguments)},i.pp_getTransform=function(t){return y.getTransform(this,...arguments)},i.pp_getTransformMatrix=function(t){return y.getTransformMatrix(this,...arguments)},i.pp_getTransformQuat=function(t){return y.getTransformQuat(this,...arguments)},i.pp_getTransformWorld=function(t){return y.getTransformWorld(this,...arguments)},i.pp_getTransformWorldMatrix=function(t=O.create()){return y.getTransformWorldMatrix(this,...arguments)},i.pp_getTransformWorldQuat=function(t=V.create()){return y.getTransformWorldQuat(this,...arguments)},i.pp_getTransformLocal=function(t){return y.getTransformLocal(this,...arguments)},i.pp_getTransformLocalMatrix=function(t=O.create()){return y.getTransformLocalMatrix(this,...arguments)},i.pp_getTransformLocalQuat=function(t=V.create()){return y.getTransformLocalQuat(this,...arguments)},i.pp_getAxes=function(t){return y.getAxes(this,...arguments)},i.pp_getAxesWorld=function(t=[p.create(),p.create(),p.create()]){return y.getAxesWorld(this,...arguments)},i.pp_getAxesLocal=function(t=[p.create(),p.create(),p.create()]){return y.getAxesLocal(this,...arguments)},i.pp_getForward=function(t){return y.getForward(this,...arguments)},i.pp_getForwardWorld=function(t=p.create()){return y.getForwardWorld(this,...arguments)},i.pp_getForwardLocal=function(t=p.create()){return y.getForwardLocal(this,...arguments)},i.pp_getBackward=function(t){return y.getBackward(this,...arguments)},i.pp_getBackwardWorld=function(t=p.create()){return y.getBackwardWorld(this,...arguments)},i.pp_getBackwardLocal=function(t=p.create()){return y.getBackwardLocal(this,...arguments)},i.pp_getUp=function(t){return y.getUp(this,...arguments)},i.pp_getUpWorld=function(t=p.create()){return y.getUpWorld(this,...arguments)},i.pp_getUpLocal=function(t=p.create()){return y.getUpLocal(this,...arguments)},i.pp_getDown=function(t){return y.getDown(this,...arguments)},i.pp_getDownWorld=function(t=p.create()){return y.getDownWorld(this,...arguments)},i.pp_getDownLocal=function(t=p.create()){return y.getDownLocal(this,...arguments)},i.pp_getLeft=function(t){return y.getLeft(this,...arguments)},i.pp_getLeftWorld=function(t=p.create()){return y.getLeftWorld(this,...arguments)},i.pp_getLeftLocal=function(t=p.create()){return y.getLeftLocal(this,...arguments)},i.pp_getRight=function(t){return y.getRight(this,...arguments)},i.pp_getRightWorld=function(t=p.create()){return y.getRightWorld(this,...arguments)},i.pp_getRightLocal=function(t=p.create()){return y.getRightLocal(this,...arguments)},i.pp_setPosition=function(t){return y.setPosition(this,...arguments)},i.pp_setPositionWorld=function(t){return y.setPositionWorld(this,...arguments)},i.pp_setPositionLocal=function(t){return y.setPositionLocal(this,...arguments)},i.pp_setRotation=function(t){return y.setRotation(this,...arguments)},i.pp_setRotationDegrees=function(t){return y.setRotationDegrees(this,...arguments)},i.pp_setRotationRadians=function(t){return y.setRotationRadians(this,...arguments)},i.pp_setRotationMatrix=function(t){return y.setRotationMatrix(this,...arguments)},i.pp_setRotationQuat=function(t){return y.setRotationQuat(this,...arguments)},i.pp_setRotationWorld=function(t){return y.setRotationWorld(this,...arguments)},i.pp_setRotationWorldDegrees=function(t){return y.setRotationWorldDegrees(this,...arguments)},i.pp_setRotationWorldRadians=function(t){return y.setRotationWorldRadians(this,...arguments)},i.pp_setRotationWorldMatrix=function(t){return y.setRotationWorldMatrix(this,...arguments)},i.pp_setRotationWorldQuat=function(t){return y.setRotationWorldQuat(this,...arguments)},i.pp_setRotationLocal=function(t){return y.setRotationLocal(this,...arguments)},i.pp_setRotationLocalDegrees=function(t){return y.setRotationLocalDegrees(this,...arguments)},i.pp_setRotationLocalRadians=function(t){return y.setRotationLocalRadians(this,...arguments)},i.pp_setRotationLocalMatrix=function(t){return y.setRotationLocalMatrix(this,...arguments)},i.pp_setRotationLocalQuat=function(t){return y.setRotationLocalQuat(this,...arguments)},i.pp_setScale=function(t){return y.setScale(this,...arguments)},i.pp_setScaleWorld=function(t){return y.setScaleWorld(this,...arguments)},i.pp_setScaleLocal=function(t){return y.setScaleLocal(this,...arguments)},i.pp_setAxes=function(t,n,o){return y.setAxes(this,...arguments)},i.pp_setAxesWorld=function(t,n,o){return y.setAxesWorld(this,...arguments)},i.pp_setAxesLocal=function(t,n,o){return y.setAxesLocal(this,...arguments)},i.pp_setForward=function(t,n,o){return y.setForward(this,...arguments)},i.pp_setForwardWorld=function(t,n=null,o=null){return y.setForwardWorld(this,...arguments)},i.pp_setForwardLocal=function(t,n=null,o=null){return y.setForwardLocal(this,...arguments)},i.pp_setBackward=function(t,n,o){return y.setBackward(this,...arguments)},i.pp_setBackwardWorld=function(t,n=null,o=null){return y.setBackwardWorld(this,...arguments)},i.pp_setBackwardLocal=function(t,n=null,o=null){return y.setBackwardLocal(this,...arguments)},i.pp_setUp=function(t,n,o){return y.setUp(this,...arguments)},i.pp_setUpWorld=function(t,n=null,o=null){return y.setUpWorld(this,...arguments)},i.pp_setUpLocal=function(t,n=null,o=null){return y.setUpLocal(this,...arguments)},i.pp_setDown=function(t,n,o){return y.setDown(this,...arguments)},i.pp_setDownWorld=function(t,n=null,o=null){return y.setDownWorld(this,...arguments)},i.pp_setDownLocal=function(t,n=null,o=null){return y.setDownLocal(this,...arguments)},i.pp_setLeft=function(t,n,o){return y.setLeft(this,...arguments)},i.pp_setLeftWorld=function(t,n=null,o=null){return y.setLeftWorld(this,...arguments)},i.pp_setLeftLocal=function(t,n=null,o=null){return y.setLeftLocal(this,...arguments)},i.pp_setRight=function(t,n,o){return y.setRight(this,...arguments)},i.pp_setRightWorld=function(t,n=null,o=null){return y.setRightWorld(this,...arguments)},i.pp_setRightLocal=function(t,n=null,o=null){return y.setRightLocal(this,...arguments)},i.pp_setTransform=function(t){return y.setTransform(this,...arguments)},i.pp_setTransformMatrix=function(t){return y.setTransformMatrix(this,...arguments)},i.pp_setTransformQuat=function(t){return y.setTransformQuat(this,...arguments)},i.pp_setTransformWorld=function(t){return y.setTransformWorld(this,...arguments)},i.pp_setTransformWorldMatrix=function(t){return y.setTransformWorldMatrix(this,...arguments)},i.pp_setTransformWorldQuat=function(t){return y.setTransformWorldQuat(this,...arguments)},i.pp_setTransformLocal=function(t){return y.setTransformLocal(this,...arguments)},i.pp_setTransformLocalMatrix=function(t){return y.setTransformLocalMatrix(this,...arguments)},i.pp_setTransformLocalQuat=function(t){return y.setTransformLocalQuat(this,...arguments)},i.pp_resetPosition=function(){return y.resetPosition(this,...arguments)},i.pp_resetPositionWorld=function(){return y.resetPositionWorld(this,...arguments)},i.pp_resetPositionLocal=function(){return y.resetPositionLocal(this,...arguments)},i.pp_resetRotation=function(){return y.resetRotation(this,...arguments)},i.pp_resetRotationWorld=function(){return y.resetRotationWorld(this,...arguments)},i.pp_resetRotationLocal=function(){return y.resetRotationLocal(this,...arguments)},i.pp_resetScale=function(){return y.resetScale(this,...arguments)},i.pp_resetScaleWorld=function(){return y.resetScaleWorld(this,...arguments)},i.pp_resetScaleLocal=function(){return y.resetScaleLocal(this,...arguments)},i.pp_resetTransform=function(){return y.resetTransform(this,...arguments)},i.pp_resetTransformWorld=function(){return y.resetTransformWorld(this,...arguments)},i.pp_resetTransformLocal=function(){return y.resetTransformLocal(this,...arguments)},i.pp_translate=function(t){return y.translate(this,...arguments)},i.pp_translateWorld=function(t){return y.translateWorld(this,...arguments)},i.pp_translateLocal=function(t){return y.translateLocal(this,...arguments)},i.pp_translateObject=function(t){return y.translateObject(this,...arguments)},i.pp_translateAxis=function(t,n){return y.translateAxis(this,...arguments)},i.pp_translateAxisWorld=function(t,n){return y.translateAxisWorld(this,...arguments)},i.pp_translateAxisLocal=function(t,n){return y.translateAxisLocal(this,...arguments)},i.pp_translateAxisObject=function(t,n){return y.translateAxisObject(this,...arguments)},i.pp_rotate=function(t){return y.rotate(this,...arguments)},i.pp_rotateDegrees=function(t){return y.rotateDegrees(this,...arguments)},i.pp_rotateRadians=function(t){return y.rotateRadians(this,...arguments)},i.pp_rotateMatrix=function(t){return y.rotateMatrix(this,...arguments)},i.pp_rotateQuat=function(t){return y.rotateQuat(this,...arguments)},i.pp_rotateWorld=function(t){return y.rotateWorld(this,...arguments)},i.pp_rotateWorldDegrees=function(t){return y.rotateWorldDegrees(this,...arguments)},i.pp_rotateWorldRadians=function(t){return y.rotateWorldRadians(this,...arguments)},i.pp_rotateWorldMatrix=function(t){return y.rotateWorldMatrix(this,...arguments)},i.pp_rotateWorldQuat=function(t){return y.rotateWorldQuat(this,...arguments)},i.pp_rotateLocal=function(t){return y.rotateLocal(this,...arguments)},i.pp_rotateLocalDegrees=function(t){return y.rotateLocalDegrees(this,...arguments)},i.pp_rotateLocalRadians=function(t){return y.rotateLocalRadians(this,...arguments)},i.pp_rotateLocalMatrix=function(t){return y.rotateLocalMatrix(this,...arguments)},i.pp_rotateLocalQuat=function(t){return y.rotateLocalQuat(this,...arguments)},i.pp_rotateObject=function(t){return y.rotateObject(this,...arguments)},i.pp_rotateObjectDegrees=function(t){return y.rotateObjectDegrees(this,...arguments)},i.pp_rotateObjectRadians=function(t){return y.rotateObjectRadians(this,...arguments)},i.pp_rotateObjectMatrix=function(t){return y.rotateObjectMatrix(this,...arguments)},i.pp_rotateObjectQuat=function(t){return y.rotateObjectQuat(this,...arguments)},i.pp_rotateAxis=function(t,n){return y.rotateAxis(this,...arguments)},i.pp_rotateAxisDegrees=function(t,n){return y.rotateAxisDegrees(this,...arguments)},i.pp_rotateAxisRadians=function(t,n){return y.rotateAxisRadians(this,...arguments)},i.pp_rotateAxisWorld=function(t,n){return y.rotateAxisWorld(this,...arguments)},i.pp_rotateAxisWorldDegrees=function(t,n){return y.rotateAxisWorldDegrees(this,...arguments)},i.pp_rotateAxisWorldRadians=function(t,n){return y.rotateAxisWorldRadians(this,...arguments)},i.pp_rotateAxisLocal=function(t,n){return y.rotateAxisLocal(this,...arguments)},i.pp_rotateAxisLocalDegrees=function(t,n){return y.rotateAxisLocalDegrees(this,...arguments)},i.pp_rotateAxisLocalRadians=function(t,n){return y.rotateAxisLocalRadians(this,...arguments)},i.pp_rotateAxisObject=function(t,n){return y.rotateAxisObject(this,...arguments)},i.pp_rotateAxisObjectDegrees=function(t,n){return y.rotateAxisObjectDegrees(this,...arguments)},i.pp_rotateAxisObjectRadians=function(t,n){return y.rotateAxisObjectRadians(this,...arguments)},i.pp_rotateAround=function(t,n){return y.rotateAround(this,...arguments)},i.pp_rotateAroundDegrees=function(t,n){return y.rotateAroundDegrees(this,...arguments)},i.pp_rotateAroundRadians=function(t,n){return y.rotateAroundRadians(this,...arguments)},i.pp_rotateAroundMatrix=function(t,n){return y.rotateAroundMatrix(this,...arguments)},i.pp_rotateAroundQuat=function(t,n){return y.rotateAroundQuat(this,...arguments)},i.pp_rotateAroundWorld=function(t,n){return y.rotateAroundWorld(this,...arguments)},i.pp_rotateAroundWorldDegrees=function(t,n){return y.rotateAroundWorldDegrees(this,...arguments)},i.pp_rotateAroundWorldRadians=function(t,n){return y.rotateAroundWorldRadians(this,...arguments)},i.pp_rotateAroundWorldMatrix=function(t,n){return y.rotateAroundWorldMatrix(this,...arguments)},i.pp_rotateAroundWorldQuat=function(t,n){return y.rotateAroundWorldQuat(this,...arguments)},i.pp_rotateAroundLocal=function(t,n){return y.rotateAroundLocal(this,...arguments)},i.pp_rotateAroundLocalDegrees=function(t,n){return y.rotateAroundLocalDegrees(this,...arguments)},i.pp_rotateAroundLocalRadians=function(t,n){return y.rotateAroundLocalRadians(this,...arguments)},i.pp_rotateAroundLocalMatrix=function(t,n){return y.rotateAroundLocalMatrix(this,...arguments)},i.pp_rotateAroundLocalQuat=function(t,n){return y.rotateAroundLocalQuat(this,...arguments)},i.pp_rotateAroundObject=function(t,n){return y.rotateAroundObject(this,...arguments)},i.pp_rotateAroundObjectDegrees=function(t,n){return y.rotateAroundObjectDegrees(this,...arguments)},i.pp_rotateAroundObjectRadians=function(t,n){return y.rotateAroundObjectRadians(this,...arguments)},i.pp_rotateAroundObjectMatrix=function(t,n){return y.rotateAroundObjectMatrix(this,...arguments)},i.pp_rotateAroundObjectQuat=function(t,n){return y.rotateAroundObjectQuat(this,...arguments)},i.pp_rotateAroundAxis=function(t,n,o){return y.rotateAroundAxis(this,...arguments)},i.pp_rotateAroundAxisDegrees=function(t,n,o){return y.rotateAroundAxisDegrees(this,...arguments)},i.pp_rotateAroundAxisRadians=function(t,n,o){return y.rotateAroundAxisRadians(this,...arguments)},i.pp_rotateAroundAxisWorld=function(t,n,o){return y.rotateAroundAxisWorld(this,...arguments)},i.pp_rotateAroundAxisWorldDegrees=function(t,n,o){return y.rotateAroundAxisWorldDegrees(this,...arguments)},i.pp_rotateAroundAxisWorldRadians=function(t,n,o){return y.rotateAroundAxisWorldRadians(this,...arguments)},i.pp_rotateAroundAxisLocal=function(t,n,o){return y.rotateAroundAxisLocal(this,...arguments)},i.pp_rotateAroundAxisLocalDegrees=function(t,n,o){return y.rotateAroundAxisLocalDegrees(this,...arguments)},i.pp_rotateAroundAxisLocalRadians=function(t,n,o){return y.rotateAroundAxisLocalRadians(this,...arguments)},i.pp_rotateAroundAxisObject=function(t,n,o){return y.rotateAroundAxisObject(this,...arguments)},i.pp_rotateAroundAxisObjectDegrees=function(t,n,o){return y.rotateAroundAxisObjectDegrees(this,...arguments)},i.pp_rotateAroundAxisObjectRadians=function(t,n,o){return y.rotateAroundAxisObjectRadians(this,...arguments)},i.pp_scaleObject=function(t){return y.scaleObject(this,...arguments)},i.pp_lookAt=function(t,n){return y.lookAt(this,...arguments)},i.pp_lookAtWorld=function(t,n){return y.lookAtWorld(this,...arguments)},i.pp_lookAtLocal=function(t,n){return y.lookAtLocal(this,...arguments)},i.pp_lookTo=function(t,n){return y.lookTo(this,...arguments)},i.pp_lookToWorld=function(t,n){return y.lookToWorld(this,...arguments)},i.pp_lookToLocal=function(t,n){return y.lookToLocal(this,...arguments)},i.pp_setParent=function(t,n=!0){return y.setParent(this,...arguments)},i.pp_getParent=function(){return y.getParent(this,...arguments)},i.pp_convertPositionObjectToWorld=function(t,n=p.create()){return y.convertPositionObjectToWorld(this,...arguments)},i.pp_convertDirectionObjectToWorld=function(t,n=p.create()){return y.convertDirectionObjectToWorld(this,...arguments)},i.pp_convertPositionWorldToObject=function(t,n=p.create()){return y.convertPositionWorldToObject(this,...arguments)},i.pp_convertDirectionWorldToObject=function(t,n=p.create()){return y.convertDirectionWorldToObject(this,...arguments)},i.pp_convertPositionLocalToWorld=function(t,n=p.create()){return y.convertPositionLocalToWorld(this,...arguments)},i.pp_convertDirectionLocalToWorld=function(t,n=p.create()){return y.convertDirectionLocalToWorld(this,...arguments)},i.pp_convertPositionWorldToLocal=function(t,n=p.create()){return y.convertPositionWorldToLocal(this,...arguments)},i.pp_convertDirectionWorldToLocal=function(t,n=p.create()){return y.convertDirectionWorldToLocal(this,...arguments)},i.pp_convertPositionObjectToLocal=function(t,n=p.create()){return y.convertPositionObjectToLocal(this,...arguments)},i.pp_convertDirectionObjectToLocal=function(t,n=p.create()){return y.convertDirectionObjectToLocal(this,...arguments)},i.pp_convertPositionLocalToObject=function(t,n=p.create()){return y.convertPositionLocalToObject(this,...arguments)},i.pp_convertDirectionLocalToObject=function(t,n=p.create()){return y.convertDirectionLocalToObject(this,...arguments)},i.pp_convertTransformObjectToWorld=function(t,n){return y.convertTransformObjectToWorld(this,...arguments)},i.pp_convertTransformObjectToWorldMatrix=function(t,n=O.create()){return y.convertTransformObjectToWorldMatrix(this,...arguments)},i.pp_convertTransformObjectToWorldQuat=function(t,n=V.create()){return y.convertTransformObjectToWorldQuat(this,...arguments)},i.pp_convertTransformWorldToObject=function(t,n){return y.convertTransformWorldToObject(this,...arguments)},i.pp_convertTransformWorldToObjectMatrix=function(t,n=O.create()){return y.convertTransformWorldToObjectMatrix(this,...arguments)},i.pp_convertTransformWorldToObjectQuat=function(t,n=V.create()){return y.convertTransformWorldToObjectQuat(this,...arguments)},i.pp_convertTransformLocalToWorld=function(t,n){return y.convertTransformLocalToWorld(this,...arguments)},i.pp_convertTransformLocalToWorldMatrix=function(t,n=O.create()){return y.convertTransformLocalToWorldMatrix(this,...arguments)},i.pp_convertTransformLocalToWorldQuat=function(t,n=V.create()){return y.convertTransformLocalToWorldQuat(this,...arguments)},i.pp_convertTransformWorldToLocal=function(t,n){return y.convertTransformWorldToLocal(this,...arguments)},i.pp_convertTransformWorldToLocalMatrix=function(t,n=O.create()){return y.convertTransformWorldToLocalMatrix(this,...arguments)},i.pp_convertTransformWorldToLocalQuat=function(t,n=V.create()){return y.convertTransformWorldToLocalQuat(this,...arguments)},i.pp_convertTransformObjectToLocal=function(t,n){return y.convertTransformObjectToLocal(this,...arguments)},i.pp_convertTransformObjectToLocalMatrix=function(t,n=O.create()){return y.convertTransformObjectToLocalMatrix(this,...arguments)},i.pp_convertTransformObjectToLocalQuat=function(t,n=V.create()){return y.convertTransformObjectToLocalQuat(this,...arguments)},i.pp_convertTransformLocalToObject=function(t,n){return y.convertTransformLocalToObject(this,...arguments)},i.pp_convertTransformLocalToObjectMatrix=function(t,n=O.create()){return y.convertTransformLocalToObjectMatrix(this,...arguments)},i.pp_convertTransformLocalToObjectQuat=function(t,n=V.create()){return y.convertTransformLocalToObjectQuat(this,...arguments)},i.pp_addComponent=function(t,n,o=null){return y.addComponent(this,...arguments)},i.pp_getComponent=function(t,n=0){return y.getComponent(this,...arguments)},i.pp_getComponentSelf=function(t,n=0){return y.getComponentSelf(this,...arguments)},i.pp_getComponentHierarchy=function(t,n=0){return y.getComponentHierarchy(this,...arguments)},i.pp_getComponentHierarchyBreadth=function(t,n=0){return y.getComponentHierarchyBreadth(this,...arguments)},i.pp_getComponentHierarchyDepth=function(t,n=0){return y.getComponentHierarchyDepth(this,...arguments)},i.pp_getComponentDescendants=function(t,n=0){return y.getComponentDescendants(this,...arguments)},i.pp_getComponentDescendantsBreadth=function(t,n=0){return y.getComponentDescendantsBreadth(this,...arguments)},i.pp_getComponentDescendantsDepth=function(t,n=0){return y.getComponentDescendantsDepth(this,...arguments)},i.pp_getComponentChildren=function(t,n=0){return y.getComponentChildren(this,...arguments)},i.pp_getComponents=function(t){return y.getComponents(this,...arguments)},i.pp_getComponentsSelf=function(t){return y.getComponentsSelf(this,...arguments)},i.pp_getComponentsHierarchy=function(t){return y.getComponentsHierarchy(this,...arguments)},i.pp_getComponentsHierarchyBreadth=function(t){return y.getComponentsHierarchyBreadth(this,...arguments)},i.pp_getComponentsHierarchyDepth=function(t){return y.getComponentsHierarchyDepth(this,...arguments)},i.pp_getComponentsDescendants=function(t){return y.getComponentsDescendants(this,...arguments)},i.pp_getComponentsDescendantsBreadth=function(t){return y.getComponentsDescendantsBreadth(this,...arguments)},i.pp_getComponentsDescendantsDepth=function(t){return y.getComponentsDescendantsDepth(this,...arguments)},i.pp_getComponentsChildren=function(t){return y.getComponentsChildren(this,...arguments)},i.pp_setActive=function(t){return y.setActive(this,...arguments)},i.pp_setActiveSelf=function(t){return y.setActiveSelf(this,...arguments)},i.pp_setActiveHierarchy=function(t){return y.setActiveHierarchy(this,...arguments)},i.pp_setActiveHierarchyBreadth=function(t){return y.setActiveHierarchyBreadth(this,...arguments)},i.pp_setActiveHierarchyDepth=function(t){return y.setActiveHierarchyDepth(this,...arguments)},i.pp_setActiveDescendants=function(t){return y.setActiveDescendants(this,...arguments)},i.pp_setActiveDescendantsBreadth=function(t){return y.setActiveDescendantsBreadth(this,...arguments)},i.pp_setActiveDescendantsDepth=function(t){return y.setActiveDescendantsDepth(this,...arguments)},i.pp_setActiveChildren=function(t){return y.setActiveChildren(this,...arguments)},i.pp_hasUniformScale=function(){return y.hasUniformScale(this,...arguments)},i.pp_hasUniformScaleWorld=function(){return y.hasUniformScaleWorld(this,...arguments)},i.pp_hasUniformScaleLocal=function(){return y.hasUniformScaleLocal(this,...arguments)},i.pp_clone=function(t=new Xt){return y.clone(this,...arguments)},i.pp_isCloneable=function(t=new Xt){return y.isCloneable(this,...arguments)},i.pp_toString=function(){return y.toString(this,...arguments)},i.pp_toStringExtended=function(){return y.toStringExtended(this,...arguments)},i.pp_toStringCompact=function(){return y.toStringCompact(this,...arguments)},i.pp_getObjectByName=function(t,n=!1,o=0){return y.getObjectByName(this,...arguments)},i.pp_getObjectByNameHierarchy=function(t,n=!1,o=0){return y.getObjectByNameHierarchy(this,...arguments)},i.pp_getObjectByNameHierarchyBreadth=function(t,n=!1,o=0){return y.getObjectByNameHierarchyBreadth(this,...arguments)},i.pp_getObjectByNameHierarchyDepth=function(t,n=!1,o=0){return y.getObjectByNameHierarchyDepth(this,...arguments)},i.pp_getObjectByNameDescendants=function(t,n=!1,o=0){return y.getObjectByNameDescendants(this,...arguments)},i.pp_getObjectByNameDescendantsBreadth=function(t,n=!1,o=0){return y.getObjectByNameDescendantsBreadth(this,...arguments)},i.pp_getObjectByNameDescendantsDepth=function(t,n=!1,o=0){return y.getObjectByNameDescendantsDepth(this,...arguments)},i.pp_getObjectByNameChildren=function(t,n=!1,o=0){return y.getObjectByNameChildren(this,...arguments)},i.pp_getObjectsByName=function(t,n=!1){return y.getObjectsByName(this,...arguments)},i.pp_getObjectsByNameHierarchy=function(t,n=!1){return y.getObjectsByNameHierarchy(this,...arguments)},i.pp_getObjectsByNameHierarchyBreadth=function(t,n=!1){return y.getObjectsByNameHierarchyBreadth(this,...arguments)},i.pp_getObjectsByNameHierarchyDepth=function(t,n=!1){return y.getObjectsByNameHierarchyDepth(this,...arguments)},i.pp_getObjectsByNameDescendants=function(t,n=!1){return y.getObjectsByNameDescendants(this,...arguments)},i.pp_getObjectsByNameDescendantsBreadth=function(t,n=!1){return y.getObjectsByNameDescendantsBreadth(this,...arguments)},i.pp_getObjectsByNameDescendantsDepth=function(t,n=!1){return y.getObjectsByNameDescendantsDepth(this,...arguments)},i.pp_getObjectsByNameChildren=function(t,n=!1){return y.getObjectsByNameChildren(this,...arguments)},i.pp_getObjectByID=function(t){return y.getObjectByID(this,...arguments)},i.pp_getObjectByIDHierarchy=function(t){return y.getObjectByIDHierarchy(this,...arguments)},i.pp_getObjectByIDHierarchyBreadth=function(t){return y.getObjectByIDHierarchyBreadth(this,...arguments)},i.pp_getObjectByIDHierarchyDepth=function(t){return y.getObjectByIDHierarchyDepth(this,...arguments)},i.pp_getObjectByIDDescendants=function(t){return y.getObjectByIDDescendants(this,...arguments)},i.pp_getObjectByIDDescendantsBreadth=function(t){return y.getObjectByIDDescendantsBreadth(this,...arguments)},i.pp_getObjectByIDDescendantsDepth=function(t){return y.getObjectByIDDescendantsDepth(this,...arguments)},i.pp_getObjectByIDChildren=function(t){return y.getObjectByIDChildren(this,...arguments)},i.pp_getHierarchyBreadth=function(){return y.getHierarchyBreadth(this,...arguments)},i.pp_getHierarchyDepth=function(){return y.getHierarchyDepth(this,...arguments)},i.pp_getDescendants=function(){return y.getDescendants(this,...arguments)},i.pp_getDescendantsBreadth=function(){return y.getDescendantsBreadth(this,...arguments)},i.pp_getDescendantsDepth=function(){return y.getDescendantsDepth(this,...arguments)},i.pp_getChildren=function(){return y.getChildren(this,...arguments)},i.pp_getSelf=function(){return y.getSelf(this,...arguments)},i.pp_addObject=function(){return y.addObject(this,...arguments)},i.pp_getName=function(){return y.getName(this,...arguments)},i.pp_setName=function(t){return y.setName(this,...arguments)},i.pp_getEngine=function(){return y.getEngine(this,...arguments)},i.pp_getID=function(){return y.getID(this,...arguments)},i.pp_markDirty=function(){return y.markDirty(this,...arguments)},i.pp_isTransformChanged=function(){return y.isTransformChanged(this,...arguments)},i.pp_equals=function(t){return y.equals(this,...arguments)},i.pp_destroy=function(){return y.destroy(this,...arguments)},i.pp_reserveObjects=function(t){return y.reserveObjects(this,...arguments)},i.pp_reserveObjectsSelf=function(t){return y.reserveObjectsSelf(this,...arguments)},i.pp_reserveObjectsHierarchy=function(t){return y.reserveObjectsHierarchy(this,...arguments)},i.pp_reserveObjectsDescendants=function(t){return y.reserveObjectsDescendants(this,...arguments)},i.pp_reserveObjectsChildren=function(t){return y.reserveObjectsChildren(this,...arguments)},i.pp_getComponentsAmountMap=function(t=new Map){return y.getComponentsAmountMap(this,...arguments)},i.pp_getComponentsAmountMapSelf=function(t=new Map){return y.getComponentsAmountMapSelf(this,...arguments)},i.pp_getComponentsAmountMapHierarchy=function(t=new Map){return y.getComponentsAmountMapHierarchy(this,...arguments)},i.pp_getComponentsAmountMapDescendants=function(t=new Map){return y.getComponentsAmountMapDescendants(this,...arguments)},i.pp_getComponentsAmountMapChildren=function(t=new Map){return y.getComponentsAmountMapChildren(this,...arguments)},xe.injectProperties(i,EE.prototype,!1,!0,!0)}import{Scene as AE}from"@wonderlandengine/api";function Ol(i){ZT()}function ZT(){let i={};i.pp_getRoot=function(){return Z.getRoot(this,...arguments)},i.pp_addObject=function(){return Z.addObject(this,...arguments)},i.pp_getObjects=function(){return Z.getObjects(this,...arguments)},i.pp_getObjectsBreadth=function(){return Z.getObjectsBreadth(this,...arguments)},i.pp_getObjectsDepth=function(){return Z.getObjectsDepth(this,...arguments)},i.pp_getComponent=function(t,n=0){return Z.getComponent(this,...arguments)},i.pp_getComponentBreadth=function(t,n=0){return Z.getComponentBreadth(this,...arguments)},i.pp_getComponentDepth=function(t,n=0){return Z.getComponentDepth(this,...arguments)},i.pp_getComponents=function(t){return Z.getComponents(this,...arguments)},i.pp_getComponentsBreadth=function(t){return Z.getComponentsBreadth(this,...arguments)},i.pp_getComponentsDepth=function(t){return Z.getComponentsDepth(this,...arguments)},i.pp_getObjectByName=function(t,n=!1,o=0){return Z.getObjectByName(this,...arguments)},i.pp_getObjectByNameBreadth=function(t,n=!1,o=0){return Z.getObjectByNameBreadth(this,...arguments)},i.pp_getObjectByNameDepth=function(t,n=!1,o=0){return Z.getObjectByNameDepth(this,...arguments)},i.pp_getObjectsByName=function(t,n=!1){return Z.getObjectsByName(this,...arguments)},i.pp_getObjectsByNameBreadth=function(t,n=!1){return Z.getObjectsByNameBreadth(this,...arguments)},i.pp_getObjectsByNameDepth=function(t,n=!1){return Z.getObjectsByNameDepth(this,...arguments)},i.pp_getObjectByID=function(t){return Z.getObjectByID(this,...arguments)},i.pp_getObjectByIDBreadth=function(t){return Z.getObjectByIDBreadth(this,...arguments)},i.pp_getObjectByIDDepth=function(t){return Z.getObjectByIDDepth(this,...arguments)},i.pp_toString=function(){return Z.toString(this,...arguments)},i.pp_toStringCompact=function(){return Z.toStringCompact(this,...arguments)},i.pp_toStringExtended=function(){return Z.toStringExtended(this,...arguments)},i.pp_getComponentsAmountMap=function(t=new Map){return Z.getComponentsAmountMap(this,...arguments)},xe.injectProperties(i,AE.prototype,!1,!0,!0)}function Vl(i){Rl(),Ol(i)}import{InputComponent as RE,ViewComponent as OE}from"@wonderlandengine/api";import{Cursor as VE,CursorTarget as Il,HitTestLocation as IE}from"@wonderlandengine/components";function YT(i=r.getMainEngine()){let e=r.getXR(i);return e!=null?e.session:null}function $T(i=r.getMainEngine()){let e=r.getXR(i);return e!=null?e.sessionMode:null}function eP(i=r.getMainEngine()){let e=r.getXR(i);return e!=null?e.currentReferenceSpace:null}function tP(i=r.getMainEngine()){let e="local";try{let t=r.getXR(i);e=t!=null?t.currentReferenceSpaceType:null}catch{}return e}function iP(i=r.getMainEngine()){let e=r.getXR(i);return e!=null?e.frame:null}function nP(i=r.getMainEngine()){return I.getSession(i)!=null}function oP(i=r.getMainEngine()){return I.getReferenceSpaceType(i).includes("floor")}function sP(i=r.getMainEngine()){let e=I.getSession(i);e?.end()}function aP(i,e,t=!1,n=!1,o=r.getMainEngine()){e!=null&&(t&&I.isSessionActive(o)&&(n?e(!0,I.getSession(o),I.getSessionMode(o)):e(I.getSession(o),I.getSessionMode(o))),n?o.onXRSessionStart.add(e.bind(void 0,!1),{id:i,immediate:!1}):o.onXRSessionStart.add(e,{id:i,immediate:!1}))}function rP(i,e=r.getMainEngine()){e.onXRSessionStart.remove(i)}function lP(i,e,t=r.getMainEngine()){e!=null&&t.onXRSessionEnd.add(e,{id:i})}function mP(i,e=r.getMainEngine()){return e.onXRSessionEnd.remove(i)}function yP(i,e,t,n=!1,o=!1,s=r.getMainEngine()){I.registerSessionStartEventListener(i,e,n,o,s),I.registerSessionEndEventListener(i,t,s)}function uP(i,e=r.getMainEngine()){I.unregisterSessionStartEventListener(i,e),I.unregisterSessionEndEventListener(i,e)}function hP(i=r.getMainEngine()){return I.isVRSupported(i)||I.isARSupported(i)}function cP(i=r.getMainEngine()){return i.vrSupported}function pP(i=r.getMainEngine()){return i.arSupported}function dP(i=r.getMainEngine()){return"CustomWebXRPolyfill"in r.getWindow(i)}var I={getSession:YT,getSessionMode:$T,getReferenceSpace:eP,getReferenceSpaceType:tP,getFrame:iP,isSessionActive:nP,exitSession:sP,registerSessionStartEventListener:aP,unregisterSessionStartEventListener:rP,registerSessionEndEventListener:lP,unregisterSessionEndEventListener:mP,registerSessionStartEndEventListeners:yP,unregisterSessionStartEndEventListeners:uP,isReferenceSpaceFloorBased:oP,isXRSupported:hP,isVRSupported:cP,isARSupported:pP,isDeviceEmulated:dP};var A={LEFT:"left",RIGHT:"right"},Bi={LEFT:0,RIGHT:1},Ye={GAMEPAD:0,TRACKED_HAND:1},lt={WRIST:"wrist",THUMB_METACARPAL:"thumb-metacarpal",THUMB_PHALANX_PROXIMAL:"thumb-phalanx-proximal",THUMB_PHALANX_DISTAL:"thumb-phalanx-distal",THUMB_TIP:"thumb-tip",INDEX_FINGER_METACARPAL:"index-finger-metacarpal",INDEX_FINGER_PHALANX_PROXIMAL:"index-finger-phalanx-proximal",INDEX_FINGER_PHALANX_INTERMEDIATE:"index-finger-phalanx-intermediate",INDEX_FINGER_PHALANX_DISTAL:"index-finger-phalanx-distal",INDEX_FINGER_TIP:"index-finger-tip",MIDDLE_FINGER_METACARPAL:"middle-finger-metacarpal",MIDDLE_FINGER_PHALANX_PROXIMAL:"middle-finger-phalanx-proximal",MIDDLE_FINGER_PHALANX_INTERMEDIATE:"middle-finger-phalanx-intermediate",MIDDLE_FINGER_PHALANX_DISTAL:"middle-finger-phalanx-distal",MIDDLE_FINGER_TIP:"middle-finger-tip",RING_FINGER_METACARPAL:"ring-finger-metacarpal",RING_FINGER_PHALANX_PROXIMAL:"ring-finger-phalanx-proximal",RING_FINGER_PHALANX_INTERMEDIATE:"ring-finger-phalanx-intermediate",RING_FINGER_PHALANX_DISTAL:"ring-finger-phalanx-distal",RING_FINGER_TIP:"ring-finger-tip",PINKY_FINGER_METACARPAL:"pinky-finger-metacarpal",PINKY_FINGER_PHALANX_PROXIMAL:"pinky-finger-phalanx-proximal",PINKY_FINGER_PHALANX_INTERMEDIATE:"pinky-finger-phalanx-intermediate",PINKY_FINGER_PHALANX_DISTAL:"pinky-finger-phalanx-distal",PINKY_FINGER_TIP:"pinky-finger-tip"},So={WRIST:0,THUMB_METACARPAL:1,THUMB_PHALANX_PROXIMAL:2,THUMB_PHALANX_DISTAL:3,THUMB_TIP:4,INDEX_FINGER_METACARPAL:5,INDEX_FINGER_PHALANX_PROXIMAL:6,INDEX_FINGER_PHALANX_INTERMEDIATE:7,INDEX_FINGER_PHALANX_DISTAL:8,INDEX_FINGER_TIP:9,MIDDLE_FINGER_METACARPAL:10,MIDDLE_FINGER_PHALANX_PROXIMAL:11,MIDDLE_FINGER_PHALANX_INTERMEDIATE:12,MIDDLE_FINGER_PHALANX_DISTAL:13,MIDDLE_FINGER_TIP:14,RING_FINGER_METACARPAL:15,RING_FINGER_PHALANX_PROXIMAL:16,RING_FINGER_PHALANX_INTERMEDIATE:17,RING_FINGER_PHALANX_DISTAL:18,RING_FINGER_TIP:19,PINKY_FINGER_METACARPAL:20,PINKY_FINGER_PHALANX_PROXIMAL:21,PINKY_FINGER_PHALANX_INTERMEDIATE:22,PINKY_FINGER_PHALANX_DISTAL:23,PINKY_FINGER_TIP:24};function _P(i){let e=null;switch(i){case Bi.LEFT:e=A.LEFT;break;case Bi.RIGHT:e=A.RIGHT;break}return e}function gP(i,e=null,t=r.getMainEngine()){let n=null,o=I.getSession(t);if(o!=null&&o.inputSources)for(let s=0;s<o.inputSources.length;s++){let a=o.inputSources[s];if((!e||e==Ye.GAMEPAD&&!a.hand||e==Ye.TRACKED_HAND&&a.hand)&&a.handedness==i){n=a;break}}return n}function fP(i,e){let t=ie.getInputSource(i,void 0,e);return ie.getInputSourceType(t)}function TP(i){let e=null;return i&&(i.hand?e=Ye.TRACKED_HAND:e=Ye.GAMEPAD),e}function PP(i){let e=null;switch(i){case A.LEFT:e=A.RIGHT;break;case A.RIGHT:e=A.LEFT;break}return e}function CP(i){let e=null,t=null;for(let n in So)if(So[n]==i){t=n;break}return t!=null&&(e=lt[t]),e}var ie={getHandednessByIndex:_P,getInputSource:gP,getInputSourceTypeByHandedness:fP,getInputSourceType:TP,getOppositeHandedness:PP,getJointIDByIndex:CP};function Bl(){bP()}function bP(){let i={};i.init=function(){this.maxDistance=100,this.visible=!1,this.globalTarget=this.object.pp_addComponent(Il),this.hitTestTarget=this.object.pp_addComponent(Il),this.hoveringObject=null,this.hoveringObjectTarget=null,this.cursorPos=c(),this._collisionMask=1<<this.collisionGroup,this._doubleClickTimer=0,this._tripleClickTimer=0,this._multipleClickObject=null,this._multipleClickDelay=.3,this._onDestroyCallbacks=[],this._prevHitLocationLocalToTarget=c(),this._pointerID=null,this._updatePointerStyle=!1,this._lastClientX=null,this._lastClientY=null,this._lastWidth=null,this._lastHeight=null,this._lastPointerID=null,this._lastOriginalMouseEvent=null,this._lastOriginalGamepadEvent=null,this._pointerLeaveToProcess=!1,this._pointerLeaveMouseEvent=null,this._transformQuat=N(),this._origin=c(),this._direction=c(),this._isHovering=!1,this._isDown=!1,this._lastIsDown=!1,this._isRealDown=!1,this._isDownForUpWithDown=!1,this._isUpWithNoDown=!1,this._tempVec=c(),this._viewComponent=null,this._cursorRayOrigin=c(),this._cursorRayScale=c(),this._projectionMatrix=be(),this._hitTestLocation=null,this._hitTestObject=null,this._rayHitLocation=c(),this._hitObjectData=[null,null,null],this._myViewEventListenersRegistered=!1},i.start=function(){if(this.handedness==0){let t=this.object.pp_getComponent(RE);t?(this.handedness=t.handedness,this.input=t):console.warn("cursor component on object "+this.object.pp_getName()+' was configured with handedness "input component", but object has no input component.')}else this.handedness=ie.getHandednessByIndex(this.handedness-1);this.pp_setViewComponent(this.object.pp_getComponent(OE)),I.registerSessionStartEventListener(this,this.setupVREvents.bind(this),!0,!1,this.engine),this._onDestroyCallbacks.push(()=>{I.unregisterSessionStartEventListener(this,this.engine)}),this.cursorRayObject&&(this.cursorRayObject.pp_setActive(!1),this._cursorRayScale.set(this.cursorRayObject.pp_getScaleLocal()),this._setCursorRayTransform(null)),this._setCursorVisibility(!1),this.useWebXRHitTest&&(this._hitTestObject=this.object.pp_addObject(),this._hitTestLocation=this.hitTestObject.pp_addComponent(IE,{scaleObject:!1}))},i.update=function(t){if(this._doubleClickTimer>0&&(this._doubleClickTimer-=t),this._tripleClickTimer>0&&(this._tripleClickTimer-=t),I.isSessionActive(this.engine)&&this._viewComponent==null){if(this.arTouchDown&&this._pp_isAR()){let o=I.getSession(this.engine).inputSources[0].gamepad.axes;this._direction.vec3_set(o[0],-o[1],-1),this.updateDirection()}else this.object.pp_getPosition(this._origin),this.object.pp_getForward(this._direction);let n=this._pp_rayCast();this._pp_hoverBehaviour(n[0],n[1],n[2],this._lastOriginalGamepadEvent)}else if(!I.isSessionActive(this.engine)&&this._viewComponent!=null)if(this._lastPointerID!=null){this._pp_updateMousePos(this._lastClientX,this._lastClientY,this._lastWidth,this._lastHeight);let n=this._pp_rayCast();this._pp_hoverBehaviour(n[0],n[1],n[2],this._lastOriginalMouseEvent),this.hoveringObject!=null?this._pointerID=this._lastPointerID:this._pointerID=null}else this.hoveringObject!=null&&this._pp_hoverBehaviour(null,null,null,this._lastOriginalMouseEvent,!0);else this.hoveringObject!=null&&this._pp_hoverBehaviour(null,null,null,null,!0);this._pp_processPointerLeave(),this.hoveringObject!=null&&(this.cursorPos[0]!=0||this.cursorPos[1]!=0||this.cursorPos[2]!=0)?(this.cursorObject&&(this._setCursorVisibility(!0),this.cursorObject.pp_setPosition(this.cursorPos),this.cursorObject.pp_setTransformLocalQuat(this.cursorObject.pp_getTransformLocalQuat(this._transformQuat).quat2_normalize(this._transformQuat))),this.cursorRayObject&&this._setCursorRayTransform(this.cursorPos)):(this.cursorObject&&this._setCursorVisibility(!1),this.cursorRayObject&&this._setCursorRayTransform(null)),this.cursorRayObject&&(I.isSessionActive(this.engine)&&this._viewComponent==null||!I.isSessionActive(this.engine)&&this._viewComponent!=null&&this.handedness!=A.LEFT&&this.handedness!=A.RIGHT?this.cursorRayObject.pp_setActive(!0):this.cursorRayObject.pp_setActive(!1)),this.hoveringObject==null&&(this._pointerID=null),this._updatePointerStyle=!1,this._lastOriginalMouseEvent=null,this._lastOriginalGamepadEvent=null},i.onActivate=function(){this._isDown=!1,this._lastIsDown=!1,this._isDownForUpWithDown=!1,this._isUpWithNoDown=!1},i.onDeactivate=function(){this.hoveringObject!=null&&this._pp_hoverBehaviour(null,null,null,null,!0),this.hoveringObject=null,this.hoveringObjectTarget=null,this._pp_updateCursorStyle(),this._setCursorVisibility(!1),this.cursorRayObject&&this.cursorRayObject.pp_setActive(!1),this._isDown=!1,this._lastIsDown=!1,this._isRealDown=!1,this._isDownForUpWithDown=!1,this._isUpWithNoDown=!1,this._pointerID=null,this._lastPointerID=null,this._lastClientX=null,this._lastClientY=null,this._lastWidth=null,this._lastHeight=null,this._lastOriginalMouseEvent=null,this._lastOriginalGamepadEvent=null,this._pointerLeaveToProcess=!1,this._pointerLeaveMouseEvent=null},i.onDestroy=function(){this._hitTestObject!=null&&this._hitTestObject.pp_destroy();for(let t of this._onDestroyCallbacks)t()},i.updateDirection=function(){let e=N();return function(){this.object.pp_getPosition(this._origin),this._direction.vec3_transformMat4(this._projectionMatrix,this._direction),this._direction.vec3_normalize(this._direction),this._direction.vec3_transformQuat(this.object.pp_getTransformQuat(e),this._direction)}}(),i.setupVREvents=function(t){let n=this.onSelect.bind(this);t.addEventListener("select",n);let o=this.onSelectStart.bind(this);t.addEventListener("selectstart",o);let s=this.onSelectEnd.bind(this);t.addEventListener("selectend",s),this._onDestroyCallbacks.push(()=>{if(!I.isSessionActive(this.engine))return;let a=I.getSession(this.engine);a.removeEventListener("select",n),a.removeEventListener("selectstart",o),a.removeEventListener("selectend",s)}),this._onViewportResize()},i.onSelect=function(t){},i.onSelectStart=function(t){this.active&&(this._pp_isAR()?(this.arTouchDown=!0,this._lastOriginalGamepadEvent=t):t.inputSource.handedness==this.handedness&&(this._isDown=!0,this._isRealDown=!0,this._lastIsDown||(this._isDownForUpWithDown=!0),this._lastOriginalGamepadEvent=t))},i.onSelectEnd=function(t){this.active&&(this._pp_isAR()?(this.arTouchDown=!1,this._lastOriginalGamepadEvent=t):t.inputSource.handedness==this.handedness&&(this._isDownForUpWithDown||(this._isUpWithNoDown=!0),this._isDown=!1,this._isRealDown=!1,this._isDownForUpWithDown=!1,this._lastOriginalGamepadEvent=t))},i.onPointerMove=function(t){if(this.active&&!this._pointerLeaveToProcess){if(this._pointerID!=null&&this._pointerID!=t.pointerId)return;let n=r.getBody(this.engine).getBoundingClientRect();this._pp_updateMouseData(t,t.clientX,t.clientY,n.width,n.height,t.pointerId)}},i.onClick=function(t){},i.onPointerDown=function(t){if(this.active&&!this._pointerLeaveToProcess){if(this._pointerID!=null&&this._pointerID!=t.pointerId||t.button!==0)return;let n=r.getBody(this.engine).getBoundingClientRect();this._pp_updateMouseData(t,t.clientX,t.clientY,n.width,n.height,t.pointerId),this._isDown=!0,this._isRealDown=!0,this._lastIsDown||(this._isDownForUpWithDown=!0)}},i.onPointerUp=function(t){if(this.active&&!this._pointerLeaveToProcess){if(this._pointerID!=null&&this._pointerID!=t.pointerId||t.button!==0)return;let n=r.getBody(this.engine).getBoundingClientRect();this._pp_updateMouseData(t,t.clientX,t.clientY,n.width,n.height,t.pointerId),this._isDownForUpWithDown||(this._isUpWithNoDown=!0),this._isDown=!1,this._isRealDown=!1,this._isDownForUpWithDown=!1,this._updatePointerStyle=!0}},i._onViewportResize=function(){!this._viewComponent||this._viewComponent.projectionMatrix.mat4_invert(this._projectionMatrix)},i._setCursorRayTransform=function(t){if(!!this.cursorRayObject&&this.cursorRayScalingAxis!=4&&(this.cursorRayObject.pp_resetScaleLocal(),t!=null)){this.cursorRayObject.pp_getPosition(this._cursorRayOrigin);let n=this._cursorRayOrigin.vec3_distance(t);this._cursorRayScale[this.cursorRayScalingAxis]=n,this.cursorRayObject.pp_scaleObject(this._cursorRayScale)}},i._setCursorVisibility=function(t){this.visible=t,this.cursorObject&&this.cursorObject.pp_setActive(t)},i._pp_hoverBehaviour=function(t,n,o,s=null,a=!1){if(!a&&t!=null){let l=!1;(this.hoveringObject==null||!this.hoveringObject.pp_equals(t))&&(this.hoveringObject!=null&&(this.hoveringReality?this.hitTestTarget.onUnhover.notify(null,this,s):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onUnhover.notify(this.hoveringObject,this,s),this.globalTarget.onUnhover.notify(this.hoveringObject,this,s))),l=!0,this.hoveringObject=t,this.hoveringObjectTarget=this.hoveringObject.pp_getComponent(Il),this.hoveringReality?this.hitTestTarget.onHover.notify(o,this,s):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onHover.notify(this.hoveringObject,this,s),this.globalTarget.onHover.notify(this.hoveringObject,this,s)),this._pp_updateCursorStyle(),!this._pp_isDownToProcess()&&this._isRealDown&&(this._isDown=!0,this._lastIsDown=!0,this._isDownForUpWithDown=!1,this._isUpWithNoDown=!1,this.hoveringReality?this.hitTestTarget.onDownOnHover.notify(o,this,s):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onDownOnHover.notify(this.hoveringObject,this,s),this.globalTarget.onDownOnHover.notify(this.hoveringObject,this,s)))),this._updatePointerStyle&&this._pp_updateCursorStyle(),!l&&this._pp_isMoving(n)&&(this.hoveringReality?this.hitTestTarget.onMove.notify(o,this,s):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onMove.notify(this.hoveringObject,this,s),this.globalTarget.onMove.notify(this.hoveringObject,this,s))),this._pp_isDownToProcess()?(this.hoveringReality?this.hitTestTarget.onDown.notify(o,this,s):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onDown.notify(this.hoveringObject,this,s),this.globalTarget.onDown.notify(this.hoveringObject,this,s)),this.hoveringReality?this.hitTestTarget.onClick.notify(o,this,s):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onClick.notify(this.hoveringObject,this,s),this.globalTarget.onClick.notify(this.hoveringObject,this,s)),this._tripleClickTimer>0&&this._multipleClickObject&&this._multipleClickObject.pp_equals(this.hoveringObject)?(this.hoveringReality?this.hitTestTarget.onTripleClick.notify(o,this,s):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onTripleClick.notify(this.hoveringObject,this,s),this.globalTarget.onTripleClick.notify(this.hoveringObject,this,s)),this._tripleClickTimer=0):this._doubleClickTimer>0&&this._multipleClickObject&&this._multipleClickObject.pp_equals(this.hoveringObject)?(this.hoveringReality?this.hitTestTarget.onDoubleClick.notify(o,this,s):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onDoubleClick.notify(this.hoveringObject,this,s),this.globalTarget.onDoubleClick.notify(this.hoveringObject,this,s)),this._tripleClickTimer=this._multipleClickDelay,this._doubleClickTimer=0):(this.hoveringReality?this.hitTestTarget.onSingleClick.notify(o,this,s):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onSingleClick.notify(this.hoveringObject,this,s),this.globalTarget.onSingleClick.notify(this.hoveringObject,this,s)),this._tripleClickTimer=0,this._doubleClickTimer=this._multipleClickDelay,this._multipleClickObject=this.hoveringObject)):!this._isUpWithNoDown&&!l&&this._pp_isUpToProcess()?this.hoveringReality?(this.hitTestTarget.onUp.notify(o,this,s),this.hitTestTarget.onUpWithDown.notify(o,this,s)):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onUp.notify(this.hoveringObject,this,s),this.globalTarget.onUp.notify(this.hoveringObject,this,s),this.hoveringObjectTarget&&this.hoveringObjectTarget.onUpWithDown.notify(this.hoveringObject,this,s),this.globalTarget.onUpWithDown.notify(this.hoveringObject,this,s)):(this._isUpWithNoDown||l&&this._pp_isUpToProcess())&&(this.hoveringReality?(this.hitTestTarget.onUp.notify(o,this,s),this.hitTestTarget.onUpWithNoDown.notify(o,this,s)):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onUp.notify(this.hoveringObject,this,s),this.globalTarget.onUp.notify(this.hoveringObject,this,s),this.hoveringObjectTarget&&this.hoveringObjectTarget.onUpWithNoDown.notify(this.hoveringObject,this,s),this.globalTarget.onUpWithNoDown.notify(this.hoveringObject,this,s))),this._prevHitLocationLocalToTarget=this.hoveringObject.pp_convertPositionWorldToLocal(n,this._prevHitLocationLocalToTarget)}else this.hoveringObject!=null&&(a||t==null)&&(this.hoveringReality?this.hitTestTarget.onUnhover.notify(null,this,s):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onUnhover.notify(this.hoveringObject,this,s),this.globalTarget.onUnhover.notify(this.hoveringObject,this,s)),this.hoveringObject=null,this.hoveringObjectTarget=null,this._pp_updateCursorStyle());this.hoveringObject!=null?this._lastIsDown=this._isDown:(this._isDown=!1,this._lastIsDown=!1,this._isDownForUpWithDown=!1),this._isUpWithNoDown=!1},i._pp_rayCast=function(){let t=this.rayCastMode==0?r.getScene(this.engine).rayCast(this._origin,this._direction,this._collisionMask):r.getPhysics(this.engine).rayCast(this._origin,this._direction,this._collisionMask,this.maxDistance),n=!0;this.rayCastMode==0&&t.hitCount>0&&t.distances[0]>this.maxDistance&&(n=!1),this._hitObjectData[0]=null,this._hitObjectData[1]=null,this._hitObjectData[2]=null;let o=1/0;this._hitTestLocation!=null&&this._hitTestLocation.visible&&(this._hitTestObject.pp_getPositionWorld(this.cursorPos),this._rayHitLocation.vec3_copy(this.cursorPos),o=this.cursorPos.vec3_distance(this.object.pp_getPositionWorld(this._tempVec)),this._hitObjectData[0]=this._hitTestObject,this._hitObjectData[1]=this._rayHitLocation),this.hoveringReality=!1,t.hitCount>0&&n?t.distances[0]<=o?(this.cursorPos.vec3_copy(t.locations[0]),this._rayHitLocation.vec3_copy(this.cursorPos),this._hitObjectData[0]=t.objects[0],this._hitObjectData[1]=this._rayHitLocation):this.hoveringReality=!0:o==1/0&&(this.cursorPos.vec3_zero(),this._hitObjectData[0]=null,this._hitObjectData[1]=null);let s=I.getFrame(this.engine);return this.hoveringReality&&s!=null&&(this._hitObjectData[2]=this._hitTestLocation.getHitTestResults(s)[0]),this._hitObjectData},i._pp_updateMouseData=function(t,n,o,s,a,l){this._lastClientX=n,this._lastClientY=o,this._lastWidth=s,this._lastHeight=a,this._lastPointerID=l,this._lastOriginalMouseEvent=t},i._pp_updateMousePos=function(t,n,o,s){let a=t/o,l=n/s;this._direction.vec3_set(a*2-1,-l*2+1,-1),this.updateDirection()},i.pp_setViewComponent=function(t){if(this._viewComponent=t,this._viewComponent!=null&&(this._viewComponent.projectionMatrix.mat4_invert(this._projectionMatrix),!this._myViewEventListenersRegistered)){this._myViewEventListenersRegistered=!0;let n=this.onClick.bind(this);r.getCanvas(this.engine).addEventListener("click",n);let o=this.onPointerDown.bind(this);r.getCanvas(this.engine).addEventListener("pointerdown",o);let s=this.onPointerMove.bind(this);r.getCanvas(this.engine).addEventListener("pointermove",s);let a=this.onPointerUp.bind(this);r.getCanvas(this.engine).addEventListener("pointerup",a);let l=this._pp_onPointerLeave.bind(this);r.getCanvas(this.engine).addEventListener("pointerleave",l);let u=this._onViewportResize.bind(this);this.engine.onResize.add(u),this._onDestroyCallbacks.push(()=>{r.getCanvas(this.engine).removeEventListener("click",n),r.getCanvas(this.engine).removeEventListener("pointerdown",o),r.getCanvas(this.engine).removeEventListener("pointermove",s),r.getCanvas(this.engine).removeEventListener("pointerup",a),r.getCanvas(this.engine).removeEventListener("pointerleave",l),this.engine.onResize.remove(u),this._myViewEventListenersRegistered=!1})}},i._pp_onPointerLeave=function(t){(this._pointerID==null||this._pointerID==t.pointerId)&&(this._pointerLeaveToProcess=!0,this._pointerLeaveMouseEvent=t)},i._pp_processPointerLeave=function(){this._pointerLeaveToProcess&&(this._pointerID=null,this._lastPointerID=null,this._lastClientX=null,this._lastClientY=null,this._lastWidth=null,this._lastHeight=null,this._lastOriginalMouseEvent=this._pointerLeaveMouseEvent,this._pointerLeaveToProcess=!1,this._pointerLeaveMouseEvent=null,this.hoveringObject!=null&&this._pp_hoverBehaviour(null,null,null,this._lastOriginalMouseEvent,!0),this._isDown=!1,this._lastIsDown=!1,this._isRealDown=!1,this._isDownForUpWithDown=!1,this._isUpWithNoDown=!1)},i._pp_isDownToProcess=function(){return this._isDown!==this._lastIsDown&&this._isDown},i._pp_isUpToProcess=function(){return this._isDown!==this._lastIsDown&&!this._isDown},i._pp_isMoving=function(){let e=c();return function(n){let o=!1;return e=this.hoveringObject.pp_convertPositionWorldToLocal(n,e),e.vec_equals(this._prevHitLocationLocalToTarget,1e-4)||(o=!0),o}}(),i._pp_isAR=function(){let t=I.getSession(this.engine).inputSources[0];return this.input!=null&&t.handedness==="none"&&t.gamepad!=null},i._pp_updateCursorStyle=function(){this.styleCursor&&(this.hoveringObjectTarget!=null&&!this.hoveringObjectTarget.isSurface?r.getBody(this.engine).style.cursor="pointer":r.getBody(this.engine).style.cursor=="pointer"&&(r.getBody(this.engine).style.cursor="default"))},xe.injectProperties(i,VE.prototype,!1,!0,!0)}import{Emitter as vo}from"@wonderlandengine/api";import{CursorTarget as BE}from"@wonderlandengine/components";function Ll(){SP()}function SP(){let i={};i.init=function(){this.onSingleClick=new vo,this.onDoubleClick=new vo,this.onTripleClick=new vo,this.onDownOnHover=new vo,this.onUpWithDown=new vo,this.onUpWithNoDown=new vo,this.isSurface=!1},i.start=function(){},i.update=function(t){},i.onActivate=function(){},i.onDeactivate=function(){},i.onDestroy=function(){},xe.injectProperties(i,BE.prototype,!1,!0,!0)}import{MouseLookComponent as HE}from"@wonderlandengine/components";import{Emitter as LE}from"@wonderlandengine/api";var ne=class{constructor(e,t=!0){this._myDuration=e,this._myOnEndEmitter=new LE,this._myDone=!1,this._myJustDone=!1,this._myStarted=!1,t?this.start():this.reset()}start(e=null){this.reset(e),this._myStarted=!0}end(){this._done()}reset(e=null){e!=null&&(this._myDuration=Math.max(0,e)),this._myTimeLeft=this._myDuration,this._myDone=!1,this._myJustDone=!1,this._myStarted=!1}update(e){this._myJustDone=!1,this.isRunning()&&(this._myTimeLeft=Math.max(0,this._myTimeLeft-e),this._myTimeLeft==0&&this._done())}isDone(){return this._myDone}isJustDone(){return this._myJustDone}isStarted(){return this._myStarted}isRunning(){return this.isStarted()&&!this.isDone()}getDuration(){return this._myDuration}setDuration(e){this._myDuration=Math.max(0,e)}getTimeLeft(){return this._myTimeLeft}getPercentage(){let e=1;return this._myTimeLeft>0&&this._myDuration>0&&(e=(this._myDuration-this._myTimeLeft)/this._myDuration),Math.pp_clamp(e,0,1)}setPercentage(e){if(this.isRunning()){let t=Math.pp_clamp(1-e,0,1);this._myTimeLeft=this._myDuration*t}}onEnd(e,t=null){this._myOnEndEmitter.add(e,{id:t})}unregisterOnEnd(e=null){this._myOnEndEmitter.remove(e)}_done(){this._myTimeLeft=0,this._myDone=!0,this._myJustDone=!0,this._myOnEndEmitter.notify()}};function Hl(){vP()}function vP(){let i={};i.init=function(){this.pointerId=null,this.prevMoveEvent=null,this.resetMovingDelay=.15,this.resetMovingTimer=new ne(this.resetMovingDelay,!1),this.isMoving=!1,this.pointerMoveListener=this._onMove.bind(this),this.contextMenuListener=function(t){this.active&&t.preventDefault()}.bind(this),this.pointerDown=function(t){if(this.active){if(this.pointerId!=null)return;if(!this.mouseDown&&t.button==this.mouseButtonIndex&&(this.pointerId=t.pointerId,this.mouseDown=!0,t.button==1))return t.preventDefault(),!1}}.bind(this),this.pointerUp=function(t){if(this.active){if(t.pointerId!=this.pointerId)return;this.mouseDown&&t.button==this.mouseButtonIndex&&(this.mouseDown=!1)}}.bind(this),this.pointerLeave=function(t){if(this.active){if(t.pointerId!=this.pointerId)return;this.pointerId=null,this.prevMoveEvent=null,this.mouseDown&&(this.mouseDown=!1)}}.bind(this),r.getBody(this.engine).addEventListener("pointermove",this.pointerMoveListener),this.requireMouseDown&&(this.mouseButtonIndex==2&&r.getCanvas(this.engine).addEventListener("contextmenu",this.contextMenuListener,!1),r.getCanvas(this.engine).addEventListener("pointerdown",this.pointerDown),r.getBody(this.engine).addEventListener("pointerup",this.pointerUp)),r.getBody(this.engine).addEventListener("pointerleave",this.pointerLeave)},i.start=function(){},i.onActivate=function(){},i.onDeactivate=function(){this.mouseDown,this.isMoving=!1,this.mouseDown=!1,this.pointerId=null,this.prevMoveEvent=null},i.onDestroy=function(){r.getBody(this.engine).removeEventListener("pointermove",this.pointerMoveListener),r.getCanvas(this.engine).removeEventListener("contextmenu",this.contextMenuListener),r.getCanvas(this.engine).removeEventListener("pointerdown",this.pointerDown),r.getBody(this.engine).removeEventListener("pointerup",this.pointerUp),r.getBody(this.engine).removeEventListener("pointerleave",this.pointerLeave)},i.update=function(t){this.resetMovingTimer.isRunning()&&(this.resetMovingTimer.update(t),this.resetMovingTimer.isDone()&&(this.resetMovingTimer.reset(),this.isMoving=!1)),this.isMoving||((!this.requireMouseDown||!this.mouseDown)&&(this.pointerId=null),this.prevMoveEvent=null)},i._onMove=function(){let e=c(),t=c(),n=c(),o=c(),s=c(),a=c();return function(u){if(this.active){if(this.pointerId!=null&&u.pointerId!=this.pointerId)return;if(this.mouseDown||!this.requireMouseDown){e=this.object.pp_getBackward(e),t=this.object.pp_getUp(t),n.vec3_set(0,1,0),this.object.pp_getParent()!=null&&(n=this.object.pp_getParent().pp_getUp(n)),s=e.vec3_cross(n,s);let _=1;e.vec3_angle(n)<_?s=t.vec3_negate(s).vec3_cross(n,s):e.vec3_angle(n.vec3_negate(o))<_?s=t.vec3_cross(n,s):t.vec3_isConcordant(n)||s.vec3_negate(s),s.vec3_normalize(s);let m=u.movementX,h=u.movementY;(m==null||h==null)&&(this.prevMoveEvent!=null?(m=u.pageX-this.prevMoveEvent.pageX,h=u.pageY-this.prevMoveEvent.pageY):(m=0,h=0)),this.rotationX=-this.sensitity*m,this.rotationY=-this.sensitity*h,this.object.pp_rotateAxis(this.rotationY,s);let d=90-.001;a=this.object.pp_getUp(a);let g=Math.pp_angleClamp(a.vec3_angleSigned(n,s));if(Math.abs(g)>d){let P=(Math.abs(g)-d)*Math.pp_sign(g);this.object.pp_rotateAxis(P,s)}this.object.pp_rotateAxis(this.rotationX,n),this.prevMoveEvent=u,this.pointerId=u.pointerId,this.resetMovingTimer.start(this.resetMovingDelay),this.isMoving=!0}}}}(),xe.injectProperties(i,HE.prototype,!1,!0,!0)}function kl(){Bl(),Ll(),Hl()}function Fl(){kl()}function wl(i){Vl(i),Fl()}function jl(i){Al(),wl(i)}function zl(i){i.registerComponent(_i,ci,sn,Zt,en,tn,cn,pn,nn,xn,Cn,bn,vn,Sn,yn,mn,$e,ei,ln,rn,hn,un,En,An,Rn,On,Vn,Bn,In,Ln,Hn,Dn,Mn,pi,di,Ti,fn,Hi,Lt,Ht,gi,fi,It,Bt,Vt,Yi,Yt,Zi,dn,on,ki,Pi,Pn,Fi,an,$i,_n,wi,gn,ti,Li,Tn,$t)}function Nl(i){r.initEngine(i),z.setDefaultWLComponentCloneCallbacks(i),Kr(i),zl(i),jl(i)}var ls=class{constructor(){this.myScene=null,this.myCauldron=null,this.myDynamics=null,this.myParticles=null,this.myVisualElements=null,this.myTools=null,this.myPlayerObjects=new vr}},vr=class{constructor(){this.myPlayer=null,this.myCauldron=null,this.myReferenceSpace=null,this.myCameraNonXR=null,this.myEyes=[],this.myEyeLeft=null,this.myEyeRight=null,this.myHands=[],this.myHandLeft=null,this.myHandRight=null,this.myHead=null,this.myHeadDebugs=null}};var ms=class{constructor(){this.myMeshes=new xr,this.myMaterials=new Mr}},xr=class{constructor(){this.myPlane=null,this.myCube=null,this.mySphere=null,this.myCone=null,this.myCylinder=null,this.myCircle=null,this.myInvertedCube=null,this.myInvertedSphere=null,this.myInvertedCone=null,this.myInvertedCylinder=null,this.myDoubleSidedPlane=null,this.myDoubleSidedCube=null,this.myDoubleSidedSphere=null,this.myDoubleSidedCone=null,this.myDoubleSidedCylinder=null,this.myDoubleSidedCircle=null}},Mr=class{constructor(){this.myFlatOpaque=null,this.myFlatTransparentNoDepth=null,this.myPhongOpaque=null,this.myText=null}};import{Component as DA,Property as Er}from"@wonderlandengine/api";import{Component as jE,Property as zE}from"@wonderlandengine/api";import{Howler as Gl}from"howler";import{Emitter as kE}from"@wonderlandengine/api";import{Howl as FE,Howler as wE}from"howler";var ji=class{constructor(e=null){this.myAudioFilePath=e,this.myLoop=!1,this.myAutoPlay=!1,this.myVolume=1,this._myRate=1,this.myPool=5,this.myPreload=!0,this.myPreventPlayWhenAudioContextNotRunning=!1,this.myPosition=null,this.mySpatial=!0,this.myReferenceDistance=Number.MAX_VALUE}clone(){let e=new ji;return e.myAudioFilePath=this.myAudioFilePath,e.myLoop=this.myLoop,e.myAutoPlay=this.myAutoPlay,e.myVolume=this.myVolume,e.myPitch=this.myPitch,e.myRate=this.myRate,e.myPool=this.myPool,e.myPreload=this.myPreload,e.myPreventPlayWhenAudioContextNotRunning=this.myPreventPlayWhenAudioContextNotRunning,this.myPosition!=null?e.myPosition=this.myPosition.vec3_clone():e.myPosition=null,e.mySpatial=this.mySpatial,e.myReferenceDistance=this.myReferenceDistance,e}get myPitch(){return this._myRate}get myRate(){return this._myRate}set myPitch(e){this._myRate=e}set myRate(e){this._myRate=e}};var ys={END:"end",STOP:"stop",LOAD:"load",LOAD_ERROR:"loaderror",PLAY:"play",PLAY_ERROR:"playerror",PAUSE:"pause",MUTE:"mute",VOLUME:"volume",RATE:"rate",SEEK:"seek",FADE:"fade",UNLOCK:"unlock"},kn=class{constructor(e,t=null){e==null?this._myAudioSetup=new ji:typeof e=="string"?this._myAudioSetup=new ji(e):this._myAudioSetup=e.clone(),this._myAudio=null,t==null?(this._myAudio=new FE({src:[this._myAudioSetup.myAudioFilePath],loop:this._myAudioSetup.myLoop,volume:this._myAudioSetup.myVolume,autoplay:!1,rate:this._myAudioSetup.myRate,pool:this._myAudioSetup.myPool,pos:this._myAudioSetup.mySpatial?this._myAudioSetup.myPosition:null,refDistance:this._myAudioSetup.myReferenceDistance,preload:this._myAudioSetup.myPreload}),this._myAudio._pannerAttr.refDistance=this._myAudioSetup.myReferenceDistance):this._myAudio=t,this._myLastAudioID=null,this._myAudioEventEmitters=new Map;for(let n in ys)this._myAudioEventEmitters.set(ys[n],new kE);this._addListeners(),this._myAudioSetup.myAutoPlay&&this.play()}isValid(){return this._myAudio!=null}play(){if(wE.state!="running"&&this._myAudioSetup.myPreventPlayWhenAudioContextNotRunning)return!1;let e=this._myAudio.play();return e!=null&&(this._myLastAudioID=e,this.updatePosition(this._myAudioSetup.myPosition,!0),this.updatePitch(this._myAudioSetup.myPitch,!0),this.updateVolume(this._myAudioSetup.myVolume,!0)),e!=null}stop(){this._myAudio.stop()}pause(){this._myAudio.pause()}resume(){this._myAudio.play()}isPlaying(e=!1){let t=!1;return e?t=this._myAudio.playing(this._myLastAudioID):t=this._myAudio.playing(),t}isLoaded(){return this._myAudio.state()=="loaded"}fade(e,t,n,o=!0,s=!0){s&&this.setVolume(t),o?this._myAudio.fade(e,t,n*1e3,this._myLastAudioID):this._myAudio.fade(e,t,n*1e3)}isFading(e=!0){let t=!1;if(e){let n=this._myAudio._soundById(this._myLastAudioID);n!=null&&(t=n._fadeTo!=null)}else for(let n of this._myAudio._sounds)if(n._fadeTo!=null){t=!0;break}return t}updatePosition(e,t=!0,n=!0){n&&this.setPosition(e),this._myAudioSetup.mySpatial&&e&&(t?this._myAudio.pos(e[0],e[1],e[2],this._myLastAudioID):this._myAudio.pos(e[0],e[1],e[2]))}updatePitch(e,t=!0,n=!0){this.updateRate(e,t,n)}updateRate(e,t=!0,n=!0){n&&this.setRate(e),e!=null&&(t?this._myAudio.rate(e,this._myLastAudioID):this._myAudio.rate(e))}updateVolume(e,t=!0,n=!0){n&&this.setVolume(e),e!=null&&(t?this._myAudio.volume(e,this._myLastAudioID):this._myAudio.volume(e))}setSpatial(e){this._myAudioSetup.mySpatial=e}setPosition(e){this._myAudioSetup.myPosition=e}setPitch(e){this._myAudioSetup.myPitch=e}setRate(e){this._myAudioSetup.myRate=e}setVolume(e){this._myAudioSetup.myVolume=e}getDuration(){return this._myAudio.duration()}getVolume(){return this._myAudioSetup.myVolume}getPitch(){return this._myAudioSetup.myPitch}getRate(){return this._myAudioSetup.myRate}registerAudioEventListener(e,t,n,o=!1){this._myAudioEventEmitters.get(e).add(n,{id:t,once:o})}unregisterAudioEventListener(e,t){this._myAudioEventEmitters.get(e).remove(t)}_addListeners(){if(this._myAudio!=null)for(let e in ys){let t=ys[e];this._myAudio.on(t,function(n){this._myAudioEventEmitters.get(t).notify(n)}.bind(this))}}};var us=class{constructor(e=!0,t=r.getMainEngine()){this._myEngine=t,this._myPreloadAudio=e,this._myAudioSetups=new Map}createAudioPlayer(e){return this.getAudioSetup(e)!=null?new kn(this.getAudioSetup(e)):null}getAudioSetup(e){return this._myAudioSetups.get(e)}addAudioSetup(e,t,n=null){this._myAudioSetups.set(e,t),(this._myPreloadAudio&&n==null||n!=null&&n)&&this.createAudioPlayer(e)}removeAudioSetup(e){this._myAudioSetups.delete(e)}setVolume(e){Gl.volume(e)}setMute(e){Gl.mute(e)}stop(){Gl.stop()}};var Zt=class extends jE{init(){this._myAudioManager=null,r.hasAudioManager(this.engine)||(this._myAudioManager=new us(this._myPreloadAudio,this.engine),r.setAudioManager(this._myAudioManager,this.engine))}onDestroy(){this._myAudioManager!=null&&r.getAudioManager(this.engine)==this._myAudioManager&&r.removeAudioManager(this.engine)}};R(Zt,"TypeName","pp-audio-manager"),R(Zt,"Properties",{_myPreloadAudio:zE.bool(!0)});import{Component as NE}from"@wonderlandengine/api";var hs=class{constructor(){this._myPools=new Map,this._myDestroyed=!1}addPool(e,t){this._myPools.has(e)?console.warn("Trying to add a Pool with an ID that has been already used:",e):this._myPools.set(e,t)}removePool(e){let t=this._myPools.get(e);t!=null&&(this._myPools.delete(e),t.destroy())}getPool(e){return this._myPools.get(e)}hasPool(e){return this._myPools.has(e)}get(e){return this._myPools.has(e)?this._myPools.get(e).get():null}release(e,t){if(t===void 0)for(let n of this._myPools.values())n.release(e);else this._myPools.get(e).release(t)}releaseAll(e=void 0){if(e===void 0)for(let t of this._myPools.values())t.releaseAll();else this._myPools.get(e).releaseAll()}increase(e,t){let n=this._myPools.get(e);n&&n.increase(t)}increasePercentage(e,t){let n=this._myPools.get(e);n&&n.increasePercentage(t)}destroy(){this._myDestroyed=!0;for(let e of this._myPools.values())e.destroy()}isDestroyed(){return this._myDestroyed}};var Yt=class extends NE{init(){this._myObjectPoolManager=null,r.hasObjectPoolManager(this.engine)||(this._myObjectPoolManager=new hs,r.setObjectPoolManager(this._myObjectPoolManager,this.engine))}onDestroy(){this._myObjectPoolManager!=null&&r.getObjectPoolManager(this.engine)==this._myObjectPoolManager&&r.removeObjectPoolManager(this.engine)}};R(Yt,"TypeName","pp-object-pools-manager"),R(Yt,"Properties",{});import{Component as JE}from"@wonderlandengine/api";var Fn=class{constructor(){this.myInitialPoolSize=0,this.myAmountToAddWhenEmpty=0,this.myPercentageToAddWhenEmpty=0,this.myCloneParams=void 0,this.myOptimizeObjectsAllocation=!0,this.myCloneCallback=void 0,this.mySetActiveCallback=void 0,this.myEqualCallback=void 0,this.myDestroyCallback=void 0,this.myOptimizeObjectsAllocationCallback=void 0,this.myLogEnabled=!1}},wn=class{constructor(e,t){this._myObjectPoolParams=t,this._myPrototype=this._clone(e),this._myAvailableObjects=[],this._myBusyObjects=[],this._addToPool(t.myInitialPoolSize,!1),this._myDestroyed=!1}get(){let e=this._myAvailableObjects.shift();if(e==null){let t=Math.ceil(this._myBusyObjects.length*this._myObjectPoolParams.myPercentageToAddWhenEmpty);t+=this._myObjectPoolParams.myAmountToAddWhenEmpty,this._addToPool(t,this._myObjectPoolParams.myLogEnabled),e=this._myAvailableObjects.shift()}return e!=null&&this._myBusyObjects.push(e),e}release(e){let t=this._myBusyObjects.pp_remove(this._equals.bind(this,e));t!=null&&(this._setActive(t,!1),this._myAvailableObjects.push(t))}releaseAll(){for(let e of this._myBusyObjects)this._setActive(e,!1),this._myAvailableObjects.push(e)}increase(e){this._addToPool(e,!1)}increasePercentage(e){let t=Math.ceil(this.getSize()*e);this._addToPool(t,!1)}getSize(){return this._myBusyObjects.length+this._myAvailableObjects.length}getAvailableSize(){return this._myAvailableObjects.length}getBusySize(){return this._myAvailableObjects.length}_addToPool(e,t){if(!(e<=0)){this._myObjectPoolParams.myOptimizeObjectsAllocation&&(this._myObjectPoolParams.myOptimizeObjectsAllocationCallback!=null?this._myObjectPoolParams.myOptimizeObjectsAllocationCallback(this._myPrototype,e):this._myPrototype.pp_reserveObjects!=null&&this._myPrototype.pp_reserveObjects(e));for(let n=0;n<e;n++)this._myAvailableObjects.push(this._clone(this._myPrototype));t&&console.warn("Added new elements to the pool:",e)}}_clone(e){let t=null;return this._myObjectPoolParams.myCloneCallback!=null?t=this._myObjectPoolParams.myCloneCallback(e,this._myObjectPoolParams.myCloneParams):e.pp_clone!=null?t=e.pp_clone(this._myObjectPoolParams.myCloneParams):e.clone!=null&&(t=e.clone(this._myObjectPoolParams.myCloneParams)),t==null?console.error("Object not cloneable, pool will return null"):this._setActive(t,!1),t}_setActive(e,t){this._myObjectPoolParams.mySetActiveCallback!=null?this._myObjectPoolParams.mySetActiveCallback(e,t):e.pp_setActive!=null?e.pp_setActive(t):e.setActive!=null&&e.setActive(t)}_equals(e,t){let n=!1;return this._myObjectPoolParams.myEqualCallback!=null?n=this._myObjectPoolParams.myEqualCallback(e,t):e.pp_equals!=null?n=e.pp_equals(t):e.equals!=null?n=e.equals(t):n=e==t,n}destroy(){this._myDestroyed=!0;for(let e of this._myAvailableObjects)this._destroyObject(e);for(let e of this._myBusyObjects)this._destroyObject(e);this._destroyObject(this._myPrototype)}isDestroyed(){return this._myDestroyed}_destroyObject(e){this._myObjectPoolParams.myDestroyCallback!=null?this._myObjectPoolParams.myDestroyCallback(e):e.pp_destroy!=null?e.pp_destroy():e.destroy!=null&&e.destroy()}};import{MeshComponent as WE}from"@wonderlandengine/api";var Me={MESH:0,LINE:1,POINT:2,TEXT:3,ARROW:4,TRANSFORM:5,RAYCAST:6,TORUS:7};import{MeshComponent as GE}from"@wonderlandengine/api";var et=class{constructor(e=r.getMainEngine()){this.myStart=c(),this.myDirection=c(0,0,1),this.myLength=0,this.myThickness=.005,this.myMesh=null,this.myMaterial=null,this.myColor=null,this.myParent=r.getSceneObjects(e).myVisualElements,this.myLocal=!1,this.myType=Me.LINE}setStartEnd(e,t){return t.vec3_sub(e,this.myDirection),this.myLength=this.myDirection.vec3_length(),this.myDirection.vec3_normalize(this.myDirection),this.myStart.vec3_copy(e),this}copy(e){}},ht=class{constructor(e=new et){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myLineParentObject=null,this._myLineObject=null,this._myLineMeshComponent=null,this._myFlatOpaqueMaterial=null,this._myDestroyed=!1,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){this._myVisible!=e&&(this._myVisible=e,this._myLineParentObject.pp_setActive(e))}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1)}_build(){this._myLineParentObject=r.getSceneObjects(this._myParams.myParent.pp_getEngine()).myVisualElements.pp_addObject(),this._myLineObject=this._myLineParentObject.pp_addObject(),this._myLineMeshComponent=this._myLineObject.pp_addComponent(GE)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new et(this._myParams.myParent.pp_getEngine());e.copy(this._myParams);let t=new ht(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}_refresh(){}destroy(){this._myDestroyed=!0,this._myLineParentObject.pp_destroy()}isDestroyed(){return this._myDestroyed}};ht.prototype._refresh=function(){let i=c(),e=c(),t=c(0,1,0);return function(){this._myLineParentObject.pp_setParent(this._myParams.myParent,!1),this._myParams.myLocal?this._myLineParentObject.pp_setPositionLocal(this._myParams.myStart):this._myLineParentObject.pp_setPosition(this._myParams.myStart),i.vec3_set(this._myParams.myThickness/2,this._myParams.myLength/2,this._myParams.myThickness/2),this._myParams.myLocal?this._myLineObject.pp_setScaleLocal(i):this._myLineObject.pp_setScale(i),this._myParams.myLocal?this._myLineObject.pp_setUpLocal(this._myParams.myDirection,t):this._myLineObject.pp_setUp(this._myParams.myDirection,t),this._myLineObject.pp_resetPositionLocal(),e.vec3_set(0,this._myParams.myLength/2,0),this._myLineObject.pp_translateObject(e),this._myParams.myMesh!=null?this._myLineMeshComponent.mesh=this._myParams.myMesh:this._myLineMeshComponent.mesh=r.getDefaultMeshes(this._myParams.myParent.pp_getEngine()).myCylinder,this._myParams.myMaterial==null?this._myParams.myColor==null?this._myLineMeshComponent.material=r.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myMesh:(this._myFlatOpaqueMaterial==null&&(this._myFlatOpaqueMaterial=r.getDefaultMaterials(this._myParams.myParent.pp_getEngine()).myFlatOpaque.clone()),this._myLineMeshComponent.material=this._myFlatOpaqueMaterial,this._myFlatOpaqueMaterial.color=this._myParams.myColor):this._myLineMeshComponent.material=this._myParams.myMaterial}}();et.prototype.copy=function(e){this.myStart.vec3_copy(e.myStart),this.myDirection.vec3_copy(e.myDirection),this.myLength=e.myLength,this.myThickness=e.myThickness,this.myMesh=e.myMesh,e.myMaterial!=null?this.myMaterial=e.myMaterial.clone():this.myMaterial=null,e.myColor!=null?this.myColor!=null?this.myColor.vec4_copy(e.myColor):this.myColor=e.myColor.vec4_clone():this.myColor=null,this.myParent=e.myParent,this.myLocal=e.myLocal,this.myType=e.myType};var Ne=class{constructor(e=r.getMainEngine()){this.myStart=c(),this.myDirection=c(0,0,1),this.myLength=0,this.myThickness=.005,this.myArrowThickness=null,this.myArrowLength=null,this.myShareArrowLengthWithLineWhenArrowLongerThanLength=!0,this.myLineMesh=null,this.myArrowMesh=null,this.myMaterial=null,this.myColor=null,this.myParent=r.getSceneObjects(e).myVisualElements,this.myLocal=!1,this.myType=Me.ARROW}setStartEnd(e,t){return t.vec3_sub(e,this.myDirection),this.myLength=this.myDirection.vec3_length(),this.myDirection.vec3_normalize(this.myDirection),this.myStart.vec3_copy(e),this}copy(e){}},tt=class{constructor(e=new Ne){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myVisualLine=new ht(new et(this._myParams.myParent.pp_getEngine())),this._myVisualLine.setAutoRefresh(!1),this._myArrowParentObject=null,this._myArrowObject=null,this._myArrowMeshComponent=null,this._myFlatOpaqueMaterial=null,this._myDestroyed=!1,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){this._myVisible!=e&&(this._myVisible=e,this._myVisualLine.setVisible(e),this._myArrowParentObject.pp_setActive(e))}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh(),this._myVisualLine.forceRefresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1),this._myVisualLine.update(e)}_build(){this._myArrowParentObject=r.getSceneObjects(this._myParams.myParent.pp_getEngine()).myVisualElements.pp_addObject(),this._myArrowObject=this._myArrowParentObject.pp_addObject(),this._myArrowMeshComponent=this._myArrowObject.pp_addComponent(WE)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new Ne(this._myParams.myParent.pp_getEngine());e.copy(this._myParams);let t=new tt(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}_refresh(){}destroy(){this._myDestroyed=!0,this._myVisualLine.destroy(),this._myArrowParentObject.pp_destroy()}isDestroyed(){return this._myDestroyed}};tt.prototype._refresh=function(){let i=c(),e=c(),t=c(),n=c(0,1,0);return function(){this._myArrowParentObject.pp_setParent(this._myParams.myParent,!1);let s=this._myParams.myArrowThickness!=null?this._myParams.myArrowThickness:this._myParams.myThickness*1.5,a=this._myParams.myArrowLength!=null?this._myParams.myArrowLength:this._myParams.myThickness*3.5;this._myParams.myShareArrowLengthWithLineWhenArrowLongerThanLength&&a>this._myParams.myLength/2&&(a=this._myParams.myLength/2),a=Math.min(a,this._myParams.myLength),t.vec3_set(s,a/2,s);let l=this._myParams.myLength-a;this._myParams.myDirection.vec3_scale(l,i),i.vec3_add(this._myParams.myStart,i),this._myParams.myLocal?(this._myArrowParentObject.pp_setPositionLocal(i),this._myArrowParentObject.pp_setUpLocal(this._myParams.myDirection,n)):(this._myArrowParentObject.pp_setPosition(i),this._myArrowParentObject.pp_setUp(this._myParams.myDirection,n)),e.vec3_set(0,a/2-1e-5,0),this._myArrowParentObject.pp_translateObject(e),this._myParams.myLocal?this._myArrowObject.pp_setScaleLocal(t):this._myArrowObject.pp_setScale(t),this._myParams.myArrowMesh!=null?this._myArrowMeshComponent.mesh=this._myParams.myArrowMesh:this._myArrowMeshComponent.mesh=r.getDefaultMeshes(this._myParams.myParent.pp_getEngine()).myCone,this._myParams.myMaterial==null?this._myParams.myColor==null?this._myArrowMeshComponent.material=r.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myMesh:(this._myFlatOpaqueMaterial==null&&(this._myFlatOpaqueMaterial=r.getDefaultMaterials(this._myParams.myParent.pp_getEngine()).myFlatOpaque.clone()),this._myArrowMeshComponent.material=this._myFlatOpaqueMaterial,this._myFlatOpaqueMaterial.color=this._myParams.myColor):this._myArrowMeshComponent.material=this._myParams.myMaterial;let u=this._myVisualLine.getParams();u.myStart.vec3_copy(this._myParams.myStart),u.myDirection.vec3_copy(this._myParams.myDirection),u.myLength=l,u.myThickness=this._myParams.myThickness,u.myMesh=this._myParams.myLineMesh,u.myMaterial=this._myArrowMeshComponent.material,u.myParent=this._myParams.myParent,u.myLocal=this._myParams.myLocal,this._myVisualLine.paramsUpdated()}}();Ne.prototype.copy=function(e){this.myStart.vec3_copy(e.myStart),this.myDirection.vec3_copy(e.myDirection),this.myLength=e.myLength,this.myThickness=e.myThickness,this.myArrowThickness=e.myArrowThickness,this.myArrowLength=e.myArrowLength,this.myShareArrowLengthWithLineWhenArrowLongerThanLength=e.myShareArrowLengthWithLineWhenArrowLongerThanLength,this.myArrowMesh=e.myArrowMesh,this.myLineMesh=e.myLineMesh,e.myMaterial!=null?this.myMaterial=e.myMaterial.clone():this.myMaterial=null,e.myColor!=null?this.myColor!=null?this.myColor.vec4_copy(e.myColor):this.myColor=e.myColor.vec4_clone():this.myColor=null,this.myParent=e.myParent,this.myLocal=e.myLocal,this.myType=e.myType};import{MeshComponent as UE}from"@wonderlandengine/api";var ii=class{constructor(e=r.getMainEngine()){this.myTransform=be(),this.myMesh=null,this.myMaterial=null,this.myParent=r.getSceneObjects(e).myVisualElements,this.myLocal=!1,this.myType=Me.MESH}copy(e){}},Ci=class{constructor(e=new ii){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myMeshObject=null,this._myMeshComponent=null,this._myDestroyed=!1,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){this._myVisible!=e&&(this._myVisible=e,this._myMeshObject.pp_setActive(e))}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1)}_refresh(){this._myMeshObject.pp_setParent(this._myParams.myParent,!1),this._myParams.myLocal?this._myMeshObject.pp_setTransformLocal(this._myParams.myTransform):this._myMeshObject.pp_setTransform(this._myParams.myTransform),this._myParams.myMesh==null?this._myMeshComponent.mesh=r.getDefaultMeshes(this._myParams.myParent.pp_getEngine()).mySphere:this._myMeshComponent.mesh=this._myParams.myMesh,this._myParams.myMaterial==null?this._myMeshComponent.material=r.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myMesh:this._myMeshComponent.material=this._myParams.myMaterial}_build(){this._myMeshObject=r.getSceneObjects(this._myParams.myParent.pp_getEngine()).myVisualElements.pp_addObject(),this._myMeshComponent=this._myMeshObject.pp_addComponent(UE)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new ii(this._myParams.myParent.pp_getEngine());e.copy(this._myParams);let t=new Ci(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}destroy(){this._myDestroyed=!0,this._myMeshObject.pp_destroy()}isDestroyed(){return this._myDestroyed}};ii.prototype.copy=function(e){this.myTransform.pp_copy(e.myTransform),e.myMesh!=null?this.myMesh=e.myMesh:this.myMesh=null,e.myMaterial!=null?this.myMaterial=e.myMaterial.clone():this.myMaterial=null,this.myParent=e.myParent,this.myLocal=e.myLocal,this.myType=e.myType};import{MeshComponent as QE}from"@wonderlandengine/api";var xt=class{constructor(e=r.getMainEngine()){this.myPosition=c(),this.myRadius=.005,this.myMesh=null,this.myMaterial=null,this.myColor=null,this.myParent=r.getSceneObjects(e).myVisualElements,this.myLocal=!1,this.myType=Me.POINT}copy(e){}},kt=class{constructor(e=new xt){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myPointObject=null,this._myPointMeshComponent=null,this._myFlatOpaqueMaterial=null,this._myDestroyed=!1,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){this._myVisible!=e&&(this._myVisible=e,this._myPointObject.pp_setActive(e))}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1)}_build(){this._myPointObject=r.getSceneObjects(this._myParams.myParent.pp_getEngine()).myVisualElements.pp_addObject(),this._myPointMeshComponent=this._myPointObject.pp_addComponent(QE)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new xt(this._myParams.myParent.pp_getEngine());e.copy(this._myParams);let t=new kt(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}_refresh(){}destroy(){this._myDestroyed=!0,this._myPointObject.pp_destroy()}isDestroyed(){return this._myDestroyed}};kt.prototype._refresh=function(){let i=c(0,0,0);return function(){this._myPointObject.pp_setParent(this._myParams.myParent,!1),this._myParams.myLocal?(this._myPointObject.pp_setPositionLocal(this._myParams.myPosition),this._myPointObject.pp_setRotationLocal(i),this._myPointObject.pp_setScaleLocal(this._myParams.myRadius)):(this._myPointObject.pp_setPosition(this._myParams.myPosition),this._myPointObject.pp_setRotation(i),this._myPointObject.pp_setScale(this._myParams.myRadius)),this._myParams.myMesh!=null?this._myPointMeshComponent.mesh=this._myParams.myMesh:this._myPointMeshComponent.mesh=r.getDefaultMeshes(this._myParams.myParent.pp_getEngine()).mySphere,this._myParams.myMaterial==null?this._myParams.myColor==null?this._myPointMeshComponent.material=r.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myMesh:(this._myFlatOpaqueMaterial==null&&(this._myFlatOpaqueMaterial=r.getDefaultMaterials(this._myParams.myParent.pp_getEngine()).myFlatOpaque.clone()),this._myPointMeshComponent.material=this._myFlatOpaqueMaterial,this._myFlatOpaqueMaterial.color=this._myParams.myColor):this._myPointMeshComponent.material=this._myParams.myMaterial}}();xt.prototype.copy=function(e){this.myPosition.vec3_copy(e.myPosition),this.myRadius=e.myRadius,this.myMesh=e.myMesh,e.myMaterial!=null?this.myMaterial=e.myMaterial.clone():this.myMaterial=null,e.myColor!=null?this.myColor!=null?this.myColor.vec4_copy(e.myColor):this.myColor=e.myColor.vec4_clone():this.myColor=null,this.myParent=e.myParent,this.myLocal=e.myLocal,this.myType=e.myType};var xP=["0","1","2","3","4","5","6","7"];function MP(i){xP=i}function DP(){return xP}var EP=function(){let i=c(),e=c(),t=(n,o)=>n.pp_equals(o);return function(o,s=new Fe){let a=o.myPhysics.rayCast(o.myOrigin,o.myDirection,o.myBlockLayerFlags.getMask(),o.myDistance);s.myRaycastParams==null&&(s.myRaycastParams=new ct(o.myPhysics)),s.myRaycastParams.copy(o);let l=0,u=0,_=a.hitCount;if(_!=0){let m=null,h=null,d=null,g=null;e=o.myDirection.vec3_negate(e);for(let P=0;P<_;P++){if(o.myObjectsToIgnore.length!=0&&(m==null&&(m=a.objects),o.myObjectsToIgnore.pp_hasEqual(m[P],t)))continue;h==null&&(h=a.distances);let C=h[P]==0;if(C&&(d==null&&(d=a.locations),C&&=o.myOrigin.vec3_sub(d[P],i).vec3_isZero(Math.PP_EPSILON),C&&(g||(g=a.normals),C&&=e.vec3_equals(g[P],Math.PP_EPSILON_DEGREES))),!o.myIgnoreHitsInsideCollision||!C){let f=null;l<s.myHits.length?f=s.myHits[l]:s._myUnusedHits!=null&&s._myUnusedHits.length>0?(f=s._myUnusedHits.pop(),s.myHits.push(f)):(f=new mt,s.myHits.push(f)),m==null&&(m=a.objects),d==null&&(d=a.locations),g==null&&(g=a.normals),f.myPosition.vec3_copy(d[P]),f.myNormal.vec3_copy(g[P]),f.myDistance=h[P],f.myObject=m[P],f.myInsideCollision=C,u++,l++}}}if(s.myHits.length>u){s._myUnusedHits==null&&(s._myUnusedHits=[]);let m=s.myHits.length-u;for(let h=0;h<m;h++)s._myUnusedHits.push(s.myHits.pop())}return s}}(),De={setLayerFlagsNames:MP,getLayerFlagsNames:DP,raycast:EP};var Ve=class{constructor(){this._myLayerMask=0}setFlagActive(e,t){let n=e;if(isNaN(e)&&(n=De.getLayerFlagsNames().pp_findIndexEqual(e)),n>=0&&n<De.getLayerFlagsNames().length){let o=1<<n;t?this._myLayerMask=this._myLayerMask|o:this._myLayerMask=this._myLayerMask&~o}}isFlagActive(e){let t=e;isNaN(e)&&(t=De.getLayerFlagsNames().pp_findIndexEqual(e));let n=!1;if(t>=0&&t<De.getLayerFlagsNames().length){let o=1<<t;n=!!(this._myLayerMask&o)}return n}setAllFlagsActive(e){e?this._myLayerMask=Math.pow(2,De.getLayerFlagsNames().length)-1:this._myLayerMask=0}add(e){this._myLayerMask=this._myLayerMask|e.getMask()}remove(e){this._myLayerMask=this._myLayerMask&~e.getMask()}intersect(e){this._myLayerMask=this._myLayerMask&e.getMask()}copy(e){this._myLayerMask=e._myLayerMask}getMask(){return this._myLayerMask}setMask(e){this._myLayerMask=e}};var ct=class{constructor(e=r.getPhysics()){this.myOrigin=c(),this.myDirection=c(),this.myDistance=0,this.myBlockLayerFlags=new Ve,this.myObjectsToIgnore=[],this.myIgnoreHitsInsideCollision=!1,this.myPhysics=e}copy(e){this.myOrigin.vec3_copy(e.myOrigin),this.myDirection.vec3_copy(e.myDirection),this.myDistance=e.myDistance,this.myBlockLayerFlags.copy(e.myBlockLayerFlags),this.myObjectsToIgnore.pp_copy(e.myObjectsToIgnore),this.myIgnoreHitsInsideCollision=e.myIgnoreHitsInsideCollision,this.myPhysics=e.myPhysics}reset(){this.myOrigin.vec3_zero(),this.myDirection.vec3_zero(),this.myDistance=0,this.myBlockLayerFlags.setAllFlagsActive(!1),this.myObjectsToIgnore.pp_clear(),this.myIgnoreHitsInsideCollision=!1}},Fe=class{constructor(){this.myRaycastParams=null,this.myHits=[],this._myUnusedHits=null}isColliding(e=!1){return e?this.getFirstHitOutsideCollision()!=null:this.myHits.length>0}getFirstHitInsideCollision(){let e=null;for(let t of this.myHits)if(t.myInsideCollision){e=t;break}return e}getFirstHitOutsideCollision(){let e=null;for(let t of this.myHits)if(!t.myInsideCollision){e=t;break}return e}getHitsInsideCollision(){let e=[];for(let t of this.myHits)t.myInsideCollision&&e.push(t);return e}getHitsOutsideCollision(){let e=[];for(let t of this.myHits)t.myInsideCollision||e.push(t);return e}removeHit(e){let t=this.myHits.pp_removeIndex(e);return t!=null&&(this._myUnusedHits==null&&(this._myUnusedHits=[]),this._myUnusedHits.push(t)),t}removeAllHits(){this._myUnusedHits==null&&(this._myUnusedHits=[]),this._myUnusedHits.push(...this.myHits),this.myHits.pp_clear()}copy(e){}reset(){this.myRaycastParams!=null&&this.myRaycastParams.reset(),this.removeAllHits()}},mt=class{constructor(){this.myPosition=c(),this.myNormal=c(),this.myDistance=0,this.myObject=null,this.myInsideCollision=!1}isValid(){return this.myObject!=null}copy(e){this.myPosition.vec3_copy(e.myPosition),this.myNormal.vec3_copy(e.myNormal),this.myDistance=e.myDistance,this.myObject=e.myObject,this.myInsideCollision=e.myInsideCollision}reset(){this.myPosition.vec3_zero(),this.myNormal.vec3_zero(),this.myDistance=0,this.myObject=null,this.myInsideCollision=!1}};Fe.prototype.copy=function(){let i=function(e,t){return e==null&&(e=new mt),e.copy(t),e};return function(t){if(t.myRaycastParams==null?this.myRaycastParams=null:(this.myRaycastParams==null&&(this.myRaycastParams=new ct(t.myRaycastParams.myPhysics)),this.myRaycastParams.copy(t.myRaycastParams)),this.myHits.length>t.myHits.length){this._myUnusedHits==null&&(this._myUnusedHits=[]);for(let n=0;n<this.myHits.length-t.myHits.length;n++)this._myUnusedHits.push(this.myHits.pop())}else if(this.myHits.length<t.myHits.length&&this._myUnusedHits!=null){let n=Math.min(this._myUnusedHits.length,t.myHits.length-this.myHits.length);for(let o=0;o<n;o++)this.myHits.push(this._myUnusedHits.pop())}this.myHits.pp_copy(t.myHits,i)}}();var ni=class{constructor(e=r.getMainEngine()){this._myRaycastResults=new Fe,this.myHitNormalLength=.2,this.myThickness=.005,this.myShowOnlyFirstHit=!0,this.myRayMaterial=null,this.myHitNormalMaterial=null,this.myParent=r.getSceneObjects(e).myVisualElements,this.myLocal=!1,this.myType=Me.RAYCAST}get myRaycastResults(){return this._myRaycastResults}set myRaycastResults(e){this._myRaycastResults.copy(e)}copy(e){}},jn=class{constructor(e=new ni){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myVisualRaycast=new tt(new Ne(this._myParams.myParent.pp_getEngine())),this._myVisualRaycast.setAutoRefresh(!1),this._myVisualRaycastHitList=[],this._myDestroyed=!1,this._addVisualRaycastHit(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){if(this._myVisible!=e)if(this._myVisible=e,this._myVisible){if(this._myParams.myRaycastResults.myRaycastParams!=null&&this._myVisualRaycast.setVisible(!0),this._myParams.myRaycastResults.myHits.length>0){let t=Math.min(this._myParams.myRaycastResults.myHits.length,this._myVisualRaycastHitList.length);for(let n=0;n<t;n++)this._myVisualRaycastHitList[n].setVisible(!0)}}else{this._myVisualRaycast.setVisible(!1);for(let t of this._myVisualRaycastHitList)t.setVisible(!1)}}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){if(this._refresh(),this._myVisualRaycast.forceRefresh(),this._myParams.myRaycastResults.myHits.length>0){let e=Math.min(this._myParams.myRaycastResults.myHits.length,this._myVisualRaycastHitList.length);for(let t=0;t<e;t++)this._myVisualRaycastHitList[t].forceRefresh()}}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1),this._myVisualRaycast.update(e);for(let t of this._myVisualRaycastHitList)t.update(e)}_refresh(){for(let e of this._myVisualRaycastHitList)e.setVisible(!1);if(this._myParams.myRaycastResults.myHits.length>0){let e=this._myParams.myShowOnlyFirstHit?this._myParams.myRaycastResults.myHits.pp_first().myDistance:this._myParams.myRaycastResults.myHits.pp_last().myDistance;{let n=this._myVisualRaycast.getParams();n.myStart.vec3_copy(this._myParams.myRaycastResults.myRaycastParams.myOrigin),n.myDirection.vec3_copy(this._myParams.myRaycastResults.myRaycastParams.myDirection),n.myLength=e,n.myThickness=this._myParams.myThickness,this._myParams.myRayMaterial==null?n.myMaterial=r.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myRay:n.myMaterial=this._myParams.myRayMaterial,n.myParent=this._myParams.myParent,n.myLocal=this._myParams.myLocal,this._myVisualRaycast.paramsUpdated(),this._myVisualRaycast.setVisible(this._myVisible)}let t=this._myParams.myShowOnlyFirstHit?1:this._myParams.myRaycastResults.myHits.length;for(;t>this._myVisualRaycastHitList.length;)this._addVisualRaycastHit();for(let n=0;n<t;n++){let o=this._myVisualRaycastHitList[n];{let s=o.getParams();s.myStart.vec3_copy(this._myParams.myRaycastResults.myHits[n].myPosition),s.myDirection.vec3_copy(this._myParams.myRaycastResults.myHits[n].myNormal),s.myLength=this._myParams.myHitNormalLength,s.myThickness=this._myParams.myThickness,this._myParams.myHitNormalMaterial==null?s.myMaterial=r.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myHitNormal:s.myMaterial=this._myParams.myHitNormalMaterial,s.myParent=this._myParams.myParent,s.myLocal=this._myParams.myLocal,o.paramsUpdated(),o.setVisible(this._myVisible)}}}else if(this._myParams.myRaycastResults.myRaycastParams!=null){let e=this._myVisualRaycast.getParams();e.myStart.vec3_copy(this._myParams.myRaycastResults.myRaycastParams.myOrigin),e.myDirection.vec3_copy(this._myParams.myRaycastResults.myRaycastParams.myDirection),e.myLength=this._myParams.myRaycastResults.myRaycastParams.myDistance,e.myThickness=this._myParams.myThickness,this._myParams.myRayMaterial==null?e.myMaterial=r.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myRay:e.myMaterial=this._myParams.myRayMaterial,e.myParent=this._myParams.myParent,e.myLocal=this._myParams.myLocal,this._myVisualRaycast.paramsUpdated(),this._myVisualRaycast.setVisible(this._myVisible)}else this._myVisualRaycast.setVisible(!1)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new ni(this._myParams.myParent.pp_getEngine());e.copy(this._myParams);let t=new jn(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}_addVisualRaycastHit(){let e=new tt(new Ne(this._myParams.myParent.pp_getEngine()));e.setAutoRefresh(!1),e.setVisible(!1),this._myVisualRaycastHitList.push(e)}destroy(){this._myDestroyed=!0,this._myVisualRaycast.destroy();for(let e of this._myVisualRaycastHitList)e.destroy()}isDestroyed(){return this._myDestroyed}};ni.prototype.copy=function(e){this.myRaycastResults=e.myRaycastResults,this.myHitNormalLength=e.myHitNormalLength,this.myThickness=e.myThickness,this.myShowOnlyFirstHit=e.myShowOnlyFirstHit,e.myRayMaterial!=null?this.myRayMaterial=e.myRayMaterial.clone():this.myRayMaterial=null,e.myHitNormalMaterial!=null?this.myHitNormalMaterial=e.myHitNormalMaterial.clone():this.myHitNormalMaterial=null,this.myParent=e.myParent,this.myLocal=e.myLocal,this.myType=e.myType};import{Alignment as qE,Justification as XE,TextComponent as KE}from"@wonderlandengine/api";var Ft=class{constructor(e=r.getMainEngine()){this.myText="",this.myAlignment=qE.Center,this.myJustification=XE.Middle,this.myTransform=be(),this.myMaterial=null,this.myColor=null,this.myParent=r.getSceneObjects(e).myVisualElements,this.myLocal=!1,this.myLookAtObject=null,this.myType=Me.TEXT}copy(e){}},zi=class{constructor(e=new Ft){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myTextObject=null,this._myTextComponent=null,this._myTextMaterial=null,this._myDestroyed=!1,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){this._myVisible!=e&&(this._myVisible=e,this._myTextObject.pp_setActive(e))}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh()}update(e){(this._myDirty||this._myParams.myLookAtObject!=null)&&(this._refresh(),this._myDirty=!1)}_refresh(){}_build(){this._myTextObject=r.getSceneObjects(this._myParams.myParent.pp_getEngine()).myVisualElements.pp_addObject(),this._myTextComponent=this._myTextObject.pp_addComponent(KE)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new Ft(this._myParams.myParent.pp_getEngine());e.copy(this._myParams);let t=new zi(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}destroy(){this._myDestroyed=!0,this._myTextObject.pp_destroy()}isDestroyed(){return this._myDestroyed}};Ft.prototype.copy=function(e){this.myText=e.myText,this.myAlignment=e.myAlignment,this.myJustification=e.myJustification,this.myTransform.mat4_copy(e.myTransform),e.myMaterial!=null?this.myMaterial=e.myMaterial.clone():this.myMaterial=null,e.myColor!=null?this.myColor!=null?this.myColor.vec4_copy(e.myColor):this.myColor=e.myColor.vec4_clone():this.myColor=null,this.myParent=e.myParent,this.myLocal=e.myLocal,this.myLookAtObject=e.myLookAtObject,this.myType=e.myType};zi.prototype._refresh=function(){let i=c();return function(){this._myTextObject.pp_setParent(this._myParams.myParent,!1),this._myParams.myLocal?this._myTextObject.pp_setTransformLocal(this._myParams.myTransform):this._myTextObject.pp_setTransform(this._myParams.myTransform),this._myParams.myLookAtObject!=null&&(this._myParams.myLookAtObject.pp_getPosition(i),this._myTextObject.pp_lookAt(i)),this._myParams.myMaterial==null?this._myParams.myColor==null?this._myTextComponent.material=r.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myText:(this._myTextMaterial==null&&(this._myTextMaterial=r.getDefaultMaterials(this._myParams.myParent.pp_getEngine()).myText.clone()),this._myTextComponent.material=this._myTextMaterial,this._myTextMaterial.color=this._myParams.myColor):this._myTextComponent.material=this._myParams.myMaterial,this._myTextComponent.text=this._myParams.myText,this._myTextComponent.alignment=this._myParams.myAlignment,this._myTextComponent.justification=this._myParams.myJustification,this._myDirty=!1}}();var wt=class{constructor(e=r.getMainEngine()){this.myTransform=be(),this.myRadius=0,this.mySegmentsAmount=12,this.mySegmentThickness=.05,this.mySegmentMesh=null,this.myMaterial=null,this.myColor=null,this.myParent=r.getSceneObjects(e).myVisualElements,this.myLocal=!1,this.myType=Me.TORUS}copy(e){}},jt=class{constructor(e=new wt){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myTorusParentObject=null,this._myVisualSegmentList=[],this._myFlatOpaqueMaterial=null,this._myDestroyed=!1,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){if(this._myVisible!=e)if(this._myVisible=e,this._myVisible){let t=Math.min(this._myParams.mySegmentsAmount,this._myVisualSegmentList.length);for(let n=0;n<t;n++)this._myVisualSegmentList[n].setVisible(!0)}else for(let t of this._myVisualSegmentList)t.setVisible(!1)}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh();let e=Math.min(this._myParams.mySegmentsAmount,this._myVisualSegmentList.length);for(let t=0;t<e;t++)this._myVisualSegmentList[t].forceRefresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1);for(let t of this._myVisualSegmentList)t.update(e)}_build(){this._myTorusParentObject=r.getSceneObjects(this._myParams.myParent.pp_getEngine()).myVisualElements.pp_addObject(),this._fillSegmentList()}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}_fillSegmentList(){for(;this._myVisualSegmentList.length<this._myParams.mySegmentsAmount;){let e=new ht(new et(this._myParams.myParent.pp_getEngine()));e.setAutoRefresh(!1),e.setVisible(!1),e.getParams().myParent=this._myTorusParentObject,e.getParams().myLocal=!0,this._myVisualSegmentList.push(e)}}clone(){let e=new wt(this._myParams.myParent.pp_getEngine());e.copy(this._myParams);let t=new jt(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}_refresh(){}destroy(){this._myDestroyed=!0;for(let e of this._myVisualSegmentList)e.destroy();this._myTorusParentObject.pp_destroy()}isDestroyed(){return this._myDestroyed}};jt.prototype._refresh=function(){let i=c(),e=c(),t=c(),n=c(),o=c(),s=c(0,1,0);return function(){this._fillSegmentList();for(let u of this._myVisualSegmentList)u.setVisible(!1);this._myTorusParentObject.pp_setParent(this._myParams.myParent,!1),this._myParams.myLocal?this._myTorusParentObject.pp_setTransformLocal(this._myParams.myTransform):this._myTorusParentObject.pp_setTransform(this._myParams.myTransform);let l=2*Math.PI/this._myParams.mySegmentsAmount;i.vec3_set(this._myParams.myRadius,0,0);for(let u=0;u<this._myParams.mySegmentsAmount;u++){e=i.vec3_rotateAxisRadians(l,s,e),t=e.vec3_sub(i,t).vec3_normalize(t);let _=Math.tan(l/2)*this._myParams.mySegmentThickness/2;n=i.vec3_sub(t.vec3_scale(_,n),n),o=e.vec3_add(t.vec3_scale(_,o),o);let m=this._myVisualSegmentList[u],h=m.getParams();h.setStartEnd(n,o),h.myThickness=this._myParams.mySegmentThickness,h.myMesh=this._myParams.mySegmentMesh,this._myParams.myMaterial==null?this._myParams.myColor==null?h.myMaterial=r.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myMesh:(this._myFlatOpaqueMaterial==null&&(this._myFlatOpaqueMaterial=r.getDefaultMaterials(this._myParams.myParent.pp_getEngine()).myFlatOpaque.clone()),h.myMaterial=this._myFlatOpaqueMaterial,this._myFlatOpaqueMaterial.color=this._myParams.myColor):h.myMaterial=this._myParams.myMaterial,m.paramsUpdated(),m.setVisible(this._myVisible),i.vec3_copy(e)}}}();wt.prototype.copy=function(e){this.myRadius=e.myRadius,this.mySegmentsAmount=e.mySegmentsAmount,this.mySegmentThickness=e.mySegmentThickness,this.myTransform.mat4_copy(e.myTransform),this.mySegmentMesh=e.mySegmentMesh,e.myMaterial!=null?this.myMaterial=e.myMaterial.clone():this.myMaterial=null,e.myColor!=null?this.myColor!=null?this.myColor.vec4_copy(e.myColor):this.myColor=e.myColor.vec4_clone():this.myColor=null,this.myParent=e.myParent,this.myLocal=e.myLocal,this.myType=e.myType};var Rt=class{constructor(e=r.getMainEngine()){this.myTransform=be(),this.myLength=.2,this.myThickness=.005,this.myForwardMaterial=null,this.myUpMaterial=null,this.myRightMaterial=null,this.myParent=r.getSceneObjects(e).myVisualElements,this.myLocal=!1,this.myType=Me.TRANSFORM}copy(e){}},oi=class{constructor(e=new Rt){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myVisualRight=new tt(new Ne(this._myParams.myParent.pp_getEngine())),this._myVisualUp=new tt(new Ne(this._myParams.myParent.pp_getEngine())),this._myVisualForward=new tt(new Ne(this._myParams.myParent.pp_getEngine())),this._myVisualRight.setAutoRefresh(!1),this._myVisualUp.setAutoRefresh(!1),this._myVisualForward.setAutoRefresh(!1),this._myDestroyed=!1,this.forceRefresh(),this.setVisible(!0)}setVisible(e){this._myVisible!=e&&(this._myVisible=e,this._myVisualRight.setVisible(e),this._myVisualUp.setVisible(e),this._myVisualForward.setVisible(e))}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh(),this._myVisualRight.forceRefresh(),this._myVisualUp.forceRefresh(),this._myVisualForward.forceRefresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1),this._myVisualRight.update(e),this._myVisualUp.update(e),this._myVisualForward.update(e)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new Rt(this._myParams.myParent.pp_getEngine());e.copy(this._myParams);let t=new oi(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}_refresh(){}destroy(){this._myDestroyed=!0,this._myVisualRight.destroy(),this._myVisualUp.destroy(),this._myVisualForward.destroy()}isDestroyed(){return this._myDestroyed}};oi.prototype._refresh=function(){let i=[c(),c(),c()],e=c(),t=c();return function(){i=this._myParams.myTransform.mat4_getAxes(i),e=this._myParams.myTransform.mat4_getScale(e);let o=0;for(let s of e)o=Math.max(s,o);o==0?(e[0]=1,e[1]=1,e[2]=1):(e[0]=e[0]/o,e[1]=e[1]/o,e[2]=e[2]/o),t=this._myParams.myTransform.mat4_getPosition(t);{let s=this._myVisualRight.getParams();s.myStart.vec3_copy(t),s.myDirection=i[0].vec3_negate(s.myDirection).vec3_normalize(s.myDirection),s.myLength=Math.max(this._myParams.myLength*e[0],.001),s.myThickness=this._myParams.myThickness,this._myParams.myRightMaterial==null?s.myMaterial=r.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myRight:s.myMaterial=this._myParams.myRightMaterial,s.myParent=this._myParams.myParent,s.myLocal=this._myParams.myLocal,this._myVisualRight.paramsUpdated()}{let s=this._myVisualUp.getParams();s.myStart.vec3_copy(t),s.myDirection=i[1].vec3_normalize(s.myDirection),s.myLength=Math.max(this._myParams.myLength*e[1],.001),s.myThickness=this._myParams.myThickness,this._myParams.myUpMaterial==null?s.myMaterial=r.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myUp:s.myMaterial=this._myParams.myUpMaterial,s.myParent=this._myParams.myParent,s.myLocal=this._myParams.myLocal,this._myVisualUp.paramsUpdated()}{let s=this._myVisualForward.getParams();s.myStart.vec3_copy(t),s.myDirection=i[2].vec3_normalize(s.myDirection),s.myLength=Math.max(this._myParams.myLength*e[2],.001),s.myThickness=this._myParams.myThickness,this._myParams.myForwardMaterial==null?s.myMaterial=r.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myForward:s.myMaterial=this._myParams.myForwardMaterial,s.myParent=this._myParams.myParent,s.myLocal=this._myParams.myLocal,this._myVisualForward.paramsUpdated()}}}();Rt.prototype.copy=function(e){this.myTransform.mat4_copy(e.myTransform),this.myLength=e.myLength,this.myThickness=e.myThickness,e.myRightMaterial!=null?this.myRightMaterial=e.myRightMaterial.clone():this.myRightMaterial=null,e.myUpMaterial!=null?this.myUpMaterial=e.myUpMaterial.clone():this.myUpMaterial=null,e.myForwardMaterial!=null?this.myForwardMaterial=e.myForwardMaterial.clone():this.myForwardMaterial=null,this.myParent=e.myParent,this.myLocal=e.myLocal,this.myType=e.myType};var zn=class{constructor(e=r.getMainEngine()){this._myEngine=e,this._myVisualElementPrototypeCreationCallbacks=new Map,this._myVisualElementsTypeMap=new Map,this._myVisualElementLastID=0,this._myVisualElementsToShow=[],this._myActive=!0,this._myDestroyed=!1,this._myObjectPoolManagerPrefix=this._getClassName()+"_"+Math.pp_randomUUID()+"_visual_element_type_",this._myTypePoolIDs=new Map,this._addStandardVisualElementTypes()}setActive(e){this._myActive!=e&&(this._myActive=e,this._myActive||this.clearVisualElement())}isActive(){return this._myActive}start(){}update(e){this._myActive&&this._updateDraw(e)}draw(e,t=0,n=null){if(!this._myActive)return 0;let o=null,s=!1;if(n!=null&&this._myVisualElementsTypeMap.has(e.myType)){let u=this._myVisualElementsTypeMap.get(e.myType);u.has(n)&&(o=u.get(n)[0],o.copyParams(e),o.setVisible(!1),s=!0)}if(o==null&&(o=this._getVisualElementFromPool(e)),o==null)return console.error("Couldn't create the requested visual element"),null;this._myVisualElementsTypeMap.has(e.myType)||this._myVisualElementsTypeMap.set(e.myType,new Map);let a=this._myVisualElementsTypeMap.get(e.myType),l=null;if(!s)l=this._myVisualElementLastID+1,this._myVisualElementLastID=l,a.set(l,[o,new ne(t,t!=null)]);else{l=n;let u=a.get(l);u[0]=o,u[1].reset(t),t!=null&&u[1].start()}return this._myVisualElementsToShow.push(o),l}getVisualElement(e){let t=null;for(let n of this._myVisualElementsTypeMap.values())if(n.has(e)){t=n.get(e)[0];break}return t}getVisualElementParams(e){return this.getVisualElement(e).getParams()}getVisualElementID(e){let t=null;for(let n of this._myVisualElementsTypeMap.values()){for(let[o,s]of n.entries())if(s[0]==e){t=o;break}if(t!=null)break}return t}clearVisualElement(e=null){if(e==null){for(let t of this._myVisualElementsTypeMap.values())for(let n of t.values())this._releaseElement(n[0]);this._myVisualElementsToShow=[],this._myVisualElementsTypeMap=new Map,this._myVisualElementLastID=0}else for(let t of this._myVisualElementsTypeMap.values())if(t.has(e)){let n=t.get(e);this._releaseElement(n[0]),t.delete(e),this._myVisualElementsToShow.pp_removeEqual(n[0]);break}}allocateVisualElementType(e,t){r.getObjectPoolManager(this._myEngine).hasPool(this._getTypePoolID(e))||this._addVisualElementTypeToPool(e);let n=r.getObjectPoolManager(this._myEngine).getPool(this._getTypePoolID(e)),o=n.getAvailableSize()-t;o<0&&n.increase(-o)}addVisualElementType(e,t){this._myVisualElementPrototypeCreationCallbacks.set(e,t)}removeVisualElementType(e){this._myVisualElementPrototypeCreationCallbacks.delete(e)}_updateDraw(e){for(let t of this._myVisualElementsToShow)t.setVisible(!0);this._myVisualElementsToShow.pp_clear();for(let t of this._myVisualElementsTypeMap.values()){let n=[];for(let o of t.entries()){let s=o[1];s[1].isDone()?(this._releaseElement(s[0]),n.push(o[0])):(s[0].update(e),s[1].update(e))}for(let o of n)t.delete(o)}}_getVisualElementFromPool(e){let t=null;return r.getObjectPoolManager(this._myEngine).hasPool(this._getTypePoolID(e.myType))||this._addVisualElementTypeToPool(e.myType),t=r.getObjectPoolManager(this._myEngine).get(this._getTypePoolID(e.myType)),t?.copyParams(e),t}_addVisualElementTypeToPool(e){let t=new Fn;t.myInitialPoolSize=10,t.myAmountToAddWhenEmpty=0,t.myPercentageToAddWhenEmpty=.5,t.mySetActiveCallback=function(o,s){o.setVisible(s)};let n=null;this._myVisualElementPrototypeCreationCallbacks.has(e)&&(n=this._myVisualElementPrototypeCreationCallbacks.get(e)()),n!=null?(n.setVisible(!1),n.setAutoRefresh(!0),r.getObjectPoolManager(this._myEngine).addPool(this._getTypePoolID(e),new wn(n,t))):console.error("Visual element type not supported")}_addStandardVisualElementTypes(){this.addVisualElementType(Me.LINE,()=>new ht(new et(this._myEngine))),this.addVisualElementType(Me.MESH,()=>new Ci(new ii(this._myEngine))),this.addVisualElementType(Me.POINT,()=>new kt(new xt(this._myEngine))),this.addVisualElementType(Me.ARROW,()=>new tt(new Ne(this._myEngine))),this.addVisualElementType(Me.TEXT,()=>new zi(new Ft(this._myEngine))),this.addVisualElementType(Me.TRANSFORM,()=>new oi(new Rt(this._myEngine))),this.addVisualElementType(Me.RAYCAST,()=>new jn(new ni(this._myEngine))),this.addVisualElementType(Me.TORUS,()=>new jt(new wt(this._myEngine)))}_getTypePoolID(e){let t=this._myTypePoolIDs.get(e);return t==null&&(t=this._myObjectPoolManagerPrefix+e,this._myTypePoolIDs.set(e,t)),t}_releaseElement(e){let t=r.getSceneObjects(this._myEngine).myVisualElements;e.getParams().myParent!=t&&(e.getParams().myParent=t,e.forceRefresh()),r.getObjectPoolManager(this._myEngine).release(this._getTypePoolID(e.getParams().myType),e)}_getClassName(){return"visual_manager"}destroy(){this._myDestroyed=!0;for(let e of this._myTypePoolIDs.values())r.getObjectPoolManager(this._myEngine)?.removePool(e)}isDestroyed(){return this._myDestroyed}};var cs=class{constructor(){this.myDefaultMaterials=new Dr}},Dr=class{constructor(){this.myMesh=null,this.myText=null,this.myRight=null,this.myUp=null,this.myForward=null,this.myRay=null,this.myHitNormal=null}};var $t=class extends JE{init(){this._myVisualManager=null,r.hasVisualManager(this.engine)||(this._myVisualManager=new zn(this.engine),r.setVisualManager(this._myVisualManager,this.engine)),r.hasVisualResources(this.engine)||(this._myVisualResources=new cs,r.setVisualResources(this._myVisualResources,this.engine))}start(){this._myVisualResources!=null&&(this._myVisualResources.myDefaultMaterials.myMesh=r.getDefaultMaterials(this.engine).myFlatOpaque.clone(),this._myVisualResources.myDefaultMaterials.myText=r.getDefaultMaterials(this.engine).myText.clone(),this._myVisualResources.myDefaultMaterials.myRight=r.getDefaultMaterials(this.engine).myFlatOpaque.clone(),this._myVisualResources.myDefaultMaterials.myRight.color=F(1,0,0,1),this._myVisualResources.myDefaultMaterials.myUp=r.getDefaultMaterials(this.engine).myFlatOpaque.clone(),this._myVisualResources.myDefaultMaterials.myUp.color=F(0,1,0,1),this._myVisualResources.myDefaultMaterials.myForward=r.getDefaultMaterials(this.engine).myFlatOpaque.clone(),this._myVisualResources.myDefaultMaterials.myForward.color=F(0,0,1,1),this._myVisualResources.myDefaultMaterials.myRay=r.getDefaultMaterials(this.engine).myFlatOpaque.clone(),this._myVisualResources.myDefaultMaterials.myRay.color=F(0,1,0,1),this._myVisualResources.myDefaultMaterials.myHitNormal=r.getDefaultMaterials(this.engine).myFlatOpaque.clone(),this._myVisualResources.myDefaultMaterials.myHitNormal.color=F(1,0,0,1)),this.myVisualManager!=null&&this.myVisualManager.start()}update(e){this.myVisualManager!=null&&this.myVisualManager.update(e)}onDestroy(){this._myVisualManager!=null&&r.getVisualManager(this.engine)==this._myVisualManager&&(r.removeVisualManager(this.engine),this._myVisualManager.destroy()),this._myVisualResources!=null&&r.getVisualResources(this.engine)==this._myVisualResources&&r.removeVisualResources(this.engine)}};R($t,"TypeName","pp-visual-manager"),R($t,"Properties",{});import*as ZE from"@wonderlandengine/api";import{Component as YE,Property as $E}from"@wonderlandengine/api";import*as eA from"@wonderlandengine/components";var ci=class extends YE{init(){this._myAdd&&(r.getWindow(this.engine).WL={},this._addProperties(ZE),this._addProperties(eA))}_addProperties(e){let t=Object.getOwnPropertyNames(e);for(let n of t)e[n]!=null&&(r.getWindow(this.engine).WL[n]=e[n])}onDestroy(){r.getWindow(this.engine).WL=void 0}};R(ci,"TypeName","pp-add-wl-to-window"),R(ci,"Properties",{_myAdd:$E.bool(!0)});import{Component as tA}from"@wonderlandengine/api";import{Alignment as AP,Justification as RP}from"@wonderlandengine/api";var Ni=class extends zn{constructor(e){super(e),this._myDefaultColor=F(1,0,1,1),this._myDefaultLineThickness=.005,this._myDefaultPointRadius=.01,this._myDefaultAxisLength=.2,this._myDefaultTextLookAtPlayer=!0,this._myDefaultTextAlignment=AP.Center,this._myDefaultTextJustification=RP.Middle,this._myDefaultUITextAlignment=AP.Center,this._myDefaultUITextJustification=RP.Middle,this._myDefaultUITextScale=1,this._myDefaultUITextScreenPosition=c(1,1,1)}drawLine(e,t,n,o,s=this._myDefaultColor,a=this._myDefaultLineThickness){if(this.isActive()){let l=new et(this._myEngine);l.myStart.vec3_copy(t),l.myDirection.vec3_copy(n),l.myLength=o,l.myThickness=a,l.myColor=F(),l.myColor.vec4_copy(s),this.draw(l,e)}}drawLineEnd(e,t,n,o=this._myDefaultColor,s=this._myDefaultLineThickness){}drawArrow(e,t,n,o,s=this._myDefaultColor,a=this._myDefaultLineThickness){if(this.isActive()){let l=new Ne(this._myEngine);l.myStart.vec3_copy(t),l.myDirection.vec3_copy(n),l.myLength=o,l.myThickness=a,l.myColor=F(),l.myColor.vec4_copy(s),this.draw(l,e)}}drawArrowEnd(e,t,n,o=this._myDefaultColor,s=this._myDefaultLineThickness){}drawPoint(e,t,n=this._myDefaultColor,o=this._myDefaultPointRadius){if(this.isActive()){let s=new xt(this._myEngine);s.myPosition.vec3_copy(t),s.myRadius=o,s.myColor=F(),s.myColor.vec4_copy(n),this.draw(s,e)}}drawText(e,t,n,o=this._myDefaultColor,s=this._myDefaultTextLookAtPlayer,a=this._myDefaultTextAlignment,l=this._myDefaultTextJustification){if(this.isActive()){let u=new Ft(this._myEngine);u.myText=t,u.myAlignment=a,u.myJustification=l,u.myTransform.mat4_copy(n),u.myColor=F(),u.myColor.vec4_copy(o),s&&(u.myLookAtObject=r.getPlayerObjects(this._myEngine).myHead),this.draw(u,e)}}drawRaycast(e,t,n=!0,o=this._myDefaultAxisLength,s=this._myDefaultLineThickness){if(this.isActive()){let a=new ni(this._myEngine);a.myRaycastResults=t,a.myShowOnlyFirstHit=n,a.myHitNormalLength=o,a.myThickness=s,this.draw(a,e)}}drawTransform(e,t,n=this._myDefaultAxisLength,o=this._myDefaultLineThickness){if(this.isActive()){let s=new Rt(this._myEngine);s.myTransform.mat4_copy(t),s.myLength=n,s.myThickness=o,this.draw(s,e)}}drawUIText(e,t,n,o=this._myDefaultUITextScale,s=this._myDefaultColor,a=this._myDefaultUITextAlignment,l=this._myDefaultUITextJustification){}_getClassName(){return"debug_visual_manager"}};Ni.prototype.drawLineEnd=function(){let i=c();return function(t,n,o,s=this._myDefaultColor,a=this._myDefaultLineThickness){if(this.isActive()){i=o.vec3_sub(n,i);let l=i.vec3_length();i.vec3_normalize(i),this.drawLine(t,n,i,l,s,a)}}}();Ni.prototype.drawArrowEnd=function(){let i=c();return function(t,n,o,s=this._myDefaultColor,a=this._myDefaultLineThickness){if(this.isActive()){i=o.vec3_sub(n,i);let l=i.vec3_length();i.vec3_normalize(i),this.drawArrow(t,n,i,l,s,a)}}}();Ni.prototype.drawUIText=function(){let i=j(),e=c(0,1,0),t=c(),n=c(-.12*1,.12*1,.35),o=c(-.27*1.15,.13*1.05,.35),s=c(),a=c(),l=c();return function(_,m,h=this._myDefaultUITextScreenPosition,d=this._myDefaultUITextScale,g=this._myDefaultColor,P=this._myDefaultUITextAlignment,C=this._myDefaultUITextJustification){if(this.isActive()){let f=new Ft(this._myEngine);f.myText=m,f.myAlignment=P,f.myJustification=C,f.myColor=F(),f.myColor.vec4_copy(g);let S=.2;I.isSessionActive(this._myEngine)?(f.myTransform.mat4_setPositionRotationScale(n.vec3_mul(h,s),a.vec3_set(0,180,0),l.vec3_set(S*d,S*d,S*d)),t=f.myTransform.mat4_getPosition(t).vec3_negate(t).vec3_normalize(t),i=f.myTransform.mat4_getRotationQuat(i),i.quat_setForward(t,e,i),f.myTransform.mat4_setRotationQuat(i)):f.myTransform.mat4_setPositionRotationScale(o.vec3_mul(h,s),a.vec3_set(0,180,0),l.vec3_set(S*d,S*d,S*d)),f.myParent=r.getPlayerObjects(this._myEngine).myHeadDebugs,f.myLocal=!0,this.draw(f,_)}}}();var ps=class{constructor(e=r.getMainEngine()){this._myEngine=e,this._myDebugVisualManager=new Ni(this._myEngine),this._myDestroyed=!1}getDebugVisualManager(){return this._myDebugVisualManager}start(){this._myDebugVisualManager.start()}update(e){this._myDebugVisualManager.setActive(r.isDebugEnabled(this._myEngine)),this._myDebugVisualManager.update(e)}destroy(){this._myDestroyed=!0,this._myDebugVisualManager.destroy()}isDestroyed(){return this._myDestroyed}};var ei=class extends tA{init(){this._myDebugManager=null,r.hasDebugManager(this.engine)||(this._myDebugManager=new ps(this.engine),r.setDebugManager(this._myDebugManager,this.engine))}start(){this._myDebugManager!=null&&this._myDebugManager.start()}update(e){this._myDebugManager!=null&&this._myDebugManager.update(e)}onDestroy(){this._myDebugManager!=null&&r.getDebugManager(this.engine)==this._myDebugManager&&(r.removeDebugManager(this.engine),this._myDebugManager.destroy())}};R(ei,"TypeName","pp-debug-manager"),R(ei,"Properties",{});import{Component as iA,Property as nA}from"@wonderlandengine/api";var pi=class extends iA{init(){this._myDebugEnabled=null,r.hasDebugEnabled(this.engine)||(this._myDebugEnabled=this._myEnable,r.setDebugEnabled(this._myDebugEnabled,this.engine))}onDestroy(){this._myDebugEnabled!=null&&r.isDebugEnabled(this.engine)==this._myDebugEnabled&&r.removeDebugEnabled(this.engine)}};R(pi,"TypeName","pp-enable-debug"),R(pi,"Properties",{_myEnable:nA.bool(!0)});import{Component as sA,Property as Wl}from"@wonderlandengine/api";var E={SELECT:0,SQUEEZE:1,TOUCHPAD:2,THUMBSTICK:3,BOTTOM_BUTTON:4,TOP_BUTTON:5,THUMB_REST:6},re={PRESS_START:0,PRESS_END:1,PRESSED:2,NOT_PRESSED:3,TOUCH_START:4,TOUCH_END:5,TOUCHED:6,NOT_TOUCHED:7,VALUE_CHANGED:8,ALWAYS:9},oe={THUMBSTICK:0},si={X_CHANGED:0,Y_CHANGED:1,AXES_CHANGED:2,ALWAYS:3},Nn=class{constructor(e,t){this.myID=e,this.myHandedness=t,this.myPressed=!1,this.myPrevIsPressed=!1,this.myTouched=!1,this.myPrevIsTouched=!1,this.myValue=0,this.myPrevValue=0,this.myTimePressed=0,this.myPrevTimePressed=0,this.myTimeNotPressed=0,this.myPrevTimeNotPressed=0,this.myTimeTouched=0,this.myPrevTimeTouched=0,this.myTimeNotTouched=0,this.myPrevTimeNotTouched=0,this.myMultiplePressStartCount=0,this.myPrevMultiplePressStartCount=0,this.myMultiplePressEndCount=0,this.myPrevMultiplePressEndCount=0,this.myMultipleTouchStartCount=0,this.myPrevMultipleTouchStartCount=0,this.myMultipleTouchEndCount=0,this.myPrevMultipleTouchEndCount=0}getID(){return this.myID}getHandedness(){return this.myHandedness}getValue(){return this.myValue}isPressed(){return this.myPressed}isTouched(){return this.myTouched}isPressStart(e=null){return this.myPressed&&!this.myPrevIsPressed&&(e==null||this.myMultiplePressStartCount==e)}isPressEnd(e=null){return!this.myPressed&&this.myPrevIsPressed&&(e==null||this.myMultiplePressEndCount==e)}isTouchStart(e=null){return this.myTouched&&!this.myPrevIsTouched&&(e==null||this.myMultipleTouchStartCount==e)}isTouchEnd(e=null){return!this.myTouched&&this.myPrevIsTouched&&(e==null||this.myMultipleTouchEndCount==e)}clone(){let e=new Nn(this.myID,this.myHandedness);return e.myPressed=this.myPressed,e.myPrevIsPressed=this.myPrevIsPressed,e.myTouched=this.myTouched,e.myPrevIsTouched=this.myPrevIsTouched,e.myValue=this.myValue,e.myPrevValue=this.myPrevValue,e.myTimePressed=this.myTimePressed,e.myPrevTimePressed=this.myPrevTimePressed,e.myTimeNotPressed=this.myTimeNotPressed,e.myPrevTimeNotPressed=this.myPrevTimeNotPressed,e.myTimeTouched=this.myTimeTouched,e.myPrevTimeTouched=this.myPrevTimeTouched,e.myTimeNotTouched=this.myTimeNotTouched,e.myPrevTimeNotTouched=this.myPrevTimeNotTouched,e.myMultiplePressStartCount=this.myMultiplePressStartCount,e.myPrevMultiplePressStartCount=this.myPrevMultiplePressStartCount,e.myMultiplePressEndCount=this.myMultiplePressEndCount,e.myPrevMultiplePressEndCount=this.myPrevMultiplePressEndCount,e.myMultipleTouchStartCount=this.myMultipleTouchStartCount,e.myPrevMultipleTouchStartCount=this.myPrevMultipleTouchStartCount,e.myMultipleTouchEndCount=this.myMultipleTouchEndCount,e.myPrevMultipleTouchEndCount=this.myPrevMultipleTouchEndCount,e}},Gn=class{constructor(e,t){this.myID=e,this.myHandedness=t,this.myAxes=Ae(0,0),this.myPrevAxes=Ae(0,0)}getID(){return this.myID}getAxes(){return this.myAxes}getHandedness(){return this.myHandedness}clone(){let e=new Gn(this.myID,this.myHandedness);return e.myAxes.vec2_copy(this.myAxes),e.myPrevAxes.vec2_copy(this.myPrevAxes),e}},Wn=class{constructor(){this.myIntensity=0,this.myDuration=0,this.myDevicePulsing=!1}clone(){let e=new Wn;return e.myIntensity=this.myIntensity,e.myDuration=this.myDuration,e.myDevicePulsing=this.myDevicePulsing,e}};var zt=class{constructor(e){this._myHandPose=e,this._myManagingHandPose=!1,this._myDestroyed=!1}getHandedness(){return this.getHandPose().getHandedness()}getHandPose(){return this._myHandPose}getEngine(){return this.getHandPose().getEngine()}isGamepadCoreActive(){return!0}setManageHandPose(e){this._myManagingHandPose=e}isManagingHandPose(){return this._myManagingHandPose}start(){this.getHandPose()&&this.isManagingHandPose()&&this.getHandPose().start(),this._startHook()}preUpdate(e){this.getHandPose()&&this.isManagingHandPose()&&this.getHandPose().update(e),this._preUpdateHook(e)}postUpdate(e){this._postUpdateHook(e)}getButtonData(e){return this._createButtonData()}getAxesData(e){return this._createAxesData()}getHapticActuators(){return[]}_startHook(){}_preUpdateHook(e){}_postUpdateHook(e){}_destroyHook(){}_createButtonData(){return{myPressed:!1,myTouched:!1,myValue:0}}_createAxesData(){return Ae(0,0)}destroy(){this._myDestroyed=!0,this._destroyHook(),this.isManagingHandPose()&&this.getHandPose().destroy()}isDestroyed(){return this._myDestroyed}};var xo=class extends zt{constructor(e,t){super(t),this._myGamepadIndex=e,this._myCurrentGamepads=window.navigator.getGamepads(),this._myButtonData=this._createButtonData(),this._myAxesData=this._createAxesData(),this._myHapticActuators=[]}_preUpdateHook(e){this._myCurrentGamepads=window.navigator.getGamepads()}isGamepadCoreActive(){let e=this._getClassicGamepad();return e!=null&&(e.connected==null||e.connected)}getButtonData(e){this._myButtonData.myPressed=!1,this._myButtonData.myTouched=!1,this._myButtonData.myValue=0;let t=this._getClassicGamepad();if(t!=null&&this.isGamepadCoreActive()){let n=null;if(this.getHandedness()==A.LEFT)switch(e){case E.SELECT:n=t.buttons[4];break;case E.SQUEEZE:n=t.buttons[6];break;case E.TOUCHPAD:n=null;break;case E.THUMBSTICK:n=t.buttons[10];break;case E.BOTTOM_BUTTON:n=t.buttons[13];break;case E.TOP_BUTTON:n=t.buttons[12];break;case E.THUMB_REST:n=null;break}else switch(e){case E.SELECT:n=t.buttons[5];break;case E.SQUEEZE:n=t.buttons[7];break;case E.TOUCHPAD:n=null;break;case E.THUMBSTICK:n=t.buttons[11];break;case E.BOTTOM_BUTTON:n=t.buttons[0];break;case E.TOP_BUTTON:n=t.buttons[3];break;case E.THUMB_REST:n=null;break}n!=null&&(this._myButtonData.myPressed=n.pressed,this._myButtonData.myTouched=n.touched,this._myButtonData.myValue=n.value)}return this._myButtonData}getAxesData(e){this._myAxesData.vec2_zero();let t=this._getClassicGamepad();return t!=null&&this.isGamepadCoreActive()&&(this.getHandedness()==A.LEFT?(this._myAxesData[0]=t.axes[0],this._myAxesData[1]=t.axes[1]):(this._myAxesData[0]=t.axes[2],this._myAxesData[1]=t.axes[3]),this._myAxesData[1]=-this._myAxesData[1]),this._myAxesData}getHapticActuators(){this._myHapticActuators.pp_clear();let e=this._getClassicGamepad();return e!=null&&this.isGamepadCoreActive()&&(e.hapticActuators!=null&&e.hapticActuators.length>0&&this._myHapticActuators.push(...e.hapticActuators),e.vibrationActuator!=null&&this._myHapticActuators.push(e.vibrationActuator)),this._myHapticActuators}_getClassicGamepad(){let e=null;if(this._myGamepadIndex!=null)this._myGamepadIndex<this._myCurrentGamepads.length&&(e=this._myCurrentGamepads[this._myGamepadIndex]);else for(let t of this._myCurrentGamepads)if(t!=null&&(t.connected==null||t.connected)){e=t;break}return e}};var ee={_0:"0",_1:"1",_2:"2",_3:"3",_4:"4",_5:"5",_6:"6",_7:"7",_8:"8",_9:"9",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z",a:"a",b:"b",c:"c",d:"d",e:"e",f:"f",g:"g",h:"h",i:"i",j:"j",k:"k",l:"l",m:"m",n:"n",o:"o",p:"p",q:"q",r:"r",s:"s",t:"t",u:"u",v:"v",w:"w",x:"x",y:"y",z:"z",UP:"ArrowUp",DOWN:"ArrowDown",LEFT:"ArrowLeft",RIGHT:"ArrowRight",SPACE:" ",ENTER:"Enter",BACKSPACE:"Backspace",ESC:"Escape",SHIFT_LEFT:"ShiftLeft",SHIFT_RIGHT:"ShiftRight",CONTROL_LEFT:"ControlLeft",CONTROL_RIGHT:"ControlRight",ALT_LEFT:"AltLeft",ALT_RIGHT:"AltRight"},ds=class{constructor(e=r.getMainEngine()){this._myEngine=e,this._myKeyInfos=new Map;for(let t in ee)this.addKey(ee[t]);this._myOnKeyDownEventListener=null,this._myOnKeyUpEventListener=null,this._myDestroyed=!1}isKeyPressed(e){let t=!1;return this._myKeyInfos.has(e)&&(t=this._myKeyInfos.get(e).myPressed),t}isKeyPressStart(e){let t=!1;return this._myKeyInfos.has(e)&&(t=this._myKeyInfos.get(e).myPressStart),t}isKeyPressEnd(e){let t=!1;return this._myKeyInfos.has(e)&&(t=this._myKeyInfos.get(e).myPressEnd),t}addKey(e){this._myKeyInfos.set(e,this._createKeyInfo())}start(){this._myOnKeyDownEventListener=this._keyDown.bind(this),r.getWindow(this._myEngine).addEventListener("keydown",this._myOnKeyDownEventListener),this._myOnKeyUpEventListener=this._keyUp.bind(this),r.getWindow(this._myEngine).addEventListener("keyup",this._myOnKeyUpEventListener)}update(e){if(!r.getDocument(this._myEngine).hasFocus())for(let t of this._myKeyInfos.values())t.myPressed&&(t.myPressed=!1,t.myPressEndToProcess=!0);for(let t of this._myKeyInfos.values())t.myPressStart=t.myPressStartToProcess,t.myPressEnd=t.myPressEndToProcess,t.myPressStartToProcess=!1,t.myPressEndToProcess=!1}_keyDown(e){this._keyPressedChanged(e.key,!0),e.key!=e.code&&this._keyPressedChanged(e.code,!0)}_keyUp(e){this._keyPressedChanged(e.key,!1),e.key!=e.code&&this._keyPressedChanged(e.code,!1)}_keyPressedChanged(e,t){if(this._myKeyInfos.has(e)){let n=this._myKeyInfos.get(e);t?(n.myPressed=!0,n.myPressStartToProcess=!0):(n.myPressed=!1,n.myPressEndToProcess=!0)}}_createKeyInfo(){return{myPressed:!1,myPressStart:!1,myPressStartToProcess:!1,myPressEnd:!1,myPressEndToProcess:!1}}destroy(){this._myDestroyed=!0,r.getWindow(this._myEngine).removeEventListener("keydown",this._myOnKeyDownEventListener),r.getWindow(this._myEngine).removeEventListener("keyup",this._myOnKeyUpEventListener)}isDestroyed(){return this._myDestroyed}};var Mo=class extends zt{constructor(e){super(e),this._myButtonData=this._createButtonData(),this._myAxesData=this._createAxesData(),this._myHapticActuators=[]}isGamepadCoreActive(){return!0}getButtonData(e){this._myButtonData.myPressed=!1,this._myButtonData.myTouched=!1,this._myButtonData.myValue=0;let t=r.getKeyboard(this.getEngine());if(this.isGamepadCoreActive())if(this.getHandedness()==A.LEFT)switch(e){case E.SELECT:this._myButtonData.myPressed=t.isKeyPressed(ee.E)||t.isKeyPressed(ee.e);break;case E.SQUEEZE:this._myButtonData.myPressed=t.isKeyPressed(ee.Q)||t.isKeyPressed(ee.q);break;case E.TOUCHPAD:this._myButtonData.myPressed=t.isKeyPressed(ee.X)||t.isKeyPressed(ee.x);break;case E.THUMBSTICK:this._myButtonData.myPressed=t.isKeyPressed(ee.R)||t.isKeyPressed(ee.r);break;case E.BOTTOM_BUTTON:this._myButtonData.myPressed=t.isKeyPressed(ee.C)||t.isKeyPressed(ee.c);break;case E.TOP_BUTTON:this._myButtonData.myPressed=t.isKeyPressed(ee.F)||t.isKeyPressed(ee.f);break;case E.THUMB_REST:this._myButtonData.myPressed=t.isKeyPressed(ee.V)||t.isKeyPressed(ee.v);break}else switch(e){case E.SELECT:this._myButtonData.myPressed=t.isKeyPressed(ee.U)||t.isKeyPressed(ee.u);break;case E.SQUEEZE:this._myButtonData.myPressed=t.isKeyPressed(ee.O)||t.isKeyPressed(ee.o);break;case E.TOUCHPAD:this._myButtonData.myPressed=t.isKeyPressed(ee.M)||t.isKeyPressed(ee.m);break;case E.THUMBSTICK:this._myButtonData.myPressed=t.isKeyPressed(ee.Y)||t.isKeyPressed(ee.y);break;case E.BOTTOM_BUTTON:this._myButtonData.myPressed=t.isKeyPressed(ee.N)||t.isKeyPressed(ee.n);break;case E.TOP_BUTTON:this._myButtonData.myPressed=t.isKeyPressed(ee.H)||t.isKeyPressed(ee.h);break;case E.THUMB_REST:this._myButtonData.myPressed=t.isKeyPressed(ee.B)||t.isKeyPressed(ee.b);break}return this._myButtonData.myPressed&&(this._myButtonData.myTouched=!0,this._myButtonData.myValue=1),this._myButtonData}getAxesData(e){this._myAxesData.vec2_zero();let t=r.getKeyboard(this.getEngine());return this.isGamepadCoreActive()&&(this.getHandedness()==A.LEFT?((t.isKeyPressed(ee.W)||t.isKeyPressed(ee.w))&&(this._myAxesData[1]+=1),(t.isKeyPressed(ee.S)||t.isKeyPressed(ee.s))&&(this._myAxesData[1]+=-1),(t.isKeyPressed(ee.D)||t.isKeyPressed(ee.d))&&(this._myAxesData[0]+=1),(t.isKeyPressed(ee.A)||t.isKeyPressed(ee.a))&&(this._myAxesData[0]+=-1)):((t.isKeyPressed(ee.I)||t.isKeyPressed(ee.i)||t.isKeyPressed(ee.UP))&&(this._myAxesData[1]+=1),(t.isKeyPressed(ee.K)||t.isKeyPressed(ee.k)||t.isKeyPressed(ee.DOWN))&&(this._myAxesData[1]+=-1),(t.isKeyPressed(ee.L)||t.isKeyPressed(ee.l)||t.isKeyPressed(ee.RIGHT))&&(this._myAxesData[0]+=1),(t.isKeyPressed(ee.J)||t.isKeyPressed(ee.j)||t.isKeyPressed(ee.LEFT))&&(this._myAxesData[0]+=-1))),this._myAxesData}getHapticActuators(){return this._myHapticActuators}};var Do=class extends zt{constructor(e){super(e),this._mySelectPressed=!1,this._mySqueezePressed=!1,this._myXRSessionActive=!1,this._myInputSource=null,this._myGamepad=null,this._mySelectStartEventListener=null,this._mySelectEndEventListener=null,this._mySqueezeStartEventListener=null,this._mySqueezeEndEventListener=null,this._myButtonData=this._createButtonData(),this._myAxesData=this._createAxesData(),this._myHapticActuators=[]}isGamepadCoreActive(){return this._myXRSessionActive&&this._myGamepad!=null&&(this._myGamepad.connected==null||this._myGamepad.connected)}_startHook(){I.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this.getEngine())}_preUpdateHook(e){this._myInputSource=this.getHandPose().getInputSource(),this._myInputSource!=null?this._myGamepad=this._myInputSource.gamepad:this._myGamepad=null}getButtonData(e){if(this._myButtonData.myPressed=!1,this._myButtonData.myTouched=!1,this._myButtonData.myValue=0,this.isGamepadCoreActive()){if(e<this._myGamepad.buttons.length){let t=this._myGamepad.buttons[e];e!=E.SELECT&&e!=E.SQUEEZE?this._myButtonData.myPressed=t.pressed:this._myButtonData.myPressed=this._getSpecialButtonPressed(e),this._myButtonData.myTouched=t.touched,this._myButtonData.myValue=t.value}else if(e==E.TOP_BUTTON&&this._myGamepad.buttons.length>=3){let t=this._myGamepad.buttons[2];this._myButtonData.myPressed=t.pressed,this._myButtonData.myTouched=t.touched,this._myButtonData.myValue=t.value}}return this._myButtonData}getAxesData(e){if(this._myAxesData.vec2_zero(),this.isGamepadCoreActive()){let t=this._myGamepad.axes;t.length==4?(Math.abs(t[0])>Math.abs(t[2])?this._myAxesData[0]=t[0]:this._myAxesData[0]=t[2],Math.abs(t[1])>Math.abs(t[3])?this._myAxesData[1]=t[1]:this._myAxesData[1]=t[3]):t.length==2&&(this._myAxesData[0]=t[0],this._myAxesData[1]=t[1]),this._myAxesData[1]=-this._myAxesData[1]}return this._myAxesData}getHapticActuators(){return this._myHapticActuators.pp_clear(),this.isGamepadCoreActive()&&(this._myGamepad.hapticActuators!=null&&this._myGamepad.hapticActuators.length>0&&this._myHapticActuators.push(...this._myGamepad.hapticActuators),this._myGamepad.vibrationActuator!=null&&this._myHapticActuators.push(this._myGamepad.vibrationActuator)),this._myHapticActuators}_getSpecialButtonPressed(e){let t=!1;return this.isGamepadCoreActive()&&(e==E.SELECT?t=this._mySelectPressed:e==E.SQUEEZE&&(t=this._mySqueezePressed)),t}_onXRSessionStart(e){this._mySelectStartEventListener=this._selectStart.bind(this),this._mySelectEndEventListener=this._selectEnd.bind(this),this._mySqueezeStartEventListener=this._squeezeStart.bind(this),this._mySqueezeEndEventListener=this._squeezeEnd.bind(this),e.addEventListener("selectstart",this._mySelectStartEventListener),e.addEventListener("selectend",this._mySelectEndEventListener),e.addEventListener("squeezestart",this._mySqueezeStartEventListener),e.addEventListener("squeezeend",this._mySqueezeEndEventListener),this._myXRSessionActive=!0}_onXRSessionEnd(e){this._mySelectStartEventListener=null,this._mySelectEndEventListener=null,this._mySqueezeStartEventListener=null,this._mySqueezeEndEventListener=null,this._myXRSessionActive=!1}_selectStart(e){this._myInputSource!=null&&this._myInputSource==e.inputSource&&(this._mySelectPressed=!0)}_selectEnd(e){this._myInputSource!=null&&this._myInputSource==e.inputSource&&(this._mySelectPressed=!1)}_squeezeStart(e){this._myInputSource!=null&&this._myInputSource==e.inputSource&&(this._mySqueezePressed=!0)}_squeezeEnd(e){this._myInputSource!=null&&this._myInputSource==e.inputSource&&(this._mySqueezePressed=!1)}_destroyHook(){I.getSession(this.getEngine())?.removeEventListener("selectstart",this._mySelectStartEventListener),I.getSession(this.getEngine())?.removeEventListener("selectend",this._mySelectEndEventListener),I.getSession(this.getEngine())?.removeEventListener("squeezestart",this._mySqueezeStartEventListener),I.getSession(this.getEngine())?.removeEventListener("squeezeend",this._mySqueezeEndEventListener),I.unregisterSessionStartEndEventListeners(this,this.getEngine())}};import{Emitter as OP}from"@wonderlandengine/api";var _s=class{constructor(e){this._myHandedness=e,this._myButtonInfos=[];for(let t in E)this._myButtonInfos[E[t]]=new Nn(E[t],this._myHandedness);this._myAxesInfos=[];for(let t in oe)this._myAxesInfos[oe[t]]=new Gn(oe[t],this._myHandedness);this._myButtonEmitters=[];for(let t in E){this._myButtonEmitters[E[t]]=[];for(let n in re)this._myButtonEmitters[E[t]][re[n]]=new OP}this._myAxesEmitters=[];for(let t in oe){this._myAxesEmitters[oe[t]]=[];for(let n in si)this._myAxesEmitters[oe[t]][si[n]]=new OP}this._myPulseInfo=new Wn,this._myDestroyed=!1,this._myMultiplePressMaxDelay=.4,this._myMultipleTouchMaxDelay=.4}getHandedness(){return this._myHandedness}getButtonInfo(e){return this._myButtonInfos[e]}registerButtonEventListener(e,t,n,o){this._myButtonEmitters[e][t].add(o,{id:n})}unregisterButtonEventListener(e,t,n){this._myButtonEmitters[e][t].remove(n)}getAxesInfo(e){return this._myAxesInfos[e]}registerAxesEventListener(e,t,n,o){this._myAxesEmitters[e][t].add(o,{id:n})}unregisterAxesEventListener(e,t,n){this._myAxesEmitters[e][t].remove(n)}pulse(e,t=0){this._myPulseInfo.myIntensity=Math.pp_clamp(e,0,1),this._myPulseInfo.myDuration=Math.max(t,0)}stopPulse(){this._myPulseInfo.myIntensity=0,this._myPulseInfo.myDuration=0}isPulsing(){return this._myPulseInfo.myIntensity>0||this._myPulseInfo.myDuration>0}getPulseInfo(){return this._myPulseInfo}getMultiplePressMaxDelay(){return this._myMultiplePressMaxDelay}setMultiplePressMaxDelay(e){this._myMultiplePressMaxDelay=e}getMultipleTouchMaxDelay(){return this._myMultipleTouchMaxDelay}setMultipleTouchMaxDelay(e){this._myMultipleTouchMaxDelay=e}getHandPose(){return null}_startHook(){}_preUpdate(e){}_postUpdate(e){}_getButtonData(e){return this._createButtonData()}_getAxesData(e){return this._createAxesData()}_getHapticActuators(){return[]}_destroyHook(){}start(){this._startHook()}update(e){this._preUpdate(e),this._preUpdateButtonInfos(),this._updateButtonInfos(),this._postUpdateButtonInfos(e),this._preUpdateAxesInfos(),this._updateAxesInfos(),this._postUpdateAxesInfos(),this._updatePulse(e),this._postUpdate(e)}_preUpdateButtonInfos(){for(let e of this._myButtonInfos)e.myPrevIsPressed=e.myPressed,e.myPrevIsTouched=e.myTouched,e.myPrevValue=e.myValue}_updateButtonInfos(){this._updateSingleButtonInfo(E.SELECT),this._updateSingleButtonInfo(E.SQUEEZE),this._updateSingleButtonInfo(E.TOUCHPAD),this._updateSingleButtonInfo(E.THUMBSTICK),this._updateSingleButtonInfo(E.BOTTOM_BUTTON),this._updateSingleButtonInfo(E.TOP_BUTTON),this._updateSingleButtonInfo(E.THUMB_REST)}_updateSingleButtonInfo(e){let t=this._myButtonInfos[e],n=this._getButtonData(e);t.myPressed=n.myPressed,t.myTouched=n.myTouched,t.myValue=n.myValue}_postUpdateButtonInfos(e){for(let t of this._myButtonInfos)t.myPressed?(t.myTimePressed+=e,t.myPrevIsPressed||(t.myMultiplePressStartCount+=1,t.myPrevTimeNotPressed=t.myTimeNotPressed,t.myTimeNotPressed=0),t.myPrevTimeNotPressed+t.myTimePressed>this._myMultiplePressMaxDelay&&t.myMultiplePressEndCount>0&&(t.myPrevMultiplePressEndCount=t.myMultiplePressEndCount,t.myMultiplePressEndCount=0),t.myTimePressed>this._myMultiplePressMaxDelay&&t.myMultiplePressStartCount>0&&(t.myPrevMultiplePressStartCount=t.myMultiplePressStartCount,t.myMultiplePressStartCount=0)):(t.myTimeNotPressed+=e,t.myPrevIsPressed&&(t.myMultiplePressEndCount+=1,t.myPrevTimePressed=t.myTimePressed,t.myTimePressed=0),t.myPrevTimePressed+t.myTimeNotPressed>this._myMultiplePressMaxDelay&&t.myMultiplePressStartCount>0&&(t.myPrevMultiplePressStartCount=t.myMultiplePressStartCount,t.myMultiplePressStartCount=0),t.myTimeNotPressed>this._myMultiplePressMaxDelay&&t.myMultiplePressEndCount>0&&(t.myPrevMultiplePressEndCount=t.myMultiplePressEndCount,t.myMultiplePressEndCount=0)),t.myTouched?(t.myTimeTouched+=e,t.myPrevIsTouched||(t.myMultipleTouchStartCount+=1,t.myPrevTimeNotTouched=t.myTimeNotTouched,t.myTimeNotTouched=0),t.myPrevTimeNotTouched+t.myTimeTouched>this._myMultipleTouchMaxDelay&&t.myMultipleTouchEndCount>0&&(t.myPrevMultipleTouchEndCount=t.myMultipleTouchEndCount,t.myMultipleTouchEndCount=0),t.myTimeTouched>this._myMultipleTouchMaxDelay&&t.myMultipleTouchStartCount>0&&(t.myPrevMultipleTouchStartCount=t.myMultipleTouchStartCount,t.myMultipleTouchStartCount=0)):(t.myTimeNotTouched+=e,t.myPrevIsTouched&&(t.myMultipleTouchEndCount+=1,t.myPrevTimeTouched=t.myTimeTouched,t.myTimeTouched=0),t.myPrevTimeTouched+t.myTimeNotTouched>this._myMultipleTouchMaxDelay&&t.myMultipleTouchStartCount>0&&(t.myPrevMultipleTouchStartCount=t.myMultipleTouchStartCount,t.myMultipleTouchStartCount=0),t.myTimeNotTouched>this._myMultipleTouchMaxDelay&&t.myMultipleTouchEndCount>0&&(t.myPrevMultipleTouchEndCount=t.myMultipleTouchEndCount,t.myMultipleTouchEndCount=0));for(let t in E){let n=this._myButtonInfos[E[t]],o=this._myButtonEmitters[E[t]];n.myPressed&&!n.myPrevIsPressed&&o[re.PRESS_START].notify(n,this),!n.myPressed&&n.myPrevIsPressed&&o[re.PRESS_END].notify(n,this),n.myPressed?o[re.PRESSED].notify(n,this):o[re.NOT_PRESSED].notify(n,this),n.myTouched&&!n.myPrevIsTouched&&o[re.TOUCH_START].notify(n,this),!n.myTouched&&n.myPrevIsTouched&&o[re.TOUCH_END].notify(n,this),n.myTouched?o[re.TOUCHED].notify(n,this):o[re.NOT_TOUCHED].notify(n,this),n.myValue!=n.myPrevValue&&o[re.VALUE_CHANGED].notify(n,this),o[re.ALWAYS].notify(n,this)}this._mySelectStart=!1,this._mySelectEnd=!1,this._mySqueezeStart=!1,this._mySqueezeEnd=!1}_preUpdateAxesInfos(){for(let e of this._myAxesInfos)e.myPrevAxes[0]=e.myAxes[0],e.myPrevAxes[1]=e.myAxes[1]}_updateAxesInfos(){this._updateSingleAxesInfo(oe.THUMBSTICK)}_updateSingleAxesInfo(e){let t=this._myAxesInfos[e],n=this._getAxesData(e);t.myAxes[0]=n[0],t.myAxes[1]=n[1]}_postUpdateAxesInfos(){for(let e in oe){let t=this._myAxesInfos[oe[e]],n=this._myAxesEmitters[oe[e]];t.myAxes[0]!=t.myPrevAxes[0]&&n[si.X_CHANGED].notify(t,this),t.myAxes[1]!=t.myPrevAxes[1]&&n[si.Y_CHANGED].notify(t,this),(t.myAxes[0]!=t.myPrevAxes[0]||t.myAxes[1]!=t.myPrevAxes[1])&&n[si.AXES_CHANGED].notify(t,this),n[si.ALWAYS].notify(t,this)}}_updatePulse(e){if(this._myPulseInfo.myDevicePulsing||this._myPulseInfo.myIntensity>0){let t=this._getHapticActuators();if(t.length>0){if(this._myPulseInfo.myIntensity>0){for(let n of t)n.pulse(this._myPulseInfo.myIntensity,Math.max(500,this._myPulseInfo.myDuration*1e3));this._myPulseInfo.myDevicePulsing=!0}else if(this._myPulseInfo.myDevicePulsing){for(let n of t)n.reset();this._myPulseInfo.myDevicePulsing=!1}}else this._myPulseInfo.myDevicePulsing=!1}this._myPulseInfo.myDuration-=e,this._myPulseInfo.myDuration<=0&&(this._myPulseInfo.myIntensity=0,this._myPulseInfo.myDuration=0)}_createButtonData(){return{myPressed:!1,myTouched:!1,myValue:0}}_createAxesData(){return Ae(0,0)}destroy(){this._myDestroyed=!0,this._destroyHook()}isDestroyed(){return this._myDestroyed}};var Eo=class extends _s{constructor(e){super(e),this._myGamepadCores=new Map,this._myStarted=!1,this._myButtonData=this._createButtonData(),this._myAxesData=this._createAxesData(),this._myHapticActuators=[]}addGamepadCore(e,t){t.getHandedness()==this.getHandedness()&&(this._myGamepadCores.set(e,t),this._myStarted&&t.start())}getGamepadCore(e){return this._myGamepadCores.get(e)}removeGamepadCore(e){this._myGamepadCores.get(e)&&this._myGamepadCores.delete(e)}removeAllGamepadCores(){for(let e of this._myGamepadCores.keys())this.removeGamepadCore(e)}getHandPose(){let e=null;for(let t of this._myGamepadCores.values()){if(t.isGamepadCoreActive()){let n=t.getHandPose();(e==null||n!=null&&n.isValid())&&(e=n)}if(e!=null&&e.isValid())break}return e}_startHook(){for(let e of this._myGamepadCores.values())e.start();this._myStarted=!0}_preUpdate(e){for(let t of this._myGamepadCores.values())t.preUpdate(e)}_postUpdate(e){for(let t of this._myGamepadCores.values())t.postUpdate(e)}_getButtonData(e){this._myButtonData.myPressed=!1,this._myButtonData.myTouched=!1,this._myButtonData.myValue=0;for(let t of this._myGamepadCores.values())if(t.isGamepadCoreActive()){let n=t.getButtonData(e);this._myButtonData.myPressed=this._myButtonData.myPressed||n.myPressed,this._myButtonData.myTouched=this._myButtonData.myTouched||n.myTouched,Math.abs(n.myValue)>Math.abs(this._myButtonData.myValue)&&(this._myButtonData.myValue=n.myValue)}return this._myButtonData}_getAxesData(e){this._myAxesData.vec2_zero();for(let t of this._myGamepadCores.values())if(t.isGamepadCoreActive()){let n=t.getAxesData(e);Math.abs(n[0])>Math.abs(this._myAxesData[0])&&(this._myAxesData[0]=n[0]),Math.abs(n[1])>Math.abs(this._myAxesData[1])&&(this._myAxesData[1]=n[1])}return this._myAxesData}_getHapticActuators(){this._myHapticActuators.pp_clear();for(let e of this._myGamepadCores.values())e.isGamepadCoreActive()&&this._myHapticActuators.push(...e.getHapticActuators());return this._myHapticActuators}_destroyHook(){for(let e of this._myGamepadCores.values())e.destroy()}};var gs=class{constructor(){this._myGamepads=[],this._myGamepads[A.LEFT]=new Eo(A.LEFT),this._myGamepads[A.RIGHT]=new Eo(A.RIGHT),this._myDestroyed=!1}start(){for(let e in this._myGamepads)this._myGamepads[e].start()}update(e){for(let t in this._myGamepads)this._myGamepads[t].update(e)}getLeftGamepad(){return this._myGamepads[A.LEFT]}getRightGamepad(){return this._myGamepads[A.RIGHT]}getGamepad(e){return this._myGamepads[e]}getGamepads(){return this._myGamepads}destroy(){this._myDestroyed=!0;for(let e in this._myGamepads)this._myGamepads[e].destroy()}isDestroyed(){return this._myDestroyed}};import{Emitter as oA}from"@wonderlandengine/api";var Mt=class{constructor(e=r.getMainEngine()){this.myReferenceObject=null,this.myForwardFixed=!0,this.myUpdateOnViewReset=!0,this.myForceEmulatedVelocities=!1,this.myEngine=e}},Ge=class{constructor(e=new Mt){this._myForwardFixed=e.myForwardFixed,this._myForceEmulatedVelocities=e.myForceEmulatedVelocities,this._myUpdateOnViewReset=e.myUpdateOnViewReset,this._myReferenceObject=e.myReferenceObject,this._myEngine=e.myEngine,this._myPosition=c(),this._myRotationQuat=N(),this._myPrevPosition=c(),this._myPrevRotationQuat=j(),this._myLinearVelocity=c(),this._myAngularVelocityRadians=c(),this._myValid=!1,this._myLinearVelocityEmulated=!0,this._myAngularVelocityEmulated=!0,this._myPoseUpdatedEmitter=new oA,this._myViewResetEventListener=null,this._myDestroyed=!1}getEngine(){return this._myEngine}setReferenceObject(e){this._myReferenceObject=e}getReferenceObject(){return this._myReferenceObject}setForwardFixed(e){this._myForwardFixed=e}isForwardFixed(){return this._myForwardFixed}setForceEmulatedVelocities(e){this._myForceEmulatedVelocities=e}isForceEmulatedVelocities(){return this._myForceEmulatedVelocities}setUpdateOnViewReset(e){this._myUpdateOnViewReset=e}isUpdateOnViewReset(){return this._myUpdateOnViewReset}getReferenceSpace(){return I.getReferenceSpace(this._myEngine)}getPosition(e=c(),t=void 0){}getRotation(e=c(),t=void 0){return this.getRotationDegrees(e,t)}getRotationDegrees(e=c(),t=void 0){}getRotationRadians(e=c(),t=void 0){}getRotationQuat(e=j(),t=void 0){}getTransform(e=be(),t=void 0){return this.getTransformMatrix(e,t)}getTransformMatrix(e=be(),t=void 0){}getTransformQuat(e=N(),t=void 0){}getLinearVelocity(e=c(),t=void 0){}getAngularVelocity(e=c(),t=void 0){return this.getAngularVelocityDegrees(e,t)}getAngularVelocityDegrees(e=c(),t=void 0){}getAngularVelocityRadians(e=c(),t=void 0){}isValid(){return this._myValid}isLinearVelocityEmulated(){return this._myLinearVelocityEmulated}isAngularVelocityEmulated(){return this._myAngularVelocityEmulated}registerPoseUpdatedEventListener(e,t){this._myPoseUpdatedEmitter.add(t,{id:e})}unregisterPoseUpdatedEventListener(e){this._myPoseUpdatedEmitter.remove(e)}start(){I.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!0,this._myEngine)}update(e){this._update(e,!0)}_isReadyToGetPose(){return!0}_getPose(e){return null}_updateHook(e,t,n){}_onXRSessionStartHook(e,t){}_onXRSessionEndHook(){}_onViewResetHook(){}_destroyHook(){}_update(e,t){this._myPrevPosition.vec3_copy(this._myPosition),this._myPrevRotationQuat.quat_copy(this._myRotationQuat);let n=I.getFrame(this._myEngine);if(n&&this._isReadyToGetPose()){let o=null;try{o=this._getPose(n)}catch{}o?(this._myPosition[0]=o.transform.position.x,this._myPosition[1]=o.transform.position.y,this._myPosition[2]=o.transform.position.z,this._myRotationQuat[0]=o.transform.orientation.x,this._myRotationQuat[1]=o.transform.orientation.y,this._myRotationQuat[2]=o.transform.orientation.z,this._myRotationQuat[3]=o.transform.orientation.w,this._myRotationQuat.quat_normalize(this._myRotationQuat),t&&(o.linearVelocity&&!this._myForceEmulatedVelocities?(this._myLinearVelocity[0]=o.linearVelocity.x,this._myLinearVelocity[1]=o.linearVelocity.y,this._myLinearVelocity[2]=o.linearVelocity.z,this._myLinearVelocityEmulated=!1):(this._computeEmulatedLinearVelocity(e),this._myLinearVelocityEmulated=!0),o.angularVelocity&&!this._myForceEmulatedVelocities?(this._myAngularVelocityRadians[0]=o.angularVelocity.x,this._myAngularVelocityRadians[1]=o.angularVelocity.y,this._myAngularVelocityRadians[2]=o.angularVelocity.z,this._myAngularVelocityEmulated=!1):(this._computeEmulatedAngularVelocity(e),this._myAngularVelocityEmulated=!0)),this._myValid=!0):(t&&(this._myLinearVelocity[0]=0,this._myLinearVelocity[1]=0,this._myLinearVelocity[2]=0,this._myAngularVelocityRadians[0]=0,this._myAngularVelocityRadians[1]=0,this._myAngularVelocityRadians[2]=0),this._myValid=!1,this._myLinearVelocityEmulated=!0,this._myAngularVelocityEmulated=!0),this._updateHook(e,t,o)}else t&&(this._myLinearVelocity[0]=0,this._myLinearVelocity[1]=0,this._myLinearVelocity[2]=0,this._myAngularVelocityRadians[0]=0,this._myAngularVelocityRadians[1]=0,this._myAngularVelocityRadians[2]=0),this._myValid=!1,this._myLinearVelocityEmulated=!0,this._myAngularVelocityEmulated=!0,this._updateHook(e,t,null);this._myPoseUpdatedEmitter.notify(this)}_computeEmulatedLinearVelocity(e){e>0?(this._myPosition.vec3_sub(this._myPrevPosition,this._myLinearVelocity),this._myLinearVelocity.vec3_scale(1/e,this._myLinearVelocity)):(this._myLinearVelocity[0]=0,this._myLinearVelocity[1]=0,this._myLinearVelocity[2]=0)}_onXRSessionStart(e,t){let n=I.getReferenceSpace(this._myEngine);n.addEventListener!=null&&(this._myViewResetEventListener=this._onViewReset.bind(this),n.addEventListener("reset",this._myViewResetEventListener)),this._onXRSessionStartHook(e,t)}_onXRSessionEnd(){this._onXRSessionEndHook(),this._myViewResetEventListener=null}_onViewReset(){this._myUpdateOnViewReset&&this._update(0,!1),this._onViewResetHook()}_computeEmulatedAngularVelocity(){}destroy(){this._myDestroyed=!0,this._destroyHook(),I.getReferenceSpace(this._myEngine)?.removeEventListener?.("reset",this._myViewResetEventListener),I.unregisterSessionStartEndEventListeners(this,this._myEngine)}isDestroyed(){return this._myDestroyed}};Ge.prototype.getPosition=function(){let i=be();return function(t=c(),n=void 0){let o=n===void 0?this._myReferenceObject:n;return t.vec3_copy(this._myPosition),o==null?t:t.vec3_convertPositionToWorld(o.pp_getTransform(i),t)}}();Ge.prototype.getRotationDegrees=function(){let i=j();return function(t=c(),n=void 0){return this.getRotationQuat(i,n).quat_toDegrees(t)}}();Ge.prototype.getRotationRadians=function(){let i=j();return function(t=c(),n=void 0){return this.getRotationQuat(i,n).quat_toRadians(t)}}();Ge.prototype.getRotationQuat=function(){let i=j(),e=c();return function(n=j(),o=void 0){let s=o===void 0?this._myReferenceObject:o;return n.quat_copy(this._myRotationQuat),this._myForwardFixed&&n.quat_rotateAxisRadians(Math.PI,n.quat_getUp(e),n),s==null?n:n.quat_toWorld(s.pp_getRotationQuat(i),n)}}();Ge.prototype.getTransformMatrix=function(){let i=N();return function(t=be(),n=void 0){return this.getTransformQuat(i,n).quat2_toMatrix(t)}}();Ge.prototype.getTransformQuat=function(){let i=j(),e=N();return function(n=N(),o=void 0){let s=o===void 0?this._myReferenceObject:o;return n.quat2_identity(),n.quat2_setPositionRotationQuat(this._myPosition,this.getRotationQuat(i,o)),s==null?n:n.quat_toWorld(s.pp_getTransformQuat(e),n)}}();Ge.prototype.getLinearVelocity=function(){let i=be();return function(t=c(),n=void 0){let o=n===void 0?this._myReferenceObject:n;return t.vec3_copy(this._myLinearVelocity),o==null?t:t.vec3_convertDirectionToWorld(o.pp_getTransform(i),t)}}();Ge.prototype.getAngularVelocityDegrees=function(){let i=c();return function(t=c(),n=void 0){return this.getAngularVelocityRadians(i,n).vec3_toDegrees(t)}}();Ge.prototype.getAngularVelocityRadians=function(){let i=be();return function(t=c(),n=void 0){let o=n===void 0?this._myReferenceObject:n;return t.vec3_copy(this._myAngularVelocityRadians),o==null?t:t.vec3_convertDirectionToWorld(o.pp_getTransform(i),t)}}();Ge.prototype._computeEmulatedAngularVelocity=function(){let i=c(),e=c();return function(n){n>0?(i=this._myRotationQuat.quat_toRadians(i),e=this._myPrevRotationQuat.quat_toRadians(e),i.vec3_sub(e,this._myAngularVelocityRadians),this._myAngularVelocityRadians.vec3_scale(1/n,this._myAngularVelocityRadians)):(this._myAngularVelocityRadians[0]=0,this._myAngularVelocityRadians[1]=0,this._myAngularVelocityRadians[2]=0)}}();var Un=class extends Mt{constructor(e){super(e),this.myFixTrackedHandRotation=!0}},Qn=class extends Ge{constructor(e,t=new Un){super(t),this._myInputSource=null,this._myHandedness=e,this._myFixTrackedHandRotation=t.myFixTrackedHandRotation,this._myTrackedHand=!1,this._myInputSourcesChangeEventListener=null}getHandedness(){return this._myHandedness}getInputSource(){return this._myInputSource}getInputSourceType(){return this._myInputSource==null?null:ie.getInputSourceType(this._myInputSource)}isFixTrackedHandRotation(){return this._myFixTrackedHandRotation}setFixTrackedHandRotation(e){this.myFixTrackedHandRotation=e}getRotationQuat(e=void 0){}_isReadyToGetPose(){return this._myInputSource!=null}_getPose(e){return e.getPose(this._myInputSource.gripSpace,this.getReferenceSpace())}_onXRSessionStartHook(e,t){if(this._myInputSourcesChangeEventListener=function(n){if(n.removed)for(let o of n.removed)o==this._myInputSource&&(this._myInputSource=null);if(n.added)for(let o of n.added)o.handedness==this._myHandedness&&(this._myInputSource=o,this._myTrackedHand=ie.getInputSourceType(this._myInputSource)==Ye.TRACKED_HAND)}.bind(this),t.addEventListener("inputsourceschange",this._myInputSourcesChangeEventListener),e&&this._myInputSource==null&&t.inputSources)for(let n of t.inputSources)n.handedness==this._myHandedness&&(this._myInputSource=n,this._myTrackedHand=ie.getInputSourceType(this._myInputSource)==Ye.TRACKED_HAND)}_onXRSessionEndHook(){this._myInputSource=null,this._myInputSourcesChangeEventListener=null}_destroyHook(){I.getSession(this.getEngine())?.removeEventListener("inputsourceschange",this._myInputSourcesChangeEventListener)}};Qn.prototype.getRotationQuat=function(){let i=j(),e=c(),t=c(),n=c();return function(s=j(),a=void 0){let l=a===void 0?this._myReferenceObject:a;if(s.quat_copy(this._myRotationQuat),this._myForwardFixed&&s.quat_rotateAxisRadians(Math.PI,s.quat_getUp(e),s),this._myFixTrackedHandRotation&&this._myTrackedHand){s.quat_rotateAxis(-60,s.quat_getRight(t),s);let u=20;u=this._myHandedness==A.LEFT?u:-u,s.quat_rotateAxis(u,s.quat_getForward(n),s)}return l==null?s:s.quat_toWorld(l.pp_getRotationQuat(i),s)}}();var fs=class extends Ge{_getPose(e){return e.getViewerPose(this.getReferenceSpace())}};var Ao=class extends Ge{constructor(e,t,n=new Mt){super(n),this._myInputSource=null,this._myHandedness=e,this._myTrackedHandJointID=t,this._myJointRadius=0,this._myInputSourcesChangeEventListener=null}getHandedness(){return this._myHandedness}getTrackedHandJointID(){return this._myTrackedHandJointID}setTrackedHandJointID(e){this._myTrackedHandJointID=e}getJointRadius(){return this._myJointRadius}_isReadyToGetPose(){return this._myInputSource!=null}_getPose(e){return e.getJointPose(this._myInputSource.hand.get(this._myTrackedHandJointID),this.getReferenceSpace())}_updateHook(e,t,n){n!=null&&(this._myJointRadius=n.radius)}_onXRSessionStartHook(e,t){if(this._myInputSourcesChangeEventListener=function(n){if(n.removed)for(let o of n.removed)o==this._myInputSource&&(this._myInputSource=null);if(n.added)for(let o of n.added)o.handedness==this._myHandedness&&ie.getInputSourceType(o)==Ye.TRACKED_HAND&&(this._myInputSource=o)}.bind(this),t.addEventListener("inputsourceschange",this._myInputSourcesChangeEventListener),e&&this._myInputSource==null&&t.inputSources)for(let n of t.inputSources)n.handedness==this._myHandedness&&ie.getInputSourceType(n)==Ye.TRACKED_HAND&&(this._myInputSource=n)}_onXRSessionEndHook(){this._myInputSource=null,this._myInputSourcesChangeEventListener=null}_destroyHook(){I.getSession(this.getEngine())?.removeEventListener("inputsourceschange",this._myInputSourcesChangeEventListener)}};var qn=class extends Mt{constructor(e=!0,t=r.getMainEngine()){if(super(t),this.myTrackedHandJointIDList=[],e)for(let n in lt)this.myTrackedHandJointIDList.push([lt[n]])}},Ro=class{constructor(e,t=new qn){this._myHandedness=e,this._myForwardFixed=t.myForwardFixed,this._myForceEmulatedVelocities=t.myForceEmulatedVelocities,this._myReferenceObject=t.myReferenceObject,this._myEngine=t.myEngine,this._myTrackedHandJointPoseParams=new Mt(this._myEngine),this._myTrackedHandJointPoseParams.myForwardFixed=this._myForwardFixed,this._myTrackedHandJointPoseParams.myForceEmulatedVelocities=this._myForceEmulatedVelocities,this._myTrackedHandJointPoseParams.myReferenceObject=this._myReferenceObject,this._myTrackedHandJointPoses=[];for(let n of t.myTrackedHandJointIDList){let o=new Ao(this._myHandedness,n,this._myTrackedHandJointPoseParams);this._myTrackedHandJointPoses[n]=o}}start(){for(let e in this._myTrackedHandJointPoses)this._myTrackedHandJointPoses[e].start()}update(e){for(let t in this._myTrackedHandJointPoses)this._myTrackedHandJointPoses[t].update(e)}getEngine(){this._myEngine}getHandedness(){return this._myHandedness}getJointPose(e){return this._myTrackedHandJointPoses[e]}getJointPoseByIndex(e){return this._myTrackedHandJointPoses[ie.getJointIDByIndex(e)]}getJointPoses(){return this._myTrackedHandJointPoses}addTrackedHandJointID(e){if(!this._myTrackedHandJointPoses.pp_has(t=>t.getTrackedHandJointID()==e)){let t=new Ao(this._myHandedness,e,this._myTrackedHandJointPoseParams);this._myTrackedHandJointPoses.push(t)}}removeTrackedHandJointID(e){this._myTrackedHandJointPoses.pp_remove(t=>t.getTrackedHandJointID()==e)}setReferenceObject(e){this._myReferenceObject=e,this._myTrackedHandJointPoseParams.myReferenceObject=this._myReferenceObject;for(let t in this._myTrackedHandJointPoses)this._myTrackedHandJointPoses[t].setReferenceObject(e)}getReferenceObject(){return this._myReferenceObject}setForwardFixed(e){this._myForwardFixed=e,this._myTrackedHandJointPoseParams.myForwardFixed=this._myForwardFixed;for(let t in this._myTrackedHandJointPoses)this._myTrackedHandJointPoses[t].setForwardFixed(e)}isForwardFixed(){return this._myForwardFixed}setForceEmulatedVelocities(e){this._myForceEmulatedVelocities=e,this._myTrackedHandJointPoseParams.myForceEmulatedVelocities=this._myForceEmulatedVelocities;for(let t in this._myTrackedHandJointPoses)this._myTrackedHandJointPoses[t].setForceEmulatedVelocities(e)}isForceEmulatedVelocities(){return this._myForceEmulatedVelocities}destroy(){this._myDestroyed=!0;for(let e of this._myTrackedHandJointPoses)e.destroy()}isDestroyed(){return this._myDestroyed}};import{ViewComponent as VP}from"@wonderlandengine/api";var Gi={LEFT:0,MIDDLE:1,RIGHT:2},Ts=class{constructor(e=r.getMainEngine()){this._myEngine=e,this._myButtonInfos=new Map;for(let t in Gi)this._myButtonInfos.set(Gi[t],this._createButtonInfo());this._myPreventContextMenuEventListener=this._preventContextMenu.bind(this),this._myPreventMiddleButtonScrollEventListener=this._preventMiddleButtonScroll.bind(this),this._myInternalMousePosition=Ae(),this._myScreenSize=Ae(),this._updateScreenSize(),this._myResetMovingDelay=.15,this._myResetMovingTimer=new ne(this._myResetMovingDelay,!1),this._myMoving=!1,this._myInsideView=!1,this._myValid=!1,this._myPointerUpOnPointerLeave=!0,this._myContextMenuActive=!0,this._myMiddleButtonScrollActive=!0,this._myPointerID=null,this._myLastValidPointerEvent=null,this._myPointerEventValidCallbacks=new Map,this._myPointerMoveEventListener=null,this._myPointerDownEventListener=null,this._myPointerUpEventListener=null,this._myPointerLeaveEventListener=null,this._myPointerEnterEventListener=null,this._myMouseDownEventListener=null,this._myMouseUpEventListener=null,this._myDestroyed=!1,this._myProjectionMatrixInverse=be(),this._myRotationQuat=j(),this._myOriginWorld=c(),this._myDirectionWorld=c()}start(){this._myPointerMoveEventListener=this._onPointerAction.bind(this,this._onPointerMove.bind(this)),r.getBody(this._myEngine).addEventListener("pointermove",this._myPointerMoveEventListener),this._myPointerDownEventListener=this._onPointerAction.bind(this,this._onPointerDown.bind(this)),r.getBody(this._myEngine).addEventListener("pointerdown",this._myPointerDownEventListener),this._myPointerUpEventListener=this._onPointerAction.bind(this,this._onPointerUp.bind(this)),r.getBody(this._myEngine).addEventListener("pointerup",this._myPointerUpEventListener),this._myPointerLeaveEventListener=this._onPointerLeave.bind(this),r.getBody(this._myEngine).addEventListener("pointerleave",this._myPointerLeaveEventListener),this._myPointerEnterEventListener=this._onPointerEnter.bind(this),r.getBody(this._myEngine).addEventListener("pointerenter",this._myPointerEnterEventListener),this._myMouseDownEventListener=this._onMouseAction.bind(this,this._onPointerDown.bind(this)),r.getBody(this._myEngine).addEventListener("mousedown",this._myMouseDownEventListener),this._myMouseUpEventListener=this._onMouseAction.bind(this,this._onPointerUp.bind(this)),r.getBody(this._myEngine).addEventListener("mouseup",this._myMouseUpEventListener)}update(e){this._myResetMovingTimer.isRunning()&&(this._myResetMovingTimer.update(e),this._myResetMovingTimer.isDone()&&(this._myResetMovingTimer.reset(),this._myMoving=!1));for(let t of this._myButtonInfos.values())t.myPressStart=t.myPressStartToProcess,t.myPressEnd=t.myPressEndToProcess,t.myPressStartToProcess=!1,t.myPressEndToProcess=!1;this._updateScreenSize(),!this.isAnyButtonPressed()&&!this._myMoving&&(this._myPointerID=null),this._myLastValidPointerEvent!=null&&(this._isPointerEventValid(this._myLastValidPointerEvent)||(this._myInsideView&&this._onPointerLeave(this._myLastValidPointerEvent),this._myLastValidPointerEvent=null))}isValid(){return this._myValid}isButtonPressed(e){let t=!1;return this._myButtonInfos.has(e)&&(t=this._myButtonInfos.get(e).myPressed),t}isAnyButtonPressed(){let e=!1;for(let t of this._myButtonInfos.values())if(t.myPressed){e=!0;break}return e}isButtonPressStart(e){let t=!1;return this._myButtonInfos.has(e)&&(t=this._myButtonInfos.get(e).myPressStart),t}isButtonPressEnd(e=null){let t=!1;return this._myButtonInfos.has(e)&&(t=this._myButtonInfos.get(e).myPressEnd),t}isMoving(){return this._myMoving}isInsideView(){return this._myInsideView}isTargetingRenderCanvas(){return this.isInsideView()&&this._myLastValidPointerEvent!=null&&this._myLastValidPointerEvent.target==r.getCanvas(this._myEngine)}raycastWorld(e,t=new Fe){return this.getOriginWorld(e.myOrigin),this.getDirectionWorld(e.myDirection),t=De.raycast(e,t,r.getPhysics(this._myEngine)),t}getPositionScreen(e=Ae()){let t=e;return t[0]=this._myInternalMousePosition[0],t[1]=this._myScreenSize[1]-1-this._myInternalMousePosition[1],t}getPositionScreenNormalized(e=Ae()){let t=e;return t[0]=this._myScreenSize[0]==0?0:this._myInternalMousePosition[0]/this._myScreenSize[0]*2-1,t[1]=this._myScreenSize[1]==0?0:(this._myScreenSize[1]-1-this._myInternalMousePosition[1])/this._myScreenSize[1]*2-1,t}getScreenSize(){return this._myScreenSize}getPositionWorld(e,t=c()){let n=this.getOriginWorld(this._myOriginWorld),o=this.getDirectionWorld(this._myDirectionWorld);return t=n.vec3_add(o.vec3_scale(e,t),t),t}getOriginWorld(e=c()){return I.isSessionActive(this._myEngine)?r.getPlayerObjects(this._myEngine).myEyeLeft.pp_getPosition(e):r.getPlayerObjects(this._myEngine).myCameraNonXR.pp_getPosition(e),e}getDirectionWorld(e=c()){let t=this._myInternalMousePosition[0]/this._myScreenSize[0],n=this._myInternalMousePosition[1]/this._myScreenSize[1],o=e;o.vec3_set(t*2-1,-n*2+1,-1);let s=this._myProjectionMatrixInverse;I.isSessionActive(this._myEngine)?s=r.getPlayerObjects(this._myEngine).myEyeLeft.pp_getComponent(VP).projectionMatrix.mat4_invert(s):s=r.getPlayerObjects(this._myEngine).myCameraNonXR.pp_getComponent(VP).projectionMatrix.mat4_invert(s),o.vec3_transformMat4(s,o),o.vec3_normalize(o);let a=o;return I.isSessionActive(this._myEngine)?a=o.vec3_transformQuat(r.getPlayerObjects(this._myEngine).myEyeLeft.pp_getRotationQuat(this._myRotationQuat),o):a=o.vec3_transformQuat(r.getPlayerObjects(this._myEngine).myCameraNonXR.pp_getRotationQuat(this._myRotationQuat),o),a.vec3_normalize(a),e}setTouchValid(e){let t="pp_internal_touch_valid_callback";e?this.removePointerEventValidCallback(t):this.addPointerEventValidCallback(t,function(n){return n.pointerType=="mouse"})}setTargetOnlyRenderCanvas(e){let t="pp_internal_target_only_render_canvas_callback";e?this.addPointerEventValidCallback(t,function(n){return n.target==r.getCanvas(this._myEngine)}):this.removePointerEventValidCallback(t)}getLastValidPointerEvent(){return this._myLastValidPointerEvent}addPointerEventValidCallback(e,t){this._myPointerEventValidCallbacks.set(e,t)}removePointerEventValidCallback(e){this._myPointerEventValidCallbacks.delete(e)}isPointerUpOnPointerLeave(){return this._myPointerUpOnPointerLeave}setPointerUpOnPointerLeave(e){this._myPointerUpOnPointerLeave=e}isContextMenuActive(){return this._myContextMenuActive}setContextMenuActive(e){this._myContextMenuActive!=e&&(e?r.getBody(this._myEngine).removeEventListener("contextmenu",this._myPreventContextMenuEventListener):r.getBody(this._myEngine).addEventListener("contextmenu",this._myPreventContextMenuEventListener,!1),this._myContextMenuActive=e)}isMiddleButtonScrollActive(){return this._myMiddleButtonScrollActive}setMiddleButtonScrollActive(e){this._myMiddleButtonScrollActive!=e&&(e?r.getBody(this._myEngine).removeEventListener("mousedown",this._myPreventMiddleButtonScrollEventListener):r.getBody(this._myEngine).addEventListener("mousedown",this._myPreventMiddleButtonScrollEventListener,!1),this._myMiddleButtonScrollActive=e)}setResetMovingDelay(e){this._myResetMovingDelay=e}getResetMovingDelay(){return this._myResetMovingDelay}_onPointerAction(e,t){if(!!this._isPointerEventIDValid(t)){if(!this._isPointerEventValid(t)){this._myInsideView&&this._onPointerLeave(t);return}this._myInsideView||this._onPointerEnter(t),e(t),this._updatePositionAndScreen(t),this._updatePointerData(t)}}_onMouseAction(e,t){!this._myInsideView||!this._isMouseAllowed()||!this._isPointerEventIDValid(this._myLastValidPointerEvent)||!this._isPointerEventValid(this._myLastValidPointerEvent)||e(t)}_onPointerMove(e){this._myResetMovingTimer.start(this._myResetMovingDelay),this._myMoving=!0}_onPointerDown(e){let t=this._myButtonInfos.get(e.button);t.myPressed||(t.myPressed=!0,t.myPressStartToProcess=!0)}_onPointerUp(e){let t=this._myButtonInfos.get(e.button);t.myPressed&&(t.myPressed=!1,t.myPressEndToProcess=!0)}_onPointerLeave(e){if(!(!this._myInsideView||this._myLastValidPointerEvent==null||e.pointerId!=this._myLastValidPointerEvent.pointerId)){if(this._myInsideView=!1,this._myMoving=!1,this._myPointerUpOnPointerLeave)for(let t of this._myButtonInfos.values())t.myPressed&&(t.myPressed=!1,t.myPressEndToProcess=!0);this._myPointerID=null}}_onPointerEnter(e){this._myInsideView&&this._myPointerID!=null||!this._isPointerEventIDValid(e)||!this._isPointerEventValid(e)||(this._myInsideView=!0,this._updatePositionAndScreen(e),this._updatePointerData(e))}_preventContextMenu(e){!this._isPointerEventIDValid(e)||!this._isPointerEventValid(e)||e.preventDefault()}_preventMiddleButtonScroll(e){if(!(!this._isPointerEventIDValid(e)||!this._isPointerEventValid(e))&&e.button==1)return e.preventDefault(),!1}_updatePositionAndScreen(e){this._updateScreenSize(),this._myInternalMousePosition[0]=e.clientX,this._myInternalMousePosition[1]=e.clientY,this._myValid=!0}_updateScreenSize(){let e=r.getBody(this._myEngine).getBoundingClientRect();this._myScreenSize[0]=e.width,this._myScreenSize[1]=e.height}_updatePointerData(e){this._myPointerID=e.pointerId,this._myLastValidPointerEvent=e}_isPointerEventIDValid(e){return e==null?!1:this._myPointerID==null||this._myPointerID==e.pointerId}_isPointerEventValid(e){if(e==null)return!1;let t=!0;for(let n of this._myPointerEventValidCallbacks.values())if(!n(e)){t=!1;break}return t}_isMouseAllowed(){return this._myLastValidPointerEvent!=null&&this._myLastValidPointerEvent.pointerId==1}_createButtonInfo(){return{myPressed:!1,myPressStart:!1,myPressStartToProcess:!1,myPressEnd:!1,myPressEndToProcess:!1}}destroy(){this._myDestroyed=!0,r.getBody(this._myEngine).removeEventListener("pointermove",this._myPointerMoveEventListener),r.getBody(this._myEngine).removeEventListener("pointerdown",this._myPointerDownEventListener),r.getBody(this._myEngine).removeEventListener("pointerup",this._myPointerUpEventListener),r.getBody(this._myEngine).removeEventListener("pointerleave",this._myPointerLeaveEventListener),r.getBody(this._myEngine).removeEventListener("pointerenter",this._myPointerEnterEventListener),r.getBody(this._myEngine).removeEventListener("mousedown",this._myMouseDownEventListener),r.getBody(this._myEngine).removeEventListener("mouseup",this._myMouseUpEventListener),r.getBody(this._myEngine).removeEventListener("contextmenu",this._myPreventContextMenuEventListener),r.getBody(this._myEngine).removeEventListener("mousedown",this._myPreventMiddleButtonScrollEventListener)}isDestroyed(){return this._myDestroyed}};var Ps=class{constructor(e=r.getMainEngine()){this._myEngine=e,this._myMouse=new Ts(this._myEngine),this._myKeyboard=new ds(this._myEngine),this._myHeadPose=new fs(new Mt(this._myEngine)),this._myHeadPose.setReferenceObject(r.getPlayerObjects(this._myEngine).myReferenceSpace),this._myHeadPose.setForwardFixed(r.isPoseForwardFixed(this._myEngine)),this._myHandPoses=[],this._myHandPoses[A.LEFT]=new Qn(A.LEFT,new Un(this._myEngine)),this._myHandPoses[A.RIGHT]=new Qn(A.RIGHT,new Un(this._myEngine)),this._myHandPoses[A.LEFT].setReferenceObject(r.getPlayerObjects(this._myEngine).myReferenceSpace),this._myHandPoses[A.RIGHT].setReferenceObject(r.getPlayerObjects(this._myEngine).myReferenceSpace),this._myHandPoses[A.LEFT].setForwardFixed(r.isPoseForwardFixed(this._myEngine)),this._myHandPoses[A.RIGHT].setForwardFixed(r.isPoseForwardFixed(this._myEngine)),this._myTrackedHandPoses=[],this._myTrackedHandPoses[A.LEFT]=new Ro(A.LEFT,new qn(!0,this._myEngine)),this._myTrackedHandPoses[A.RIGHT]=new Ro(A.RIGHT,new qn(!0,this._myEngine)),this._myTrackedHandPoses[A.LEFT].setReferenceObject(r.getPlayerObjects(this._myEngine).myReferenceSpace),this._myTrackedHandPoses[A.RIGHT].setReferenceObject(r.getPlayerObjects(this._myEngine).myReferenceSpace),this._myTrackedHandPoses[A.LEFT].setForwardFixed(r.isPoseForwardFixed(this._myEngine)),this._myTrackedHandPoses[A.RIGHT].setForwardFixed(r.isPoseForwardFixed(this._myEngine)),this._myGamepadsManager=new gs(this._myEngine),this._myDestroyed=!1}start(){this._myMouse.start(),this._myKeyboard.start(),this._myHeadPose.setReferenceObject(r.getPlayerObjects(this._myEngine).myReferenceSpace),this._myHeadPose.setForwardFixed(r.isPoseForwardFixed(this._myEngine)),this._myHeadPose.start();for(let e in this._myHandPoses)this._myHandPoses[e].setReferenceObject(r.getPlayerObjects(this._myEngine).myReferenceSpace),this._myHandPoses[e].setForwardFixed(r.isPoseForwardFixed(this._myEngine)),this._myHandPoses[e].start();for(let e in this._myTrackedHandPoses)this._myTrackedHandPoses[e].setReferenceObject(r.getPlayerObjects(this._myEngine).myReferenceSpace),this._myTrackedHandPoses[e].setForwardFixed(r.isPoseForwardFixed(this._myEngine)),this._myTrackedHandPoses[e].start();this._myGamepadsManager.start()}update(e){this._myMouse.update(e),this._myKeyboard.update(e),this._myHeadPose.setReferenceObject(r.getPlayerObjects(this._myEngine).myReferenceSpace),this._myHeadPose.setForwardFixed(r.isPoseForwardFixed(this._myEngine)),this._myHeadPose.update(e);for(let t in this._myHandPoses)this._myHandPoses[t].setReferenceObject(r.getPlayerObjects(this._myEngine).myReferenceSpace),this._myHandPoses[t].setForwardFixed(r.isPoseForwardFixed(this._myEngine)),this._myHandPoses[t].update(e);for(let t in this._myTrackedHandPoses)this._myTrackedHandPoses[t].setReferenceObject(r.getPlayerObjects(this._myEngine).myReferenceSpace),this._myTrackedHandPoses[t].setForwardFixed(r.isPoseForwardFixed(this._myEngine)),this._myTrackedHandPoses[t].update(e);this._myGamepadsManager.update(e)}getMouse(){return this._myMouse}getKeyboard(){return this._myKeyboard}getGamepadsManager(){return this._myGamepadsManager}getHeadPose(){return this._myHeadPose}getLeftHandPose(){return this._myHandPoses[A.LEFT]}getRightHandPose(){return this._myHandPoses[A.RIGHT]}getHandPose(e){return this._myHandPoses[e]}getHandPoses(){return this._myHandPoses}getLeftTrackedHandPose(){return this._myTrackedHandPoses[A.LEFT]}getRightTrackedHandPose(){return this._myTrackedHandPoses[A.RIGHT]}getTrackedHandPose(e){return this._myTrackedHandPoses[e]}getTrackedHandPoses(){return this._myTrackedHandPoses}destroy(){this._myDestroyed=!0,this._myMouse.destroy(),this._myKeyboard.destroy(),this._myHeadPose.destroy();for(let e in this._myHandPoses)this._myHandPoses[e].destroy();for(let e in this._myTrackedHandPoses)this._myTrackedHandPoses[e].destroy();this._myGamepadsManager.destroy()}isDestroyed(){return this._myDestroyed}};var Vt=class extends sA{init(){this._myInputManager=null,this._myPoseForwardFixedGlobal=null,r.hasInputManager(this.engine)||(this._myInputManager=new Ps(this.engine),r.setInputManager(this._myInputManager,this.engine)),r.hasPoseForwardFixed(this.engine)||(this._myPoseForwardFixedGlobal=this._myPoseForwardFixed,r.setPoseForwardFixed(this._myPoseForwardFixedGlobal,this.engine))}start(){this._myInputManager!=null&&(this._myInputManager.start(),this._setupMousePrevent(),this._addGamepadCores())}update(e){this._myInputManager!=null&&this._myInputManager.update(e)}_setupMousePrevent(){this._myMousePreventContextMenu&&this._myInputManager.getMouse().setContextMenuActive(!1),this._myMousePreventMiddleButtonScroll&&this._myInputManager.getMouse().setMiddleButtonScrollActive(!1)}_addGamepadCores(){let e=this._myInputManager.getLeftHandPose(),t=this._myInputManager.getRightHandPose(),n=new Do(e),o=new Do(t);this._myInputManager.getGamepadsManager().getLeftGamepad().addGamepadCore("pp_left_xr_gamepad",n),this._myInputManager.getGamepadsManager().getRightGamepad().addGamepadCore("pp_right_xr_gamepad",o);let s=new Mo(e),a=new Mo(t);this._myInputManager.getGamepadsManager().getLeftGamepad().addGamepadCore("pp_left_keyboard_gamepad",s),this._myInputManager.getGamepadsManager().getRightGamepad().addGamepadCore("pp_right_keyboard_gamepad",a);let l=new xo(null,e),u=new xo(null,t);this._myInputManager.getGamepadsManager().getLeftGamepad().addGamepadCore("pp_left_classic_gamepad",l),this._myInputManager.getGamepadsManager().getRightGamepad().addGamepadCore("pp_right_classic_gamepad",u)}onDestroy(){this._myInputManager!=null&&r.getInputManager(this.engine)==this._myInputManager&&(r.removeInputManager(this.engine),this._myInputManager.destroy()),this._myPoseForwardFixedGlobal!=null&&r.isPoseForwardFixed(this.engine)==this._myPoseForwardFixedGlobal&&r.removePoseForwardFixed(this.engine)}};R(Vt,"TypeName","pp-input-manager"),R(Vt,"Properties",{_myPoseForwardFixed:Wl.bool(!0),_myMousePreventContextMenu:Wl.bool(!0),_myMousePreventMiddleButtonScroll:Wl.bool(!0)});import{Component as aA,Property as rA}from"@wonderlandengine/api";var di=class extends aA{init(){this._myToolEnabled=null,r.hasToolEnabled(this.engine)||(this._myToolEnabled=this._myEnable,r.setToolEnabled(this._myToolEnabled,this.engine))}onDestroy(){this._myToolEnabled!=null&&r.isToolEnabled(this.engine)==this._myToolEnabled&&r.removeToolEnabled(this.engine)}};R(di,"TypeName","pp-enable-tools"),R(di,"Properties",{_myEnable:rA.bool(!0)});import{Component as TA,Property as PA}from"@wonderlandengine/api";var lA=console.log,mA=console.error,yA=console.warn,uA=console.info,hA=console.debug,cA=console.assert,pA=console.clear;function dA(i=r.getMainEngine(),...e){return Ee.getLog(i).apply(console,e)}function _A(i=r.getMainEngine(),...e){return Ee.getError(i).apply(console,e)}function gA(i=r.getMainEngine(),...e){return Ee.getWarn(i).apply(console,e)}function IP(i=r.getMainEngine(),...e){return Ee.getInfo(i).apply(console,e)}function BP(i=r.getMainEngine(),...e){return Ee.getDebug(i).apply(console,e)}function LP(i=r.getMainEngine(),...e){return Ee.getAssert(i).apply(console,e)}function fA(i=r.getMainEngine(),...e){return Ee.getClear(i).apply(console,e)}function HP(i=r.getMainEngine()){return lA}function kP(i=r.getMainEngine()){return mA}function FP(i=r.getMainEngine()){return yA}function wP(i=r.getMainEngine()){return uA}function jP(i=r.getMainEngine()){return hA}function zP(i=r.getMainEngine()){return cA}function NP(i=r.getMainEngine()){return pA}var Ee={log:dA,error:_A,warn:gA,info:IP,debug:BP,assert:LP,clear:fA,getLog:HP,getError:kP,getWarn:FP,getInfo:wP,getDebug:jP,getAssert:zP,getClear:NP};var Cs=class{constructor(e=r.getMainEngine()){this._myEngine=e,this._myForwardToBrowserConsole=!0}log(...e){this._myForwardToBrowserConsole&&Ee.log(this._myEngine,...e)}error(...e){this._myForwardToBrowserConsole&&Ee.error(this._myEngine,...e)}warn(...e){this._myForwardToBrowserConsole&&Ee.warn(this._myEngine,...e)}info(...e){this._myForwardToBrowserConsole&&Ee.info(this._myEngine,...e)}debug(...e){this._myForwardToBrowserConsole&&Ee.debug(this._myEngine,...e)}assert(...e){this._myForwardToBrowserConsole&&Ee.assert(this._myEngine,...e)}clear(...e){this._myForwardToBrowserConsole&&Ee.clear(this._myEngine,...e)}setForwardToBrowserConsole(e){this._myForwardToBrowserConsole=e}isForwardToBrowserConsole(){return this._myForwardToBrowserConsole}};var It=class extends TA{init(){this._myConsoleVR=null,this._myInit&&(r.hasConsoleVR(this.engine)||(this._myConsoleVR=new Cs(this.engine),r.setConsoleVR(this._myConsoleVR,this.engine)))}onDestroy(){this._myConsoleVR!=null&&r.getConsoleVR(this.engine)==this._myConsoleVR&&r.removeConsoleVR(this.engine)}};R(It,"TypeName","pp-init-console-vr"),R(It,"Properties",{_myInit:PA.bool(!0)});import{Component as CA,Property as bA}from"@wonderlandengine/api";var bs=class{constructor(){this._myVariables=new Map}add(e,t=!1){(t||!this._myVariables.has(e.getName()))&&this._myVariables.set(e.getName(),e)}remove(e){this._myVariables.delete(e)}get(e){let t=this._myVariables.get(e);return t?t.getValue():null}set(e,t,n=!1){let o=this._myVariables.get(e);o&&o.setValue(t,n)}has(e){return this._myVariables.has(e)}length(){return this._myVariables.size}isWidgetCurrentVariable(e){let t=this._myVariables.get(e);return t?t.isWidgetCurrentVariable():!1}getEasyTuneVariable(e){return this._myVariables.get(e)}getEasyTuneVariablesList(){return Array.from(this._myVariables.values())}getEasyTuneVariablesNames(){return Array.from(this._myVariables.keys())}fromJSON(e,t=!1){let n=JSON.parse(e);for(let o of this._myVariables.values()){let s=n[o.getName()];s!==void 0&&o.fromJSON(s,t)}}toJSON(){let e={};for(let t of this._myVariables.values())e[t.getName()]=t.toJSON();return JSON.stringify(e)}registerValueChangedEventListener(e,t,n){this._myVariables.get(e).registerValueChangedEventListener(t,n)}unregisterValueChangedEventListener(e,t,n){this._myVariables.get(e).unregisterValueChangedEventListener(t)}};var Bt=class extends CA{init(){this._myEasyTuneVariables=null,this._myInit&&(r.hasEasyTuneVariables(this.engine)||(this._myEasyTuneVariables=new bs,r.setEasyTuneVariables(this._myEasyTuneVariables,this.engine)))}onDestroy(){this._myEasyTuneVariables!=null&&r.getEasyTuneVariables(this.engine)==this._myEasyTuneVariables&&r.removeEasyTuneVariables(this.engine)}};R(Bt,"TypeName","pp-init-easy-tune-variables"),R(Bt,"Properties",{_myInit:bA.bool(!0)});import{Component as SA,Property as vA}from"@wonderlandengine/api";var _i=class extends SA{init(){this._myAdd&&(r.getWindow(this.engine).PP={},this._addProperties(Ul))}_addProperties(e){let t=Object.getOwnPropertyNames(e);for(let n of t)e[n]!=null&&(r.getWindow(this.engine).PP[n]=e[n])}onDestroy(){r.getWindow(this.engine).PP=void 0}};R(_i,"TypeName","pp-add-pp-to-window"),R(_i,"Properties",{_myAdd:vA.bool(!0)});import{Component as xA,Property as ai}from"@wonderlandengine/api";var Lt=class extends xA{init(){this._myDefaultResources=null,r.hasDefaultResources(this.engine)||(this._myDefaultResources=new ms,this._myDefaultResources.myMeshes.myPlane=Oe.clone(this._myPlane),this._myDefaultResources.myMeshes.myCube=Oe.clone(this._myCube),this._myDefaultResources.myMeshes.mySphere=Oe.clone(this._mySphere),this._myDefaultResources.myMeshes.myCone=Oe.clone(this._myCone),this._myDefaultResources.myMeshes.myCylinder=Oe.clone(this._myCylinder),this._myDefaultResources.myMeshes.myCircle=Oe.clone(this._myCircle),this._myDefaultResources.myMeshes.myInvertedCube=Oe.invert(this._myCube),this._myDefaultResources.myMeshes.myInvertedSphere=Oe.invert(this._mySphere),this._myDefaultResources.myMeshes.myInvertedCone=Oe.invert(this._myCone),this._myDefaultResources.myMeshes.myInvertedCylinder=Oe.invert(this._myCylinder),this._myDefaultResources.myMeshes.myDoubleSidedPlane=Oe.makeDoubleSided(this._myPlane),this._myDefaultResources.myMeshes.myDoubleSidedCube=Oe.makeDoubleSided(this._myCube),this._myDefaultResources.myMeshes.myDoubleSidedSphere=Oe.makeDoubleSided(this._mySphere),this._myDefaultResources.myMeshes.myDoubleSidedCone=Oe.makeDoubleSided(this._myCone),this._myDefaultResources.myMeshes.myDoubleSidedCylinder=Oe.makeDoubleSided(this._myCylinder),this._myDefaultResources.myMeshes.myDoubleSidedCircle=Oe.makeDoubleSided(this._myCircle),this._myFlatOpaque!=null&&(this._myDefaultResources.myMaterials.myFlatOpaque=this._myFlatOpaque.clone()),this._myFlatTransparentNoDepth!=null&&(this._myDefaultResources.myMaterials.myFlatTransparentNoDepth=this._myFlatTransparentNoDepth.clone()),this._myPhongOpaque!=null&&(this._myDefaultResources.myMaterials.myPhongOpaque=this._myPhongOpaque.clone()),this._myText!=null&&(this._myDefaultResources.myMaterials.myText=this._myText.clone()),r.setDefaultResources(this._myDefaultResources,this.engine))}onDestroy(){this._myDefaultResources!=null&&r.getDefaultResources(this.engine)==this._myDefaultResources&&r.removeDefaultResources(this.engine)}};R(Lt,"TypeName","pp-get-default-resources"),R(Lt,"Properties",{_myPlane:ai.mesh(),_myCube:ai.mesh(),_mySphere:ai.mesh(),_myCone:ai.mesh(),_myCylinder:ai.mesh(),_myCircle:ai.mesh(),_myFlatOpaque:ai.material(),_myFlatTransparentNoDepth:ai.material(),_myPhongOpaque:ai.material(),_myText:ai.material()});import{Component as MA,Property as bi}from"@wonderlandengine/api";var Ht=class extends MA{init(){this._mySceneObjects=null,r.hasSceneObjects(this.engine)||(this._mySceneObjects=new ls,this._mySceneObjects.myScene=this._myScene,this._mySceneObjects.myPlayerObjects.myPlayer=this._myPlayer,this._mySceneObjects.myPlayerObjects.myReferenceSpace=this._myReferenceSpace,this._mySceneObjects.myPlayerObjects.myCameraNonXR=this._myCameraNonXR,this._mySceneObjects.myPlayerObjects.myEyeLeft=this._myEyeLeft,this._mySceneObjects.myPlayerObjects.myEyeRight=this._myEyeRight,this._mySceneObjects.myPlayerObjects.myHandLeft=this._myHandLeft,this._mySceneObjects.myPlayerObjects.myHandRight=this._myHandRight,this._mySceneObjects.myPlayerObjects.myEyes=[],this._mySceneObjects.myPlayerObjects.myEyes[A.LEFT]=this._myEyeLeft,this._mySceneObjects.myPlayerObjects.myEyes[A.RIGHT]=this._myEyeRight,this._mySceneObjects.myPlayerObjects.myHands=[],this._mySceneObjects.myPlayerObjects.myHands[A.LEFT]=this._myHandLeft,this._mySceneObjects.myPlayerObjects.myHands[A.RIGHT]=this._myHandRight,this._mySceneObjects.myPlayerObjects.myHead=this._myHead,this._mySceneObjects.myPlayerObjects.myReferenceSpace==null&&(this._mySceneObjects.myPlayerObjects.myReferenceSpace=this._mySceneObjects.myPlayerObjects.myPlayer),this._mySceneObjects.myCauldron=this._mySceneObjects.myScene.pp_addObject(),this._mySceneObjects.myCauldron.pp_setName("Cauldron"),this._mySceneObjects.myDynamics=this._mySceneObjects.myScene.pp_addObject(),this._mySceneObjects.myDynamics.pp_setName("Dynamics"),this._mySceneObjects.myParticles=this._mySceneObjects.myScene.pp_addObject(),this._mySceneObjects.myParticles.pp_setName("Particles"),this._mySceneObjects.myVisualElements=this._mySceneObjects.myScene.pp_addObject(),this._mySceneObjects.myVisualElements.pp_setName("Visual Elements"),this._mySceneObjects.myTools=this._mySceneObjects.myScene.pp_addObject(),this._mySceneObjects.myTools.pp_setName("Tools"),this._mySceneObjects.myPlayerObjects.myCauldron=this._mySceneObjects.myPlayerObjects.myPlayer.pp_addObject(),this._mySceneObjects.myPlayerObjects.myCauldron.pp_setName("Cauldron"),this._mySceneObjects.myPlayerObjects.myHeadDebugs=this._mySceneObjects.myPlayerObjects.myHead.pp_addObject(),this._mySceneObjects.myPlayerObjects.myHeadDebugs.pp_setName("Head Debugs"),r.setSceneObjects(this._mySceneObjects,this.engine))}onDestroy(){this._mySceneObjects!=null&&r.getSceneObjects(this.engine)==this._mySceneObjects&&r.removeSceneObjects(this.engine)}};R(Ht,"TypeName","pp-get-scene-objects"),R(Ht,"Properties",{_myScene:bi.object(),_myPlayer:bi.object(),_myReferenceSpace:bi.object(),_myCameraNonXR:bi.object(),_myEyeLeft:bi.object(),_myEyeRight:bi.object(),_myHandLeft:bi.object(),_myHandRight:bi.object(),_myHead:bi.object()});var GP=new WeakMap,Zi=class extends DA{static onRegister(e){GP.has(e)||(GP.set(e,null),Nl(e))}init(){this._myGetDefaultResourcesComponent=this.object.pp_addComponent(Lt,this._getProperties(Lt.Properties)),this._myGetSceneObjectsComponent=this.object.pp_addComponent(Ht,this._getProperties(Ht.Properties)),this._myEnableDebugComponent=null,this._myEnableDebug&&(this._myEnableDebugComponent=this.object.pp_addComponent(pi,!1)),this._myEnableToolComponent=null,this._myEnableTool&&(this._myEnableToolComponent=this.object.pp_addComponent(di,!1)),this._myAddPPToWindowComponent=null,this._myAddPPToWindow&&(this._myAddPPToWindowComponent=this.object.pp_addComponent(_i,!1)),this._myAddWLToWindowComponent=null,this._myAddWLToWindow&&(this._myAddWLToWindowComponent=this.object.pp_addComponent(ci,!1)),this._myInitConsoleVRComponent=this.object.pp_addComponent(It,!1),this._myInitEasyTuneVariablesComponent=this.object.pp_addComponent(Bt,!1),this._myObjectPoolManagerComponent=this.object.pp_addComponent(Yt,!1),this._myInputManagerComponent=this.object.pp_addComponent(Vt,this._getProperties(Vt.Properties)),this._myAudioManagerComponent=this.object.pp_addComponent(Zt,!1),this._myVisualManagerComponent=this.object.pp_addComponent($t,!1),this._myDebugManagerComponent=this.object.pp_addComponent(ei,!1)}start(){this._myGetDefaultResourcesComponent.active=!0,this._myGetSceneObjectsComponent.active=!0,this._myEnableDebugComponent!=null&&(this._myEnableDebugComponent.active=!0),this._myEnableToolComponent!=null&&(this._myEnableToolComponent.active=!0),this._myAddPPToWindowComponent!=null&&(this._myAddPPToWindowComponent.active=!0),this._myAddWLToWindowComponent!=null&&(this._myAddWLToWindowComponent.active=!0),this._myInitConsoleVRComponent.active=!0,this._myInitEasyTuneVariablesComponent.active=!0,this._myObjectPoolManagerComponent.active=!0,this._myInputManagerComponent.active=!0,this._myAudioManagerComponent.active=!0,this._myVisualManagerComponent.active=!0,this._myDebugManagerComponent.active=!0}_getProperties(e,t=!1){let n={};n.active=t;let o=Object.getOwnPropertyNames(e);for(let s of o)this[s]!=null&&(n[s]=this[s]);return n}};R(Zi,"TypeName","pp-gateway"),R(Zi,"Properties",{_myEnableDebug:Er.bool(!0),_myEnableTool:Er.bool(!0),_myAddPPToWindow:Er.bool(!0),_myAddWLToWindow:Er.bool(!0),...Yt.Properties,...Vt.Properties,...Zt.Properties,...$t.Properties,...ei.Properties,...Ht.Properties,...Lt.Properties});import{Howler as WP}from"howler";function UP(){let i=!1;return WP!=null&&WP.state!="running"&&(i=!0),i}var EA={isPlaybackBlocked:UP};var Ql=class extends kn{constructor(e,t=null){super(t,e),t==null?(this._myAudioSetup.myAudioFilePath=this._myAudio._src,this._myAudioSetup.myLoop=this._myAudio._loop,this._myAudioSetup.myAutoPlay=this._myAudio._autoplay,this._myAudioSetup.myVolume=this._myAudio._volume,this._myAudioSetup.myRate=this._myAudio._rate,this._myAudioSetup.myPool=this._myAudio._pool,this._myAudioSetup.myPreload=this._myAudio._preload,this._myAudioSetup.myPosition=this._myAudio._pos!=null?this._myAudio._pos.vec3_clone():null,this._myAudioSetup.mySpatial=this._myAudio._pos!=null,this._myAudioSetup.myReferenceDistance=this._myAudio._pannerAttr.refDistance):(this._myAudioSetup.myAudioFilePath=this._myAudio._src,this._myAudio.loop(this._myAudioSetup.myLoop),this._myAudio._autoplay=this._myAudioSetup.myAutoPlay,this._myAudio.volume(this._myAudioSetup.myVolume),this._myAudio.rate(this._myAudioSetup.myRate),this._myAudio._pool=this._myAudioSetup.myPool,this._myAudio._preload=this._myAudioSetup.myPreload,this.updatePosition(this._myAudioSetup.myPosition),this._myAudio._pannerAttr.refDistance=this._myAudioSetup.myReferenceDistance,this._myAudioSetup.myAutoPlay&&this._myAudio.play()),this._addListeners()}};import{Component as AA}from"@wonderlandengine/api";import{Howler as RA}from"howler";var Yi=class extends AA{start(){RA.mute(!0)}};R(Yi,"TypeName","pp-mute-everything"),R(Yi,"Properties",{});import{Component as OA}from"@wonderlandengine/api";import{Howler as QP}from"howler";var $i=class extends OA{init(){this._myOrigin=c(),this._myForward=c(),this._myUp=c()}start(){this._updateAudioListener()}update(e){this._updateAudioListener()}_updateAudioListener(){this.object.pp_getPosition(this._myOrigin),this.object.pp_getForward(this._myForward),this.object.pp_getUp(this._myUp),QP.pos(this._myOrigin[0],this._myOrigin[1],this._myOrigin[2]),QP.orientation(this._myForward[0],this._myForward[1],this._myForward[2],this._myUp[0],this._myUp[1],this._myUp[2])}};R($i,"TypeName","pp-spatial-audio-listener"),R($i,"Properties",{});import{Component as VA,PhysXComponent as IA,Property as Pt,Shape as Xl}from"@wonderlandengine/api";import{CollisionEventType as Ss,Emitter as ql,PhysXComponent as qP}from"@wonderlandengine/api";var Si=class{constructor(e,t=!1){this._myPhysX=e,this._myTrigger=t,this._myCollisions=[],this._myCollisionsStart=[],this._myCollisionsEnd=[],this._myUpdateActive=!1,this._myCollisionsStartToProcess=[],this._myCollisionsEndToProcess=[],this._myCollisionCallbackID=null,this._myActive=!1,this.setActive(!0),this._myLogEnabled=!1,this._myTriggerDesyncFixDelay=new ne(.1),this._myCollisionEmitter=new ql,this._myCollisionStartEmitter=new ql,this._myCollisionEndEmitter=new ql,this._myDestroyed=!1}getPhysX(){return this._myPhysX}getCollisions(){return this._myCollisions}getCollisionsStart(){return this._myCollisionsStart}getCollisionsEnd(){return this._myCollisionsEnd}isActive(){return this._myActive}setActive(e){this._myActive!=e&&(this._myActive=e,this._myCollisions=[],this._myCollisionsStart=[],this._myCollisionsEnd=[],this._myUpdateActive=!1,this._myCollisionsStartToProcess=[],this._myCollisionsEndToProcess=[],this._myActive?this._myCollisionCallbackID=this._myPhysX.onCollision(this._onCollision.bind(this)):this._myCollisionCallbackID!=null&&(this._myPhysX.removeCollisionCallback(this._myCollisionCallbackID),this._myCollisionCallbackID=null))}setUpdateActive(e){this._myUpdateActive=e}update(e){!this._myActive||(this._myUpdateActive=!0,this._myCollisionsStart=this._myCollisionsStartToProcess,this._myCollisionsStartToProcess=[],this._myCollisionsEnd=this._myCollisionsEndToProcess,this._myCollisionsEndToProcess=[],this._myTrigger&&this._triggerDesyncFix(e))}isLogEnabled(){return this._myLogEnabled}setLogEnabled(e){this._myLogEnabled=e}registerCollisionEventListener(e,t){this._myCollisionEmitter.add(t,{id:e})}unregisterCollisionEventListener(e){this._myCollisionEmitter.remove(e)}registerCollisionStartEventListener(e,t){this._myCollisionStartEmitter.add(t,{id:e})}unregisterCollisionStartEventListener(e){this._myCollisionStartEmitter.remove(e)}registerCollisionEndEventListener(e,t){this._myCollisionEndEmitter.add(t,{id:e})}unregisterCollisionEndEventListener(e){this._myCollisionEndEmitter.remove(e)}_onCollision(e,t){e==Ss.Touch||e==Ss.TriggerTouch?this._onCollisionStart(e,t):(e==Ss.TouchLost||e==Ss.TriggerTouchLost)&&this._onCollisionEnd(e,t),this._myCollisionEmitter.notify(this._myPhysX,t,e)}_onCollisionStart(e,t){if(this._myLogEnabled){let n=!1;for(let o of this._myCollisions)if(o.pp_equals(t.object)){n=!0;break}n&&console.error("Collision Start on object already collected")}this._myCollisions.push(t.object),this._myUpdateActive&&(this._myCollisionsStartToProcess.push(t.object),this._myCollisionsEndToProcess.pp_removeAll(function(n){return n.pp_equals(t.object)})),this._myLogEnabled&&console.log("Collision Start -",this._myCollisions.length),this._myCollisionStartEmitter.notify(this._myPhysX,t,e)}_onCollisionEnd(e,t){if(this._myLogEnabled){let n=!1;for(let o of this._myCollisions)if(o.pp_equals(t.object)){n=!0;break}n||console.error("Collision End on object not collected")}this._myCollisions.pp_removeAll(function(n){return n.pp_equals(t.object)}),this._myUpdateActive&&(this._myCollisionsEndToProcess.push(t.object),this._myCollisionsStartToProcess.pp_removeAll(function(n){return n.pp_equals(t.object)})),this._myLogEnabled&&console.log("Collision End -",this._myCollisions.length),this._myCollisionEndEmitter.notify(this._myPhysX,t,e)}_triggerDesyncFix(e){if(this._myTriggerDesyncFixDelay.update(e),this._myTriggerDesyncFixDelay.isDone()){this._myTriggerDesyncFixDelay.start();let t=this._myCollisions.pp_findAll(function(n){let o=n.pp_getComponentSelf(qP);return o==null||!o.active});if(t.length>0)for(let n of t){let o=n.pp_getComponentSelf(qP);o?this._onCollisionEnd(Ss.TriggerTouchLost,o):console.error("NO PHYSX, HOW?")}}}destroy(){this._myDestroyed=!0,this._myCollisionCallbackID!=null&&(this._myPhysX.removeCollisionCallback(this._myCollisionCallbackID),this._myCollisionCallbackID=null)}isDestroyed(){return this._myDestroyed}};var en=class extends VA{start(){this._myValid=!1,r.isDebugEnabled(this.engine)&&(this._myValid=!0,this._myStarted=!1,this._myPreStartTimer=new ne(1))}_start(){this._myParentObject=this.object.pp_addObject(),this._myRaycastParams=new ct(r.getPhysics(this.engine)),this._myRaycastResults=new Fe,this._myStaticPhysXObjects=[],this._myStaticPhysXComponents=[],this._myStaticPhysXCollectors=[],this._myDynamicPhysXObjects=[],this._myDynamicPhysXComponents=[],this._myDynamicPhysXCollectors=[],this._myKinematicPhysXObjects=[],this._myKinematicPhysXComponents=[],this._myKinematicPhysXCollectors=[],this._spawnDome(!0,!1),this._spawnDome(!1,!1),this._spawnDome(!1,!0),this._myStartTimer=new ne(1),this._myTimer=new ne(0),this._myDebugTimer=new ne(this._myVisualizeRaycastDelay),this._myLogEnabledTimer=new ne(1),this._myFPSHistory=[];for(let e=0;e<7;e++)this._myFPSHistory.push(0);this._myAddVelocityDelay=10,this._myTranslateVec3=c(),this._myRotateVec3=c(),this._myStarted=!0}update(e){if(!!this._myValid)if(!this._myStarted)this._myPreStartTimer.update(e),this._myPreStartTimer.isDone()&&this._start();else{if(this._myStartTimer.update(e),this._myStartTimer.isDone()){if(this._myTimer.update(e),this._myDebugTimer.update(e),this._myLogEnabledTimer.update(e),this._myTimer.isDone()){this._myTimer.start();let t=!1;this._myDebugTimer.isDone()&&(this._myDebugTimer.start(),t=!0),t=t&&this._myVisualizeRaycast,this._raycastTest(t)}if(this._myFPSHistory.pop(),this._myFPSHistory.unshift(Math.round(1/e)),this._myLogEnabled&&this._myLogEnabledTimer.isDone()){this._myLogEnabledTimer.start(),this._myClearConsoleBeforeLog&&console.clear(),console.log("Static PhysX Dome Size:",this._myStaticPhysXObjects.length),console.log("Dynamic PhysX Dome Size:",this._myDynamicPhysXObjects.length),console.log("Kinematic PhysX Dome Size:",this._myKinematicPhysXObjects.length);let t=0;for(let l of this._myStaticPhysXCollectors)t+=l.getCollisions().length;let n=0;for(let l of this._myDynamicPhysXCollectors)n+=l.getCollisions().length;let o=0;for(let l of this._myKinematicPhysXCollectors)o+=l.getCollisions().length;let s=(t+n+o)/2;console.log("Current Collisions Count:",s),console.log("Raycast Count:",this._myRaycastCount),console.log("FPS History:");let a="";for(let l of this._myFPSHistory)a=a.concat(l,`
`);console.log(a)}}if(this._myAddVelocityDelay>0&&(this._myAddVelocityDelay--,this._myAddVelocityDelay==0))for(let t of this._myDynamicPhysXComponents){t.kinematic=!1;let n=50;t.linearVelocity=[Math.pp_random(-n,n),Math.pp_random(-n,n),Math.pp_random(-n,n)],t.angularVelocity=[Math.pp_random(-n,n),Math.pp_random(-n,n),Math.pp_random(-n,n)]}for(let t of this._myKinematicPhysXObjects){let n=5*e;this._myTranslateVec3.vec3_set(Math.pp_random(-n,n),Math.pp_random(-n,n),Math.pp_random(-n,n)),t.pp_translate(this._myTranslateVec3);let o=50*e;this._myRotateVec3.vec3_set(Math.pp_random(-o,o),Math.pp_random(-o,o),Math.pp_random(-o,o)),t.pp_rotate(this._myRotateVec3)}}}_raycastTest(e){let t=this._myRaycastCount,n=1e4;for(let o=0;o<t;o++){let s=[Math.pp_random(1,2)*Math.pp_randomSign(),Math.pp_random(1,2)*Math.pp_randomSign(),Math.pp_random(1,2)*Math.pp_randomSign()],a=[Math.pp_random(-1,1),Math.pp_random(-1,1),Math.pp_random(-1,1)];a.vec3_normalize(a),this._myRaycastParams.myOrigin.vec3_copy(s),this._myRaycastParams.myDirection.vec3_copy(a),this._myRaycastParams.myDistance=n,this._myRaycastParams.myBlockLayerFlags.setAllFlagsActive();let l=De.raycast(this._myRaycastParams,this._myRaycastResults);e&&r.isDebugEnabled(this.engine)&&r.getDebugVisualManager(this.engine).drawRaycast(this._myDebugTimer.getDuration(),l,!0,5,.015)}}_spawnDome(e,t){let n=this._myStaticPhysXCount,o=this._myStaticPhysXObjects,s=Math.ceil(Math.sqrt(this._myStaticPhysXCount));e||(t?(s=Math.ceil(Math.sqrt(this._myDynamicPhysXCount)),n=this._myDynamicPhysXCount,o=this._myDynamicPhysXObjects):(s=Math.ceil(Math.sqrt(this._myKinematicPhysXCount)),n=this._myKinematicPhysXCount,o=this._myKinematicPhysXObjects));let a=Math.PI*2/s,l=Math.max(0,this._myStaticDomeSize-20),u=this._myStaticDomeSize+20;e||(t?(l=Math.max(0,this._myDynamicDomeSize-20),u=this._myDynamicDomeSize+20):(l=Math.max(0,this._myKinematicDomeSize-20),u=this._myKinematicDomeSize+20));let _=0,m=Math.pp_toRadians(10),h=c(0,1,0),d=c(0,0,-1);for(let g=0;g<s/2;g++){let P=c(0,1,0),C=c();d.vec3_cross(P,C),C.vec3_normalize(C);for(let f=0;f<s;f++){if(o.length<n){let S=Math.random()*(u-l)+l,M=(Math.random()*2-1)*(m-_)+_,D=(Math.random()*2-1)*(m-_)+_,v=P.pp_clone();v.vec3_rotateAxisRadians(M,C,v),v.vec3_rotateAxisRadians(D,h,v),v.vec3_scale(S,v),this._addPhysX(v,e,t)}if(P.vec3_rotateAxisRadians(a/2,C,P),o.length<n){let S=Math.random()*(u-l)+l,M=(Math.random()*2-1)*(m-_)+_,D=(Math.random()*2-1)*(m-_)+_,v=P.pp_clone();v.vec3_rotateAxisRadians(M,C,v),v.vec3_rotateAxisRadians(D,h,v),v.vec3_scale(S,v),this._addPhysX(v,e,t)}P.vec3_rotateAxisRadians(a/2,C,P)}d.vec3_rotateAxisRadians(a,h,d)}}_addPhysX(e,t,n){let o=e,s=Math.pp_random(1,10),a=Math.pp_randomPick(Xl.Sphere,Xl.Box);this._myUseConvexMesh&&(a=Xl.ConvexMesh,s*=this._myShapeScaleMultiplier);let l=this._myParentObject.pp_addObject();l.pp_setPosition(o);let u=l.pp_addComponent(IA,{shape:a,shapeData:{index:this._myShapeIndex},extents:c(s,s,s),static:t,kinematic:!n,mass:1});t?(this._myStaticPhysXObjects.push(l),this._myStaticPhysXComponents.push(u),this._myStaticPhysXCollectors.push(new Si(u))):n?(this._myDynamicPhysXObjects.push(l),this._myDynamicPhysXComponents.push(u),this._myDynamicPhysXCollectors.push(new Si(u))):(this._myKinematicPhysXObjects.push(l),this._myKinematicPhysXComponents.push(u),this._myKinematicPhysXCollectors.push(new Si(u)))}onDestroy(){for(let e of this._myStaticPhysXCollectors)e.destroy();for(let e of this._myDynamicPhysXCollectors)e.destroy();for(let e of this._myKinematicPhysXCollectors)e.destroy()}};R(en,"TypeName","pp-benchmark-max-physx"),R(en,"Properties",{_myStaticDomeSize:Pt.float(40),_myStaticPhysXCount:Pt.int(1e3),_myDynamicDomeSize:Pt.float(80),_myDynamicPhysXCount:Pt.int(250),_myKinematicDomeSize:Pt.float(120),_myKinematicPhysXCount:Pt.int(250),_myRaycastCount:Pt.int(100),_myVisualizeRaycast:Pt.bool(!1),_myVisualizeRaycastDelay:Pt.float(.5),_myUseConvexMesh:Pt.bool(!1),_myShapeIndex:Pt.int(0),_myShapeScaleMultiplier:Pt.float(1),_myLogEnabled:Pt.bool(!0),_myClearConsoleBeforeLog:Pt.bool(!0)});import{Alignment as Ar,Component as BA,Justification as Rr,MeshComponent as Or,Property as pt,TextComponent as Vr}from"@wonderlandengine/api";var tn=class extends BA{_start(){this._myBackgroundSize=4,this._myBackgroundObject.pp_setActive(!0),this._myBackgroundObject.pp_setScale(this._myBackgroundSize+.1),this._myBackgroundObject.pp_translateLocal(c(0,0,-.001)),this._myDoubleTimer=new ne(this._mySecondsBeforeDoubling),this._myDone=!1,this._myCurrentPlanes=this._myStartPlaneCount,this._myDTHistory=[],this._myUpperLimit=-1,this._myLowerLimit=0,this._myPlanes=[],this._mySkipNextFrames=0,this._myMaxWaitFrames=0,this._myMaxPlanesReached=!1,this._myFirstTime=!0}_update(e){{if(e<1e-5)return;if(e>.5&&this._myMaxWaitFrames>0){this._myMaxWaitFrames--;return}if(this._myMaxWaitFrames=10,this._mySkipNextFrames>0){this._mySkipNextFrames--;return}}if(!this._myDone&&(this._myDoubleTimer.update(e),this._myDTHistory.push(e),this._myDoubleTimer.isDone())){this._myDoubleTimer.start();let t=this._computeAverageFrameRate(!1);if(this._myFirstTime)this._myFirstTime=!1;else{let n=!1;t<this._myStableFrameRate-this._myTargetFrameRateThreshold?(this._myUpperLimit=this._myCurrentPlanes,n=!0,this._myUpperLimit==1&&(this._myLowerLimit=1)):(this._myLowerLimit=this._myCurrentPlanes,this._myUpperLimit>0&&(this._myUpperLimit=Math.max(this._myUpperLimit,this._myLowerLimit))),this._myTriangleTextComponent.text="Triangles: "+this._myCurrentPlanes*this._myRealTrianglesAmount,this._myPlaneTextComponent.text="Planes: "+this._myCurrentPlanes,this._myFPSTextComponent.text="FPS: "+t+" / "+this._myStableFrameRate,n?(this._myTriangleTextComponent.material.color=this._myLagColor,this._myPlaneTextComponent.material.color=this._myLagColor,this._myFPSTextComponent.material.color=this._myLagColor):(this._myTriangleTextComponent.material.color=this._myNormalColor,this._myPlaneTextComponent.material.color=this._myNormalColor,this._myFPSTextComponent.material.color=this._myNormalColor);let o=!1;(this._myUpperLimit>0&&!n&&this._myUpperLimit-this._myLowerLimit<=Math.max(2,1e3/this._myRealTrianglesAmount)||n&&this._myUpperLimit-this._myLowerLimit<=1||!n&&this._myMaxPlanesReached)&&(t<this._myStableFrameRate-this._myTargetFrameRateThreshold?(this._myLowerLimit=Math.max(1,Math.floor(this._myUpperLimit/2.5)),this._myUpperLimit=0,o=!0,this._myLogEnabled&&console.log("Rst - Triangles:",this._myCurrentPlanes*this._myRealTrianglesAmount,"- Planes:",this._myCurrentPlanes,"- Frame Rate:",t)):(this._myMaxPlanesReached?this._myLogEnabled&&(console.log("Aborted - Max Planes Reached"),this._myDoneTextComponent.text="Aborted - Max Planes Reached"):(this._displayPlanes(this._myLowerLimit),this._myLogEnabled&&(console.log(`
End - Triangles:`,this._myLowerLimit*this._myRealTrianglesAmount,"- Planes:",this._myLowerLimit,"- Frame Rate:",t),console.log("Plane Triangles (Adjusted):",this._myRealTrianglesAmount),console.log("Target Frame Rate:",this._myStableFrameRate,"- Threshold: ",this._myStableFrameRate-this._myTargetFrameRateThreshold)),this._myTriangleTextComponent.text="Triangles: "+this._myLowerLimit*this._myRealTrianglesAmount,this._myPlaneTextComponent.text="Planes: "+this._myLowerLimit,this._myFPSTextComponent.text="FPS: "+t+" / "+this._myStableFrameRate,this._myDoneTextComponent.text="End"),this._myDone=!0)),n&&!o&&this._myLogEnabled&&console.log("Lag - Triangles:",this._myCurrentPlanes*this._myRealTrianglesAmount,"- Planes:",this._myCurrentPlanes,"- Frame Rate:",t),this._myDone||(this._myUpperLimit>0?(this._myCurrentPlanes=Math.floor((this._myUpperLimit+this._myLowerLimit)/2),this._myCurrentPlanes=Math.max(this._myCurrentPlanes,1)):o?this._myCurrentPlanes=this._myLowerLimit:this._myCurrentPlanes=this._myLowerLimit*2,this._myCurrentPlanes>5e4?(this._myCurrentPlanes=5e4,this._myMaxPlanesReached=!0):this._myMaxPlanesReached=!1)}this._myDone||(this._displayPlanes(this._myCurrentPlanes),this._myElapsedTime=0,this._myFrameCount=0,this._mySkipNextFrames=30)}}_displayPlanes(e){for(;this._myPlanes.length>e;){let l=this._myPlanes.pop();r.getObjectPoolManager(this.engine).release(this._myPoolID,l)}for(;this._myPlanes.length<e;){let l=r.getObjectPoolManager(this.engine).get(this._myPoolID);this._myPlanes.push(l)}let t=1;for(;t*t<e;)t++;let n=.01,o=n*(t-1),s=(this._myBackgroundSize*2-o)/(t*2),a=e;for(let l=0;l<t&&a>0;l++)for(let u=0;u<t&&a>0;u++){let _=this._myPlanes[a-1];_.pp_setScale(s);let m=[-this._myBackgroundSize+s+u*s*2+u*n,this._myBackgroundSize-s-l*s*2-l*n,0];_.pp_setPositionLocal(m),_.pp_setActive(!0),a--}}start(){if(this._myValid=!1,!r.isDebugEnabled(this.engine))return;this._myValid=!0,this._myPlaneMaterial==null&&(this._myPlaneMaterial=r.getDefaultMaterials(this.engine).myPhongOpaque.clone(),this._myPlaneMaterial.diffuseColor=F(.95,.95,.95,1),this._myPlaneMaterial.ambientColor=F(0,0,0,1),this._myPlaneMaterial.ambientFactor=.5),this._myBackgroundMaterial==null&&(this._myBackgroundMaterial=r.getDefaultMaterials(this.engine).myPhongOpaque.clone(),this._myBackgroundMaterial.diffuseColor=F(.25,.25,.25,1),this._myBackgroundMaterial.ambientColor=F(0,0,0,1),this._myBackgroundMaterial.ambientFactor=.5),this._myTextMaterial==null&&(this._myTextMaterial=r.getDefaultMaterials(this.engine).myText.clone()),this._myLagColor=F(.6,0,0,1),this._myNormalColor=F(.25,.25,.25,1),this._myRealTrianglesAmount=0;let e=this.object;this._myDisplayInFrontOfPlayer&&(e=r.getPlayerObjects(this.engine).myHead.pp_addObject(),e.pp_rotateAxis(180,c(0,1,0)),e.pp_translateLocal(c(0,0,this._myDisplayInFrontOfPlayerDistance))),this._myTrianglesObject=e.pp_addObject(),this._myBackgroundObject=this._myTrianglesObject.pp_addObject();{let n=this._myBackgroundObject.pp_addComponent(Or);n.mesh=Oe.createPlane(this.engine),n.material=this._myBackgroundMaterial.clone()}this._myPlaneObject=this._myTrianglesObject.pp_addObject();{let n=this._myPlaneObject.pp_addComponent(Or);n.mesh=this._createPlaneMesh(this._myPlaneTriangles),this._myRealTrianglesAmount=n.mesh.indexData.length/3,n.material=this._myPlaneMaterial.clone()}let t=new Fn;this._myCloneMesh?this._myRealTrianglesAmount<=4?t.myInitialPoolSize=15e3:this._myRealTrianglesAmount<=8?t.myInitialPoolSize=1e4:this._myRealTrianglesAmount<=64?t.myInitialPoolSize=7500:t.myInitialPoolSize=5e3:t.myInitialPoolSize=3e4,t.myPercentageToAddWhenEmpty=0,t.myAmountToAddWhenEmpty=1e4,t.myCloneParams=new Xt,t.myCloneParams.myComponentDeepCloneParams.setDeepCloneComponentVariable(Or.TypeName,"material",this._myCloneMaterial),t.myCloneParams.myComponentDeepCloneParams.setDeepCloneComponentVariable(Or.TypeName,"mesh",this._myCloneMesh),this._myPoolID=this.type+"_"+Math.pp_randomUUID(),r.getObjectPoolManager(this.engine).addPool(this._myPoolID,new wn(this._myPlaneObject,t)),this._myBackgroundObject.pp_setActive(!1),this._myPlaneObject.pp_setActive(!1),this._myStartTimer=new ne(2),this._mySessionStarted=!1,this._myTextsObject=this._myTrianglesObject.pp_addObject(),this._myTriangleTextObject=this._myTextsObject.pp_addObject(),this._myTriangleTextComponent=this._myTriangleTextObject.pp_addComponent(Vr),this._myTriangleTextComponent.alignment=Ar.Left,this._myTriangleTextComponent.justification=Rr.Line,this._myTriangleTextComponent.material=this._myTextMaterial.clone(),this._myTriangleTextComponent.material.color=this._myNormalColor,this._myTriangleTextComponent.text=" ",this._myPlaneTextObject=this._myTextsObject.pp_addObject(),this._myPlaneTextComponent=this._myPlaneTextObject.pp_addComponent(Vr),this._myPlaneTextComponent.alignment=Ar.Left,this._myPlaneTextComponent.justification=Rr.Line,this._myPlaneTextComponent.material=this._myTextMaterial.clone(),this._myPlaneTextComponent.material.color=this._myNormalColor,this._myPlaneTextComponent.text=" ",this._myFPSTextObject=this._myTextsObject.pp_addObject(),this._myFPSTextComponent=this._myFPSTextObject.pp_addComponent(Vr),this._myFPSTextComponent.alignment=Ar.Left,this._myFPSTextComponent.justification=Rr.Line,this._myFPSTextComponent.material=this._myTextMaterial.clone(),this._myFPSTextComponent.material.color=this._myNormalColor,this._myFPSTextComponent.text=" ",this._myDoneTextObject=this._myTrianglesObject.pp_addObject(),this._myDoneTextComponent=this._myDoneTextObject.pp_addComponent(Vr),this._myDoneTextComponent.alignment=Ar.Center,this._myDoneTextComponent.justification=Rr.Line,this._myDoneTextComponent.material=this._myTextMaterial.clone(),this._myDoneTextComponent.material.color=this._myNormalColor,this._myDoneTextComponent.text=" ",this._myTextsObject.pp_setPositionLocal(c(0,4.3,0)),this._myTextsObject.pp_setScale(2.75),this._myTriangleTextObject.pp_setPositionLocal(c(-1.4,0,0)),this._myPlaneTextObject.pp_setPositionLocal(c(.55,0,0)),this._myFPSTextObject.pp_setPositionLocal(c(-.315,0,0)),this._myDoneTextObject.pp_setPositionLocal(c(0,-4.6,0)),this._myDoneTextObject.pp_setScale(4),this._myDTHistory=[],this._myFramesToSkip=10}update(e){!this._myValid||(this._myFramesToSkip==0?this._mySessionStarted||!this._myStartOnXRStart?this._myStartTimer.isRunning()?(this._myStartTimer.update(e),this._myDTHistory.push(e),this._myStartTimer.isDone()&&(this._myStableFrameRate=this._computeAverageFrameRate(!0),this._myTargetFrameRate>0&&(this._myStableFrameRate=this._myTargetFrameRate),this._myLogEnabled&&(console.log(`
Plane Triangles (Adjusted):`,this._myRealTrianglesAmount),console.log("Target Frame Rate:",this._myStableFrameRate,"- Threshold: ",this._myStableFrameRate-this._myTargetFrameRateThreshold),console.log("")),this._start())):this._update(e):this._mySessionStarted=I.getSession(this.engine)!=null:this._myFramesToSkip--)}_computeAverageFrameRate(e){let t=0;this._myDTHistory.sort();let n=Math.floor(this._myDTHistory.length*Math.min(.9,this._myDTHistoryToIgnorePercentage*(e?2:1)));for(let s=0;s<n&&this._myDTHistory.length>1;s++)this._myDTHistory.pop();let o=0;for(let s of this._myDTHistory)o+=s;return o/=this._myDTHistory.length,t=Math.round(1/o),this._myDTHistory=[],t}_createPlaneMesh(e){let t=Math.ceil(e/2),n=1,o=1,s=1;for(;s*s<t;)s++;for(n=s,o=s;n>1&&o>1&&n*o>t&&(n-1)*o>=t;)n--;let a=new Co(this.engine);for(let u=0;u<n+1;u++)for(let _=0;_<o+1;_++){let m=2/o*_,h=2/n*u,d=new Po;d.myPosition=c(),d.myPosition[0]=m-1,d.myPosition[1]=h-1,d.myPosition[2]=0,d.myTextureCoordinates=Ae(),d.myTextureCoordinates[0]=m/2,d.myTextureCoordinates[1]=h/2,d.myNormal=c(),d.myNormal[0]=0,d.myNormal[1]=0,d.myNormal[2]=1,a.myVertexes.push(d)}for(let u=0;u<n;u++)for(let _=0;_<o;_++){let m=new Ii;m.myIndexes[0]=u*(o+1)+_,m.myIndexes[1]=u*(o+1)+_+1,m.myIndexes[2]=(u+1)*(o+1)+_;let h=new Ii;h.myIndexes[0]=(u+1)*(o+1)+_,h.myIndexes[1]=u*(o+1)+_+1,h.myIndexes[2]=(u+1)*(o+1)+_+1,a.myTriangles.push(m),a.myTriangles.push(h)}return Oe.create(a)}onDestroy(){r.getObjectPoolManager(this.engine)?.removePool(this._myPoolID)}};R(tn,"TypeName","pp-benchmark-max-visible-triangles"),R(tn,"Properties",{_myTargetFrameRate:pt.int(-1),_myTargetFrameRateThreshold:pt.int(3),_myStartPlaneCount:pt.int(1),_myPlaneTriangles:pt.int(100),_mySecondsBeforeDoubling:pt.float(.5),_myDTHistoryToIgnorePercentage:pt.float(.25),_myCloneMaterial:pt.bool(!1),_myCloneMesh:pt.bool(!1),_myLogEnabled:pt.bool(!0),_myStartOnXRStart:pt.bool(!1),_myDisplayInFrontOfPlayer:pt.bool(!0),_myDisplayInFrontOfPlayerDistance:pt.float(10),_myPlaneMaterial:pt.material(),_myBackgroundMaterial:pt.material(),_myTextMaterial:pt.material(null)});import{Emitter as Xn}from"@wonderlandengine/api";function XP(i,e){e!=null&&localStorage.setItem(i,e)}function LA(i){return Nt.loadString(i,null)!=null}function HA(i){return localStorage.removeItem(i)}function kA(){return localStorage.clear()}function KP(i,e=null){return Nt.loadString(i,e)}function JP(i,e=null){let t=localStorage.getItem(i);return t==null&&(t=e),t}function ZP(i,e=null){let t=Nt.loadString(i);return t!=null?Number(t):e}function YP(i,e=null){let t=Nt.loadString(i);return t=="true"?!0:t=="false"?!1:e}var Nt={save:XP,has:LA,remove:HA,clear:kA,load:KP,loadString:JP,loadNumber:ZP,loadBool:YP};var Kl=class{constructor(e=r.getMainEngine()){this._myEngine=e,this._mySaveCache=new Map,this._myCacheEnabled=!0,this._myCommitSavesDelayTimer=new ne(0,!1),this._myDelaySavesCommit=!0,this._myIDsToCommit=[],this._myCacheDefaultValueOnFail=!0,I.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this._myEngine),this._myClearEmitter=new Xn,this._myDeleteEmitter=new Xn,this._myDeleteIDEmitters=new Map,this._mySaveEmitter=new Xn,this._mySaveValueChangedEmitter=new Xn,this._mySaveIDEmitters=new Map,this._mySaveValueChangedIDEmitters=new Map,this._myCommitSaveEmitter=new Xn,this._myCommitSaveIDEmitters=new Map,this._myCommitSavesEmitter=new Xn,this._myLoadEmitter=new Xn,this._myLoadIDEmitters=new Map,this._myVisibilityChangeEventListener=null,this._myDestroyed=!1}setCommitSavesDelay(e){this._myCommitSavesDelayTimer.start(e)}setDelaySavesCommit(e){this._myDelaySavesCommit=e}setCacheDefaultValueOnFail(e){this._myCacheDefaultValueOnFail=e}setCacheEnabled(e){this._myCacheEnabled=e}update(e){this._myCommitSavesDelayTimer.isRunning()&&(this._myCommitSavesDelayTimer.update(e),this._myCommitSavesDelayTimer.isDone()&&this.commitSaves())}save(e,t,n=null,o=null){let s=!1;if(this._mySaveCache.has(e)&&this._isCacheEnabled(o)&&(s=this._mySaveCache.get(e)===t),!s)if(this._mySaveCache.set(e,t),this._myDelaySavesCommit&&n==null||n!=null&&n)this._myIDsToCommit.pp_pushUnique(e),this._myCommitSavesDelayTimer.isRunning()||this._myCommitSavesDelayTimer.start();else{let a=this._commitSave(e,!1),l=!1;this._myCommitSavesEmitter.notify(l,a)}if(this._mySaveEmitter.notify(e,t),this._mySaveIDEmitters.size>0){let a=this._mySaveIDEmitters.get(e);a?.notify(e,t)}if(!s&&(this._mySaveValueChangedEmitter.notify(e,t),this._mySaveValueChangedIDEmitters.size>0)){let a=this._mySaveValueChangedIDEmitters.get(e);a?.notify(e,t)}}commitSaves(){if(this._myIDsToCommit.length>0){let e=!1;for(let n of this._myIDsToCommit)if(this._mySaveCache.has(n)){let o=this._commitSave(n,!0);e=e||o}this._myIDsToCommit=[];let t=!0;this._myCommitSavesEmitter.notify(t,e)}}has(e,t=null){return this._mySaveCache.has(e)&&this._isCacheEnabled(t)||Nt.has(e)}remove(e){if(this._mySaveCache.delete(e),Nt.remove(e),this._myDeleteEmitter.notify(e),this._myDeleteIDEmitters.size>0){let t=this._myDeleteIDEmitters.get(e);t?.notify(e)}}clear(){this._mySaveCache.clear(),Nt.clear(),this._myClearEmitter.notify()}load(e,t=null,n=null){return this._load(e,t,"load",n)}loadString(e,t=null,n=null){return this._load(e,t,"loadString",n)}loadNumber(e,t=null,n=null){return this._load(e,t,"loadNumber",n)}loadBool(e,t=null,n=null){return this._load(e,t,"loadBool",n)}getCommitSavesDelay(){return this._myCommitSavesDelayTimer.getDuration()}isDelaySavesCommit(){return this._myDelaySavesCommit}isCacheDefaultValueOnFail(){return this._myCacheDefaultValueOnFail}isCacheEnabled(){return this._myCacheEnabled}_commitSave(e,t){let n=this._mySaveCache.get(e),o=!1;try{Nt.save(e,n)}catch{o=!0}if(this._myCommitSaveEmitter.notify(e,n,t,o),this._myCommitSaveIDEmitters.size>0){let s=this._myCommitSaveIDEmitters.get(e);s?.notify(e,n,t,o)}return o}_load(e,t,n,o=null){let s=null,a=!1,l=!1;if(this._mySaveCache.has(e)&&this._isCacheEnabled(o))s=this._mySaveCache.get(e),s==null&&t!=null&&(s=t,this._myCacheDefaultValueOnFail&&this._mySaveCache.set(e,s)),l=!0;else{let u=null;try{u=Nt[n](e,null)}catch{u=null,a=!0}u==null?s=t:s=u,u!=null||this._myCacheDefaultValueOnFail?this._mySaveCache.set(e,s):this._mySaveCache.set(e,null)}if(this._myLoadEmitter.notify(e,s,l,a),this._myLoadIDEmitters.size>0){let u=this._myLoadIDEmitters.get(e);u?.notify(e,s,l,a)}return s}_onXRSessionStart(e){this._myVisibilityChangeEventListener=function(t){t.session.visibilityState!="visible"&&this._onXRSessionInterrupt()}.bind(this),e.addEventListener("visibilitychange",this._myVisibilityChangeEventListener)}_onXRSessionEnd(){this._myVisibilityChangeEventListener=null,this._onXRSessionInterrupt()}_onXRSessionInterrupt(){this.commitSaves()}registerClearEventListener(e,t){this._myClearEmitter.add(t,{id:e})}unregisterClearEventListener(e){this._myClearEmitter.remove(e)}registerDeleteEventListener(e,t){this._myDeleteEmitter.add(t,{id:e})}unregisterDeleteEventListener(e){this._myDeleteEmitter.remove(e)}registerDeleteIDEventListener(e,t,n){let o=this._myDeleteIDEmitters.get(e);o==null&&(this._myDeleteIDEmitters.set(e,new Map),o=this._myDeleteIDEmitters.get(e)),o.add(n,{id:t})}unregisterDeleteIDEventListener(e,t){let n=this._myDeleteIDEmitters.get(e);n!=null&&(n.remove(t),n.size<=0&&this._myDeleteIDEmitters.delete(e))}registerSaveEventListener(e,t){this._mySaveEmitter.add(t,{id:e})}unregisterSaveEventListener(e){this._mySaveEmitter.remove(e)}registerSaveIDEventListener(e,t,n){let o=this._mySaveIDEmitters.get(e);o==null&&(this._mySaveIDEmitters.set(e,new Map),o=this._mySaveIDEmitters.get(e)),o.add(n,{id:t})}unregisterSaveIDEventListener(e,t){let n=this._mySaveIDEmitters.get(e);n!=null&&(n.remove(t),n.size<=0&&this._mySaveIDEmitters.delete(e))}registerSaveValueChangedEventListener(e,t){this._mySaveValueChangedEmitter.add(t,{id:e})}unregisterSaveValueChangedEventListener(e){this._mySaveValueChangedEmitter.remove(e)}registerSaveValueChangedIDEventListener(e,t,n){let o=this._mySaveValueChangedIDEmitters.get(e);o==null&&(this._mySaveValueChangedIDEmitters.set(e,new Map),o=this._mySaveValueChangedIDEmitters.get(e)),o.add(n,{id:t})}unregisterSaveValueChangedIDEventListener(e,t){let n=this._mySaveValueChangedIDEmitters.get(e);n!=null&&(n.remove(t),n.size<=0&&this._mySaveValueChangedIDEmitters.delete(e))}registerCommitSavesEventListener(e,t){this._myCommitSavesEmitter.add(t,{id:e})}unregisterCommitSavesEventListener(e){this._myCommitSavesEmitter.remove(e)}registerCommitSaveEventListener(e,t){this._myCommitSaveEmitter.add(t,{id:e})}unregisterCommitSaveEventListener(e){this._myCommitSaveEmitter.remove(e)}registerCommitSaveIDEventListener(e,t,n){let o=this._myCommitSaveIDEmitters.get(e);o==null&&(this._myCommitSaveIDEmitters.set(e,new Map),o=this._myCommitSaveIDEmitters.get(e)),o.add(n,{id:t})}unregisterCommitSaveIDEventListener(e,t){let n=this._myCommitSaveIDEmitters.get(e);n!=null&&(n.remove(t),n.size<=0&&this._myCommitSaveIDEmitters.delete(e))}registerLoadEventListener(e,t){this._myLoadEmitter.add(t,{id:e})}unregisterLoadEventListener(e){this._myLoadEmitter.remove(e)}registerLoadIDEventListener(e,t,n){let o=this._myLoadIDEmitters.get(e);o==null&&(this._myLoadIDEmitters.set(e,new Map),o=this._myLoadIDEmitters.get(e)),o.add(n,{id:t})}unregisterLoadIDEventListener(e,t){let n=this._myLoadIDEmitters.get(e);n!=null&&(n.remove(t),n.size<=0&&this._myLoadIDEmitters.delete(e))}_isCacheEnabled(e=null){return this._myCacheEnabled&&e==null||e!=null&&e}destroy(){this._myDestroyed=!0,I.getSession(this._myEngine)?.removeEventListener("visibilitychange",this._myVisibilityChangeEventListener),I.unregisterSessionStartEndEventListeners(this,this._myEngine)}isDestroyed(){return this._myDestroyed}};import{Component as FA,Property as wA}from"@wonderlandengine/api";var nn=class extends FA{start(){this._myFirstTime=!0,I.registerSessionStartEventListener(this,this._onXRSessionStart.bind(this),!0,!1,this.engine)}_onXRSessionStart(){(!this._myFirstTimeOnly||this._myFirstTime)&&(this._myFirstTime=!1,console.clear())}onDestroy(){I.unregisterSessionStartEventListener(this,this.engine)}};R(nn,"TypeName","pp-clear-console-on-xr-session-start"),R(nn,"Properties",{_myFirstTimeOnly:wA.bool(!0)});import{Component as jA,Property as Jl}from"@wonderlandengine/api";var on=class extends jA{init(){this.active&&this._mySetActiveWhen==0&&this._setActive()}start(){this._mySetActiveWhen==1&&this._setActive(),this._myFirstUpdate=!0,this._myFirstXRStart=!0,this._myFirstXREnd=!0,(this._mySetActiveWhen==3||this._mySetActiveWhen==5)&&I.registerSessionStartEventListener(this,this._onXRSessionStart.bind(this),!0,!0,this.engine),(this._mySetActiveWhen==4||this._mySetActiveWhen==6)&&I.registerSessionEndEventListener(this,this._onXRSessionEnd.bind(this),this.engine)}update(e){this._mySetActiveWhen==2&&this._myFirstUpdate&&this._setActive(),this._myFirstUpdate=!1}_onXRSessionStart(){(this._mySetActiveWhen==3||this._mySetActiveWhen==5&&this._myFirstXRStart)&&this._setActive(),this._myFirstXRStart=!1}_onXRSessionEnd(){(this._mySetActiveWhen==4||this._mySetActiveWhen==6&&this._myFirstXREnd)&&this._setActive(),this._myFirstXREnd=!1}_setActive(){this._mySetActiveOn==0?this.object.pp_setActiveSelf(this._myActive):this._mySetActiveOn==1?this.object.pp_setActiveChildren(this._myActive):this._mySetActiveOn==2?this.object.pp_setActiveDescendants(this._myActive):this.object.pp_setActive(this._myActive)}onDestroy(){I.unregisterSessionStartEndEventListeners(this,this.engine)}};R(on,"TypeName","pp-set-active"),R(on,"Properties",{_myActive:Jl.bool(!0),_mySetActiveOn:Jl.enum(["Self","Children","Descendants","Hierarchy"],"Hierarchy"),_mySetActiveWhen:Jl.enum(["Init","Start","First Update","Enter XR","Exit XR","First Enter XR","First Exit XR"],"Init")});import{Component as zA,PhysXComponent as NA,Property as GA}from"@wonderlandengine/api";var sn=class extends zA{init(){this.active&&this._myWhen==0&&this._adjustScale()}start(){this._myWhen==1&&this._adjustScale(),this._myFirst=!0}update(e){this._myWhen==2&&this._myFirst&&(this._myFirst=!1,this._adjustScale())}_adjustScale(){let e=this.object.pp_getScale(),t=this.object.pp_getComponents(NA);for(let n of t)n.extents[0]=n.extents[0]*e[0],n.extents[1]=n.extents[1]*e[1],n.extents[2]=n.extents[2]*e[2],n.active&&(n.active=!1,n.active=!0)}};R(sn,"TypeName","pp-adjust-hierarchy-physx-scale"),R(sn,"Properties",{_myWhen:GA.enum(["Init","Start","First Update"],"Start")});import{Alignment as WA,Component as UA,Justification as QA,Property as Oo}from"@wonderlandengine/api";var an=class extends UA{start(){this._myColor=F(1,1,1,1),this._myTextMaterial!=null&&this._myColor.vec4_copy(this._myTextMaterial.color),this._myScreenPosition=c(this._myScreenPositionX,this._myScreenPositionY,this._myScreenPositionZ),this._myCurrentFPS=0,this._myTimer=new ne(this._myRefreshSeconds),this._myTotalDT=0,this._myFrames=0}update(e){r.isDebugEnabled(this.engine)&&(this._myTotalDT+=e,this._myFrames++,this._myTimer.update(e),this._myTimer.isDone()&&(this._myTimer.start(),this._myCurrentFPS=Math.round(this._myFrames/this._myTotalDT),this._myTotalDT=0,this._myFrames=0),r.getDebugVisualManager(this.engine).drawUIText(0,this._myCurrentFPS.toFixed(0),this._myScreenPosition,this._myScale,this._myColor,WA.Right,QA.Bottom))}};R(an,"TypeName","pp-show-fps"),R(an,"Properties",{_myRefreshSeconds:Oo.float(.25),_myScreenPositionX:Oo.float(1),_myScreenPositionY:Oo.float(-1),_myScreenPositionZ:Oo.float(1),_myScale:Oo.float(1.5),_myTextMaterial:Oo.material()});import{Emitter as Ir}from"@wonderlandengine/api";var Io=class{constructor(e,t){this.myID=e,this.myObject=t}},Bo=class{constructor(e,t,n,o,s){this.myID=e,this.myFromState=t,this.myToState=n,this.myObject=o,this.mySkipStateFunction=s}},vi={IMMEDIATE:0,DELAYED:1},vs={QUEUE:0,KEEP_FIRST:1,KEEP_LAST:2},Vo={NONE:0,END:1,START:2,BOTH:3},it=class{constructor(e=vi.IMMEDIATE,t=vs.QUEUE){this._myCurrentStateData=null,this._myStates=new Map,this._myTransitions=new Map,this._myLogEnabled=!1,this._myLogShowDelayedInfo=!1,this._myLogFSMName="FSM",this._myPerformMode=e,this._myPerformDelayedMode=t,this._myPendingPerforms=[],this._myCurrentlyPerformedTransition=null,this._myInitEmitter=new Ir,this._myInitIDEmitters=new Map,this._myTransitionEmitter=new Ir,this._myTransitionIDEmitters=[]}addState(e,t=null){let n=null;!t||typeof t=="function"?(n={},typeof t=="function"?n.update=function(){return t(...arguments)}:n.update=null,n.clone=function(){let a={};return a.update=this.update,a.clone=this.clone,a}):n=t;let o=new Io(e,n);this._myStates.set(e,o),this._myTransitions.set(e,new Map)}addTransition(e,t,n,o=null,s=Vo.NONE){let a=null;if(!o||typeof o=="function"?(a={},typeof o=="function"?a.perform=function(){return o(...arguments)}:a.perform=null,a.clone=function(){let u={};return u.perform=this.perform,u.clone=this.clone,u}):a=o,this.hasState(e)&&this.hasState(t)){let l=this._getTransitionsFromState(e),u=new Bo(n,this.getState(e),this.getState(t),a,s);l.set(n,u)}else!this.hasState(e)&&!this.hasState(t)?console.error("Can't add transition:",n,"- from state not found:",e,"- to state not found:",t):this.hasState(e)?this.hasState(t)||console.error("Can't add transition:",n,"- to state not found:",t):console.error("Can't add transition:",n,"- from state not found:",e)}init(e,t=null,...n){let o=t;if(t&&typeof t=="function"&&(o={},o.performInit=t),this.hasState(e)){let s=this._myStates.get(e);if(this._myLogEnabled&&console.log(this._myLogFSMName,"- Init:",e),o&&o.performInit?o.performInit(this,s,...n):s.myObject&&s.myObject.init&&s.myObject.init(this,s,...n),this._myCurrentStateData=s,this._myInitEmitter.notify(this,s,o,...n),this._myInitIDEmitters.size>0){let a=this._myInitIDEmitters.get(e);a?.notify(this,s,o,...n)}}else this._myLogEnabled&&console.warn(this._myLogFSMName,"- Init state not found:",e)}update(e,...t){if(this._myPendingPerforms.length>0){for(let n=0;n<this._myPendingPerforms.length;n++)this._perform(this._myPendingPerforms[n].myID,vi.DELAYED,...this._myPendingPerforms[n].myArgs);this._myPendingPerforms=[]}this._myCurrentStateData&&this._myCurrentStateData.myObject&&this._myCurrentStateData.myObject.update&&this._myCurrentStateData.myObject.update(e,this,...t)}perform(e,...t){this._myPerformMode==vi.DELAYED?this.performDelayed(e,...t):this.performImmediate(e,...t)}performDelayed(e,...t){let n=!1;switch(this._myPerformDelayedMode){case vs.QUEUE:this._myPendingPerforms.push(new xs(e,...t)),n=!0;break;case vs.KEEP_FIRST:this.hasPendingPerforms()||(this._myPendingPerforms.push(new xs(e,...t)),n=!0);break;case vs.KEEP_LAST:this.resetPendingPerforms(),this._myPendingPerforms.push(new xs(e,...t)),n=!0;break}return n}performImmediate(e,...t){return this._perform(e,vi.IMMEDIATE,...t)}canPerform(e){return this.hasTransitionFromState(this._myCurrentStateData.myID,e)}canGoTo(e,t=null){return this.hasTransitionFromStateToState(this._myCurrentStateData.myID,e,t)}isInState(e){return this._myCurrentStateData!=null&&this._myCurrentStateData.myID==e}isPerformingTransition(){return this._myCurrentlyPerformedTransition!=null}getCurrentlyPerformedTransition(){return this._myCurrentlyPerformedTransition}hasBeenInit(){return this._myCurrentStateData!=null}reset(){this.resetState(),this.resetPendingPerforms()}resetState(){this._myCurrentStateData=null}resetPendingPerforms(){this._myPendingPerforms=[]}getCurrentState(){return this._myCurrentStateData}getCurrentTransitions(){return this.getTransitionsFromState(this._myCurrentStateData.myID)}getCurrentTransitionsToState(e){return this.getTransitionsFromStateToState(this._myCurrentStateData.myID,e)}getState(e){return this._myStates.get(e)}getStates(){return this._myStates.values()}getTransitions(){let e=[];for(let t of this._myTransitions.values())for(let n of t.values())e.push(n);return e}getTransitionsFromState(e){let t=this._getTransitionsFromState(e);return Array.from(t.values())}getTransitionsFromStateToState(e,t){let n=this._getTransitionsFromState(e),o=[];for(let s of n.values())s.myToState.myID==t&&o.push(s);return o}removeState(e){if(this.hasState(e)){this._myStates.delete(e),this._myTransitions.delete(e);for(let t of this._myTransitions.values()){let n=[];for(let[o,s]of t.entries())s.myToState.myID==e&&n.push(o);for(let o of n)t.delete(o)}return!0}return!1}removeTransitionFromState(e,t){let n=this._getTransitionsFromState(e);return n?n.delete(t):!1}hasState(e){return this._myStates.has(e)}hasTransitionFromState(e,t){return this.getTransitionsFromState(e).findIndex(function(s){return s.myID==t})>=0}hasTransitionFromStateToState(e,t,n=null){let o=this.getTransitionsFromStateToState(e,t),s=!1;return n?s=o.findIndex(function(l){return l.myID==n})>=0:s=o.length>0,s}setPerformMode(e){this._myPerformMode=e}getPerformMode(){return this._myPerformMode}setPerformDelayedMode(e){this._myPerformDelayedMode=e}getPerformDelayedMode(){return this._myPerformDelayedMode}hasPendingPerforms(){return this._myPendingPerforms.length>0}getPendingPerforms(){return this._myPendingPerforms.pp_clone()}clone(e=!1){if(!this.isCloneable(e))return null;let t=new it;t._myLogEnabled=this._myLogEnabled,t._myLogShowDelayedInfo=this._myLogShowDelayedInfo,t._myLogFSMName=this._myLogFSMName,t._myPerformMode=this._myPerformMode,t._myPerformDelayedMode=this._myPerformDelayedMode,t._myPendingPerforms=this._myPendingPerforms.pp_clone();for(let n of this._myStates.entries()){let o=null;e?o=new Io(n[1].myID,n[1].myObject.clone()):o=new Io(n[1].myID,n[1].myObject),t._myStates.set(o.myID,o)}for(let n of this._myTransitions.entries()){let o=new Map;t._myTransitions.set(n[0],o);for(let s of n[1].entries()){let a=null,l=t.getState(s[1].myFromState.myID),u=t.getState(s[1].myToState.myID);e?a=new Bo(s[1].myID,l,u,s[1].myObject.clone(),s[1].mySkipStateFunction):a=new Bo(s[1].myID,l,u,s[1].myObject,s[1].mySkipStateFunction),o.set(a.myID,a)}}return this._myCurrentStateData&&(t._myCurrentStateData=t.getState(this._myCurrentStateData.myID)),t}isCloneable(e=!1){if(!e)return!0;let t=!0;for(let n of this._myStates.entries())t=t&&n[1].myObject.clone!=null;for(let n of this._myTransitions.entries())for(let o of n[1].entries())t=t&&o[1].myObject.clone!=null;return t}setLogEnabled(e,t=null,n=!1){this._myLogEnabled=e,this._myLogShowDelayedInfo=n,t&&(this._myLogFSMName="FSM: ".concat(t))}registerInitEventListener(e,t){this._myInitEmitter.add(t,{id:e})}unregisterInitEventListener(e){this._myInitEmitter.remove(e)}registerInitIDEventListener(e,t,n){let o=this._myInitIDEmitters.get(e);o==null&&(this._myInitIDEmitters.set(e,new Ir),o=this._myInitIDEmitters.get(e)),o.add(n,{id:t})}unregisterInitIDEventListener(e,t){let n=this._myInitIDEmitters.get(e);n!=null&&(n.remove(t),n.isEmpty&&this._myInitIDEmitters.delete(e))}registerTransitionEventListener(e,t){this._myTransitionEmitter.add(t,{id:e})}unregisterTransitionEventListener(e){this._myTransitionEmitter.remove(e)}registerTransitionIDEventListener(e,t,n,o,s){let a=null;for(let l of this._myTransitionIDEmitters)if(l[0]==e&&l[1]==t&&l[2]==n){a=l[3];break}if(a==null){let l=[];l[0]=e,l[1]=t,l[2]=n,l[3]=new Ir,a=l[3],this._myTransitionIDEmitters.push(l)}a.add(s,{id:o})}unregisterTransitionIDEventListener(e,t,n,o){let s=null;for(let a of this._myTransitionIDEmitters)if(a[0]==e&&a[1]==t&&a[2]==n){s=a[3];break}s!=null&&(s.remove(o),s.isEmpty&&this._myTransitionIDEmitters.pp_remove(a=>a[0]==e&&a[1]==t&&a[2]==n))}_perform(e,t,...n){if(this.isPerformingTransition()){let o=this.getCurrentlyPerformedTransition(),s=[this._myLogFSMName,"- Trying to perform:",e];return this._myLogShowDelayedInfo&&s.push(t==vi.DELAYED?"- Delayed":"- Immediate"),s.push("- But another transition is currently being performed -",o.myID),console.warn(...s),!1}if(this._myCurrentStateData){if(this.canPerform(e)){let s=this._myTransitions.get(this._myCurrentStateData.myID).get(e);this._myCurrentlyPerformedTransition=s;let a=this._myCurrentStateData,l=this._myStates.get(s.myToState.myID);if(this._myLogEnabled){let u=[this._myLogFSMName,"- From:",a.myID,"- To:",l.myID,"- With:",e];this._myLogShowDelayedInfo&&u.push(t==vi.DELAYED?"- Delayed":"- Immediate"),console.log(...u)}if(s.mySkipStateFunction!=Vo.END&&s.mySkipStateFunction!=Vo.BOTH&&a.myObject&&a.myObject.end&&a.myObject.end(this,s,...n),s.myObject&&s.myObject.perform&&s.myObject.perform(this,s,...n),s.mySkipStateFunction!=Vo.START&&s.mySkipStateFunction!=Vo.BOTH&&l.myObject&&l.myObject.start&&l.myObject.start(this,s,...n),this._myCurrentStateData=s.myToState,this._myTransitionEmitter.notify(this,a,l,s,t,...n),this._myTransitionIDEmitters.length>0){let u=[];for(let _ of this._myTransitionIDEmitters)(_[0]==null||_[0]==a.myID)&&(_[1]==null||_[1]==l.myID)&&(_[2]==null||_[2]==s.myID)&&u.push(_[3]);for(let _ of u)_.notify(this,a,l,s,t,...n)}return this._myCurrentlyPerformedTransition=null,!0}else if(this._myLogEnabled){let o=[this._myLogFSMName,"- No Transition:",e,"- From:",this._myCurrentStateData.myID];this._myLogShowDelayedInfo&&o.push(t==vi.DELAYED?"- Delayed":"- Immediate"),console.warn(...o)}}else if(this._myLogEnabled){let o=[this._myLogFSMName,"- FSM not initialized yet"];this._myLogShowDelayedInfo&&o.push(t==vi.DELAYED?"- Delayed":"- Immediate"),console.warn(...o)}return!1}_getTransitionsFromState(e){return this._myTransitions.get(e)}},xs=class{constructor(e,...t){this.myID=e,this.myArgs=t}};var Kn=class{update(e,t,...n){}init(e,t,...n){}start(e,t,...n){}end(e,t,...n){}};var Zl=class{performInit(e,t,...n){}perform(e,t,...n){}};var Ms=class extends Kn{constructor(e=0,t=null,...n){super(),this._myTransitionToPerformOnEnd=t,this._myTransitionArgs=n,this._myTimer=new ne(e,!1)}setDuration(e){this._myTimer.setDuration(e)}setTransitionToPerformOnEnd(e,...t){this._myTransitionToPerformOnEnd=e,this._myTransitionArgs=t}onEnd(e,t=null){this._myTimer.onEnd(e,t)}unregisterOnEnd(e=null){this._myTimer.unregisterOnEnd(e)}update(e,t){this._myTimer.update(e),this._myTimer.isDone()&&this._myTransitionToPerformOnEnd!=null&&t.perform(this._myTransitionToPerformOnEnd,...this._myTransitionArgs)}start(e,t,n=null,o=null,...s){this._myTimer.start(n),o!=null&&(this._myTransitionToPerformOnEnd=o,this._myTransitionArgs=s)}init(e,t,n=null,o=null,...s){this._myTimer.start(n),o!=null&&(this._myTransitionToPerformOnEnd=o,this._myTransitionArgs=s)}};function $P(i){let e=i.pp_clone(),t=i[0],n=i[1],o=i[2],s=Math.max(t,n,o),a=Math.min(t,n,o),l=s-a,u,_=s===0?0:l/s,m=s;switch(s){case a:u=0;break;case t:u=n-o+l*(n<o?6:0),u/=6*l;break;case n:u=o-t+l*2,u/=6*l;break;case o:u=t-n+l*4,u/=6*l;break}return e[0]=u,e[1]=_,e[2]=m,e}function eC(i){let e=i.pp_clone(),t=i[0],n=i[1],o=i[2],s,a,l,u,_,m,h,d;switch(u=Math.floor(t*6),_=t*6-u,m=o*(1-n),h=o*(1-_*n),d=o*(1-(1-_)*n),u%6){case 0:s=o,a=d,l=m;break;case 1:s=h,a=o,l=m;break;case 2:s=m,a=o,l=d;break;case 3:s=m,a=h,l=o;break;case 4:s=d,a=m,l=o;break;case 5:s=o,a=m,l=h;break}return e[0]=s,e[1]=a,e[2]=l,e}function tC(i){return ce.color1To255(i)}function iC(i){return ce.color255To1(i)}function nC(i){return ce.color1To255(i)}function oC(i){return ce.color255To1(i)}function sC(i){let e=i.pp_clone();for(let t=0;t<e.length;t++)e[t]/=255,e[t]=Math.pp_clamp(e[t],0,1);return e}function aC(i){let e=i.pp_clone();for(let t=0;t<e.length;t++)e[t]=Math.round(e[t]*255),e[t]=Math.pp_clamp(e[t],0,255);return e}var ce={rgbToHSV:$P,hsvToRGB:eC,rgbCodeToHuman:tC,rgbHumanToCode:iC,hsvCodeToHuman:nC,hsvHumanToCode:oC,color255To1:sC,color1To255:aC};import{MeshComponent as Ds}from"@wonderlandengine/api";var rC=function(){let i=F();return function(t,n){t.color!=null&&(i.vec4_copy(t.color),i[3]=n,t.color=i),t.diffuseColor!=null&&(i.vec4_copy(t.diffuseColor),i[3]=n,t.diffuseColor=i),t.ambientColor!=null&&(i.vec4_copy(t.ambientColor),i[3]=n,t.ambientColor=i)}}();function lC(i,e){let t=i.pp_getComponents(Ds);for(let n of t)n.material!=null&&Es.setAlpha(n.material,e)}function mC(i,e,t=!1){let n=i.pp_getComponents(Ds);for(let o of n)t?o.material=e.clone():o.material=e}function yC(i){let e=i.pp_getComponents(Ds);for(let t of e)t.material=t.material.clone()}function uC(i,e){let t=i.pp_getComponents(Ds);for(let n of t)n.material.specularColor!=null&&(n.material.specularColor=e)}function hC(i,e){let t=i.pp_getComponents(Ds);for(let n of t)n.material.fogColor!=null&&(n.material.fogColor=e)}var Es={setAlpha:rC,setObjectAlpha:lC,setObjectMaterial:mC,setObjectClonedMaterials:yC,setObjectSpecularColor:uC,setObjectFogColor:hC};import{TextComponent as qA}from"@wonderlandengine/api";function cC(i){let e=i.pp_getComponents(qA);for(let t of e)t.material=t.material.clone()}var XA={setClonedMaterials:cC};var pC=function(){let i=new RegExp("mobi","i");return function(t=r.getMainEngine()){let n=r.getNavigator(t).userAgent;return n!=null&&n.match(i)!=null}}();function dC(i=r.getMainEngine()){return!Jn.isMobile(i)}function _C(i,e=!0,t=!0,n=!0,o=!1,s=null,a=null,l=r.getMainEngine()){let u=document.createElement("a");u.style.display="none",document.body.appendChild(u),u.addEventListener("click",function(){let _;e?_="_blank":_="_top",window.open(i,_)!=null?(!t&&n&&I.exitSession(l),s?.()):o?setTimeout(function(){Jn.openLinkOnClick(i,e,n,s,a)},100):a?.()}),t&&I.exitSession(l),u.click(),document.body.removeChild(u)}function gC(i,e=!0,t=!0,n=null,o=null,s=r.getMainEngine()){document.addEventListener("click",function(){let a;e?a="_blank":a="_top",window.open(i,a)!=null?(t&&I.exitSession(s),n?.()):o?.()},{once:!0})}var Jn={isMobile:pC,isDesktop:dC,openLink:_C,openLinkOnClick:gC};import{Component as KA,Property as fC}from"@wonderlandengine/api";var rn=class extends KA{start(){this._myStarted=!1,r.isDebugEnabled(this.engine)&&(this._myDebugVisualTransform=null,this._myDebugTransformParams=new Rt(this.engine),this._myDebugTransformParams.myLength=this._myLength,this._myDebugTransformParams.myThickness=this._myThickness,this._myDebugVisualTransform=new oi(this._myDebugTransformParams),this._myDebugVisualTransform.setVisible(r.isDebugEnabled(this.engine)),this._myStarted=!0)}update(e){r.isDebugEnabled(this.engine)&&this._myStarted&&(this.object.pp_getTransform(this._myDebugTransformParams.myTransform),this._myDebugVisualTransform.paramsUpdated(),this._myDebugVisualTransform.setVisible(!0))}onDestroy(){this._myStarted&&this._myDebugVisualTransform.destroy()}};R(rn,"TypeName","pp-debug-transform"),R(rn,"Properties",{_myLength:fC.float(.1),_myThickness:fC.float(.005)});var Lo=class{constructor(e=r.getMainEngine()){this.myObjectsByReference=[],this.myObjectsByPath=[],this.myClassesByReference=[],this.myClassesByPath=[],this.myFunctionsByPath=[],this.myExcludeConstructors=!1,this.myExcludeJSObjectFunctions=!1,this.myFunctionNamesToInclude=[],this.myFunctionNamesToExclude=[],this.myFunctionPathsToInclude=[],this.myFunctionPathsToExclude=[],this.myObjectAddObjectDescendantsDepthLevel=0,this.myObjectAddClassDescendantsDepthLevel=0,this.myObjectNamesToInclude=[],this.myObjectNamesToExclude=[],this.myClassNamesToInclude=[],this.myClassNamesToExclude=[],this.myObjectPathsToInclude=[],this.myObjectPathsToExclude=[],this.myClassPathsToInclude=[],this.myClassPathsToExclude=[],this.myLogEnabled=!1,this.myEngine=e}},Ho=class{constructor(e=new Lo){this._myParams=e,this._myPropertiesAlreadyOverwritten=new Map}overwriteFunctions(){let e=this._getReferencesAndParents(this._myParams.myClassesByReference,this._myParams.myClassesByPath,!0),t=this._getReferencesAndParents(this._myParams.myObjectsByReference,this._myParams.myObjectsByPath,!1),n=this._getReferencesAndParents([],this._myParams.myFunctionsByPath,!1);this._objectAddDescendants(t,e);for(let o of e){let s=o[0],a=o[1],l=o[2],u=o[3],_=o[4];this._overwriteReferenceFunctions(s,a,l,u,_,!0)}for(let o of t){let s=o[0],a=o[1],l=o[2],u=o[3],_=o[4];this._overwriteReferenceFunctions(s,a,l,u,_,!1)}for(let o of n){let s=o[1],a=o[2],l=o[3];this._overwriteFunction(s,a,null,null,l,!1,!0)}}_getOverwrittenFunction(e,t,n,o,s){return $.getObjectProperty(e,t)}_getOverwrittenConstructor(e,t,n,o,s){return $.getObjectProperty(e,t)}_onOverwriteSuccess(e,t,n,o,s,a,l,u){}_onOverwriteFailure(e,t,n,o,s,a,l,u){}_overwriteReferenceFunctions(e,t,n,o,s,a){let l=this._myParams.myObjectPathsToInclude,u=this._myParams.myObjectPathsToExclude,_=this._myParams.myObjectNamesToInclude,m=this._myParams.myObjectNamesToExclude;a&&(l=this._myParams.myClassPathsToInclude,u=this._myParams.myClassPathsToExclude,_=this._myParams.myClassNamesToInclude,m=this._myParams.myClassNamesToExclude);let h=this._filterName(o,l,u),d=this._filterName(s,_,m);if(h&&d){let g=$.getObjectPropertyNames(e);g.pp_hasEqual("constructor")&&g.unshift("constructor");for(let P of g){let C=null,f=null,S=null;if(a){let M=e;if(t!=null){let D=Object.getOwnPropertyDescriptor(t,n);D!=null&&D.value!=null&&(M=D.value)}if(C=M.prototype,C==null)C=M;else try{$.getObjectProperty(C,P)==null&&(C=M)}catch{C=M}f=t,S=n}else C=e;this._overwriteFunction(C,P,f,S,o,a,!1)}}}_overwriteFunction(e,t,n,o,s,a,l){try{if(!(this._myPropertiesAlreadyOverwritten.get(t)!=null&&this._myPropertiesAlreadyOverwritten.get(t).pp_hasEqual(e))&&$.isFunctionByName(e,t)&&(!this._myParams.myExcludeJSObjectFunctions||!this._isJSObjectFunction(t))){let _=this._filterName(t,this._myParams.myFunctionNamesToInclude,this._myParams.myFunctionNamesToExclude),m=this._filterName((s!=null?s+".":"")+t,this._myParams.myFunctionPathsToInclude,this._myParams.myFunctionPathsToExclude);if(_&&m){this._myPropertiesAlreadyOverwritten.has(t)||this._myPropertiesAlreadyOverwritten.set(t,[]);let h=!1,d=!1;if(t!="constructor")try{let g=this._getOverwrittenFunction(e,t,s,a,l);g!=$.getObjectProperty(e,t)?h=$.overwriteObjectProperty(g,e,t,!1,!0,this._myParams.myLogEnabled):h=!0}catch(g){h=!1,this._myParams.myLogEnabled&&console.error(g)}else if(!this._myParams.myExcludeConstructors&&a&&n!=null){let g=$.getObjectProperty(n,o);if(g!=null&&g.prototype!=null){d=!0;try{let P=this._getOverwrittenConstructor(n,o,s,a,l);P!=g?(h=$.overwriteObjectProperty(P,n,o,!1,!0,this._myParams.myLogEnabled),h&&(h=$.overwriteObjectProperty(P,g.prototype,t,!1,!0,this._myParams.myLogEnabled))):h=!0}catch(P){h=!1,this._myParams.myLogEnabled&&console.error(P)}}}h?(this._myPropertiesAlreadyOverwritten.get(t).push(e),this._onOverwriteSuccess(e,t,n,o,s,a,l,d)):this._onOverwriteFailure(e,t,n,o,s,a,l,d)}}}catch(u){this._myParams.myLogEnabled&&console.error(u)}}_getReferencesAndParents(e,t,n){let o=[],s=(a,l)=>a[0]==l[0];for(let a of t){let l=a,u="",_=a,m="";a!=null&&Array.isArray(a)&&a.length!=null&&a.length==2&&typeof a[1]=="string"&&(l=a[0],_=a[1]),u=$.getObjectNameFromPath(l),m=$.getObjectNameFromPath(_);let h=$.getObjectFromPath(l,r.getWindow(this._myParams.myEngine)),d=$.getObjectParentFromPath(l,r.getWindow(this._myParams.myEngine));h!=null&&o.pp_pushUnique([h,d,u,_,m],s)}for(let a of e){let l=a,u="",_="",m="";a!=null&&a.length!=null&&a.length==2&&typeof a[1]=="string"?(l=a[0],_=a[1],m=$.getObjectNameFromPath(_)):(_=n?l.name:null,m=n?l.name:null),n?u=l.name:u=$.getObjectNameFromPath(_),l!=null&&o.pp_pushUnique([l,null,u,_,m],s)}return o}_objectAddDescendants(e,t){let n=(s,a)=>s[0]==a[0],o=[];for(let s of e)o.pp_pushUnique([s[0],0,s[3]],n);for(;o.length>0;){let s=o.shift(),a=s[0],l=s[1],u=s[2];if(l+1<=this._myParams.myObjectAddObjectDescendantsDepthLevel||this._myParams.myObjectAddObjectDescendantsDepthLevel==-1||l+1<=this._myParams.myObjectAddClassDescendantsDepthLevel||this._myParams.myObjectAddClassDescendantsDepthLevel==-1){let _=null;try{_=$.getObjectPropertyNames(a)}catch{continue}for(let m of _){let h=null;try{if(h=$.getObjectProperty(a,m),h==null)continue}catch{continue}let d="",g="";u!=null?(g=m,d=u+"."+g):(g=m,d=g);let P=$.isClassByName(a,m),C=$.isObjectByName(a,m),f=this._myParams.myObjectPathsToInclude,S=this._myParams.myObjectPathsToExclude,M=this._myParams.myObjectNamesToInclude,D=this._myParams.myObjectNamesToExclude;P&&(f=this._myParams.myClassPathsToInclude,S=this._myParams.myClassPathsToExclude,M=this._myParams.myClassNamesToInclude,D=this._myParams.myClassNamesToExclude);let v=this._filterName(d,f,S),b=this._filterName(m,M,D);v&&b&&(C&&(l+1<=this._myParams.myObjectAddObjectDescendantsDepthLevel||this._myParams.myObjectAddObjectDescendantsDepthLevel==-1)&&e.pp_pushUnique([h,a,m,d,g],n),P&&(l+1<=this._myParams.myObjectAddClassDescendantsDepthLevel||this._myParams.myObjectAddClassDescendantsDepthLevel==-1)&&t.pp_pushUnique([h,a,m,d,g],n),C&&o.pp_pushUnique([h,l+1,d],n))}}}}_filterName(e,t,n){let o=t.length==0;for(let s of t)if(e.match(s)!=null){o=!0;break}if(o){for(let s of n)if(e.match(s)!=null){o=!1;break}}return o}_isJSObjectFunction(e){}};Ho.prototype._isJSObjectFunction=function(){let i=["__defineGetter__","__defineSetter__","hasOwnProperty","__lookupGetter__","__lookupSetter__","isPrototypeOf","propertyIsEnumerable","toString","valueOf","__proto__","toLocaleString","arguments","caller","apply","bind","call","callee"];return function(t){return i.pp_hasEqual(t)}}();var Fo=class extends Lo{constructor(){super(),this.myExecutionTimeAnalysisEnabled=!0,this.myAddPathPrefixToFunctionID=!0,this.myFilterDebugFunctionsPerformanceAnalyzerClasses=!0}},ko=class{constructor(){this.myReference=null,this.myName="",this.myPath="",this.myID="",this.myCallsCount=0,this.myTotalExecutionTime=0,this.myTotalExecutionTimePercentage=0,this.myAverageExecutionTime=0,this.myTimeElapsedSinceLastReset=0,this._myTotalExecutionTimeInternal=0}reset(){this.myCallsCount=0,this.myTotalExecutionTime=0,this.myTotalExecutionTimePercentage=0,this.myAverageExecutionTime=0,this.myTimeElapsedSinceLastReset=0,this._myTotalExecutionTimeInternal=0}max(e){this.myCallsCount=Math.max(this.myCallsCount,e.myCallsCount),this.myTotalExecutionTime=Math.max(this.myTotalExecutionTime,e.myTotalExecutionTime),this.myTotalExecutionTimePercentage=Math.max(this.myTotalExecutionTimePercentage,e.myTotalExecutionTimePercentage),this.myAverageExecutionTime=Math.max(this.myAverageExecutionTime,e.myAverageExecutionTime)}copy(e){this.myReference=e.myReference,this.myName=e.myName,this.myPath=e.myPath,this.myID=e.myID,this.myCallsCount=e.myCallsCount,this.myTotalExecutionTime=e.myTotalExecutionTime,this.myTotalExecutionTimePercentage=e.myTotalExecutionTimePercentage,this.myAverageExecutionTime=e.myAverageExecutionTime,this.myTimeElapsedSinceLastReset=e.myTimeElapsedSinceLastReset,this._myTotalExecutionTimeInternal=e._myTotalExecutionTimeInternal}},Gt={NONE:0,CALLS_COUNT:1,TOTAL_EXECUTION_TIME:2,AVERAGE_EXECUTION_TIME:3},Zn=class extends Ho{constructor(e=new Fo){super(e),this._myFunctionPerformanceAnalysisResults=new Map,this._myFunctionPerformanceAnalysisMaxResults=new Map,this._myResultsAlreadyAdded=!1,this._myExecutionTimes={myOverheadExecutionTimeSinceLastReset:0,myLastFunctionExecutionTime:0,myOriginalFunctionOverheadExecutionTimes:[]},this._myTimeOfLastReset=r.getWindow(this._myParams.myEngine).performance.now(),this._myMaxTimeElapsedSinceLastReset=0;let t=Array.prototype.push,n=Array.prototype.pop;this._myExecutionTimes.myOriginalFunctionOverheadExecutionTimes.push=function(){return t.bind(this)(...arguments)},this._myExecutionTimes.myOriginalFunctionOverheadExecutionTimes.pop=function(){return n.bind(this)(...arguments)}}overwriteFunctions(){super.overwriteFunctions(),this.resetResults(),this.resetMaxResults()}getTimeElapsedSinceLastReset(){return r.getWindow(this._myParams.myEngine).performance.now()-this._myTimeOfLastReset-this._myExecutionTimes.myOverheadExecutionTimeSinceLastReset}getMaxTimeElapsedSinceLastReset(){return this._myMaxTimeElapsedSinceLastReset=Math.max(this._myMaxTimeElapsedSinceLastReset,this.getTimeElapsedSinceLastReset()),this._myMaxTimeElapsedSinceLastReset}resetResults(){this._updateDerivatesResults(),this._updateMaxResults();for(let e of this._myFunctionPerformanceAnalysisResults.keys())this._myFunctionPerformanceAnalysisResults.get(e).reset();this._myExecutionTimes.myOverheadExecutionTimeSinceLastReset=0,this._myTimeOfLastReset=r.getWindow(this._myParams.myEngine).performance.now()}resetMaxResults(){this._myMaxTimeElapsedSinceLastReset=0;for(let e of this._myFunctionPerformanceAnalysisMaxResults.keys())this._myFunctionPerformanceAnalysisMaxResults.get(e).reset()}getResults(e=Gt.NONE){this._updateDerivatesResults(),this._updateMaxResults();let t=this._myFunctionPerformanceAnalysisResults;return t=this._sortResults(t,e),t}getMaxResults(e=Gt.NONE){this._updateDerivatesResults(),this._updateMaxResults();let t=this._myFunctionPerformanceAnalysisMaxResults;return t=this._sortResults(t,e),t}_getOverwrittenFunction(e,t,n,o,s){return this._getOverwrittenFunctionInternal(e,t,n,o,s,!1)}_getOverwrittenConstructor(e,t,n,o,s){return this._getOverwrittenFunctionInternal(e,t,n,o,s,!0)}_onOverwriteSuccess(e,t,n,o,s,a,l,u){this._myResultsAlreadyAdded=!1}_onOverwriteFailure(e,t,n,o,s,a,l,u){if(this._myResultsAlreadyAdded){let _=this._getPropertyID(t,s,l,u);this._myFunctionPerformanceAnalysisResults.delete(_)}}_sortResults(e,t){let n=e;return t!=Gt.NONE&&(n=new Map([...e.entries()].sort(function(o,s){let a=0;return t==Gt.CALLS_COUNT?(a=-(o[1].myCallsCount-s[1].myCallsCount),a==0&&(a=-(o[1].myTotalExecutionTime-s[1].myTotalExecutionTime),a==0&&(a=-(o[1].myAverageExecutionTime-s[1].myAverageExecutionTime)))):t==Gt.TOTAL_EXECUTION_TIME?(a=-(o[1].myTotalExecutionTime-s[1].myTotalExecutionTime),a==0&&(a=-(o[1].myAverageExecutionTime-s[1].myAverageExecutionTime),a==0&&(a=-(o[1].myCallsCount-s[1].myCallsCount)))):(a=-(o[1].myAverageExecutionTime-s[1].myAverageExecutionTime),a==0&&(a=-(o[1].myTotalExecutionTime-s[1].myTotalExecutionTime),a==0&&(a=-(o[1].myCallsCount-s[1].myCallsCount)))),a}))),n}_getPropertyID(e,t,n,o){let s=o?"constructor":e;return t!=null&&this._myParams.myAddPathPrefixToFunctionID&&(n?s=t:s=t+"."+s),s}_updateDerivatesResults(){let e=this.getTimeElapsedSinceLastReset(),t=r.getWindow(this._myParams.myEngine).performance.now();for(let n of this._myFunctionPerformanceAnalysisResults.keys()){let o=this._myFunctionPerformanceAnalysisResults.get(n);e!=0?o.myTotalExecutionTimePercentage=o.myTotalExecutionTime/e:o.myCallsCount!=0?o.myTotalExecutionTimePercentage=1:o.myTotalExecutionTimePercentage=0,o.myCallsCount!=0?o.myAverageExecutionTime=o.myTotalExecutionTime/o.myCallsCount:o.myAverageExecutionTime=0,o.myTimeElapsedSinceLastReset=e}this._myExecutionTimes.myOverheadExecutionTimeSinceLastReset+=r.getWindow(this._myParams.myEngine).performance.now()-t}_updateMaxResults(){let e=r.getWindow(this._myParams.myEngine).performance.now();this._myMaxTimeElapsedSinceLastReset=Math.max(this._myMaxTimeElapsedSinceLastReset,this.getTimeElapsedSinceLastReset());for(let t of this._myFunctionPerformanceAnalysisResults.keys())if(this._myFunctionPerformanceAnalysisMaxResults.has(t))this._myFunctionPerformanceAnalysisMaxResults.get(t).max(this._myFunctionPerformanceAnalysisResults.get(t));else{let n=new ko;n.copy(this._myFunctionPerformanceAnalysisResults.get(t)),this._myFunctionPerformanceAnalysisMaxResults.set(t,n)}this._myExecutionTimes.myOverheadExecutionTimeSinceLastReset+=r.getWindow(this._myParams.myEngine).performance.now()-e}_getOverwrittenFunctionInternal(e,t,n,o,s,a){let l=$.getObjectProperty(e,t);if((!this._myParams.myFilterDebugFunctionsPerformanceAnalyzerClasses||!this._isPerformanceAnalyzer(e,t,o))&&t!="_myPerformanceAnalyzerOriginalFunction"){let u=this._getPropertyID(t,n,s,a);this._myResultsAlreadyAdded=this._myFunctionPerformanceAnalysisResults.has(u);let _=new ko;_.myReference=e,_.myName=t,_.myPath=n,_.myID=n,this._myFunctionPerformanceAnalysisResults.set(u,_);try{let m=r.getWindow(this._myParams.myEngine),h=this._myFunctionPerformanceAnalysisResults.get(u),d=this._myExecutionTimes,g=e[t],P=175e-6,C=35e-5,f=this._myParams.myExecutionTimeAnalysisEnabled;a?l=function(){let S=m.performance.now(),M=null,D,v=0,b=0,x=0,B=0,H=0,w=0,Q=0;if(f){d.myOriginalFunctionOverheadExecutionTimes.push(0),v=m.performance.now(),b=m.performance.now();try{v=m.performance.now(),D=new g(...arguments),b=m.performance.now()}catch(ue){b=m.performance.now(),M=ue}}else try{D=new g(...arguments)}catch(ue){M=ue}if(h.myCallsCount+=1,f&&(x=d.myOriginalFunctionOverheadExecutionTimes.pop(),B=b-v-x,H=B-P,g._myPerformanceAnalyzerHasBeenOverwritten&&(H=d.myLastFunctionExecutionTime),h._myTotalExecutionTimeInternal+=H,h.myTotalExecutionTime=Math.max(0,h._myTotalExecutionTimeInternal),d.myLastFunctionExecutionTime=H,w=v-S,Q=w-b-C,d.myOriginalFunctionOverheadExecutionTimes.length>0&&(d.myOriginalFunctionOverheadExecutionTimes[d.myOriginalFunctionOverheadExecutionTimes.length-1]+=Q+x+C*2.75,d.myOriginalFunctionOverheadExecutionTimes[d.myOriginalFunctionOverheadExecutionTimes.length-1]+=m.performance.now()),d.myOverheadExecutionTimeSinceLastReset+=Q,d.myOverheadExecutionTimeSinceLastReset+=m.performance.now()),M!=null)throw M;return D}:l=function(){let S=m.performance.now(),M=null,D,v=null,b=0,x=0,B=0,H=0,w=0,Q=0,ue=0;if(f){d.myOriginalFunctionOverheadExecutionTimes.push(0),b=m.performance.now(),x=m.performance.now();try{v=g.bind(this),b=m.performance.now(),D=v(...arguments),x=m.performance.now()}catch(me){x=m.performance.now(),M=me}}else try{v=g.bind(this),D=v(...arguments)}catch(me){M=me}if(h.myCallsCount+=1,f&&(B=d.myOriginalFunctionOverheadExecutionTimes.pop(),H=x-b-B,w=H-P,g._myPerformanceAnalyzerHasBeenOverwritten&&(w=d.myLastFunctionExecutionTime),h._myTotalExecutionTimeInternal+=w,h.myTotalExecutionTime=Math.max(0,h._myTotalExecutionTimeInternal),d.myLastFunctionExecutionTime=w,Q=b-S,ue=Q-x-C,d.myOriginalFunctionOverheadExecutionTimes.length>0&&(d.myOriginalFunctionOverheadExecutionTimes[d.myOriginalFunctionOverheadExecutionTimes.length-1]+=ue+B+C*2.75,d.myOriginalFunctionOverheadExecutionTimes[d.myOriginalFunctionOverheadExecutionTimes.length-1]+=m.performance.now()),d.myOverheadExecutionTimeSinceLastReset+=ue,d.myOverheadExecutionTimeSinceLastReset+=m.performance.now()),M!=null)throw M;return D},l!=null&&(Object.defineProperty(l,"_myPerformanceAnalyzerHasBeenOverwritten",{value:!0,enumerable:!1,configurable:!1,writable:!1}),Object.defineProperty(l,"_myPerformanceAnalyzerOriginalFunction",{value:g,enumerable:!1,configurable:!1,writable:!1}))}catch(m){this._myParams.myLogEnabled&&console.error("Function:",t,"of:",e,`can't be overwritten.
Error:`,m)}}return l}_isPerformanceAnalyzer(e,t,n){let o=!1;return n&&(e==Zn.prototype||e==ko.prototype)&&(o=!0),o}};var As=class{constructor(){this.myPerformanceAnalyzer=null,this.myLogTitle="Functions Performance Analysis Results",this.mySecondsBetweenLogs=1,this.myLogFunction="log",this.myFormatLog=!0,this.myFormatLogIndentationCharacter="-",this.myLogMaxResults=!1,this.myLogSortOrder=Gt.NONE,this.myLogMaxAmountOfFunctions=null,this.myLogFunctionsWithCallsCountAbove=null,this.myLogFunctionsWithTotalExecutionTimePercentageAbove=null,this.myLogCallsCountResults=!1,this.myLogTotalExecutionTimeResults=!1,this.myLogTotalExecutionTimePercentageResults=!1,this.myLogAverageExecutionTimeResults=!1,this.myClearConsoleBeforeLog=!1}},Rs=class{constructor(e){this._myParams=e,this._myLogTimer=new ne(this._myParams.mySecondsBetweenLogs),this._myMaxNameLength=0,this._myMaxCallsCountLength=0,this._myMaxTotalExecutionTimeLength=0,this._myMaxTotalExecutionTimePercentageLength=0,this._myMaxAverageExecutionTimeLength=0}update(e){if(this._myParams.myPerformanceAnalyzer!=null&&(this._myLogTimer.update(e),this._myLogTimer.isDone())){this._myLogTimer.start();let t=this._myParams.myPerformanceAnalyzer.getTimeElapsedSinceLastReset();this._myParams.myLogMaxResults&&(t=this._myParams.myPerformanceAnalyzer.getMaxTimeElapsedSinceLastReset());let n=null;if(this._myParams.myLogMaxResults?n=this._myParams.myPerformanceAnalyzer.getMaxResults(this._myParams.myLogSortOrder):n=this._myParams.myPerformanceAnalyzer.getResults(this._myParams.myLogSortOrder),this._myParams.myLogFunctionsWithCallsCountAbove!=null){let a=new Map(n);n=new Map;let l=[...a.keys()];for(let u=0;u<l.length;u++){let _=a.get(l[u]);_.myCallsCount>this._myParams.myLogFunctionsWithCallsCountAbove&&n.set(l[u],_)}}if(this._myParams.myLogFunctionsWithTotalExecutionTimePercentageAbove!=null){let a=new Map(n);n=new Map;let l=[...a.keys()];for(let u=0;u<l.length;u++){let _=a.get(l[u]);_.myTotalExecutionTimePercentage*100>this._myParams.myLogFunctionsWithTotalExecutionTimePercentageAbove&&n.set(l[u],_)}}if(this._myParams.myLogMaxAmountOfFunctions!=null){let a=new Map(n);n=new Map;let l=[...a.keys()];for(let u=0;u<this._myParams.myLogMaxAmountOfFunctions&&u<l.length;u++){let _=a.get(l[u]);n.set(l[u],_)}}this._myParams.myClearConsoleBeforeLog&&console.clear();let o=new Map;for(let a of n.keys()){let l=n.get(a),u={};this._myParams.myLogCallsCountResults&&(u.myCallsCount=l.myCallsCount),this._myParams.myLogTotalExecutionTimeResults&&(u.myTotalExecutionTime=l.myTotalExecutionTime),this._myParams.myLogTotalExecutionTimePercentageResults&&(u.myTotalExecutionTimePercentage=l.myTotalExecutionTimePercentage),this._myParams.myLogAverageExecutionTimeResults&&(u.myAverageExecutionTime=l.myAverageExecutionTime),o.set(a,u)}let s="";for(let a of n.entries()){let l=a[0],u=a[1];this._myMaxNameLength=Math.max(this._myMaxNameLength,l.length),this._myMaxCallsCountLength=Math.max(this._myMaxCallsCountLength,u.myCallsCount.toFixed(0).length),this._myMaxTotalExecutionTimeLength=Math.max(this._myMaxTotalExecutionTimeLength,u.myTotalExecutionTime.toFixed(5).length),this._myMaxTotalExecutionTimePercentageLength=Math.max(this._myMaxTotalExecutionTimePercentageLength,(u.myTotalExecutionTimePercentage*100).toFixed(2).length),this._myMaxAverageExecutionTimeLength=Math.max(this._myMaxAverageExecutionTimeLength,u.myAverageExecutionTime.toFixed(5).length)}for(let a of n.entries()){let l=a[0],u=a[1],_=0;this._myParams.myLogCallsCountResults&&_++,this._myParams.myLogTotalExecutionTimeResults&&_++,this._myParams.myLogTotalExecutionTimePercentageResults&&_++,this._myParams.myLogAverageExecutionTimeResults&&_++;let m=[],h=_>1?"Calls Count: ":"";if(this._myParams.myFormatLog)for(let f=0;f<this._myMaxCallsCountLength-u.myCallsCount.toFixed(0).length;f++)h+=" ";h+=u.myCallsCount.toFixed(0);let d=_>1?"Total Time: ":"";if(this._myParams.myFormatLog)for(let f=0;f<this._myMaxTotalExecutionTimeLength-u.myTotalExecutionTime.toFixed(5).length;f++)d+=" ";d+=u.myTotalExecutionTime.toFixed(5)+"ms";let g=_>1?"Total Time: ":"";if(this._myParams.myFormatLog)for(let f=0;f<this._myMaxTotalExecutionTimePercentageLength-(u.myTotalExecutionTimePercentage*100).toFixed(2).length;f++)g+=" ";g+=(u.myTotalExecutionTimePercentage*100).toFixed(2)+"%";let P=_>1?"Average Time: ":"";if(this._myParams.myFormatLog)for(let f=0;f<this._myMaxAverageExecutionTimeLength-u.myAverageExecutionTime.toFixed(5).length;f++)P+=" ";switch(P+=u.myAverageExecutionTime.toFixed(5)+"ms",this._myParams.myLogCallsCountResults||(h=null),this._myParams.myLogTotalExecutionTimeResults||(d=null),this._myParams.myLogTotalExecutionTimePercentageResults||(g=null),this._myParams.myLogAverageExecutionTimeResults||(P=null),this._myParams.myLogSortOrder){case Gt.CALLS_COUNT:m.push(h),m.push(d),m.push(g),m.push(P);break;case Gt.TOTAL_EXECUTION_TIME:m.push(d),m.push(g),m.push(P),m.push(h);break;case Gt.AVERAGE_EXECUTION_TIME:m.push(P),m.push(d),m.push(g),m.push(h);break;default:m.push(h),m.push(d),m.push(g),m.push(P)}if(s+=`
`,this._myParams.myFormatLog){let f=l+" ";for(;f.length<this._myMaxNameLength+1;)f+=this._myParams.myFormatLogIndentationCharacter;f+=this._myParams.myFormatLogIndentationCharacter+" ",s+=f}else s+=l+" - ";let C=!0;for(let f of m)f!=null&&(C?C=!1:s+=" - ",s+=f)}this._myParams.myLogTotalExecutionTimeResults||this._myParams.myLogTotalExecutionTimePercentageResults||this._myParams.myLogAverageExecutionTimeResults?console[this._myParams.myLogFunction](`
`+this._myParams.myLogTitle,`

Total Time:`,t.toFixed(5),`ms
`,s):console[this._myParams.myLogFunction](`
`+this._myParams.myLogTitle,`
`,s)}}};import{Component as JA,Property as Se}from"@wonderlandengine/api";var $e=class extends JA{init(){this._myActive=!1,r.isDebugEnabled(this.engine)&&(this._myActive=!0,this._myFunctionsPerformanceAnalyzer=null,this._myFunctionsPerformanceAnalysisResultsLogger=null,this._mySkipFirstUpdate=!0,this._myStartTimer=new ne(this._myDelayStart),this._myDelayStart==0&&(this._myStartTimer.end(),this._mySkipFirstUpdate=!1,this._start()))}update(e){if(this._myActive){if(this._mySkipFirstUpdate){this._mySkipFirstUpdate=!1;return}this._myStartTimer.isRunning()?(this._myStartTimer.update(e),this._myStartTimer.isDone()&&this._start()):(this._myFunctionsPerformanceAnalysisResultsLogger.update(e),this._myFunctionsPerformanceAnalyzer.resetResults()),this._myResetMaxResultsShortcutEnabled&&r.getLeftGamepad(this.engine).getButtonInfo(E.SELECT).isPressEnd(3)&&this._myFunctionsPerformanceAnalyzer.resetMaxResults()}}_start(){let e=new Fo(this.engine);if(this._myObjectsByPath.length>0){let n=[...this._myObjectsByPath.split(",")];for(let o=0;o<n.length;o++)n[o]=n[o].trim();e.myObjectsByPath.push(...n)}if(this._myClassesByPath.length>0){let n=[...this._myClassesByPath.split(",")];for(let o=0;o<n.length;o++)n[o]=n[o].trim();e.myClassesByPath.push(...n)}if(this._myFunctionsByPath.length>0){let n=[...this._myFunctionsByPath.split(",")];for(let o=0;o<n.length;o++)n[o]=n[o].trim();e.myFunctionsByPath.push(...n)}if(e.myExcludeConstructors=this._myExcludeConstructors,e.myExcludeJSObjectFunctions=this._myExcludeJSObjectFunctions,e.myAddPathPrefixToFunctionID=this._myAddPathPrefixToFunctionID,this._myFunctionPathsToInclude.length>0){let n=[...this._myFunctionPathsToInclude.split(",")];for(let o=0;o<n.length;o++)n[o]=n[o].trim();e.myFunctionPathsToInclude.push(...n)}if(this._myFunctionPathsToExclude.length>0){let n=[...this._myFunctionPathsToExclude.split(",")];for(let o=0;o<n.length;o++)n[o]=n[o].trim();e.myFunctionPathsToExclude.push(...n)}e.myObjectAddObjectDescendantsDepthLevel=this._myObjectAddObjectDescendantsDepthLevel,e.myObjectAddClassDescendantsDepthLevel=this._myObjectAddClassDescendantsDepthLevel,e.myExecutionTimeAnalysisEnabled=this._myLogTotalExecutionTimeResults||this._myLogTotalExecutionTimePercentageResults||this._myLogAverageExecutionTimeResults,e.myClassesByReference=this._myClassesByReference!=0?this._myClassesByReference:[],e.myObjectsByReference=this._myObjectsByReference!=0?this._myObjectsByReference:[],this._myFunctionsPerformanceAnalyzer=new Zn(e),this._myFunctionsPerformanceAnalyzer.overwriteFunctions();let t=new As;t.myPerformanceAnalyzer=this._myFunctionsPerformanceAnalyzer,t.myLogTitle=this._myLogTitle,t.mySecondsBetweenLogs=this._mySecondsBetweenLogs,t.myLogFunction=["log","error","warn","debug"][this._myLogFunction],t.myLogMaxAmountOfFunctions=this._myLogMaxAmountOfFunctions>=0?this._myLogMaxAmountOfFunctions:null,t.myLogFunctionsWithCallsCountAbove=this._myLogFunctionsWithCallsCountAbove>=0?this._myLogFunctionsWithCallsCountAbove:null,t.myLogFunctionsWithTotalExecutionTimePercentageAbove=this._myLogFunctionsWithTotalExecutionTimePercentageAbove>=0?this._myLogFunctionsWithTotalExecutionTimePercentageAbove:null,t.myLogMaxResults=this._myLogMaxResults,t.myClearConsoleBeforeLog=this._myClearConsoleBeforeLog,t.myLogSortOrder=this._myLogSortOrder,t.myLogCallsCountResults=this._myLogCallsCountResults,t.myLogTotalExecutionTimeResults=this._myLogTotalExecutionTimeResults,t.myLogTotalExecutionTimePercentageResults=this._myLogTotalExecutionTimePercentageResults,t.myLogAverageExecutionTimeResults=this._myLogAverageExecutionTimeResults,this._myFunctionsPerformanceAnalysisResultsLogger=new Rs(t)}};R($e,"TypeName","pp-debug-functions-performance-analyzer"),R($e,"Properties",{_myObjectsByPath:Se.string(""),_myClassesByPath:Se.string(""),_myFunctionsByPath:Se.string(""),_myDelayStart:Se.float(0),_myLogTitle:Se.string("Functions Performance Analysis Results"),_myLogFunction:Se.enum(["Log","Error","Warn","Debug"],"Log"),_mySecondsBetweenLogs:Se.float(1),_myLogMaxResults:Se.bool(!1),_myLogSortOrder:Se.enum(["None","Calls Count","Total Execution Time","Average Execution Time"],"None"),_myLogCallsCountResults:Se.bool(!0),_myLogTotalExecutionTimeResults:Se.bool(!0),_myLogTotalExecutionTimePercentageResults:Se.bool(!0),_myLogAverageExecutionTimeResults:Se.bool(!0),_myLogMaxAmountOfFunctions:Se.int(-1),_myLogFunctionsWithCallsCountAbove:Se.int(-1),_myLogFunctionsWithTotalExecutionTimePercentageAbove:Se.float(-1),_myFunctionPathsToInclude:Se.string(""),_myFunctionPathsToExclude:Se.string(""),_myExcludeConstructors:Se.bool(!1),_myExcludeJSObjectFunctions:Se.bool(!0),_myAddPathPrefixToFunctionID:Se.bool(!0),_myObjectAddObjectDescendantsDepthLevel:Se.int(0),_myObjectAddClassDescendantsDepthLevel:Se.int(0),_myClearConsoleBeforeLog:Se.bool(!1),_myResetMaxResultsShortcutEnabled:Se.bool(!1),_myClassesByReference:Se.enum(["Code Driven"],"Code Driven"),_myObjectsByReference:Se.enum(["Code Driven"],"Code Driven")});import{Component as ZA,Property as nt}from"@wonderlandengine/api";var ln=class extends ZA{init(){this.object.pp_addComponent($e,{_myObjectsByPath:"PP",_myDelayStart:this._myDelayStart,_myLogTitle:"PP Functions Performance Analysis Results",_myLogFunction:this._myLogFunction,_mySecondsBetweenLogs:this._mySecondsBetweenLogs,_myLogMaxResults:this._myLogMaxResults,_myLogSortOrder:this._myLogSortOrder,_myLogMaxAmountOfFunctions:this._myLogMaxAmountOfFunctions,_myLogFunctionsWithCallsCountAbove:this._myLogFunctionsWithCallsCountAbove,_myLogFunctionsWithTotalExecutionTimePercentageAbove:this._myLogFunctionsWithTotalExecutionTimePercentageAbove,_myLogCallsCountResults:this._myLogCallsCountResults,_myLogTotalExecutionTimeResults:this._myLogTotalExecutionTimeResults,_myLogTotalExecutionTimePercentageResults:this._myLogTotalExecutionTimePercentageResults,_myLogAverageExecutionTimeResults:this._myLogAverageExecutionTimeResults,_myFunctionPathsToInclude:this._myFunctionPathsToInclude,_myFunctionPathsToExclude:this._myFunctionPathsToExclude,_myExcludeConstructors:this._myExcludeConstructors,_myExcludeJSObjectFunctions:!0,_myAddPathPrefixToFunctionID:!0,_myObjectAddObjectDescendantsDepthLevel:1,_myObjectAddClassDescendantsDepthLevel:1,_myClearConsoleBeforeLog:this._myClearConsoleBeforeLog,_myResetMaxResultsShortcutEnabled:this._myResetMaxResultsShortcutEnabled})}};R(ln,"TypeName","pp-debug-pp-functions-performance-analyzer"),R(ln,"Properties",{_myDelayStart:nt.float(0),_myLogFunction:nt.enum(["Log","Error","Warn","Debug"],"Log"),_mySecondsBetweenLogs:nt.float(1),_myLogMaxResults:nt.bool(!1),_myLogSortOrder:nt.enum(["None","Calls Count","Total Execution Time","Average Execution Time"],"None"),_myLogCallsCountResults:nt.bool(!0),_myLogTotalExecutionTimeResults:nt.bool(!0),_myLogTotalExecutionTimePercentageResults:nt.bool(!0),_myLogAverageExecutionTimeResults:nt.bool(!0),_myLogMaxAmountOfFunctions:nt.int(-1),_myLogFunctionsWithCallsCountAbove:nt.int(-1),_myLogFunctionsWithTotalExecutionTimePercentageAbove:nt.float(-1),_myFunctionPathsToInclude:nt.string(""),_myFunctionPathsToExclude:nt.string(""),_myExcludeConstructors:nt.bool(!1),_myClearConsoleBeforeLog:nt.bool(!1),_myResetMaxResultsShortcutEnabled:nt.bool(!1)});import{Component as YA,Property as We}from"@wonderlandengine/api";var mn=class extends YA{init(){let e="Array, Uint8ClampedArray, Uint8Array, Uint16Array, Uint32Array, Int8Array, Int16Array, Int32Array, Float32Array, Float64Array";this._myIncludeOnlyMainArrayTypes&&(e="Array, Uint8Array, Uint16Array, Float32Array"),this.object.pp_addComponent($e,{_myClassesByPath:e,_myDelayStart:this._myDelayStart,_myLogTitle:"Array Functions Performance Analysis Results",_myLogFunction:this._myLogFunction,_mySecondsBetweenLogs:this._mySecondsBetweenLogs,_myLogMaxResults:this._myLogMaxResults,_myLogSortOrder:this._myLogSortOrder,_myLogMaxAmountOfFunctions:this._myLogMaxAmountOfFunctions,_myLogFunctionsWithCallsCountAbove:this._myLogFunctionsWithCallsCountAbove,_myLogFunctionsWithTotalExecutionTimePercentageAbove:this._myLogFunctionsWithTotalExecutionTimePercentageAbove,_myLogCallsCountResults:this._myLogCallsCountResults,_myLogTotalExecutionTimeResults:this._myLogTotalExecutionTimeResults,_myLogTotalExecutionTimePercentageResults:this._myLogTotalExecutionTimePercentageResults,_myLogAverageExecutionTimeResults:this._myLogAverageExecutionTimeResults,_myFunctionPathsToInclude:this._myFunctionPathsToInclude+(this._myFunctionPathsToInclude.length>0&&this._myIncludeOnlyArrayExtensionFunctions?", ":"")+(this._myIncludeOnlyArrayExtensionFunctions?"pp_, vec_, vec2_, vec3_, vec4_, quat_, quat2_, mat3_, mat4_, _pp_, _vec_, _quat_":""),_myFunctionPathsToExclude:this._myFunctionPathsToExclude,_myExcludeConstructors:this._myExcludeConstructors,_myExcludeJSObjectFunctions:!0,_myAddPathPrefixToFunctionID:!0,_myClearConsoleBeforeLog:this._myClearConsoleBeforeLog,_myResetMaxResultsShortcutEnabled:this._myResetMaxResultsShortcutEnabled})}};R(mn,"TypeName","pp-debug-array-functions-performance-analyzer"),R(mn,"Properties",{_myIncludeOnlyMainArrayTypes:We.bool(!0),_myIncludeOnlyArrayExtensionFunctions:We.bool(!1),_myDelayStart:We.float(0),_myLogFunction:We.enum(["Log","Error","Warn","Debug"],"Log"),_mySecondsBetweenLogs:We.float(1),_myLogMaxResults:We.bool(!1),_myLogSortOrder:We.enum(["None","Calls Count","Total Execution Time","Average Execution Time"],"None"),_myLogCallsCountResults:We.bool(!0),_myLogTotalExecutionTimeResults:We.bool(!0),_myLogTotalExecutionTimePercentageResults:We.bool(!0),_myLogAverageExecutionTimeResults:We.bool(!0),_myLogMaxAmountOfFunctions:We.int(-1),_myLogFunctionsWithCallsCountAbove:We.int(-1),_myLogFunctionsWithTotalExecutionTimePercentageAbove:We.float(-1),_myFunctionPathsToInclude:We.string(""),_myFunctionPathsToExclude:We.string(""),_myExcludeConstructors:We.bool(!1),_myClearConsoleBeforeLog:We.bool(!1),_myResetMaxResultsShortcutEnabled:We.bool(!1)});import{Component as $A,Property as Ct}from"@wonderlandengine/api";var yn=class extends $A{init(){this.object.pp_addComponent($e,{_myObjectsByPath:"PP",_myDelayStart:this._myDelayStart,_myLogTitle:"PP Array Creation Performance Analysis Results",_myLogFunction:this._myLogFunction,_mySecondsBetweenLogs:this._mySecondsBetweenLogs,_myLogMaxResults:this._myLogMaxResults,_myLogSortOrder:this._myLogSortOrder,_myLogMaxAmountOfFunctions:this._myLogMaxAmountOfFunctions,_myLogFunctionsWithCallsCountAbove:this._myLogFunctionsWithCallsCountAbove,_myLogFunctionsWithTotalExecutionTimePercentageAbove:this._myLogFunctionsWithTotalExecutionTimePercentageAbove,_myLogCallsCountResults:this._myLogCallsCountResults,_myLogTotalExecutionTimeResults:this._myLogTotalExecutionTimeResults,_myLogTotalExecutionTimePercentageResults:this._myLogTotalExecutionTimePercentageResults,_myLogAverageExecutionTimeResults:this._myLogAverageExecutionTimeResults,_myFunctionPathsToInclude:"vec2_create, vec3_create, vec4_create, quat_create, quat2_create, mat3_create, mat4_create",_myExcludeConstructors:!0,_myExcludeJSObjectFunctions:!0,_myAddPathPrefixToFunctionID:!0,_myClearConsoleBeforeLog:this._myClearConsoleBeforeLog,_myResetMaxResultsShortcutEnabled:this._myResetMaxResultsShortcutEnabled})}};R(yn,"TypeName","pp-debug-pp-array-creation-performance-analyzer"),R(yn,"Properties",{_myDelayStart:Ct.float(0),_myLogFunction:Ct.enum(["Log","Error","Warn","Debug"],"Log"),_mySecondsBetweenLogs:Ct.float(1),_myLogMaxResults:Ct.bool(!1),_myLogSortOrder:Ct.enum(["None","Calls Count","Total Execution Time","Average Execution Time"],"None"),_myLogCallsCountResults:Ct.bool(!0),_myLogTotalExecutionTimeResults:Ct.bool(!0),_myLogTotalExecutionTimePercentageResults:Ct.bool(!0),_myLogAverageExecutionTimeResults:Ct.bool(!0),_myLogMaxAmountOfFunctions:Ct.int(-1),_myLogFunctionsWithCallsCountAbove:Ct.int(-1),_myLogFunctionsWithTotalExecutionTimePercentageAbove:Ct.float(-1),_myClearConsoleBeforeLog:Ct.bool(!1),_myResetMaxResultsShortcutEnabled:Ct.bool(!1)});import{Component as eR,Property as ot}from"@wonderlandengine/api";var un=class extends eR{init(){this.object.pp_addComponent($e,{_myObjectsByPath:"WL",_myDelayStart:this._myDelayStart,_myLogTitle:"WL Functions Performance Analysis Results",_myLogFunction:this._myLogFunction,_mySecondsBetweenLogs:this._mySecondsBetweenLogs,_myLogMaxResults:this._myLogMaxResults,_myLogSortOrder:this._myLogSortOrder,_myLogMaxAmountOfFunctions:this._myLogMaxAmountOfFunctions,_myLogFunctionsWithCallsCountAbove:this._myLogFunctionsWithCallsCountAbove,_myLogFunctionsWithTotalExecutionTimePercentageAbove:this._myLogFunctionsWithTotalExecutionTimePercentageAbove,_myLogCallsCountResults:this._myLogCallsCountResults,_myLogTotalExecutionTimeResults:this._myLogTotalExecutionTimeResults,_myLogTotalExecutionTimePercentageResults:this._myLogTotalExecutionTimePercentageResults,_myLogAverageExecutionTimeResults:this._myLogAverageExecutionTimeResults,_myFunctionPathsToInclude:this._myFunctionPathsToInclude,_myFunctionPathsToExclude:this._myFunctionPathsToExclude,_myExcludeConstructors:this._myExcludeConstructors,_myExcludeJSObjectFunctions:!0,_myAddPathPrefixToFunctionID:!0,_myObjectAddObjectDescendantsDepthLevel:1,_myObjectAddClassDescendantsDepthLevel:1,_myClearConsoleBeforeLog:this._myClearConsoleBeforeLog,_myResetMaxResultsShortcutEnabled:this._myResetMaxResultsShortcutEnabled})}};R(un,"TypeName","pp-debug-wl-functions-performance-analyzer"),R(un,"Properties",{_myDelayStart:ot.float(0),_myLogFunction:ot.enum(["Log","Error","Warn","Debug"],"Log"),_mySecondsBetweenLogs:ot.float(1),_myLogMaxResults:ot.bool(!1),_myLogSortOrder:ot.enum(["None","Calls Count","Total Execution Time","Average Execution Time"],"None"),_myLogCallsCountResults:ot.bool(!0),_myLogTotalExecutionTimeResults:ot.bool(!0),_myLogTotalExecutionTimePercentageResults:ot.bool(!0),_myLogAverageExecutionTimeResults:ot.bool(!0),_myLogMaxAmountOfFunctions:ot.int(-1),_myLogFunctionsWithCallsCountAbove:ot.int(-1),_myLogFunctionsWithTotalExecutionTimePercentageAbove:ot.float(-1),_myFunctionPathsToInclude:ot.string(""),_myFunctionPathsToExclude:ot.string(""),_myExcludeConstructors:ot.bool(!1),_myClearConsoleBeforeLog:ot.bool(!1),_myResetMaxResultsShortcutEnabled:ot.bool(!1)});import{AnimationComponent as tR,CollisionComponent as iR,Component as nR,InputComponent as oR,LightComponent as sR,MeshComponent as aR,PhysXComponent as rR,Property as je,TextComponent as lR,ViewComponent as mR}from"@wonderlandengine/api";var hn=class extends nR{init(){this._myStartTimer=new ne(this._myDelayStart),this._myDelayStart==0&&(this._myStartTimer.end(),this._start())}update(e){this._myStartTimer.isRunning()&&(this._myStartTimer.update(e),this._myStartTimer.isDone()&&this._start())}_start(){let e=[],t=[];this._myAnalyzeComponentInstances&&this._addComponentInstanceReferences(e),this._myAnalyzeComponentTypes&&this._addComponentTypeReferences(t),this._myAnalyzerComponent=this.object.pp_addComponent($e,{_myObjectsByReference:e,_myClassesByReference:t,_myDelayStart:0,_myLogTitle:"WL Components Performance Analysis Results",_myLogFunction:this._myLogFunction,_mySecondsBetweenLogs:this._mySecondsBetweenLogs,_myLogMaxResults:this._myLogMaxResults,_myLogSortOrder:this._myLogSortOrder,_myLogMaxAmountOfFunctions:this._myLogMaxAmountOfFunctions,_myLogFunctionsWithCallsCountAbove:this._myLogFunctionsWithCallsCountAbove,_myLogFunctionsWithTotalExecutionTimePercentageAbove:this._myLogFunctionsWithTotalExecutionTimePercentageAbove,_myLogCallsCountResults:this._myLogCallsCountResults,_myLogTotalExecutionTimeResults:this._myLogTotalExecutionTimeResults,_myLogTotalExecutionTimePercentageResults:this._myLogTotalExecutionTimePercentageResults,_myLogAverageExecutionTimeResults:this._myLogAverageExecutionTimeResults,_myFunctionPathsToInclude:this._myFunctionPathsToInclude,_myFunctionPathsToExclude:this._myFunctionPathsToExclude,_myExcludeConstructors:this._myExcludeConstructors,_myExcludeJSObjectFunctions:!0,_myAddPathPrefixToFunctionID:!0,_myObjectAddClassDescendantsDepthLevel:0,_myClearConsoleBeforeLog:this._myClearConsoleBeforeLog,_myResetMaxResultsShortcutEnabled:this._myResetMaxResultsShortcutEnabled})}_addComponentTypeReferences(e){let t=[tR,iR,oR,sR,aR,rR,lR,mR];for(let n of t)e.push([n.prototype,'{"'+n.TypeName+'"}']);for(let n of z.getJavascriptComponentClassesByIndex(this.engine))e.push([n.prototype,'{"'+n.TypeName+'"}'])}_addComponentInstanceReferences(e){for(let t of z.getJavascriptComponentInstances(this.engine)){let n="";switch(this._myComponentInstanceID){case 0:n=t.object.pp_getID();break;case 1:n=t.object.pp_getName();break;case 2:n=t.object.pp_getID(),t.object.pp_getName().length>0&&(n=n+" - "+t.object.pp_getName());break}e.push([t,'{"'+t.type+'"}['+n+"]"])}}};R(hn,"TypeName","pp-debug-wl-components-functions-performance-analyzer"),R(hn,"Properties",{_myAnalyzeComponentTypes:je.bool(!0),_myAnalyzeComponentInstances:je.bool(!1),_myComponentInstanceID:je.enum(["Object ID","Object Name","Object ID - Object Name"],"Object ID - Object Name"),_myDelayStart:je.float(0),_myLogFunction:je.enum(["Log","Error","Warn","Debug"],"Log"),_mySecondsBetweenLogs:je.float(1),_myLogMaxResults:je.bool(!1),_myLogSortOrder:je.enum(["None","Calls Count","Total Execution Time","Average Execution Time"],"None"),_myLogCallsCountResults:je.bool(!0),_myLogTotalExecutionTimeResults:je.bool(!0),_myLogTotalExecutionTimePercentageResults:je.bool(!0),_myLogAverageExecutionTimeResults:je.bool(!0),_myLogMaxAmountOfFunctions:je.int(-1),_myLogFunctionsWithCallsCountAbove:je.int(-1),_myLogFunctionsWithTotalExecutionTimePercentageAbove:je.float(-1),_myFunctionPathsToInclude:je.string(""),_myFunctionPathsToExclude:je.string(""),_myExcludeConstructors:je.bool(!1),_myClearConsoleBeforeLog:je.bool(!1),_myResetMaxResultsShortcutEnabled:je.bool(!1)});var Yn=class{constructor(){this.myStartFlyingForward=!1,this.myStartFlyingRight=!1,this.myAutoUpdateFlyForward=!1,this.myAutoUpdateFlyRight=!1,this.myResetFlyForwardWhenZero=!1,this.myResetFlyRightWhenZero=!1,this.myMinAngleToFlyForwardUp=90,this.myMinAngleToFlyForwardDown=90,this.myMinAngleToFlyRightUp=90,this.myMinAngleToFlyRightDown=90,this.myAdjustForwardWhenCloseToUp=!0,this.myAdjustRightWhenCloseToUp=!0,this.myAdjustForwardWhenCloseToUpAngleThreshold=10,this.myAdjustRightWhenCloseToUpAngleThreshold=10,this.myInvertForwardWhenUpsideDown=!1,this.myInvertRightWhenUpsideDown=!1,this.myAdjustLastValidFlatForwardOverConversionReferenceRotation=!0,this.myAdjustLastValidFlatRightOverConversionReferenceRotation=!0}},ri=class{constructor(e=new Yn){this._myParams=e,this._myFlyingForward=this._myParams.myStartFlyingForward,this._myFlyingRight=this._myParams.myStartFlyingRight,this._myLastConvertRotationQuat=j(),this._myLastConvertRotationQuatValid=!1,this._myLastValidFlatForward=c(),this._myLastValidFlatRight=c()}convert(e,t,n=null,o=c()){return this.convertTransform(e,t,n,o)}isFlying(){return this._myFlyingForward||this._myFlyingRight}isFlyingForward(){return this._myFlyingForward}isFlyingRight(){return this._myFlyingRight}startFlying(){this._myFlyingForward=!0,this._myFlyingRight=!0}startFlyingForward(){this._myFlyingForward=!0}startFlyingRight(){this._myFlyingRight=!0}stopFlying(){this._myFlyingForward=!1,this._myFlyingRight=!1}stopFlyingForward(){this._myFlyingForward=!1}stopFlyingRight(){this._myFlyingRight=!1}resetFly(){this.resetFlyForward(),this.resetFlyRight()}resetFlyForward(){this._myParams.myStartFlyingForward?this.startFlyingForward():this.stopFlyingForward()}resetFlyRight(){this._myParams.myStartFlyingRight?this.startFlyingRight():this.stopFlyingRight()}resetLastValidFlatDirections(){this._myLastValidFlatForward.vec3_zero(),this._myLastValidFlatRight.vec3_zero()}resetLastValidFlatForward(){this._myLastValidFlatForward.vec3_zero()}resetLastValidFlatRight(){this._myLastValidFlatRight.vec3_zero()}resetLastConvertTransform(){this._myLastConvertRotationQuatValid=!1,this._myLastConvertRotationQuat.quat_identity()}convertForward(e,t,n=null,o=c()){}convertTransform(e,t,n=null,o=c()){return this.convertTransformMatrix(e,t,n,o)}convertTransformMatrix(e,t,n=null,o=c()){}convertTransformQuat(e,t,n=null,o=c()){}convertRotationQuat(e,t,n=null,o=c()){}};ri.prototype.convertForward=function(){let i=j();return function(t,n,o=null,s=c()){return i.quat_identity(),i.quat_setForward(n,o),this.convertRotationQuat(t,i,o,s)}}();ri.prototype.convertTransformMatrix=function(){let i=j();return function(t,n,o=null,s=c()){return i=n.mat4_getRotationQuat(i),this.convertRotationQuat(t,i,o,s)}}();ri.prototype.convertTransformQuat=function(){let i=j();return function(t,n,o=null,s=c()){return i=n.quat2_getRotationQuat(i),this.convertRotationQuat(t,i,o,s)}}();ri.prototype.convertRotationQuat=function(){let i=c(),e=c(),t=c(),n=c(),o=c(),s=c(),a=j();return function(u,_,m=null,h=c()){if(h.vec3_zero(),(this._myParams.myAdjustLastValidFlatForwardOverConversionReferenceRotation||this._myParams.myAdjustLastValidFlatRightOverConversionReferenceRotation)&&m!=null&&this._myLastConvertRotationQuatValid&&(a=this._myLastConvertRotationQuat.quat_rotationToQuat(_,a).quat_rotationAroundAxisQuat(m,a),Math.pp_angleClamp(a.quat_getAngle(),!0)>Math.PP_EPSILON_DEGREES&&(this._myParams.myAdjustLastValidFlatForwardOverConversionReferenceRotation&&this._myLastValidFlatForward.vec3_rotateQuat(a,this._myLastValidFlatForward),this._myParams.myAdjustLastValidFlatRightOverConversionReferenceRotation&&this._myLastValidFlatRight.vec3_rotateQuat(a,this._myLastValidFlatRight))),u.vec2_isZero())this._myParams.myAutoUpdateFlyForward&&this._myParams.myResetFlyForwardWhenZero&&this.resetFlyForward(),this._myParams.myAutoUpdateFlyRight&&this._myParams.myResetFlyRightWhenZero&&this.resetFlyRight();else{if(i=_.quat_getForward(i),e=_.quat_getRight(e),t=_.quat_getUp(t),m!=null){let d=!m.vec3_isConcordant(t);if(n=m.vec3_negate(n),this._myParams.myAutoUpdateFlyForward){let g=i.vec3_angle(m);this._myFlyingForward=this._myFlyingForward||g<90-this._myParams.myMinAngleToFlyForwardUp||g>90+this._myParams.myMinAngleToFlyForwardDown}if(this._myParams.myAutoUpdateFlyRight){let g=e.vec3_angle(m);this._myFlyingRight=this._myFlyingRight||g<90-this._myParams.myMinAngleToFlyRightUp||g>90+this._myParams.myMinAngleToFlyRightDown}this._myFlyingForward||(this._myParams.myAdjustForwardWhenCloseToUp&&!this._myLastValidFlatForward.vec3_isZero(Math.PP_EPSILON)&&(i.vec3_angle(m)<this._myParams.myAdjustForwardWhenCloseToUpAngleThreshold||i.vec3_angle(n)<this._myParams.myAdjustForwardWhenCloseToUpAngleThreshold)?i.pp_copy(this._myLastValidFlatForward):d&&this._myParams.myInvertForwardWhenUpsideDown&&i.vec3_negate(i),i=i.vec3_removeComponentAlongAxis(m,i),i.vec3_normalize(i),i.vec3_isZero(Math.PP_EPSILON)&&(this._myLastValidFlatForward.vec3_isZero(Math.PP_EPSILON)?i.vec3_set(0,0,1):i.pp_copy(this._myLastValidFlatForward))),this._myFlyingRight||(this._myParams.myAdjustRightWhenCloseToUp&&!this._myLastValidFlatRight.vec3_isZero(Math.PP_EPSILON)&&(e.vec3_angle(m)<this._myParams.myAdjustRightWhenCloseToUpAngleThreshold||e.vec3_angle(n)<this._myParams.myAdjustRightWhenCloseToUpAngleThreshold)?e.pp_copy(this._myLastValidFlatRight):d&&this._myParams.myInvertRightWhenUpsideDown&&e.vec3_negate(e),e=e.vec3_removeComponentAlongAxis(m,e),e.vec3_normalize(e),e.vec3_isZero(Math.PP_EPSILON)&&(this._myLastValidFlatRight.vec3_isZero(Math.PP_EPSILON)?e.vec3_set(-1,0,0):e.pp_copy(this._myLastValidFlatRight))),(i.vec3_angle(m)>=this._myParams.myAdjustForwardWhenCloseToUpAngleThreshold&&i.vec3_angle(n)>=this._myParams.myAdjustForwardWhenCloseToUpAngleThreshold||u[1]!=0&&this._myLastValidFlatForward.vec3_isZero(Math.PP_EPSILON))&&(this._myLastValidFlatForward=i.vec3_removeComponentAlongAxis(m,this._myLastValidFlatForward),this._myLastValidFlatForward.vec3_normalize(this._myLastValidFlatForward)),(e.vec3_angle(m)>=this._myParams.myAdjustRightWhenCloseToUpAngleThreshold&&e.vec3_angle(n)>=this._myParams.myAdjustRightWhenCloseToUpAngleThreshold||u[0]!=0&&this._myLastValidFlatRight.vec3_isZero(Math.PP_EPSILON))&&(this._myLastValidFlatRight=e.vec3_removeComponentAlongAxis(m,this._myLastValidFlatRight),this._myLastValidFlatRight.vec3_normalize(this._myLastValidFlatRight))}h=e.vec3_scale(u[0],s).vec3_add(i.vec3_scale(u[1],o),h),m!=null&&!this._myFlyingForward&&!this._myFlyingRight&&(h=h.vec3_removeComponentAlongAxis(m,h)),h.vec3_normalize(h)}return this._myLastConvertRotationQuat.quat_copy(_),this._myLastConvertRotationQuatValid=!0,h}}();var xi=class{constructor(e,t=null,n=0,o=0,s=he.linear,a=null){t==null&&(t=e),this._myFromNumber=e,this._myToNumber=t,this._myFromFactor=n,this._myToFactor=o,this._myEasingFunction=s,this._myRoundingFunction=a}get(e){let t=this._myEasingFunction(Math.pp_mapToRange(e,this._myFromFactor,this._myToFactor,0,1)),n=Math.pp_lerp(this._myFromNumber,this._myToNumber,t);return this._myRoundingFunction&&(n=this._myRoundingFunction(n,this._myFromNumber,this._myToNumber)),n}getAverage(e){return this.get(e)}getRange(e){let t=this.get(e);return[t,t]}getMax(e){return this.get(e)}getMin(e){return this.get(e)}isInside(e,t){return this.get(t)==e}isInsideAngleRange(e,t){return this.isInsideAngleRangeDegrees(e,t)}isInsideAngleRangeDegrees(e,t){let n=this.get(t),o=Math.pp_angleClampDegrees(e),s=Math.pp_angleClampDegrees(n);return o==s}isInsideAngleRangeRadians(e,t){let n=this.get(t),o=Math.pp_angleClampRadians(e),s=Math.pp_angleClampRadians(n);return o==s}},Yl=class extends xi{constructor(e,t,n,o,s=he.linear,a=null){a==null&&(a=function(l,u,_){let m=null;return u<=_?m=Math.floor(l):m=Math.ceil(l),m}),super(e,t,n,o,s,a)}},Br=class{constructor(e,t=null,n=0,o=0,s=he.linear,a=null){t==null&&(t=e),this._myFromNumberOverFactor=new xi(e[0],t[0],n,o,s,a),this._myToNumberOverFactor=new xi(e[1],t[1],n,o,s,a),this._myRoundingFunction=a}get(e){let t=this._myFromNumberOverFactor.get(e),n=this._myToNumberOverFactor.get(e),o=null;return this._myRoundingFunction?o=Math.pp_randomInt(t,n):o=Math.pp_random(t,n),o}getAverage(e){let t=this._myFromNumberOverFactor.get(e),n=this._myToNumberOverFactor.get(e),o=(t+n)/2;return this._myRoundingFunction&&(o=this._myRoundingFunction(o,t,n)),o}getRange(e){let t=this._myFromNumberOverFactor.get(e),n=this._myToNumberOverFactor.get(e);return[t,n]}getMax(e){let t=this._myFromNumberOverFactor.get(e),n=this._myToNumberOverFactor.get(e);return Math.max(t,n)}getMin(e){let t=this._myFromNumberOverFactor.get(e),n=this._myToNumberOverFactor.get(e);return Math.min(t,n)}isInside(e,t){let n=this._myFromNumberOverFactor.get(t),o=this._myToNumberOverFactor.get(t),s=Math.min(n,o),a=Math.max(n,o);return e>=s&&e<=a}isInsideAngleRange(e,t){return this.isInsideAngleRangeDegrees(e,t)}isInsideAngleRangeDegrees(e,t){let n=this._myFromNumberOverFactor.get(t),o=this._myToNumberOverFactor.get(t);return Math.pp_isInsideAngleRangeDegrees(e,n,o)}isInsideAngleRangeRadians(e,t){let n=this._myFromNumberOverFactor.get(t),o=this._myToNumberOverFactor.get(t);return Math.pp_isInsideAngleRangeRadians(e,n,o)}},$l=class extends Br{constructor(e,t,n,o,s=he.linear,a=null){a==null&&(a=function(l,u,_){let m=null;return u<=_?m=Math.floor(l):m=Math.ceil(l),m}),super(e,t,n,o,s,a)}};import{Component as yR,Emitter as em,PhysXComponent as uR,Property as Lr}from"@wonderlandengine/api";var gi=class extends yR{init(){this._myGrabbed=!1,this._myGrabber=null,this._myOldParent=null,this._myPhysX=null,this._myOldKinematicValue=null,this._myGrabEmitter=new em,this._myThrowEmitter=new em,this._myReleaseEmitter=new em}start(){this._myOldParent=this.object.pp_getParent(),this._myPhysX=this.object.pp_getComponent(uR)}onDeactivate(){this.release()}grab(e){this.isGrabbed()||(this._myOldKinematicValue=this._myPhysX.kinematic),this.release(),this._myPhysX.kinematic=!0,this._myOldParent=this.object.pp_getParent(),this.object.pp_setParent(e),this._myGrabbed=!0,this._myGrabEmitter.notify(e,this)}throw(e,t){if(this._myGrabbed){let n=this._myGrabber;this._release(),this._myPhysX.linearVelocity=e.vec3_scale(this._myThrowLinearVelocityMultiplier),this._myPhysX.angularVelocity=t.vec3_scale(this._myThrowAngularVelocityMultiplier),this._myThrowEmitter.notify(n,this),this._myReleaseEmitter.notify(n,this,!0)}}release(){if(this._myGrabbed){let e=this._myGrabber;this._release(),this._myReleaseEmitter.notify(e,this,!1)}}getLinearVelocity(){let e=c();return this._myPhysX.linearVelocity.vec3_clone(e),e}getAngularVelocity(){return this.getAngularVelocityDegrees()}getAngularVelocityDegrees(){let e=c();return this._myPhysX.angularVelocity.vec3_toDegrees(e),e}getAngularVelocityRadians(){let e=c();return this._myPhysX.angularVelocity.vec3_clone(e),e}isGrabbed(){return this._myGrabbed}getGrabber(){return this._myGrabber}registerGrabEventListener(e,t){this._myGrabEmitter.add(t,{id:e})}unregisterGrabEventListener(e){this._myGrabEmitter.remove(e)}registerThrowEventListener(e,t){this._myThrowEmitter.add(t,{id:e})}unregisterThrowEventListener(e){this._myThrowEmitter.remove(e)}registerReleaseEventListener(e,t){this._myReleaseEmitter.add(t,{id:e})}unregisterReleaseEventListener(e){this._myReleaseEmitter.remove(e)}_release(){this._myParentOnRelease==0?this.object.pp_setParent(r.getSceneObjects(this.engine).myDynamics):this.object.pp_setParent(this._myOldParent),this._myGrabbed=!1,this._myGrabber=null,this._myKinematicValueOnRelease==0?this._myPhysX.kinematic=!0:this._myKinematicValueOnRelease==1?this._myPhysX.kinematic=!1:this._myOldKinematicValue!=null&&(this._myPhysX.kinematic=this._myOldKinematicValue),this._myPhysX.kinematic&&(this._myPhysX.linearVelocity=c(),this._myPhysX.angularVelocity=c())}pp_clone(e){return z.cloneDefault(this,e)}pp_clonePostProcess(e){e.start()}};R(gi,"TypeName","pp-grabbable"),R(gi,"Properties",{_myThrowLinearVelocityMultiplier:Lr.float(1),_myThrowAngularVelocityMultiplier:Lr.float(1),_myKinematicValueOnRelease:Lr.enum(["True","False","Own"],"False"),_myParentOnRelease:Lr.enum(["Scene","Own"],"Own")});import{Component as hR,Emitter as TC,PhysXComponent as cR,Property as Ot}from"@wonderlandengine/api";var fi=class extends hR{init(){this._myGrabbables=[],this._myGamepad=null,this._myActiveGrabButton=null,this._myLinearVelocityHistorySize=5,this._myLinearVelocityHistorySpeedAverageSamplesFromStart=1,this._myLinearVelocityHistoryDirectionAverageSamplesFromStart=3,this._myLinearVelocityHistoryDirectionAverageSkipFromStart=0,this._myHandLinearVelocityHistory=new Array(this._myLinearVelocityHistorySize),this._myHandLinearVelocityHistory.fill(c()),this._myAngularVelocityHistorySize=1,this._myHandAngularVelocityHistory=new Array(this._myAngularVelocityHistorySize),this._myHandAngularVelocityHistory.fill(c()),this._myThrowMaxAngularSpeedRadians=Math.pp_toRadians(this._myThrowMaxAngularSpeed),this._myGrabEmitter=new TC,this._myThrowEmitter=new TC,this._myDebugEnabled=!1}start(){this._myHandedness==Bi.LEFT?this._myGamepad=r.getLeftGamepad(this.engine):this._myGamepad=r.getRightGamepad(this.engine),this._myPhysX=this.object.pp_getComponent(cR),this._myCollisionsCollector=new Si(this._myPhysX,!0)}update(e){this._myCollisionsCollector.update(e),this._myGrabbables.length>0&&(this._updateLinearVelocityHistory(),this._updateAngularVelocityHistory())}grab(e=null){this._grab(e)}throw(e=null){this._throw(e)}getGamepad(){return this._myGamepad}getHandedness(){return ie.getHandednessByIndex(this._myHandedness)}registerGrabEventListener(e,t){this._myGrabEmitter.add(t,{id:e})}unregisterGrabEventListener(e){this._myGrabEmitter.remove(e)}registerThrowEventListener(e,t){this._myThrowEmitter.add(t,{id:e})}unregisterThrowEventListener(e){this._myThrowEmitter.remove(e)}onActivate(){this._myGamepad!=null&&(this._myGrabButton==0?(this._myGamepad.registerButtonEventListener(E.SELECT,re.PRESS_START,this,this._grab.bind(this,E.SELECT)),this._myGamepad.registerButtonEventListener(E.SELECT,re.PRESS_END,this,this._throw.bind(this,E.SELECT))):this._myGrabButton==1?(this._myGamepad.registerButtonEventListener(E.SQUEEZE,re.PRESS_START,this,this._grab.bind(this,E.SQUEEZE)),this._myGamepad.registerButtonEventListener(E.SQUEEZE,re.PRESS_END,this,this._throw.bind(this,E.SQUEEZE))):(this._myGamepad.registerButtonEventListener(E.SQUEEZE,re.PRESS_START,this,this._grab.bind(this,E.SQUEEZE)),this._myGamepad.registerButtonEventListener(E.SQUEEZE,re.PRESS_END,this,this._throw.bind(this,E.SQUEEZE)),this._myGamepad.registerButtonEventListener(E.SELECT,re.PRESS_START,this,this._grab.bind(this,E.SELECT)),this._myGamepad.registerButtonEventListener(E.SELECT,re.PRESS_END,this,this._throw.bind(this,E.SELECT))))}onDeactivate(){this.throw(),this._myGamepad!=null&&(this._myGrabButton==0?(this._myGamepad.unregisterButtonEventListener(E.SELECT,re.PRESS_START,this),this._myGamepad.unregisterButtonEventListener(E.SELECT,re.PRESS_END,this)):this._myGrabButton==1?(this._myGamepad.unregisterButtonEventListener(E.SQUEEZE,re.PRESS_START,this),this._myGamepad.unregisterButtonEventListener(E.SQUEEZE,re.PRESS_END,this)):(this._myGamepad.unregisterButtonEventListener(E.SQUEEZE,re.PRESS_START,this),this._myGamepad.unregisterButtonEventListener(E.SQUEEZE,re.PRESS_END,this),this._myGamepad.unregisterButtonEventListener(E.SELECT,re.PRESS_START,this),this._myGamepad.unregisterButtonEventListener(E.SELECT,re.PRESS_END,this)))}_grab(e){if(!(this._myGrabbables.length>=this._myMaxNumberOfObjects)&&(this._myGrabButton==2||this._myActiveGrabButton==null||this._myActiveGrabButton==e||e==null)){let t=[],n=this._myCollisionsCollector.getCollisions();for(let s=0;s<n.length;s++){let a=n[s].pp_getComponent(gi);a&&a.active&&t.push(a)}let o=this.object.pp_getPosition();t.sort(function(s,a){let l=s.object.pp_getPosition(),u=a.object.pp_getPosition(),_=l.vec3_distance(o),m=u.vec3_distance(o);return Math.pp_sign(_-m,0)});for(let s of t){if(!this._isAlreadyGrabbed(s)){let a=new tm(s,this._myThrowVelocitySource==1,this._myLinearVelocityHistorySize,this._myAngularVelocityHistorySize);this._myGrabbables.push(a),s.grab(this.object),s.registerReleaseEventListener(this,this._onRelease.bind(this)),this._mySnapOnPivot&&s.object.pp_resetPositionLocal(),this._myGrabEmitter.notify(this,s)}if(this._myGrabbables.length>=this._myMaxNumberOfObjects)break}this._myGrabbables.length>0&&this._myActiveGrabButton==null&&(this._myActiveGrabButton=e)}}_throw(e){if(this._myGrabButton==2||this._myActiveGrabButton==null||this._myActiveGrabButton==e||e==null){if(this._myGrabbables.length>0){let t=null,n=null;this._myThrowVelocitySource==0&&(t=this._computeReleaseLinearVelocity(this._myHandLinearVelocityHistory),n=this._computeReleaseAngularVelocity(this._myHandAngularVelocityHistory));for(let o of this._myGrabbables){let s=o.getGrabbable();s.unregisterReleaseEventListener(this),this._myThrowVelocitySource==1&&(t=this._computeReleaseLinearVelocity(o.getLinearVelocityHistory()),n=this._computeReleaseAngularVelocity(o.getAngularVelocityHistory())),s.throw(t,n),this._myThrowEmitter.notify(this,s)}this._myGrabbables=[]}this._myActiveGrabButton=null}}_onRelease(e,t){t.unregisterReleaseEventListener(this),this._myGrabbables.pp_remove(n=>n.getGrabbable()==t),this._myGrabbables.length<=0&&(this._myActiveGrabButton=null)}_updateLinearVelocityHistory(){let e=this._myGamepad.getHandPose();this._myHandLinearVelocityHistory.unshift(e.getLinearVelocity()),this._myHandLinearVelocityHistory.pop();for(let t of this._myGrabbables)t.updateLinearVelocityHistory()}_updateAngularVelocityHistory(){let e=this._myGamepad.getHandPose();this._myHandAngularVelocityHistory.unshift(e.getAngularVelocityRadians()),this._myHandAngularVelocityHistory.pop();for(let t of this._myGrabbables)t.updateAngularVelocityHistory()}_computeReleaseLinearVelocity(e){let t=e[0].vec3_length();for(let u=1;u<this._myLinearVelocityHistorySpeedAverageSamplesFromStart;u++)t+=e[u].vec3_length();t/=this._myLinearVelocityHistorySpeedAverageSamplesFromStart;let n=Math.pp_mapToRange(t,this._myThrowLinearVelocityBoostMinSpeedThreshold,this._myThrowLinearVelocityBoostMaxSpeedThreshold,0,1);n=he.easeIn(n),t+=t*(n*this._myThrowLinearVelocityBoost),t*=this._myThrowLinearVelocityMultiplier,t=Math.pp_clamp(t,0,this._myThrowMaxLinearSpeed),this._myDebugEnabled&&r.isDebugEnabled(this.engine)&&this._debugDirectionLines(e);let s=this._myLinearVelocityHistoryDirectionAverageSamplesFromStart,a=this._myLinearVelocityHistoryDirectionAverageSkipFromStart+this._myLinearVelocityHistoryDirectionAverageSamplesFromStart,l=c();for(let u=this._myLinearVelocityHistoryDirectionAverageSkipFromStart;u<a;u++){let _=e[u];_.vec3_scale(s,_),l.vec3_add(_,l),s--}return l.vec3_normalize(l),l.vec3_scale(t,l),l}_computeReleaseAngularVelocity(e){let t=e[0],n=t.vec3_length();n=Math.pp_clamp(n*this._myThrowAngularVelocityMultiplier,0,this._myThrowMaxAngularSpeedRadians);let o=t;return o.vec3_normalize(o),o.vec3_scale(n,o),o}_debugDirectionLines(e){for(let t=this._myLinearVelocityHistoryDirectionAverageSkipFromStart+this._myLinearVelocityHistoryDirectionAverageSamplesFromStart;t>this._myLinearVelocityHistoryDirectionAverageSkipFromStart;t--){let n=t-this._myLinearVelocityHistoryDirectionAverageSkipFromStart,o=t-this._myLinearVelocityHistoryDirectionAverageSkipFromStart,s=c();for(let l=this._myLinearVelocityHistoryDirectionAverageSkipFromStart;l<o;l++){let u=e[l].pp_clone();u.vec3_scale(n,u),s.vec3_add(u,s),n--}s.vec3_normalize(s);let a=1/t;r.getDebugVisualManager(this.engine).drawLine(5,this.object.pp_getPosition(),s,.2,F(a,a,a,1))}}_isAlreadyGrabbed(e){return this._myGrabbables.pp_find(n=>n.getGrabbable()==e)!=null}};R(fi,"TypeName","pp-grabber-hand"),R(fi,"Properties",{_myHandedness:Ot.enum(["Left","Right"],"Left"),_myGrabButton:Ot.enum(["Select","Squeeze","Both","Both Exclusive"],"Squeeze"),_mySnapOnPivot:Ot.bool(!1),_myMaxNumberOfObjects:Ot.int(1),_myThrowVelocitySource:Ot.enum(["Hand","Grabbable"],"Hand"),_myThrowLinearVelocityMultiplier:Ot.float(1),_myThrowMaxLinearSpeed:Ot.float(15),_myThrowAngularVelocityMultiplier:Ot.float(.5),_myThrowMaxAngularSpeed:Ot.float(1080),_myThrowLinearVelocityBoost:Ot.float(1.75),_myThrowLinearVelocityBoostMinSpeedThreshold:Ot.float(.6),_myThrowLinearVelocityBoostMaxSpeedThreshold:Ot.float(2.5)});var tm=class{constructor(e,t,n,o){this._myGrabbable=e,this._myUseGrabbableAsVelocitySource=t,this._myUseGrabbableAsVelocitySource&&(this._myLinearVelocityHistory=new Array(n),this._myLinearVelocityHistory.fill(c()),this._myAngularVelocityHistory=new Array(o),this._myAngularVelocityHistory.fill(c()))}getGrabbable(){return this._myGrabbable}getLinearVelocityHistory(){return this._myLinearVelocityHistory}getAngularVelocityHistory(){return this._myAngularVelocityHistory}updateLinearVelocityHistory(){this._myUseGrabbableAsVelocitySource&&(this._myLinearVelocityHistory.unshift(this._myGrabbable.getLinearVelocity()),this._myLinearVelocityHistory.pop())}updateAngularVelocityHistory(){this._myUseGrabbableAsVelocitySource&&(this._myAngularVelocityHistory.unshift(this._myGrabbable.getAngularVelocityRadians()),this._myAngularVelocityHistory.pop())}onDestroy(){this._myCollisionsCollector.destroy()}};var se=null,Os=!1,yt=!1,we={DUMMY_NOT_INITIALIZED:0,CA_SDK_MISSING:1,SUBMIT_SCORE_FAILED:2,GET_LEADERBOARD_FAILED:3,GET_USER_FAILED:4,USER_HAS_NO_SCORE:5};function PC(i){Os=i}function CC(i){yt=i}function bC(i){se=i}function SC(){return Os}function vC(){return yt}function xC(){return se}function MC(i=r.getMainEngine()){return"casdk"in r.getWindow(i)}function DC(i=r.getMainEngine()){return r.getWindow(i).casdk}function EC(i,e,t,n,o,s,a=null,l=r.getMainEngine()){if(de.isSDKAvailable(l)){let u=de.getSDK(l);if(t)de.getUser(function(_){let m=_.displayName;try{u.getLeaderboard(i,e,t,n).then(function(h){if(h.leaderboard){let d=!1;for(let g of h.leaderboard)if(g.displayName==m&&g.score!=0){d=!0;break}if(d)o&&o(h.leaderboard);else if(se!=null&&se.getLeaderboard!=null&&yt&&a==null||a!=null&&a)de.getLeaderboardDummy(i,e,t,n,o,s);else if(s){let g={};g.reason="Searching for around player but the user has not submitted a score yet",g.type=we.USER_HAS_NO_SCORE,s(g,h)}}else if(se!=null&&se.getLeaderboard!=null&&yt&&a==null||a!=null&&a)de.getLeaderboardDummy(i,e,t,n,o,s);else if(s){let d={};d.reason="Get leaderboard failed",d.type=we.GET_LEADERBOARD_FAILED,s(d,h)}}).catch(function(h){if(se!=null&&se.getLeaderboard!=null&&yt&&a==null||a!=null&&a)de.getLeaderboardDummy(i,e,t,n,o,s);else if(s){let d={};d.reason="Get leaderboard failed",d.type=we.GET_LEADERBOARD_FAILED,s(d,h)}})}catch{if(se!=null&&se.getLeaderboard!=null&&yt&&a==null||a!=null&&a)de.getLeaderboardDummy(i,e,t,n,o,s);else if(s){let d={};d.reason="Get leaderboard failed",d.type=we.GET_LEADERBOARD_FAILED,s(d,null)}}},function(){if(se!=null&&se.getLeaderboard!=null&&yt&&a==null||a!=null&&a)de.getLeaderboardDummy(i,e,t,n,o,s);else if(s){let _={};_.reason="Searching for around player but the user can't be retrieved",_.type=we.GET_USER_FAILED,s(_,null)}},!1,l);else try{u.getLeaderboard(i,e,t,n).then(function(_){if(_.leaderboard)o&&o(_.leaderboard);else if(se!=null&&se.getLeaderboard!=null&&yt&&a==null||a!=null&&a)de.getLeaderboardDummy(i,e,t,n,o,s);else if(s){let m={};m.reason="Get leaderboard failed",m.type=we.GET_LEADERBOARD_FAILED,s(m,_)}}).catch(function(_){if(se!=null&&se.getLeaderboard!=null&&yt&&a==null||a!=null&&a)de.getLeaderboardDummy(i,e,t,n,o,s);else if(s){let m={};m.reason="Get leaderboard failed",m.type=we.GET_LEADERBOARD_FAILED,s(m,_)}})}catch{if(se!=null&&se.getLeaderboard!=null&&yt&&a==null||a!=null&&a)de.getLeaderboardDummy(i,e,t,n,o,s);else if(s){let m={};m.reason="Get leaderboard failed",m.type=we.GET_LEADERBOARD_FAILED,s(m,null)}}}else if(se!=null&&se.getLeaderboard!=null&&Os&&a==null||a!=null&&a)de.getLeaderboardDummy(i,e,t,n,o,s);else if(s){let u={};u.reason="Construct Arcade SDK missing",u.type=we.CA_SDK_MISSING,s(u,null)}}function AC(i,e,t,n,o,s){if(se)se.getLeaderboard(i,e,t,n,o,s);else if(s){let a={};a.reason="Dummy server not initialized",a.type=we.DUMMY_NOT_INITIALIZED,s(a,null)}}function RC(i,e,t,n,o=null,s=r.getMainEngine()){if(de.isSDKAvailable(s)){let a=de.getSDK(s);try{a.submitScore(i,e).then(function(l){if(l.error){if(se!=null&&se.submitScore!=null&&yt&&o==null||o!=null&&o)de.submitScoreDummy(i,e,t,n);else if(n){let u={};u.reason="Submit score failed",u.type=we.SUBMIT_SCORE_FAILED,n(u,l)}}else t()}).catch(function(l){if(se!=null&&se.submitScore!=null&&yt&&o==null||o!=null&&o)de.submitScoreDummy(i,e,t,n);else if(n){let u={};u.reason="Submit score failed",u.type=we.SUBMIT_SCORE_FAILED,n(u,l)}})}catch{if(se!=null&&se.submitScore!=null&&yt&&o==null||o!=null&&o)de.submitScoreDummy(i,e,t,n);else if(n){let u={};u.reason="Submit score failed",u.type=we.SUBMIT_SCORE_FAILED,n(u,null)}}}else if(se!=null&&se.submitScore!=null&&Os&&o==null||o!=null&&o)de.submitScoreDummy(i,e,t,n);else if(n){let a={};a.reason="Construct Arcade SDK missing",a.type=we.CA_SDK_MISSING,n(a,null)}}function OC(i,e,t,n){if(se)se.submitScore(i,e,t,n);else if(n){let o={};o.reason="Dummy server not initialized",o.type=we.DUMMY_NOT_INITIALIZED,n(o,null)}}function VC(i,e,t=null,n=r.getMainEngine()){if(de.isSDKAvailable(n)){let o=de.getSDK(n);try{o.getUser().then(function(s){if(s.user)i&&i(s.user);else if(se!=null&&se.getUser!=null&&yt&&t==null||t!=null&&t)de.getUserDummy(i,e);else if(e){let a={};a.reason="Get user failed",a.type=we.GET_USER_FAILED,e(a,s)}}).catch(function(s){if(se!=null&&se.getUser!=null&&yt&&t==null||t!=null&&t)de.getUserDummy(i,e);else if(e){let a={};a.reason="Get user failed",a.type=we.GET_USER_FAILED,e(a,s)}})}catch{if(se!=null&&se.getUser!=null&&yt&&t==null||t!=null&&t)de.getUserDummy(i,e);else if(e){let a={};a.reason="Get user failed",a.type=we.GET_USER_FAILED,e(a,null)}}}else if(se!=null&&se.getUser!=null&&Os&&t==null||t!=null&&t)de.getUserDummy(i,e);else if(e){let o={};o.reason="Construct Arcade SDK missing",o.type=we.CA_SDK_MISSING,e(o,null)}}function IC(i,e){if(se)se.getUser(i,e);else if(e){let t={};t.reason="Dummy server not initialized",t.type=we.DUMMY_NOT_INITIALIZED,e(t,null)}}var de={setUseDummyServerOnSDKMissing:PC,setUseDummyServerOnError:CC,setDummyServer:bC,isUseDummyServerOnSDKMissing:SC,isUseDummyServerOnError:vC,getDummyServer:xC,isSDKAvailable:MC,getSDK:DC,getLeaderboard:EC,getLeaderboardDummy:AC,submitScore:RC,submitScoreDummy:OC,getUser:VC,getUserDummy:IC};var Vs=class{constructor(e=r.getMainEngine()){this._myEngine=e}getLeaderboard(e,t,n,o,s,a){let l=null;for(de.isSDKAvailable(this._myEngine)?l=[{rank:0,displayName:"An",score:0},{rank:1,displayName:"Error",score:0},{rank:2,displayName:"Has",score:0},{rank:3,displayName:"Occurred",score:0},{rank:4,displayName:"While",score:0},{rank:5,displayName:"Trying",score:0},{rank:6,displayName:"To",score:0},{rank:7,displayName:"Retrieve",score:0},{rank:8,displayName:"The",score:0},{rank:9,displayName:"Leaderboard",score:0}]:n?l=[{rank:0,displayName:"Sign In",score:0},{rank:1,displayName:"And",score:0},{rank:2,displayName:"Play",score:0},{rank:3,displayName:"On",score:0},{rank:4,displayName:"HeyVR",score:0},{rank:5,displayName:"To",score:0},{rank:6,displayName:"Submit",score:0},{rank:7,displayName:"Your",score:0},{rank:8,displayName:"Own",score:0},{rank:9,displayName:"Score",score:0}]:l=[{rank:0,displayName:"The",score:0},{rank:1,displayName:"Top 10",score:0},{rank:2,displayName:"Leaderboard",score:0},{rank:3,displayName:"Is",score:0},{rank:4,displayName:"Available",score:0},{rank:5,displayName:"Only",score:0},{rank:5,displayName:"When",score:0},{rank:7,displayName:"Playing",score:0},{rank:8,displayName:"On",score:0},{rank:9,displayName:"HeyVR",score:0}];l.length>o;)l.pop();s&&s(l)}submitScore(e,t,n,o){n&&n()}getUser(e,t){let n={};n.displayName="J",e&&e(n)}};import{Component as pR,Property as Wi,TextComponent as BC}from"@wonderlandengine/api";var cn=class extends pR{init(){this._myNamesTextComponent=null,this._myScoresTextComponent=null,this._myStarted=!1,this._myDestroyed=!1}start(){this._myAddDefaultCADummyServer&&(de.setDummyServer(new Vs),de.setUseDummyServerOnSDKMissing(!0),de.setUseDummyServerOnError(!0))}update(e){if(!this._myStarted){this._myStarted=!0;let t=this.object.pp_getObjectByName("Names"),n=this.object.pp_getObjectByName("Scores");t!=null&&n!=null&&(this._myNamesTextComponent=t.pp_getComponent(BC),this._myScoresTextComponent=n.pp_getComponent(BC)),this.updateLeaderboard()}}updateLeaderboard(){de.getLeaderboard(this._myLeaderboardID,this._myAscending,this._myLocal,this._myScoresAmount,this._onLeaderboardRetrieved.bind(this),void 0,void 0,this.engine)}_onLeaderboardRetrieved(e){if(this._myDestroyed)return;let t="",n="",o=0;for(let s of e){let a=s.rank+1;a.toFixed(0).length>o&&(o=a.toFixed(0).length)}for(let s of e){let l=(s.rank+1).toFixed(0);for(;l.length<o;)l="0".concat(l);let u=`
`;for(let m=0;m<this._myNumberOfLinesBetweenScores;m++)u=u+`
`;t=t.concat(l,this._myPositionAndUsernameSeparator,s.displayName,u);let _=this._formatScore(s.score);n=n.concat(_,u)}this._myNamesTextComponent!=null&&this._myScoresTextComponent!=null&&(this._myNamesTextComponent.text=t,this._myScoresTextComponent.text=n)}_formatScore(e){let t=e.toString();return this._myScoreFormat==1?t=this._formatTime(e,!0,!0,!0):this._myScoreFormat==2?t=this._formatTime(e,!1,!0,!0):this._myScoreFormat==3?t=this._formatTime(e,!1,!1,!0):this._myScoreFormat==4?t=this._formatTime(e,!0,!0,!1):this._myScoreFormat==5&&(t=this._formatTime(e,!1,!0,!1)),t}_formatTime(e,t,n,o){let s=Math.floor(e/1e3),a=0;t&&(a=Math.floor(s/3600),s-=a*3600);let l=0;n&&(l=Math.floor(s/60),s-=l*60);let u=0;o&&(u=Math.floor(s));let _="";return o&&(_=u.toFixed(0).length<2&&(n||t)?"0".concat(u.toFixed(0)):u.toFixed(0)),n&&(_=(l.toFixed(0).length<2&&(o||t)?"0".concat(l.toFixed(0)):l.toFixed(0))+(o?":"+_:"")),t&&(_=(a.toFixed(0).length<2&&(o||n)?"0".concat(a.toFixed(0)):a.toFixed(0))+(n?":"+_:"")),_}pp_clone(e){return z.cloneDefault(this,e)}onDestroy(){this._myDestroyed=!0}};R(cn,"TypeName","pp-ca-display-leaderboard"),R(cn,"Properties",{_myLeaderboardID:Wi.string(""),_myLocal:Wi.bool(!1),_myAscending:Wi.bool(!1),_myScoresAmount:Wi.int(10),_myScoreFormat:Wi.enum(["Value","Hours:Minutes:Seconds","Minutes:Seconds","Seconds","Hours:Minutes","Minutes"],"Value"),_myPositionAndUsernameSeparator:Wi.string(" - "),_myNumberOfLinesBetweenScores:Wi.int(1),_myAddDefaultCADummyServer:Wi.bool(!1)});var st=class{constructor(){this.mySplitMovementEnabled=!1,this.mySplitMovementMaxLength=0,this.mySplitMovementMaxStepsEnabled=!1,this.mySplitMovementMaxSteps=0,this.mySplitMovementStepEqualLength=!1,this.mySplitMovementStepEqualLengthMinLength=0,this.mySplitMovementStopWhenHorizontalMovementCanceled=!1,this.mySplitMovementStopWhenVerticalMovementCanceled=!1,this.mySplitMovementStopCallback=null,this.mySplitMovementStopReturnPrevious=!1,this.myRadius=0,this.myDistanceFromFeetToIgnore=0,this.myDistanceFromHeadToIgnore=0,this.myPositionOffsetLocal=c(),this.myRotationOffsetLocalQuat=j(),this.myHorizontalMovementCheckEnabled=!1,this.myHorizontalMovementStepEnabled=!1,this.myHorizontalMovementStepMaxLength=0,this.myHorizontalMovementRadialStepAmount=0,this.myHorizontalMovementCheckDiagonalOutward=!1,this.myHorizontalMovementCheckDiagonalInward=!1,this.myHorizontalMovementCheckStraight=!1,this.myHorizontalMovementCheckHorizontalBorder=!1,this.myHorizontalMovementCheckVerticalStraight=!1,this.myHorizontalMovementCheckVerticalDiagonalUpwardOutward=!1,this.myHorizontalMovementCheckVerticalDiagonalUpwardInward=!1,this.myHorizontalMovementCheckVerticalDiagonalDownwardOutward=!1,this.myHorizontalMovementCheckVerticalDiagonalDownwardInward=!1,this.myHorizontalMovementCheckVerticalStraightDiagonalUpward=!1,this.myHorizontalMovementCheckVerticalStraightDiagonalDownward=!1,this.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward=!1,this.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward=!1,this.myHorizontalMovementHorizontalStraightCentralCheckEnabled=!1,this.myHorizontalMovementVerticalStraightCentralCheckEnabled=!1,this.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=!1,this.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled=!1,this.myHorizontalPositionCheckEnabled=!1,this.myHalfConeAngle=0,this.myHalfConeSliceAmount=0,this.myCheckConeBorder=!1,this.myCheckConeRay=!1,this.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision=!0,this.myHorizontalPositionCheckVerticalDirectionType=0,this.myCheckHorizontalFixedForwardEnabled=!1,this.myCheckHorizontalFixedForward=c(),this.myVerticalMovementCheckEnabled=!1,this.myVerticalPositionCheckEnabled=!1,this.myFeetRadius=0,this.myAdjustVerticalMovementWithGroundAngleDownhill=!1,this.myAdjustVerticalMovementWithGroundAngleUphill=!1,this.myAdjustVerticalMovementWithGroundAngleDownhillMaxAngle=null,this.myAdjustVerticalMovementWithGroundAngleUphillMaxAngle=null,this.myAdjustVerticalMovementWithGroundAngleDownhillMaxPerceivedAngle=null,this.myAdjustVerticalMovementWithGroundAngleUphillMaxPerceivedAngle=null,this.myAdjustHorizontalMovementWithGroundAngleDownhill=!1,this.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle=null,this.myAdjustVerticalMovementWithCeilingAngleDownhill=!1,this.myAdjustVerticalMovementWithCeilingAngleUphill=!1,this.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle=null,this.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle=null,this.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle=null,this.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle=null,this.myAdjustHorizontalMovementWithCeilingAngleDownhill=!1,this.myAdjustHorizontalMovementWithCeilingAngleDownhillMinAngle=null,this.myCheckVerticalFixedForwardEnabled=!1,this.myCheckVerticalFixedForward=c(),this.myCheckVerticalBothDirection=!1,this.mySnapOnGroundEnabled=!1,this.mySnapOnGroundExtraDistance=0,this.mySnapOnCeilingEnabled=!1,this.mySnapOnCeilingExtraDistance=0,this.myGroundPopOutEnabled=!1,this.myGroundPopOutExtraDistance=0,this.myCeilingPopOutEnabled=!1,this.myCeilingPopOutExtraDistance=0,this.myVerticalMovementReduceEnabled=!1,this.myGroundCircumferenceAddCenter=!1,this.myGroundCircumferenceSliceAmount=0,this.myGroundCircumferenceStepAmount=0,this.myGroundCircumferenceRotationPerStep=0,this.myVerticalAllowHitInsideCollisionIfOneOk=!1,this.myCheckHeight=!1,this.myCheckHeightVerticalMovement=!1,this.myCheckHeightVerticalPosition=!1,this.myCheckHeightTopMovement=!1,this.myCheckHeightTopPosition=!1,this.myCheckHeightConeOnCollision=!1,this.myCheckHeightConeOnCollisionKeepHit=!1,this.myHeightCheckStepAmountMovement=0,this.myHeightCheckStepAmountPosition=0,this.myCheckVerticalStraight=!1,this.myCheckVerticalDiagonalRayOutward=!1,this.myCheckVerticalDiagonalRayInward=!1,this.myCheckVerticalDiagonalBorderOutward=!1,this.myCheckVerticalDiagonalBorderInward=!1,this.myCheckVerticalDiagonalBorderRayOutward=!1,this.myCheckVerticalDiagonalBorderRayInward=!1,this.myCheckVerticalSearchFartherVerticalHit=!1,this.myGroundAngleToIgnore=0,this.myGroundAngleToIgnoreWithPerceivedAngle=null,this.myCeilingAngleToIgnore=0,this.myCeilingAngleToIgnoreWithPerceivedAngle=null,this.myHorizontalMovementGroundAngleIgnoreHeight=null,this.myHorizontalMovementCeilingAngleIgnoreHeight=null,this.myHorizontalPositionGroundAngleIgnoreHeight=null,this.myHorizontalPositionCeilingAngleIgnoreHeight=null,this.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft=null,this.myHorizontalMovementCeilingAngleIgnoreMaxMovementLeft=null,this.myHeight=0,this.myComputeGroundInfoEnabled=!1,this.myComputeCeilingInfoEnabled=!1,this.myDistanceToBeOnGround=0,this.myDistanceToComputeGroundInfo=0,this.myDistanceToBeOnCeiling=0,this.myDistanceToComputeCeilingInfo=0,this.myVerticalFixToBeOnGround=0,this.myVerticalFixToComputeGroundInfo=0,this.myVerticalFixToBeOnCeiling=0,this.myVerticalFixToComputeCeilingInfo=0,this.myGroundIsBaseInsideCollisionCheckEnabled=!1,this.myCeilingIsBaseInsideCollisionCheckEnabled=!1,this.myIsOnGroundIfInsideHit=!1,this.myIsOnCeilingIfInsideHit=!1,this.myIsOnGroundMaxSurfaceAngle=null,this.myIsOnCeilingMaxSurfaceAngle=null,this.myFindGroundDistanceMaxOutsideDistance=0,this.myFindGroundDistanceMaxInsideDistance=0,this.myFindCeilingDistanceMaxOutsideDistance=0,this.myFindCeilingDistanceMaxInsideDistance=0,this.myAllowGroundSteepFix=!1,this.myAllowCeilingSteepFix=!1,this.myMustStayOnGround=!1,this.myMustStayOnCeiling=!1,this.myMustStayOnValidGroundAngleDownhill=!1,this.myMustStayOnValidCeilingAngleDownhill=!1,this.myRegatherGroundInfoOnSurfaceCheckFail=!1,this.myRegatherCeilingInfoOnSurfaceCheckFail=!1,this.myMustStayBelowIgnorableGroundAngleDownhill=!1,this.myMustStayBelowIgnorableCeilingAngleDownhill=!1,this.myMustStayBelowGroundAngleDownhill=null,this.myMustStayBelowCeilingAngleDownhill=null,this.myMovementMustStayOnGroundHitAngle=null,this.myMovementMustStayOnCeilingHitAngle=null,this.myTeleportMustBeOnIgnorableGroundAngle=!1,this.myCheckTransformMustBeOnIgnorableGroundAngle=!1,this.myTeleportMustBeOnIgnorableCeilingAngle=!1,this.myCheckTransformMustBeOnIgnorableCeilingAngle=!1,this.myTeleportMustBeOnGroundAngle=null,this.myCheckTransformMustBeOnGroundAngle=null,this.myTeleportMustBeOnCeilingAngle=null,this.myCheckTransformMustBeOnCeilingAngle=null,this.myTeleportMustBeOnGround=!1,this.myCheckTransformMustBeOnGround=!1,this.myTeleportMustBeOnCeiling=!1,this.myCheckTransformMustBeOnCeiling=!1,this.mySlidingEnabled=!1,this.mySlidingHorizontalMovementCheckBetterNormal=!1,this.mySlidingMaxAttempts=0,this.mySlidingCheckBothDirections=!1,this.mySlidingFlickeringPreventionType=0,this.mySlidingFlickeringPreventionCheckOnlyIfAlreadySliding=!1,this.mySlidingFlickerPreventionCheckAnywayCounter=0,this.mySlidingAdjustSign90Degrees=!1,this.myHorizontalBlockLayerFlags=new Ve,this.myHorizontalObjectsToIgnore=[],this.myVerticalBlockLayerFlags=new Ve,this.myVerticalObjectsToIgnore=[],this.myExtraMovementCheckCallback=null,this.myExtraTeleportCheckCallback=null,this.myExtraCheckTransformCheckCallback=null,this.myDebugEnabled=!1,this.myDebugHorizontalMovementEnabled=!1,this.myDebugHorizontalPositionEnabled=!1,this.myDebugVerticalMovementEnabled=!1,this.myDebugVerticalPositionEnabled=!1,this.myDebugSlidingEnabled=!1,this.myDebugGroundInfoEnabled=!1,this.myDebugCeilingInfoEnabled=!1,this.myDebugRuntimeParamsEnabled=!1,this.myDebugMovementEnabled=!1}copy(e){this.mySplitMovementEnabled=e.mySplitMovementEnabled,this.mySplitMovementMaxLength=e.mySplitMovementMaxLength,this.mySplitMovementMaxStepsEnabled=e.mySplitMovementMaxStepsEnabled,this.mySplitMovementMaxSteps=e.mySplitMovementMaxSteps,this.mySplitMovementStepEqualLength=e.mySplitMovementStepEqualLength,this.mySplitMovementStepEqualLengthMinLength=e.mySplitMovementStepEqualLengthMinLength,this.mySplitMovementStopWhenHorizontalMovementCanceled=e.mySplitMovementStopWhenHorizontalMovementCanceled,this.mySplitMovementStopWhenVerticalMovementCanceled=e.mySplitMovementStopWhenVerticalMovementCanceled,this.mySplitMovementStopCallback=e.mySplitMovementStopCallback,this.mySplitMovementStopReturnPrevious=e.mySplitMovementStopReturnPrevious,this.myRadius=e.myRadius,this.myDistanceFromFeetToIgnore=e.myDistanceFromFeetToIgnore,this.myDistanceFromHeadToIgnore=e.myDistanceFromHeadToIgnore,this.myPositionOffsetLocal.vec3_copy(e.myPositionOffsetLocal),this.myRotationOffsetLocalQuat.quat_copy(e.myRotationOffsetLocalQuat),this.myHorizontalMovementCheckEnabled=e.myHorizontalMovementCheckEnabled,this.myHorizontalMovementStepEnabled=e.myHorizontalMovementStepEnabled,this.myHorizontalMovementStepMaxLength=e.myHorizontalMovementStepMaxLength,this.myHorizontalMovementRadialStepAmount=e.myHorizontalMovementRadialStepAmount,this.myHorizontalMovementCheckDiagonalOutward=e.myHorizontalMovementCheckDiagonalOutward,this.myHorizontalMovementCheckDiagonalInward=e.myHorizontalMovementCheckDiagonalInward,this.myHorizontalMovementCheckStraight=e.myHorizontalMovementCheckStraight,this.myHorizontalMovementCheckHorizontalBorder=e.myHorizontalMovementCheckHorizontalBorder,this.myHorizontalMovementCheckVerticalStraight=e.myHorizontalMovementCheckVerticalStraight,this.myHorizontalMovementCheckVerticalDiagonalUpwardOutward=e.myHorizontalMovementCheckVerticalDiagonalUpwardOutward,this.myHorizontalMovementCheckVerticalDiagonalUpwardInward=e.myHorizontalMovementCheckVerticalDiagonalUpwardInward,this.myHorizontalMovementCheckVerticalDiagonalDownwardOutward=e.myHorizontalMovementCheckVerticalDiagonalDownwardOutward,this.myHorizontalMovementCheckVerticalDiagonalDownwardInward=e.myHorizontalMovementCheckVerticalDiagonalDownwardInward,this.myHorizontalMovementCheckVerticalStraightDiagonalUpward=e.myHorizontalMovementCheckVerticalStraightDiagonalUpward,this.myHorizontalMovementCheckVerticalStraightDiagonalDownward=e.myHorizontalMovementCheckVerticalStraightDiagonalDownward,this.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward=e.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward,this.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward=e.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward,this.myHorizontalMovementHorizontalStraightCentralCheckEnabled=e.myHorizontalMovementHorizontalStraightCentralCheckEnabled,this.myHorizontalMovementVerticalStraightCentralCheckEnabled=e.myHorizontalMovementVerticalStraightCentralCheckEnabled,this.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=e.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled,this.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled=e.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled,this.myHorizontalPositionCheckEnabled=e.myHorizontalPositionCheckEnabled,this.myHalfConeAngle=e.myHalfConeAngle,this.myHalfConeSliceAmount=e.myHalfConeSliceAmount,this.myCheckConeBorder=e.myCheckConeBorder,this.myCheckConeRay=e.myCheckConeRay,this.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision=e.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision,this.myHorizontalPositionCheckVerticalDirectionType=e.myHorizontalPositionCheckVerticalDirectionType,this.myVerticalMovementCheckEnabled=e.myVerticalMovementCheckEnabled,this.myVerticalPositionCheckEnabled=e.myVerticalPositionCheckEnabled,this.myFeetRadius=e.myFeetRadius,this.myAdjustVerticalMovementWithGroundAngleDownhill=e.myAdjustVerticalMovementWithGroundAngleDownhill,this.myAdjustVerticalMovementWithGroundAngleUphill=e.myAdjustVerticalMovementWithGroundAngleUphill,this.myAdjustVerticalMovementWithGroundAngleDownhillMaxAngle=e.myAdjustVerticalMovementWithGroundAngleDownhillMaxAngle,this.myAdjustVerticalMovementWithGroundAngleUphillMaxAngle=e.myAdjustVerticalMovementWithGroundAngleUphillMaxAngle,this.myAdjustVerticalMovementWithGroundAngleDownhillMaxPerceivedAngle=e.myAdjustVerticalMovementWithGroundAngleDownhillMaxPerceivedAngle,this.myAdjustVerticalMovementWithGroundAngleUphillMaxPerceivedAngle=e.myAdjustVerticalMovementWithGroundAngleUphillMaxPerceivedAngle,this.myAdjustHorizontalMovementWithGroundAngleDownhill=e.myAdjustHorizontalMovementWithGroundAngleDownhill,this.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle=e.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle,this.myAdjustVerticalMovementWithCeilingAngleDownhill=e.myAdjustVerticalMovementWithCeilingAngleDownhill,this.myAdjustVerticalMovementWithCeilingAngleUphill=e.myAdjustVerticalMovementWithCeilingAngleUphill,this.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle=e.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle,this.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle=e.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle,this.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle=e.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle,this.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle=e.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle,this.myAdjustHorizontalMovementWithCeilingAngleDownhill=e.myAdjustHorizontalMovementWithCeilingAngleDownhill,this.myAdjustHorizontalMovementWithCeilingAngleDownhillMinAngle=e.myAdjustHorizontalMovementWithCeilingAngleDownhillMinAngle,this.myCheckVerticalFixedForwardEnabled=e.myCheckVerticalFixedForwardEnabled,this.myCheckVerticalFixedForward.vec3_copy(e.myCheckVerticalFixedForward),this.myCheckVerticalBothDirection=e.myCheckVerticalBothDirection,this.mySnapOnGroundEnabled=e.mySnapOnGroundEnabled,this.mySnapOnGroundExtraDistance=e.mySnapOnGroundExtraDistance,this.mySnapOnCeilingEnabled=e.mySnapOnCeilingEnabled,this.mySnapOnCeilingExtraDistance=e.mySnapOnCeilingExtraDistance,this.myGroundPopOutEnabled=e.myGroundPopOutEnabled,this.myGroundPopOutExtraDistance=e.myGroundPopOutExtraDistance,this.myCeilingPopOutEnabled=e.myCeilingPopOutEnabled,this.myCeilingPopOutExtraDistance=e.myCeilingPopOutExtraDistance,this.myVerticalMovementReduceEnabled=e.myVerticalMovementReduceEnabled,this.myGroundCircumferenceAddCenter=e.myGroundCircumferenceAddCenter,this.myGroundCircumferenceSliceAmount=e.myGroundCircumferenceSliceAmount,this.myGroundCircumferenceStepAmount=e.myGroundCircumferenceStepAmount,this.myGroundCircumferenceRotationPerStep=e.myGroundCircumferenceRotationPerStep,this.myVerticalAllowHitInsideCollisionIfOneOk=e.myVerticalAllowHitInsideCollisionIfOneOk,this.myCheckHeight=e.myCheckHeight,this.myCheckHeightVerticalMovement=e.myCheckHeightVerticalMovement,this.myCheckHeightVerticalPosition=e.myCheckHeightVerticalPosition,this.myCheckHeightTopMovement=e.myCheckHeightTopMovement,this.myCheckHeightTopPosition=e.myCheckHeightTopPosition,this.myCheckHeightConeOnCollision=e.myCheckHeightConeOnCollision,this.myCheckHeightConeOnCollisionKeepHit=e.myCheckHeightConeOnCollisionKeepHit,this.myHeightCheckStepAmountMovement=e.myHeightCheckStepAmountMovement,this.myHeightCheckStepAmountPosition=e.myHeightCheckStepAmountPosition,this.myCheckVerticalStraight=e.myCheckVerticalStraight,this.myCheckVerticalDiagonalRayOutward=e.myCheckVerticalDiagonalRayOutward,this.myCheckVerticalDiagonalRayInward=e.myCheckVerticalDiagonalRayInward,this.myCheckVerticalDiagonalBorderOutward=e.myCheckVerticalDiagonalBorderOutward,this.myCheckVerticalDiagonalBorderInward=e.myCheckVerticalDiagonalBorderInward,this.myCheckVerticalDiagonalBorderRayOutward=e.myCheckVerticalDiagonalBorderRayOutward,this.myCheckVerticalDiagonalBorderRayInward=e.myCheckVerticalDiagonalBorderRayInward,this.myCheckVerticalSearchFartherVerticalHit=e.myCheckVerticalSearchFartherVerticalHit,this.myGroundAngleToIgnore=e.myGroundAngleToIgnore,this.myGroundAngleToIgnoreWithPerceivedAngle=e.myGroundAngleToIgnoreWithPerceivedAngle,this.myCeilingAngleToIgnore=e.myCeilingAngleToIgnore,this.myCeilingAngleToIgnoreWithPerceivedAngle=e.myCeilingAngleToIgnoreWithPerceivedAngle,this.myHorizontalMovementGroundAngleIgnoreHeight=e.myHorizontalMovementGroundAngleIgnoreHeight,this.myHorizontalMovementCeilingAngleIgnoreHeight=e.myHorizontalMovementCeilingAngleIgnoreHeight,this.myHorizontalPositionGroundAngleIgnoreHeight=e.myHorizontalPositionGroundAngleIgnoreHeight,this.myHorizontalPositionCeilingAngleIgnoreHeight=e.myHorizontalPositionCeilingAngleIgnoreHeight,this.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft=e.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft,this.myHorizontalMovementCeilingAngleIgnoreMaxMovementLeft=e.myHorizontalMovementCeilingAngleIgnoreMaxMovementLeft,this.myHeight=e.myHeight,this.myComputeGroundInfoEnabled=e.myComputeGroundInfoEnabled,this.myComputeCeilingInfoEnabled=e.myComputeCeilingInfoEnabled,this.myDistanceToBeOnGround=e.myDistanceToBeOnGround,this.myDistanceToComputeGroundInfo=e.myDistanceToComputeGroundInfo,this.myDistanceToBeOnCeiling=e.myDistanceToBeOnCeiling,this.myDistanceToComputeCeilingInfo=e.myDistanceToComputeCeilingInfo,this.myVerticalFixToBeOnGround=e.myVerticalFixToBeOnGround,this.myVerticalFixToComputeGroundInfo=e.myVerticalFixToComputeGroundInfo,this.myVerticalFixToBeOnCeiling=e.myVerticalFixToBeOnCeiling,this.myVerticalFixToComputeCeilingInfo=e.myVerticalFixToComputeCeilingInfo,this.myGroundIsBaseInsideCollisionCheckEnabled=e.myGroundIsBaseInsideCollisionCheckEnabled,this.myCeilingIsBaseInsideCollisionCheckEnabled=e.myCeilingIsBaseInsideCollisionCheckEnabled,this.myIsOnGroundIfInsideHit=e.myIsOnGroundIfInsideHit,this.myIsOnCeilingIfInsideHit=e.myIsOnCeilingIfInsideHit,this.myIsOnGroundMaxSurfaceAngle=e.myIsOnGroundMaxSurfaceAngle,this.myIsOnCeilingMaxSurfaceAngle=e.myIsOnCeilingMaxSurfaceAngle,this.myFindGroundDistanceMaxOutsideDistance=e.myFindGroundDistanceMaxOutsideDistance,this.myFindGroundDistanceMaxInsideDistance=e.myFindGroundDistanceMaxInsideDistance,this.myFindCeilingDistanceMaxOutsideDistance=e.myFindCeilingDistanceMaxOutsideDistance,this.myFindCeilingDistanceMaxInsideDistance=e.myFindCeilingDistanceMaxInsideDistance,this.myAllowGroundSteepFix=e.myAllowGroundSteepFix,this.myAllowCeilingSteepFix=e.myAllowCeilingSteepFix,this.myMustStayOnGround=e.myMustStayOnGround,this.myMustStayOnCeiling=e.myMustStayOnCeiling,this.myMustStayOnValidGroundAngleDownhill=e.myMustStayOnValidGroundAngleDownhill,this.myMustStayOnValidCeilingAngleDownhill=e.myMustStayOnValidCeilingAngleDownhill,this.myRegatherGroundInfoOnSurfaceCheckFail=e.myRegatherGroundInfoOnSurfaceCheckFail,this.myRegatherCeilingInfoOnSurfaceCheckFail=e.myRegatherCeilingInfoOnSurfaceCheckFail,this.myMustStayBelowGroundAngleDownhill=e.myMustStayBelowGroundAngleDownhill,this.myMustStayBelowCeilingAngleDownhill=e.myMustStayBelowCeilingAngleDownhill,this.myMustStayBelowIgnorableGroundAngleDownhill=e.myMustStayBelowIgnorableGroundAngleDownhill,this.myMustStayBelowIgnorableCeilingAngleDownhill=e.myMustStayBelowIgnorableCeilingAngleDownhill,this.myMovementMustStayOnGroundHitAngle=e.myMovementMustStayOnGroundHitAngle,this.myMovementMustStayOnCeilingHitAngle=e.myMovementMustStayOnCeilingHitAngle,this.myTeleportMustBeOnIgnorableGroundAngle=e.myTeleportMustBeOnIgnorableGroundAngle,this.myCheckTransformMustBeOnIgnorableGroundAngle=e.myCheckTransformMustBeOnIgnorableGroundAngle,this.myTeleportMustBeOnIgnorableCeilingAngle=e.myTeleportMustBeOnIgnorableCeilingAngle,this.myCheckTransformMustBeOnIgnorableCeilingAngle=e.myCheckTransformMustBeOnIgnorableCeilingAngle,this.myTeleportMustBeOnGroundAngle=e.myTeleportMustBeOnGroundAngle,this.myCheckTransformMustBeOnGroundAngle=e.myCheckTransformMustBeOnGroundAngle,this.myTeleportMustBeOnCeilingAngle=e.myTeleportMustBeOnCeilingAngle,this.myCheckTransformMustBeOnCeilingAngle=e.myCheckTransformMustBeOnCeilingAngle,this.myTeleportMustBeOnGround=e.myTeleportMustBeOnGround,this.myCheckTransformMustBeOnGround=e.myCheckTransformMustBeOnGround,this.myTeleportMustBeOnCeiling=e.myTeleportMustBeOnCeiling,this.myCheckTransformMustBeOnCeiling=e.myCheckTransformMustBeOnCeiling,this.mySlidingEnabled=e.mySlidingEnabled,this.mySlidingHorizontalMovementCheckBetterNormal=e.mySlidingHorizontalMovementCheckBetterNormal,this.mySlidingMaxAttempts=e.mySlidingMaxAttempts,this.mySlidingCheckBothDirections=e.mySlidingCheckBothDirections,this.mySlidingFlickeringPreventionType=e.mySlidingFlickeringPreventionType,this.mySlidingFlickeringPreventionCheckOnlyIfAlreadySliding=e.mySlidingFlickeringPreventionCheckOnlyIfAlreadySliding,this.mySlidingFlickerPreventionCheckAnywayCounter=e.mySlidingFlickerPreventionCheckAnywayCounter,this.mySlidingAdjustSign90Degrees=e.mySlidingAdjustSign90Degrees,this.myHorizontalBlockLayerFlags.copy(e.myHorizontalBlockLayerFlags),this.myHorizontalObjectsToIgnore.pp_copy(e.myHorizontalObjectsToIgnore),this.myVerticalBlockLayerFlags.copy(e.myVerticalBlockLayerFlags),this.myVerticalObjectsToIgnore.pp_copy(e.myVerticalObjectsToIgnore),this.myExtraMovementCheckCallback=e.myExtraMovementCheckCallback,this.myExtraTeleportCheckCallback=e.myExtraTeleportCheckCallback,this.myExtraCheckTransformCheckCallback=e.myExtraCheckTransformCheckCallback,this.myDebugEnabled=e.myDebugEnabled,this.myDebugHorizontalMovementEnabled=e.myDebugHorizontalMovementEnabled,this.myDebugHorizontalPositionEnabled=e.myDebugHorizontalPositionEnabled,this.myDebugVerticalMovementEnabled=e.myDebugVerticalMovementEnabled,this.myDebugVerticalPositionEnabled=e.myDebugVerticalPositionEnabled,this.myDebugSlidingEnabled=e.myDebugSlidingEnabled,this.myDebugGroundInfoEnabled=e.myDebugGroundInfoEnabled,this.myDebugCeilingInfoEnabled=e.myDebugCeilingInfoEnabled,this.myDebugRuntimeParamsEnabled=e.myDebugRuntimeParamsEnabled,this.myDebugMovementEnabled=e.myDebugMovementEnabled}},_e=class{constructor(){this.myOriginalPosition=c(),this.myNewPosition=c(),this.myOriginalHeight=0,this.myOriginalForward=c(),this.myOriginalUp=c(),this.myOffsetUp=c(),this.myOriginalMovement=c(),this.myFixedMovement=c(),this.myLastValidOriginalHorizontalMovement=c(),this.myLastValidOriginalVerticalMovement=c(),this.myLastValidSurfaceAdjustedHorizontalMovement=c(),this.myLastValidSurfaceAdjustedVerticalMovement=c(),this.myLastValidEndHorizontalMovement=c(),this.myLastValidEndVerticalMovement=c(),this.myIsOnGround=!1,this.myGroundAngle=0,this.myGroundPerceivedAngle=0,this.myGroundNormal=c(),this.myGroundHitMaxAngle=0,this.myGroundHitMaxNormal=c(),this.myGroundDistance=null,this.myGroundIsBaseInsideCollision=!1,this.myIsOnCeiling=!1,this.myCeilingAngle=0,this.myCeilingPerceivedAngle=0,this.myCeilingNormal=c(),this.myCeilingHitMaxAngle=0,this.myCeilingHitMaxNormal=c(),this.myCeilingDistance=null,this.myCeilingIsBaseInsideCollision=!1,this.myHorizontalMovementCanceled=!1,this.myIsCollidingHorizontally=!1,this.myHorizontalCollisionHit=new mt,this.myVerticalMovementCanceled=!1,this.myIsCollidingVertically=!1,this.myVerticalCollisionHit=new mt,this.myHasSnappedOnGround=!1,this.myHasSnappedOnCeiling=!1,this.myHasPoppedOutGround=!1,this.myHasPoppedOutCeiling=!1,this.myHasReducedVerticalMovement=!1,this.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleDownhill=!1,this.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleUphill=!1,this.myVerticalMovementHasAdjustedHorizontalMovementOverGroundAngleDownhill=!1,this.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleDownhill=!1,this.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleUphill=!1,this.myVerticalMovementHasAdjustedHorizontalMovementOverCeilingAngleDownhill=!1,this.myIsSliding=!1,this.myIsSlidingIntoOppositeDirection=!1,this.myIsSlidingFlickerPrevented=!1,this.mySlidingFlickerPreventionCheckAnywayCounter=0,this.mySlidingMovementAngle=0,this.mySlidingCollisionAngle=0,this.mySlidingCollisionHit=new mt,this.mySlidingWallNormal=new c,this.mySliding90DegreesSign=0,this.mySlidingRecompute90DegreesSign=!0,this.myLastValidIsSliding=!1,this.mySlidingPreviousHorizontalMovement=c(),this.myOriginalTeleportPosition=c(),this.myFixedTeleportPosition=c(),this.myOriginalPositionCheckPosition=c(),this.myFixedPositionCheckPosition=c(),this.myTeleportCanceled=!1,this.myIsPositionOk=!1,this.myIsTeleport=!1,this.myIsMove=!1,this.myIsPositionCheck=!1,this.myIsPositionCheckAllowAdjustments=!1,this.mySplitMovementSteps=0,this.mySplitMovementStepsPerformed=0,this.mySplitMovementStop=!1,this.mySplitMovementMovementChecked=c(),this.myRealIsOnGround=!1,this.myRealIsOnCeiling=!1}reset(){this.myOriginalPosition.vec3_zero(),this.myNewPosition.vec3_zero(),this.myOriginalHeight=0,this.myOriginalForward.vec3_zero(),this.myOriginalUp.vec3_zero(),this.myOffsetUp.vec3_zero(),this.myOriginalMovement.vec3_zero(),this.myFixedMovement.vec3_zero(),this.myLastValidOriginalHorizontalMovement.vec3_zero(),this.myLastValidOriginalVerticalMovement.vec3_zero(),this.myLastValidSurfaceAdjustedHorizontalMovement.vec3_zero(),this.myLastValidSurfaceAdjustedVerticalMovement.vec3_zero(),this.myLastValidEndHorizontalMovement.vec3_zero(),this.myLastValidEndVerticalMovement.vec3_zero(),this.myIsOnGround=!1,this.myGroundAngle=0,this.myGroundPerceivedAngle=0,this.myGroundNormal.vec3_zero(),this.myGroundHitMaxAngle=0,this.myGroundHitMaxNormal.vec3_zero(),this.myGroundDistance=null,this.myGroundIsBaseInsideCollision=!1,this.myIsOnCeiling=!1,this.myCeilingAngle=0,this.myCeilingPerceivedAngle=0,this.myCeilingNormal.vec3_zero(),this.myCeilingHitMaxAngle=0,this.myCeilingHitMaxNormal.vec3_zero(),this.myCeilingDistance=null,this.myCeilingIsBaseInsideCollision=!1,this.myHorizontalMovementCanceled=!1,this.myIsCollidingHorizontally=!1,this.myHorizontalCollisionHit.reset(),this.myVerticalMovementCanceled=!1,this.myIsCollidingVertically=!1,this.myVerticalCollisionHit.reset(),this.myHasSnappedOnGround=!1,this.myHasSnappedOnCeiling=!1,this.myHasPoppedOutGround=!1,this.myHasPoppedOutCeiling=!1,this.myHasReducedVerticalMovement=!1,this.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleDownhill=!1,this.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleUphill=!1,this.myVerticalMovementHasAdjustedHorizontalMovementOverGroundAngleDownhill=!1,this.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleDownhill=!1,this.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleUphill=!1,this.myVerticalMovementHasAdjustedHorizontalMovementOverCeilingAngleDownhill=!1,this.myIsSliding=!1,this.myIsSlidingIntoOppositeDirection=!1,this.myIsSlidingFlickerPrevented=!1,this.mySlidingFlickerPreventionCheckAnywayCounter=0,this.mySlidingMovementAngle=0,this.mySlidingCollisionAngle=0,this.mySlidingCollisionHit.reset(),this.mySliding90DegreesSign=0,this.mySlidingRecompute90DegreesSign=!0,this.myLastValidIsSliding=!1,this.mySlidingPreviousHorizontalMovement.vec3_zero(),this.mySlidingWallNormal.vec3_zero(),this.myOriginalTeleportPosition.vec3_zero(),this.myFixedTeleportPosition.vec3_zero(),this.myOriginalPositionCheckPosition.vec3_zero(),this.myFixedPositionCheckPosition.vec3_zero(),this.myTeleportCanceled=!1,this.myIsPositionOk=!1,this.myIsTeleport=!1,this.myIsMove=!1,this.myIsPositionCheck=!1,this.myIsPositionCheckAllowAdjustments=!1,this.mySplitMovementSteps=0,this.mySplitMovementStepsPerformed=0,this.mySplitMovementStop=!1,this.mySplitMovementMovementChecked.vec3_zero(),this.myRealIsOnGround=!1,this.myRealIsOnCeiling=!1}copy(e){this.myOriginalPosition.vec3_copy(e.myOriginalPosition),this.myNewPosition.vec3_copy(e.myNewPosition),this.myOriginalHeight=e.myOriginalHeight,this.myOriginalForward.vec3_copy(e.myOriginalForward),this.myOriginalUp.vec3_copy(e.myOriginalUp),this.myOffsetUp.vec3_copy(e.myOffsetUp),this.myOriginalMovement.vec3_copy(e.myOriginalMovement),this.myFixedMovement.vec3_copy(e.myFixedMovement),this.myLastValidOriginalHorizontalMovement.vec3_copy(e.myLastValidOriginalHorizontalMovement),this.myLastValidOriginalVerticalMovement.vec3_copy(e.myLastValidOriginalVerticalMovement),this.myLastValidSurfaceAdjustedHorizontalMovement.vec3_copy(e.myLastValidSurfaceAdjustedHorizontalMovement),this.myLastValidSurfaceAdjustedVerticalMovement.vec3_copy(e.myLastValidSurfaceAdjustedVerticalMovement),this.myLastValidEndHorizontalMovement.vec3_copy(e.myLastValidEndHorizontalMovement),this.myLastValidEndVerticalMovement.vec3_copy(e.myLastValidEndVerticalMovement),this.myIsOnGround=e.myIsOnGround,this.myGroundAngle=e.myGroundAngle,this.myGroundPerceivedAngle=e.myGroundPerceivedAngle,this.myGroundNormal.vec3_copy(e.myGroundNormal),this.myGroundHitMaxAngle=e.myGroundHitMaxAngle,this.myGroundHitMaxNormal.vec3_copy(e.myGroundHitMaxNormal),this.myGroundDistance=e.myGroundDistance,this.myGroundIsBaseInsideCollision=e.myGroundIsBaseInsideCollision,this.myIsOnCeiling=e.myIsOnCeiling,this.myCeilingAngle=e.myCeilingAngle,this.myCeilingPerceivedAngle=e.myCeilingPerceivedAngle,this.myCeilingNormal.vec3_copy(e.myCeilingNormal),this.myCeilingHitMaxAngle=e.myCeilingHitMaxAngle,this.myCeilingHitMaxNormal.vec3_copy(e.myCeilingHitMaxNormal),this.myCeilingDistance=e.myCeilingDistance,this.myCeilingIsBaseInsideCollision=e.myCeilingIsBaseInsideCollision,this.myHorizontalMovementCanceled=e.myHorizontalMovementCanceled,this.myIsCollidingHorizontally=e.myIsCollidingHorizontally,this.myHorizontalCollisionHit.copy(e.myHorizontalCollisionHit),this.myVerticalMovementCanceled=e.myVerticalMovementCanceled,this.myIsCollidingVertically=e.myIsCollidingVertically,this.myVerticalCollisionHit.copy(e.myVerticalCollisionHit),this.myHasSnappedOnGround=e.myHasSnappedOnGround,this.myHasSnappedOnCeiling=e.myHasSnappedOnCeiling,this.myHasPoppedOutGround=e.myHasPoppedOutGround,this.myHasPoppedOutCeiling=e.myHasPoppedOutCeiling,this.myHasReducedVerticalMovement=e.myHasReducedVerticalMovement,this.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleDownhill=e.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleDownhill,this.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleUphill=e.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleUphill,this.myVerticalMovementHasAdjustedHorizontalMovementOverGroundAngleDownhill=e.myVerticalMovementHasAdjustedHorizontalMovementOverGroundAngleDownhill,this.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleDownhill=e.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleDownhill,this.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleUphill=e.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleUphill,this.myVerticalMovementHasAdjustedHorizontalMovementOverCeilingAngleDownhill=e.myVerticalMovementHasAdjustedHorizontalMovementOverCeilingAngleDownhill,this.myIsSliding=e.myIsSliding,this.myIsSlidingIntoOppositeDirection=e.myIsSlidingIntoOppositeDirection,this.myIsSlidingFlickerPrevented=e.myIsSlidingFlickerPrevented,this.mySlidingFlickerPreventionCheckAnywayCounter=e.mySlidingFlickerPreventionCheckAnywayCounter,this.mySlidingMovementAngle=e.mySlidingMovementAngle,this.mySlidingCollisionAngle=e.mySlidingCollisionAngle,this.mySlidingCollisionHit.copy(e.mySlidingCollisionHit),this.mySliding90DegreesSign=e.mySliding90DegreesSign,this.mySlidingRecompute90DegreesSign=e.mySlidingRecompute90DegreesSign,this.myLastValidIsSliding=e.myLastValidIsSliding,this.mySlidingPreviousHorizontalMovement.vec3_copy(e.mySlidingPreviousHorizontalMovement),this.mySlidingWallNormal.vec3_copy(e.mySlidingWallNormal),this.myOriginalTeleportPosition.vec3_copy(e.myOriginalTeleportPosition),this.myFixedTeleportPosition.vec3_copy(e.myFixedTeleportPosition),this.myTeleportCanceled=e.myTeleportCanceled,this.myIsPositionOk=e.myIsPositionOk,this.myOriginalPositionCheckPosition.vec3_copy(e.myOriginalPositionCheckPosition),this.myFixedPositionCheckPosition.vec3_copy(e.myFixedPositionCheckPosition),this.myIsTeleport=e.myIsTeleport,this.myIsMove=e.myIsMove,this.myIsPositionCheck=e.myIsPositionCheck,this.myIsPositionCheckAllowAdjustments=e.myIsPositionCheckAllowAdjustments,this.mySplitMovementSteps=e.mySplitMovementSteps,this.mySplitMovementStepsPerformed=e.mySplitMovementStepsPerformed,this.mySplitMovementStop=e.mySplitMovementStop,this.mySplitMovementMovementChecked.vec3_copy(e.mySplitMovementMovementChecked),this.myRealIsOnGround=e.myRealIsOnGround,this.myRealIsOnCeiling=e.myRealIsOnCeiling}};function LC(i,e=new st){return e.copy(i),e.myHalfConeAngle=180,e.myHalfConeSliceAmount=Math.round(e.myHalfConeAngle/i.myHalfConeAngle*i.myHalfConeSliceAmount),e.myCheckHorizontalFixedForwardEnabled=!0,e.myCheckHorizontalFixedForward=c(0,0,1),e}var Is={generate360TeleportParamsFromMovementParams:LC},G=class{constructor(e=r.getMainEngine()){this._myEngine=e,this._myRaycastParams=new ct(r.getPhysics(this._myEngine)),this._myRaycastResult=new Fe,this._myFixRaycastResult=new Fe,this._myBackupRaycastHit=new mt,this._myPrevCollisionRuntimeParams=new _e,this._mySlidingCollisionRuntimeParams=new _e,this._myCheckBetterSlidingNormalCollisionRuntimeParams=new _e,this._myInternalSlidingCollisionRuntimeParams=new _e,this._mySlidingFlickeringFixCollisionRuntimeParams=new _e,this._mySlidingFlickeringFixSlidingCollisionRuntimeParams=new _e,this._mySlidingOppositeDirectionCollisionRuntimeParams=new _e,this._mySlidingOnVerticalCheckCollisionRuntimeParams=new _e,this._myDebugEnabled=!1,this._myTotalRaycasts=0,this._myTotalRaycastsMax=0}move(e,t,n,o){this._move(e,t,n,o)}teleport(e,t,n,o){this._teleport(e,t,n,o)}positionCheck(e,t,n,o){this._positionCheck(e,t,n,o)}updateSurfaceInfo(e,t,n){this._updateSurfaceInfo(e,t,n)}_debugMovement(e,t,n,o,s){let a=e.vec3_removeComponentAlongAxis(o),l=t.vec3_removeComponentAlongAxis(o),u=t.vec3_componentAlongAxis(o),_=n.vec3_add(o.vec3_scale(s.myDistanceFromFeetToIgnore+.001));a.vec3_isZero()||(a.vec3_normalize(a),r.getDebugVisualManager(this._myEngine).drawArrow(0,_,a,.2,F(.5,.5,1,1))),l.vec3_isZero()||(l.vec3_normalize(l),r.getDebugVisualManager(this._myEngine).drawArrow(0,_,l,.2,F(0,0,1,1))),u.vec3_isZero()||(u.vec3_normalize(u),r.getDebugVisualManager(this._myEngine).drawArrow(0,n,u,.2,F(0,0,1,1)))}_debugRuntimeParams(e){e.myHorizontalCollisionHit.isValid()&&r.getDebugVisualManager(this._myEngine).drawArrow(0,e.myHorizontalCollisionHit.myPosition,e.myHorizontalCollisionHit.myNormal,.2,F(1,0,0,1)),e.mySlidingCollisionHit.isValid()&&r.getDebugVisualManager(this._myEngine).drawArrow(0,e.mySlidingCollisionHit.myPosition,e.mySlidingCollisionHit.myNormal,.2,F(1,0,0,1)),e.myVerticalCollisionHit.isValid()&&r.getDebugVisualManager(this._myEngine).drawArrow(0,e.myVerticalCollisionHit.myPosition,e.myVerticalCollisionHit.myNormal,.2,F(1,0,0,1))}_raycastAndDebug(e,t,n,o,s,a,l){}};G.prototype._raycastAndDebug=function(){let i=new Fe;return function(t,n,o,s,a,l,u){this._myRaycastParams.myOrigin.vec3_copy(t),this._myRaycastParams.myDirection.vec3_copy(n),this._myRaycastParams.myDistance=o,a?(this._myRaycastParams.myBlockLayerFlags.copy(l.myHorizontalBlockLayerFlags),this._myRaycastParams.myObjectsToIgnore=l.myHorizontalObjectsToIgnore):(this._myRaycastParams.myBlockLayerFlags.copy(l.myVerticalBlockLayerFlags),this._myRaycastParams.myObjectsToIgnore=l.myVerticalObjectsToIgnore),this._myRaycastParams.myIgnoreHitsInsideCollision=s;let _=null;return!1&&r.isDebugEnabled(this._myEngine)?((!1||!this._myRaycastResult.isColliding())&&(_=De.raycast(this._myRaycastParams,i)),!this._myRaycastResult.isColliding()&&i.isColliding()&&this._myRaycastResult.copy(i),_=this._myRaycastResult):_=De.raycast(this._myRaycastParams,this._myRaycastResult),this._myTotalRaycasts++,this._myDebugEnabled&&r.isDebugEnabled(this._myEngine)&&r.getDebugVisualManager(this._myEngine).drawRaycast(0,_),_}}();G.prototype._move=function(){let i=c(),e=c(),t=c(),n=N(),o=N(),s=c(),a=c(),l=c(),u=c(),_=c(),m=c(),h=c(),d=c(),g=new _e,P=c(),C=c();return function(S,M,D,v){n.quat2_setPositionRotationQuat(D.myPositionOffsetLocal,D.myRotationOffsetLocalQuat),o=n.quat2_toWorld(M,o),M.vec_equals(o,1e-5)&&o.quat2_copy(M),i=o.quat2_getUp(i),e=o.quat2_getForward(e),t=o.quat2_getPosition(t);let b=D.myHeight;b=b-1e-5,b<1e-5&&(b=0),s=S.vec3_removeComponentAlongAxis(i,s),a=S.vec3_componentAlongAxis(i,a);let x=1;if(l.vec3_copy(S),!S.vec3_isZero(1e-5)&&D.mySplitMovementEnabled){let w=S.vec3_length()/D.mySplitMovementMaxSteps;if(!D.mySplitMovementStepEqualLength||w<D.mySplitMovementStepEqualLengthMinLength){let Q=D.mySplitMovementStepEqualLength?D.mySplitMovementStepEqualLengthMinLength:D.mySplitMovementMaxLength;x=Math.ceil(S.vec3_length()/Q),x>1&&(l=l.vec3_normalize(l).vec3_scale(Q,l),x=D.mySplitMovementMaxStepsEnabled?Math.min(x,D.mySplitMovementMaxSteps):x),x=Math.max(1,x),x==1&&l.vec3_copy(S)}else x=D.mySplitMovementMaxSteps,x>1&&(l=l.vec3_normalize(l).vec3_scale(w,l))}m.vec3_zero(),_.vec3_zero(),g.copy(v),P.vec3_copy(m),C.vec3_copy(_);let B=0,H=!1;for(let w=0;w<x;w++){if(x==1||w!=x-1?u.vec3_copy(l):u=S.vec3_sub(_,u),h=t.vec3_add(m,h),d.vec3_zero(),d=this._moveStep(u,h,i,e,b,!0,D,v,d),m.vec3_add(d,m),_=_.vec3_add(l,_),B=w+1,v.myHorizontalMovementCanceled&&v.myVerticalMovementCanceled||v.myHorizontalMovementCanceled&&D.mySplitMovementStopWhenHorizontalMovementCanceled||v.myVerticalMovementCanceled&&D.mySplitMovementStopWhenVerticalMovementCanceled||D.mySplitMovementStopCallback!=null&&D.mySplitMovementStopCallback(v)){D.mySplitMovementStopReturnPrevious&&(v.copy(g),m.vec3_copy(P),_.vec3_copy(C),B-=1),H=!0;break}g.copy(v),P.vec3_copy(m),C.vec3_copy(_)}v.mySplitMovementSteps=x,v.mySplitMovementStepsPerformed=B,v.mySplitMovementStop=H,v.mySplitMovementMovementChecked.vec3_copy(_),v.myOriginalUp=M.quat2_getUp(v.myOriginalUp),v.myOriginalForward=M.quat2_getForward(v.myOriginalForward),v.myOriginalPosition=M.quat2_getPosition(v.myOriginalPosition),v.myOffsetUp.vec3_copy(i),v.myOriginalHeight=D.myHeight,v.myOriginalMovement.vec3_copy(S),v.myFixedMovement.vec3_copy(m),v.myNewPosition=v.myOriginalPosition.vec3_add(v.myFixedMovement,v.myNewPosition),v.myIsMove=!0}}();G.prototype._moveStep=function(){let i=c(),e=c(),t=c(),n=c(),o=c(),s=c(),a=c(),l=c(),u=c(),_=c(),m=c(),h=c(),d=c(0,0,1),g=c(1,0,0);return function(C,f,S,M,D,v,b,x,B){i=C.vec3_removeComponentAlongAxis(S,i),i.vec3_isZero(1e-6)&&i.vec3_zero(),e=C.vec3_componentAlongAxis(S,e),e.vec3_isZero(1e-6)&&e.vec3_zero(),i.vec3_isZero(),this._myPrevCollisionRuntimeParams.copy(x),x.reset(),m=this._adjustHorizontalMovementWithSurface(i,e,S,b,x,this._myPrevCollisionRuntimeParams,m),m.vec3_isZero(1e-5)&&m.vec3_zero(),this._syncCollisionRuntimeParamsWithPrevious(m,e,S,b,x,this._myPrevCollisionRuntimeParams),s.vec3_copy(b.myCheckHorizontalFixedForward),b.myCheckHorizontalFixedForwardEnabled?(b.myCheckHorizontalFixedForward.vec3_isOnAxis(S)&&(d.vec3_isOnAxis(S)?s.vec3_copy(g):s.vec3_copy(d)),s=s.vec3_removeComponentAlongAxis(S,s),s=s.vec3_normalize(s),s.vec_equals(b.myCheckHorizontalFixedForward,1e-5)&&s.vec3_copy(b.myCheckHorizontalFixedForward)):m.vec3_isZero()?i.vec3_isZero()?s.vec3_copy(M):s=i.vec3_normalize(s):s=m.vec3_normalize(s),t.vec3_zero(),m.vec3_isZero()||(t=this._horizontalCheck(m,f,D,S,s,v,b,x,this._myPrevCollisionRuntimeParams,!1,t),b.mySlidingEnabled&&x.myIsCollidingHorizontally&&this._isSlidingNormalValid(m,S,x)&&(t=this._horizontalSlide(m,f,D,S,s,v,b,x,this._myPrevCollisionRuntimeParams,t))),t.vec3_isZero(1e-6)&&t.vec3_zero(),!m.vec3_isZero()&&t.vec3_isZero()&&(x.myHorizontalMovementCanceled=!0);{a.vec3_copy(b.myCheckVerticalFixedForward),b.myCheckVerticalFixedForwardEnabled?(b.myCheckVerticalFixedForward.vec3_isOnAxis(S)&&(d.vec3_isOnAxis(S)?a.vec3_copy(g):a.vec3_copy(d)),a=a.vec3_removeComponentAlongAxis(S,a),a=a.vec3_normalize(a),a.vec_equals(b.myCheckVerticalFixedForward,1e-5)&&a.vec3_copy(b.myCheckVerticalFixedForward)):t.vec3_isZero()?m.vec3_isZero()?i.vec3_isZero()?a.vec3_copy(M):a=i.vec3_normalize(a):a=m.vec3_normalize(a):a=t.vec3_normalize(a),_=this._adjustVerticalMovementWithSurface(t,e,S,b,x,this._myPrevCollisionRuntimeParams,_),u=f.vec3_add(t,u);let w=Math.pp_sign(e.vec3_lengthSigned(S),0);n.vec3_zero(),n=this._verticalCheck(_,w,u,D,S,a,b,x,n),n.vec3_isZero(1e-6)&&n.vec3_zero()}B.vec3_zero(),x.myIsCollidingVertically?(x.myHorizontalMovementCanceled=!0,x.myVerticalMovementCanceled=!0,t.vec3_zero(),n.vec3_zero(),b.myCheckVerticalFixedForwardEnabled||(m.vec3_isZero()?i.vec3_isZero()?a.vec3_copy(M):a=i.vec3_normalize(a):a=m.vec3_normalize(a))):B=t.vec3_add(n,B),u=f.vec3_add(B,u),l.vec3_copy(M),t.vec3_isZero()?m.vec3_isZero()?i.vec3_isZero()||(l=i.vec3_normalize(l)):l=m.vec3_normalize(l):l=t.vec3_normalize(l),b.myComputeGroundInfoEnabled&&this._gatherSurfaceInfo(u,D,S,l,a,!0,b,x),b.myComputeCeilingInfoEnabled&&this._gatherSurfaceInfo(u,D,S,l,a,!1,b,x),!m.vec3_isZero()&&!x.myHorizontalMovementCanceled&&(this._postSurfaceCheck(t,n,S,b,x,this._myPrevCollisionRuntimeParams)||(x.myHorizontalMovementCanceled=!0,x.myVerticalMovementCanceled=!0,t.vec3_zero(),n.vec3_zero(),B.vec3_zero(),u=f.vec3_add(B,u),m.vec3_isZero()?i.vec3_isZero()?l.vec3_copy(M):l=i.vec3_normalize(l):l=m.vec3_normalize(l),b.myComputeGroundInfoEnabled&&b.myRegatherGroundInfoOnSurfaceCheckFail?this._gatherSurfaceInfo(u,D,S,l,a,!0,b,x):(x.myIsOnGround=this._myPrevCollisionRuntimeParams.myIsOnGround,x.myGroundAngle=this._myPrevCollisionRuntimeParams.myGroundAngle,x.myGroundPerceivedAngle=this._myPrevCollisionRuntimeParams.myGroundPerceivedAngle,x.myGroundNormal.vec3_copy(this._myPrevCollisionRuntimeParams.myGroundNormal)),b.myComputeCeilingInfoEnabled&&b.myRegatherCeilingInfoOnSurfaceCheckFail?this._gatherSurfaceInfo(u,D,S,l,a,!1,b,x):(x.myIsOnCeiling=this._myPrevCollisionRuntimeParams.myIsOnCeiling,x.myCeilingAngle=this._myPrevCollisionRuntimeParams.myCeilingAngle,x.myCeilingPerceivedAngle=this._myPrevCollisionRuntimeParams.myCeilingPerceivedAngle,x.myCeilingNormal.vec3_copy(this._myPrevCollisionRuntimeParams.myCeilingNormal)))),b.myExtraMovementCheckCallback!=null&&(h.vec3_copy(B),B=b.myExtraMovementCheckCallback(C,h,f,S,M,D,b,this._myPrevCollisionRuntimeParams,x,B),t=B.vec3_removeComponentAlongAxis(S,t),n=B.vec3_componentAlongAxis(S,n)),b.mySlidingAdjustSign90Degrees&&!x.myHorizontalMovementCanceled&&!x.myIsSliding&&!t.vec3_isZero()&&(x.mySlidingRecompute90DegreesSign=!0),i.vec3_isZero()||x.myLastValidOriginalHorizontalMovement.vec3_copy(i),m.vec3_isZero()||x.myLastValidSurfaceAdjustedHorizontalMovement.vec3_copy(m),e.vec3_isZero()||x.myLastValidOriginalVerticalMovement.vec3_copy(e),_.vec3_isZero()||x.myLastValidSurfaceAdjustedVerticalMovement.vec3_copy(_),t.vec3_isZero(1e-6)||(x.myLastValidIsSliding=x.myIsSliding,x.myIsSlidingFlickerPrevented=!1,x.myLastValidEndHorizontalMovement.vec3_copy(t),x.myIsSliding),n.vec3_isZero(1e-6)||x.myLastValidEndVerticalMovement.vec3_copy(n);let H=!1;if(!x.myHorizontalMovementCanceled&&!t.vec3_isZero(1e-6)){o=t.vec3_normalize(o);let w=this._surfaceTooSteep(S,o,b,this._myPrevCollisionRuntimeParams);if(w[0]||w[1]){o=t.vec3_normalize(o);let Q=this._surfaceTooSteep(S,o,b,x);(w[0]&&Q[0]||w[1]&&Q[1]||!v||w[0]&&!b.myAllowGroundSteepFix||w[1]&&!b.myAllowCeilingSteepFix)&&(B.vec3_zero(),x.copy(this._myPrevCollisionRuntimeParams),this._moveStep(C,f,S,M,D,!1,b,x,B),H=!0)}}return H||(b.myDebugEnabled&&b.myDebugMovementEnabled&&r.isDebugEnabled(this._myEngine)&&this._debugMovement(C,B,u,S,b),b.myDebugEnabled&&b.myDebugRuntimeParamsEnabled&&r.isDebugEnabled(this._myEngine)&&this._debugRuntimeParams(x)),B}}();G.prototype._syncCollisionRuntimeParamsWithPrevious=function(){let i=c();return function(t,n,o,s,a,l){if(a.myIsSlidingFlickerPrevented=l.myIsSlidingFlickerPrevented,a.myLastValidOriginalHorizontalMovement.vec3_copy(l.myLastValidOriginalHorizontalMovement),a.myLastValidOriginalVerticalMovement.vec3_copy(l.myLastValidOriginalVerticalMovement),a.myLastValidSurfaceAdjustedHorizontalMovement.vec3_copy(l.myLastValidSurfaceAdjustedHorizontalMovement),a.myLastValidSurfaceAdjustedVerticalMovement.vec3_copy(l.myLastValidSurfaceAdjustedVerticalMovement),a.myLastValidIsSliding=l.myLastValidIsSliding,a.mySliding90DegreesSign=l.mySliding90DegreesSign,a.mySlidingRecompute90DegreesSign=l.mySlidingRecompute90DegreesSign,s.mySlidingAdjustSign90Degrees){let u=.5;if(!l.myLastValidSurfaceAdjustedHorizontalMovement.vec3_isZero()&&!t.vec3_isZero()&&t.vec3_angle(l.myLastValidSurfaceAdjustedHorizontalMovement)>u){if(!l.myLastValidIsSliding){let _=t.vec3_angleSigned(l.myLastValidSurfaceAdjustedHorizontalMovement,o),m=10;Math.abs(_)<180-m&&(a.mySliding90DegreesSign=Math.pp_sign(_))}a.mySlidingRecompute90DegreesSign=!0}}i=l.myFixedMovement.vec3_removeComponentAlongAxis(o,i),i.vec3_isZero(1e-6)?a.mySlidingPreviousHorizontalMovement.vec3_copy(l.mySlidingPreviousHorizontalMovement):a.mySlidingPreviousHorizontalMovement.vec3_copy(i)}}();Object.defineProperty(G.prototype,"_move",{enumerable:!1});Object.defineProperty(G.prototype,"_moveStep",{enumerable:!1});Object.defineProperty(G.prototype,"_syncCollisionRuntimeParamsWithPrevious",{enumerable:!1});G.prototype._teleport=function(){let i=c(),e=c(),t=c(),n=c(),o=N(),s=N(),a=c(),l=c(),u=c(),_=c(),m=c(),h=c(),d=c(),g=c(),P=c(),C=c(),f=c(0,0,1),S=c(1,0,0);return function(D,v,b,x,B=!1){o.quat2_setPositionRotationQuat(b.myPositionOffsetLocal,b.myRotationOffsetLocalQuat),s=o.quat2_toWorld(v,s),v.vec_equals(s,1e-5)&&s.quat2_copy(v),i=s.quat2_getUp(i),e=s.quat2_getForward(e),t=s.quat2_getPosition(t),l.vec3_copy(D),n=v.quat2_getPosition(n),a=n.vec3_sub(t,a),a.vec3_isZero(1e-5)?a.vec3_zero():l=l.vec3_sub(a,l);let H=b.myHeight;if(H=H-1e-5,H<1e-5&&(H=0),this._myPrevCollisionRuntimeParams.copy(x),x.reset(),_.vec3_copy(b.myCheckHorizontalFixedForward),b.myCheckHorizontalFixedForwardEnabled?(b.myCheckHorizontalFixedForward.vec3_isOnAxis(i)&&(f.vec3_isOnAxis(i)?_.vec3_copy(S):_.vec3_copy(f)),_=_.vec3_removeComponentAlongAxis(i,_),_=_.vec3_normalize(_),_.vec_equals(b.myCheckHorizontalFixedForward,1e-5)&&_.vec3_copy(b.myCheckHorizontalFixedForward)):_.vec3_copy(e),d=this._horizontalCheck(u,l,H,i,_,!1,b,x,this._myPrevCollisionRuntimeParams,!1,d),x.myIsCollidingHorizontally)x.myTeleportCanceled=!0;else{P=l.vec3_add(d,P),m.vec3_copy(b.myCheckVerticalFixedForward),b.myCheckVerticalFixedForwardEnabled?(b.myCheckVerticalFixedForward.vec3_isOnAxis(i)&&(f.vec3_isOnAxis(i)?m.vec3_copy(S):m.vec3_copy(f)),m=m.vec3_removeComponentAlongAxis(i,m),m=m.vec3_normalize(m),m.vec_equals(b.myCheckVerticalFixedForward,1e-5)&&m.vec3_copy(b.myCheckVerticalFixedForward)):m.vec3_copy(e);let w=-1;if(g=this._verticalCheck(u,w,P,H,i,m,b,x,g),x.myIsCollidingVertically)x.myTeleportCanceled=!0;else{if(P=P.vec3_add(g,P),h.vec3_copy(e),b.myComputeGroundInfoEnabled&&this._gatherSurfaceInfo(P,H,i,h,m,!0,b,x),b.myComputeCeilingInfoEnabled&&this._gatherSurfaceInfo(P,H,i,h,m,!1,b,x),x.myIsOnGround||(b.myTeleportMustBeOnGround&&!B||b.myCheckTransformMustBeOnGround&&B)&&(x.myTeleportCanceled=!0),x.myIsOnCeiling||(b.myTeleportMustBeOnCeiling&&!B||b.myCheckTransformMustBeOnCeiling&&B)&&(x.myTeleportCanceled=!0),x.myIsOnGround){let Q=null;B?(b.myCheckTransformMustBeOnIgnorableGroundAngle&&(Q=b.myGroundAngleToIgnore),b.myCheckTransformMustBeOnGroundAngle!=null&&(Q=Math.min(Q,b.myCheckTransformMustBeOnGroundAngle))):(b.myTeleportMustBeOnIgnorableGroundAngle&&(Q=b.myGroundAngleToIgnore),b.myTeleportMustBeOnGroundAngle!=null&&(Q=Math.min(Q,b.myTeleportMustBeOnGroundAngle))),Q!=null&&x.myGroundAngle>Q+1e-4&&(x.myTeleportCanceled=!0)}if(x.myIsOnCeiling){let Q=null;B?(b.myCheckTransformMustBeOnIgnorableCeilingAngle&&(Q=b.myCeilingAngleToIgnore),b.myCheckTransformMustBeOnCeilingAngle!=null&&(Q=Math.min(Q,b.myCheckTransformMustBeOnCeilingAngle))):(b.myTeleportMustBeOnIgnorableCeilingAngle&&(Q=b.myCeilingAngleToIgnore),b.myTeleportMustBeOnCeilingAngle!=null&&(Q=Math.min(Q,b.myTeleportMustBeOnCeilingAngle))),Q!=null&&x.myCeilingAngle>Q+1e-4&&(x.myTeleportCanceled=!0)}x.myTeleportCanceled&&(b.myComputeGroundInfoEnabled&&b.myRegatherGroundInfoOnSurfaceCheckFail?this._gatherSurfaceInfo(P,H,i,h,m,!0,b,x):(x.myIsOnGround=this._myPrevCollisionRuntimeParams.myIsOnGround,x.myGroundAngle=this._myPrevCollisionRuntimeParams.myGroundAngle,x.myGroundPerceivedAngle=this._myPrevCollisionRuntimeParams.myGroundPerceivedAngle,x.myGroundNormal.vec3_copy(this._myPrevCollisionRuntimeParams.myGroundNormal)),b.myComputeCeilingInfoEnabled&&b.myRegatherCeilingInfoOnSurfaceCheckFail?this._gatherSurfaceInfo(P,H,i,h,m,!1,b,x):(x.myIsOnCeiling=this._myPrevCollisionRuntimeParams.myIsOnCeiling,x.myCeilingAngle=this._myPrevCollisionRuntimeParams.myCeilingAngle,x.myCeilingPerceivedAngle=this._myPrevCollisionRuntimeParams.myCeilingPerceivedAngle,x.myCeilingNormal.vec3_copy(this._myPrevCollisionRuntimeParams.myCeilingNormal)))}}B?b.myExtraCheckTransformCheckCallback!=null&&(C.vec3_copy(P),P=b.myExtraCheckTransformCheckCallback(C,t,i,e,H,b,this._myPrevCollisionRuntimeParams,x,P)):b.myExtraTeleportCheckCallback!=null&&(C.vec3_copy(P),P=b.myExtraTeleportCheckCallback(l,C,t,i,e,H,b,this._myPrevCollisionRuntimeParams,x,P)),x.myOriginalUp=v.quat2_getUp(x.myOriginalUp),x.myOriginalForward=v.quat2_getForward(x.myOriginalForward),x.myOriginalPosition=v.quat2_getPosition(x.myOriginalPosition),x.myOriginalHeight=b.myHeight,x.myOriginalTeleportPosition.vec3_copy(D),x.myTeleportCanceled?x.myNewPosition.vec3_copy(x.myOriginalPosition):(x.myFixedTeleportPosition.vec3_copy(P),a.vec3_isZero(1e-5)||(x.myFixedTeleportPosition=x.myFixedTeleportPosition.vec3_add(a,x.myFixedTeleportPosition)),x.myNewPosition.vec3_copy(x.myFixedTeleportPosition)),x.myIsTeleport=!0,b.myDebugEnabled&&b.myDebugRuntimeParamsEnabled&&r.isDebugEnabled(this._myEngine)&&this._debugRuntimeParams(x)}}();Object.defineProperty(G.prototype,"_teleport",{enumerable:!1});G.prototype._positionCheck=function(){let i=c();return function(t,n,o,s){i=n.quat2_getPosition(i),this._teleport(i,n,o,s,!0),s.myIsPositionOk=!s.myTeleportCanceled,s.myIsPositionCheck=!0,s.myOriginalPositionCheckPosition.vec3_copy(s.myOriginalTeleportPosition),s.myFixedPositionCheckPosition.vec3_copy(s.myFixedTeleportPosition),s.myIsPositionCheckAllowAdjustments=t,t||(s.myIsPositionOk=s.myIsPositionOk&&s.myOriginalPositionCheckPosition.vec_equals(s.myFixedPositionCheckPosition,1e-5)),s.myOriginalTeleportPosition.vec3_zero(),s.myFixedTeleportPosition.vec3_zero(),s.myTeleportCanceled=!1,s.myIsTeleport=!1}}();Object.defineProperty(G.prototype,"_positionCheck",{enumerable:!1});G.prototype._horizontalCheck=function(){let i=c(),e=c(),t=c(),n=c();return function(s,a,l,u,_,m,h,d,g,P,C){d.myIsCollidingHorizontally=!1,d.myHorizontalCollisionHit.reset(),C.vec3_zero(),n=s.vec3_normalize(n);let f=this._surfaceTooSteep(u,n,h,g);if(s.vec3_isZero(1e-6)||(!f[0]||m&&h.myAllowGroundSteepFix)&&(!f[1]||m&&h.myAllowCeilingSteepFix)){i=a.vec3_add(u.vec3_scale(h.myDistanceFromFeetToIgnore+1e-4,i),i);let S=Math.max(0,l-h.myDistanceFromFeetToIgnore-h.myDistanceFromHeadToIgnore-1e-4*2),M=!0;h.myHorizontalMovementCheckEnabled&&!s.vec3_isZero(1e-6)&&(M=this._horizontalMovementCheck(s,a,l,i,S,u,h,d)),M?h.myHorizontalPositionCheckEnabled?(e=i.vec3_add(s,e),t=a.vec3_add(s,t),this._horizontalPositionCheck(t,l,e,S,u,_,h,d)&&C.vec3_copy(s),C.vec3_isZero(1e-6)&&C.vec3_zero()):C.vec3_copy(s):!P&&h.mySlidingEnabled&&h.mySlidingHorizontalMovementCheckBetterNormal&&this._horizontalCheckBetterSlideNormal(s,a,l,i,S,u,_,h,d)}return C}}();G.prototype._horizontalCheckRaycast=function(){let i=c(),e=c(),t=c();return function(o,s,a,l,u,_,m,h,d,g,P,C=!1,f=!1){let S=o;i=s.vec3_sub(S,i),a!=null&&!i.vec3_isConcordant(a)&&(i.vec3_negate(i),S=s);let M=i.vec3_length();i.vec3_normalize(i);let D=this._raycastAndDebug(S,i,M,u,!0,g,P),v=!0;if(D.isColliding()){let b=C?D.myHits.length:1,x=0;for(let B=0;B<b;B++){let H=D.myHits[B];if((_==null||!_(H,f))&&(m==null||!m(H,f))){v=!1,x=B;break}}if(!v&&x>0)for(let B=0;B<x;B++)D.removeHit(0)}if(!v&&d){let b=D.myHits[0].myPosition;e=h.vec3_copyComponentAlongAxis(b,l,e),t.vec3_copy(b);let x=1e-4;i=i.vec3_componentAlongAxis(l,i),i.vec3_isZero(1e-6)||(i.vec3_normalize(i),i.vec3_scale(x,i),e.vec3_add(i,e),t.vec3_add(i,t)),i=t.vec3_sub(e,i),i.vec3_normalize(i),i.vec3_scale(x,i),t=t.vec3_add(i,t);let B=this._myRaycastResult;this._myRaycastResult=this._myFixRaycastResult,v=this._horizontalCheckRaycast(e,t,null,l,!1,_,m,h,!1,g,P),this._myRaycastResult.isColliding()?this._myFixRaycastResult=B:(v=!1,this._myRaycastResult=B)}return v}}();G.prototype._ignoreSurfaceAngle=function(){let i=(s,a)=>s.pp_equals(a),e=c(),t=c(),n=c(),o=c();return function(a,l,u,_,m,h,d,g,P,C,f){let S=!1,M=null,D=d?P.myHorizontalMovementGroundAngleIgnoreHeight:P.myHorizontalPositionGroundAngleIgnoreHeight,v=d?P.myHorizontalMovementCeilingAngleIgnoreHeight:P.myHorizontalPositionCeilingAngleIgnoreHeight;h&&D!=null?M=Math.pp_clamp(D+2e-4,0,l):!h&&v!=null&&(M=Math.pp_clamp(l-v-2e-4,0,l));let b=null;if(d&&(h&&P.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft!=null?b=P.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft:!h&&P.myHorizontalMovementCeilingAngleIgnoreMaxMovementLeft!=null&&(b=P.myHorizontalMovementCeilingAngleIgnoreMaxMovementLeft)),C.myInsideCollision)f&&(_==null||_.pp_hasEqual(C.myObject,i))&&(S=!0);else{e=u.vec3_normalize(e);let x=C.myNormal.vec3_angle(g);if(h||(x=180-x),h&&P.myGroundAngleToIgnore>0&&x>P.myGroundAngleToIgnore+1e-4){if(P.myGroundAngleToIgnoreWithPerceivedAngle!=null&&x<=P.myGroundAngleToIgnoreWithPerceivedAngle+1e-4){let B=this.computeSurfacePerceivedAngle(C.myNormal,e,g,!0);x=Math.abs(B)}}else if(!h&&P.myCeilingAngleToIgnore>0&&x>P.myCeilingAngleToIgnore+1e-4&&P.myCeilingAngleToIgnoreWithPerceivedAngle!=null&&x<=P.myCeilingAngleToIgnoreWithPerceivedAngle+1e-4){let B=this.computeSurfacePerceivedAngle(C.myNormal,e,g,!1);x=Math.abs(B)}if((h&&P.myGroundAngleToIgnore>0&&x<=P.myGroundAngleToIgnore+1e-4||!h&&P.myCeilingAngleToIgnore>0&&x<=P.myCeilingAngleToIgnore+1e-4)&&(_==null||_.pp_hasEqual(C.myObject,i))){let B=!0,H=!0;if(M!=null){B=!1;let w=a.vec3_valueAlongAxis(g),ue=C.myPosition.vec3_valueAlongAxis(g)-w;(h&&ue<=M||!h&&ue>=M)&&(B=!0)}if(B&&d&&b!=null){let w=u.vec3_length();if(w>b){H=!1;let Q=C.myPosition,ue=Math.min(P.myHalfConeAngle,90);t=Q.vec3_sub(a,t),t.vec3_isToTheRight(e,g)?o=e.vec3_rotateAxis(-ue,g,o):o=e.vec3_rotateAxis(ue,g,o),n=t.vec3_projectOnAxisAlongAxis(e,o,n);let me=n.vec3_length();w-me<=b&&(H=!0)}}B&&H&&(S=!0)}}return S&&m?.pp_pushUnique(C.myObject,i),S}}();Object.defineProperty(G.prototype,"_horizontalCheck",{enumerable:!1});Object.defineProperty(G.prototype,"_horizontalCheckRaycast",{enumerable:!1});Object.defineProperty(G.prototype,"_ignoreSurfaceAngle",{enumerable:!1});G.prototype._horizontalSlide=function(){let i=c();return function(t,n,o,s,a,l,u,_,m,h){if(t.vec3_isZero(1e-5))return h.vec3_zero();if(this._mySlidingCollisionRuntimeParams.copy(_),i.vec3_copy(_.mySlidingPreviousHorizontalMovement),h=this._internalHorizontalSlide(t,n,o,s,a,i,l,u,this._mySlidingCollisionRuntimeParams,m,!1,h),u.mySlidingCheckBothDirections&&this._horizontalSlideCheckOpposite(t,n,o,s,a,i,this._myPrevCollisionRuntimeParams.myIsSliding,l,u,_,this._mySlidingCollisionRuntimeParams,m,h),this._mySlidingCollisionRuntimeParams.myIsSliding&&u.mySlidingFlickeringPreventionType>0){let d=this._horizontalSlideFlickerCheck(t,h,n,o,s,a,l,u,this._mySlidingCollisionRuntimeParams,m);this._mySlidingCollisionRuntimeParams.myIsSliding=!d}if(this._mySlidingCollisionRuntimeParams.myIsSliding){let d=_.myIsSlidingFlickerPrevented;_.copy(this._mySlidingCollisionRuntimeParams),_.myIsSlidingFlickerPrevented=d||this._mySlidingCollisionRuntimeParams.myIsSlidingFlickerPrevented}else _.myIsSlidingFlickerPrevented=_.myIsSlidingFlickerPrevented||this._mySlidingCollisionRuntimeParams.myIsSlidingFlickerPrevented,h.vec3_zero();return h}}();G.prototype._horizontalSlideCheckOpposite=function(){let i=c(),e=c();return function(n,o,s,a,l,u,_,m,h,d,g,P,C){i=d.myHorizontalCollisionHit.myNormal.vec3_removeComponentAlongAxis(a,i),i.vec3_normalize(i);let f=20;if(!(i.vec3_angle(n)>180-f)&&!(_&&g.myIsSliding&&C.vec3_isConcordant(u))&&(this._mySlidingOppositeDirectionCollisionRuntimeParams.copy(d),e=this._internalHorizontalSlide(n,o,s,a,l,u,m,h,this._mySlidingOppositeDirectionCollisionRuntimeParams,P,!0,e),this._mySlidingOppositeDirectionCollisionRuntimeParams.myIsSliding)){let S=!1;if(g.myIsSliding){if(n.vec3_angle(e)<n.vec3_angle(C)-1e-4)S=!0;else if(Math.abs(n.vec3_angle(e)-n.vec3_angle(C))<=1e-4&&u.vec3_angle(e)<u.vec3_angle(C)-1e-4){let M=5;i.vec3_angle(n)<90+M&&(S=!0)}}else{let M=.001;n.vec3_isConcordant(e)&&n.vec3_angle(e)<90-M&&(S=!0)}S&&(C.vec3_copy(e),g.copy(this._mySlidingOppositeDirectionCollisionRuntimeParams))}}}();G.prototype._horizontalSlideFlickerCheck=function(){let i=c(),e=c(),t=c(),n=c();return function(s,a,l,u,_,m,h,d,g,P){let C=!1;i.vec3_copy(g.mySlidingPreviousHorizontalMovement);let f=this._myPrevCollisionRuntimeParams.myIsSlidingFlickerPrevented||i.vec3_isZero(1e-5);if(!f&&(this._myPrevCollisionRuntimeParams.myIsSliding||!d.mySlidingFlickeringPreventionCheckOnlyIfAlreadySliding)){let S=90,M=85;switch(d.mySlidingFlickeringPreventionType){case 1:f=i.vec3_signTo(s,_,0)!=a.vec3_signTo(s,_,0);break;case 2:f=d.mySlidingCheckBothDirections&&g.myIsSlidingIntoOppositeDirection,f=f||Math.abs(g.mySlidingCollisionAngle)>S+1e-5;break;case 3:f=d.mySlidingCheckBothDirections&&g.myIsSlidingIntoOppositeDirection,f=f||Math.abs(g.mySlidingCollisionAngle)>S+1e-5,f=f||Math.abs(Math.abs(g.mySlidingCollisionAngle)-S)<1e-5&&Math.abs(g.mySlidingMovementAngle)>M+1e-5;break;case 4:f=!0;break}}if(f||this._myPrevCollisionRuntimeParams.mySlidingFlickerPreventionCheckAnywayCounter>0)if(f?g.mySlidingFlickerPreventionCheckAnywayCounter=d.mySlidingFlickerPreventionCheckAnywayCounter:g.mySlidingFlickerPreventionCheckAnywayCounter=Math.max(0,this._myPrevCollisionRuntimeParams.mySlidingFlickerPreventionCheckAnywayCounter-1),(d.mySlidingFlickeringPreventionType!=1||g.myIsSlidingFlickerPrevented||this._myPrevCollisionRuntimeParams.mySlidingFlickerPreventionCheckAnywayCounter>0)&&this._myPrevCollisionRuntimeParams.myIsSliding&&i.vec3_signTo(s,_,0)!=a.vec3_signTo(s,_,0))C=!0,g.myIsSlidingFlickerPrevented=!0;else{this._mySlidingFlickeringFixCollisionRuntimeParams.reset(),this._mySlidingFlickeringFixCollisionRuntimeParams.mySliding90DegreesSign=g.mySliding90DegreesSign,this._mySlidingFlickeringFixCollisionRuntimeParams.mySlidingRecompute90DegreesSign=!1,e=l.vec3_add(a,e);let S=d.myDebugEnabled;d.myDebugEnabled=d.myDebugEnabled&&d.myDebugSlidingEnabled,t.vec3_zero(),t=this._horizontalCheck(s,e,u,_,m,h,d,this._mySlidingFlickeringFixCollisionRuntimeParams,P,!1,t),d.myDebugEnabled=S,t.vec3_isZero(1e-5)&&(this._mySlidingFlickeringFixSlidingCollisionRuntimeParams.copy(this._mySlidingFlickeringFixCollisionRuntimeParams),n=this._internalHorizontalSlide(s,e,u,_,m,a,h,d,this._mySlidingFlickeringFixSlidingCollisionRuntimeParams,P,!1,n),d.mySlidingCheckBothDirections&&this._horizontalSlideCheckOpposite(s,e,u,_,m,a,!0,h,d,this._mySlidingFlickeringFixCollisionRuntimeParams,this._mySlidingFlickeringFixSlidingCollisionRuntimeParams,P,n),this._mySlidingFlickeringFixSlidingCollisionRuntimeParams.myIsSliding&&a.vec3_signTo(s,_,0)!=n.vec3_signTo(s,_,0)&&(C=!0,g.myIsSlidingFlickerPrevented=!0))}return C}}();G.prototype._internalHorizontalSlide=function(){let i=c(),e=c(),t=c(),n=c(),o=c(),s=c();return function(l,u,_,m,h,d,g,P,C,f,S,M){if(l.vec3_isZero(1e-5))return M.vec3_zero();if(i=C.myHorizontalCollisionHit.myNormal.vec3_negate(i),i.vec3_removeComponentAlongAxis(m,i),i[0]=Math.abs(i[0])<.01?0:i[0],i[2]=Math.abs(i[2])<.01?0:i[2],i.vec3_normalize(i),C.mySlidingCollisionHit.copy(C.myHorizontalCollisionHit),C.mySlidingWallNormal.vec3_copy(C.myHorizontalCollisionHit.myNormal),M.vec3_zero(),e.vec3_copy(i),S&&(e.vec3_copy(l),e.vec3_normalize(e)),!e.vec3_isZero(1e-5)){e.vec3_scale(l.vec3_length(),e);let D=i.vec3_signTo(l,m);if(P.mySlidingAdjustSign90Degrees){let H=.1;i.vec3_angle(l)<H&&C.mySliding90DegreesSign!=0?D=C.mySliding90DegreesSign:(C.mySliding90DegreesSign==0||C.mySlidingRecompute90DegreesSign)&&(C.mySliding90DegreesSign=D),C.mySlidingRecompute90DegreesSign=!1}S&&(D*=-1);let v=90*D,b=Math.pp_angleClamp(e.vec3_angleSigned(l.vec3_rotateAxis(90*D,m,t),m)*D,!0)*D,x=Math.pp_angleClamp(e.vec3_angleSigned(l,m)*D,!0)*D;if(S?(b=v,x=0):(Math.abs(b)<Math.abs(x)&&(x=0),Math.abs(Math.abs(b)-Math.abs(x))<1e-4&&(x=b),(Math.abs(b)<Math.abs(v)||Math.abs(Math.abs(b)-Math.abs(v))<1e-4)&&(v=b),(Math.abs(v)<Math.abs(x)||Math.abs(Math.abs(x)-Math.abs(v))<1e-4)&&(v=x)),S&&!d.vec3_isZero(1e-6)){let H=l.vec3_angleSigned(d,m);Math.pp_sign(H)==Math.pp_sign(b)&&Math.abs(b)>Math.abs(H)&&(v=H)}n.vec3_zero();let B=P.myDebugEnabled;P.myDebugEnabled=P.myDebugEnabled&&P.myDebugSlidingEnabled;for(let H=0;H<P.mySlidingMaxAttempts&&(this._myInternalSlidingCollisionRuntimeParams.copy(C),n=e.vec3_rotateAxis(v,m,n),o.vec3_copy(h),P.myCheckHorizontalFixedForwardEnabled||n.vec3_isZero()||(o=n.vec3_normalize(o)),s.vec3_zero(),s=this._horizontalCheck(n,u,_,m,o,g,P,this._myInternalSlidingCollisionRuntimeParams,f,!0,s),s.vec3_isZero(1e-5)?(v!=b&&(x=v),H==0&&v!=b?v=b:v=(x+b)/2):(M.vec3_copy(n),C.copy(this._myInternalSlidingCollisionRuntimeParams),C.myIsSliding=!0,C.myIsSlidingIntoOppositeDirection=S,C.mySlidingMovementAngle=l.vec3_angleSigned(n,m),C.mySlidingCollisionAngle=i.vec3_angleSigned(n,m),b=v,v=(b+x)/2),!(Math.abs(Math.abs(b)-Math.abs(x))<1e-4));H++);P.myDebugEnabled=B}return C.myIsSliding||C.mySlidingCollisionHit.reset(),M}}();G.prototype._horizontalCheckBetterSlideNormal=function(){let i=c(),e=c(),t=c(),n=c(),o=c(),s=c();return function(l,u,_,m,h,d,g,P,C){i=l.vec3_normalize(i);let f=C.myHorizontalCollisionHit.myPosition,S=Math.min(P.myHalfConeAngle,90);e=f.vec3_sub(m,e),e.vec3_isToTheRight(i,d)?t=i.vec3_rotateAxis(-S,d,t):t=i.vec3_rotateAxis(S,d,t),n=e.vec3_projectOnAxisAlongAxis(i,t,n),n.vec3_isConcordant(i)?n=i.vec3_scale(Math.min(n.vec3_length(),l.vec3_length()),n):n.vec3_zero(),P.myDebugEnabled&&P.myDebugHorizontalMovementEnabled&&r.isDebugEnabled(this._myEngine)&&r.getDebugVisualManager(this._myEngine).drawArrow(0,m,i,n.vec3_length(),F(1,0,1,1)),this._myCheckBetterSlidingNormalCollisionRuntimeParams.copy(C),this._myCheckBetterSlidingNormalCollisionRuntimeParams.myIsCollidingHorizontally=!1,this._myCheckBetterSlidingNormalCollisionRuntimeParams.myHorizontalCollisionHit.reset(),o=m.vec3_add(n,o),s=m.vec3_add(n,s);let M=P.myDebugEnabled;P.myDebugEnabled=P.myDebugEnabled&&P.myDebugSlidingEnabled,P.myHorizontalPositionCheckEnabled&&this._horizontalPositionCheck(u,_,o,h,d,g,P,this._myCheckBetterSlidingNormalCollisionRuntimeParams),P.myDebugEnabled=M,this._myCheckBetterSlidingNormalCollisionRuntimeParams.myIsCollidingHorizontally&&!this._myCheckBetterSlidingNormalCollisionRuntimeParams.myHorizontalCollisionHit.myInsideCollision&&C.copy(this._myCheckBetterSlidingNormalCollisionRuntimeParams)}}();G.prototype._isSlidingNormalValid=function(){let i=c();return function(t,n,o){let s=!1;return i=o.myHorizontalCollisionHit.myNormal.vec3_removeComponentAlongAxis(n,i),i.vec3_normalize(i),i.vec3_isZero(1e-6)||(s=!0),s}}();Object.defineProperty(G.prototype,"_horizontalSlide",{enumerable:!1});Object.defineProperty(G.prototype,"_horizontalSlideCheckOpposite",{enumerable:!1});Object.defineProperty(G.prototype,"_horizontalSlideFlickerCheck",{enumerable:!1});Object.defineProperty(G.prototype,"_internalHorizontalSlide",{enumerable:!1});Object.defineProperty(G.prototype,"_horizontalCheckBetterSlideNormal",{enumerable:!1});Object.defineProperty(G.prototype,"_isSlidingNormalValid",{enumerable:!1});G.prototype._horizontalMovementCheck=function(){let i=[],e=[],t=0,n=function(){let P=null;for(;e.length<=t;)e.push(c());return P=e[t],t++,P},o=[],s=[],a=[],l=(P,C)=>P.pp_equals(C),u=c(),_=c(),m=c(),h=c(),d=c(),g=c();return function(C,f,S,M,D,v,b,x){this._myDebugEnabled=b.myDebugEnabled&&b.myDebugHorizontalMovementEnabled;let B=Math.min(b.myHalfConeAngle,90);u=C.vec3_normalize(u),i.length=0,t=0;let H=b.myRadius/b.myHorizontalMovementRadialStepAmount;{let me=n();me.vec3_copy(M),i.push(me)}{d=u.vec3_rotateAxis(B,v,d),g=u.vec3_rotateAxis(-B,v,g);for(let me=1;me<=b.myHorizontalMovementRadialStepAmount;me++){{let Pe=me*H,Le=n(),ve=d.vec3_scale(Pe,Le),ye=ve.vec3_add(M,ve);i.push(ye)}{let Pe=me*H,Le=n(),ve=g.vec3_scale(Pe,Le),ye=ve.vec3_add(M,ve);i.push(ye)}}}let w=null,Q=null,ue=null;if(b.myGroundAngleToIgnore>0){w=o,w.length=0,ue=a,ue.length=0;let me=this._ignoreSurfaceAngle.bind(this,f,S,C,null,w,!0,!0,v,b),Pe=null;b.myCeilingAngleToIgnore>0&&(Pe=this._ignoreSurfaceAngle.bind(this,f,S,C,null,ue,!1,!0,v,b)),_.vec3_zero(),this._horizontalMovementHorizontalCheck(C,M,i,_,v,me,Pe,b,x)}if(b.myCeilingAngleToIgnore>0&&!x.myIsCollidingHorizontally&&b.myCheckHeight){Q=s,Q.length=0;let me=null;b.myGroundAngleToIgnore>0&&(me=this._ignoreSurfaceAngle.bind(this,f,S,C,w,null,!0,!0,v,b));let Pe=this._ignoreSurfaceAngle.bind(this,f,S,C,null,Q,!1,!0,v,b);_=v.vec3_scale(D,_),this._horizontalMovementHorizontalCheck(C,M,i,_,v,me,Pe,b,x)}if(!x.myIsCollidingHorizontally){let me=!0;if(ue!=null){for(let ye of ue)if(!Q.pp_hasEqual(ye,l)){me=!1;break}}let Pe=null,Le=null;b.myGroundAngleToIgnore>0&&(Pe=this._ignoreSurfaceAngle.bind(this,f,S,C,w,null,!0,!0,v,b)),b.myCeilingAngleToIgnore>0&&(Le=this._ignoreSurfaceAngle.bind(this,f,S,C,Q,null,!1,!0,v,b));let ve=0;b.myCheckHeight&&b.myHeightCheckStepAmountMovement>0&&D>1e-6&&(ve=b.myHeightCheckStepAmountMovement,m=v.vec3_scale(D/ve,m));for(let ye=0;ye<=ve&&(h=m.vec3_scale(ye,h),!((b.myCheckHeightTopMovement||ye==0)&&(ye!=0&&ye!=ve||ye==0&&!me||ye==0&&b.myGroundAngleToIgnore==0||ye==ve&&b.myCeilingAngleToIgnore==0)&&(this._horizontalMovementHorizontalCheck(C,M,i,h,v,Pe,Le,b,x),x.myIsCollidingHorizontally)||ye>0&&(b.myCheckHeightVerticalMovement&&this._horizontalMovementVerticalCheck(C,M,i,h,m,v,Pe,Le,b,x),x.myIsCollidingHorizontally)));ye++);}return!x.myIsCollidingHorizontally}}();G.prototype._horizontalMovementVerticalCheck=function(){let i=c(),e=c(),t=c(),n=c(),o=c(),s=c(),a=c(),l=c(),u=c(),_=c();return function(h,d,g,P,C,f,S,M,D,v){let b=!0,x=1;i.vec3_copy(h),D.myHorizontalMovementStepEnabled&&(x=Math.max(1,Math.ceil(h.vec3_length()/D.myHorizontalMovementStepMaxLength)),h.vec3_scale(1/x,i)),e=h.vec3_normalize(e);for(let B=0;B<x;B++)for(let H=0;H<g.length;H++){if(t=g[H].vec3_add(i.vec3_scale(B,t),t).vec3_add(P,t),H>0){let w=Math.max(0,H-2);if(n=g[w].vec3_add(i.vec3_scale(B,n),n).vec3_add(P,n),D.myHorizontalMovementCheckVerticalDiagonalUpwardOutward&&(o=t.vec3_add(i,o),l=n.vec3_sub(C,l),b=this._horizontalCheckRaycast(l,o,e,f,!0,S,M,d,!0,D,v),!b)||D.myHorizontalMovementCheckVerticalDiagonalUpwardInward&&(s=n.vec3_add(i,s),a=t.vec3_sub(C,a),b=this._horizontalCheckRaycast(a,s,e,f,!0,S,M,d,!0,D,v),!b)||D.myHorizontalMovementCheckVerticalDiagonalDownwardOutward&&(u=t.vec3_add(i,u),u=u.vec3_sub(C,u),b=this._horizontalCheckRaycast(n,u,e,f,!0,S,M,d,!0,D,v),!b)||D.myHorizontalMovementCheckVerticalDiagonalDownwardInward&&(_=n.vec3_add(i,_),_=_.vec3_sub(C,_),b=this._horizontalCheckRaycast(t,_,e,f,!0,S,M,d,!0,D,v),!b))break;if(B==0){if(D.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward&&(l=n.vec3_sub(C,l),b=this._horizontalCheckRaycast(l,t,e,f,!0,S,M,d,!0,D,v),!b))break;if(D.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward){let Q=t.vec3_sub(C);if(b=this._horizontalCheckRaycast(Q,n,e,f,!0,S,M,d,!0,D,v),!b)break}}if(D.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward&&(o=t.vec3_add(i,o),_=n.vec3_sub(C,_).vec3_add(i,_),b=this._horizontalCheckRaycast(_,o,e,f,!0,S,M,d,!0,D,v),!b)||D.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward&&(s=n.vec3_add(i,s),u=t.vec3_sub(C,u).vec3_add(i,u),b=this._horizontalCheckRaycast(u,s,e,f,!0,S,M,d,!0,D,v),!b))break}if((D.myHorizontalMovementCheckVerticalStraight||D.myHorizontalMovementHorizontalStraightCentralCheckEnabled&&H==0)&&(B==0&&(a=t.vec3_sub(C,a),b=this._horizontalCheckRaycast(a,t,e,f,!0,S,M,d,!0,D,v),!b)||(o=t.vec3_add(i,o),u=o.vec3_sub(C,u),b=this._horizontalCheckRaycast(u,o,e,f,!0,S,M,d,!0,D,v),!b))||(D.myHorizontalMovementCheckVerticalStraightDiagonalUpward||D.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled&&H==0)&&(o=t.vec3_add(i,o),a=t.vec3_sub(C,a),b=this._horizontalCheckRaycast(a,o,e,f,!0,S,M,d,!0,D,v),!b)||(D.myHorizontalMovementCheckVerticalStraightDiagonalDownward||D.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled&&H==0)&&(u=t.vec3_sub(C,u).vec3_add(i,u),b=this._horizontalCheckRaycast(t,u,e,f,!0,S,M,d,!0,D,v),!b))break;if(!b){v.myIsCollidingHorizontally=!0,v.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]);break}}return b}}();G.prototype._horizontalMovementHorizontalCheck=function(){let i=c(),e=c(),t=c(),n=c(),o=c(),s=c();return function(l,u,_,m,h,d,g,P,C){let f=!0,S=1;i.vec3_copy(l),P.myHorizontalMovementStepEnabled&&(S=Math.max(1,Math.ceil(l.vec3_length()/P.myHorizontalMovementStepMaxLength)),l.vec3_scale(1/S,i)),e=l.vec3_normalize(e);for(let M=0;M<S;M++){for(let D=0;D<_.length;D++){if(t=_[D].vec3_add(i.vec3_scale(M,t),t).vec3_add(m,t),D>0){let v=Math.max(0,D-2);if(n=_[v].vec3_add(i.vec3_scale(M,n),n).vec3_add(m,n),P.myHorizontalMovementCheckDiagonalOutward&&(o=t.vec3_add(i,o),f=this._horizontalCheckRaycast(n,o,e,h,!0,d,g,u,!0,P,C),!f)||P.myHorizontalMovementCheckDiagonalInward&&(s=n.vec3_add(i,s),f=this._horizontalCheckRaycast(t,s,e,h,!0,d,g,u,!0,P,C),!f)||P.myHorizontalMovementCheckHorizontalBorder&&(M==0&&(f=this._horizontalCheckRaycast(n,t,e,h,!0,d,g,u,!0,P,C),!f)||(o=t.vec3_add(i,o),s=n.vec3_add(i,s),f=this._horizontalCheckRaycast(s,o,e,h,!0,d,g,u,!0,P,C),!f)))break}if((P.myHorizontalMovementCheckStraight||P.myHorizontalMovementVerticalStraightCentralCheckEnabled&&D==0)&&(o=t.vec3_add(i,o),f=this._horizontalCheckRaycast(t,o,null,h,!0,d,g,u,!0,P,C),!f))break}if(!f){C.myIsCollidingHorizontally=!0,C.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]);break}}return f}}();Object.defineProperty(G.prototype,"_horizontalMovementCheck",{enumerable:!1});Object.defineProperty(G.prototype,"_horizontalMovementVerticalCheck",{enumerable:!1});Object.defineProperty(G.prototype,"_horizontalMovementHorizontalCheck",{enumerable:!1});G.prototype._horizontalPositionCheck=function(){let i=[],e=[],t=0,n=function(){let S=null;for(;e.length<=t;)e.push(c());return S=e[t],t++,S},o=[],s=[],a=[],l=(S,M)=>S.pp_equals(M),u=c(),_=c(),m=c(),h=c(),d=c(),g=c(),P=c(),C=c(),f=new mt;return function(M,D,v,b,x,B,H,w){this._myDebugEnabled=H.myDebugEnabled&&H.myDebugHorizontalPositionEnabled,i.length=0,t=0;let ue=Math.min(H.myHalfConeAngle,180)/H.myHalfConeSliceAmount,me=n();i.push(v.vec3_add(B.vec3_scale(H.myRadius,me),me));for(let ye=1;ye<=H.myHalfConeSliceAmount;ye++){let qe=ye*ue;me=n();let ze=B.vec3_rotateAxis(-qe,x,me);i.push(v.vec3_add(ze.vec3_scale(H.myRadius,ze),ze)),me=n(),ze=B.vec3_rotateAxis(qe,x,me),i.push(v.vec3_add(ze.vec3_scale(H.myRadius,ze),ze))}let Pe=null,Le=null,ve=null;if(H.myGroundAngleToIgnore>0){Pe=o,Pe.length=0,ve=a,ve.length=0;let ye=this._ignoreSurfaceAngle.bind(this,M,D,B,null,Pe,!0,!1,x,H),qe=null;H.myCeilingAngleToIgnore>0&&(qe=this._ignoreSurfaceAngle.bind(this,M,D,B,null,ve,!1,!1,x,H)),u.vec3_zero(),this._horizontalPositionHorizontalCheck(v,i,u,x,B,ye,qe,H,w)}if(H.myCeilingAngleToIgnore>0&&!w.myIsCollidingHorizontally&&H.myCheckHeight){Le=s,Le.length=0;let ye=null;H.myGroundAngleToIgnore>0&&(ye=this._ignoreSurfaceAngle.bind(this,M,D,B,Pe,null,!0,!1,x,H));let qe=this._ignoreSurfaceAngle.bind(this,M,D,B,null,Le,!1,!1,x,H);u=x.vec3_scale(b,u),this._horizontalPositionHorizontalCheck(v,i,u,x,B,ye,qe,H,w)}if(!w.myIsCollidingHorizontally){let ye=!0;if(ve!=null){for(let Je of ve)if(!Le.pp_hasEqual(Je,l)){ye=!1;break}}let qe=null,ze=null;H.myGroundAngleToIgnore>0&&(qe=this._ignoreSurfaceAngle.bind(this,M,D,B,Pe,null,!0,!1,x,H)),H.myCeilingAngleToIgnore>0&&(ze=this._ignoreSurfaceAngle.bind(this,M,D,B,Le,null,!1,!1,x,H));let Et=0;H.myCheckHeight&&H.myHeightCheckStepAmountPosition>0&&b>0&&(Et=H.myHeightCheckStepAmountPosition,x.vec3_scale(b/Et,_));for(let Je=0;Je<=Et&&(m=_.vec3_scale(Je,m),!((H.myCheckHeightTopPosition||Je==0)&&(Je!=0&&Je!=Et||Je==0&&!ye||Je==0&&H.myGroundAngleToIgnore==0||Je!=0&&Je==Et&&H.myCeilingAngleToIgnore==0)&&(this._horizontalPositionHorizontalCheck(v,i,m,x,B,qe,ze,H,w),w.myIsCollidingHorizontally)));Je++)if(Je>0&&H.myCheckHeightVerticalPosition){let _o=1e-4;if((H.myHorizontalPositionCheckVerticalDirectionType==0||H.myHorizontalPositionCheckVerticalDirectionType==2)&&(C.vec3_copy(x),this._horizontalPositionVerticalCheck(v,i,m,_,C,x,qe,ze,H,w),w.myIsCollidingHorizontally&&H.myCheckHeightConeOnCollision)){if(h=w.myHorizontalCollisionHit.myPosition.vec3_sub(v,h).vec3_componentAlongAxis(x,h),h.vec3_add(C.vec3_scale(_o,d),h),w.myIsCollidingHorizontally=!1,H.myCheckHeightConeOnCollisionKeepHit&&f.copy(w.myHorizontalCollisionHit),w.myHorizontalCollisionHit.reset(),this._horizontalPositionHorizontalCheck(v,i,h,x,B,qe,ze,H,w),w.myIsCollidingHorizontally)break;if(H.myCheckHeightConeOnCollisionKeepHit){w.myIsCollidingHorizontally=!0,w.myHorizontalCollisionHit.copy(f);break}}if(!w.myIsCollidingHorizontally&&((H.myHorizontalPositionCheckVerticalDirectionType==1||H.myHorizontalPositionCheckVerticalDirectionType==2)&&(C=x.vec3_negate(C),g=m.vec3_sub(_,g),P=_.vec3_negate(P),this._horizontalPositionVerticalCheck(v,i,g,P,C,x,qe,ze,H,w)),w.myIsCollidingHorizontally&&H.myCheckHeightConeOnCollision)){if(h=w.myHorizontalCollisionHit.myPosition.vec3_sub(v,h).vec3_componentAlongAxis(x,h),h.vec3_add(C.vec3_scale(_o,d),h),w.myIsCollidingHorizontally=!1,H.myCheckHeightConeOnCollisionKeepHit&&f.copy(w.myHorizontalCollisionHit),w.myHorizontalCollisionHit.reset(),this._horizontalPositionHorizontalCheck(v,i,h,x,B,qe,ze,H,w),w.myIsCollidingHorizontally)break;if(H.myCheckHeightConeOnCollisionKeepHit){w.myIsCollidingHorizontally=!0,w.myHorizontalCollisionHit.copy(f);break}}}}return!w.myIsCollidingHorizontally}}();G.prototype._horizontalPositionHorizontalCheck=function(){let i=c(),e=c(),t=c(),n=c();return function(s,a,l,u,_,m,h,d,g){let P=!0;i=s.vec3_add(l,i);let C=Math.floor(a.length/2)+1;for(let f=0;f<C;f++){if(f>0){let S=Math.max(0,f*2),M=Math.max(0,f*2-1),D=a[S].vec_equals(a[M],1e-6);if(d.myCheckConeBorder)for(let v=0;v<2;v++){let b=v==0?S:M;t=a[b].vec3_add(l,t);let x=Math.max(0,b-2);if(n=a[x].vec3_add(l,n),P=this._horizontalCheckRaycast(n,t,_.vec3_negate(e),u,!0,m,h,s,!0,d,g),!P)break}if(d.myCheckConeRay&&P)for(let v=0;v<2&&!(v==1&&D);v++){let b=v==0?S:M;if(t=a[b].vec3_add(l,t),P=this._horizontalCheckRaycast(i,t,null,u,!1,m,h,s,!1,d,g),!P)break}}else if(d.myCheckConeRay&&(t=a[f].vec3_add(l,t),P=this._horizontalCheckRaycast(i,t,null,u,!1,m,h,s,!1,d,g),!P))break;if(!P)break}return P||(g.myIsCollidingHorizontally=!0,g.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0])),P}}();G.prototype._horizontalPositionVerticalCheck=function(){let i=c(),e=c(),t=c(),n=c(),o=c(),s=c();return function(l,u,_,m,h,d,g,P,C,f){let S=!0;i=l.vec3_add(_,i),e=i.vec3_sub(m,e);for(let M=0;M<=u.length;M++){let D=!1;if(M==u.length?(t.vec3_copy(i),n.vec3_copy(e)):(t=u[M].vec3_add(_,t),n=t.vec3_sub(m,n),M>0&&(D=u[M].vec_equals(u[M-1],1e-6))),C.myCheckVerticalStraight&&!D&&(S=this._horizontalCheckRaycast(n,t,null,d,C.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision,g,P,l,!0,C,f,!0,!0),!S&&(f.myIsCollidingHorizontally?this._myRaycastResult.myHits[0].myPosition.vec3_isFartherAlongAxis(f.myHorizontalCollisionHit.myPosition,h)&&f.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]):(f.myIsCollidingHorizontally=!0,f.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0])),!C.myCheckVerticalSearchFartherVerticalHit)))break;if(M<u.length){if((C.myCheckVerticalDiagonalRayOutward||C.myCheckVerticalDiagonalBorderRayOutward&&(M==u.length-2||M==u.length-1))&&!D&&(S=this._horizontalCheckRaycast(e,t,null,d,C.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision,g,P,l,!0,C,f,!0,!0),!S&&(f.myIsCollidingHorizontally?this._myRaycastResult.myHits[0].myPosition.vec3_isFartherAlongAxis(f.myHorizontalCollisionHit.myPosition,h)&&f.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]):(f.myIsCollidingHorizontally=!0,f.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0])),!C.myCheckVerticalSearchFartherVerticalHit))||(C.myCheckVerticalDiagonalRayInward||C.myCheckVerticalDiagonalBorderRayInward&&(M==u.length-2||M==u.length-1))&&!D&&(S=this._horizontalCheckRaycast(n,i,null,d,C.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision,g,P,l,!0,C,f,!0,!0),!S&&(f.myIsCollidingHorizontally?this._myRaycastResult.myHits[0].myPosition.vec3_isFartherAlongAxis(f.myHorizontalCollisionHit.myPosition,h)&&f.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]):(f.myIsCollidingHorizontally=!0,f.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0])),!C.myCheckVerticalSearchFartherVerticalHit)))break;if(M>0&&(C.myCheckVerticalDiagonalBorderOutward||C.myCheckVerticalDiagonalBorderInward)){let v=Math.max(0,M-2);if(o=u[v].vec3_add(_,o),s=o.vec3_sub(m,s),C.myCheckVerticalDiagonalBorderOutward&&(S=this._horizontalCheckRaycast(s,t,null,d,C.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision,g,P,l,!0,C,f,!0,!0),!S&&(f.myIsCollidingHorizontally?this._myRaycastResult.myHits[0].myPosition.vec3_isFartherAlongAxis(f.myHorizontalCollisionHit.myPosition,h)&&f.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]):(f.myIsCollidingHorizontally=!0,f.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0])),!C.myCheckVerticalSearchFartherVerticalHit))||C.myCheckVerticalDiagonalBorderInward&&(S=this._horizontalCheckRaycast(n,o,null,d,C.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision,g,P,l,!0,C,f,!0,!0),!S&&(f.myIsCollidingHorizontally?this._myRaycastResult.myHits[0].myPosition.vec3_isFartherAlongAxis(f.myHorizontalCollisionHit.myPosition,h)&&f.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]):(f.myIsCollidingHorizontally=!0,f.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0])),!C.myCheckVerticalSearchFartherVerticalHit)))break}}}return!f.myIsCollidingHorizontally}}();Object.defineProperty(G.prototype,"_horizontalPositionCheck",{enumerable:!1});Object.defineProperty(G.prototype,"_horizontalPositionHorizontalCheck",{enumerable:!1});Object.defineProperty(G.prototype,"_horizontalPositionVerticalCheck",{enumerable:!1});G.prototype._verticalCheck=function(){let i=c(),e=c(),t=c(0,0,0);return function(o,s,a,l,u,_,m,h,d){h.myIsCollidingVertically=!1,h.myVerticalCollisionHit.reset();let g=Math.pp_sign(o.vec3_lengthSigned(u),-1),P=g<0;if(d.vec3_copy(o),m.myVerticalMovementCheckEnabled&&(d=this._verticalMovementAdjustment(o,P,s,a,l,u,_,m,h,d),m.myCheckVerticalBothDirection&&(d.vec_equals(o,1e-5)||s==0||g!=s))){i=a.vec3_add(d,i);let C=!P;e=this._verticalMovementAdjustment(t,C,s,i,l,u,_,m,h,e),d.vec3_add(e,d),P=!P}return m.myVerticalPositionCheckEnabled&&(i=a.vec3_add(d,i),this._verticalPositionCheck(i,P,l,u,_,m,h)||(d.vec3_zero(),h.myHasSnappedOnGround=!1,h.myHasSnappedOnCeiling=!1,h.myHasPoppedOutGround=!1,h.myHasPoppedOutCeiling=!1,h.myHasReducedVerticalMovement=!1)),d}}();G.prototype._verticalMovementAdjustment=function(){let i=c(),e=c(),t=c(),n=c(),o=c(),s=c(),a=c(),l=c();return function(_,m,h,d,g,P,C,f,S,M){this._myDebugEnabled=f.myDebugEnabled&&f.myDebugVerticalMovementEnabled,i.vec3_zero(),e.vec3_zero();let D=!1,v=!1;if(m?(i.vec3_zero(),e.vec3_copy(_),f.myGroundPopOutExtraDistance>0&&f.myGroundPopOutEnabled&&(i.vec3_add(P.vec3_scale(f.myGroundPopOutExtraDistance+1e-5,t),i),D=!0)):(i=P.vec3_scale(g,i),e=P.vec3_scale(g,e).vec3_add(_,e),f.myCeilingPopOutExtraDistance>0&&f.myCeilingPopOutEnabled&&(i.vec3_add(P.vec3_scale(-f.myCeilingPopOutExtraDistance-1e-5,t),i),D=!0)),m&&h<=0&&this._myPrevCollisionRuntimeParams.myIsOnGround&&f.mySnapOnGroundEnabled&&f.mySnapOnGroundExtraDistance>0?(e.vec3_add(P.vec3_scale(-f.mySnapOnGroundExtraDistance-1e-5,t),e),v=!0):!m&&this._myPrevCollisionRuntimeParams.myIsOnCeiling&&f.mySnapOnCeilingEnabled&&f.mySnapOnCeilingExtraDistance>0&&(h>0||h==0&&(!this._myPrevCollisionRuntimeParams.myIsOnGround||!f.mySnapOnGroundEnabled))&&(e.vec3_add(P.vec3_scale(f.mySnapOnCeilingExtraDistance+1e-5,t),e),v=!0),M.vec3_zero(),i.vec3_distance(e)>1e-5){let b=this._getVerticalCheckPositions(d,P,C,f,S);n.vec3_copy(P),m||n.vec3_negate(n);let x=!1;for(let B=0;B<b.length;B++){let H=b[B];a=H.vec3_add(i,a),l=H.vec3_add(e,l).vec3_sub(a,l);let w=l.vec3_length();l.vec3_normalize(l);let Q=this._raycastAndDebug(a,l,w,!0,!1,f,S);Q.myHits.length>0&&(x?Q.myHits[0].myPosition.vec3_isFartherAlongAxis(o,n)&&o.vec3_copy(Q.myHits[0].myPosition):(x=!0,o.vec3_copy(Q.myHits[0].myPosition)))}x?(s=P.vec3_negate(s),m?(M=o.vec3_sub(d,M).vec3_componentAlongAxis(P,M),v&&M.vec3_isFartherAlongAxis(_,s)?S.myHasSnappedOnGround=!0:D&&M.vec3_isFartherAlongAxis(_,P)&&!M.vec3_isZero(1e-5)&&(_.vec3_isZero(1e-5)||!M.vec3_isConcordant(_))?S.myHasPoppedOutGround=!0:S.myHasReducedVerticalMovement=!0):(M=o.vec3_sub(d.vec3_add(P.vec3_scale(g,M),M),M).vec3_componentAlongAxis(P,M),v&&M.vec3_isFartherAlongAxis(_,P)?S.myHasSnappedOnCeiling=!0:D&&M.vec3_isFartherAlongAxis(_,s)&&!M.vec3_isZero(1e-5)&&(_.vec3_isZero(1e-5)||!M.vec3_isConcordant(_))?S.myHasPoppedOutCeiling=!0:S.myHasReducedVerticalMovement=!0),!D&&!M.vec3_isConcordant(_)&&M.vec3_zero(),!f.myVerticalMovementReduceEnabled&&S.myHasReducedVerticalMovement&&(M.vec3_copy(_),S.myHasReducedVerticalMovement=!1)):M.vec3_copy(_)}else M.vec3_copy(_);return M.vec3_length()<1e-5&&M.vec3_zero(),M}}();G.prototype._verticalPositionCheck=function(){let i=c(),e=c(),t=c(),n=c(),o=c();return function(a,l,u,_,m,h,d){if(u<1e-5)return!0;this._myDebugEnabled=h.myDebugEnabled&&h.myDebugVerticalPositionEnabled;let g=this._getVerticalCheckPositions(a,_,m,h,d),P=!0,C=!1,f=1e-4;i=_.vec3_scale(f,i),e=_.vec3_scale(u-f,e),u-f<f*10&&(e=_.vec3_scale(f*10,e));let S=!1;for(let M=0;M<g.length;M++){let D=g[M];l?(t=D.vec3_add(i,t),n=D.vec3_add(e,n)):(t=D.vec3_add(e,t),n=D.vec3_add(i,n));let v=t;o=n.vec3_sub(v,o);let b=o.vec3_length();o.vec3_normalize(o);let x=this._raycastAndDebug(v,o,b,!1,!1,h,d);if(x.isColliding()){let B=x.getFirstHitOutsideCollision();if(B!=null){P=!1,d.myVerticalCollisionHit.copy(B);break}else if(!S&&(S=!0,d.myVerticalCollisionHit.copy(x.myHits[0]),!h.myVerticalAllowHitInsideCollisionIfOneOk)){P=!1;break}}else C=!0}return d.myIsCollidingVertically=!P||!C,!d.myIsCollidingVertically}}();G.prototype._getVerticalCheckPositions=function(){let i=[],e=[],t=0,n=function(){let s=null;for(;e.length<=t;)e.push(c());return s=e[t],t++,s},o=c();return function(a,l,u,_,m){if(i.length=0,t=0,_.myGroundCircumferenceAddCenter){let P=n();P.vec3_copy(a),i.push(P)}let h=_.myFeetRadius/_.myGroundCircumferenceStepAmount,d=360/_.myGroundCircumferenceSliceAmount,g=0;for(let P=0;P<_.myGroundCircumferenceStepAmount;P++){let C=h*(P+1);o=u.vec3_rotateAxis(g,l,o);for(let f=0;f<_.myGroundCircumferenceSliceAmount;f++){let S=n(),M=o.vec3_rotateAxis(d*f,l,S);i.push(a.vec3_add(M.vec3_scale(C,M),M))}g+=_.myGroundCircumferenceRotationPerStep}return i}}();Object.defineProperty(G.prototype,"_verticalCheck",{enumerable:!1});Object.defineProperty(G.prototype,"_verticalMovementAdjustment",{enumerable:!1});Object.defineProperty(G.prototype,"_verticalPositionCheck",{enumerable:!1});Object.defineProperty(G.prototype,"_getVerticalCheckPositions",{enumerable:!1});G.prototype._updateSurfaceInfo=function(){let i=c(),e=c(),t=c(),n=N(),o=N(),s=c(),a=c(),l=c(0,0,1),u=c(1,0,0);return function(m,h,d){n.quat2_setPositionRotationQuat(h.myPositionOffsetLocal,h.myRotationOffsetLocalQuat),o=n.quat2_toWorld(m,o),m.vec_equals(o,1e-5)&&o.quat2_copy(m),i=o.quat2_getUp(i),e=o.quat2_getForward(e),t=o.quat2_getPosition(t);let g=h.myHeight;g=g-1e-5,g<1e-5&&(g=0),s.vec3_copy(e),a.vec3_copy(h.myCheckVerticalFixedForward),h.myCheckVerticalFixedForwardEnabled?(h.myCheckVerticalFixedForward.vec3_isOnAxis(i)&&(l.vec3_isOnAxis(i)?a.vec3_copy(u):a.vec3_copy(l)),a=a.vec3_removeComponentAlongAxis(i,a),a=a.vec3_normalize(a),a.vec_equals(h.myCheckVerticalFixedForward,1e-5)&&a.vec3_copy(h.myCheckVerticalFixedForward)):a.vec3_copy(e),h.myComputeGroundInfoEnabled&&this._gatherSurfaceInfo(t,g,i,s,a,!0,h,d),h.myComputeCeilingInfoEnabled&&this._gatherSurfaceInfo(t,g,i,s,a,!1,h,d)}}();G.prototype._postSurfaceCheck=function(){let i=c();return function(t,n,o,s,a,l){let u=n.vec3_isZero(1e-5),_=Math.pp_sign(n.vec3_lengthSigned(o),-1)<0,m=t.vec3_isZero(1e-5);i=t.vec3_normalize(i);let h=this.computeSurfacePerceivedAngle(a.myGroundNormal,i,o,!0),d=this.computeSurfacePerceivedAngle(a.myCeilingNormal,i,o,!1),g=!0;s.myMustStayOnGround&&l.myIsOnGround&&!a.myIsOnGround&&(u||_)&&(g=!1);let P=!0;s.myMustStayOnCeiling&&l.myIsOnCeiling&&!a.myIsOnCeiling&&(u||_)&&(P=!1);let C=!0;if(s.myMustStayBelowGroundAngleDownhill!=null||s.myMustStayBelowIgnorableGroundAngleDownhill){let B=null;s.myMustStayBelowIgnorableGroundAngleDownhill?s.myMustStayBelowGroundAngleDownhill==null?B=s.myGroundAngleToIgnore:B=Math.min(s.myMustStayBelowGroundAngleDownhill,s.myGroundAngleToIgnore):B=s.myMustStayBelowGroundAngleDownhill,!m&&h<0&&l.myIsOnGround&&l.myGroundAngle<=B&&a.myIsOnGround&&a.myGroundAngle>B+1e-4&&(C=!1)}let f=!0;if(s.myMustStayBelowCeilingAngleDownhill!=null||s.myMustStayBelowIgnorableCeilingAngleDownhill){let B=null;s.myMustStayBelowIgnorableCeilingAngleDownhill?s.myMustStayBelowCeilingAngleDownhill==null?B=s.myCeilingAngleToIgnore:B=Math.min(s.myMustStayBelowCeilingAngleDownhill,s.myCeilingAngleToIgnore):B=s.myMustStayBelowCeilingAngleDownhill,!m&&h<0&&l.myIsOnCeiling&&l.myCeilingAngle<=B&&a.myIsOnCeiling&&a.myCeilingAngle>B+1e-4&&(f=!1)}let S=!0;s.myMovementMustStayOnGroundHitAngle!=null&&!m&&l.myIsOnGround&&l.myGroundHitMaxAngle<=s.myMovementMustStayOnGroundHitAngle&&a.myIsOnGround&&a.myGroundHitMaxAngle>s.myMovementMustStayOnGroundHitAngle+1e-4&&(S=!1);let M=!0;s.myMovementMustStayOnCeilingHitAngle!=null&&!m&&l.myIsOnCeiling&&l.myCeilingHitMaxAngle<=s.myMovementMustStayOnCeilingHitAngle&&a.myIsOnCeiling&&a.myCeilingHitMaxAngle>s.myMovementMustStayOnCeilingHitAngle+1e-4&&(M=!1);let D=!0,v=!0;a.myIsOnGround&&a.myGroundAngle>s.myGroundAngleToIgnore+1e-4&&l.myIsOnGround&&!m&&(h>0?(D=!1,s.myGroundAngleToIgnoreWithPerceivedAngle!=null&&a.myGroundAngle<=s.myGroundAngleToIgnoreWithPerceivedAngle+1e-4&&(D=Math.abs(h)<=s.myGroundAngleToIgnore+1e-4)):h<0&&l.myGroundAngle<=s.myGroundAngleToIgnore+1e-4&&s.myMustStayOnValidGroundAngleDownhill&&(v=!1));let b=!0,x=!0;return a.myIsOnCeiling&&a.myCeilingAngle>s.myCeilingAngleToIgnore+1e-4&&l.myIsOnCeiling&&!m&&(d>0?(b=!1,s.myCeilingAngleToIgnoreWithPerceivedAngle!=null&&a.myCeilingAngle<=s.myCeilingAngleToIgnoreWithPerceivedAngle+1e-4&&(b=Math.abs(d)<=s.myCeilingAngleToIgnore+1e-4)):d<0&&l.myCeilingAngle<=s.myCeilingAngleToIgnore+1e-4&&s.myMustStayOnValidCeilingAngleDownhill&&(x=!1)),g&&P&&C&&f&&S&&M&&D&&v&&b&&x}}();G.prototype._surfaceTooSteep=function(){let i=[!1,!1];return function(t,n,o,s){let a=!1,l=!1;if(s.myIsOnGround&&s.myGroundAngle>o.myGroundAngleToIgnore+1e-4){let u=this.computeSurfacePerceivedAngle(s.myGroundNormal,n,t,!0);a=u>0,a&&o.myGroundAngleToIgnoreWithPerceivedAngle!=null&&s.myGroundAngle<=o.myGroundAngleToIgnoreWithPerceivedAngle+1e-4&&(a=Math.abs(u)>o.myGroundAngleToIgnore+1e-4)}if(!a&&s.myIsOnCeiling&&s.myCeilingAngle>o.myCeilingAngleToIgnore+1e-4){let u=this.computeSurfacePerceivedAngle(s.myCeilingNormal,n,t,!1);l=u>0,l&&o.myCeilingAngleToIgnoreWithPerceivedAngle!=null&&s.myCeilingAngle<=o.myCeilingAngleToIgnoreWithPerceivedAngle+1e-4&&(l=Math.abs(u)>o.myCeilingAngleToIgnore+1e-4)}return i[0]=a,i[1]=l,i}}();G.prototype._adjustVerticalMovementWithSurface=function(){let i=c(),e=c();return function(n,o,s,a,l,u,_){if(_.vec3_copy(o),n.vec3_isZero(1e-5))return _;let m=0;if(i=n.vec3_normalize(i),u.myIsOnGround){let h=this.computeSurfacePerceivedAngle(u.myGroundNormal,i,s,!0),d=n.vec3_length()*Math.tan(Math.pp_toRadians(Math.abs(h)));d*=Math.pp_sign(h),Math.abs(d)>1e-5&&(h>0?a.myAdjustVerticalMovementWithGroundAngleUphill&&(a.myAdjustVerticalMovementWithGroundAngleUphillMaxPerceivedAngle==null||Math.abs(h)<=a.myAdjustVerticalMovementWithGroundAngleUphillMaxPerceivedAngle)&&(a.myAdjustVerticalMovementWithGroundAngleUphillMaxAngle==null||u.myGroundAngle<=a.myAdjustVerticalMovementWithGroundAngleUphillMaxAngle)&&(m=d,l.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleUphill=!0):h<0&&a.myAdjustVerticalMovementWithGroundAngleDownhill&&(a.myAdjustVerticalMovementWithGroundAngleDownhillMaxPerceivedAngle==null||Math.abs(h)<=a.myAdjustVerticalMovementWithGroundAngleDownhillMaxPerceivedAngle)&&(a.myAdjustVerticalMovementWithGroundAngleDownhillMaxAngle==null||u.myGroundAngle<=a.myAdjustVerticalMovementWithGroundAngleDownhillMaxAngle)&&(m=d,l.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleDownhill=!0))}if(u.myIsOnCeiling){let h=this.computeSurfacePerceivedAngle(u.myCeilingNormal,i,s,!1),d=n.vec3_length()*Math.tan(Math.pp_toRadians(Math.abs(h)));if(d*=Math.pp_sign(h),Math.abs(d)>1e-5){let g=Math.pp_sign(m)==Math.pp_sign(d);(m==0||g&&Math.abs(d)>Math.abs(m))&&(h>0?a.myAdjustVerticalMovementWithCeilingAngleUphill&&(a.myAdjustVerticalMovementWithCeilingAngleUphillMaxPerceivedAngle==null||Math.abs(h)<=a.myAdjustVerticalMovementWithCeilingAngleUphillMaxPerceivedAngle)&&(a.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle==null||u.myCeilingAngle<=a.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle)&&(m=d,l.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleUphill=!0,l.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleUphill=!1):h<0&&a.myAdjustVerticalMovementWithCeilingAngleDownhill&&(a.myAdjustVerticalMovementWithCeilingAngleDownhillMaxPerceivedAngle==null||Math.abs(h)<=a.myAdjustVerticalMovementWithCeilingAngleDownhillMaxPerceivedAngle)&&(a.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle==null||u.myCeilingAngle<=a.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle)&&(m=d,l.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleDownhill=!0,l.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleDownhill=!1))}}if(Math.abs(m)>1e-5){let h=o.vec3_lengthSigned(s),d=Math.pp_sign(m)==Math.pp_sign(h);e=s.vec3_scale(m,e),o.vec3_isZero(1e-5)?_.vec3_copy(e):d||!d&&(l.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleUphill||l.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleUphill)?_=o.vec3_add(e,_):(l.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleUphill=!1,l.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleUphill=!1,l.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleDownhill=!1,l.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleDownhill=!1)}return _.vec3_isZero(1e-6)&&_.vec3_zero(),_}}();G.prototype._adjustHorizontalMovementWithSurface=function(){let i=c(),e=c(),t=c(),n=c(),o=c(),s=c();return function(l,u,_,m,h,d,g){if(g.vec3_copy(l),u.vec3_isZero(1e-5))return g;let P=!u.vec3_isConcordant(_);if(i.vec3_zero(),e.vec3_zero(),d.myIsOnGround&&(e=d.myGroundNormal.vec3_removeComponentAlongAxis(_,e),!e.vec3_isZero(1e-5))){e.vec3_normalize(e);let C=u.vec3_length()/Math.tan(Math.pp_toRadians(d.myGroundAngle));C*=P?1:-1,Math.abs(C)>1e-5&&P&&m.myAdjustHorizontalMovementWithGroundAngleDownhill&&(m.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle==null||d.myGroundAngle>=m.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle)&&(i=e.vec3_scale(C,i),h.myVerticalMovementHasAdjustedHorizontalMovementOverGroundAngleDownhill=!0)}if(d.myIsOnCeiling&&(t=d.myCeilingNormal.vec3_removeComponentAlongAxis(_,t),!t.vec3_isZero(1e-5))){t.vec3_normalize(t);let C=u.vec3_length()/Math.tan(Math.pp_toRadians(d.myCeilingAngle));if(C*=P?-1:1,Math.abs(C)>1e-5){let f=t.vec3_isConcordant(e);(i.vec3_isZero()||f)&&(P||m.myAdjustHorizontalMovementWithCeilingAngleDownhill&&(m.myAdjustHorizontalMovementWithCeilingAngleDownhillMinAngle==null||d.myCeilingAngle>=m.myAdjustHorizontalMovementWithCeilingAngleDownhillMinAngle)&&(n=t.vec3_scale(C,n),e.vec3_isZero()?(i.vec3_copy(n),h.myVerticalMovementHasAdjustedHorizontalMovementOverCeilingAngleDownhill=!0):(s=n.vec3_removeComponentAlongAxis(s),o=n.vec3_componentAlongAxis(s),o.vec3_isFartherAlongAxis(i,e)?(h.myVerticalMovementHasAdjustedHorizontalMovementOverGroundAngleDownhill=!1,i.vec3_copy(n),h.myVerticalMovementHasAdjustedHorizontalMovementOverCeilingAngleDownhill=!0):s.vec3_isZero(1e-5)||(i=i.vec3_add(s,i),h.myVerticalMovementHasAdjustedHorizontalMovementOverCeilingAngleDownhill=!0))))}}return i.vec3_isZero()||(l.vec3_isZero(1e-5)?g.vec3_copy(i):(i.vec3_isConcordant(l),g=l.vec3_add(i,g))),g.vec3_isZero(1e-6)&&g.vec3_zero(),g}}();G.prototype._computeExtraSurfaceVerticalMovement=function(){let i=c(),e=c();return function(n,o,s,a,l){if(l.vec3_zero(),!n.vec3_isZero()){if(a.myIsOnGround&&a.myGroundAngle!=0){i=n.vec3_normalize(i);let u=this.computeSurfacePerceivedAngle(a.myGroundNormal,i,o,!0),_=n.vec3_length()*Math.tan(Math.pp_toRadians(Math.abs(u)));_*=Math.pp_sign(u),Math.abs(_)>1e-5&&(s.mySnapOnGroundEnabled||_>0)&&l.vec3_add(o.vec3_scale(_,e),l)}else if(a.myIsOnCeiling&&a.myCeilingAngle!=0){i=n.vec3_normalize(i);let u=this.computeSurfacePerceivedAngle(a.myCeilingNormal,i,o,!1),_=n.vec3_length()*Math.tan(Math.pp_toRadians(Math.abs(u)));_*=Math.pp_sign(u),_*=-1,Math.abs(_)>1e-5&&(s.mySnapOnCeilingEnabled||_<0)&&l.vec3_add(o.vec3_scale(_,e),l)}}return l}}();G.prototype._gatherSurfaceInfo=function(){let i=c(),e=c(),t=c(),n=c(),o=c(),s=c(),a=c(),l=c(),u=c(),_=c(),m=c(),h=c(),d=c();return function(P,C,f,S,M,D,v,b){this._myDebugEnabled=v.myDebugEnabled&&(D&&v.myDebugGroundInfoEnabled||!D&&v.myDebugCeilingInfoEnabled);let x=this._getVerticalCheckPositions(P,f,M,v,b);i.vec3_copy(f);let B=v.myDistanceToBeOnGround,H=v.myDistanceToComputeGroundInfo,w=v.myFindGroundDistanceMaxOutsideDistance,Q=v.myVerticalFixToBeOnGround,ue=v.myVerticalFixToComputeGroundInfo,me=v.myFindGroundDistanceMaxInsideDistance,Pe=v.myIsOnGroundIfInsideHit,Le=v.myGroundIsBaseInsideCollisionCheckEnabled;D||(i.vec3_negate(i),B=v.myDistanceToBeOnCeiling,H=v.myDistanceToComputeCeilingInfo,w=v.myFindCeilingDistanceMaxOutsideDistance,Q=v.myVerticalFixToBeOnCeiling,ue=v.myVerticalFixToComputeCeilingInfo,me=v.myFindCeilingDistanceMaxInsideDistance,Pe=v.myIsOnCeilingIfInsideHit,Le=v.myCeilingIsBaseInsideCollisionCheckEnabled),e=i.vec3_scale(Math.max(Q,ue,me,1e-5),e),t=i.vec3_negate(t).vec3_scale(Math.max(B,H,w,1e-5),t),n.vec3_zero(),D||(n=f.vec3_scale(C,n)),o=i.vec3_scale(1e-4,o);let ve=!1,ye=0,qe=0;l.vec3_zero();let ze=0;u.vec3_zero();let Et=null,Je=x.length>0;for(let _o=0;_o<x.length;_o++){let Ki=x[_o];Ki.vec3_add(n,Ki);let Qr=!1;if(Le){s=Ki.vec3_add(o,s),a=Ki.vec3_sub(o,a);let ss=s;d=a.vec3_sub(ss,d);let qr=d.vec3_length();d.vec3_normalize(d);let go=this._raycastAndDebug(ss,d,qr,!1,!1,v,b);go.isColliding()&&(Qr=go.myHits[0].myInsideCollision)}if(Je&&=Qr,Qr)Pe&&(ve=!0);else{m=Ki.vec3_add(e,m),h=Ki.vec3_add(t,h);let ss=m;d=h.vec3_sub(ss,d);let qr=d.vec3_length();d.vec3_normalize(d);let go=this._raycastAndDebug(ss,d,qr,!0,!1,v,b);if(go.isColliding()){_=go.myHits[0].myPosition.vec3_sub(Ki,_);let ut=_.vec3_lengthSigned(i);if((ut>=0&&ut<=Q+1e-5||ut<0&&Math.abs(ut)<=B+1e-5)&&(ve=!0),ut>=0&&ut<=ue+1e-5||ut<0&&Math.abs(ut)<=H+1e-5){let Xr=go.myHits[0].myNormal;l.vec3_add(Xr,l);let cm=Xr.vec3_angle(i);cm>ze&&(ze=cm,u.vec3_copy(Xr))}(ut>=0&&ut<=me+1e-5||ut<0&&Math.abs(ut)<=w+1e-5)&&(Et==null||Math.abs(ut)<Math.abs(Et))&&(Et=-ut)}}}l.vec3_isZero()||(l.vec3_normalize(l),ye=l.vec3_angle(i),ye<=1e-4?(ye=0,l.vec3_copy(i)):ye>=180-1e-4&&(ye=180,l=i.vec3_negate(l)),qe=this.computeSurfacePerceivedAngle(l,S,f,D)),D?(b.myRealIsOnGround=ve,b.myGroundAngle=ye,b.myGroundPerceivedAngle=qe,b.myGroundNormal.vec3_copy(l),b.myGroundHitMaxAngle=ze,b.myGroundHitMaxNormal.vec3_copy(u),b.myGroundDistance=Et,b.myGroundIsBaseInsideCollision=Je,ve&&(v.myIsOnGroundMaxSurfaceAngle==null||b.myGroundAngle<=v.myIsOnGroundMaxSurfaceAngle)&&(b.myIsOnGround=ve)):(b.myRealIsOnCeiling=ve,b.myCeilingAngle=ye,b.myCeilingPerceivedAngle=qe,b.myCeilingNormal.vec3_copy(l),b.myCeilingHitMaxAngle=ze,b.myCeilingHitMaxNormal.vec3_copy(u),b.myCeilingDistance=Et,b.myCeilingIsBaseInsideCollision=Je,ve&&(v.myIsOnCeilingMaxSurfaceAngle==null||b.myCeilingAngle<=v.myIsOnCeilingMaxSurfaceAngle)&&(b.myIsOnCeiling=ve))}}();G.prototype.computeSurfacePerceivedAngle=function(){let i=c(),e=c();return function(n,o,s,a=!0){let l=0;e.vec3_copy(s),a||e.vec3_negate(e);let u=n.vec3_angle(e);u<=Math.PP_EPSILON_DEGREES?u=0:u>=180-Math.PP_EPSILON_DEGREES&&(u=180),i=o.vec3_projectOnPlaneAlongAxis(n,s,i),l=i.vec3_angle(o);let _=i.vec3_isFartherAlongAxis(o,s);return(!_&&a||_&&!a)&&(l*=-1),Math.abs(l)>=u&&(u!=0&&u!=180?l=u*Math.pp_sign(l):l=u),l}}();Object.defineProperty(G.prototype,"_surfaceTooSteep",{enumerable:!1});Object.defineProperty(G.prototype,"_computeExtraSurfaceVerticalMovement",{enumerable:!1});Object.defineProperty(G.prototype,"_gatherSurfaceInfo",{enumerable:!1});Object.defineProperty(G.prototype,"_updateSurfaceInfo",{enumerable:!1});var Ue=class{constructor(){this.myCheckType=null,this.myTransformResults=new jo,this.myMovementResults=new Ui,this.myHorizontalMovementResults=new Ui,this.myVerticalMovementResults=new Ui,this.myTeleportResults=new zo,this.myCheckTransformResults=new No,this.myWallSlideResults=new wo,this.myGroundInfo=new $n,this.myCeilingInfo=new $n,this.myGroundResults=new eo,this.myCeilingResults=new eo,this.mySplitMovementResults=new Go,this.myDebugResults=new Wo,this.myInternalResults=new Uo}reset(){}copy(e){}},Qi={CHECK_MOVEMENT:0,CHECK_TELEPORT:1,CHECK_TRANSFORM:2,UPDATE_SURFACE_INFO:3,UPDATE_GROUND_INFO:4,UPDATE_CEILING_INFO:5},$n=class{constructor(){this.myOnSurface=!1,this.mySurfaceAngle=0,this.mySurfacePerceivedAngle=0,this.mySurfaceNormal=c(),this.mySurfaceHitMaxAngle=0,this.mySurfaceHitMaxNormal=c(),this.mySurfaceDistance=null,this.myBaseInsideCollision=!1}reset(){}copy(e){}},wo=class{constructor(){this.myHasSlid=!1,this.mySlideMovementAngle=0,this.mySlideMovementWallAngle=0,this.myWallNormal=c()}reset(){}copy(e){}},jo=class{constructor(){this.myInitialTransformQuat=N(),this.myFinalTransformQuat=N()}reset(){}copy(e){}},Ui=class{constructor(){this.myInitialMovement=c(),this.myFinalMovement=c(),this.myMovementFailed=!1,this.myMovementCollided=!1,this.myReferenceCollisionHit=new mt}reset(){}copy(e){}},zo=class{constructor(){this.myInitialTeleportTransformQuat=N(),this.myFinalTeleportTransformQuat=N(),this.myTeleportFailed=!1}reset(){}copy(e){}},No=class{constructor(){this.myInitialCheckTransformQuat=N(),this.myFinalCheckTransformQuat=N(),this.myCheckTransformFailed=!1}reset(){}copy(e){}},eo=class{constructor(){this.myHasSnappedOnSurface=!1,this.myHasPoppedOutSurface=!1,this.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleDownhill=!1,this.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleUphill=!1,this.myHasVerticalMovementAdjustedHorizontalMovementOverSurfaceAngleDownhill=!1}reset(){}copy(e){}},Go=class{constructor(){this.myStepsToPerform=0,this.myStepsPerformed=0,this.myMovementInterrupted=!1,this.myMovementChecked=c()}reset(){}copy(e){}},Wo=class{constructor(){this._myRaycastsPerformed=0}reset(){}copy(e){}},Uo=class{constructor(){this.myLastRelevantInitialHorizontalMovement=c(),this.myLastRelevantAdjustedInitialHorizontalMovement=c(),this.myLastRelevantFinalHorizontalMovement=c(),this.myLastRelevantInitialVerticalMovement=c(),this.myLastRelevantAdjustedInitialVerticalMovement=c(),this.myLastRelevantFinalVerticalMovement=c(),this.myLastRelevantHasWallSlid=!1,this.myHasWallSlidTowardOppositeDirection=!1,this.myLastRelevantWallSlideFlickerPrevented=!1,this.myWallSlideFlickerPreventionForceCheckCounter=0,this.myWallSlide90DegreesDirectionSign=0,this.myWallSlide90DegreesRecomputeDirectionSign=!0}reset(){}copy(e){}};Ue.prototype.reset=function(){this.myCheckType=null,this.myTransformResults.reset(),this.myMovementResults.reset(),this.myHorizontalMovementResults.reset(),this.myVerticalMovementResults.reset(),this.myTeleportResults.reset(),this.myCheckTransformResults.reset(),this.myWallSlideResults.reset(),this.myGroundInfo.reset(),this.myCeilingInfo.reset(),this.myGroundResults.reset(),this.myCeilingResults.reset(),this.mySplitMovementResults.reset(),this.myInternalResults.reset()};Ue.prototype.copy=function(e){this.myCheckType=e.myCheckType,this.myTransformResults.copy(e.myTransformResults),this.myMovementResults.copy(e.myMovementResults),this.myHorizontalMovementResults.copy(e.myHorizontalMovementResults),this.myVerticalMovementResults.copy(e.myVerticalMovementResults),this.myTeleportResults.copy(e.myTeleportResults),this.myCheckTransformResults.copy(e.myCheckTransformResults),this.myWallSlideResults.copy(e.myWallSlideResults),this.myGroundInfo.copy(e.myGroundInfo),this.myCeilingInfo.copy(e.myCeilingInfo),this.myGroundResults.copy(e.myGroundResults),this.myCeilingResults.copy(e.myCeilingResults),this.mySplitMovementResults.copy(e.mySplitMovementResults),this.myInternalResults.copy(e.myInternalResults)};$n.prototype.reset=function(){this.myOnSurface=!1,this.mySurfaceAngle=0,this.mySurfacePerceivedAngle=0,this.mySurfaceNormal.vec3_zero(),this.mySurfaceHitMaxAngle=0,this.mySurfaceHitMaxNormal.vec3_zero(),this.mySurfaceDistance=null,this.myBaseInsideCollision=!1};$n.prototype.copy=function(e){this.myOnSurface=e.myOnSurface,this.mySurfaceAngle=e.mySurfaceAngle,this.mySurfacePerceivedAngle=e.mySurfacePerceivedAngle,this.mySurfaceNormal.vec3_copy(e.mySurfaceNormal),this.mySurfaceHitMaxAngle=e.mySurfaceHitMaxAngle,this.mySurfaceHitMaxNormal.vec3_copy(e.mySurfaceHitMaxNormal),this.mySurfaceDistance=e.mySurfaceDistance,this.myBaseInsideCollision=e.myBaseInsideCollision};wo.prototype.reset=function(){this.myHasSlid=!1,this.mySlideMovementAngle=0,this.mySlideMovementWallAngle=0,this.myWallNormal.vec3_zero()};wo.prototype.copy=function(e){this.myHasSlid=e.myHasSlid,this.mySlideMovementAngle=e.mySlideMovementAngle,this.mySlideMovementWallAngle=e.mySlideMovementWallAngle,this.myWallNormal.vec3_copy(e.myWallNormal)};jo.prototype.reset=function(){this.myInitialTransformQuat.quat2_identity(),this.myFinalTransformQuat.quat2_identity()};jo.prototype.copy=function(e){this.myInitialTransformQuat.quat2_copy(e.myInitialTransformQuat),this.myFinalTransformQuat.quat2_copy(e.myFinalTransformQuat)};Ui.prototype.reset=function(){this.myInitialMovement.vec3_zero(),this.myFinalMovement.vec3_zero(),this.myMovementFailed=!1,this.myMovementCollided=!1,this.myReferenceCollisionHit.reset()};Ui.prototype.copy=function(e){this.myInitialMovement.vec3_copy(e.myInitialMovement),this.myFinalMovement.vec3_copy(e.myFinalMovement),this.myMovementFailed=e.myMovementFailed,this.myMovementCollided=e.myMovementCollided,this.myReferenceCollisionHit.copy(e.myReferenceCollisionHit)};zo.prototype.reset=function(){this.myInitialTeleportTransformQuat.quat2_identity(),this.myFinalTeleportTransformQuat.quat2_identity(),this.myTeleportFailed=!1};zo.prototype.copy=function(e){this.myInitialTeleportTransformQuat.quat2_copy(e.myInitialTeleportTransformQuat),this.myFinalTeleportTransformQuat.quat2_copy(e.myFinalTeleportTransformQuat),this.myTeleportFailed=e.myTeleportFailed};No.prototype.reset=function(){this.myInitialCheckTransformQuat.quat2_identity(),this.myFinalCheckTransformQuat.quat2_identity(),this.myCheckTransformFailed=!1};No.prototype.copy=function(e){this.myInitialCheckTransformQuat.quat2_copy(e.myInitialCheckTransformQuat),this.myFinalCheckTransformQuat.quat2_copy(e.myFinalCheckTransformQuat),this.myCheckTransformFailed=e.myCheckTransformFailed};eo.prototype.reset=function(){this.myHasSnappedOnSurface=!1,this.myHasPoppedOutSurface=!1,this.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleDownhill=!1,this.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleUphill=!1,this.myHasVerticalMovementAdjustedHorizontalMovementOverSurfaceAngleDownhill=!1};eo.prototype.copy=function(e){this.myHasSnappedOnSurface=e.myHasSnappedOnSurface,this.myHasPoppedOutSurface=e.myHasPoppedOutSurface,this.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleDownhill=e.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleDownhill,this.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleUphill=e.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleUphill,this.myHasVerticalMovementAdjustedHorizontalMovementOverSurfaceAngleDownhill=e.myHasVerticalMovementAdjustedHorizontalMovementOverSurfaceAngleDownhill};Go.prototype.reset=function(){this.myStepsToPerform=0,this.myStepsPerformed=0,this.myMovementInterrupted=!1,this.myMovementChecked.vec3_zero()};Go.prototype.copy=function(e){this.myStepsToPerform=e.myStepsToPerform,this.myStepsPerformed=e.myStepsPerformed,this.myMovementInterrupted=e.myMovementInterrupted,this.myMovementChecked.vec3_copy(e.myMovementChecked)};Wo.prototype.reset=function(){this._myRaycastsPerformed=0};Wo.prototype.copy=function(e){this._myRaycastsPerformed=e._myRaycastsPerformed};Uo.prototype.reset=function(){};Uo.prototype.copy=function(e){this.myLastRelevantInitialHorizontalMovement.vec3_copy(e.myLastRelevantInitialHorizontalMovement),this.myLastRelevantAdjustedInitialHorizontalMovement.vec3_copy(e.myLastRelevantAdjustedInitialHorizontalMovement),this.myLastRelevantFinalHorizontalMovement.vec3_copy(e.myLastRelevantFinalHorizontalMovement),this.myLastRelevantInitialVerticalMovement.vec3_copy(e.myLastRelevantInitialVerticalMovement),this.myLastRelevantAdjustedInitialVerticalMovement.vec3_copy(e.myLastRelevantAdjustedInitialVerticalMovement),this.myLastRelevantFinalVerticalMovement.vec3_copy(e.myLastRelevantFinalVerticalMovement),this.myLastRelevantHasWallSlid=e.myLastRelevantHasWallSlid,this.myHasWallSlidTowardOppositeDirection=e.myHasWallSlidTowardOppositeDirection,this.myLastRelevantWallSlideFlickerPrevented=e.myLastRelevantWallSlideFlickerPrevented,this.myWallSlideFlickerPreventionForceCheckCounter=e.myWallSlideFlickerPreventionForceCheckCounter,this.myWallSlide90DegreesDirectionSign=e.myWallSlide90DegreesDirectionSign,this.myWallSlide90DegreesRecomputeDirectionSign=e.myWallSlide90DegreesRecomputeDirectionSign};var im=new WeakMap;function HC(i=r.getMainEngine()){return im.get(i)}function kC(i,e=r.getMainEngine()){im.set(e,i)}function FC(i=r.getMainEngine()){im.has(i)||q.setCollisionCheck(new G(i),i)}var wC=function(){let i=new st,e=new _e;return function(n,o,s,a,l=new Ue,u=r.getMainEngine()){q.convertCharacterColliderSetupToCollisionCheckParams(s,i),q.convertCharacterCollisionResultsToCollisionRuntimeParams(a,e),q.getCollisionCheck(u).move(n,o,i,e),q.convertCollisionRuntimeParamsToCharacterCollisionResults(e,o,l)}}(),jC=function(){let i=c(),e=new st,t=new _e;return function(o,s,a,l,u=new Ue,_=r.getMainEngine()){q.convertCharacterColliderSetupToCollisionCheckParams(a,e),q.convertCharacterCollisionResultsToCollisionRuntimeParams(l,t),i=o.quat2_getPosition(i),q.getCollisionCheck(_).teleport(i,o,e,t),q.convertCollisionRuntimeParamsToCharacterCollisionResults(t,s,u)}}(),zC=function(){let i=new st,e=new _e;return function(n,o,s,a=new Ue,l=r.getMainEngine()){q.convertCharacterColliderSetupToCollisionCheckParams(o,i),q.convertCharacterCollisionResultsToCollisionRuntimeParams(s,e),q.getCollisionCheck(l).positionCheck(!0,n,i,e),q.convertCollisionRuntimeParamsToCharacterCollisionResults(e,n,a)}}(),NC=function(){let i=new st,e=new _e;return function(n,o,s,a=new Ue,l=r.getMainEngine()){q.convertCharacterColliderSetupToCollisionCheckParams(o,i),q.convertCharacterCollisionResultsToCollisionRuntimeParams(s,e),i.myComputeCeilingInfoEnabled=!1,q.getCollisionCheck(l).updateSurfaceInfo(n,i,e),q.convertCollisionRuntimeParamsToCharacterCollisionResults(e,n,a)}}(),GC=function(){let i=new st,e=new _e;return function(n,o,s,a=new Ue,l=r.getMainEngine()){q.convertCharacterColliderSetupToCollisionCheckParams(o,i),q.convertCharacterCollisionResultsToCollisionRuntimeParams(s,e),i.myComputeGroundInfoEnabled=!1,q.getCollisionCheck(l).updateSurfaceInfo(n,i,e),q.convertCollisionRuntimeParamsToCharacterCollisionResults(e,n,a)}}();function WC(i,e){return e.reset(),i.myTransformResults.myInitialTransformQuat.quat2_getPosition(e.myOriginalPosition),i.myTransformResults.myFinalTransformQuat.quat2_getPosition(e.myNewPosition),i.myTransformResults.myInitialTransformQuat.quat2_getForward(e.myOriginalForward),i.myTransformResults.myInitialTransformQuat.quat2_getUp(e.myOriginalUp),e.myOriginalMovement.vec3_copy(i.myMovementResults.myInitialMovement),e.myFixedMovement.vec3_copy(i.myMovementResults.myFinalMovement),e.myLastValidOriginalHorizontalMovement.vec3_copy(i.myInternalResults.myLastRelevantInitialHorizontalMovement),e.myLastValidOriginalVerticalMovement.vec3_copy(i.myInternalResults.myLastRelevantInitialVerticalMovement),e.myLastValidEndHorizontalMovement.vec3_copy(i.myInternalResults.myLastRelevantFinalHorizontalMovement),e.myLastValidEndVerticalMovement.vec3_copy(i.myInternalResults.myLastRelevantFinalVerticalMovement),e.myLastValidSurfaceAdjustedHorizontalMovement.vec3_copy(i.myInternalResults.myLastRelevantAdjustedInitialHorizontalMovement),e.myLastValidSurfaceAdjustedVerticalMovement.vec3_copy(i.myInternalResults.myLastRelevantAdjustedInitialVerticalMovement),e.myIsOnGround=i.myGroundInfo.myOnSurface,e.myGroundAngle=i.myGroundInfo.mySurfaceAngle,e.myGroundPerceivedAngle=i.myGroundInfo.mySurfacePerceivedAngle,e.myGroundNormal.vec3_copy(i.myGroundInfo.mySurfaceNormal),e.myGroundHitMaxAngle=i.myGroundInfo.mySurfaceHitMaxAngle,e.myGroundHitMaxNormal.vec3_copy(i.myGroundInfo.mySurfaceHitMaxNormal),e.myGroundDistance=i.myGroundInfo.mySurfaceDistance,e.myGroundIsBaseInsideCollision=i.myGroundInfo.myBaseInsideCollision,e.myIsOnCeiling=i.myCeilingInfo.myOnSurface,e.myCeilingAngle=i.myCeilingInfo.mySurfaceAngle,e.myCeilingPerceivedAngle=i.myCeilingInfo.mySurfacePerceivedAngle,e.myCeilingNormal.vec3_copy(i.myCeilingInfo.mySurfaceNormal),e.myCeilingHitMaxAngle=i.myCeilingInfo.mySurfaceHitMaxAngle,e.myCeilingHitMaxNormal.vec3_copy(i.myCeilingInfo.mySurfaceHitMaxNormal),e.myCeilingDistance=i.myCeilingInfo.mySurfaceDistance,e.myCeilingIsBaseInsideCollision=i.myCeilingInfo.myBaseInsideCollision,e.myHorizontalMovementCanceled=i.myHorizontalMovementResults.myMovementFailed,e.myIsCollidingHorizontally=i.myHorizontalMovementResults.myMovementCollided,e.myHorizontalCollisionHit.copy(i.myHorizontalMovementResults.myReferenceCollisionHit),e.myVerticalMovementCanceled=i.myVerticalMovementResults.myMovementFailed,e.myIsCollidingVertically=i.myVerticalMovementResults.myMovementCollided,e.myVerticalCollisionHit.copy(i.myVerticalMovementResults.myReferenceCollisionHit),e.myHasSnappedOnGround=i.myGroundResults.myHasSnappedOnSurface,e.myHasSnappedOnCeiling=i.myCeilingResults.myHasSnappedOnSurface,e.myHasPoppedOutGround=i.myGroundResults.myHasPoppedOutSurface,e.myHasPoppedOutCeiling=i.myCeilingResults.myHasPoppedOutSurface,e.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleDownhill=i.myGroundResults.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleDownhill,e.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleUphill=i.myGroundResults.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleUphill,e.myVerticalMovementHasAdjustedHorizontalMovementOverGroundAngleDownhill=i.myGroundResults.myHasVerticalMovementAdjustedHorizontalMovementOverSurfaceAngleDownhill,e.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleDownhill=i.myCeilingResults.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleDownhill,e.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleUphill=i.myCeilingResults.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleUphill,e.myVerticalMovementHasAdjustedHorizontalMovementOverCeilingAngleDownhill=i.myCeilingResults.myHasVerticalMovementAdjustedHorizontalMovementOverSurfaceAngleDownhill,e.myIsSliding=i.myWallSlideResults.myHasSlid,e.mySlidingMovementAngle=i.myWallSlideResults.mySlideMovementAngle,e.mySlidingCollisionAngle=i.myWallSlideResults.mySlideMovementWallAngle,e.mySlidingWallNormal.vec3_copy(i.myWallSlideResults.myWallNormal),e.myIsSlidingIntoOppositeDirection=i.myInternalResults.myHasWallSlidTowardOppositeDirection,e.myIsSlidingFlickerPrevented=i.myInternalResults.myLastRelevantWallSlideFlickerPrevented,e.mySlidingFlickerPreventionCheckAnywayCounter=i.myInternalResults.myWallSlideFlickerPreventionForceCheckCounter,e.mySliding90DegreesSign=i.myInternalResults.myWallSlide90DegreesDirectionSign,e.mySlidingRecompute90DegreesSign=i.myInternalResults.myWallSlide90DegreesRecomputeDirectionSign,e.myLastValidIsSliding=i.myInternalResults.myLastRelevantHasWallSlid,e.mySlidingPreviousHorizontalMovement.vec3_copy(i.myInternalResults.myLastRelevantFinalHorizontalMovement),e.myOriginalTeleportPosition.vec3_copy(i.myTeleportResults.myInitialTeleportTransformQuat),e.myFixedTeleportPosition.vec3_copy(i.myTeleportResults.myFinalTeleportTransformQuat),e.myTeleportCanceled=i.myTeleportResults.myTeleportFailed,e.myIsPositionOk=i.myCheckTransformResults.myCheckTransformFailed,i.myCheckTransformResults.myInitialCheckTransformQuat.quat2_getPosition(e.myOriginalPositionCheckPosition),i.myCheckTransformResults.myFinalCheckTransformQuat.quat2_getPosition(e.myFixedPositionCheckPosition),e.myIsTeleport=i.myCheckType==Qi.CHECK_TELEPORT,e.myIsMove=i.myCheckType==Qi.CHECK_MOVEMENT,e.myIsPositionCheck=i.myCheckType==Qi.CHECK_TRANSFORM,e.mySplitMovementSteps=i.mySplitMovementResults.myStepsToPerform,e.mySplitMovementStepsPerformed=i.mySplitMovementResults.myStepsPerformed,e.mySplitMovementStop=i.mySplitMovementResults.myMovementInterrupted,e.mySplitMovementMovementChecked.vec3_copy(i.mySplitMovementResults.myMovementChecked),e}var UC=function(){let i=j();return function(t,n,o){return o.reset(),t.myIsMove?o.myCheckType=Qi.CHECK_MOVEMENT:t.myIsTeleport?o.myCheckType=Qi.CHECK_TELEPORT:t.myIsPositionCheck&&(o.myCheckType=Qi.CHECK_TRANSFORM),i.quat_setForward(t.myOriginalForward,t.myOriginalUp),o.myTransformResults.myInitialTransformQuat.quat2_setPositionRotationQuat(t.myOriginalPosition,i),o.myTransformResults.myFinalTransformQuat.quat2_setPositionRotationQuat(t.myNewPosition,i),o.myMovementResults.myInitialMovement.vec3_copy(t.myOriginalMovement),o.myMovementResults.myFinalMovement.vec3_copy(t.myFixedMovement),o.myMovementResults.myMovementFailed=t.myHorizontalMovementCanceled&&t.myVerticalMovementCanceled,o.myMovementResults.myMovementCollided=t.myIsCollidingHorizontally||t.myIsCollidingVertically,t.myIsCollidingHorizontally?o.myMovementResults.myReferenceCollisionHit.copy(t.myHorizontalCollisionHit):t.myIsCollidingVertically&&o.myMovementResults.myReferenceCollisionHit.copy(t.myVerticalCollisionHit),o.myHorizontalMovementResults.myMovementFailed=t.myHorizontalMovementCanceled,o.myHorizontalMovementResults.myMovementCollided=t.myIsCollidingHorizontally,o.myHorizontalMovementResults.myReferenceCollisionHit.copy(t.myHorizontalCollisionHit),o.myHorizontalMovementResults.myInitialMovement=t.myOriginalMovement.vec3_removeComponentAlongAxis(t.myOffsetUp,o.myHorizontalMovementResults.myInitialMovement),o.myHorizontalMovementResults.myFinalMovement=t.myFixedMovement.vec3_removeComponentAlongAxis(t.myOffsetUp,o.myHorizontalMovementResults.myFinalMovement),o.myVerticalMovementResults.myMovementFailed=t.myVerticalMovementCanceled,o.myVerticalMovementResults.myMovementCollided=t.myIsCollidingVertically,o.myVerticalMovementResults.myReferenceCollisionHit.copy(t.myVerticalCollisionHit),o.myVerticalMovementResults.myInitialMovement=t.myOriginalMovement.vec3_componentAlongAxis(t.myOffsetUp,o.myVerticalMovementResults.myInitialMovement),o.myVerticalMovementResults.myFinalMovement=t.myFixedMovement.vec3_componentAlongAxis(t.myOffsetUp,o.myVerticalMovementResults.myFinalMovement),o.myTeleportResults.myInitialTeleportTransformQuat.quat2_copy(o.myTransformResults.myInitialTransformQuat),o.myTeleportResults.myInitialTeleportTransformQuat.quat2_setPosition(t.myOriginalTeleportPosition),o.myTeleportResults.myFinalTeleportTransformQuat.quat2_copy(o.myTransformResults.myFinalTransformQuat),o.myTeleportResults.myFinalTeleportTransformQuat.quat2_setPosition(t.myFixedTeleportPosition),o.myTeleportResults.myTeleportFailed=t.myTeleportCanceled,o.myCheckTransformResults.myInitialCheckTransformQuat.quat2_copy(o.myTransformResults.myInitialTransformQuat),o.myCheckTransformResults.myInitialCheckTransformQuat.quat2_setPosition(t.myOriginalPositionCheckPosition),o.myCheckTransformResults.myFinalCheckTransformQuat.quat2_copy(o.myTransformResults.myFinalTransformQuat),o.myCheckTransformResults.myFinalCheckTransformQuat.quat2_setPosition(t.myFixedPositionCheckPosition),o.myCheckTransformResults.myCheckTransformFailed=!t.myIsPositionOk,o.myWallSlideResults.myHasSlid=t.myIsSliding,o.myWallSlideResults.mySlideMovementAngle=t.mySlidingMovementAngle,o.myWallSlideResults.mySlideMovementWallAngle=t.mySlidingCollisionAngle,o.myWallSlideResults.myWallNormal.vec3_copy(t.mySlidingWallNormal),o.myGroundInfo.myOnSurface=t.myIsOnGround,o.myGroundInfo.mySurfaceAngle=t.myGroundAngle,o.myGroundInfo.mySurfacePerceivedAngle=t.myGroundPerceivedAngle,o.myGroundInfo.mySurfaceNormal.vec3_copy(t.myGroundNormal),o.myGroundInfo.mySurfaceHitMaxAngle=t.myGroundHitMaxAngle,o.myGroundInfo.mySurfaceHitMaxNormal.vec3_copy(t.myGroundHitMaxNormal),o.myGroundInfo.mySurfaceDistance=t.myGroundDistance,o.myGroundInfo.myBaseInsideCollision=t.myGroundIsBaseInsideCollision,o.myCeilingInfo.myOnSurface=t.myIsOnCeiling,o.myCeilingInfo.mySurfaceAngle=t.myCeilingAngle,o.myCeilingInfo.mySurfacePerceivedAngle=t.myCeilingPerceivedAngle,o.myCeilingInfo.mySurfaceNormal.vec3_copy(t.myCeilingNormal),o.myCeilingInfo.mySurfaceHitMaxAngle=t.myCeilingHitMaxAngle,o.myCeilingInfo.mySurfaceHitMaxNormal.vec3_copy(t.myCeilingHitMaxNormal),o.myCeilingInfo.mySurfaceDistance=t.myCeilingDistance,o.myCeilingInfo.myBaseInsideCollision=t.myCeilingIsBaseInsideCollision,o.myGroundResults.myHasSnappedOnSurface=t.myHasSnappedOnGround,o.myGroundResults.myHasPoppedOutSurface=t.myHasPoppedOutGround,o.myCeilingResults.myHasSnappedOnSurface=t.myHasSnappedOnCeiling,o.myCeilingResults.myHasPoppedOutSurface=t.myHasPoppedOutCeiling,o.myGroundResults.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleDownhill=t.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleDownhill,o.myGroundResults.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleUphill=t.myHorizontalMovementHasAdjustedVerticalMovementOverGroundPerceivedAngleUphill,o.myGroundResults.myHasVerticalMovementAdjustedHorizontalMovementOverSurfaceAngleDownhill=t.myVerticalMovementHasAdjustedHorizontalMovementOverGroundAngleDownhill,o.myCeilingResults.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleDownhill=t.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleDownhill,o.myCeilingResults.myHasHorizontalMovementAdjustedVerticalMovementOverSurfacePerceivedAngleUphill=t.myHorizontalMovementHasAdjustedVerticalMovementOverCeilingPerceivedAngleUphill,o.myCeilingResults.myHasVerticalMovementAdjustedHorizontalMovementOverSurfaceAngleDownhill=t.myVerticalMovementHasAdjustedHorizontalMovementOverCeilingAngleDownhill,o.mySplitMovementResults.myStepsToPerform=t.mySplitMovementSteps,o.mySplitMovementResults.myStepsPerformed=t.mySplitMovementStepsPerformed,o.mySplitMovementResults.myMovementInterrupted=t.mySplitMovementStop,o.mySplitMovementResults.myMovementChecked.vec3_copy(t.mySplitMovementMovementChecked),o.myInternalResults.myLastRelevantInitialHorizontalMovement.vec3_copy(t.myLastValidOriginalHorizontalMovement),o.myInternalResults.myLastRelevantFinalHorizontalMovement.vec3_copy(t.myLastValidEndHorizontalMovement),o.myInternalResults.myLastRelevantInitialVerticalMovement.vec3_copy(t.myLastValidOriginalVerticalMovement),o.myInternalResults.myLastRelevantFinalVerticalMovement.vec3_copy(t.myLastValidEndVerticalMovement),o.myInternalResults.myLastRelevantAdjustedInitialHorizontalMovement.vec3_copy(t.myLastValidSurfaceAdjustedHorizontalMovement),o.myInternalResults.myLastRelevantAdjustedInitialVerticalMovement.vec3_copy(t.myLastValidSurfaceAdjustedVerticalMovement),o.myInternalResults.myLastRelevantHasWallSlid=t.myLastValidIsSliding,o.myInternalResults.myHasWallSlidTowardOppositeDirection=t.myIsSlidingIntoOppositeDirection,o.myInternalResults.myLastRelevantWallSlideFlickerPrevented=t.myIsSlidingFlickerPrevented,o.myInternalResults.myWallSlideFlickerPreventionForceCheckCounter=t.mySlidingFlickerPreventionCheckAnywayCounter,o.myInternalResults.myWallSlide90DegreesDirectionSign=t.mySliding90DegreesSign,o.myInternalResults.myWallSlide90DegreesRecomputeDirectionSign=t.mySlidingRecompute90DegreesSign,o.myTransformResults.myInitialTransformQuat.quat2_copy(n),o}}(),QC=function(){return function(e,t){return t.myHeight=e.myHeight,t.myRadius=e.myHorizontalCheckParams.myHorizontalCheckConeRadius,t.myDistanceFromFeetToIgnore=e.myHorizontalCheckParams.myHorizontalCheckFeetDistanceToIgnore,t.myDistanceFromHeadToIgnore=e.myHorizontalCheckParams.myHorizontalCheckHeadDistanceToIgnore,t.myHorizontalMovementCheckEnabled=e.myHorizontalCheckParams.myHorizontalMovementCheckEnabled,t.myHorizontalMovementStepEnabled=e.myHorizontalCheckParams.myHorizontalMovementCheckSplitMovementEnabled,t.myHorizontalMovementStepMaxLength=e.myHorizontalCheckParams.myHorizontalMovementCheckSplitMovementMaxStepLength,t.myHorizontalMovementRadialStepAmount=e.myHorizontalCheckParams.myHorizontalMovementCheckRadialSteps,t.myHorizontalMovementCheckDiagonalOutward=e.myHorizontalCheckParams.myHorizontalMovementHorizontalDiagonalOutwardCheckEnabled,t.myHorizontalMovementCheckDiagonalInward=e.myHorizontalCheckParams.myHorizontalMovementHorizontalDiagonalInwardCheckEnabled,t.myHorizontalMovementCheckStraight=e.myHorizontalCheckParams.myHorizontalMovementHorizontalStraightCheckEnabled,t.myHorizontalMovementCheckHorizontalBorder=e.myHorizontalCheckParams.myHorizontalMovementHorizontalRadialCheckEnabled,t.myHorizontalMovementCheckVerticalStraight=e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightCheckEnabled,t.myHorizontalMovementCheckVerticalDiagonalUpwardOutward=e.myHorizontalCheckParams.myHorizontalMovementVerticalDiagonalOutwardUpwardCheckEnabled,t.myHorizontalMovementCheckVerticalDiagonalUpwardInward=e.myHorizontalCheckParams.myHorizontalMovementVerticalDiagonalInwardUpwardCheckEnabled,t.myHorizontalMovementCheckVerticalDiagonalDownwardOutward=e.myHorizontalCheckParams.myHorizontalMovementVerticalDiagonalOutwardDownwardCheckEnabled,t.myHorizontalMovementCheckVerticalDiagonalDownwardInward=e.myHorizontalCheckParams.myHorizontalMovementVerticalDiagonalInwardDownwardCheckEnabled,t.myHorizontalMovementCheckVerticalStraightDiagonalUpward=e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalUpwardCheckEnabled,t.myHorizontalMovementCheckVerticalStraightDiagonalDownward=e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalDownwardCheckEnabled,t.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward=e.myHorizontalCheckParams.myHorizontalMovementVerticalRadialDiagonalOutwardCheckEnabled,t.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward=e.myHorizontalCheckParams.myHorizontalMovementVerticalRadialDiagonalInwardCheckEnabled,t.myHorizontalMovementHorizontalStraightCentralCheckEnabled=e.myHorizontalCheckParams.myHorizontalMovementHorizontalStraightCentralCheckEnabled,t.myHorizontalMovementVerticalStraightCentralCheckEnabled=e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightCentralCheckEnabled,t.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled,t.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled=e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled,t.myHorizontalPositionCheckEnabled=e.myHorizontalCheckParams.myHorizontalPositionCheckEnabled,t.myHalfConeAngle=e.myHorizontalCheckParams.myHorizontalCheckConeHalfAngle,t.myHalfConeSliceAmount=e.myHorizontalCheckParams.myHorizontalPositionCheckConeHalfSlices,t.myCheckConeBorder=e.myHorizontalCheckParams.myHorizontalPositionHorizontalBorderCheckEnabled,t.myCheckConeRay=e.myHorizontalCheckParams.myHorizontalPositionHorizontalRadialCheckEnabled,t.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision=e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckIgnoreHitsInsideCollision,t.myHorizontalPositionCheckVerticalDirectionType=e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckDirection,t.myCheckHeight=e.myHorizontalCheckParams.myHorizontalHeightCheckEnabled,t.myCheckHeightVerticalMovement=e.myHorizontalCheckParams.myHorizontalMovementHeightVerticalCheckEnabled,t.myCheckHeightVerticalPosition=e.myHorizontalCheckParams.myHorizontalPositionHeightVerticalCheckEnabled,t.myCheckHeightTopMovement=e.myHorizontalCheckParams.myHorizontalMovementHeightHorizontalCheckEnabled,t.myCheckHeightTopPosition=e.myHorizontalCheckParams.myHorizontalPositionHeightHorizontalCheckEnabled,t.myCheckHeightConeOnCollision=e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHit,t.myCheckHeightConeOnCollisionKeepHit=e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHitKeepVerticalHitIfNoHorizontalHit,t.myHeightCheckStepAmountMovement=e.myHorizontalCheckParams.myHorizontalMovementHeightCheckSteps,t.myHeightCheckStepAmountPosition=e.myHorizontalCheckParams.myHorizontalPositionHeightCheckSteps,t.myCheckVerticalStraight=e.myHorizontalCheckParams.myHorizontalPositionVerticalStraightCheckEnabled,t.myCheckVerticalDiagonalRayOutward=e.myHorizontalCheckParams.myHorizontalPositionVerticalRadialDiagonalOutwardCheckEnabled,t.myCheckVerticalDiagonalRayInward=e.myHorizontalCheckParams.myHorizontalPositionVerticalRadialDiagonalInwardCheckEnabled,t.myCheckVerticalDiagonalBorderOutward=e.myHorizontalCheckParams.myHorizontalPositionVerticalBorderDiagonalOutwardCheckEnabled,t.myCheckVerticalDiagonalBorderInward=e.myHorizontalCheckParams.myHorizontalPositionVerticalBorderDiagonalInwardCheckEnabled,t.myCheckVerticalDiagonalBorderRayOutward=e.myHorizontalCheckParams.myHorizontalPositionVerticalRadialBorderDiagonalOutwardCheckEnabled,t.myCheckVerticalDiagonalBorderRayInward=e.myHorizontalCheckParams.myHorizontalPositionVerticalRadialBorderDiagonalInwardCheckEnabled,t.myCheckVerticalSearchFartherVerticalHit=e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckGetFarthestHit,t.myCheckHorizontalFixedForwardEnabled=e.myHorizontalCheckParams.myHorizontalCheckFixedForwardEnabled,t.myCheckHorizontalFixedForward.vec3_copy(e.myHorizontalCheckParams.myHorizontalCheckFixedForward),t.myVerticalMovementCheckEnabled=e.myVerticalCheckParams.myVerticalMovementCheckEnabled,t.myVerticalPositionCheckEnabled=e.myVerticalCheckParams.myVerticalPositionCheckEnabled,t.myFeetRadius=e.myVerticalCheckParams.myVerticalCheckCircumferenceRadius,t.myAdjustVerticalMovementWithGroundAngleDownhill=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhill,t.myAdjustVerticalMovementWithGroundAngleUphill=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphill,t.myAdjustVerticalMovementWithGroundAngleDownhillMaxAngle=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhillMaxSurfaceAngle,t.myAdjustVerticalMovementWithGroundAngleUphillMaxAngle=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphillMaxSurfaceAngle,t.myAdjustVerticalMovementWithGroundAngleDownhillMaxPerceivedAngle=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhillMaxSurfacePerceivedAngle,t.myAdjustVerticalMovementWithGroundAngleUphillMaxPerceivedAngle=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphillMaxSurfacePerceivedAngle,t.myAdjustHorizontalMovementWithGroundAngleDownhill=e.myGroundParams.myVerticalMovementAdjustHorizontalMovementOverSurfaceAngleDownhill,t.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle=e.myGroundParams.myVerticalMovementAdjustHorizontalMovementOverSurfaceAngleDownhillMinSurfaceAngle,t.myAdjustVerticalMovementWithCeilingAngleDownhill=e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhill,t.myAdjustVerticalMovementWithCeilingAngleUphill=e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphill,t.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle=e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhillMaxSurfaceAngle,t.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle=e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphillMaxSurfaceAngle,t.myAdjustVerticalMovementWithCeilingAngleDownhillMaxPerceivedAngle=e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhillMaxSurfacePerceivedAngle,t.myAdjustVerticalMovementWithCeilingAngleUphillMaxPerceivedAngle=e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphillMaxSurfacePerceivedAngle,t.myAdjustHorizontalMovementWithCeilingAngleDownhill=e.myCeilingParams.myVerticalMovementAdjustHorizontalMovementOverSurfaceAngleDownhill,t.myAdjustHorizontalMovementWithCeilingAngleDownhillMinAngle=e.myCeilingParams.myVerticalMovementAdjustHorizontalMovementOverSurfaceAngleDownhillMinSurfaceAngle,t.myCheckVerticalFixedForwardEnabled=e.myVerticalCheckParams.myVerticalCheckFixedForwardEnabled,t.myCheckVerticalFixedForward.vec3_copy(e.myVerticalCheckParams.myVerticalCheckFixedForward),t.myCheckVerticalBothDirection=e.myVerticalCheckParams.myVerticalMovementCheckPerformCheckOnBothSides,t.myVerticalMovementReduceEnabled=e.myVerticalCheckParams.myVerticalMovementCheckReductionEnabled,t.myGroundCircumferenceAddCenter=e.myVerticalCheckParams.myVerticalCheckCircumferenceCentralCheckEnabled,t.myGroundCircumferenceSliceAmount=e.myVerticalCheckParams.myVerticalCheckCircumferenceSlices,t.myGroundCircumferenceStepAmount=e.myVerticalCheckParams.myVerticalCheckCircumferenceRadialSteps,t.myGroundCircumferenceRotationPerStep=e.myVerticalCheckParams.myVerticalCheckCircumferenceRotationPerRadialStep,t.myVerticalAllowHitInsideCollisionIfOneOk=e.myVerticalCheckParams.myVerticalCheckAllowHitsInsideCollisionIfOneValid,t.myHorizontalBlockLayerFlags.copy(e.myHorizontalCheckParams.myHorizontalCheckBlockLayerFlags),t.myVerticalBlockLayerFlags.copy(e.myVerticalCheckParams.myVerticalCheckBlockLayerFlags),t.myHorizontalObjectsToIgnore.pp_copy(e.myHorizontalCheckParams.myHorizontalCheckObjectsToIgnore),t.myVerticalObjectsToIgnore.pp_copy(e.myVerticalCheckParams.myVerticalCheckObjectsToIgnore),t.mySnapOnGroundEnabled=e.myGroundParams.mySurfaceSnapEnabled,t.mySnapOnGroundExtraDistance=e.myGroundParams.mySurfaceSnapMaxDistance,t.mySnapOnCeilingEnabled=e.myCeilingParams.mySurfaceSnapEnabled,t.mySnapOnCeilingExtraDistance=e.myCeilingParams.mySurfaceSnapMaxDistance,t.myGroundPopOutEnabled=e.myGroundParams.mySurfacePopOutEnabled,t.myGroundPopOutExtraDistance=e.myGroundParams.mySurfacePopOutMaxDistance,t.myCeilingPopOutEnabled=e.myCeilingParams.mySurfacePopOutEnabled,t.myCeilingPopOutExtraDistance=e.myCeilingParams.mySurfacePopOutMaxDistance,t.myGroundAngleToIgnore=e.myGroundParams.mySurfaceAngleToIgnore,t.myGroundAngleToIgnoreWithPerceivedAngle=e.myGroundParams.mySurfaceAngleToIgnoreWithSurfacePerceivedAngle,t.myCeilingAngleToIgnore=e.myCeilingParams.mySurfaceAngleToIgnore,t.myCeilingAngleToIgnoreWithPerceivedAngle=e.myCeilingParams.mySurfaceAngleToIgnoreWithSurfacePerceivedAngle,t.myHorizontalMovementGroundAngleIgnoreHeight=e.myGroundParams.myHorizontalMovementSurfaceAngleToIgnoreMaxVerticalDistance,t.myHorizontalMovementCeilingAngleIgnoreHeight=e.myCeilingParams.myHorizontalMovementSurfaceAngleToIgnoreMaxVerticalDistance,t.myHorizontalPositionGroundAngleIgnoreHeight=e.myGroundParams.myHorizontalPositionSurfaceAngleToIgnoreMaxVerticalDistance,t.myHorizontalPositionCeilingAngleIgnoreHeight=e.myCeilingParams.myHorizontalPositionSurfaceAngleToIgnoreMaxVerticalDistance,t.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft=e.myGroundParams.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft,t.myHorizontalMovementCeilingAngleIgnoreMaxMovementLeft=e.myCeilingParams.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft,t.myComputeGroundInfoEnabled=e.myGroundParams.myCollectSurfaceInfo,t.myComputeCeilingInfoEnabled=e.myCeilingParams.myCollectSurfaceInfo,t.myDistanceToBeOnGround=e.myGroundParams.myOnSurfaceMaxOutsideDistance,t.myDistanceToComputeGroundInfo=e.myGroundParams.myCollectSurfaceNormalMaxOutsideDistance,t.myDistanceToBeOnCeiling=e.myCeilingParams.myOnSurfaceMaxOutsideDistance,t.myDistanceToComputeCeilingInfo=e.myCeilingParams.myCollectSurfaceNormalMaxOutsideDistance,t.myVerticalFixToBeOnGround=e.myGroundParams.myOnSurfaceMaxInsideDistance,t.myVerticalFixToComputeGroundInfo=e.myGroundParams.myCollectSurfaceNormalMaxInsideDistance,t.myVerticalFixToBeOnCeiling=e.myCeilingParams.myOnSurfaceMaxInsideDistance,t.myVerticalFixToComputeCeilingInfo=e.myCeilingParams.myCollectSurfaceNormalMaxInsideDistance,t.myGroundIsBaseInsideCollisionCheckEnabled=e.myGroundParams.myBaseInsideCollisionCheckEnabled,t.myCeilingIsBaseInsideCollisionCheckEnabled=e.myCeilingParams.myBaseInsideCollisionCheckEnabled,t.myIsOnGroundIfInsideHit=e.myGroundParams.myOnSurfaceIfBaseInsideCollision,t.myIsOnCeilingIfInsideHit=e.myCeilingParams.myOnSurfaceIfBaseInsideCollision,t.myFindGroundDistanceMaxOutsideDistance=e.myGroundParams.myFindSurfaceDistanceMaxOutsideDistance,t.myFindGroundDistanceMaxInsideDistance=e.myGroundParams.myFindSurfaceDistanceMaxInsideDistance,t.myFindCeilingDistanceMaxOutsideDistance=e.myCeilingParams.myFindSurfaceDistanceMaxOutsideDistance,t.myFindCeilingDistanceMaxInsideDistance=e.myCeilingParams.myFindSurfaceDistanceMaxInsideDistance,t.myAllowGroundSteepFix=e.myGroundParams.myHorizontalMovementAllowExitAttemptWhenOnNotIgnorableSurfacePerceivedAngle,t.myAllowCeilingSteepFix=e.myCeilingParams.myHorizontalMovementAllowExitAttemptWhenOnNotIgnorableSurfacePerceivedAngle,t.myMustStayOnGround=e.myGroundParams.myMovementMustStayOnSurface,t.myMustStayOnCeiling=e.myCeilingParams.myMovementMustStayOnSurface,t.myRegatherGroundInfoOnSurfaceCheckFail=e.myGroundParams.myRecollectSurfaceInfoOnSurfaceCheckFailed,t.myRegatherCeilingInfoOnSurfaceCheckFail=e.myCeilingParams.myRecollectSurfaceInfoOnSurfaceCheckFailed,t.myMustStayBelowIgnorableGroundAngleDownhill=e.myGroundParams.myMovementMustStayOnIgnorableSurfaceAngleDownhill,t.myMustStayBelowIgnorableCeilingAngleDownhill=e.myCeilingParams.myMovementMustStayOnIgnorableSurfaceAngleDownhill,t.myMustStayBelowGroundAngleDownhill=e.myGroundParams.myMovementMustStayOnSurfaceAngleDownhill,t.myMustStayBelowCeilingAngleDownhill=e.myCeilingParams.myMovementMustStayOnSurfaceAngleDownhill,t.myMovementMustStayOnGroundHitAngle=e.myGroundParams.myMovementMustStayOnSurfaceHitMaxAngle,t.myMovementMustStayOnCeilingHitAngle=e.myCeilingParams.myMovementMustStayOnSurfaceHitMaxAngle,t.myTeleportMustBeOnIgnorableGroundAngle=e.myGroundParams.myTeleportMustBeOnIgnorableSurfaceAngle,t.myCheckTransformMustBeOnIgnorableGroundAngle=e.myGroundParams.myCheckTransformMustBeOnIgnorableSurfaceAngle,t.myTeleportMustBeOnIgnorableCeilingAngle=e.myCeilingParams.myTeleportMustBeOnIgnorableSurfaceAngle,t.myCheckTransformMustBeOnIgnorableCeilingAngle=e.myCeilingParams.myCheckTransformMustBeOnIgnorableSurfaceAngle,t.myTeleportMustBeOnGroundAngle=e.myGroundParams.myTeleportMustBeOnSurfaceAngle,t.myCheckTransformMustBeOnGroundAngle=e.myGroundParams.myCheckTransformMustBeOnSurfaceAngle,t.myTeleportMustBeOnCeilingAngle=e.myCeilingParams.myTeleportMustBeOnSurfaceAngle,t.myCheckTransformMustBeOnCeilingAngle=e.myCeilingParams.myCheckTransformMustBeOnSurfaceAngle,t.myTeleportMustBeOnGround=e.myGroundParams.myTeleportMustBeOnSurface,t.myCheckTransformMustBeOnGround=e.myGroundParams.myCheckTransformMustBeOnSurface,t.myTeleportMustBeOnCeiling=e.myCeilingParams.myTeleportMustBeOnSurface,t.myCheckTransformMustBeOnCeiling=e.myCeilingParams.myCheckTransformMustBeOnSurface,t.mySlidingEnabled=e.myWallSlideParams.myWallSlideEnabled,t.mySlidingHorizontalMovementCheckBetterNormal=e.myHorizontalCheckParams.myHorizontalMovementCheckGetBetterReferenceHit,t.mySlidingMaxAttempts=e.myWallSlideParams.myWallSlideMaxAttempts,t.mySlidingCheckBothDirections=e.myWallSlideParams.myCheckBothWallSlideDirections,t.mySlidingFlickeringPreventionType=e.myWallSlideParams.myWallSlideFlickerPreventionMode,t.mySlidingFlickeringPreventionCheckOnlyIfAlreadySliding=e.myWallSlideParams.myWallSlideFlickerPreventionCheckOnlyIfAlreadySliding,t.mySlidingFlickerPreventionCheckAnywayCounter=e.myWallSlideParams.myWallSlideFlickerPreventionForceCheckCounter,t.mySlidingAdjustSign90Degrees=e.myWallSlideParams.my90DegreesWallSlideAdjustDirectionSign,t.mySplitMovementEnabled=e.mySplitMovementParams.mySplitMovementEnabled,t.mySplitMovementMaxLength=e.mySplitMovementParams.mySplitMovementMaxStepLength,t.mySplitMovementMaxStepsEnabled=e.mySplitMovementParams.mySplitMovementMaxSteps!=null,t.mySplitMovementMaxSteps=e.mySplitMovementParams.mySplitMovementMaxSteps,t.mySplitMovementStepEqualLength=e.mySplitMovementParams.mySplitMovementMaxStepLength==null,t.mySplitMovementStepEqualLengthMinLength=e.mySplitMovementParams.mySplitMovementMinStepLength,t.mySplitMovementStopWhenHorizontalMovementCanceled=e.mySplitMovementParams.mySplitMovementStopOnHorizontalMovementFailed,t.mySplitMovementStopWhenVerticalMovementCanceled=e.mySplitMovementParams.mySplitMovementStopOnVerticalMovementFailed,t.mySplitMovementStopCallback=e.mySplitMovementParams.mySplitMovementStopOnCallback,t.mySplitMovementStopReturnPrevious=e.mySplitMovementParams.mySplitMovementStopReturnPreviousResults,t.myPositionOffsetLocal.vec3_copy(e.myAdditionalParams.myPositionOffsetLocal),t.myRotationOffsetLocalQuat.quat_copy(e.myAdditionalParams.myRotationOffsetLocalQuat),t.myDebugEnabled=e.myDebugParams.myVisualDebugEnabled,t.myDebugHorizontalMovementEnabled=e.myDebugParams.myVisualDebugHorizontalMovementCheckEnabled,t.myDebugHorizontalPositionEnabled=e.myDebugParams.myVisualDebugHorizontalPositionCheckEnabled,t.myDebugVerticalMovementEnabled=e.myDebugParams.myVisualDebugVerticalMovementCheckEnabled,t.myDebugVerticalPositionEnabled=e.myDebugParams.myVisualDebugVerticalPositionCheckEnabled,t.myDebugSlidingEnabled=e.myDebugParams.myVisualDebugSlideEnabled,t.myDebugGroundInfoEnabled=e.myDebugParams.myVisualDebugGroundInfoEnabled,t.myDebugCeilingInfoEnabled=e.myDebugParams.myVisualDebugGroundInfoEnabled,t.myDebugRuntimeParamsEnabled=e.myDebugParams.myVisualDebugResultsEnabled,t.myDebugMovementEnabled=e.myDebugParams.myVisualDebugMovementEnabled,t}}(),q={getCollisionCheck:HC,setCollisionCheck:kC,initBridge:FC,checkMovement:wC,checkTeleportToTransform:jC,checkTransform:zC,updateGroundInfo:NC,updateCeilingInfo:GC,convertCharacterCollisionResultsToCollisionRuntimeParams:WC,convertCollisionRuntimeParamsToCharacterCollisionResults:UC,convertCharacterColliderSetupToCollisionCheckParams:QC};var to=class{constructor(){this.myHeight=0,this.myHorizontalCheckParams=new Bs,this.myVerticalCheckParams=new Ls,this.myWallSlideParams=new Hs,this.myGroundParams=new Qo,this.myCeilingParams=new Qo,this.mySplitMovementParams=new ks,this.myAdditionalParams=new Fs,this.myDebugParams=new ws}copy(e){}},qC={UPWARD:0,DOWNWARD:1,BOTH:2},Bs=class{constructor(){this.myHorizontalCheckConeRadius=0,this.myHorizontalCheckConeHalfAngle=0,this.myHorizontalHeightCheckEnabled=!1,this.myHorizontalCheckFeetDistanceToIgnore=0,this.myHorizontalCheckHeadDistanceToIgnore=0,this.myHorizontalCheckFixedForwardEnabled=!1,this.myHorizontalCheckFixedForward=c(),this.myHorizontalMovementCheckEnabled=!1,this.myHorizontalMovementCheckRadialSteps=0,this.myHorizontalMovementCheckSplitMovementEnabled=!1,this.myHorizontalMovementCheckSplitMovementMaxSteps=null,this.myHorizontalMovementCheckSplitMovementMaxStepLength=null,this.myHorizontalMovementCheckSplitMovementMinStepLength=null,this.myHorizontalMovementCheckGetBetterReferenceHit=!1,this.myHorizontalMovementHorizontalRadialCheckEnabled=!1,this.myHorizontalMovementHorizontalDiagonalOutwardCheckEnabled=!1,this.myHorizontalMovementHorizontalDiagonalInwardCheckEnabled=!1,this.myHorizontalMovementHorizontalStraightCheckEnabled=!1,this.myHorizontalMovementHorizontalStraightCentralCheckEnabled=!1,this.myHorizontalMovementHeightCheckSteps=0,this.myHorizontalMovementHeightHorizontalCheckEnabled=!1,this.myHorizontalMovementHeightVerticalCheckEnabled=!1,this.myHorizontalMovementVerticalRadialDiagonalOutwardCheckEnabled=!1,this.myHorizontalMovementVerticalRadialDiagonalInwardCheckEnabled=!1,this.myHorizontalMovementVerticalDiagonalOutwardUpwardCheckEnabled=!1,this.myHorizontalMovementVerticalDiagonalOutwardDownwardCheckEnabled=!1,this.myHorizontalMovementVerticalDiagonalInwardUpwardCheckEnabled=!1,this.myHorizontalMovementVerticalDiagonalInwardDownwardCheckEnabled=!1,this.myHorizontalMovementVerticalStraightCheckEnabled=!1,this.myHorizontalMovementVerticalStraightCentralCheckEnabled=!1,this.myHorizontalMovementVerticalStraightDiagonalUpwardCheckEnabled=!1,this.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=!1,this.myHorizontalMovementVerticalStraightDiagonalDownwardCheckEnabled=!1,this.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled=!1,this.myHorizontalPositionCheckEnabled=!1,this.myHorizontalPositionCheckConeHalfSlices=0,this.myHorizontalPositionHorizontalBorderCheckEnabled=!1,this.myHorizontalPositionHorizontalRadialCheckEnabled=!1,this.myHorizontalPositionHeightCheckSteps=0,this.myHorizontalPositionHeightHorizontalCheckEnabled=!1,this.myHorizontalPositionHeightVerticalCheckEnabled=!1,this.myHorizontalPositionVerticalStraightCheckEnabled=!1,this.myHorizontalPositionVerticalStraightCentralCheckEnabled=!1,this.myHorizontalPositionVerticalRadialDiagonalOutwardCheckEnabled=!1,this.myHorizontalPositionVerticalRadialDiagonalInwardCheckEnabled=!1,this.myHorizontalPositionVerticalBorderDiagonalOutwardCheckEnabled=!1,this.myHorizontalPositionVerticalBorderDiagonalInwardCheckEnabled=!1,this.myHorizontalPositionVerticalRadialBorderDiagonalOutwardCheckEnabled=!1,this.myHorizontalPositionVerticalRadialBorderDiagonalInwardCheckEnabled=!1,this.myHorizontalPositionVerticalCheckGetFarthestHit=!1,this.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHit=!1,this.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHitKeepVerticalHitIfNoHorizontalHit=!1,this.myHorizontalPositionVerticalCheckIgnoreHitsInsideCollision=!1,this.myHorizontalPositionVerticalCheckDirection=qC.UPWARD,this.myHorizontalCheckBlockLayerFlags=new Ve,this.myHorizontalCheckObjectsToIgnore=[]}copy(e){}},Ls=class{constructor(){this.myVerticalCheckCircumferenceRadius=0,this.myVerticalCheckCircumferenceSlices=0,this.myVerticalCheckCircumferenceCentralCheckEnabled=!1,this.myVerticalCheckCircumferenceRadialSteps=0,this.myVerticalCheckCircumferenceRotationPerRadialStep=0,this.myVerticalCheckFixedForwardEnabled=!1,this.myVerticalCheckFixedForward=c(),this.myVerticalMovementCheckEnabled=!1,this.myVerticalMovementCheckReductionEnabled=!1,this.myVerticalMovementCheckPerformCheckOnBothSides=!1,this.myVerticalPositionCheckEnabled=!1,this.myVerticalCheckAllowHitsInsideCollisionIfOneValid=!1,this.myVerticalCheckBlockLayerFlags=new Ve,this.myVerticalCheckObjectsToIgnore=[]}copy(e){}},js={NONE:0,USE_PREVIOUS_RESULTS:1,COLLISION_ANGLE_ABOVE_90_DEGREES:2,COLLISION_ANGLE_ABOVE_90_DEGREES_OR_MOVEMENT_ANGLE_ABOVE_85_DEGREES:3,ALWAYS:4},Hs=class{constructor(){this.myWallSlideEnabled=!1,this.myWallSlideMaxAttempts=0,this.myCheckBothWallSlideDirections=!1,this.myWallSlideFlickerPreventionMode=js.NONE,this.myWallSlideFlickerPreventionCheckOnlyIfAlreadySliding=!1,this.myWallSlideFlickerPreventionForceCheckCounter=0,this.my90DegreesWallSlideAdjustDirectionSign=!1}copy(e){}},Qo=class{constructor(){this.mySurfaceSnapEnabled=!1,this.mySurfaceSnapMaxDistance=0,this.mySurfacePopOutEnabled=!1,this.mySurfacePopOutMaxDistance=0,this.mySurfaceAngleToIgnore=0,this.mySurfaceAngleToIgnoreWithSurfacePerceivedAngle=null,this.myHorizontalMovementSurfaceAngleToIgnoreMaxVerticalDistance=null,this.myHorizontalPositionSurfaceAngleToIgnoreMaxVerticalDistance=null,this.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft=null,this.myCollectSurfaceInfo=!1,this.myOnSurfaceMaxOutsideDistance=0,this.myOnSurfaceMaxInsideDistance=0,this.myBaseInsideCollisionCheckEnabled=!1,this.myOnSurfaceIfBaseInsideCollision=!1,this.myCollectSurfaceNormalMaxOutsideDistance=0,this.myCollectSurfaceNormalMaxInsideDistance=0,this.myFindSurfaceDistanceMaxOutsideDistance=0,this.myFindSurfaceDistanceMaxInsideDistance=0,this.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhill=!1,this.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphill=!1,this.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhillMaxSurfaceAngle=null,this.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphillMaxSurfaceAngle=null,this.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhillMaxSurfacePerceivedAngle=null,this.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphillMaxSurfacePerceivedAngle=null,this.myVerticalMovementAdjustHorizontalMovementOverSurfaceAngleDownhill=!1,this.myVerticalMovementAdjustHorizontalMovementOverSurfaceAngleDownhillMinSurfaceAngle=null,this.myMovementMustStayOnSurface=!1,this.myMovementMustStayOnSurfaceHitMaxAngle=null,this.myMovementMustStayOnIgnorableSurfaceAngleDownhill=!1,this.myMovementMustStayOnSurfaceAngleDownhill=null,this.myTeleportMustBeOnSurface=!1,this.myTeleportMustBeOnIgnorableSurfaceAngle=!1,this.myTeleportMustBeOnSurfaceAngle=null,this.myCheckTransformMustBeOnSurface=!1,this.myCheckTransformMustBeOnIgnorableSurfaceAngle=!1,this.myCheckTransformMustBeOnSurfaceAngle=null,this.myRecollectSurfaceInfoOnSurfaceCheckFailed=!1,this.myHorizontalMovementAllowExitAttemptWhenOnNotIgnorableSurfacePerceivedAngle=!1}copy(e){}},ks=class{constructor(){this.mySplitMovementEnabled=!1,this.mySplitMovementMaxSteps=null,this.mySplitMovementMaxStepLength=null,this.mySplitMovementMinStepLength=null,this.mySplitMovementStopOnHorizontalMovementFailed=!1,this.mySplitMovementStopOnVerticalMovementFailed=!1,this.mySplitMovementStopReturnPreviousResults=!1}copy(e){}},Fs=class{constructor(){this.myPositionOffsetLocal=c(),this.myRotationOffsetLocalQuat=j()}copy(e){}},ws=class{constructor(){this.myVisualDebugEnabled=!1,this.myVisualDebugMovementEnabled=!1,this.myVisualDebugHorizontalMovementCheckEnabled=!1,this.myVisualDebugHorizontalPositionCheckEnabled=!1,this.myVisualDebugVerticalMovementCheckEnabled=!1,this.myVisualDebugVerticalPositionCheckEnabled=!1,this.myVisualDebugSlideEnabled=!1,this.myVisualDebugGroundInfoEnabled=!1,this.myVisualDebugCeilingInfoEnabled=!1,this.myVisualDebugResultsEnabled=!1}copy(e){}};to.prototype.copy=function(e){this.myHeight=e.myHeight,this.myHorizontalCheckParams.copy(e.myHorizontalCheckParams),this.myVerticalCheckParams.copy(e.myVerticalCheckParams),this.myWallSlideParams.copy(e.myWallSlideParams),this.myGroundParams.copy(e.myGroundParams),this.myCeilingParams.copy(e.myCeilingParams),this.mySplitMovementParams.copy(e.mySplitMovementParams),this.myAdditionalParams.copy(e.myAdditionalParams),this.myDebugParams.copy(e.myDebugParams)};Bs.prototype.copy=function(e){this.myHorizontalCheckConeRadius=e.myHorizontalCheckConeRadius,this.myHorizontalCheckConeHalfAngle=e.myHorizontalCheckConeHalfAngle,this.myHorizontalHeightCheckEnabled=e.myHorizontalHeightCheckEnabled,this.myHorizontalCheckFeetDistanceToIgnore=e.myHorizontalCheckFeetDistanceToIgnore,this.myHorizontalCheckHeadDistanceToIgnore=e.myHorizontalCheckHeadDistanceToIgnore,this.myHorizontalCheckFixedForwardEnabled=e.myHorizontalCheckFixedForwardEnabled,this.myHorizontalCheckFixedForward.vec3_copy(e.myHorizontalCheckFixedForward),this.myHorizontalMovementCheckEnabled=e.myHorizontalMovementCheckEnabled,this.myHorizontalMovementCheckRadialSteps=e.myHorizontalMovementCheckRadialSteps,this.myHorizontalMovementCheckSplitMovementEnabled=e.myHorizontalMovementCheckSplitMovementEnabled,this.myHorizontalMovementCheckSplitMovementMaxSteps=e.myHorizontalMovementCheckSplitMovementMaxSteps,this.myHorizontalMovementCheckSplitMovementMaxStepLength=e.myHorizontalMovementCheckSplitMovementMaxStepLength,this.myHorizontalMovementCheckSplitMovementMinStepLength=e.myHorizontalMovementCheckSplitMovementMinStepLength,this.myHorizontalMovementCheckGetBetterReferenceHit=e.myHorizontalMovementCheckGetBetterReferenceHit,this.myHorizontalMovementHorizontalRadialCheckEnabled=e.myHorizontalMovementHorizontalRadialCheckEnabled,this.myHorizontalMovementHorizontalDiagonalOutwardCheckEnabled=e.myHorizontalMovementHorizontalDiagonalOutwardCheckEnabled,this.myHorizontalMovementHorizontalDiagonalInwardCheckEnabled=e.myHorizontalMovementHorizontalDiagonalInwardCheckEnabled,this.myHorizontalMovementHorizontalStraightCheckEnabled=e.myHorizontalMovementHorizontalStraightCheckEnabled,this.myHorizontalMovementHorizontalStraightCentralCheckEnabled=e.myHorizontalMovementHorizontalStraightCentralCheckEnabled,this.myHorizontalMovementHeightCheckSteps=e.myHorizontalMovementHeightCheckSteps,this.myHorizontalMovementHeightVerticalCheckEnabled=e.myHorizontalMovementHeightVerticalCheckEnabled,this.myHorizontalMovementHeightHorizontalCheckEnabled=e.myHorizontalMovementHeightHorizontalCheckEnabled,this.myHorizontalMovementVerticalRadialDiagonalOutwardCheckEnabled=e.myHorizontalMovementVerticalRadialDiagonalOutwardCheckEnabled,this.myHorizontalMovementVerticalRadialDiagonalInwardCheckEnabled=e.myHorizontalMovementVerticalRadialDiagonalInwardCheckEnabled,this.myHorizontalMovementVerticalDiagonalOutwardUpwardCheckEnabled=e.myHorizontalMovementVerticalDiagonalOutwardUpwardCheckEnabled,this.myHorizontalMovementVerticalDiagonalOutwardDownwardCheckEnabled=e.myHorizontalMovementVerticalDiagonalOutwardDownwardCheckEnabled,this.myHorizontalMovementVerticalDiagonalInwardUpwardCheckEnabled=e.myHorizontalMovementVerticalDiagonalInwardUpwardCheckEnabled,this.myHorizontalMovementVerticalDiagonalInwardDownwardCheckEnabled=e.myHorizontalMovementVerticalDiagonalInwardDownwardCheckEnabled,this.myHorizontalMovementVerticalStraightCheckEnabled=e.myHorizontalMovementVerticalStraightCheckEnabled,this.myHorizontalMovementVerticalStraightCentralCheckEnabled=e.myHorizontalMovementVerticalStraightCentralCheckEnabled,this.myHorizontalMovementVerticalStraightDiagonalUpwardCheckEnabled=e.myHorizontalMovementVerticalStraightDiagonalUpwardCheckEnabled,this.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=e.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled,this.myHorizontalMovementVerticalStraightDiagonalDownwardCheckEnabled=e.myHorizontalMovementVerticalStraightDiagonalDownwardCheckEnabled,this.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled=e.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled,this.myHorizontalPositionCheckEnabled=e.myHorizontalPositionCheckEnabled,this.myHorizontalPositionCheckConeHalfSlices=e.myHorizontalPositionCheckConeHalfSlices,this.myHorizontalPositionHorizontalBorderCheckEnabled=e.myHorizontalPositionHorizontalBorderCheckEnabled,this.myHorizontalPositionHorizontalRadialCheckEnabled=e.myHorizontalPositionHorizontalRadialCheckEnabled,this.myHorizontalPositionHeightCheckSteps=e.myHorizontalPositionHeightCheckSteps,this.myHorizontalPositionHeightHorizontalCheckEnabled=e.myHorizontalPositionHeightHorizontalCheckEnabled,this.myHorizontalPositionHeightVerticalCheckEnabled=e.myHorizontalPositionHeightVerticalCheckEnabled,this.myHorizontalPositionVerticalStraightCheckEnabled=e.myHorizontalPositionVerticalStraightCheckEnabled,this.myHorizontalPositionVerticalStraightCentralCheckEnabled=e.myHorizontalPositionVerticalStraightCentralCheckEnabled,this.myHorizontalPositionVerticalRadialDiagonalOutwardCheckEnabled=e.myHorizontalPositionVerticalRadialDiagonalOutwardCheckEnabled,this.myHorizontalPositionVerticalRadialDiagonalInwardCheckEnabled=e.myHorizontalPositionVerticalRadialDiagonalInwardCheckEnabled,this.myHorizontalPositionVerticalBorderDiagonalOutwardCheckEnabled=e.myHorizontalPositionVerticalBorderDiagonalOutwardCheckEnabled,this.myHorizontalPositionVerticalBorderDiagonalInwardCheckEnabled=e.myHorizontalPositionVerticalBorderDiagonalInwardCheckEnabled,this.myHorizontalPositionVerticalRadialBorderDiagonalOutwardCheckEnabled=e.myHorizontalPositionVerticalRadialBorderDiagonalOutwardCheckEnabled,this.myHorizontalPositionVerticalRadialBorderDiagonalInwardCheckEnabled=e.myHorizontalPositionVerticalRadialBorderDiagonalInwardCheckEnabled,this.myHorizontalPositionVerticalCheckGetFarthestHit=e.myHorizontalPositionVerticalCheckGetFarthestHit,this.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHit=e.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHit,this.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHitKeepVerticalHitIfNoHorizontalHit=e.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHitKeepVerticalHitIfNoHorizontalHit,this.myHorizontalPositionVerticalCheckIgnoreHitsInsideCollision=e.myHorizontalPositionVerticalCheckIgnoreHitsInsideCollision,this.myHorizontalPositionVerticalCheckDirection=e.myHorizontalPositionVerticalCheckDirection,this.myHorizontalCheckBlockLayerFlags.setMask(e.myHorizontalCheckBlockLayerFlags.getMask()),this.myHorizontalCheckObjectsToIgnore.pp_copy(e.myHorizontalCheckObjectsToIgnore)};Ls.prototype.copy=function(e){this.myVerticalCheckCircumferenceRadius=e.myVerticalCheckCircumferenceRadius,this.myVerticalCheckCircumferenceSlices=e.myVerticalCheckCircumferenceSlices,this.myVerticalCheckCircumferenceCentralCheckEnabled=e.myVerticalCheckCircumferenceCentralCheckEnabled,this.myVerticalCheckCircumferenceRadialSteps=e.myVerticalCheckCircumferenceRadialSteps,this.myVerticalCheckCircumferenceRotationPerRadialStep=e.myVerticalCheckCircumferenceRotationPerRadialStep,this.myVerticalCheckFixedForwardEnabled=e.myVerticalCheckFixedForwardEnabled,this.myVerticalCheckFixedForward.vec3_copy(e.myVerticalCheckFixedForward),this.myVerticalMovementCheckEnabled=e.myVerticalMovementCheckEnabled,this.myVerticalMovementCheckReductionEnabled=e.myVerticalMovementCheckReductionEnabled,this.myVerticalMovementCheckPerformCheckOnBothSides=e.myVerticalMovementCheckPerformCheckOnBothSides,this.myVerticalPositionCheckEnabled=e.myVerticalPositionCheckEnabled,this.myVerticalCheckAllowHitsInsideCollisionIfOneValid=e.myVerticalCheckAllowHitsInsideCollisionIfOneValid,this.myVerticalCheckBlockLayerFlags.setMask(e.myVerticalCheckBlockLayerFlags.getMask()),this.myVerticalCheckObjectsToIgnore.pp_copy(e.myVerticalCheckObjectsToIgnore)};Hs.prototype.copy=function(e){this.myWallSlideEnabled=e.myWallSlideEnabled,this.myWallSlideMaxAttempts=e.myWallSlideMaxAttempts,this.myCheckBothWallSlideDirections=e.myCheckBothWallSlideDirections,this.myWallSlideFlickerPreventionMode=e.myWallSlideFlickerPreventionMode,this.myWallSlideFlickerPreventionCheckOnlyIfAlreadySliding=e.myWallSlideFlickerPreventionCheckOnlyIfAlreadySliding,this.myWallSlideFlickerPreventionForceCheckCounter=e.myWallSlideFlickerPreventionForceCheckCounter,this.my90DegreesWallSlideAdjustDirectionSign=e.my90DegreesWallSlideAdjustDirectionSign};Qo.prototype.copy=function(e){this.mySurfaceSnapEnabled=e.mySurfaceSnapEnabled,this.mySurfaceSnapMaxDistance=e.mySurfaceSnapMaxDistance,this.mySurfacePopOutEnabled=e.mySurfacePopOutEnabled,this.mySurfacePopOutMaxDistance=e.mySurfacePopOutMaxDistance,this.mySurfaceAngleToIgnore=e.mySurfaceAngleToIgnore,this.mySurfaceAngleToIgnoreWithSurfacePerceivedAngle=e.mySurfaceAngleToIgnoreWithSurfacePerceivedAngle,this.myHorizontalMovementSurfaceAngleToIgnoreMaxVerticalDistance=e.myHorizontalMovementSurfaceAngleToIgnoreMaxVerticalDistance,this.myHorizontalPositionSurfaceAngleToIgnoreMaxVerticalDistance=e.myHorizontalPositionSurfaceAngleToIgnoreMaxVerticalDistance,this.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft=e.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft,this.myCollectSurfaceInfo=e.myCollectSurfaceInfo,this.myOnSurfaceMaxOutsideDistance=e.myOnSurfaceMaxOutsideDistance,this.myOnSurfaceMaxInsideDistance=e.myOnSurfaceMaxInsideDistance,this.myBaseInsideCollisionCheckEnabled=e.myBaseInsideCollisionCheckEnabled,this.myOnSurfaceIfBaseInsideCollision=e.myOnSurfaceIfBaseInsideCollision,this.myCollectSurfaceNormalMaxOutsideDistance=e.myCollectSurfaceNormalMaxOutsideDistance,this.myCollectSurfaceNormalMaxInsideDistance=e.myCollectSurfaceNormalMaxInsideDistance,this.myFindSurfaceDistanceMaxOutsideDistance=e.myFindSurfaceDistanceMaxOutsideDistance,this.myFindSurfaceDistanceMaxInsideDistance=e.myFindSurfaceDistanceMaxInsideDistance,this.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhill=e.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhill,this.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphill=e.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphill,this.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhillMaxSurfaceAngle=e.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhillMaxSurfaceAngle,this.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphillMaxSurfaceAngle=e.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphillMaxSurfaceAngle,this.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhillMaxSurfacePerceivedAngle=e.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhillMaxSurfacePerceivedAngle,this.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphillMaxSurfacePerceivedAngle=e.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphillMaxSurfacePerceivedAngle,this.myVerticalMovementAdjustHorizontalMovementOverSurfaceAngleDownhill=e.myVerticalMovementAdjustHorizontalMovementOverSurfaceAngleDownhill,this.myVerticalMovementAdjustHorizontalMovementOverSurfaceAngleDownhillMinSurfaceAngle=e.myVerticalMovementAdjustHorizontalMovementOverSurfaceAngleDownhillMinSurfaceAngle,this.myMovementMustStayOnSurface=e.myMovementMustStayOnSurface,this.myMovementMustStayOnSurfaceHitMaxAngle=e.myMovementMustStayOnSurfaceHitMaxAngle,this.myMovementMustStayOnIgnorableSurfaceAngleDownhill=e.myMovementMustStayOnIgnorableSurfaceAngleDownhill,this.myMovementMustStayOnSurfaceAngleDownhill=e.myMovementMustStayOnSurfaceAngleDownhill,this.myTeleportMustBeOnSurface=e.myTeleportMustBeOnSurface,this.myTeleportMustBeOnIgnorableSurfaceAngle=e.myTeleportMustBeOnIgnorableSurfaceAngle,this.myTeleportMustBeOnSurfaceAngle=e.myTeleportMustBeOnSurfaceAngle,this.myCheckTransformMustBeOnSurface=e.myCheckTransformMustBeOnSurface,this.myCheckTransformMustBeOnIgnorableSurfaceAngle=e.myCheckTransformMustBeOnIgnorableSurfaceAngle,this.myCheckTransformMustBeOnSurfaceAngle=e.myCheckTransformMustBeOnSurfaceAngle,this.myRecollectSurfaceInfoOnSurfaceCheckFailed=e.myRecollectSurfaceInfoOnSurfaceCheckFailed,this.myHorizontalMovementAllowExitAttemptWhenOnNotIgnorableSurfacePerceivedAngle=e.myHorizontalMovementAllowExitAttemptWhenOnNotIgnorableSurfacePerceivedAngle};ks.prototype.copy=function(e){this.mySplitMovementEnabled=e.mySplitMovementEnabled,this.mySplitMovementMaxSteps=e.mySplitMovementMaxSteps,this.mySplitMovementMaxStepLength=e.mySplitMovementMaxStepLength,this.mySplitMovementMinStepLength=e.mySplitMovementMinStepLength,this.mySplitMovementStopOnHorizontalMovementFailed=e.mySplitMovementStopOnHorizontalMovementFailed,this.mySplitMovementStopOnVerticalMovementFailed=e.mySplitMovementStopOnVerticalMovementFailed,this.mySplitMovementStopReturnPreviousResults=e.mySplitMovementStopReturnPreviousResults};Fs.prototype.copy=function(e){this.myPositionOffsetLocal.vec3_copy(e.myPositionOffsetLocal),this.myRotationOffsetLocalQuat.quat_copy(e.myRotationOffsetLocalQuat)};ws.prototype.copy=function(e){this.myVisualDebugEnabled=e.myVisualDebugEnabled,this.myVisualDebugMovementEnabled=e.myVisualDebugMovementEnabled,this.myVisualDebugHorizontalMovementCheckEnabled=e.myVisualDebugHorizontalMovementCheckEnabled,this.myVisualDebugHorizontalPositionCheckEnabled=e.myVisualDebugHorizontalPositionCheckEnabled,this.myVisualDebugVerticalMovementCheckEnabled=e.myVisualDebugVerticalMovementCheckEnabled,this.myVisualDebugVerticalPositionCheckEnabled=e.myVisualDebugVerticalPositionCheckEnabled,this.myVisualDebugSlideEnabled=e.myVisualDebugSlideEnabled,this.myVisualDebugGroundInfoEnabled=e.myVisualDebugGroundInfoEnabled,this.myVisualDebugCeilingInfoEnabled=e.myVisualDebugCeilingInfoEnabled,this.myVisualDebugResultsEnabled=e.myVisualDebugResultsEnabled};var io={VERY_LOW:0,LOW:1,MEDIUM:2,HIGH:3,VERY_HIGH:4},zs=class{constructor(){this.myHeight=0,this.myRadius=0,this.myAccuracyLevel=io.VERY_LOW,this.myIsPlayer=!1,this.myCheckOnlyFeet=!1,this.myMaxSpeed=0,this.myAverageFPS=72,this.myCanFly=!1,this.myShouldSlideAlongWall=!1,this.myCollectGroundInfo=!1,this.myShouldSnapOnGround=!1,this.myMaxDistanceToSnapOnGround=0,this.myMaxWalkableGroundAngle=0,this.myMaxWalkableGroundStepHeight=0,this.myShouldNotFallFromEdges=!1,this.myHorizontalCheckBlockLayerFlags=new Ve,this.myHorizontalCheckObjectsToIgnore=[],this.myVerticalCheckBlockLayerFlags=new Ve,this.myVerticalCheckObjectsToIgnore=[],this.myHorizontalCheckDebugEnabled=!1,this.myVerticalCheckDebugEnabled=!1}};function XC(i,e=new to){return e.myHeight=i.myHeight,e.myHorizontalCheckParams.myHorizontalCheckConeRadius=i.myRadius,e.myVerticalCheckParams.myVerticalCheckCircumferenceRadius=i.myRadius/2,e.myVerticalCheckParams.myVerticalCheckFixedForwardEnabled=!0,e.myVerticalCheckParams.myVerticalCheckFixedForward.vec3_set(0,0,1),(!i.myCheckOnlyFeet||i.myCanFly)&&(e.myHorizontalCheckParams.myHorizontalHeightCheckEnabled=!0,e.myVerticalCheckParams.myVerticalPositionCheckEnabled=!0),e.myWallSlideParams.myWallSlideEnabled=i.myShouldSlideAlongWall,e.myHorizontalCheckParams.myHorizontalCheckFeetDistanceToIgnore=i.myMaxWalkableGroundStepHeight,e.myGroundParams.mySurfaceSnapMaxDistance=i.myMaxDistanceToSnapOnGround,e.myGroundParams.mySurfacePopOutMaxDistance=i.myMaxDistanceToSnapOnGround>0?i.myMaxDistanceToSnapOnGround:i.myRadius>.1?.1:.01,e.myGroundParams.mySurfacePopOutMaxDistance=Math.max(e.myGroundParams.mySurfacePopOutMaxDistance,e.myHorizontalCheckParams.myHorizontalCheckFeetDistanceToIgnore),e.myGroundParams.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft=i.myRadius*.75,e.myGroundParams.myCollectSurfaceInfo=i.myCollectGroundInfo||i.myMaxWalkableGroundAngle>0,e.myGroundParams.mySurfaceSnapEnabled=i.myShouldSnapOnGround,e.myGroundParams.mySurfacePopOutEnabled=!0,e.myGroundParams.mySurfaceAngleToIgnore=i.myMaxWalkableGroundAngle,e.myGroundParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngle=!0,e.myGroundParams.myOnSurfaceMaxOutsideDistance=.001,e.myGroundParams.myOnSurfaceMaxInsideDistance=.001,e.myGroundParams.myCollectSurfaceNormalMaxOutsideDistance=i.myRadius>.1?.1:.01,e.myGroundParams.myCollectSurfaceNormalMaxInsideDistance=e.myGroundParams.myCollectSurfaceNormalMaxOutsideDistance,e.myGroundParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhill=!0,e.myGroundParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphill=!0,i.myCanFly&&(e.myHorizontalCheckParams.myHorizontalCheckHeadDistanceToIgnore=e.myHorizontalCheckParams.myHorizontalCheckFeetDistanceToIgnore,e.myCeilingParams.myCollectSurfaceInfo=e.myGroundParams.myCollectSurfaceInfo,e.myCeilingParams.mySurfacePopOutEnabled=e.myGroundParams.mySurfacePopOutEnabled,e.myCeilingParams.mySurfaceAngleToIgnore=e.myGroundParams.mySurfaceAngleToIgnore,e.myCeilingParams.mySurfaceSnapMaxDistance=e.myGroundParams.mySurfaceSnapMaxDistance,e.myCeilingParams.mySurfacePopOutMaxDistance=e.myGroundParams.mySurfacePopOutMaxDistance,e.myCeilingParams.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft=e.myGroundParams.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft,e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngle=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngle,e.myCeilingParams.myOnSurfaceMaxOutsideDistance=e.myGroundParams.myOnSurfaceMaxOutsideDistance,e.myCeilingParams.myOnSurfaceMaxInsideDistance=e.myGroundParams.myOnSurfaceMaxInsideDistance,e.myCeilingParams.myCollectSurfaceNormalMaxOutsideDistance=e.myGroundParams.myCollectSurfaceNormalMaxOutsideDistance,e.myCeilingParams.myCollectSurfaceNormalMaxInsideDistance=e.myGroundParams.myCollectSurfaceNormalMaxInsideDistance,e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhill=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleDownhill,e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphill=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementOverSurfacePerceivedAngleUphill),i.myShouldNotFallFromEdges&&(e.myGroundParams.myMovementMustStayOnSurface=!0,e.myGroundParams.myMovementMustStayOnSurfaceAngleDownhill=Math.max(60,e.myGroundParams.mySurfaceAngleToIgnore)),e.myHorizontalCheckParams.myHorizontalCheckBlockLayerFlags.copy(i.myHorizontalCheckBlockLayerFlags),e.myHorizontalCheckParams.myHorizontalCheckObjectsToIgnore.pp_copy(i.myHorizontalCheckObjectsToIgnore),e.myVerticalCheckParams.myVerticalCheckBlockLayerFlags.copy(i.myVerticalCheckBlockLayerFlags),e.myVerticalCheckParams.myVerticalCheckObjectsToIgnore.pp_copy(i.myVerticalCheckObjectsToIgnore),i.myHorizontalCheckDebugEnabled&&(e.myDebugParams.myVisualDebugEnabled=!0,e.myDebugParams.myVisualDebugHorizontalMovementCheckEnabled=!0,e.myDebugParams.myVisualDebugHorizontalPositionCheckEnabled=!0),i.myVerticalCheckDebugEnabled&&(e.myDebugParams.myVisualDebugEnabled=!0,e.myDebugParams.myVisualDebugVerticalMovementCheckEnabled=!0,e.myDebugParams.myVisualDebugVerticalPositionCheckEnabled=!0),i.myAccuracyLevel>=io.VERY_LOW&&(e.myHorizontalCheckParams.myHorizontalCheckConeHalfAngle=60,e.myHorizontalCheckParams.myHorizontalMovementHeightVerticalCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalPositionHeightVerticalCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementCheckEnabled=!1,e.myHorizontalCheckParams.myHorizontalPositionCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalPositionCheckConeHalfSlices=1,e.myHorizontalCheckParams.myHorizontalPositionHeightCheckSteps=1,e.myHorizontalCheckParams.myHorizontalPositionHorizontalRadialCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalPositionVerticalStraightCheckEnabled=!0,e.myVerticalCheckParams.myVerticalCheckCircumferenceSlices=4,e.myVerticalCheckParams.myVerticalCheckCircumferenceCentralCheckEnabled=!0,e.myVerticalCheckParams.myVerticalCheckCircumferenceRadialSteps=1,e.myVerticalCheckParams.myVerticalMovementCheckEnabled=!0,e.myVerticalCheckParams.myVerticalMovementCheckReductionEnabled=!0,e.myVerticalCheckParams.myVerticalCheckAllowHitsInsideCollisionIfOneValid=!0,i.myIsPlayer&&(e.myWallSlideParams.myWallSlideMaxAttempts=2,e.myWallSlideParams.my90DegreesWallSlideAdjustDirectionSign=!0)),i.myAccuracyLevel>=io.LOW&&(e.myHorizontalCheckParams.myHorizontalMovementCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementCheckRadialSteps=1,e.myHorizontalCheckParams.myHorizontalMovementHeightCheckSteps=1,e.myHorizontalCheckParams.myHorizontalMovementHorizontalStraightCentralCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=!0,e.myVerticalCheckParams.myVerticalCheckCircumferenceRadialSteps=2,e.myVerticalCheckParams.myVerticalCheckCircumferenceRotationPerRadialStep=180/e.myVerticalCheckParams.myVerticalCheckCircumferenceSlices,e.myWallSlideParams.myWallSlideMaxAttempts=2,e.myWallSlideParams.myCheckBothWallSlideDirections=!1,e.myWallSlideParams.myWallSlideFlickerPreventionMode=js.NONE,e.myWallSlideParams.myWallSlideFlickerPreventionCheckOnlyIfAlreadySliding=!1,e.myWallSlideParams.myWallSlideFlickerPreventionForceCheckCounter=0,e.myWallSlideParams.my90DegreesWallSlideAdjustDirectionSign=!1),i.myAccuracyLevel>=io.MEDIUM&&(e.myHorizontalCheckParams.myHorizontalMovementHeightHorizontalCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementHorizontalDiagonalOutwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalDiagonalOutwardUpwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalPositionCheckConeHalfSlices=2,e.myHorizontalCheckParams.myHorizontalPositionHeightHorizontalCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalPositionHorizontalBorderCheckEnabled=!0,e.myVerticalCheckParams.myVerticalMovementCheckPerformCheckOnBothSides=!0,e.myVerticalCheckParams.myVerticalCheckCircumferenceSlices=6,e.myVerticalCheckParams.myVerticalCheckCircumferenceRadialSteps=2,e.myVerticalCheckParams.myVerticalCheckCircumferenceRotationPerRadialStep=180/e.myVerticalCheckParams.myVerticalCheckCircumferenceSlices,e.myWallSlideParams.myWallSlideMaxAttempts=3,e.myWallSlideParams.my90DegreesWallSlideAdjustDirectionSign=!0,i.myIsPlayer&&(e.myWallSlideParams.myWallSlideFlickerPreventionMode=js.USE_PREVIOUS_RESULTS,e.myWallSlideParams.myWallSlideFlickerPreventionCheckOnlyIfAlreadySliding=!0,e.myWallSlideParams.myWallSlideFlickerPreventionForceCheckCounter=4)),i.myAccuracyLevel>=io.HIGH&&(e.myWallSlideParams.myWallSlideEnabled&&(e.myHorizontalCheckParams.myHorizontalMovementCheckGetBetterReferenceHit=!0,e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHit=!0,e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHitKeepVerticalHitIfNoHorizontalHit=!0),e.myHorizontalCheckParams.myHorizontalMovementHorizontalDiagonalInwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementHorizontalStraightCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementHorizontalStraightCentralCheckEnabled=!1,e.myHorizontalCheckParams.myHorizontalMovementVerticalDiagonalInwardUpwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalUpwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=!1,e.myVerticalCheckParams.myVerticalCheckCircumferenceSlices=8,e.myVerticalCheckParams.myVerticalCheckCircumferenceRadialSteps=2,e.myVerticalCheckParams.myVerticalCheckCircumferenceRotationPerRadialStep=180/e.myVerticalCheckParams.myVerticalCheckCircumferenceSlices,e.myWallSlideParams.myWallSlideMaxAttempts=4,i.myIsPlayer&&(e.myWallSlideParams.myCheckBothWallSlideDirections=!0),e.myGroundParams.myBaseInsideCollisionCheckEnabled=!0,e.myCeilingParams.myBaseInsideCollisionCheckEnabled=!0,i.myMaxSpeed/i.myAverageFPS>i.myRadius&&(e.mySplitMovementParams.mySplitMovementEnabled=!0,e.mySplitMovementParams.mySplitMovementMaxSteps=Math.ceil(i.myMaxSpeed/i.myAverageFPS/i.myRadius),e.mySplitMovementParams.mySplitMovementMinStepLength=i.myRadius*.75)),i.myAccuracyLevel>=io.VERY_HIGH&&(e.myHorizontalCheckParams.myHorizontalMovementHeightCheckSteps=2,e.myHorizontalCheckParams.myHorizontalMovementHorizontalRadialCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalDiagonalOutwardDownwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalDiagonalInwardDownwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightCentralCheckEnabled=!1,e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalDownwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled=!1,e.myHorizontalCheckParams.myHorizontalPositionHeightCheckSteps=2,e.myHorizontalCheckParams.myHorizontalPositionVerticalRadialDiagonalOutwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalPositionVerticalBorderDiagonalOutwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHit=!0,e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHitKeepVerticalHitIfNoHorizontalHit=!0,e.myGroundParams.myRecollectSurfaceInfoOnSurfaceCheckFailed=!0,e.myCeilingParams.myRecollectSurfaceInfoOnSurfaceCheckFailed=e.myGroundParams.myRecollectSurfaceInfoOnSurfaceCheckFailed),e}function KC(i,e=new to){return e.copy(i),e.myHorizontalCheckParams.myHorizontalCheckConeHalfAngle=180,e.myHorizontalCheckParams.myHorizontalPositionCheckConeHalfSlices=Math.round(e.myHorizontalCheckParams.myHorizontalCheckConeHalfAngle/i.myHorizontalCheckParams.myHorizontalCheckConeHalfAngle*i.myHorizontalCheckParams.myHorizontalPositionCheckConeHalfSlices),e.myHorizontalCheckParams.myHorizontalCheckFixedForwardEnabled=!0,e.myHorizontalCheckParams.myHorizontalCheckFixedForward.vec3_set(0,0,1),e}var nm={createSimplified:XC,createTeleportColliderSetupFromMovementColliderSetup:KC};var qo=class{constructor(e=r.getMainEngine()){this._myLastCheckRaycastsPerformed=0,this._myCurrentFrameRaycastsPerformed=0,this._myMaxFrameRaycastsPerformed=0,this.myEngine=e,q.initBridge(this.myEngine)}update(e){this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),this._myCurrentFrameRaycastsPerformed=0,q.getCollisionCheck(this.myEngine)._myTotalRaycasts=0}checkMovement(e,t,n,o,s=new Ue){q.checkMovement(e,t,n,o,s,this.myEngine),this._myLastCheckRaycastsPerformed=q.getCollisionCheck(this.myEngine)._myTotalRaycasts-this._myCurrentFrameRaycastsPerformed,this._myCurrentFrameRaycastsPerformed=q.getCollisionCheck(this.myEngine)._myTotalRaycasts,this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),s.myDebugResults._myRaycastsPerformed=this._myLastCheckRaycastsPerformed}checkTeleportToPosition(e,t,n,o,s=new Ue){}checkTeleportToTransform(e,t,n,o,s=new Ue){q.checkTeleportToTransform(e,t,n,o,s,this.myEngine),this._myLastCheckRaycastsPerformed=q.getCollisionCheck(this.myEngine)._myTotalRaycasts-this._myCurrentFrameRaycastsPerformed,this._myCurrentFrameRaycastsPerformed=q.getCollisionCheck(this.myEngine)._myTotalRaycasts,this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),s.myDebugResults._myRaycastsPerformed=this._myLastCheckRaycastsPerformed}checkTransform(e,t,n,o=new Ue){q.checkTransform(e,t,n,o,this.myEngine),this._myLastCheckRaycastsPerformed=q.getCollisionCheck(this.myEngine)._myTotalRaycasts-this._myCurrentFrameRaycastsPerformed,this._myCurrentFrameRaycastsPerformed=q.getCollisionCheck(this.myEngine)._myTotalRaycasts,this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),o.myDebugResults._myRaycastsPerformed=this._myLastCheckRaycastsPerformed}updateSurfaceInfo(e,t,n,o=new Ue){let s=this._myCurrentFrameRaycastsPerformed;this.updateGroundInfo(e,t,n,o),this.updateCeilingInfo(e,t,n,o),this._myLastCheckRaycastsPerformed=q.getCollisionCheck(this.myEngine)._myTotalRaycasts-s,this._myCurrentFrameRaycastsPerformed=q.getCollisionCheck(this.myEngine)._myTotalRaycasts,this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),o.myDebugResults._myRaycastsPerformed=this._myLastCheckRaycastsPerformed}updateGroundInfo(e,t,n,o=new Ue){q.updateGroundInfo(e,t,n,o,this.myEngine),this._myLastCheckRaycastsPerformed=q.getCollisionCheck(this.myEngine)._myTotalRaycasts-this._myCurrentFrameRaycastsPerformed,this._myCurrentFrameRaycastsPerformed=q.getCollisionCheck(this.myEngine)._myTotalRaycasts,this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),o.myDebugResults._myRaycastsPerformed=this._myLastCheckRaycastsPerformed}updateCeilingInfo(e,t,n,o=new Ue){q.updateCeilingInfo(e,t,n,o,this.myEngine),this._myLastCheckRaycastsPerformed=q.getCollisionCheck(this.myEngine)._myTotalRaycasts-this._myCurrentFrameRaycastsPerformed,this._myCurrentFrameRaycastsPerformed=q.getCollisionCheck(this.myEngine)._myTotalRaycasts,this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),o.myDebugResults._myRaycastsPerformed=this._myLastCheckRaycastsPerformed}};qo.prototype.checkTeleportToPosition=function(){let i=N();return function(t,n,o,s,a){i.quat2_copy(n),i.quat2_setPosition(t),this.checkTeleportToTransform(i,n,o,s,a)}}();import{Component as dR}from"@wonderlandengine/api";var pn=class extends dR{init(){this._myCharacterCollisionSystem=null,r.hasCharacterCollisionSystem(this.engine)||(this._myCharacterCollisionSystem=new qo(this.engine),r.setCharacterCollisionSystem(this._myCharacterCollisionSystem,this.engine))}update(e){this._myCharacterCollisionSystem!=null&&this._myCharacterCollisionSystem.update(e)}onDestroy(){this._myCharacterCollisionSystem!=null&&r.getCharacterCollisionSystem(this.engine)==this._myCharacterCollisionSystem&&r.removeCharacterCollisionSystem(this.engine)}};R(pn,"TypeName","pp-character-collision-system"),R(pn,"Properties",{});var Xo=class{constructor(e=r.getMainEngine()){this.mySessionChangeResyncEnabled=!1,this.myBlurEndResyncEnabled=!1,this.myBlurEndResyncRotation=!1,this.myResetTransformOnViewResetEnabled=!0,this.myNextEnterSessionResyncHeight=!1,this.myEnterSessionResyncHeight=!1,this.myExitSessionResyncHeight=!1,this.myExitSessionResyncVerticalAngle=!1,this.myExitSessionRemoveRightTilt=!1,this.myExitSessionAdjustMaxVerticalAngle=!1,this.myExitSessionMaxVerticalAngle=0,this.myHeightOffsetVRWithFloor=null,this.myHeightOffsetVRWithoutFloor=null,this.myHeightOffsetNonVR=null,this.myNextEnterSessionFloorHeight=null,this.myEnterSessionFloorHeight=null,this.myRotateFeetKeepUp=!1,this.myForeheadExtraHeight=0,this.myEngine=e,this.myDebugEnabled=!1}},ae=class{constructor(e=new Xo){this._myParams=e,this._myCurrentHead=r.getPlayerObjects(this._myParams.myEngine).myHead,this._mySessionChangeResyncHeadTransform=null,this._myBlurRecoverHeadTransform=null,this._myCurrentHeadTransformLocalQuat=N(),this._myDelaySessionChangeResyncCounter=0,this._myDelayBlurEndResyncCounter=0,this._myDelayBlurEndResyncTimer=new ne(5,!1),this._myVisibilityHidden=!1,this._mySessionActive=!1,this._mySessionBlurred=!1,this._myIsSyncedDelayCounter=0,this._myViewResetEventListener=null,this._myActive=!0,this._myDestroyed=!1,this._myResyncCounterFrames=3,this._myIsSyncedDelayCounterFrames=1}start(){this._updateHeightOffset(),I.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!0,this._myParams.myEngine)}setActive(e){this._myActive=e}getParams(){return this._myParams}paramsUpdated(){this._updateHeightOffset()}getPlayer(){return r.getPlayerObjects(this._myParams.myEngine).myPlayer}getHead(){return this._myCurrentHead}getHeightHead(){return this.getHeightEyes()+this._myParams.myForeheadExtraHeight}getHeightEyes(){}getTransformFeetQuat(e=N()){}getTransformHeadQuat(e=N()){return this.getHead().pp_getTransformQuat(e)}getPositionFeet(e=c()){}getPositionHead(e=c()){return this._myCurrentHead.pp_getPosition(e)}getRotationFeetQuat(e=j()){}getRotationHeadQuat(e=j()){return this.getHead().pp_getRotationQuat(e)}isSynced(){return this._myIsSyncedDelayCounter==0&&this._myDelaySessionChangeResyncCounter==0&&this._myDelayBlurEndResyncCounter==0&&!this._myDelayBlurEndResyncTimer.isRunning()&&!this._mySessionBlurred}setHeightHead(e,t=!1){if((!t||!this._mySessionActive)&&(this._myParams.myHeightOffsetNonVR=e),!t||this._mySessionActive){this._myParams.myHeightOffsetVRWithoutFloor=e,this._myParams.myHeightOffsetVRWithFloor==null&&(this._myParams.myHeightOffsetVRWithFloor=0);let n=I.isReferenceSpaceFloorBased(this._myParams.myEngine)||I.isDeviceEmulated(this._myParams.myEngine);this._mySessionActive&&n?this._myParams.myHeightOffsetVRWithFloor=this._myParams.myHeightOffsetVRWithFloor+(e-this.getHeightHead()):this._mySessionActive||(this._myParams.myNextEnterSessionFloorHeight=e)}this._updateHeightOffset()}moveFeet(e){}moveHead(e){this.moveFeet(e)}teleportPositionHead(e){}teleportPositionFeet(e){}teleportPlayerToHeadTransformQuat(e){}rotateFeetQuat(e,t=null){}rotateHeadQuat(e){}canRotateFeet(){return!0}canRotateHead(){return!this._mySessionActive}setRotationFeetQuat(e,t=null){}setRotationHeadQuat(){}lookAtFeet(e,t=null,n=null){}lookToFeet(e,t=null,n=null){}lookAtHead(e,t=null){}lookToHead(e,t=null){}update(e){this._myIsSyncedDelayCounter!=0&&(this._myIsSyncedDelayCounter--,this._myIsSyncedDelayCounter=Math.max(0,this._myIsSyncedDelayCounter)),this._myDelaySessionChangeResyncCounter>0&&(this._myDelaySessionChangeResyncCounter--,this._myDelaySessionChangeResyncCounter==0&&(this._sessionChangeResync(),this._myIsSyncedDelayCounter=this._myIsSyncedDelayCounterFrames)),this._myDelayBlurEndResyncCounter>0&&!this._myDelayBlurEndResyncTimer.isRunning()&&(this._myDelayBlurEndResyncCounter--,this._myDelayBlurEndResyncCounter==0&&(this._blurEndResync(),this._myIsSyncedDelayCounter=this._myIsSyncedDelayCounterFrames)),this._myDelayBlurEndResyncTimer.isRunning()&&(this._myDelayBlurEndResyncCounter>0?this._myDelayBlurEndResyncCounter--:(this._myDelayBlurEndResyncTimer.update(e),this._myDelayBlurEndResyncTimer.isDone()&&(this._blurEndResync(),this._myIsSyncedDelayCounter=this._myIsSyncedDelayCounterFrames))),this.isSynced()&&this._myCurrentHead.pp_getTransformLocalQuat(this._myCurrentHeadTransformLocalQuat),this._myParams.myDebugEnabled&&r.isDebugEnabled(this._myParams.myEngine)&&this._debugUpdate(e)}_debugUpdate(e){r.getDebugVisualManager(this._myParams.myEngine).drawLineEnd(0,this.getPositionFeet(),this.getPositionHead(),F(1,0,0,1),.01),console.error(this.getHeightEyes())}destroy(){this._myDestroyed=!0,I.getReferenceSpace(this._myParams.myEngine)?.removeEventListener?.("reset",this._myViewResetEventListener),I.getSession(this._myParams.myEngine)?.removeEventListener("visibilitychange",this._myVisibilityChangeEventListener),I.unregisterSessionStartEndEventListeners(this,this._myParams.myEngine)}isDestroyed(){return this._myDestroyed}};ae.prototype.getHeightEyes=function(){let i=c();return function(){return i=this._myCurrentHead.pp_getPosition(i),this._getPositionHeight(i)}}();ae.prototype.getTransformFeetQuat=function(){let i=c(),e=j();return function(n=N()){return n.quat2_setPositionRotationQuat(this.getPositionFeet(i),this.getRotationFeetQuat(e)),n}}();ae.prototype.getRotationFeetQuat=function(){let i=c(),e=c();return function(n=j()){i=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(i),e=this._myCurrentHead.pp_getForward(e);let o=e.vec3_angle(i),s=10;return o<s?e=this._myCurrentHead.pp_getDown(e):o>180-s&&(e=this._myCurrentHead.pp_getUp(e)),e=e.vec3_removeComponentAlongAxis(i,e),e.vec3_normalize(e),n.quat_setUp(i,e),n}}();ae.prototype.getPositionFeet=function(){let i=c(),e=c();return function(n=c()){i=this._myCurrentHead.pp_getPosition(i);let o=this._getPositionHeight(i);return e=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(e),n=i.vec3_sub(e.vec3_scale(o,n),n),n}}();ae.prototype.moveFeet=function(e){r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_translate(e)};ae.prototype.rotateFeetQuat=function(){let i=c(),e=c(),t=c(),n=j(),o=j(),s=j(),a=c(),l=j(),u=c(),_=c();return function(h,d=null){h.quat_getAngleRadians()<=1e-5||(t=this._myCurrentHead.pp_getPosition(t),i=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(i),e=h.quat_getAxis(e),!e.vec3_isOnAxis(i)&&(d==null&&this._myParams.myFeetRotationKeepUp||d)?(n=this.getRotationFeetQuat(n),o=n.quat_rotateQuat(h,o),a=o.quat_getForward(a),s.quat_copy(o),s.quat_setUp(i,a),l=n.quat_rotationToQuat(s,l)):l.quat_copy(h),r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_rotateAroundQuat(l,t),u=this._myCurrentHead.pp_getPosition(u),_=t.vec3_sub(u,_),_.vec3_length()>1e-5&&this.moveFeet(_))}}();ae.prototype.rotateHeadQuat=function(){let i=j(),e=c();return function(n){this.canRotateHead()&&(this._myCurrentHead.pp_rotateQuat(n),i=this._myCurrentHead.pp_getRotationQuat(i),r.getPlayerObjects(this._myParams.myEngine).myHead.pp_setRotationQuat(i),i=i.quat_rotateAxisRadians(Math.PI,i.quat_getUp(e),i),r.getPlayerObjects(this._myParams.myEngine).myCameraNonXR.pp_setRotationQuat(i))}}();ae.prototype.setRotationFeetQuat=function(){let i=j(),e=j();return function(n,o=null){i=this.getRotationFeetQuat(i),e=i.quat_rotationToQuat(n,e),this.rotateFeetQuat(e,o)}}();ae.prototype.setRotationHeadQuat=function(){let i=j(),e=j();return function(n){i=this.getRotationHeadQuat(i),e=i.quat_rotationToQuat(n,e),this.rotateHeadQuat(e)}}();ae.prototype.teleportPositionHead=function(){let i=c(),e=c();return function(n){i=this._myCurrentHead.pp_getPosition(i),e=n.vec3_sub(i,e),this.moveFeet(e)}}();ae.prototype.teleportPositionFeet=function(){let i=c(),e=c();return function(n){i=this.getPositionFeet(i),e=n.vec3_sub(i,e),this.moveFeet(e)}}();ae.prototype.teleportPlayerToHeadTransformQuat=function(){let i=c(),e=c(),t=c(),n=c(),o=c(),s=c(),a=c(),l=j();return function(_){i=_.quat2_getPosition(i),e=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(e),t=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getPosition(t).vec3_removeComponentAlongAxis(e,t),n=i.vec3_removeComponentAlongAxis(e,n),o=n.vec3_sub(t,o),r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_translate(o),s=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getForward(s),a=_.quat2_getForward(a),l=s.vec3_rotationToPivotedQuat(a,e,l),r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_rotateQuat(l)}}();ae.prototype.lookAtFeet=function(){let i=c(),e=c();return function(n,o=null,s=null){e=this.getPositionFeet(e),i=n.vec3_sub(e,i).vec3_normalize(i),this.lookToFeet(i,o,s)}}();ae.prototype.lookToFeet=function(){let i=j();return function(t,n=null,o=null){i=this.getRotationFeetQuat(i),i.quat_setForward(t,n),this.setRotationFeetQuat(i,o)}}();ae.prototype.lookAtHead=function(){let i=c(),e=c();return function(n,o=null){e=this.getPositionHead(e),i=n.vec3_sub(e,i).vec3_normalize(i),this.lookToHead(i,o)}}();ae.prototype.lookToHead=function(){let i=j();return function(t,n=null){i=this.getRotationHeadQuat(i),i.quat_setForward(t,n),this.setRotationHeadQuat(i)}}();ae.prototype._getPositionHeight=function(){let i=c(),e=c(),t=c();return function(o){i=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getPosition(i),e=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(e),t=o.vec3_sub(i,t).vec3_componentAlongAxis(e,t);let s=t.vec3_length();return e.vec3_isConcordant(t)||(s=-s),s}}();ae.prototype._onXRSessionStart=function(){return function(e,t){this._myBlurRecoverHeadTransform=null,this._myVisibilityHidden=!1,this._myDelaySessionChangeResyncCounter=0,this._myDelayBlurEndResyncCounter=0,this._myDelayBlurEndResyncTimer.reset();let n=I.getReferenceSpace(this._myParams.myEngine);n.addEventListener!=null&&(this._myViewResetEventListener=this._onViewReset.bind(this),n.addEventListener("reset",this._myViewResetEventListener)),this._myVisibilityChangeEventListener=function(o){o.session.visibilityState!="visible"?(this._mySessionBlurred||this._onXRSessionBlurStart(o.session),this._myVisibilityHidden=t.visibilityState=="hidden"):(this._mySessionBlurred&&this._onXRSessionBlurEnd(o.session),this._myVisibilityHidden=!1)}.bind(this),t.addEventListener("visibilitychange",this._myVisibilityChangeEventListener),this._myParams.mySessionChangeResyncEnabled&&!e&&this._myActive?(this._myDelaySessionChangeResyncCounter==0&&(this._mySessionChangeResyncHeadTransform=this._getHeadTransformFromLocal(this._myCurrentHeadTransformLocalQuat)),this._myDelaySessionChangeResyncCounter=this._myResyncCounterFrames):(this._myDelaySessionChangeResyncCounter=0,this._mySessionChangeResyncHeadTransform=null),this._mySessionActive=!0,this._mySessionBlurred=!1,this._myActive&&this._updateHeightOffset()}}();ae.prototype._onXRSessionEnd=function(){return function(e){if(this._myParams.mySessionChangeResyncEnabled&&this._myActive){if(this._myDelaySessionChangeResyncCounter==0){let t=this._getHeadTransformFromLocal(this._myCurrentHeadTransformLocalQuat);this._myBlurRecoverHeadTransform!=null&&(t=this._myBlurRecoverHeadTransform),this._mySessionChangeResyncHeadTransform=t}this._myDelaySessionChangeResyncCounter=this._myResyncCounterFrames}else this._myDelaySessionChangeResyncCounter=0,this._mySessionChangeResyncHeadTransform=null;this._myVisibilityChangeEventListener=null,this._myViewResetEventListener=null,this._myBlurRecoverHeadTransform=null,this._myVisibilityHidden=!1,this._myDelayBlurEndResyncCounter=0,this._myDelayBlurEndResyncTimer.reset(),this._mySessionActive=!1,this._mySessionBlurred=!1,this._myActive&&this._updateHeightOffset()}}();ae.prototype._onXRSessionBlurStart=function(){return function(e){this._myActive&&(this._myParams.myBlurEndResyncEnabled&&this._myBlurRecoverHeadTransform==null&&this._mySessionActive?this._myDelaySessionChangeResyncCounter>0?this._myBlurRecoverHeadTransform=this._mySessionChangeResyncHeadTransform:this._myBlurRecoverHeadTransform=this._getHeadTransformFromLocal(this._myCurrentHeadTransformLocalQuat):(!this._mySessionActive||!this._myParams.myBlurEndResyncEnabled)&&(this._myBlurRecoverHeadTransform=null)),this._myDelayBlurEndResyncCounter=0,this._mySessionBlurred=!0}}();ae.prototype._onXRSessionBlurEnd=function(){return function(e){this._myActive&&(this._myDelaySessionChangeResyncCounter==0?this._myParams.myBlurEndResyncEnabled&&this._myBlurRecoverHeadTransform!=null&&this._mySessionActive?(this._myDelayBlurEndResyncCounter=this._myResyncCounterFrames,this._myVisibilityHidden):(this._myBlurRecoverHeadTransform=null,this._myDelayBlurEndResyncCounter=0):(this._myDelaySessionChangeResyncCounter=this._myResyncCounterFrames,this._myBlurRecoverHeadTransform=null)),this._mySessionBlurred=!1}}();ae.prototype._onViewReset=function(){return function(){this._myActive&&this._myParams.myResetTransformOnViewResetEnabled&&this._mySessionActive&&this.isSynced()&&this.teleportPlayerToHeadTransformQuat(this._getHeadTransformFromLocal(this._myCurrentHeadTransformLocalQuat))}}();ae.prototype._blurEndResync=function(){let i=c(),e=c(),t=c(),n=c(),o=c(),s=c(),a=c(),l=c(),u=j();return function(){this._myBlurRecoverHeadTransform!=null&&(this._mySessionChangeResyncHeadTransform!=null?(this._myBlurRecoverHeadTransform=null,this._sessionChangeResync()):(i=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(i),e=this._myCurrentHead.pp_getPosition(e),t=this._myBlurRecoverHeadTransform.quat2_getPosition(t),n=e.vec3_removeComponentAlongAxis(i,n),o=t.vec3_removeComponentAlongAxis(i,o),s=o.vec3_sub(n,s),this.moveFeet(s),a=this._myBlurRecoverHeadTransform.quat2_getForward(a),l=this._myCurrentHead.pp_getForward(l),u=l.vec3_rotationToPivotedQuat(a,i,u),this._myParams.myBlurEndResyncRotation&&this.rotateFeetQuat(u),this._myBlurRecoverHeadTransform=null))}}();ae.prototype._sessionChangeResync=function(){let i=c(),e=c(),t=j(),n=c(),o=c(),s=c(),a=c(),l=c(),u=c(),_=c(),m=c(),h=c(),d=c(),g=c(),P=c(),C=c(),f=j();return function(){if(this._myBlurRecoverHeadTransform==null&&this._mySessionChangeResyncHeadTransform!=null){if(this._mySessionActive){i=this._myCurrentHead.pp_getPosition(i),e=this._mySessionChangeResyncHeadTransform.quat2_getPosition(e),t=this._mySessionChangeResyncHeadTransform.quat2_getRotationQuat(t),n=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(n),o=i.vec3_removeComponentAlongAxis(n,o),s=e.vec3_removeComponentAlongAxis(n,s),a=s.vec3_sub(o,a),this.moveFeet(a);let M=I.isReferenceSpaceFloorBased(this._myParams.myEngine)||I.isDeviceEmulated(this._myParams.myEngine);if(this._myParams.myEnterSessionResyncHeight||this._myParams.myNextEnterSessionResyncHeight){this._myParams.myNextEnterSessionResyncHeight=!1;let D=this._getPositionHeight(e),v=this._getPositionHeight(i);this._myParams.myHeightOffsetVRWithoutFloor=D+this._myParams.myForeheadExtraHeight,this._myParams.myHeightOffsetVRWithFloor==null&&(this._myParams.myHeightOffsetVRWithFloor=0),this._myParams.myHeightOffsetVRWithFloor=this._myParams.myHeightOffsetVRWithFloor+(D-v),this._updateHeightOffset()}else if(M&&(this._myParams.myNextEnterSessionFloorHeight!=null||this._myParams.myEnterSessionFloorHeight!=null)){let D=this._myParams.myNextEnterSessionFloorHeight!=null?this._myParams.myNextEnterSessionFloorHeight:this._myParams.myEnterSessionFloorHeight;D-=this._myParams.myForeheadExtraHeight;let v=this._getPositionHeight(i);this._myParams.myHeightOffsetVRWithFloor==null&&(this._myParams.myHeightOffsetVRWithFloor=0),this._myParams.myHeightOffsetVRWithFloor=this._myParams.myHeightOffsetVRWithFloor+(D-v),this._updateHeightOffset()}this._resyncHeadRotationForward(t)}else{if(n=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(n),e=this._mySessionChangeResyncHeadTransform.quat2_getPosition(e),s=e.vec3_removeComponentAlongAxis(n,s),m=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getPosition(m),h=s.vec3_add(m.vec3_componentAlongAxis(n,h),h),r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_setPosition(h),r.getPlayerObjects(this._myParams.myEngine).myCameraNonXR.pp_resetPositionLocal(),this._myParams.myExitSessionResyncHeight){let M=this._getPositionHeight(e);this._myParams.myHeightOffsetNonVR=M+this._myParams.myForeheadExtraHeight,this._updateHeightOffset()}if(t=this._mySessionChangeResyncHeadTransform.quat2_getRotationQuat(t),this._myParams.myExitSessionRemoveRightTilt||this._myParams.myExitSessionAdjustMaxVerticalAngle||!this._myParams.myExitSessionResyncVerticalAngle){if(l=t.quat_getForward(l),u=t.quat_getUp(u),d=l.vec3_cross(n,d),d.vec3_normalize(d),!u.vec3_isConcordant(n)){let M=l.vec3_angle(n),D=45;(M>180-D||M<D)&&d.vec3_negate(d)}d.vec3_isZero(1e-6)&&(d=t.quat_getRight(d)),P=d.vec3_cross(l,P),P.vec3_normalize(P),C=P.vec3_cross(d,C),C.vec3_normalize(C),f.quat_fromAxes(d.vec3_negate(g),P,C),t.quat_copy(f)}if(this._myParams.myExitSessionAdjustMaxVerticalAngle||!this._myParams.myExitSessionResyncVerticalAngle){u=t.quat_getUp(u),_=t.quat_getRight(_);let M=Math.max(0,this._myParams.myExitSessionMaxVerticalAngle-1e-4);this._myParams.myExitSessionResyncVerticalAngle||(M=0);let D=Math.pp_angleClamp(u.vec3_angleSigned(n,_));if(Math.abs(D)>M){let v=(Math.abs(D)-M)*Math.pp_sign(D);t=t.quat_rotateAxis(v,_,t)}}this.setRotationHeadQuat(t)}this._mySessionActive&&(this._myParams.myNextEnterSessionFloorHeight=null,this._myFirstEnterSessionResyncDone=!0),this._mySessionChangeResyncHeadTransform=null}}}();ae.prototype._resyncHeadRotationForward=function(){let i=c(),e=c(),t=c(),n=j();return function(s){i=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(i),e=s.quat_getForward(e),t=s.quat_getUp(t),n.quat_copy(s),n.quat_setUp(i,e),t.vec3_isConcordant(i)||n.quat_rotateAxis(180,i,n),this.setRotationFeetQuat(n)}}();ae.prototype._updateHeightOffset=function(){return function(){this._mySessionActive?I.isDeviceEmulated(this._myParams.myEngine)?this._setReferenceSpaceHeightOffset(0,0):I.isReferenceSpaceFloorBased(this._myParams.myEngine)?this._setReferenceSpaceHeightOffset(this._myParams.myHeightOffsetVRWithFloor,0):this._setReferenceSpaceHeightOffset(this._myParams.myHeightOffsetVRWithoutFloor,this._myParams.myForeheadExtraHeight):this._setReferenceSpaceHeightOffset(this._myParams.myHeightOffsetNonVR,this._myParams.myForeheadExtraHeight)}}();ae.prototype._setReferenceSpaceHeightOffset=function(){let i=c();return function(t,n){t!=null&&(i=r.getPlayerObjects(this._myParams.myEngine).myReferenceSpace.pp_getPositionLocal(i),r.getPlayerObjects(this._myParams.myEngine).myReferenceSpace.pp_setPositionLocal([i[0],t-n,i[2]]))}}();ae.prototype._getHeadTransformFromLocal=function(){return function(e){return this._myCurrentHead.pp_convertTransformLocalToWorldQuat(e)}}();Object.defineProperty(ae.prototype,"_getPositionHeight",{enumerable:!1});Object.defineProperty(ae.prototype,"_onXRSessionStart",{enumerable:!1});Object.defineProperty(ae.prototype,"_onXRSessionEnd",{enumerable:!1});Object.defineProperty(ae.prototype,"_onXRSessionBlurStart",{enumerable:!1});Object.defineProperty(ae.prototype,"_onXRSessionBlurEnd",{enumerable:!1});Object.defineProperty(ae.prototype,"_onViewReset",{enumerable:!1});Object.defineProperty(ae.prototype,"_blurEndResync",{enumerable:!1});Object.defineProperty(ae.prototype,"_sessionChangeResync",{enumerable:!1});Object.defineProperty(ae.prototype,"_setReferenceSpaceHeightOffset",{enumerable:!1});var pe={BODY_COLLIDING:0,HEAD_COLLIDING:1,FAR:2,FLOATING:3},Ns=class{constructor(e=r.getMainEngine()){this.myPlayerHeadManager=null,this.myMovementCollisionCheckParams=null,this.myTeleportCollisionCheckParams=null,this.myTeleportCollisionCheckParamsCopyFromMovement=!1,this.myTeleportCollisionCheckParamsCheck360=!1,this.myAlwaysSyncPositionWithReal=!1,this.myAlwaysSyncHeadPositionWithReal=!1,this.mySyncEnabledFlagMap=new Map,this.mySyncEnabledFlagMap.set(pe.BODY_COLLIDING,!0),this.mySyncEnabledFlagMap.set(pe.HEAD_COLLIDING,!0),this.mySyncEnabledFlagMap.set(pe.FAR,!0),this.mySyncEnabledFlagMap.set(pe.FLOATING,!0),this.mySyncPositionFlagMap=new Map,this.mySyncPositionFlagMap.set(pe.BODY_COLLIDING,!0),this.mySyncPositionFlagMap.set(pe.HEAD_COLLIDING,!1),this.mySyncPositionFlagMap.set(pe.FAR,!0),this.mySyncPositionFlagMap.set(pe.FLOATING,!0),this.mySyncPositionHeadFlagMap=new Map,this.mySyncPositionHeadFlagMap.set(pe.BODY_COLLIDING,!1),this.mySyncPositionHeadFlagMap.set(pe.HEAD_COLLIDING,!0),this.mySyncPositionHeadFlagMap.set(pe.FAR,!1),this.mySyncPositionHeadFlagMap.set(pe.FLOATING,!1),this.mySyncRotationFlagMap=new Map,this.mySyncRotationFlagMap.set(pe.BODY_COLLIDING,!1),this.mySyncRotationFlagMap.set(pe.HEAD_COLLIDING,!1),this.mySyncRotationFlagMap.set(pe.FAR,!1),this.mySyncRotationFlagMap.set(pe.FLOATING,!1),this.mySyncHeightFlagMap=new Map,this.mySyncHeightFlagMap.set(pe.BODY_COLLIDING,!1),this.mySyncHeightFlagMap.set(pe.HEAD_COLLIDING,!1),this.mySyncHeightFlagMap.set(pe.FAR,!1),this.mySyncHeightFlagMap.set(pe.FLOATING,!1),this.myIsLeaningValidAboveDistance=!1,this.myLeaningValidDistance=0,this.myIsFloatingValidIfVerticalMovement=!1,this.myIsFloatingValidIfVerticalMovementAndRealOnGround=!1,this.myIsFloatingValidIfRealOnGround=!1,this.myIsFloatingValidIfSteepGround=!1,this.myIsFloatingValidIfVerticalMovementAndSteepGround=!1,this.myFloatingSplitCheckEnabled=!1,this.myFloatingSplitCheckMaxLength=0,this.myFloatingSplitCheckMaxSteps=null,this.myFloatingSplitCheckStepEqualLength=!1,this.myFloatingSplitCheckStepEqualLengthMinLength=0,this.myMaxDistanceFromRealToSyncEnabled=!1,this.myMaxDistanceFromRealToSync=0,this.myHeadRadius=0,this.myHeadCollisionBlockLayerFlags=new Ve,this.myHeadCollisionObjectsToIgnore=[],this.myRotateOnlyIfSynced=!1,this.myResetRealResetRotationIfUpChanged=!0,this.myRealMovementAllowVerticalAdjustments=!1,this.myUpdateRealPositionValid=!1,this.myUpdatePositionValid=!1,this.myMinHeight=null,this.myMaxHeight=null,this.myIsBodyCollidingWhenHeightBelowValue=null,this.myIsBodyCollidingWhenHeightAboveValue=null,this.myIsBodyCollidingExtraCheckCallback=null,this.myIsLeaningExtraCheckCallback=null,this.myIsHoppingExtraCheckCallback=null,this.myIsFarExtraCheckCallback=null,this.myResetToValidOnEnterSession=!1,this.myResetToValidOnExitSession=!1,this.myAlwaysResetRealPositionNonVR=!1,this.myAlwaysResetRealRotationNonVR=!1,this.myAlwaysResetRealHeightNonVR=!1,this.myAlwaysResetRealPositionVR=!1,this.myAlwaysResetRealRotationVR=!1,this.myAlwaysResetRealHeightVR=!1,this.myNeverResetRealPositionNonVR=!1,this.myNeverResetRealRotationNonVR=!1,this.myNeverResetRealHeightNonVR=!1,this.myNeverResetRealPositionVR=!1,this.myNeverResetRealRotationVR=!1,this.myNeverResetRealHeightVR=!1,this.myResetRealOnMove=!1,this.myResetRealOnTeleport=!1,this.mySyncPositionDisabled=!1,this.myEngine=e,this.myDebugEnabled=!1}destroy(){this._myDestroyed=!0,I.unregisterSessionStartEndEventListeners(this,this._myParams.myEngine)}isDestroyed(){return this._myDestroyed}},at=class{constructor(e){this._myParams=e,this._myRealMovementCollisionCheckParams=null,this._generateRealMovementParamsFromMovementParams(),this._myCollisionRuntimeParams=new _e,this._myRealCollisionRuntimeParams=new _e,this._myParams.myTeleportCollisionCheckParamsCopyFromMovement&&this._generateTeleportParamsFromMovementParams(),this._myHeadCollisionCheckParams=null,this._setupHeadCollisionCheckParams(),this._myValidPosition=c(),this._myValidRotationQuat=j(),this._myValidHeight=0,this._myValidPositionHead=c(),this._myIsBodyColliding=!1,this._myIsHeadColliding=!1,this._myIsLeaning=!1,this._myIsHopping=!1,this._myIsFar=!1,this._myLastValidMovementDirection=c(),this._myIsRealPositionValid=!1,this._myIsPositionValid=!1,this._myResetRealOnSynced=!1,this._myActive=!0,this._myDestroyed=!1}start(){this.resetToReal(!0),I.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!0,this._myParams.myEngine)}getParams(){return this._myParams}setActive(e){this._myActive=e}update(e){}move(e,t=null,n=!1){}teleportPosition(e,t=null,n=!1){}teleportPositionRotationQuat(e,t,n=null,o=!1){}teleportTransformQuat(e,t=null,n=!1){}forceTeleportAndReset(e,t){this.teleportPositionRotationQuat(e,t,null,!0),this.resetReal(!0,!0)}rotateQuat(e){}setRotationQuat(e){}setHeight(e,t=!1){}getPlayer(){return this._myParams.myPlayerHeadManager.getPlayer()}getHead(){return this._myParams.myPlayerHeadManager.getHead()}getTransformQuat(e=N()){return e.quat2_setPositionRotationQuat(this.getPosition(this._myValidPosition),this.getRotationQuat(this._myValidRotationQuat))}getPosition(e=c()){return e.vec3_copy(this._myValidPosition)}getRotationQuat(e=j()){return e.quat_copy(this._myValidRotationQuat)}getPositionHead(e=c()){return e.vec3_copy(this._myValidPositionHead)}getTransformHeadQuat(e=N()){return e.quat2_setPositionRotationQuat(this.getPositionHead(this._myValidPositionHead),this.getRotationQuat(this._myValidRotationQuat))}getHeight(){return this._myValidHeight}getTransformRealQuat(e=N()){return this.getPlayerHeadManager().getTransformFeetQuat(e)}getTransformHeadRealQuat(e=N()){return this.getPlayerHeadManager().getTransformHeadQuat(e)}getPositionReal(e=c()){return this.getPlayerHeadManager().getPositionFeet(e)}getPositionHeadReal(e=c()){return this.getPlayerHeadManager().getPositionHead(e)}getRotationRealQuat(e=j()){return this.getPlayerHeadManager().getRotationFeetQuat(e)}getHeightReal(){return this._myParams.myPlayerHeadManager.getHeightHead()}isSynced(e=null){let t=this.isBodyColliding()&&(e==null||e.get(pe.BODY_COLLIDING)),n=this.isHeadColliding()&&(e==null||e.get(pe.HEAD_COLLIDING)),o=this.isFar()&&(e==null||e.get(pe.FAR)),s=this.isFloating()&&(e==null||e.get(pe.FLOATING));return!t&&!n&&!o&&!s}resetReal(e=!0,t=!1,n=!1,o=!0,s=!1){}updateReal(){this._updateReal(0)}resetToReal(e=!1,t=!1){e?this._myValidPosition=this.getPlayerHeadManager().getPlayer().pp_getPosition(this._myValidPosition):this._myValidPosition=this.getPositionReal(this._myValidPosition),this._myParams.myAlwaysSyncPositionWithReal||(this._myValidPositionHead=this.getPositionHeadReal(this._myValidPositionHead)),e?this._myValidRotationQuat=this.getPlayerHeadManager().getPlayer().pp_getRotationQuat(this._myValidRotationQuat):this._myValidRotationQuat=this.getRotationRealQuat(this._myValidRotationQuat),this._myValidHeight=Math.pp_clamp(this.getHeightReal(),this._myParams.myMinHeight,this._myParams.myMaxHeight),t&&this._updateReal(0)}resetHeadToReal(){this._myParams.myAlwaysSyncPositionWithReal||(this._myValidPositionHead=this.getPositionHeadReal(this._myValidPositionHead))}isBodyColliding(){return this._myIsBodyColliding}isHeadColliding(){return this._myIsHeadColliding}isFloating(){return this.isLeaning()||this.isHopping()}isLeaning(){return this._myIsLeaning}isHopping(){return this._myIsHopping}isFar(){return this._myIsFar}getDistanceToReal(){}getDistanceToRealHead(){}getPlayerHeadManager(){return this._myParams.myPlayerHeadManager}getMovementCollisionCheckParams(){return this._myParams.myMovementCollisionCheckParams}getTeleportCollisionCheckParams(){return this._myParams.myTeleportCollisionCheckParams}collisionCheckParamsUpdated(){this._myParams.myTeleportCollisionCheckParamsCopyFromMovement&&this._generateTeleportParamsFromMovementParams(),this._generateRealMovementParamsFromMovementParams()}isPositionValid(){return this._myIsPositionValid}isRealPositionValid(){return this._myIsRealPositionValid}getCollisionRuntimeParams(){return this._myCollisionRuntimeParams}getRealCollisionRuntimeParams(){return this._myRealCollisionRuntimeParams}_updateCollisionHeight(){let e=this.getHeight(),t=Math.pp_clamp(this.getHeightReal(),this._myParams.myMinHeight,this._myParams.myMaxHeight);this._myParams.myMovementCollisionCheckParams.myHeight=e,this._myParams.myTeleportCollisionCheckParams.myHeight=e,this._myRealMovementCollisionCheckParams.myHeight=t}_setupHeadCollisionCheckParams(){this._myHeadCollisionCheckParams=new st;let e=this._myHeadCollisionCheckParams;e.myRadius=this._myParams.myHeadRadius,e.myDistanceFromFeetToIgnore=0,e.myDistanceFromHeadToIgnore=0,e.mySplitMovementEnabled=!0,e.mySplitMovementMaxLength=.5,e.mySplitMovementMaxStepsEnabled=!0,e.mySplitMovementMaxSteps=2,e.mySplitMovementStopWhenHorizontalMovementCanceled=!0,e.mySplitMovementStopWhenVerticalMovementCanceled=!0,e.myHorizontalMovementCheckEnabled=!0,e.myHorizontalMovementRadialStepAmount=1,e.myHorizontalMovementCheckDiagonalOutward=!0,e.myHorizontalMovementCheckDiagonalInward=!0,e.myHorizontalMovementCheckVerticalDiagonalUpwardOutward=!0,e.myHorizontalMovementCheckVerticalDiagonalUpwardInward=!0,e.myHorizontalPositionCheckEnabled=!0,e.myHalfConeAngle=180,e.myHalfConeSliceAmount=3,e.myCheckConeBorder=!0,e.myCheckConeRay=!0,e.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision=!1,e.myHorizontalPositionCheckVerticalDirectionType=0,e.myHeight=e.myRadius,e.myPositionOffsetLocal.vec3_set(0,-e.myRadius/2,0),e.myCheckHeight=!0,e.myCheckHeightVerticalMovement=!0,e.myCheckHeightVerticalPosition=!0,e.myHeightCheckStepAmountMovement=2,e.myHeightCheckStepAmountPosition=2,e.myCheckHeightTopMovement=!0,e.myCheckHeightTopPosition=!0,e.myCheckVerticalStraight=!0,e.myCheckVerticalFixedForwardEnabled=!0,e.myCheckVerticalFixedForward=c(0,0,1),e.myCheckHorizontalFixedForwardEnabled=!0,e.myCheckHorizontalFixedForward=c(0,0,1),e.myVerticalMovementCheckEnabled=!0,e.myVerticalPositionCheckEnabled=!0,e.myGroundCircumferenceAddCenter=!0,e.myGroundCircumferenceSliceAmount=6,e.myGroundCircumferenceStepAmount=2,e.myGroundCircumferenceRotationPerStep=30,e.myFeetRadius=e.myRadius,e.myHorizontalBlockLayerFlags.copy(this._myParams.myHeadCollisionBlockLayerFlags),e.myHorizontalObjectsToIgnore.pp_copy(this._myParams.myHeadCollisionObjectsToIgnore),e.myVerticalBlockLayerFlags.copy(this._myParams.myHeadCollisionBlockLayerFlags),e.myVerticalObjectsToIgnore.pp_copy(this._myParams.myHeadCollisionObjectsToIgnore),e.myDebugEnabled=!1,e.myDebugHorizontalMovementEnabled=!0,e.myDebugHorizontalPositionEnabled=!1,e.myDebugVerticalMovementEnabled=!1,e.myDebugVerticalPositionEnabled=!1,e.myDebugSlidingEnabled=!1,e.myDebugGroundInfoEnabled=!1,e.myDebugCeilingInfoEnabled=!1,e.myDebugRuntimeParamsEnabled=!1,e.myDebugMovementEnabled=!1}_generateTeleportParamsFromMovementParams(){this._myParams.myTeleportCollisionCheckParams==null&&(this._myParams.myTeleportCollisionCheckParams=new st),this._myParams.myTeleportCollisionCheckParamsCheck360?this._myParams.myTeleportCollisionCheckParams=Is.generate360TeleportParamsFromMovementParams(this._myParams.myMovementCollisionCheckParams,this._myParams.myTeleportCollisionCheckParams):this._myParams.myTeleportCollisionCheckParams.copy(this._myParams.myMovementCollisionCheckParams)}_generateRealMovementParamsFromMovementParams(){this._myRealMovementCollisionCheckParams==null&&(this._myRealMovementCollisionCheckParams=new st);let e=this._myRealMovementCollisionCheckParams;e.copy(this._myParams.myMovementCollisionCheckParams),e.mySplitMovementEnabled=!0,e.mySplitMovementMaxLength=.5,e.mySplitMovementMaxStepsEnabled=!0,e.mySplitMovementMaxSteps=2,e.mySplitMovementStopWhenHorizontalMovementCanceled=!0,e.mySplitMovementStopWhenVerticalMovementCanceled=!0,e.mySlidingEnabled=!1,this._myParams.myRealMovementAllowVerticalAdjustments||(e.mySnapOnGroundEnabled=!1,e.mySnapOnCeilingEnabled=!1,e.myGroundPopOutEnabled=!1,e.myCeilingPopOutEnabled=!1,e.myAdjustVerticalMovementWithGroundAngleDownhill=!1,e.myAdjustVerticalMovementWithGroundAngleUphill=!1,e.myAdjustVerticalMovementWithCeilingAngleDownhill=!1,e.myAdjustVerticalMovementWithCeilingAngleUphill=!1,e.myAdjustHorizontalMovementWithGroundAngleDownhill=!1,e.myAdjustHorizontalMovementWithCeilingAngleDownhill=!1,e.myVerticalMovementReduceEnabled=!1),e.myIsOnGroundIfInsideHit=!0,e.myDebugEnabled=!1,e.myDebugHorizontalMovementEnabled=!1,e.myDebugHorizontalPositionEnabled=!1,e.myDebugVerticalMovementEnabled=!1,e.myDebugVerticalPositionEnabled=!1,e.myDebugSlidingEnabled=!1,e.myDebugGroundInfoEnabled=!0,e.myDebugCeilingInfoEnabled=!0,e.myDebugRuntimeParamsEnabled=!1,e.myDebugMovementEnabled=!1}_onXRSessionStart(e,t){this._myActive&&this._myParams.myResetToValidOnEnterSession&&(this._myResetRealOnSynced=!0)}_onXRSessionEnd(){this._myActive&&this._myParams.myResetToValidOnExitSession&&(this._myResetRealOnSynced=!0)}_debugUpdate(e){r.getDebugVisualManager(this._myParams.myEngine).drawPoint(0,this._myValidPosition,F(1,0,0,1),.05),r.getDebugVisualManager(this._myParams.myEngine).drawLineEnd(0,this._myValidPosition,this.getPositionReal(),F(1,0,0,1),.05),r.getDebugVisualManager(this._myParams.myEngine).drawLine(0,this._myValidPosition,this._myValidRotationQuat.quat_getForward(),.15,F(0,1,0,1),.025),r.getDebugVisualManager(this._myParams.myEngine).drawPoint(0,this._myValidPositionHead,F(1,1,0,1),.05)}destroy(){this._myDestroyed=!0,I.unregisterSessionStartEndEventListeners(this,this._myParams.myEngine)}isDestroyed(){return this._myDestroyed}};at.prototype.getDistanceToReal=function(){let i=c();return function(){return i=this.getPositionReal(i),i.vec3_distance(this.getPosition())}}();at.prototype.getDistanceToRealHead=function(){let i=c();return function(){return i=this.getPositionHeadReal(i),i.vec3_distance(this.getPositionHead())}}();at.prototype.resetReal=function(){let i=c(),e=c(),t=c(),n=j();return function(s=!0,a=!1,l=!1,u=!0,_=!1){let m=this.getPlayerHeadManager();s&&m.teleportPositionFeet(this.getPosition(t)),i=this.getPlayerHeadManager().getRotationFeetQuat(n).quat_getUp(i),e=this.getRotationQuat(n).quat_getUp(e),(a||i.vec3_angle(e)>Math.PP_EPSILON_DEGREES&&this._myParams.myResetRealResetRotationIfUpChanged)&&m.setRotationFeetQuat(this.getRotationQuat(n),!1),l&&m.setHeightHead(this.getHeight(),!0),_&&this._updateReal(0),u&&this.resetHeadToReal()}}();at.prototype.update=function(){let i=N(),e=new _e,t=c(),n=c(),o=j();return function(a){if(this._updateReal(a),this._myResetRealOnSynced&&this.getPlayerHeadManager().isSynced()&&(this._myResetRealOnSynced=!1,I.isSessionActive(this._myParams.myEngine)?this.resetReal(!this._myParams.myNeverResetRealPositionVR,!this._myParams.myNeverResetRealRotationVR,!this._myParams.myNeverResetRealHeightVR,!0,!0):this.resetReal(!this._myParams.myNeverResetRealPositionNonVR,!this._myParams.myNeverResetRealRotationNonVR,!this._myParams.myNeverResetRealHeightNonVR,!0,!0)),this._myParams.myUpdatePositionValid){i=this.getTransformQuat(i),t=i.quat2_getUp(t),o=i.quat2_getRotationQuat(o),n=this._myLastValidMovementDirection.vec3_removeComponentAlongAxis(t,n),n.vec3_isZero(1e-5)||(n.vec3_normalize(n),o.quat_setForward(n),i.quat2_setRotationQuat(o));let l=this._myParams.myMovementCollisionCheckParams.myDebugEnabled;this._myParams.myMovementCollisionCheckParams.myDebugEnabled=!1,q.getCollisionCheck(this._myParams.myEngine).positionCheck(!0,i,this._myParams.myMovementCollisionCheckParams,e),this._myParams.myMovementCollisionCheckParams.myDebugEnabled=l,this._myIsPositionValid=e.myIsPositionOk}this._myParams.myDebugEnabled&&r.isDebugEnabled(this._myParams.myEngine)&&this._debugUpdate(a)}}();at.prototype._updateReal=function(){let i=c(),e=c(),t=c(),n=N(),o=new _e,s=c(),a=c(),l=c(),u=c(),_=c(),m=c(),h=c(),d=c(),g=N(),P=c(),C=j();return function(S){if(this.getPlayerHeadManager().isSynced()){if(this._updateCollisionHeight(),this._myIsBodyColliding=!1,this._myIsHeadColliding=!1,this._myIsLeaning=!1,this._myIsHopping=!1,this._myIsFar=!1,i=this.getPositionReal(t).vec3_sub(this.getPosition(e),i),i.vec3_length()>1e-4&&(this._myLastValidMovementDirection=i.vec3_normalize(this._myLastValidMovementDirection)),this._myParams.mySyncEnabledFlagMap.get(pe.FAR)&&(this._myParams.myMaxDistanceFromRealToSyncEnabled&&i.vec3_length()>this._myParams.myMaxDistanceFromRealToSync?this._myIsFar=!0:this._myParams.myIsFarExtraCheckCallback!=null&&this._myParams.myIsFarExtraCheckCallback(this)&&(this._myIsFar=!0)),o.copy(this._myCollisionRuntimeParams),o.myIsOnGround=!0,n=this.getTransformQuat(n),s.vec3_copy(this._myValidPosition),this._myParams.mySyncEnabledFlagMap.get(pe.BODY_COLLIDING)&&(q.getCollisionCheck(this._myParams.myEngine).move(i,n,this._myRealMovementCollisionCheckParams,o),!o.myHorizontalMovementCanceled&&!o.myVerticalMovementCanceled?Math.pp_clamp(this._myRealMovementCollisionCheckParams.myHeight,this._myParams.myIsBodyCollidingWhenHeightBelowValue,this._myParams.myIsBodyCollidingWhenHeightAboveValue)!=this._myRealMovementCollisionCheckParams.myHeight?this._myIsBodyColliding=!0:this._myParams.myIsBodyCollidingExtraCheckCallback!=null&&this._myParams.myIsBodyCollidingExtraCheckCallback(this)?this._myIsBodyColliding=!0:(this._myIsBodyColliding=!1,s.vec3_copy(o.myNewPosition)):this._myIsBodyColliding=!0),this._myParams.myAlwaysSyncPositionWithReal&&s.vec3_copy(t),this._myParams.mySyncEnabledFlagMap.get(pe.FLOATING)&&(this._myIsBodyColliding?i=t.vec3_sub(e,i):i=s.vec3_sub(e,i),o.copy(this._myCollisionRuntimeParams),g.quat2_setPositionRotationQuat(this._myValidPosition,this._myValidRotationQuat),q.getCollisionCheck(this._myParams.myEngine).updateSurfaceInfo(g,this._myRealMovementCollisionCheckParams,o),o.myIsOnGround)){_=n.quat2_getUp(_),m=i.vec3_componentAlongAxis(_,m);let M=!m.vec3_isZero(1e-5);if(!M||!this._myParams.myIsFloatingValidIfVerticalMovement){let D=1;if(l.vec3_copy(i),!i.vec3_isZero(1e-5)&&this._myParams.myFloatingSplitCheckEnabled){let Q=i.vec3_length()/this._myParams.myFloatingSplitCheckMaxSteps;if(!this._myParams.myFloatingSplitCheckStepEqualLength||Q<this._myParams.myFloatingSplitCheckStepEqualLengthMinLength){let ue=this._myParams.myFloatingSplitCheckStepEqualLength?this._myParams.myFloatingSplitCheckStepEqualLengthMinLength:this._myParams.myFloatingSplitCheckMaxLength;D=Math.ceil(i.vec3_length()/ue),D>1&&(l=l.vec3_normalize(l).vec3_scale(ue,l),D=this._myParams.myFloatingSplitCheckMaxSteps!=null?Math.min(D,this._myParams.myFloatingSplitCheckMaxSteps):D),D=Math.max(1,D),D==1&&l.vec3_copy(i)}else D=this._myParams.myFloatingSplitCheckMaxSteps,D>1&&(l=l.vec3_normalize(l).vec3_scale(Q,l))}let v=o.myGroundAngle<=this._myRealMovementCollisionCheckParams.myGroundAngleToIgnore+1e-4;h.vec3_zero(),d.vec3_copy(this._myValidPosition),o.copy(this._myCollisionRuntimeParams);let b=!1,x=!1,B=!1,H=!1;for(let Q=0;Q<D;Q++)D==1||Q!=D-1?u.vec3_copy(l):u=i.vec3_sub(h,u),d=d.vec3_add(u,d),g.quat2_setPositionRotationQuat(d,this._myValidRotationQuat),o.copy(this._myCollisionRuntimeParams),q.getCollisionCheck(this._myParams.myEngine).updateSurfaceInfo(g,this._myRealMovementCollisionCheckParams,o),h=h.vec3_add(u,h),o.myIsOnGround?(o.myGroundAngle>this._myRealMovementCollisionCheckParams.myGroundAngleToIgnore+1e-4&&(H=!0),b&&(x=!0),Q==D-1&&(B=!0)):b=!0;let w=H&&v&&!this._myParams.myIsFloatingValidIfSteepGround&&(!M||!this._myParams.myIsFloatingValidIfVerticalMovementAndSteepGround);if(b||w?x?this._myIsHopping=!0:this._myIsLeaning=!0:(this._myIsLeaning=!1,this._myIsHopping=!1,this._myParams.myIsLeaningExtraCheckCallback!=null&&this._myParams.myIsLeaningExtraCheckCallback(this)?this._myIsLeaning=!0:this._myParams.myIsHoppingExtraCheckCallback!=null&&this._myParams.myIsHoppingExtraCheckCallback(this)&&(this._myIsHopping=!0)),this._myIsLeaning){let Q=i.vec3_length();this._myParams.myIsLeaningValidAboveDistance&&Q>this._myParams.myLeaningValidDistance&&(this._myIsLeaning=!1)}(this._myIsLeaning||this._myIsHopping)&&(B&&this._myParams.myIsFloatingValidIfRealOnGround?(this._myIsLeaning=!1,this._myIsHopping=!1):B&&M&&this._myParams.myIsFloatingValidIfVerticalMovementAndRealOnGround&&(this._myIsLeaning=!1,this._myIsHopping=!1))}}if(i=this.getPositionHeadReal(t).vec3_sub(this.getPositionHead(e),i),o.reset(),n=this.getTransformHeadQuat(n),a.vec3_copy(this._myValidPositionHead),this._myParams.mySyncEnabledFlagMap.get(pe.HEAD_COLLIDING)&&(q.getCollisionCheck(this._myParams.myEngine).move(i,n,this._myHeadCollisionCheckParams,o),!o.myHorizontalMovementCanceled&&!o.myVerticalMovementCanceled?(this._myIsHeadColliding=!1,a.vec3_copy(o.myNewPosition)):this._myIsHeadColliding=!0),this._myParams.myAlwaysSyncHeadPositionWithReal&&a.vec3_copy(t),(this.isSynced(this._myParams.mySyncPositionFlagMap)||this._myParams.myAlwaysSyncPositionWithReal)&&!this._myParams.mySyncPositionDisabled&&this._myValidPosition.vec3_copy(s),(this.isSynced(this._myParams.mySyncPositionHeadFlagMap)||this._myParams.myAlwaysSyncHeadPositionWithReal||this.isSynced(this._myParams.mySyncPositionFlagMap)&&this._myParams.myAlwaysSyncPositionWithReal)&&(this._myValidPositionHead=this.getPositionHeadReal(a)),this.isSynced(this._myParams.mySyncRotationFlagMap)&&(this._myValidRotationQuat=this.getRotationRealQuat(this._myValidRotationQuat)),this.isSynced(this._myParams.mySyncHeightFlagMap)&&(this._myValidHeight=this._myRealMovementCollisionCheckParams.myHeight,this._updateCollisionHeight()),this._myParams.myUpdateRealPositionValid){n=this.getTransformRealQuat(n),_=n.quat2_getUp(_),C=n.quat2_getRotationQuat(C),P=this._myLastValidMovementDirection.vec3_removeComponentAlongAxis(_,P),P.vec3_isZero(1e-5)||(P.vec3_normalize(P),C.quat_setForward(P),n.quat2_setRotationQuat(C));let M=this._myParams.myMovementCollisionCheckParams.myDebugEnabled;this._myParams.myMovementCollisionCheckParams.myDebugEnabled=!1,q.getCollisionCheck(this._myParams.myEngine).positionCheck(!0,n,this._myParams.myMovementCollisionCheckParams,this._myRealCollisionRuntimeParams),this._myIsRealPositionValid=this._myRealCollisionRuntimeParams.myIsPositionOk,this._myParams.myMovementCollisionCheckParams.myDebugEnabled=M}}}}();at.prototype.move=function(){let i=N(),e=c();return function(n,o=null,s=!1){i=this.getTransformQuat(i),q.getCollisionCheck(this._myParams.myEngine).move(n,i,this._myParams.myMovementCollisionCheckParams,this._myCollisionRuntimeParams),o?.copy(this._myCollisionRuntimeParams),s?e.vec3_copy(n):e.vec3_copy(this._myCollisionRuntimeParams.myFixedMovement),e.vec3_isZero(1e-5)||(this._myValidPosition.vec3_add(e,this._myValidPosition),this.getPlayerHeadManager().moveFeet(e)),this._myParams.myResetRealOnMove&&(this.isSynced()||(I.isSessionActive(this._myParams.myEngine)?this.resetReal(!this._myParams.myNeverResetRealPositionVR,!this._myParams.myNeverResetRealRotationVR,!this._myParams.myNeverResetRealHeightVR,!0):this.resetReal(!this._myParams.myNeverResetRealPositionNonVR,!this._myParams.myNeverResetRealRotationNonVR,!this._myParams.myNeverResetRealHeightNonVR,!0)))}}();at.prototype.teleportPosition=function(){let i=N();return function(e,t=null,n=!1){i=this.getTransformQuat(i),i.quat2_setPosition(e),this.teleportTransformQuat(i,t,n)}}();at.prototype.teleportPositionRotationQuat=function(){let i=N();return function(t,n,o=null,s=!1){i=this.getTransformQuat(i),i.quat2_setPositionRotationQuat(t,n),this.teleportTransformQuat(i,o,s)}}();at.prototype.teleportTransformQuat=function(){let i=c(),e=c(),t=j(),n=N(),o=c();return function(s,a=null,l=!1){i=this.getPosition(i),e=s.quat2_getPosition(e),t=s.quat2_getRotationQuat(t),n.quat2_setPositionRotationQuat(i,t),q.getCollisionCheck(this._myParams.myEngine).teleport(e,n,this._myParams.myTeleportCollisionCheckParams,this._myCollisionRuntimeParams),a?.copy(this._myCollisionRuntimeParams),o.vec3_zero(),l?o=e.vec3_sub(i,o):this._myCollisionRuntimeParams.myTeleportCanceled||(o=this._myCollisionRuntimeParams.myFixedTeleportPosition.vec3_sub(i,o)),(!this._myCollisionRuntimeParams.myTeleportCanceled||l)&&(this._myValidRotationQuat.quat_copy(t),this.getPlayerHeadManager().setRotationFeetQuat(t)),o.vec3_isZero(1e-5)||(this._myValidPosition.vec3_add(o,this._myValidPosition),this.getPlayerHeadManager().moveFeet(o)),this._myParams.myResetRealOnTeleport&&(this.isSynced()||(I.isSessionActive(this._myParams.myEngine)?this.resetReal(!this._myParams.myNeverResetRealPositionVR,!this._myParams.myNeverResetRealRotationVR,!this._myParams.myNeverResetRealHeightVR,!0):this.resetReal(!this._myParams.myNeverResetRealPositionNonVR,!this._myParams.myNeverResetRealRotationNonVR,!this._myParams.myNeverResetRealHeightNonVR,!0)))}}();at.prototype.rotateQuat=function(){return function(e){this._myValidRotationQuat.quat_rotateQuat(e,this._myValidRotationQuat),this.getPlayerHeadManager().rotateFeetQuat(e)}}();at.prototype.setRotationQuat=function(){let i=j();return function(t){i=this._myValidRotationQuat.quat_rotationToQuat(t,i),this.rotateQuat(i)}}();at.prototype.setHeight=function(){let i=N();return function(t,n=!1){let o=Math.pp_clamp(t,this._myParams.myMinHeight,this._myParams.myMaxHeight),s=this.getHeight();this._myValidHeight=o,this._updateCollisionHeight(),i=this.getTransformQuat(i),q.getCollisionCheck(this._myParams.myEngine).positionCheck(!0,i,this._myParams.myMovementCollisionCheckParams,this._myCollisionRuntimeParams),this._myCollisionRuntimeParams.myIsPositionOk||n?this.getPlayerHeadManager().setHeightHead(this.getHeight(),!0):this._myValidHeight=s,this._updateCollisionHeight()}}();var Gs=class{constructor(e=r.getMainEngine()){this.myPlayerHeadManager=null,this.myMaxRotationSpeed=0,this.myIsSnapTurn=!1,this.mySnapTurnOnlyVR=!1,this.mySmoothSnapEnabled=!0,this.mySmoothSnapSpeedDegrees=240,this.myRotationMinStickIntensityThreshold=0,this.mySnapTurnActivateThreshold=0,this.mySnapTurnResetThreshold=0,this.myClampVerticalAngle=!0,this.myMaxVerticalAngle=0,this.myHandedness=A.RIGHT,this.myEngine=e}},Mi=class{constructor(e){this._myParams=e,this._mySnapCharge=!1,this._mySmoothSnapHorizontalRunning=!1,this._mySmoothSnapHorizontalAngleToPerform=0,this._mySmoothSnapVerticalRunning=!1,this._mySmoothSnapVerticalAngleToPerform=0}start(){}stop(){this._mySmoothSnapHorizontalRunning=!1,this._mySmoothSnapHorizontalAngleToPerform=0,this._mySmoothSnapVerticalRunning=!1,this._mySmoothSnapVerticalAngleToPerform=0}getParams(){return this._myParams}update(e){this._rotateHeadHorizontally(e),this._myParams.myPlayerHeadManager.canRotateHead()&&this._rotateHeadVertically(e)}};Mi.prototype._rotateHeadHorizontally=function(){let i=c(),e=j();return function(n){i=this._myParams.myPlayerHeadManager.getPlayer().pp_getUp(i),e.quat_identity();let o=r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getAxesInfo(oe.THUMBSTICK).getAxes();if(!this._myParams.myIsSnapTurn||this._myParams.mySnapTurnOnlyVR&&!I.isSessionActive(this._myParams.myEngine)){if(Math.abs(o[0])>this._myParams.myRotationMinStickIntensityThreshold){let s=-o[0],a=Math.pp_lerp(0,this._myParams.myMaxRotationSpeed,Math.abs(s))*Math.pp_sign(s);e.quat_fromAxis(a*n,i)}}else if(!this._mySnapCharge)Math.abs(o.vec2_length())<this._myParams.mySnapTurnResetThreshold&&(this._mySnapCharge=!0);else if(!this._mySmoothSnapHorizontalRunning&&Math.abs(o[0])>this._myParams.mySnapTurnActivateThreshold){let s=-Math.pp_sign(o[0])*this._myParams.mySnapTurnAngle;this._myParams.mySmoothSnapEnabled?(this._mySmoothSnapHorizontalRunning=!0,this._mySmoothSnapHorizontalAngleToPerform=s):e.quat_fromAxis(s,i),this._mySnapCharge=!1}if(this._mySmoothSnapHorizontalRunning){let s=Math.pp_sign(this._mySmoothSnapHorizontalAngleToPerform)*(this._myParams.mySmoothSnapSpeedDegrees*n);Math.abs(s)>Math.abs(this._mySmoothSnapHorizontalAngleToPerform)-Math.PP_EPSILON&&(s=this._mySmoothSnapHorizontalAngleToPerform),e.quat_fromAxis(s,i),this._mySmoothSnapHorizontalAngleToPerform-=s,Math.abs(this._mySmoothSnapHorizontalAngleToPerform)<Math.PP_EPSILON&&(this._mySmoothSnapHorizontalRunning=!1,this._mySmoothSnapHorizontalAngleToPerform=0)}e.quat_getAngle()>Math.PP_EPSILON_DEGREES&&this._myParams.myPlayerTransformManager.rotateQuat(e)}}();Mi.prototype._rotateHeadVertically=function(){let i=c(),e=c(),t=c(),n=c(),o=c(),s=c(),a=j();return function(u){let _=this._myParams.myPlayerHeadManager.getHead();i=_.pp_getForward(i),e=_.pp_getUp(e),t=this._myParams.myPlayerHeadManager.getPlayer().pp_getUp(t),n=t.vec3_negate(n),o=i.vec3_cross(t,o);let m=1;i.vec3_angle(t)<m?o=e.vec3_negate(o).vec3_cross(t,o):i.vec3_angle(n)<m?o=e.vec3_cross(t,o):e.vec3_isConcordant(t)||o.vec3_negate(o),o.vec3_normalize(o);let h=r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getAxesInfo(oe.THUMBSTICK).getAxes(),d=0;if(!this._myParams.myIsSnapTurn||this._myParams.mySnapTurnOnlyVR&&!I.isSessionActive(this._myParams.myEngine)){if(Math.abs(h[1])>this._myParams.myRotationMinStickIntensityThreshold){let g=h[1];d=Math.pp_lerp(0,this._myParams.myMaxRotationSpeed,Math.abs(g))*Math.pp_sign(g)*u}}else if(!this._mySnapCharge)Math.abs(h.vec2_length())<this._myParams.mySnapTurnResetThreshold&&(this._mySnapCharge=!0);else if(!this._mySmoothSnapVerticalRunning&&Math.abs(h[1])>this._myParams.mySnapTurnActivateThreshold){d=Math.pp_sign(h[1])*this._myParams.mySnapTurnAngle;let g=Math.pp_angleClamp(e.vec3_angleSigned(t,o)),P=Math.round(g/this._myParams.mySnapTurnAngle),C=Math.pp_angleClamp(P*this._myParams.mySnapTurnAngle),f=-Math.pp_angleDistanceSigned(g,C);Math.abs(f)>1?Math.pp_sign(d)==Math.pp_sign(f)?d=f:d=-Math.pp_sign(f)*this._myParams.mySnapTurnAngle+f:Math.abs(f)>Math.PP_EPSILON_DEGREES&&(d+=f),this._myParams.mySmoothSnapEnabled&&(this._mySmoothSnapVerticalRunning=!0,this._mySmoothSnapVerticalAngleToPerform=d),this._mySnapCharge=!1}if(this._mySmoothSnapVerticalRunning&&(d=Math.pp_sign(this._mySmoothSnapVerticalAngleToPerform)*(this._myParams.mySmoothSnapSpeedDegrees*u),Math.abs(d)>Math.abs(this._mySmoothSnapVerticalAngleToPerform)-Math.PP_EPSILON&&(d=this._mySmoothSnapVerticalAngleToPerform),this._mySmoothSnapVerticalAngleToPerform-=d,Math.abs(this._mySmoothSnapVerticalAngleToPerform)<Math.PP_EPSILON&&(this._mySmoothSnapVerticalRunning=!1,this._mySmoothSnapVerticalAngleToPerform=0)),d!=0&&(a.quat_fromAxis(d,o),this._myParams.myPlayerHeadManager.rotateHeadQuat(a),this._myParams.myClampVerticalAngle)){let g=this._myParams.myMaxVerticalAngle-1e-4;s=_.pp_getUp(s);let P=Math.pp_angleClamp(s.vec3_angleSigned(t,o));if(Math.abs(P)>g){let C=(Math.abs(P)-g)*Math.pp_sign(P);a.quat_fromAxis(C,o),this._myParams.myPlayerHeadManager.rotateHeadQuat(a)}}}}();Object.defineProperty(Mi.prototype,"_rotateHeadHorizontally",{enumerable:!1});Object.defineProperty(Mi.prototype,"_rotateHeadVertically",{enumerable:!1});var Ws=class{constructor(){this.myIsFlying=!1,this.myGravitySpeed=0,this.myCollisionRuntimeParams=null,this.myIsTeleportDetecting=!1,this.myIsTeleporting=!1,this.myTeleportJustPerformed=!1}},no=class{constructor(e){this._myLocomotionRuntimeParams=e}getRuntimeParams(){return this._myLocomotionRuntimeParams}start(){}stop(){}canStop(){return!0}};import{PhysXComponent as gR}from"@wonderlandengine/api";var Us=class{constructor(e=r.getMainEngine()){this.myPlayerTransformManager=null,this.myEnabled=!0,this.myObscureObject=null,this.myObscureMaterial=null,this.myObscureRadius=0,this.myObscureFadeOutSeconds=.1,this.myObscureFadeInSeconds=.1,this.myObscureFadeEasingFunction=he.linear,this.myDistanceToStartObscureWhenHeadColliding=0,this.myDistanceToStartObscureWhenBodyColliding=0,this.myDistanceToStartObscureWhenFloating=0,this.myDistanceToStartObscureWhenFar=0,this.myRelativeDistanceToMaxObscureWhenHeadColliding=0,this.myRelativeDistanceToMaxObscureWhenBodyColliding=0,this.myRelativeDistanceToMaxObscureWhenFloating=0,this.myRelativeDistanceToMaxObscureWhenFar=0,this.myObscureLevelRelativeDistanceEasingFunction=he.linear,this.myEngine=e}},Qs=class{constructor(e){this._myParams=e,this._myObscureMaterial=null,this._myObscureParentObject=null,this._myCurrentObscureLevel=0,this._myTargetObscureLevel=0,this._myLastTargetObscureLevel=null,this._myLastIsFadingIn=null,this._myFadeTimer=new ne(0,!1),this._myFSM=new it,this._myFSM.addState("init"),this._myFSM.addState("inactive"),this._myFSM.addState("idle",this._idleUpdate.bind(this)),this._myFSM.addState("fading",this._fadingUpdate.bind(this)),this._myFSM.addTransition("init","inactive","end",this._setObscureLevel.bind(this,0)),this._myFSM.addTransition("inactive","idle","start"),this._myFSM.addTransition("idle","fading","fade",this._startFading.bind(this)),this._myFSM.addTransition("fading","idle","done",this._fadingDone.bind(this)),this._myFSM.addTransition("inactive","inactive","stop",this._setObscureLevel.bind(this,0)),this._myFSM.addTransition("idle","inactive","stop",this._setObscureLevel.bind(this,0)),this._myFSM.addTransition("fading","inactive","stop",this._setObscureLevel.bind(this,0)),this._myFSM.init("init"),this._setupVisuals(),this._myFSM.perform("end"),this._myDestroyed=!1}start(){this._myFSM.perform("start")}stop(){this._myFSM.perform("stop")}getParams(){return this._myParams}update(e){this._myObscureParentObject.pp_resetTransformLocal(),this._updateObscured(),this._myFSM.update(e),this._setObscureVisible(this.isObscured())}isStarted(){return!this._myFSM.isInState("inactive")}isObscured(){return this._myCurrentObscureLevel>0}isFading(){return this._myFSM.isInState("fading")}isFadingIn(){return this.isFading()&&this._myCurrentObscureLevel>this._myTargetObscureLevel}isFadingOut(){return this.isFading()&&this._myCurrentObscureLevel<=this._myTargetObscureLevel}getObscureLevel(){return this._myCurrentObscureLevel}getTargetObscureLevel(){return this._myTargetObscureLevel}getCurrentObscureLevel(){this._myCurrentObscureLevel}overrideObscureLevel(e,t=!1){this._myObscureLevelOverride=e,t&&this.isStarted()&&this._setObscureLevel(e)}resetObscureLevelOverride(){this._myObscureLevelOverride=null}_idleUpdate(e){Math.abs(this._myTargetObscureLevel-this._myCurrentObscureLevel)>Math.PP_EPSILON&&this._myFSM.perform("fade")}_fadingUpdate(e){if(Math.abs(this._myTargetObscureLevel-this._myCurrentObscureLevel)<=Math.PP_EPSILON){this._myFSM.perform("done");return}this._myLastTargetObscureLevel!=this._myTargetObscureLevel&&(this._refreshFadeTimer(),this._myLastTargetObscureLevel=this._myTargetObscureLevel),this._myFadeTimer.update(e);let t=this._myParams.myObscureFadeEasingFunction(this._myFadeTimer.getPercentage());this._myCurrentObscureLevel>this._myTargetObscureLevel?(t=Math.pp_clamp(1-t,0,1),t=Math.max(t,this._myTargetObscureLevel)):t=Math.min(t,this._myTargetObscureLevel),this._setObscureAlpha(t),this._myCurrentObscureLevel=t,(Math.abs(this._myTargetObscureLevel-this._myCurrentObscureLevel)<=Math.PP_EPSILON||this._myFadeTimer.isDone())&&this._myFSM.perform("done")}_startFading(){this._myLastTargetObscureLevel=null,this._myLastIsFadingIn=null}_fadingDone(){this._setObscureLevel(this._myTargetObscureLevel)}_refreshFadeTimer(){let e=this._myCurrentObscureLevel>this._myTargetObscureLevel;this._myLastIsFadingIn!=e&&this._setFadeTimerToObscureLevel(e),this._myLastIsFadingIn=e}_setFadeTimerToObscureLevel(e){let t=0,n=0,s=1/1e3;for(;t<1;)Math.abs(this._myParams.myObscureFadeEasingFunction(t)-this._myCurrentObscureLevel)<Math.abs(this._myParams.myObscureFadeEasingFunction(n)-this._myCurrentObscureLevel)&&(n=t),t+=s;Math.abs(this._myParams.myObscureFadeEasingFunction(1)-this._myCurrentObscureLevel)<Math.abs(this._myParams.myObscureFadeEasingFunction(n)-this._myCurrentObscureLevel)&&(n=1),e?(this._myFadeTimer.start(this._myParams.myObscureFadeInSeconds),this._myFadeTimer.setPercentage(Math.pp_clamp(1-n,0,1))):(this._myFadeTimer.start(this._myParams.myObscureFadeOutSeconds),this._myFadeTimer.setPercentage(Math.pp_clamp(n,0,1)))}_setObscureLevel(e){this._myTargetObscureLevel=e,this._myCurrentObscureLevel=e,this._setObscureAlpha(e),this._setObscureVisible(this.isObscured())}_setObscureAlpha(e){this._myParams.myObscureObject==null?Es.setAlpha(this._myObscureMaterial,e):Es.setObjectAlpha(this._myParams.myObscureObject,e)}_updateObscured(){if(this._myTargetObscureLevel=0,this._myParams.myEnabled)if(this._myObscureLevelOverride!=null)this._myTargetObscureLevel=this._myObscureLevelOverride;else{if(this._myParams.myPlayerTransformManager.isHeadColliding()){let t=this._myParams.myPlayerTransformManager.getDistanceToRealHead()-this._myParams.myDistanceToStartObscureWhenHeadColliding;if(t>=0){let n=Math.pp_clamp(t/this._myParams.myRelativeDistanceToMaxObscureWhenHeadColliding,0,1),o=this._myParams.myObscureLevelRelativeDistanceEasingFunction(n);this._myTargetObscureLevel=Math.max(this._myTargetObscureLevel,o)}}if(this._myParams.myPlayerTransformManager.isBodyColliding()){let t=this._myParams.myPlayerTransformManager.getDistanceToReal()-this._myParams.myDistanceToStartObscureWhenBodyColliding;if(t>=0){let n=Math.pp_clamp(t/this._myParams.myRelativeDistanceToMaxObscureWhenBodyColliding,0,1),o=this._myParams.myObscureLevelRelativeDistanceEasingFunction(n);this._myTargetObscureLevel=Math.max(this._myTargetObscureLevel,o)}}if(this._myParams.myPlayerTransformManager.isFloating()){let t=this._myParams.myPlayerTransformManager.getDistanceToReal()-this._myParams.myDistanceToStartObscureWhenFloating;if(t>=0){let n=Math.pp_clamp(t/this._myParams.myRelativeDistanceToMaxObscureWhenFloating,0,1),o=this._myParams.myObscureLevelRelativeDistanceEasingFunction(n);this._myTargetObscureLevel=Math.max(this._myTargetObscureLevel,o)}}if(this._myParams.myPlayerTransformManager.isFar()){let t=this._myParams.myPlayerTransformManager.getDistanceToReal()-this._myParams.myDistanceToStartObscureWhenFar;if(t>=0){let n=Math.pp_clamp(t/this._myParams.myRelativeDistanceToMaxObscureWhenFar,0,1),o=this._myParams.myObscureLevelRelativeDistanceEasingFunction(n);this._myTargetObscureLevel=Math.max(this._myTargetObscureLevel,o)}}}}_setupVisuals(){this._myObscureMaterial=null,this._myParams.myObscureMaterial!=null?this._myObscureMaterial=this._myParams.myObscureMaterial:(this._myObscureMaterial=r.getDefaultMaterials(this._myParams.myEngine).myFlatTransparentNoDepth.clone(),this._myObscureMaterial.color=F(0,0,0,1)),this._myObscureParentObject=r.getPlayerObjects(this._myParams.myEngine).myCauldron.pp_addObject();let e=new ii(this._myParams.myEngine);e.myMesh=r.getDefaultMeshes(this._myParams.myEngine).myInvertedSphere,e.myMaterial=this._myParams.myObscureMaterial!=null?this._myParams.myObscureMaterial:this._myObscureMaterial,e.myParent=this._myObscureParentObject,e.myLocal=!0,e.myTransform.mat4_setScale(c(this._myParams.myObscureRadius,this._myParams.myObscureRadius,this._myParams.myObscureRadius)),this._myObscureVisual=new Ci(e),this._myParams.myObscureObject!=null&&(this._myParams.myObscureObject.pp_setParent(this._myObscureParentObject,!1),this._myParams.myObscureObject.pp_resetTransformLocal()),this._setObscureVisible(!1)}_setObscureVisible(e){this._myParams.myObscureObject==null?this._myObscureVisual.setVisible(e):(this._myObscureVisual.setVisible(!1),this._myParams.myObscureObject.pp_setActive(e)),e?this._myObscureParentObject.pp_setParent(this._myParams.myPlayerTransformManager.getHead(),!1):this._myObscureParentObject.pp_setParent(r.getPlayerObjects(this._myParams.myEngine)?.myCauldron,!1)}destroy(){this._myDestroyed=!0,this._myObscureVisual.destroy()}isDestroyed(){return this._myDestroyed}};var qs=class{constructor(){this.myTeleportValidMaterial=null,this.myTeleportInvalidMaterial=null,this.myTeleportPositionObject=null,this.myTeleportPositionObjectRotateWithHead=!0,this.myTeleportParableLineEndOffset=.05,this.myTeleportParableMinVerticalDistanceToShowVerticalLine=.8,this.myTeleportParableShowVerticalLineMaxLength=.3,this.myTeleportParablePositionUpOffset=.05,this.myTeleportParablePositionVisualAlignOnSurface=!0,this.myVisualTeleportPositionLerpEnabled=!0,this.myVisualTeleportPositionLerpFactor=10,this.myVisualTeleportPositionMinDistanceToResetLerp=.005,this.myVisualTeleportPositionMinDistanceToLerp=.15,this.myVisualTeleportPositionMaxDistanceToLerp=5,this.myVisualTeleportPositionMinDistanceToCloseLerpFactor=.02,this.myVisualTeleportPositionCloseLerpFactor=30,this.myVisualTeleportPositionMinAngleDistanceToResetLerp=.1,this.myVisualTeleportPositionMinAngleDistanceToLerp=1,this.myVisualTeleportPositionMaxAngleDistanceToLerp=180}},qi=class{constructor(e,t,n){this._myDetectionRuntimeParams=n,this._myTeleportParams=e,this._myTeleportRuntimeParams=t,this._myVisualTeleportTransformQuatReset=!0,this._myVisualTeleportTransformQuat=N(),this._myVisualTeleportTransformPositionLerping=!1,this._myVisualTeleportTransformRotationLerping=!1,this._setupVisuals(),this._myDestroyed=!1}start(){}end(){this._myVisualTeleportTransformQuatReset=!0,this._myVisualTeleportTransformPositionLerping=!1,this._myVisualTeleportTransformRotationLerping=!1,this._hideTeleportPosition()}update(e){this._myDetectionRuntimeParams.myTeleportDetectionValid?this._showTeleportPosition(e):(this._myVisualTeleportTransformQuatReset=!0,this._myVisualTeleportTransformPositionLerping=!1,this._myVisualTeleportTransformRotationLerping=!1,this._hideTeleportPosition())}_showTeleportPosition(e){this._hideTeleportPosition(),this._showTeleportParable(e)}_hideTeleportPosition(){for(let e of this._myValidVisualLines)e.setVisible(!1);for(let e of this._myInvalidVisualLines)e.setVisible(!1);this._myValidVisualPoint.setVisible(!1),this._myInvalidVisualPoint.setVisible(!1),this._myValidVisualVerticalArrow.setVisible(!1),this._myValidVisualTeleportPositionTorus.setVisible(!1),this._myValidVisualTeleportPositionTorusInner.setVisible(!1),this._myTeleportParams.myVisualizerParams.myTeleportPositionObject!=null&&this._myTeleportParams.myVisualizerParams.myTeleportPositionObject.pp_setActive(!1)}_addVisualLines(e){for(let t=0;t<e;t++){{let n=new et(this._myTeleportParams.myEngine);this._myTeleportParams.myVisualizerParams.myTeleportValidMaterial!=null?n.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportValidMaterial:n.myMaterial=this._myTeleportValidMaterial,this._myValidVisualLines.push(new ht(n))}{let n=new et(this._myTeleportParams.myEngine);this._myTeleportParams.myVisualizerParams.myTeleportValidMaterial!=null?n.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportInvalidMaterial:n.myMaterial=this._myTeleportInvalidMaterial,this._myInvalidVisualLines.push(new ht(n))}}}destroy(){this._myDestroyed=!0;for(let e of this._myValidVisualLines)e.destroy();for(let e of this._myInvalidVisualLines)e.destroy();this._myValidVisualPoint.destroy(),this._myInvalidVisualPoint.destroy(),this._myValidVisualVerticalArrow.destroy(),this._myValidVisualTeleportPositionTorus.destroy(),this._myValidVisualTeleportPositionTorusInner.destroy()}isDestroyed(){return this._myDestroyed}};qi.prototype._setupVisuals=function(){let i=c();return function(){this._myTeleportValidMaterial=r.getDefaultMaterials(this._myTeleportParams.myEngine).myFlatOpaque.clone(),this._myTeleportValidMaterial.color=F(0,.5,1,1),this._myTeleportInvalidMaterial=r.getDefaultMaterials(this._myTeleportParams.myEngine).myFlatOpaque.clone(),this._myTeleportInvalidMaterial.color=F(.75,.05,0,1),this._myValidVisualLines=[],this._myInvalidVisualLines=[],this._addVisualLines(30);{let t=new xt(this._myTeleportParams.myEngine);this._myTeleportParams.myVisualizerParams.myTeleportValidMaterial!=null?t.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportValidMaterial:t.myMaterial=this._myTeleportValidMaterial,this._myValidVisualPoint=new kt(t)}{let t=new xt(this._myTeleportParams.myEngine);this._myTeleportParams.myVisualizerParams.myTeleportInvalidMaterial!=null?t.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportInvalidMaterial:t.myMaterial=this._myTeleportInvalidMaterial,this._myInvalidVisualPoint=new kt(t)}{let t=new Ne(this._myTeleportParams.myEngine);this._myTeleportParams.myVisualizerParams.myTeleportValidMaterial!=null?t.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportValidMaterial:t.myMaterial=this._myTeleportValidMaterial,this._myValidVisualVerticalArrow=new tt(t)}this._myVisualTeleportPositionObject=r.getPlayerObjects(this._myTeleportParams.myEngine).myCauldron.pp_addObject();{let t=new wt(this._myTeleportParams.myEngine);t.myRadius=.175,t.mySegmentsAmount=24,t.mySegmentThickness=.02,this._myTeleportParams.myVisualizerParams.myTeleportValidMaterial!=null?t.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportValidMaterial:t.myMaterial=this._myTeleportValidMaterial,t.myParent=this._myVisualTeleportPositionObject,t.myLocal=!0,this._myValidVisualTeleportPositionTorus=new jt(t)}{let t=new wt(this._myTeleportParams.myEngine);t.myRadius=.04,t.mySegmentsAmount=24,t.mySegmentThickness=.02,this._myTeleportParams.myVisualizerParams.myTeleportValidMaterial!=null?t.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportValidMaterial:t.myMaterial=this._myTeleportValidMaterial,t.myParent=this._myVisualTeleportPositionObject,t.myLocal=!0;let n=this._myValidVisualTeleportPositionTorus.getParams(),o=(n.myRadius-n.mySegmentThickness/2)/2;i.vec3_set(0,0,o),t.myTransform.mat4_setPosition(i),this._myValidVisualTeleportPositionTorusInner=new jt(t)}this._myTeleportParams.myVisualizerParams.myTeleportPositionObject!=null&&(this._myTeleportParams.myVisualizerParams.myTeleportPositionObject.pp_setParent(this._myVisualTeleportPositionObject),this._myTeleportParams.myVisualizerParams.myTeleportPositionObject.pp_resetTransformLocal(),this._myTeleportParams.myVisualizerParams.myTeleportPositionObject.pp_setActive(!1)),this._hideTeleportPosition()}}();qi.prototype._showTeleportParable=function(){let i=c(),e=c(),t=c(),n=c();return function(s){let a=Math.max(this._myDetectionRuntimeParams.myParableDistance-this._myTeleportParams.myVisualizerParams.myTeleportParableLineEndOffset),l=this._myDetectionRuntimeParams.myParable.getPositionIndexByDistance(a),u=this._myDetectionRuntimeParams.myParable.getDistance(l);l+1>this._myValidVisualLines.length&&this._addVisualLines(l+1,this._myValidVisualLines.length);for(let h=0;h<=l;h++){i=this._myDetectionRuntimeParams.myParable.getPosition(h,i),e=this._myDetectionRuntimeParams.myParable.getPosition(h+1,e);let d=this._myDetectionRuntimeParams.myTeleportPositionValid?this._myValidVisualLines[h]:this._myInvalidVisualLines[h],g=d.getParams();if(h==l){let P=Math.max(0,a-u);e=e.vec3_sub(i,e).vec3_normalize(e),e=i.vec3_add(e.vec3_scale(P,e),e)}g.setStartEnd(i,e),g.myThickness=.005,d.paramsUpdated(),d.setVisible(!0),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugShowEnabled&&r.isDebugEnabled(this._myTeleportParams.myEngine)&&r.getDebugVisualManager(this._myTeleportParams.myEngine).drawPoint(0,i,F(1,0,0,1),.01)}let _=this._myDetectionRuntimeParams.myTeleportPositionValid?this._myValidVisualPoint:this._myInvalidVisualPoint,m=_.getParams();if(m.myPosition.vec3_copy(e),m.myRadius=.01,_.paramsUpdated(),_.setVisible(!0),this._myDetectionRuntimeParams.myTeleportPositionValid){t=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(t),n=e.vec3_sub(this._myTeleportRuntimeParams.myTeleportPosition,n).vec3_componentAlongAxis(t,n);let h=n.vec3_length();if(h>=this._myTeleportParams.myVisualizerParams.myTeleportParableMinVerticalDistanceToShowVerticalLine){let d=Math.min(h-this._myTeleportParams.myVisualizerParams.myTeleportParableMinVerticalDistanceToShowVerticalLine,this._myTeleportParams.myVisualizerParams.myTeleportParableShowVerticalLineMaxLength),g=this._myValidVisualVerticalArrow.getParams();g.myStart.vec3_copy(e),g.myDirection=t.vec3_negate(g.myDirection),g.myLength=d,g.myThickness=.005,g.myArrowThickness=m.myRadius,g.myArrowLength=g.myArrowThickness*3.5/1.5,this._myValidVisualVerticalArrow.paramsUpdated(),this._myValidVisualVerticalArrow.setVisible(!0)}this._showTeleportParablePosition(s)}else this._myVisualTeleportTransformQuatReset=!0,this._myVisualTeleportTransformPositionLerping=!1,this._myVisualTeleportTransformRotationLerping=!1}}();qi.prototype._showTeleportParablePosition=function(){let i=c(),e=N(),t=j(),n=c(),o=c(),s=c(),a=c(),l=c(),u=j(),_=N(),m=c(),h=j(),d=j();return function(P){if(i=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(i),e=this._myTeleportParams.myPlayerHeadManager.getTransformFeetQuat(e),t=e.quat2_getRotationQuat(t),t=t.quat_rotateAxis(this._myTeleportRuntimeParams.myTeleportRotationOnUp,i,t),a=this._myTeleportRuntimeParams.myTeleportPosition.vec3_add(i.vec3_scale(this._myTeleportParams.myVisualizerParams.myTeleportParablePositionUpOffset,a),a),l=t.quat_getForward(l),this._myTeleportParams.myVisualizerParams.myTeleportPositionObjectRotateWithHead||(n=this._myDetectionRuntimeParams.myParable.getPosition(0,n),o=this._myDetectionRuntimeParams.myParable.getPosition(1,o),s=o.vec3_sub(n,s).vec3_removeComponentAlongAxis(i,s),s.vec3_length()>Math.PP_EPSILON&&(l=s.vec3_normalize(l))),this._myTeleportParams.myVisualizerParams.myTeleportParablePositionVisualAlignOnSurface?u.quat_setUp(this._myDetectionRuntimeParams.myTeleportSurfaceNormal,l):u.quat_setUp(i,l),this._myVisualTeleportTransformQuat.quat2_setPositionRotationQuat(a,u),this._myVisualTeleportTransformQuatReset||!this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionLerpEnabled)this._myVisualTeleportPositionObject.pp_setTransformQuat(this._myVisualTeleportTransformQuat),this._myVisualTeleportTransformQuatReset=!1;else{_=this._myVisualTeleportPositionObject.pp_getTransformQuat(_),m=_.quat2_getPosition(m),h=_.quat2_getRotationQuat(h),h.quat_rotationToQuat(u,d);let C=m.vec3_distance(a),f=d.quat_getAngle();if((!this._myVisualTeleportTransformPositionLerping||C<this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMinDistanceToResetLerp)&&(C<this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMinDistanceToLerp||C>this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMaxDistanceToLerp))this._myVisualTeleportTransformPositionLerping=!1,m.vec3_copy(a);else{this._myVisualTeleportTransformPositionLerping=!0;let S=this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionLerpFactor*P;C<this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMinDistanceToCloseLerpFactor&&(S=this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionCloseLerpFactor*P),m.vec3_lerp(a,S,m)}if((!this._myVisualTeleportTransformRotationLerping||f<this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMinAngleDistanceToResetLerp)&&(f<this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMinAngleDistanceToLerp||C>this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMaxAngleDistanceToLerp))this._myVisualTeleportTransformRotationLerping=!1,h.quat_copy(u);else{let S=this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionLerpFactor*P;this._myVisualTeleportTransformRotationLerping=!0,h.quat_slerp(u,S,h)}_.quat2_setPositionRotationQuat(m,h),this._myVisualTeleportPositionObject.pp_setTransformQuat(_)}{let C=this._myValidVisualTeleportPositionTorus.getParams();C.myRadius=.175,C.mySegmentsAmount=24,C.mySegmentThickness=.02,this._myValidVisualTeleportPositionTorus.paramsUpdated()}{let C=this._myValidVisualTeleportPositionTorusInner.getParams();C.myRadius=.04,C.mySegmentsAmount=24,C.mySegmentThickness=.02,this._myValidVisualTeleportPositionTorusInner.paramsUpdated()}this._myTeleportParams.myVisualizerParams.myTeleportPositionObject==null?(this._myValidVisualTeleportPositionTorus.setVisible(!0),this._myValidVisualTeleportPositionTorusInner.setVisible(!0)):(this._myValidVisualTeleportPositionTorus.setVisible(!1),this._myValidVisualTeleportPositionTorusInner.setVisible(!1),this._myTeleportParams.myVisualizerParams.myTeleportPositionObject.pp_setActive(!0)),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugShowEnabled&&r.isDebugEnabled(this._myTeleportParams.myEngine)&&r.getDebugVisualManager(this._myTeleportParams.myEngine).drawPoint(0,this._myTeleportRuntimeParams.myTeleportPosition,F(0,0,1,1),.02)}}();var Wt=class{constructor(){this._myStartPosition=c(),this._myForward=c(),this._myUp=c(),this._mySpeed=0,this._myGravity=0,this._myStepLength=0}setStartPosition(e){this._myStartPosition.vec3_copy(e)}setForward(e){this._myForward.vec3_copy(e)}setUp(e){this._myUp.vec3_copy(e)}setSpeed(e){this._mySpeed=e}setGravity(e){this._myGravity=e}setStepLength(e){this._myStepLength=e}getPosition(e,t=c()){}getDistance(e){}getPositionIndexByDistance(e){}getPositionByDistance(e,t=c()){}getDistanceOverFlatDistance(e,t){}getFlatDistanceOverDistance(e){}};Wt.prototype.getPosition=function(){let i=c(),e=c();return function(n,o=c()){let a=this._myStepLength/this._mySpeed*n;return i=this._myForward.vec3_scale(this._mySpeed*a,i),i=i.vec3_add(this._myStartPosition,i),e=this._myUp.vec3_scale(this._myGravity*a*a/2,e),o=i.vec3_add(e,o),o}}();Wt.prototype.getDistance=function(){let i=c(),e=c();return function(n){let o=0;e.vec3_copy(this._myStartPosition);for(let s=1;s<=n;s++)i=this.getPosition(s,i),o+=i.vec3_distance(e),e.vec3_copy(i);return o}}();Wt.prototype.getPositionIndexByDistance=function(){let i=c(),e=c();return function(n){let o=0,s=0;for(e=this.getPosition(s,e);o<n;)i=this.getPosition(s+1,i),o+=i.vec3_distance(e),s++,e.vec3_copy(i);return Math.max(0,s-1)}}();Wt.prototype.getPositionByDistance=function(){let i=c(),e=c(),t=c();return function(o,s=c()){let a=0,l=0,u=!1;for(e=this.getPosition(l,e);!u;){if(i=this.getPosition(l+1,i),a+=i.vec3_distance(e),l++,a>o){let _=a-o;t=i.vec3_sub(e,t);let m=t.vec3_length()-_;t.vec3_normalize(t),s=e.vec3_add(t.vec3_scale(m,s),s),u=!0}e.vec3_copy(i)}return s}}();Wt.prototype.getDistanceOverFlatDistance=function(){let i=c(),e=c(),t=c(),n=c(),o=c(),s=c();return function(l,u){if(l<1e-5)return 0;let _=0,m=0;t=this._myStartPosition.vec3_removeComponentAlongAxis(this._myUp,t),n=this.getPosition(m,n);let h=0;for(;_<=u;){i=this.getPosition(m+1,i),_+=i.vec3_distance(n),m++,e=i.vec3_removeComponentAlongAxis(this._myUp,e),s=e.vec3_sub(t,s);let d=s.vec3_length();if(d>=l){let g=d-l;o=i.vec3_sub(n,o);let P=o.vec3_angleRadians(s),C=Math.cos(P),f=o.vec3_length();C!=0&&(f=g/Math.cos(P)),h=_-f;break}else h=_;n.vec3_copy(i)}return Math.min(u,h)}}();Wt.prototype.getFlatDistanceOverDistance=function(){let i=c(),e=c(),t=c();return function(o){return i=this.getPositionByDistance(o,i),e=i.vec3_removeComponentAlongAxis(this._myUp,e),t=this._myStartPosition.vec3_removeComponentAlongAxis(this._myUp,t),t.vec3_distance(e)}}();var bt=class extends Kn{constructor(e,t,n){super(),this._myLocomotionRuntimeParams=n,this._myTeleportParams=e,this._myTeleportRuntimeParams=t,this._myTeleportAsMovementFailed=!1}};bt.prototype._checkTeleport=function(){return function(e,t,n,o=null){q.getCollisionCheck(this._myTeleportParams.myEngine).teleport(e,t,this._myTeleportParams.myCollisionCheckParams,n),o?.copy(n)}}();bt.prototype._checkTeleportAsMovement=function(){let i=new _e,e=j(),t=c(),n=c(),o=c(),s=j(),a=N(),l=c(),u=c(),_=c(),m=c(),h=c(),d=N();return function(P,C,f,S){if(t=C.quat2_getPosition(t),e=C.quat2_getRotationQuat(e),n=e.quat_getUp(n),o=P.vec3_sub(t,o).vec3_removeComponentAlongAxis(n,o),o.vec3_normalize(o),o.vec3_isZero(1e-5)&&(o=e.quat_getForward(o)),s.quat_setUp(n,o),a.quat2_setPositionRotationQuat(t,s),this._checkTeleport(P,a,f,S),!f.myTeleportCanceled){let M=!1;i.copy(f),u.vec3_copy(f.myNewPosition),l.vec3_copy(t);for(let D=0;D<this._myTeleportParams.myTeleportAsMovementMaxSteps;D++){if(_=u.vec3_sub(l,_),this._myTeleportParams.myTeleportAsMovementRemoveVerticalMovement&&(_=_.vec3_removeComponentAlongAxis(n,_)),this._myTeleportParams.myTeleportAsMovementExtraVerticalMovementPerMeter!=0){let b=_.vec3_length()*this._myTeleportParams.myTeleportAsMovementExtraVerticalMovementPerMeter;m=n.vec3_scale(b,m),_=_.vec3_add(m,_)}if(d.quat2_setPositionRotationQuat(l,e),q.getCollisionCheck(this._myTeleportParams.myEngine).move(_,d,this._myTeleportParams.myCollisionCheckParams,i),!i.myHorizontalMovementCanceled&&!i.myVerticalMovementCanceled)if(h=u.vec3_sub(i.myNewPosition,h),h.vec3_length()<this._myTeleportParams.myTeleportAsMovementMaxDistanceFromTeleportPosition+1e-5){M=!0;break}else _.vec3_copy(h),l.vec3_copy(i.myNewPosition);else break}M||(f.myTeleportCanceled=!0),this._myTeleportAsMovementFailed=!M}}}();bt.prototype._teleportToPosition=function(){let i=c(),e=N(),t=N(),n=j(),o=j();return function(a,l,u,_=!1){this._myTeleportAsMovementFailed=!1,i=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(i),e=this._myTeleportParams.myPlayerHeadManager.getTransformFeetQuat(e),n=e.quat2_getRotationQuat(n),l!=0&&(n=n.quat_rotateAxis(l,i,n)),t.quat2_setPositionRotationQuat(a,n),r.getGamepads(this._myTeleportParams.myEngine)[ie.getOppositeHandedness(this._myTeleportParams.myHandedness)].getButtonInfo(E.BOTTOM_BUTTON).isPressed()?(q.getCollisionCheck(this._myTeleportParams.myEngine).positionCheck(!0,t,this._myTeleportParams.myCollisionCheckParams,u),this._myTeleportParams.myPlayerHeadManager.teleportPositionFeet(a),l!=0&&(o.quat_fromAxis(l,i),this._myTeleportParams.myPlayerHeadManager.rotateFeetQuat(o))):this._myTeleportParams.myPlayerTransformManager.teleportTransformQuat(t,u,_)}}();var Xs=class{constructor(){this.myMaxDistance=0,this.myMaxHeightDifference=0,this.myGroundAngleToIgnoreUpward=0,this.myMustBeOnGround=!1,this.myTeleportBlockLayerFlags=new Ve,this.myTeleportFloorLayerFlags=new Ve,this.myParableForwardMinAngleToBeValidUp=30,this.myParableForwardMinAngleToBeValidDown=0,this.myTeleportParableStartReferenceObject=null,this.myTeleportParableStartPositionOffset=c(0,-.04,.08),this.myTeleportParableStartRotationOffset=c(30,0,0),this.myTeleportParableSpeed=15,this.myTeleportParableGravity=-30,this.myTeleportParableStepLength=.25,this.myRotationOnUpMinStickIntensity=.5,this.myRotationOnUpEnabled=!1,this.myTeleportFeetPositionMustBeVisible=!1,this.myTeleportHeadPositionMustBeVisible=!1,this.myTeleportHeadOrFeetPositionMustBeVisible=!1,this.myVisibilityCheckRadius=.05,this.myVisibilityCheckFeetPositionVerticalOffset=.1,this.myVisibilityCheckDistanceFromHitThreshold=.1,this.myVisibilityCheckCircumferenceSliceAmount=6,this.myVisibilityCheckCircumferenceStepAmount=1,this.myVisibilityCheckCircumferenceRotationPerStep=30,this.myVisibilityBlockLayerFlags=new Ve}},Hr=class{constructor(){this.myTeleportDetectionValid=!1,this.myTeleportPositionValid=!1,this.myTeleportSurfaceNormal=c(),this.myParable=new Wt}},dt=class extends bt{constructor(e,t,n){super(e,t,n),this._myDetectionRuntimeParams=new Hr,this._myVisualizer=new qi(this._myTeleportParams,this._myTeleportRuntimeParams,this._myDetectionRuntimeParams),this._myTeleportRotationOnUpNext=0,this._myDestroyed=!1}start(){this._myLocomotionRuntimeParams.myIsTeleportDetecting=!0,this._myTeleportRuntimeParams.myTeleportRotationOnUp=0,this._myTeleportRotationOnUpNext=0,this._myDetectionRuntimeParams.myParable.setSpeed(this._myTeleportParams.myDetectionParams.myTeleportParableSpeed),this._myDetectionRuntimeParams.myParable.setGravity(this._myTeleportParams.myDetectionParams.myTeleportParableGravity),this._myDetectionRuntimeParams.myParable.setStepLength(this._myTeleportParams.myDetectionParams.myTeleportParableStepLength),this._myTeleportParams.myPlayerTransformManager.resetReal(),this._myVisualizer.start()}end(){this._myLocomotionRuntimeParams.myIsTeleportDetecting=!1,this._myVisualizer.end()}update(e,t){this._detectTeleportPosition(),this._myVisualizer.update(e),this._confirmTeleport()?this._myDetectionRuntimeParams.myTeleportPositionValid?t.perform("teleport"):t.perform("cancel"):this._cancelTeleport()&&t.perform("cancel")}_confirmTeleport(){let e=!1;return I.isSessionActive(this._myTeleportParams.myEngine)?r.getGamepads(this._myTeleportParams.myEngine)[this._myTeleportParams.myHandedness].getAxesInfo(oe.THUMBSTICK).getAxes().vec2_length()<=this._myTeleportParams.myStickIdleThreshold&&(e=!0):r.getMouse(this._myTeleportParams.myEngine).isInsideView()&&(e=r.getMouse(this._myTeleportParams.myEngine).isButtonPressEnd(Gi.MIDDLE)),e}_cancelTeleport(){let e=!1;return I.isSessionActive(this._myTeleportParams.myEngine)?e=r.getGamepads(this._myTeleportParams.myEngine)[this._myTeleportParams.myHandedness].getButtonInfo(E.THUMBSTICK).isPressed():e=r.getMouse(this._myTeleportParams.myEngine).isButtonPressEnd(Gi.RIGHT)||!r.getMouse(this._myTeleportParams.myEngine).isInsideView(),e}_detectTeleportPosition(){I.isSessionActive(this._myTeleportParams.myEngine)?(this._detectTeleportRotationVR(),this._detectTeleportPositionVR()):(this._myTeleportRuntimeParams.myTeleportRotationOnUp=0,this._myTeleportRotationOnUpNext=0,this._detectTeleportPositionNonVR())}destroy(){this._myDestroyed=!0,this._myVisualizer.destroy()}isDestroyed(){return this._myDestroyed}};dt.prototype._detectTeleportPositionNonVR=function(){let i=c(),e=c(),t=c();return function(o){this._myDetectionRuntimeParams.myTeleportPositionValid=!1,this._myDetectionRuntimeParams.myTeleportDetectionValid=!0,t=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(t),r.getMouse(this._myTeleportParams.myEngine).getOriginWorld(i),r.getMouse(this._myTeleportParams.myEngine).getDirectionWorld(e),this._detectTeleportPositionParable(i,e,t)}}();dt.prototype._detectTeleportPositionVR=function(){let i=N(),e=N(),t=c(),n=c(),o=c(),s=c();return function(l){if(this._myDetectionRuntimeParams.myTeleportPositionValid=!1,this._myDetectionRuntimeParams.myTeleportDetectionValid=!1,this._myTeleportParams.myDetectionParams.myTeleportParableStartReferenceObject==null){let u=r.getPlayerObjects(this._myTeleportParams.myEngine).myHands[this._myTeleportParams.myHandedness];i.quat2_setPositionRotationDegrees(this._myTeleportParams.myDetectionParams.myTeleportParableStartPositionOffset,this._myTeleportParams.myDetectionParams.myTeleportParableStartRotationOffset),e=u.pp_convertTransformObjectToWorldQuat(i,e)}else this._myTeleportParams.myDetectionParams.myTeleportParableStartReferenceObject.pp_getTransformQuat(e);t=e.quat2_getPosition(t),n=e.quat2_getForward(n),o=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(o),s=o.vec3_negate(s),n.vec3_angle(o)>=this._myTeleportParams.myDetectionParams.myParableForwardMinAngleToBeValidUp&&n.vec3_angle(s)>=this._myTeleportParams.myDetectionParams.myParableForwardMinAngleToBeValidDown&&(this._myDetectionRuntimeParams.myTeleportDetectionValid=!0),this._myDetectionRuntimeParams.myTeleportDetectionValid&&this._detectTeleportPositionParable(t,n,o)}}();dt.prototype._detectTeleportPositionParable=function(){let i=c(),e=c(),t=c(),n=new ct,o=new Fe,s=c(),a=c(),l=c(),u=c(),_=c(),m=c(),h=c(),d=new _e,g=(P,C)=>P.pp_equals(C);return function(C,f,S){this._myDetectionRuntimeParams.myParable.setStartPosition(C),this._myDetectionRuntimeParams.myParable.setForward(f),this._myDetectionRuntimeParams.myParable.setUp(S);let M=1,D=0,v=0;e=this._myDetectionRuntimeParams.myParable.getPosition(M-1,e),n.myIgnoreHitsInsideCollision=!0,n.myBlockLayerFlags.setMask(this._myTeleportParams.myDetectionParams.myTeleportBlockLayerFlags.getMask()),n.myPhysics=r.getPhysics(this._myTeleportParams.myEngine),n.myObjectsToIgnore.pp_copy(this._myTeleportParams.myCollisionCheckParams.myHorizontalObjectsToIgnore);for(let Q of this._myTeleportParams.myCollisionCheckParams.myVerticalObjectsToIgnore)n.myObjectsToIgnore.pp_pushUnique(Q,g);let b=this._myTeleportParams.myDetectionParams.myMaxDistance*2;do i=this._myDetectionRuntimeParams.myParable.getPosition(M,i),n.myOrigin.vec3_copy(e),n.myDirection=i.vec3_sub(e,n.myDirection),n.myDistance=n.myDirection.vec3_length(),n.myDirection.vec3_normalize(n.myDirection),o=De.raycast(n,o),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugDetectEnabled&&r.isDebugEnabled(this._myTeleportParams.myEngine)&&r.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,o),e.vec3_copy(i),D=i.vec3_sub(C,i).vec3_removeComponentAlongAxis(S,i).vec3_length(),v=this._myDetectionRuntimeParams.myParable.getDistance(M),M++;while(D<=this._myTeleportParams.myDetectionParams.myMaxDistance&&v<=b&&!o.isColliding());let x=this._myDetectionRuntimeParams.myParable.getDistanceOverFlatDistance(this._myTeleportParams.myDetectionParams.myMaxDistance,b),B=v;(v>x||v>b)&&(B=Math.min(x,b)),this._myDetectionRuntimeParams.myParableDistance=B;let H=!1,w=100;if(o.isColliding()){let Q=o.myHits.pp_first(),ue=v-(n.myDistance-Q.myDistance);if(ue<=B&&(H=!0,this._myDetectionRuntimeParams.myParableDistance=ue,d.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(Q,this._myTeleportRuntimeParams.myTeleportRotationOnUp,d),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(d.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(d.myGroundNormal),s.vec3_copy(Q.myPosition),a.vec3_copy(Q.myNormal),!this._myDetectionRuntimeParams.myTeleportPositionValid&&!this._myTeleportAsMovementFailed&&(l=Q.myPosition.vec3_add(Q.myNormal.vec3_scale(.01,l),l),u=S.vec3_negate(u),n.myOrigin.vec3_copy(l),n.myDirection.vec3_copy(u),n.myDistance=w,o=De.raycast(n,o),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugDetectEnabled&&r.isDebugEnabled(this._myTeleportParams.myEngine)&&r.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,o),o.isColliding()))){let me=o.myHits.pp_first();if(d.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(me,this._myTeleportRuntimeParams.myTeleportRotationOnUp,d),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(d.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(d.myGroundNormal),!this._myDetectionRuntimeParams.myTeleportPositionValid&&!this._myTeleportAsMovementFailed&&d.myTeleportCanceled&&d.myIsCollidingHorizontally&&(_=d.myHorizontalCollisionHit.myNormal.vec3_removeComponentAlongAxis(S,_),!_.vec3_isZero(1e-5))){_.vec3_normalize(_);let Pe=this._myTeleportParams.myCollisionCheckParams.myRadius*1.1;if(n.myOrigin=l.vec3_add(_.vec3_scale(Pe,n.myOrigin),n.myOrigin),n.myDirection.vec3_copy(u),n.myDistance=w,o=De.raycast(n,o),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugDetectEnabled&&r.isDebugEnabled(this._myTeleportParams.myEngine)&&(r.getDebugVisualManager(this._myTeleportParams.myEngine).drawPoint(0,n.myOrigin,F(0,0,0,1),.03),r.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,o)),o.isColliding()){let Le=o.myHits.pp_first();d.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(Le,this._myTeleportRuntimeParams.myTeleportRotationOnUp,d),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(d.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(d.myGroundNormal)}}if(!this._myDetectionRuntimeParams.myTeleportPositionValid&&!this._myTeleportAsMovementFailed&&(m=a.vec3_removeComponentAlongAxis(S,m),!m.vec3_isZero(1e-5))){m.vec3_normalize(m);let Pe=this._myTeleportParams.myCollisionCheckParams.myRadius*1.1;if(n.myOrigin=l.vec3_add(m.vec3_scale(Pe,n.myOrigin),n.myOrigin),n.myDirection.vec3_copy(u),n.myDistance=w,o=De.raycast(n,o),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugDetectEnabled&&r.isDebugEnabled(this._myTeleportParams.myEngine)&&(r.getDebugVisualManager(this._myTeleportParams.myEngine).drawPoint(0,n.myOrigin,F(0,0,0,1),.03),r.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,o)),o.isColliding()){let Le=o.myHits.pp_first();d.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(Le,this._myTeleportRuntimeParams.myTeleportRotationOnUp,d),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(d.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(d.myGroundNormal)}}if(!this._myDetectionRuntimeParams.myTeleportPositionValid&&!this._myTeleportAsMovementFailed&&(h=f.vec3_negate(h).vec3_removeComponentAlongAxis(S,h).vec3_normalize(h),!h.vec3_isZero(1e-5))){h.vec3_normalize(h);let Pe=this._myTeleportParams.myCollisionCheckParams.myRadius*1.1;if(n.myOrigin=l.vec3_add(h.vec3_scale(Pe,n.myOrigin),n.myOrigin),n.myDirection.vec3_copy(u),n.myDistance=w,o=De.raycast(n,o),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugDetectEnabled&&r.isDebugEnabled(this._myTeleportParams.myEngine)&&(r.getDebugVisualManager(this._myTeleportParams.myEngine).drawPoint(0,n.myOrigin,F(0,0,0,1),.03),r.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,o)),o.isColliding()){let Le=o.myHits.pp_first();d.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(Le,this._myTeleportRuntimeParams.myTeleportRotationOnUp,d),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(d.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(d.myGroundNormal)}}}}if(!H&&(t=this._myDetectionRuntimeParams.myParable.getPositionByDistance(this._myDetectionRuntimeParams.myParableDistance,t),l.vec3_copy(t),u=S.vec3_negate(u),n.myOrigin.vec3_copy(l),n.myDirection.vec3_copy(u),n.myDistance=w,o=De.raycast(n,o),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugDetectEnabled&&r.isDebugEnabled(this._myTeleportParams.myEngine)&&r.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,o),o.isColliding())){let Q=o.myHits.pp_first();if(d.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(Q,this._myTeleportRuntimeParams.myTeleportRotationOnUp,d),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(d.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(d.myGroundNormal),!this._myDetectionRuntimeParams.myTeleportPositionValid&&!this._myTeleportAsMovementFailed&&d.myTeleportCanceled&&d.myIsCollidingHorizontally&&(_=d.myHorizontalCollisionHit.myNormal.vec3_removeComponentAlongAxis(S,_),!_.vec3_isZero(1e-5))){_.vec3_normalize(_);let ue=this._myTeleportParams.myCollisionCheckParams.myRadius*1.1;if(n.myOrigin=l.vec3_add(_.vec3_scale(ue,n.myOrigin),n.myOrigin),n.myDirection.vec3_copy(u),n.myDistance=w,o=De.raycast(n,o),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugDetectEnabled&&r.isDebugEnabled(this._myTeleportParams.myEngine)&&(r.getDebugVisualManager(this._myTeleportParams.myEngine).drawPoint(0,n.myOrigin,F(0,0,0,1),.03),r.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,o)),o.isColliding()){let me=o.myHits.pp_first();d.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(me,this._myTeleportRuntimeParams.myTeleportRotationOnUp,d),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(d.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(d.myGroundNormal)}}if(!this._myDetectionRuntimeParams.myTeleportPositionValid&&!this._myTeleportAsMovementFailed&&(h=f.vec3_negate(h).vec3_removeComponentAlongAxis(S,h).vec3_normalize(h),!h.vec3_isZero(1e-5))){h.vec3_normalize(h);let ue=this._myTeleportParams.myCollisionCheckParams.myRadius*1.1;if(n.myOrigin=l.vec3_add(h.vec3_scale(ue,n.myOrigin),n.myOrigin),n.myDirection.vec3_copy(u),n.myDistance=w,o=De.raycast(n,o),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugDetectEnabled&&r.isDebugEnabled(this._myTeleportParams.myEngine)&&(r.getDebugVisualManager(this._myTeleportParams.myEngine).drawPoint(0,n.myOrigin,F(0,0,0,1),.03),r.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,o)),o.isColliding()){let me=o.myHits.pp_first();d.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(me,this._myTeleportRuntimeParams.myTeleportRotationOnUp,d),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(d.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(d.myGroundNormal)}}}}}();dt.prototype._detectTeleportRotationVR=function(){let i=c(),e=c(0,0,1),t=c(0,1,0);return function(o){let s=r.getGamepads(this._myTeleportParams.myEngine)[this._myTeleportParams.myHandedness].getAxesInfo(oe.THUMBSTICK).getAxes();s.vec2_length()>this._myTeleportParams.myDetectionParams.myRotationOnUpMinStickIntensity&&(this._myTeleportRuntimeParams.myTeleportRotationOnUp=this._myTeleportRotationOnUpNext,i.vec3_set(s[0],0,s[1]),this._myTeleportRotationOnUpNext=i.vec3_angleSigned(e,t)),this._myTeleportParams.myDetectionParams.myRotationOnUpEnabled||(this._myTeleportRuntimeParams.myTeleportRotationOnUp=0,this._myTeleportRotationOnUpNext=0)}}();dt.prototype._isTeleportHitValid=function(){let i=new ct,e=new Fe,t=c(),n=(o,s)=>o.pp_equals(s);return function(s,a,l){let u=!1;if(this._myTeleportAsMovementFailed=!1,s.isValid()&&!s.myInsideCollision){t=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(t);let _=!0;if(s.myNormal.vec3_isConcordant(t)||_){i.myIgnoreHitsInsideCollision=!0,i.myBlockLayerFlags.setMask(this._myTeleportParams.myDetectionParams.myTeleportFloorLayerFlags.getMask()),i.myPhysics=r.getPhysics(this._myTeleportParams.myEngine),i.myObjectsToIgnore.pp_copy(this._myTeleportParams.myCollisionCheckParams.myHorizontalObjectsToIgnore);for(let h of this._myTeleportParams.myCollisionCheckParams.myVerticalObjectsToIgnore)i.myObjectsToIgnore.pp_pushUnique(h,n);let m=.01;i.myOrigin=s.myPosition.vec3_add(s.myNormal.vec3_scale(m,i.myOrigin),i.myOrigin),i.myDirection=s.myNormal.vec3_negate(i.myDirection),i.myDistance=m*1.25,i.myDirection.vec3_normalize(i.myDirection),e=De.raycast(i,e),e.isColliding()&&e.myHits.pp_first().myObject.pp_equals(s.myObject)&&(u=this._isTeleportPositionValid(s.myPosition,a,l))}}return u}}();dt.prototype._isTeleportPositionValid=function(){let i=c(),e=N(),t=j(),n=c(),o=c(),s=new _e;return function(l,u,_){let m=!1;if(this._isTeleportPositionVisible(l)&&(i=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(i),e=this._myTeleportParams.myPlayerHeadManager.getTransformFeetQuat(e),n=e.quat2_getPosition(n),u!=0&&(t=e.quat2_getRotationQuat(t),t=t.quat_rotateAxis(u,i,t),e.quat2_setPositionRotationQuat(n,t)),l.vec3_sub(n,o).vec3_componentAlongAxis(i,o).vec3_length()<this._myTeleportParams.myDetectionParams.myMaxHeightDifference+1e-5)){let g=!1;if(s.copy(this._myLocomotionRuntimeParams.myCollisionRuntimeParams),this._myTeleportParams.myPerformTeleportAsMovement?this._checkTeleportAsMovement(l,e,s,_):this._checkTeleport(l,e,s,_),s.myTeleportCanceled||(g=!0),g&&(!this._myTeleportParams.myDetectionParams.myMustBeOnGround||s.myIsOnGround)){let P=!0;s.myNewPosition.vec3_isFartherAlongAxis(n,i)&&(P=s.myGroundAngle<this._myTeleportParams.myDetectionParams.myGroundAngleToIgnoreUpward+1e-4),P&&(m=!0)}}return m}}();import{MeshComponent as _R}from"@wonderlandengine/api";var Ks=class extends bt{constructor(e,t,n){super(e,t,n),this._myBlinkSphere=r.getPlayerObjects(this._myTeleportParams.myEngine).myCauldron.pp_addObject(),this._myBlinkSphereMeshComponent=this._myBlinkSphere.pp_addComponent(_R),this._myBlinkSphereMeshComponent.mesh=r.getDefaultMeshes(this._myTeleportParams.myEngine).myInvertedSphere,this._myBlinkSphereMeshComponent.material=r.getDefaultMaterials(this._myTeleportParams.myEngine).myFlatTransparentNoDepth.clone(),this._myBlinkSphereMaterialColor=F(this._myTeleportParams.myTeleportParams.myBlinkSphereColor[0]/255,this._myTeleportParams.myTeleportParams.myBlinkSphereColor[1]/255,this._myTeleportParams.myTeleportParams.myBlinkSphereColor[2]/255,0),this._myBlinkSphereMeshComponent.material.color=this._myBlinkSphereMaterialColor,this._myBlinkSphere.pp_resetTransformLocal(),this._myBlinkSphere.pp_setScaleLocal(this._myTeleportParams.myTeleportParams.myBlinkSphereScale),this._myBlinkSphere.pp_setActive(!1),this._myFSM=new it,this._myFSM.addState("init"),this._myFSM.addState("idle"),this._myFSM.addState("fade_out",this._fadeOutUpdate.bind(this)),this._myFSM.addState("wait",new Ms(this._myTeleportParams.myTeleportParams.myBlinkWaitSeconds,"done")),this._myFSM.addState("fade_in",this._fadeInUpdate.bind(this)),this._myFSM.addTransition("init","idle","start"),this._myFSM.addTransition("idle","fade_out","teleport",this._startFadeOut.bind(this)),this._myFSM.addTransition("fade_out","wait","done",this._teleport.bind(this)),this._myFSM.addTransition("wait","fade_in","done",this._startFadeIn.bind(this)),this._myFSM.addTransition("fade_in","idle","done",this._teleportDone.bind(this)),this._myFSM.addTransition("idle","idle","stop"),this._myFSM.addTransition("fade_out","idle","stop",this._stop.bind(this,!0)),this._myFSM.addTransition("wait","idle","stop",this._stop.bind(this,!1)),this._myFSM.addTransition("fade_in","idle","stop",this._stop.bind(this,!1)),this._myFSM.init("init"),this._myFSM.perform("start"),this._myFadeInTimer=new ne(this._myTeleportParams.myTeleportParams.myBlinkFadeInSeconds),this._myFadeOutTimer=new ne(this._myTeleportParams.myTeleportParams.myBlinkFadeOutSeconds),this._myFadeOutAlphaOverTime=new xi(0,1,0,1),this._myFadeInAlphaOverTime=new xi(1,0,0,1)}start(e){this._myParentFSM=e,this._myFSM.perform("teleport")}end(){this._myBlinkSphere.pp_setActive(!1),this._myBlinkSphere.pp_setParent(r.getPlayerObjects(this._myTeleportParams.myEngine).myCauldron,!1),this._myFSM.perform("stop")}update(e,t){this._myBlinkSphere.pp_setParent(this._myTeleportParams.myPlayerHeadManager.getHead(),!1),this._myBlinkSphere.pp_resetTransformLocal(),this._myFSM.update(e)}_startFadeOut(){this._myFadeOutTimer.start(),this._myBlinkSphereMaterialColor[3]=0,this._myBlinkSphereMeshComponent.material.color=this._myBlinkSphereMaterialColor,this._myBlinkSphere.pp_setActive(!0),this._myLocomotionRuntimeParams.myIsTeleporting=!0}_startFadeIn(){this._myFadeInTimer.start()}_fadeOutUpdate(e,t){this._myFadeOutTimer.update(e);let n=this._myFadeOutAlphaOverTime.get(this._myFadeOutTimer.getPercentage());this._myBlinkSphereMaterialColor[3]=n,this._myBlinkSphereMeshComponent.material.color=this._myBlinkSphereMaterialColor,this._myFadeOutTimer.isDone()&&t.perform("done")}_fadeInUpdate(e,t){this._myFadeInTimer.update(e);let n=this._myFadeInAlphaOverTime.get(this._myFadeInTimer.getPercentage());this._myBlinkSphereMaterialColor[3]=n,this._myBlinkSphereMeshComponent.material.color=this._myBlinkSphereMaterialColor,this._myFadeInTimer.isDone()&&t.perform("done")}_teleportDone(){this._myBlinkSphere.pp_setActive(!1),this._myParentFSM.performDelayed("done")}_stop(e){this._myBlinkSphere.pp_setActive(!1),e&&this._teleport()}_teleport(){this._myLocomotionRuntimeParams.myIsTeleporting=!1,this._myLocomotionRuntimeParams.myTeleportJustPerformed=!0,this._teleportToPosition(this._myTeleportRuntimeParams.myTeleportPosition,this._myTeleportRuntimeParams.myTeleportRotationOnUp,this._myLocomotionRuntimeParams.myCollisionRuntimeParams)}};var oo=class extends bt{constructor(e,t,n){super(e,t,n),this._myFSM=new it,this._myFSM.addState("init"),this._myFSM.addState("idle"),this._myFSM.addState("shifting",this._shiftingUpdate.bind(this)),this._myFSM.addTransition("init","idle","start"),this._myFSM.addTransition("idle","shifting","teleport",this._startShifting.bind(this)),this._myFSM.addTransition("shifting","idle","done",this._teleportDone.bind(this)),this._myFSM.addTransition("idle","idle","stop"),this._myFSM.addTransition("shifting","idle","stop",this._stop.bind(this)),this._myFSM.init("init"),this._myFSM.perform("start"),this._myShiftMovementTimer=new ne(this._myTeleportParams.myTeleportParams.myShiftMovementSeconds),this._myShiftRotateTimer=new ne(this._myTeleportParams.myTeleportParams.myShiftRotateSeconds,!1),this._myFeetStartPosition=c(),this._myCurrentRotationOnUp=0,this._myStartRotationOnUp=0}start(e){this._myParentFSM=e,this._myFSM.perform("teleport")}end(){this._myFSM.perform("stop")}update(e,t){this._myFSM.update(e)}_startShifting(){if(this._myTeleportParams.myPlayerTransformManager.getParams().mySyncPositionDisabled=!0,this._myLocomotionRuntimeParams.myIsTeleporting=!0,this._myFeetStartPosition=this._myTeleportParams.myPlayerHeadManager.getPositionFeet(this._myFeetStartPosition),this._myShiftMovementTimer.start(this._myTeleportParams.myTeleportParams.myShiftMovementSeconds),this._myTeleportParams.myTeleportParams.myShiftMovementSecondsMultiplierOverDistanceFunction){let e=this._myTeleportRuntimeParams.myTeleportPosition.vec3_distance(this._myFeetStartPosition),t=this._myTeleportParams.myTeleportParams.myShiftMovementSecondsMultiplierOverDistanceFunction(e);this._myShiftMovementTimer.start(this._myTeleportParams.myTeleportParams.myShiftMovementSeconds*t)}if(this._myShiftRotateTimer.reset(this._myTeleportParams.myTeleportParams.myShiftRotateSeconds),this._myTeleportParams.myTeleportParams.myShiftRotateSecondsMultiplierOverAngleFunction){let e=this._myTeleportParams.myTeleportParams.myShiftRotateSecondsMultiplierOverAngleFunction(Math.abs(this._myTeleportRuntimeParams.myTeleportRotationOnUp));this._myShiftRotateTimer.reset(this._myTeleportParams.myTeleportParams.myShiftRotateSeconds*e)}this._myStartRotationOnUp=this._myTeleportRuntimeParams.myTeleportRotationOnUp,this._myCurrentRotationOnUp=0}_stop(){this._teleport()}_teleportDone(){this._teleport(),this._myParentFSM.performDelayed("done")}_teleport(){this._myTeleportParams.myPlayerTransformManager.getParams().mySyncPositionDisabled=!1,this._myLocomotionRuntimeParams.myIsTeleporting=!1,this._myLocomotionRuntimeParams.myTeleportJustPerformed=!0,this._teleportToPosition(this._myTeleportRuntimeParams.myTeleportPosition,this._myStartRotationOnUp-this._myCurrentRotationOnUp,this._myLocomotionRuntimeParams.myCollisionRuntimeParams)}};oo.prototype._shiftingUpdate=function(){let i=c(),e=c();return function(n,o){if(this._myShiftMovementTimer.update(n),this._myShiftRotateTimer.update(n),this._myShiftRotateTimer.isDone()&&this._myShiftMovementTimer.isDone())o.perform("done");else{if(e.vec3_copy(this._myTeleportRuntimeParams.myTeleportPosition),this._myShiftMovementTimer.isStarted()||this._myShiftMovementTimer.isJustDone()){let a=this._myTeleportParams.myTeleportParams.myShiftMovementEasingFunction(this._myShiftMovementTimer.getPercentage());a>=this._myTeleportParams.myTeleportParams.myShiftRotateStartAfterMovementPercentage&&!this._myShiftRotateTimer.isStarted()&&(this._myShiftRotateTimer.start(),this._myShiftRotateTimer.update(n)),i=this._myTeleportRuntimeParams.myTeleportPosition.vec3_sub(this._myFeetStartPosition,i),i.vec3_scale(a,i),e=this._myFeetStartPosition.vec3_add(i,e)}let s=0;if(this._myShiftRotateTimer.isRunning()||this._myShiftRotateTimer.isJustDone()){let a=this._myTeleportParams.myTeleportParams.myShiftRotateEasingFunction(this._myShiftRotateTimer.getPercentage()),l=this._myStartRotationOnUp*a;s=l-this._myCurrentRotationOnUp,this._myCurrentRotationOnUp=l}this._teleportToPosition(e,s,this._myLocomotionRuntimeParams.myCollisionRuntimeParams,!0)}}}();Object.defineProperty(oo.prototype,"_shiftingUpdate",{enumerable:!1});var so={INSTANT:0,BLINK:1,SHIFT:2},Js=class{constructor(){this.myTeleportType=so.SHIFT,this.myBlinkFadeOutSeconds=.1,this.myBlinkFadeInSeconds=.1,this.myBlinkWaitSeconds=.1,this.myBlinkSphereColor=c(),this.myBlinkSphereScale=.1,this.myShiftMovementSeconds=.15,this.myShiftMovementSecondsMultiplierOverDistanceFunction=null,this.myShiftMovementEasingFunction=he.easeInOut,this.myShiftRotateSeconds=1,this.myShiftRotateSecondsMultiplierOverAngleFunction=null,this.myShiftRotateEasingFunction=he.easeOut,this.myShiftRotateStartAfterMovementPercentage=.7,this.myShiftRotateSecondsMultiplierOverAngleFunction=function(e){return he.easeOut(e/180)}}},Zs=class extends bt{constructor(e,t,n){super(e,t,n),this._myFSM=new it,this._myFSM.addState("init"),this._myFSM.addState("idle"),this._myBlinkState=new Ks(e,t,n),this._myShiftState=new oo(e,t,n),this._myFSM.addState("instant_teleport",this._instantUpdate.bind(this)),this._myFSM.addState("blink_teleport",this._myBlinkState),this._myFSM.addState("shift_teleport",this._myShiftState),this._myFSM.addTransition("init","idle","start"),this._myFSM.addTransition("idle","instant_teleport","start_instant"),this._myFSM.addTransition("idle","blink_teleport","start_blink"),this._myFSM.addTransition("idle","shift_teleport","start_shift"),this._myFSM.addTransition("instant_teleport","idle","done",this._teleportDone.bind(this)),this._myFSM.addTransition("blink_teleport","idle","done",this._teleportDone.bind(this)),this._myFSM.addTransition("shift_teleport","idle","done",this._teleportDone.bind(this)),this._myFSM.addTransition("idle","idle","stop"),this._myFSM.addTransition("instant_teleport","idle","stop",this._instantStop.bind(this)),this._myFSM.addTransition("blink_teleport","idle","stop"),this._myFSM.addTransition("shift_teleport","idle","stop"),this._myFSM.init("init"),this._myFSM.perform("start")}start(e){switch(this._myParentFSM=e,this._myTeleportParams.myTeleportParams.myTeleportType){case so.INSTANT:this._myFSM.perform("start_instant");break;case so.BLINK:this._myFSM.perform("start_blink");break;case so.SHIFT:this._myFSM.perform("start_shift");break;default:this._myFSM.perform("start_instant")}}end(){}update(e,t){this._myFSM.update(e)}completeTeleport(){this._myFSM.perform("stop"),this._teleportToPosition(this._myTeleportRuntimeParams.myTeleportPosition,this._myTeleportRuntimeParams.myTeleportRotationOnUp,this._myLocomotionRuntimeParams.myCollisionRuntimeParams)}_instantUpdate(e,t){this._teleportToPosition(this._myTeleportRuntimeParams.myTeleportPosition,this._myTeleportRuntimeParams.myTeleportRotationOnUp,this._myLocomotionRuntimeParams.myCollisionRuntimeParams),this._myLocomotionRuntimeParams.myTeleportJustPerformed=!0,t.perform("done")}_instantStop(e){this._instantUpdate(0,e)}_teleportDone(){this._myTeleportParams.myPlayerTransformManager.resetReal(),this._myParentFSM.performDelayed("done")}};var Ys=class{constructor(e=r.getMainEngine()){this.myPlayerHeadManager=null,this.myCollisionCheckParams=null,this.myDetectionParams=new Xs,this.myVisualizerParams=new qs,this.myTeleportParams=new Js,this.myHandedness=A.LEFT,this.myPerformTeleportAsMovement=!1,this.myTeleportAsMovementMaxDistanceFromTeleportPosition=.001,this.myTeleportAsMovementMaxSteps=2,this.myTeleportAsMovementRemoveVerticalMovement=!0,this.myTeleportAsMovementExtraVerticalMovementPerMeter=1,this.myStickIdleThreshold=.1,this.myAdjustPositionEveryFrame=!1,this.myGravityAcceleration=0,this.myMaxGravitySpeed=0,this.myEngine=e,this.myDebugEnabled=!1,this.myDebugDetectEnabled=!1,this.myDebugShowEnabled=!1,this.myDebugVisibilityEnabled=!1}},kr=class{constructor(){this.myTeleportPosition=c(),this.myTeleportRotationOnUp=0}},Ko=class extends no{constructor(e,t){super(t),this._myTeleportParams=e,this._myTeleportRuntimeParams=new kr,this._myStickIdleCharge=!0,this._myDetectionState=new dt(this._myTeleportParams,this._myTeleportRuntimeParams,this._myLocomotionRuntimeParams),this._myTeleportState=new Zs(this._myTeleportParams,this._myTeleportRuntimeParams,this._myLocomotionRuntimeParams),this._myFSM=new it,this._myFSM.addState("init"),this._myFSM.addState("idle",this._idleUpdate.bind(this)),this._myFSM.addState("detect",this._myDetectionState),this._myFSM.addState("teleport",this._myTeleportState),this._myFSM.addTransition("init","idle","start"),this._myFSM.addTransition("idle","detect","detect"),this._myFSM.addTransition("detect","teleport","teleport"),this._myFSM.addTransition("detect","idle","cancel"),this._myFSM.addTransition("teleport","idle","done"),this._myFSM.addTransition("idle","idle","stop"),this._myFSM.addTransition("detect","idle","stop"),this._myFSM.addTransition("teleport","idle","stop",this._completeTeleport.bind(this)),this._myFSM.init("init"),this._myFSM.perform("start"),this._myDestroyed=!1}start(){}stop(){this._myFSM.perform("stop")}canStop(){return this._myFSM.isInState("idle")}getParams(){return this._myTeleportParams}getTeleportRuntimeParams(){return this._myTeleportRuntimeParams}update(e){this._myLocomotionRuntimeParams.myTeleportJustPerformed=!1,this._myFSM.update(e),!this._myLocomotionRuntimeParams.myIsTeleporting&&(this._myTeleportParams.myAdjustPositionEveryFrame||this._myTeleportParams.myGravityAcceleration!=0)&&this._applyGravity(e),this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnGround&&(this._myLocomotionRuntimeParams.myIsFlying=!1)}_idleUpdate(e){this._startDetecting()&&this._myFSM.perform("detect")}_startDetecting(){let e=!1;if(!I.isSessionActive(this._myTeleportParams.myEngine))e=r.getMouse(this._myTeleportParams.myEngine).isButtonPressStart(Gi.MIDDLE)&&r.getMouse(this._myTeleportParams.myEngine).isTargetingRenderCanvas();else{let t=r.getGamepads(this._myTeleportParams.myEngine)[this._myTeleportParams.myHandedness].getAxesInfo(oe.THUMBSTICK).getAxes();t.vec2_length()<=this._myTeleportParams.myStickIdleThreshold&&(this._myStickIdleCharge=!0),this._myStickIdleCharge&&t[1]>=.75&&(this._myStickIdleCharge=!1,e=!0)}return e}_completeTeleport(){this._myTeleportState.completeTeleport()}destroy(){this._myDestroyed=!0,this._myDetectionState.destroy()}isDestroyed(){return this._myDestroyed}};Ko.prototype._applyGravity=function(){let i=c(),e=c(),t=N();return function(o){i=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(i),e.vec3_zero(),!this._myLocomotionRuntimeParams.myIsFlying&&!this._myLocomotionRuntimeParams.myIsTeleporting?(this._myLocomotionRuntimeParams.myGravitySpeed+=this._myTeleportParams.myGravityAcceleration*o,Math.abs(this._myLocomotionRuntimeParams.myGravitySpeed)>Math.abs(this._myTeleportParams.myMaxGravitySpeed)&&(this._myLocomotionRuntimeParams.myGravitySpeed=Math.pp_sign(this._myTeleportParams.myGravityAcceleration)*Math.abs(this._myTeleportParams.myMaxGravitySpeed)),e=i.vec3_scale(this._myLocomotionRuntimeParams.myGravitySpeed*o,e)):this._myLocomotionRuntimeParams.myGravitySpeed=0,t=this._myTeleportParams.myPlayerHeadManager.getTransformFeetQuat(t),q.getCollisionCheck(this._myTeleportParams.myEngine).move(e,t,this._myTeleportParams.myCollisionCheckParams,this._myLocomotionRuntimeParams.myCollisionRuntimeParams),this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myVerticalMovementCanceled||this._myTeleportParams.myPlayerHeadManager.teleportPositionFeet(this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myNewPosition),(this._myLocomotionRuntimeParams.myGravitySpeed>0&&this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnCeiling||this._myLocomotionRuntimeParams.myGravitySpeed<0&&this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnGround)&&(this._myLocomotionRuntimeParams.myGravitySpeed=0)}}();var Fr={HEAD:0,HAND:1,CUSTOM_OBJECT:2},om={SMOOTH:0,TELEPORT:1},$s=class{constructor(e=r.getMainEngine()){this.myDefaultLocomotionType=om.SMOOTH,this.mySwitchLocomotionTypeShortcutEnabled=!0,this.myDefaultHeight=0,this.myMaxSpeed=0,this.myMaxRotationSpeed=0,this.myGravityAcceleration=0,this.myMaxGravitySpeed=0,this.myCharacterRadius=0,this.mySpeedSlowDownPercentageOnWallSlid=1,this.myIsSnapTurn=!1,this.mySnapTurnOnlyVR=!1,this.mySnapTurnAngle=0,this.mySnapTurnSpeedDegrees=0,this.myFlyEnabled=!1,this.myStartFlying=!1,this.myMinAngleToFlyUpNonVR=0,this.myMinAngleToFlyDownNonVR=0,this.myMinAngleToFlyUpVR=0,this.myMinAngleToFlyDownVR=0,this.myMinAngleToFlyRight=0,this.myMainHand=A.LEFT,this.myDirectionInvertForwardWhenUpsideDown=!0,this.myVRDirectionReferenceType=Fr.HEAD,this.myVRDirectionReferenceObject=null,this.myForeheadExtraHeight=0,this.myTeleportType=so.INSTANT,this.myTeleportMaxDistance=0,this.myTeleportMaxHeightDifference=0,this.myTeleportRotationOnUpEnabled=null,this.myTeleportValidMaterial=null,this.myTeleportInvalidMaterial=null,this.myTeleportPositionObject=null,this.myTeleportPositionObjectRotateWithHead=null,this.myTeleportParableStartReferenceObject=null,this.mySyncWithRealWorldPositionOnlyIfValid=!0,this.myViewOcclusionInsideWallsEnabled=!0,this.myColliderAccuracy=null,this.myColliderCheckOnlyFeet=!1,this.myColliderSlideAlongWall=!1,this.myColliderMaxWalkableGroundAngle=0,this.myColliderSnapOnGround=!1,this.myColliderMaxDistanceToSnapOnGround=0,this.myColliderMaxWalkableGroundStepHeight=0,this.myColliderPreventFallingFromEdges=!1,this.myDebugHorizontalEnabled=!1,this.myDebugVerticalEnabled=!1,this.myMoveThroughCollisionShortcutEnabled=!1,this.myMoveHeadShortcutEnabled=!1,this.myTripleSpeedShortcutEnabled=!1,this.myPhysicsBlockLayerFlags=new Ve,this.myEngine=e}},ea=class{constructor(e){this._myParams=e,this._myCollisionCheckParamsMovement=new st,this._setupCollisionCheckParamsMovement(),this._myCollisionCheckParamsTeleport=null,this._setupCollisionCheckParamsTeleport(),this._myCollisionRuntimeParams=new _e,this._myMovementRuntimeParams=new Ws,this._myMovementRuntimeParams.myIsFlying=this._myParams.myStartFlying,this._myMovementRuntimeParams.myCollisionRuntimeParams=this._myCollisionRuntimeParams;{let t=new Xo(this._myParams.myEngine);t.mySessionChangeResyncEnabled=!0,t.myBlurEndResyncEnabled=!0,t.myBlurEndResyncRotation=!0,t.myEnterSessionResyncHeight=!1,t.myExitSessionResyncHeight=!1,t.myExitSessionResyncVerticalAngle=!0,t.myExitSessionRemoveRightTilt=!0,t.myExitSessionAdjustMaxVerticalAngle=!0,t.myExitSessionMaxVerticalAngle=90,t.myHeightOffsetVRWithFloor=0,t.myHeightOffsetVRWithoutFloor=this._myParams.myDefaultHeight,t.myHeightOffsetNonVR=this._myParams.myDefaultHeight,t.myForeheadExtraHeight=this._myParams.myForeheadExtraHeight,t.myFeetRotationKeepUp=!0,t.myDebugEnabled=!1,this._myPlayerHeadManager=new ae(t)}{let t=new Ns(this._myParams.myEngine);t.myPlayerHeadManager=this._myPlayerHeadManager,t.myMovementCollisionCheckParams=this._myCollisionCheckParamsMovement,t.myTeleportCollisionCheckParams=null,t.myTeleportCollisionCheckParamsCopyFromMovement=!0,t.myTeleportCollisionCheckParamsCheck360=!0,t.myHeadCollisionBlockLayerFlags.copy(t.myMovementCollisionCheckParams.myHorizontalBlockLayerFlags),t.myHeadCollisionBlockLayerFlags.add(t.myMovementCollisionCheckParams.myVerticalBlockLayerFlags),t.myHeadCollisionObjectsToIgnore.pp_copy(t.myMovementCollisionCheckParams.myHorizontalObjectsToIgnore);let n=(o,s)=>o.pp_equals(s);for(let o of t.myMovementCollisionCheckParams.myVerticalObjectsToIgnore)t.myHeadCollisionObjectsToIgnore.pp_pushUnique(o,n);t.myCollisionRuntimeParams=this._myCollisionRuntimeParams,t.myHeadRadius=.15,t.myAlwaysSyncPositionWithReal=!this._myParams.mySyncWithRealWorldPositionOnlyIfValid,t.myAlwaysSyncHeadPositionWithReal=!1,!this._myParams.myViewOcclusionInsideWallsEnabled&&!this._myParams.mySyncWithRealWorldPositionOnlyIfValid&&(t.mySyncEnabledFlagMap.set(pe.BODY_COLLIDING,!1),t.mySyncEnabledFlagMap.set(pe.HEAD_COLLIDING,!1),t.mySyncEnabledFlagMap.set(pe.FAR,!1),t.mySyncEnabledFlagMap.set(pe.FLOATING,!1),t.myAlwaysSyncHeadPositionWithReal=!this._myParams.mySyncWithRealWorldPositionOnlyIfValid),t.myMaxDistanceFromRealToSyncEnabled=!0,t.myMaxDistanceFromRealToSync=100,t.myIsFloatingValidIfVerticalMovement=!1,t.myIsFloatingValidIfVerticalMovementAndRealOnGround=!1,t.myIsFloatingValidIfSteepGround=!1,t.myIsFloatingValidIfVerticalMovementAndSteepGround=!1,t.myIsFloatingValidIfRealOnGround=!1,t.myIsLeaningValidAboveDistance=!0,t.myLeaningValidDistance=2,t.myFloatingSplitCheckEnabled=!0,t.myFloatingSplitCheckMaxLength=.2,t.myFloatingSplitCheckMaxSteps=5,t.myRealMovementAllowVerticalAdjustments=!1,t.myUpdateRealPositionValid=!1,t.myUpdatePositionValid=!1,t.myIsBodyCollidingWhenHeightBelowValue=null,t.myIsBodyCollidingWhenHeightAboveValue=null,t.myResetToValidOnEnterSession=!0,t.myResetToValidOnExitSession=!0,t.myAlwaysResetRealPositionNonVR=!0,t.myAlwaysResetRealRotationNonVR=!0,t.myAlwaysResetRealHeightNonVR=!0,t.myAlwaysResetRealPositionVR=!1,t.myAlwaysResetRealRotationVR=!1,t.myAlwaysResetRealHeightVR=!1,t.myNeverResetRealPositionNonVR=!1,t.myNeverResetRealRotationNonVR=!0,t.myNeverResetRealHeightNonVR=!1,t.myNeverResetRealPositionVR=!1,t.myNeverResetRealRotationVR=!1,t.myNeverResetRealHeightVR=!0,t.myResetRealOnMove=!1,t.myDebugEnabled=!1,this._myPlayerTransformManager=new at(t)}{let t=new Us(this._myParams.myEngine);t.myPlayerTransformManager=this._myPlayerTransformManager,t.myEnabled=this._myParams.myViewOcclusionInsideWallsEnabled,t.myObscureObject=null,t.myObscureMaterial=null,t.myObscureRadius=.1,t.myObscureFadeOutSeconds=.25,t.myObscureFadeInSeconds=.25,t.myObscureFadeEasingFunction=he.linear,t.myObscureLevelRelativeDistanceEasingFunction=he.linear,t.myDistanceToStartObscureWhenBodyColliding=.75,t.myDistanceToStartObscureWhenHeadColliding=0,t.myDistanceToStartObscureWhenFloating=.75,t.myDistanceToStartObscureWhenFar=.75,t.myRelativeDistanceToMaxObscureWhenBodyColliding=.5,t.myRelativeDistanceToMaxObscureWhenHeadColliding=.1,t.myRelativeDistanceToMaxObscureWhenFloating=.5,t.myRelativeDistanceToMaxObscureWhenFar=.5,this._myPlayerObscureManager=new Qs(t)}{let t=new Gs(this._myParams.myEngine);t.myPlayerHeadManager=this._myPlayerHeadManager,t.myPlayerTransformManager=this._myPlayerTransformManager,t.myMaxRotationSpeed=this._myParams.myMaxRotationSpeed,t.myIsSnapTurn=this._myParams.myIsSnapTurn,t.mySnapTurnOnlyVR=this._myParams.mySnapTurnOnlyVR,t.mySnapTurnAngle=this._myParams.mySnapTurnAngle,this._myParams.mySnapTurnSpeedDegrees>Math.PP_EPSILON?(t.mySmoothSnapEnabled=!0,t.mySmoothSnapSpeedDegrees=this._myParams.mySnapTurnSpeedDegrees):t.mySmoothSnapEnabled=!1,t.myRotationMinStickIntensityThreshold=.1,t.mySnapTurnActivateThreshold=.5,t.mySnapTurnResetThreshold=.4,t.myClampVerticalAngle=!0,t.myMaxVerticalAngle=90,this._myPlayerLocomotionRotate=new Mi(t),t.myHandedness=ie.getOppositeHandedness(this._myParams.myMainHand)}{{let t=new ta(this._myParams.myEngine);t.myPlayerHeadManager=this._myPlayerHeadManager,t.myPlayerTransformManager=this._myPlayerTransformManager,t.myCollisionCheckParams=this._myCollisionCheckParamsMovement,t.myHandedness=this._myParams.myMainHand,t.myMaxSpeed=this._myParams.myMaxSpeed,t.mySpeedSlowDownPercentageOnWallSlid=this._myParams.mySpeedSlowDownPercentageOnWallSlid,t.myMovementMinStickIntensityThreshold=.1,t.myFlyEnabled=this._myParams.myFlyEnabled,t.myMinAngleToFlyUpNonVR=this._myParams.myMinAngleToFlyUpNonVR,t.myMinAngleToFlyDownNonVR=this._myParams.myMinAngleToFlyDownNonVR,t.myMinAngleToFlyUpVR=this._myParams.myMinAngleToFlyUpVR,t.myMinAngleToFlyDownVR=this._myParams.myMinAngleToFlyDownVR,t.myMinAngleToFlyRight=this._myParams.myMinAngleToFlyRight,t.myGravityAcceleration=this._myParams.myGravityAcceleration,t.myMaxGravitySpeed=this._myParams.myMaxGravitySpeed,t.myDirectionInvertForwardWhenUpsideDown=this._myParams.myDirectionInvertForwardWhenUpsideDown,t.myVRDirectionReferenceType=this._myParams.myVRDirectionReferenceType,t.myVRDirectionReferenceObject=this._myParams.myVRDirectionReferenceObject,t.myMoveThroughCollisionShortcutEnabled=this._myParams.myMoveThroughCollisionShortcutEnabled,t.myMoveHeadShortcutEnabled=this._myParams.myMoveHeadShortcutEnabled,t.myTripleSpeedShortcutEnabled=this._myParams.myTripleSpeedShortcutEnabled,this._myPlayerLocomotionSmooth=new li(t,this._myMovementRuntimeParams)}{let t=new Ys(this._myParams.myEngine);t.myPlayerHeadManager=this._myPlayerHeadManager,t.myPlayerTransformManager=this._myPlayerTransformManager,t.myCollisionCheckParams=this._myCollisionCheckParamsTeleport,t.myHandedness=this._myParams.myMainHand,t.myDetectionParams.myMaxDistance=this._myParams.myTeleportMaxDistance,t.myDetectionParams.myMaxHeightDifference=this._myParams.myTeleportMaxHeightDifference,t.myDetectionParams.myGroundAngleToIgnoreUpward=this._myCollisionCheckParamsMovement.myGroundAngleToIgnore,t.myDetectionParams.myRotationOnUpEnabled=this._myParams.myTeleportRotationOnUpEnabled,t.myDetectionParams.myMustBeOnGround=!0,t.myDetectionParams.myTeleportBlockLayerFlags.copy(this._myParams.myPhysicsBlockLayerFlags),t.myDetectionParams.myTeleportFloorLayerFlags.copy(this._myParams.myPhysicsBlockLayerFlags),t.myDetectionParams.myTeleportFeetPositionMustBeVisible=!1,t.myDetectionParams.myTeleportHeadPositionMustBeVisible=!1,t.myDetectionParams.myTeleportHeadOrFeetPositionMustBeVisible=!0,t.myDetectionParams.myTeleportParableStartReferenceObject=this._myParams.myTeleportParableStartReferenceObject,t.myDetectionParams.myVisibilityBlockLayerFlags.copy(t.myDetectionParams.myTeleportBlockLayerFlags),t.myTeleportParams.myTeleportType=this._myParams.myTeleportType,t.myVisualizerParams.myTeleportPositionObject=this._myParams.myTeleportPositionObject,t.myVisualizerParams.myTeleportValidMaterial=this._myParams.myTeleportValidMaterial,t.myVisualizerParams.myTeleportInvalidMaterial=this._myParams.myTeleportInvalidMaterial,t.myVisualizerParams.myTeleportPositionObjectRotateWithHead=this._myParams.myTeleportPositionObjectRotateWithHead,t.myPerformTeleportAsMovement=!1,t.myTeleportAsMovementRemoveVerticalMovement=!0,t.myTeleportAsMovementExtraVerticalMovementPerMeter=-2,t.myGravityAcceleration=this._myParams.myGravityAcceleration,t.myMaxGravitySpeed=this._myParams.myMaxGravitySpeed,t.myDebugEnabled=!1,t.myDebugDetectEnabled=!0,t.myDebugShowEnabled=!0,t.myDebugVisibilityEnabled=!1,this._myPlayerLocomotionTeleport=new Ko(t,this._myMovementRuntimeParams)}}this._setupLocomotionMovementFSM(),this._myIdle=!1,this._myActive=!0,this._myStarted=!1,this._myDestroyed=!1}start(){this._fixAlmostUp(),this._myPlayerHeadManager.start(),this._myPlayerTransformManager.start(),this._myPlayerObscureManager.start(),this._myPlayerLocomotionRotate.start(),this._myParams.myDefaultLocomotionType==om.SMOOTH?this._myLocomotionMovementFSM.perform("startSmooth"):this._myLocomotionMovementFSM.perform("startTeleport"),this._myStarted=!0;let e=this._myActive;this._myActive=!this._myActive,this.setActive(e)}setActive(e){this._myActive!=e&&(this._myActive=e,this._myStarted&&(this._myActive?(this._myPlayerObscureManager.start(),this._myIdle||this._myLocomotionMovementFSM.perform("resume")):(this._myLocomotionMovementFSM.perform("idle"),this._myPlayerObscureManager.stop())),this._myPlayerHeadManager.setActive(this._myActive),this._myPlayerTransformManager.setActive(this._myActive))}isStarted(){return this._myStarted}canStop(){let e=!1;return(this._myLocomotionMovementFSM.isInState("smooth")&&this._myPlayerLocomotionSmooth.canStop()||this._myLocomotionMovementFSM.isInState("teleport")&&this._myPlayerLocomotionTeleport.canStop())&&(e=!0),e}update(e){this._myPlayerHeadManager.update(e),this._myPlayerTransformManager.update(e),this._myParams.mySwitchLocomotionTypeShortcutEnabled&&r.getLeftGamepad(this._myParams.myEngine).getButtonInfo(E.THUMBSTICK).isPressEnd(2)&&(this._myLocomotionMovementFSM.isInState("smooth")&&this._myPlayerLocomotionSmooth.canStop()?this._myLocomotionMovementFSM.perform("next"):this._myLocomotionMovementFSM.isInState("teleport")&&this._myPlayerLocomotionTeleport.canStop()&&this._myLocomotionMovementFSM.perform("next")),this._myPlayerHeadManager.isSynced()&&(this._updateCollisionHeight(),this._myIdle||(this._myPlayerLocomotionRotate.update(e),this._myLocomotionMovementFSM.update(e))),this._myPlayerObscureManager.update(e)}setIdle(e){this._myIdle=e,e?this._myLocomotionMovementFSM.perform("idle"):this._myLocomotionMovementFSM.perform("resume")}getPlayerLocomotionSmooth(){return this._myPlayerLocomotionSmooth}getPlayerLocomotionTeleport(){return this._myPlayerLocomotionTeleport}getPlayerTransformManager(){return this._myPlayerTransformManager}getPlayerLocomotionRotate(){return this._myPlayerLocomotionRotate}getPlayerHeadManager(){return this._myPlayerHeadManager}getPlayerObscureManager(){return this._myPlayerObscureManager}_updateCollisionHeight(){this._myCollisionCheckParamsMovement.myHeight=this._myPlayerHeadManager.getHeightHead(),this._myCollisionCheckParamsMovement.myHeight<=1e-6&&(this._myCollisionCheckParamsMovement.myHeight=0),this._myCollisionCheckParamsTeleport.myHeight=this._myCollisionCheckParamsMovement.myHeight}_setupCollisionCheckParamsMovement(){let e=new zs;e.myHeight=this._myParams.myDefaultHeight,e.myRadius=this._myParams.myCharacterRadius,e.myAccuracyLevel=this._myParams.myColliderAccuracy,e.myIsPlayer=!0,e.myCheckOnlyFeet=this._myParams.myColliderCheckOnlyFeet,e.myMaxSpeed=this._myParams.myMaxSpeed,e.myCanFly=this._myParams.myFlyEnabled,e.myShouldSlideAlongWall=this._myParams.myColliderSlideAlongWall,e.myCollectGroundInfo=!0,e.myMaxWalkableGroundAngle=this._myParams.myColliderMaxWalkableGroundAngle,e.myShouldSnapOnGround=this._myParams.myColliderSnapOnGround,e.myMaxDistanceToSnapOnGround=this._myParams.myColliderMaxDistanceToSnapOnGround,e.myMaxWalkableGroundStepHeight=this._myParams.myColliderMaxWalkableGroundStepHeight,e.myShouldNotFallFromEdges=this._myParams.myColliderPreventFallingFromEdges,e.myHorizontalCheckBlockLayerFlags.copy(this._myParams.myPhysicsBlockLayerFlags);let t=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getComponents(gR);for(let o of t)e.myHorizontalCheckObjectsToIgnore.pp_pushUnique(o.object,(s,a)=>s.pp_equals(a));e.myVerticalCheckBlockLayerFlags.copy(e.myHorizontalCheckBlockLayerFlags),e.myVerticalCheckObjectsToIgnore.pp_copy(e.myHorizontalCheckObjectsToIgnore),e.myHorizontalCheckDebugEnabled=this._myParams.myDebugHorizontalEnabled&&r.isDebugEnabled(this._myParams.myEngine),e.myVerticalCheckDebugEnabled=this._myParams.myDebugVerticalEnabled&&r.isDebugEnabled(this._myParams.myEngine);let n=nm.createSimplified(e);this._myCollisionCheckParamsMovement=q.convertCharacterColliderSetupToCollisionCheckParams(n,this._myCollisionCheckParamsMovement,this._myParams.myEngine)}_setupCollisionCheckParamsTeleport(){this._myCollisionCheckParamsTeleport=Is.generate360TeleportParamsFromMovementParams(this._myCollisionCheckParamsMovement),this._myCollisionCheckParamsTeleport.myGroundAngleToIgnore=61,this._myCollisionCheckParamsTeleport.myTeleportMustBeOnIgnorableGroundAngle=!0,this._myCollisionCheckParamsTeleport.myTeleportMustBeOnGround=!0}_fixAlmostUp(){let e=c(0,1,0);if(r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp().vec3_angle(e)<1){let o=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getForward().vec3_clone();o[1]=0;let a=c(0,0,1).vec3_angleSigned(o,e);r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_resetRotation(),r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_rotateAxis(a,e)}}_setupLocomotionMovementFSM(){this._myLocomotionMovementFSM=new it,this._myLocomotionMovementFSM.addState("init"),this._myLocomotionMovementFSM.addState("smooth",e=>this._myPlayerLocomotionSmooth.update(e)),this._myLocomotionMovementFSM.addState("teleport",e=>this._myPlayerLocomotionTeleport.update(e)),this._myLocomotionMovementFSM.addState("idleSmooth"),this._myLocomotionMovementFSM.addState("idleTeleport"),this._myLocomotionMovementFSM.addTransition("init","smooth","startSmooth",function(){this._myPlayerLocomotionSmooth.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("init","teleport","startTeleport",function(){this._myPlayerLocomotionSmooth.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("smooth","teleport","next",function(){this._myPlayerLocomotionSmooth.stop(),this._myPlayerLocomotionTeleport.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("teleport","smooth","next",function(){this._myPlayerLocomotionTeleport.stop(),this._myPlayerLocomotionSmooth.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("smooth","idleSmooth","idle",function(){this._myPlayerLocomotionSmooth.stop()}.bind(this)),this._myLocomotionMovementFSM.addTransition("teleport","idleTeleport","idle",function(){this._myPlayerLocomotionTeleport.stop()}.bind(this)),this._myLocomotionMovementFSM.addTransition("idleSmooth","smooth","resume",function(){this._myPlayerLocomotionSmooth.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("idleTeleport","teleport","resume",function(){this._myPlayerLocomotionTeleport.start()}.bind(this)),this._myLocomotionMovementFSM.init("init")}destroy(){this._myDestroyed=!0,this._myPlayerHeadManager.destroy(),this._myPlayerLocomotionSmooth.destroy(),this._myPlayerTransformManager.destroy(),this._myPlayerObscureManager.destroy(),this._myPlayerLocomotionTeleport.destroy()}isDestroyed(){return this._myDestroyed}};var ta=class{constructor(e=r.getMainEngine()){this.myPlayerHeadManager=null,this.myPlayerTransformManager=null,this.myCollisionCheckParams=null,this.myMaxSpeed=0,this.mySpeedSlowDownPercentageOnWallSlid=1,this.myMovementMinStickIntensityThreshold=0,this.myFlyEnabled=!1,this.myMinAngleToFlyUpNonVR=0,this.myMinAngleToFlyDownNonVR=0,this.myMinAngleToFlyUpVR=0,this.myMinAngleToFlyDownVR=0,this.myMinAngleToFlyRight=0,this.myGravityAcceleration=0,this.myMaxGravitySpeed=0,this.myVRDirectionReferenceType=Fr.HEAD,this.myVRDirectionReferenceObject=null,this.myHandedness=A.LEFT,this.myMoveThroughCollisionShortcutEnabled=!1,this.myMoveHeadShortcutEnabled=!1,this.myTripleSpeedShortcutEnabled=!1,this.myEngine=e}},li=class extends no{constructor(e,t){super(t),this._myParams=e,this._myCurrentSpeed=0,this._myLastHorizontalMovement=c(),this._myDirectionReference=r.getPlayerObjects(this._myParams.myEngine).myHead,this._myStickIdleTimer=new ne(.25,!1);let n=new Yn(this._myParams.myEngine);n.myAutoUpdateFlyForward=this._myParams.myFlyEnabled,n.myAutoUpdateFlyRight=this._myParams.myFlyEnabled,n.myMinAngleToFlyForwardUp=this._myParams.myMinAngleToFlyUpNonVR,n.myMinAngleToFlyForwardDown=this._myParams.myMinAngleToFlyDownNonVR,n.myMinAngleToFlyRightUp=this._myParams.myMinAngleToFlyRight,n.myMinAngleToFlyRightDown=this._myParams.myMinAngleToFlyRight,n.myInvertForwardWhenUpsideDown=this._myParams.myDirectionInvertForwardWhenUpsideDown;let o=new Yn(this._myParams.myEngine);o.myAutoUpdateFlyForward=this._myParams.myFlyEnabled,o.myAutoUpdateFlyRight=this._myParams.myFlyEnabled,o.myMinAngleToFlyForwardUp=this._myParams.myMinAngleToFlyUpVR,o.myMinAngleToFlyForwardDown=this._myParams.myMinAngleToFlyDownVR,o.myMinAngleToFlyRightUp=this._myParams.myMinAngleToFlyRight,o.myMinAngleToFlyRightDown=this._myParams.myMinAngleToFlyRight,o.myInvertForwardWhenUpsideDown=this._myParams.myDirectionInvertForwardWhenUpsideDown,this._myDirectionConverterNonVR=new ri(n),this._myDirectionConverterVR=new ri(o),this._myCurrentDirectionConverter=this._myDirectionConverterNonVR,this._myDestroyed=!1,I.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this._myParams.myEngine)}start(){this._myCurrentSpeed=0,this._myLastHorizontalMovement.vec3_zero()}getParams(){return this._myParams}getCurrentSpeed(){return this._myCurrentSpeed}getLastHorizontalSpeed(){return this._myLastHorizontalMovement}update(e){}destroy(){this._myDestroyed=!0,I.unregisterSessionStartEndEventListeners(this,this._myParams.myEngine)}isDestroyed(){return this._myDestroyed}};li.prototype.update=function(){let i=c(),e=c(),t=c(),n=c(),o=c(),s=N(),a=N();return function(u){this._myCurrentSpeed=0,this._myLastHorizontalMovement.vec3_zero(),i=this._myParams.myPlayerHeadManager.getPlayer().pp_getUp(i),e.vec3_zero();let _=r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getAxesInfo(oe.THUMBSTICK).getAxes();_[0]=Math.abs(_[0])>this._myParams.myMovementMinStickIntensityThreshold?_[0]:0,_[1]=Math.abs(_[1])>this._myParams.myMovementMinStickIntensityThreshold?_[1]:0;let m=!1,h=this._myParams.myMaxSpeed;if(this._myParams.myTripleSpeedShortcutEnabled&&r.isDebugEnabled(this._myParams.myEngine)&&r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(E.SELECT).isPressed()&&(h*=3),_.vec2_isZero())this._myStickIdleTimer.isRunning()&&(this._myStickIdleTimer.update(u),this._myStickIdleTimer.isDone()&&this._myCurrentDirectionConverter.resetFly());else if(this._myStickIdleTimer.start(),t=this._myCurrentDirectionConverter.convertTransformQuat(_,this._myDirectionReference.pp_getTransformQuat(a),i,t),!t.vec3_isZero()){this._myLocomotionRuntimeParams.myIsFlying=this._myLocomotionRuntimeParams.myIsFlying||t.vec3_componentAlongAxis(i,n).vec3_length()>1e-6,this._myLocomotionRuntimeParams.myIsFlying||(t=t.vec3_removeComponentAlongAxis(i,t));let d=_.vec2_length();if(this._myCurrentSpeed=Math.pp_lerp(0,h,d),this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsSliding&&this._myParams.mySpeedSlowDownPercentageOnWallSlid!=1){let g=this._myParams.mySpeedSlowDownPercentageOnWallSlid,P=Math.pp_mapToRange(Math.abs(this._myLocomotionRuntimeParams.myCollisionRuntimeParams.mySlidingMovementAngle),0,90,0,1);g=Math.pp_lerp(1,g,P),this._myCurrentSpeed=this._myCurrentSpeed*g}e=t.vec3_scale(this._myCurrentSpeed*u,e),m=!0}this._myParams.myFlyEnabled&&(r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(E.TOP_BUTTON).isPressed()?(o=i.vec3_scale(h*u,o),e=e.vec3_add(o,e),this._myLocomotionRuntimeParams.myIsFlying=!0):r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(E.BOTTOM_BUTTON).isPressed()&&(o=i.vec3_scale(-h*u,o),e=e.vec3_add(o,e),this._myLocomotionRuntimeParams.myIsFlying=!0),r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(E.BOTTOM_BUTTON).isPressEnd(2)&&(this._myLocomotionRuntimeParams.myIsFlying=!1)),this._myParams.myMoveHeadShortcutEnabled&&r.isDebugEnabled(this._myParams.myEngine)&&r.getGamepads(this._myParams.myEngine)[ie.getOppositeHandedness(this._myParams.myHandedness)].getButtonInfo(E.THUMBSTICK).isPressed()?this._myParams.myPlayerTransformManager.getPlayerHeadManager().moveFeet(e):this._myParams.myMoveThroughCollisionShortcutEnabled&&r.isDebugEnabled(this._myParams.myEngine)&&r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(E.THUMBSTICK).isPressed()?(this._myParams.myPlayerTransformManager.move(e,this._myLocomotionRuntimeParams.myCollisionRuntimeParams,!0),m&&this._myParams.myPlayerTransformManager.resetReal()):(this._myLocomotionRuntimeParams.myIsFlying?this._myLocomotionRuntimeParams.myGravitySpeed=0:(this._myLocomotionRuntimeParams.myGravitySpeed+=this._myParams.myGravityAcceleration*u,Math.abs(this._myLocomotionRuntimeParams.myGravitySpeed)>Math.abs(this._myParams.myMaxGravitySpeed)&&(this._myLocomotionRuntimeParams.myGravitySpeed=Math.pp_sign(this._myParams.myGravityAcceleration)*Math.abs(this._myParams.myMaxGravitySpeed)),o=i.vec3_scale(this._myLocomotionRuntimeParams.myGravitySpeed*u,o),e=e.vec3_add(o,e)),s=this._myParams.myPlayerTransformManager.getTransformQuat(s),this._myParams.myPlayerTransformManager.move(e,this._myLocomotionRuntimeParams.myCollisionRuntimeParams),m&&(this._myParams.myPlayerTransformManager.resetReal(),this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myFixedMovement.vec3_removeComponentAlongAxis(this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myOriginalUp,this._myLastHorizontalMovement)),(this._myLocomotionRuntimeParams.myGravitySpeed>0&&this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnCeiling||this._myLocomotionRuntimeParams.myGravitySpeed<0&&this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnGround)&&(this._myLocomotionRuntimeParams.myGravitySpeed=0)),this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnGround&&(this._myLocomotionRuntimeParams.myIsFlying=!1,this._myCurrentDirectionConverter.resetFly())}}();li.prototype._onXRSessionStart=function(){return function(e){switch(this._myParams.myVRDirectionReferenceType){case 0:this._myDirectionReference=r.getPlayerObjects(this._myParams.myEngine).myHead;break;case 1:this._myDirectionReference=r.getPlayerObjects(this._myParams.myEngine).myHands[this._myParams.myHandedness];break;case 2:this._myDirectionReference=this._myParams.myVRDirectionReferenceObject;break}this._myCurrentDirectionConverter=this._myDirectionConverterVR,this._myCurrentDirectionConverter.resetFly()}}();li.prototype._onXRSessionEnd=function(){return function(e){this._myDirectionReference=r.getPlayerObjects(this._myParams.myEngine).myHead,this._myCurrentDirectionConverter=this._myDirectionConverterNonVR,this._myCurrentDirectionConverter.resetFly()}}();Object.defineProperty(li.prototype,"_onXRSessionStart",{enumerable:!1});Object.defineProperty(li.prototype,"_onXRSessionEnd",{enumerable:!1});import{Component as fR,Property as te}from"@wonderlandengine/api";var dn=class extends fR{start(){q.initBridge(this.engine);let e=new $s(this.engine);e.myDefaultLocomotionType=this._myDefaultLocomotionType,e.mySwitchLocomotionTypeShortcutEnabled=this._mySwitchLocomotionTypeShortcutEnabled,e.myDefaultHeight=this._myDefaultHeight,e.myMaxSpeed=this._myMaxSpeed,e.myMaxRotationSpeed=this._myMaxRotationSpeed,e.myGravityAcceleration=this._myGravityAcceleration,e.myMaxGravitySpeed=this._myMaxGravitySpeed,e.myCharacterRadius=this._myCharacterRadius,e.mySpeedSlowDownPercentageOnWallSlid=this._mySpeedSlowDownPercentageOnWallSlid,e.myIsSnapTurn=this._myIsSnapTurn,e.mySnapTurnOnlyVR=this._mySnapTurnOnlyVR,e.mySnapTurnAngle=this._mySnapTurnAngle,e.mySnapTurnSpeedDegrees=this._mySnapTurnSpeedDegrees,e.myFlyEnabled=this._myFlyEnabled,e.myStartFlying=this._myStartFlying,e.myMinAngleToFlyUpNonVR=this._myMinAngleToFlyUpNonVR,e.myMinAngleToFlyDownNonVR=this._myMinAngleToFlyDownNonVR,e.myMinAngleToFlyUpVR=this._myMinAngleToFlyUpVR,e.myMinAngleToFlyDownVR=this._myMinAngleToFlyDownVR,e.myMinAngleToFlyRight=this._myMinAngleToFlyRight,e.myMainHand=ie.getHandednessByIndex(this._myMainHand),e.myDirectionInvertForwardWhenUpsideDown=this._myDirectionInvertForwardWhenUpsideDown,e.myVRDirectionReferenceType=this._myVRDirectionReferenceType,e.myVRDirectionReferenceObject=this._myVRDirectionReferenceObject,e.myForeheadExtraHeight=.1,e.myTeleportType=this._myTeleportType,e.myTeleportMaxDistance=this._myTeleportMaxDistance,e.myTeleportMaxHeightDifference=this._myTeleportMaxHeightDifference,e.myTeleportRotationOnUpEnabled=this._myTeleportRotationOnUpEnabled,e.myTeleportValidMaterial=this._myTeleportValidMaterial,e.myTeleportInvalidMaterial=this._myTeleportInvalidMaterial,e.myTeleportPositionObject=this._myTeleportPositionObject,e.myTeleportPositionObjectRotateWithHead=this._myTeleportPositionObjectRotateWithHead,e.myTeleportParableStartReferenceObject=this._myTeleportParableStartReferenceObject,e.mySyncWithRealWorldPositionOnlyIfValid=this._mySyncWithRealWorldPositionOnlyIfValid,e.myViewOcclusionInsideWallsEnabled=this._myViewOcclusionInsideWallsEnabled,e.myColliderAccuracy=this._myColliderAccuracy,e.myColliderCheckOnlyFeet=this._myColliderCheckOnlyFeet,e.myColliderSlideAlongWall=this._myColliderSlideAlongWall,e.myColliderMaxWalkableGroundAngle=this._myColliderMaxWalkableGroundAngle,e.myColliderSnapOnGround=this._myColliderSnapOnGround,e.myColliderMaxDistanceToSnapOnGround=this._myColliderMaxDistanceToSnapOnGround,e.myColliderMaxWalkableGroundStepHeight=this._myColliderMaxWalkableGroundStepHeight,e.myColliderPreventFallingFromEdges=this._myColliderPreventFallingFromEdges,e.myMoveThroughCollisionShortcutEnabled=this._myMoveThroughCollisionShortcutEnabled,e.myMoveHeadShortcutEnabled=this._myMoveHeadShortcutEnabled,e.myTripleSpeedShortcutEnabled=this._myTripleSpeedShortcutEnabled,e.myDebugHorizontalEnabled=this._myDebugHorizontalEnabled,e.myDebugVerticalEnabled=this._myDebugVerticalEnabled,e.myPhysicsBlockLayerFlags.copy(this._getPhysicsBlockLayersFlags()),this._myPlayerLocomotion=new ea(e),this._myStartCounter=1,this._myResetReal=!0}update(e){this._myStartCounter>0?(this._myStartCounter--,this._myStartCounter==0&&this._myPlayerLocomotion.start(),this._myPlayerLocomotion.getPlayerHeadManager().update(e)):(this._myResetReal&&(this._myResetReal=!1,this._myPlayerLocomotion.getPlayerTransformManager().resetReal(!0,!0)),q.getCollisionCheck(this.engine)._myTotalRaycasts=0,this._myPlayerLocomotion.update(e))}getPlayerLocomotion(){return this._myPlayerLocomotion}onActivate(){this._myStartCounter==0&&this._myPlayerLocomotion!=null&&this._myPlayerLocomotion.setActive(!0)}onDeactivate(){this._myStartCounter==0&&this._myPlayerLocomotion!=null&&this._myPlayerLocomotion.setActive(!1)}_getPhysicsBlockLayersFlags(){let e=new Ve,t=[...this._myPhysicsBlockLayerFlags.split(",")];for(let n=0;n<t.length;n++)e.setFlagActive(n,t[n].trim()=="1");return e}onDestroy(){this._myPlayerLocomotion?.destroy()}};R(dn,"TypeName","pp-player-locomotion"),R(dn,"Properties",{_myDefaultLocomotionType:te.enum(["Smooth","Teleport"],"Smooth"),_mySwitchLocomotionTypeShortcutEnabled:te.bool(!0),_myPhysicsBlockLayerFlags:te.string("0, 0, 0, 0, 0, 0, 0, 0"),_myDefaultHeight:te.float(1.75),_myCharacterRadius:te.float(.3),_myMaxSpeed:te.float(2),_myMaxRotationSpeed:te.float(100),_myGravityAcceleration:te.float(-20),_myMaxGravitySpeed:te.float(-15),_mySpeedSlowDownPercentageOnWallSlid:te.float(1),_myIsSnapTurn:te.bool(!0),_mySnapTurnOnlyVR:te.bool(!0),_mySnapTurnAngle:te.float(30),_mySnapTurnSpeedDegrees:te.float(0),_myFlyEnabled:te.bool(!1),_myStartFlying:te.bool(!1),_myMinAngleToFlyUpNonVR:te.float(30),_myMinAngleToFlyDownNonVR:te.float(50),_myMinAngleToFlyUpVR:te.float(60),_myMinAngleToFlyDownVR:te.float(1),_myMinAngleToFlyRight:te.float(60),_myMainHand:te.enum(["Left","Right"],"Left"),_myDirectionInvertForwardWhenUpsideDown:te.bool(!0),_myVRDirectionReferenceType:te.enum(["Head","Hand","Custom Object"],"Head"),_myVRDirectionReferenceObject:te.object(),_myTeleportType:te.enum(["Instant","Blink","Shift"],"Shift"),_myTeleportMaxDistance:te.float(3),_myTeleportMaxHeightDifference:te.float(1.25),_myTeleportRotationOnUpEnabled:te.bool(!1),_myTeleportValidMaterial:te.material(),_myTeleportInvalidMaterial:te.material(),_myTeleportPositionObject:te.object(),_myTeleportPositionObjectRotateWithHead:te.bool(!0),_myTeleportParableStartReferenceObject:te.object(),_mySyncWithRealWorldPositionOnlyIfValid:te.bool(!0),_myViewOcclusionInsideWallsEnabled:te.bool(!0),_myColliderAccuracy:te.enum(["Very Low","Low","Medium","High","Very High"],"High"),_myColliderCheckOnlyFeet:te.bool(!1),_myColliderSlideAlongWall:te.bool(!0),_myColliderMaxWalkableGroundAngle:te.float(30),_myColliderSnapOnGround:te.bool(!0),_myColliderMaxDistanceToSnapOnGround:te.float(.1),_myColliderMaxWalkableGroundStepHeight:te.float(.1),_myColliderPreventFallingFromEdges:te.bool(!1),_myDebugHorizontalEnabled:te.bool(!1),_myDebugVerticalEnabled:te.bool(!1),_myMoveThroughCollisionShortcutEnabled:te.bool(!1),_myMoveHeadShortcutEnabled:te.bool(!1),_myTripleSpeedShortcutEnabled:te.bool(!1)});dt.prototype._isTeleportPositionVisible=function(){let i=c(),e=c(),t=c();return function(o){let s=!0;if(this._myTeleportParams.myDetectionParams.myTeleportFeetPositionMustBeVisible||this._myTeleportParams.myDetectionParams.myTeleportHeadPositionMustBeVisible||this._myTeleportParams.myDetectionParams.myTeleportHeadOrFeetPositionMustBeVisible){i=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(i);let a=!1,l=!1;if(this._myTeleportParams.myDetectionParams.myTeleportHeadOrFeetPositionMustBeVisible||this._myTeleportParams.myDetectionParams.myTeleportHeadPositionMustBeVisible){let u=this._myTeleportParams.myPlayerHeadManager.getHeightHead();t=o.vec3_add(i.vec3_scale(u,t),t),a=this._isPositionVisible(t)}else a=!0;this._myTeleportParams.myDetectionParams.myTeleportHeadOrFeetPositionMustBeVisible&&a?l=!0:this._myTeleportParams.myDetectionParams.myTeleportHeadOrFeetPositionMustBeVisible||this._myTeleportParams.myDetectionParams.myTeleportFeetPositionMustBeVisible&&a?(e=o.vec3_add(i.vec3_scale(this._myTeleportParams.myDetectionParams.myVisibilityCheckFeetPositionVerticalOffset,e),e),l=this._isPositionVisible(e)):l=!0,s=a&&l}return s}}();dt.prototype._isPositionVisible=function(){let i=c(),e=c(0,1,0),t=c(0,0,1),n=c(),o=c(),s=c(),a=c(),l=c(),u=c(),_=c(),m=new ct,h=new Fe,d=(g,P)=>g.pp_equals(P);return function(P){let C=!0;i=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(i),o=this._myTeleportParams.myPlayerHeadManager.getHead().pp_getPosition(o),s=P.vec3_sub(o,s).vec3_normalize(s),n.vec3_copy(e),s.vec3_angle(e)<1e-4&&n.vec3_copy(t),a=s.vec3_cross(n,a),u=a.vec3_cross(s,u),l.vec3_copy(s),u.vec3_normalize(u),l.vec3_normalize(l);let S=this._getVisibilityCheckPositions(o,u,l),M=o.vec3_distance(P);for(let D of S){m.myOrigin.vec3_copy(D),m.myDirection.vec3_copy(l),m.myDistance=M,m.myPhysics=r.getPhysics(this._myTeleportParams.myEngine),m.myBlockLayerFlags.setMask(this._myTeleportParams.myDetectionParams.myVisibilityBlockLayerFlags.getMask()),m.myObjectsToIgnore.pp_copy(this._myTeleportParams.myCollisionCheckParams.myHorizontalObjectsToIgnore);for(let v of this._myTeleportParams.myCollisionCheckParams.myVerticalObjectsToIgnore)m.myObjectsToIgnore.pp_pushUnique(v,d);if(m.myIgnoreHitsInsideCollision=!0,h=De.raycast(m,h),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugVisibilityEnabled&&r.isDebugEnabled(this._myTeleportParams.myEngine)&&r.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,h),h.isColliding()){_=D.vec3_add(l.vec3_scale(M,_),_);let v=h.myHits.pp_first();if(this._myTeleportParams.myDetectionParams.myVisibilityCheckDistanceFromHitThreshold==0||v.myPosition.vec3_distance(_)>this._myTeleportParams.myDetectionParams.myVisibilityCheckDistanceFromHitThreshold+1e-5){C=!1;break}}}return C}}();dt.prototype._getVisibilityCheckPositions=function(){let i=[],e=[],t=0,n=function(){let s=null;for(;e.length<=t;)e.push(c());return s=e[t],t++,s},o=c();return function(a,l,u){i.length=0,t=0;{let d=n();d.vec3_copy(a),i.push(d)}let _=this._myTeleportParams.myDetectionParams.myVisibilityCheckRadius/this._myTeleportParams.myDetectionParams.myVisibilityCheckCircumferenceStepAmount,m=360/this._myTeleportParams.myDetectionParams.myVisibilityCheckCircumferenceSliceAmount,h=0;for(let d=0;d<this._myTeleportParams.myDetectionParams.myVisibilityCheckCircumferenceStepAmount;d++){let g=_*(d+1);o=l.vec3_rotateAxis(h,u,o);for(let P=0;P<this._myTeleportParams.myDetectionParams.myVisibilityCheckCircumferenceSliceAmount;P++){let C=n(),f=o.vec3_rotateAxis(m*P,u,C);i.push(a.vec3_add(f.vec3_scale(g,f),f))}h+=this._myTeleportParams.myDetectionParams.myVisibilityCheckCircumferenceRotationPerStep}return i}}();import{Collider as TR,CollisionComponent as PR,Component as CR,Property as ia}from"@wonderlandengine/api";import{CursorTarget as bR}from"@wonderlandengine/components";var Ti=class extends CR{init(){this._myLastTarget=null,this._myHandInputSource=null,this._myHandednessType=ie.getHandednessByIndex(this._myHandedness),this._myDoubleClickTimer=0,this._myTripleClickTimer=0,this._myMultipleClickObject=null,this._myMultipleClickDelay=.3}start(){this._myCursorParentObject=this.object.pp_addObject(),this._myCursorObject==null?this._myCursorObject=this._myCursorParentObject.pp_addObject():this._myCursorObject.pp_setParent(this._myCursorParentObject),this._myCollisionComponent=this._myCursorObject.pp_addComponent(PR),this._myCollisionComponent.collider=TR.Sphere,this._myCollisionComponent.group=1<<this._myCollisionGroup,this._myCollisionComponent.extents=c(this._myCollisionSize,this._myCollisionSize,this._myCollisionSize)}update(e){if(this._myDoubleClickTimer>0&&(this._myDoubleClickTimer-=e),this._myTripleClickTimer>0&&(this._myTripleClickTimer-=e),this._myCursorParentObject.pp_setTransformQuat(r.getPlayerObjects(this.engine).myReferenceSpace.pp_getTransformQuat()),this._updateHand(),this._myHandInputSource){let t=this._myCollisionComponent.queryOverlaps(),n=null;for(let o=0;o<t.length;++o){let a=t[o].object.pp_getComponent(bR);if(a&&(n==null||!a.isSurface)&&(n=a,!a.isSurface))break}n?n.equals(this._myLastTarget)||(this._targetTouchEnd(),this._myLastTarget=n,this._targetTouchStart()):this._targetTouchEnd()}else this._targetTouchEnd()}_targetTouchStart(){this._myLastTarget.onHover.notify(this._myLastTarget.object,this),this._myLastTarget.onDown.notify(this._myLastTarget.object,this)}_targetTouchEnd(){this._myLastTarget&&(this._myMultipleClicksEnabled&&this._myTripleClickTimer>0&&this._myMultipleClickObject&&this._myMultipleClickObject.pp_equals(this._myLastTarget.object)?(this._myLastTarget.onTripleClick.notify(this._myLastTarget.object,this),this._myTripleClickTimer=0):this._myMultipleClicksEnabled&&this._myDoubleClickTimer>0&&this._myMultipleClickObject&&this._myMultipleClickObject.pp_equals(this._myLastTarget.object)?(this._myLastTarget.onDoubleClick.notify(this._myLastTarget.object,this),this._myTripleClickTimer=this._myMultipleClickDelay,this._myDoubleClickTimer=0):(this._myLastTarget.onClick.notify(this._myLastTarget.object,this),this._myTripleClickTimer=0,this._myDoubleClickTimer=this._myMultipleClickDelay,this._myMultipleClickObject=this._myLastTarget.object),this._myLastTarget.onUp.notify(this._myLastTarget.object,this),this._myLastTarget.onUnhover.notify(this._myLastTarget.object,this),this._myLastTarget=null)}onActivate(){this._myCursorParentObject.pp_setActive(!0)}onDeactivate(){this._myCursorParentObject.pp_setActive(!1)}_updateHand(){if(this._myHandInputSource=ie.getInputSource(this._myHandednessType,Ye.TRACKED_HAND,this.engine),this._myHandInputSource){let e=I.getFrame(this.engine).getJointPose(this._myHandInputSource.hand.get(lt.INDEX_FINGER_TIP),I.getReferenceSpace(this.engine));e&&(this._myCursorObject.pp_setRotationLocalQuat([e.transform.orientation.x,e.transform.orientation.y,e.transform.orientation.z,e.transform.orientation.w]),this._myCursorObject.pp_setPositionLocal([e.transform.position.x,e.transform.position.y,e.transform.position.z]))}}};R(Ti,"TypeName","pp-finger-cursor"),R(Ti,"Properties",{_myHandedness:ia.enum(["Left","Right"],"Left"),_myMultipleClicksEnabled:ia.bool(!0),_myCollisionGroup:ia.int(1),_myCollisionSize:ia.float(.0125),_myCursorObject:ia.object(null)});import{Component as SR,Property as sm}from"@wonderlandengine/api";var _n=class extends SR{start(){this._myHandednessType=ie.getHandednessByIndex(this._myHandedness),this._myFirstUpdate=!0,this._myCurrentInputSourceType=null}onActivate(){this._myFirstUpdate=!0}update(e){this._myFirstUpdate&&(this._myFirstUpdate=!1,this._start());let t=ie.getInputSourceTypeByHandedness(this._myHandednessType,this.engine);t!=null&&this._myCurrentInputSourceType!=t&&(this._myCurrentInputSourceType=t,t==Ye.TRACKED_HAND?(this._myGamepad!=null&&this._myGamepad.pp_setActive(!1),this._myTrackedHand!=null&&this._myTrackedHand.pp_setActive(!0)):t==Ye.GAMEPAD&&(this._myTrackedHand!=null&&this._myTrackedHand.pp_setActive(!1),this._myGamepad!=null&&this._myGamepad.pp_setActive(!0)))}_start(){this._myGamepad!=null&&this._myGamepad.pp_setActive(!1),this._myTrackedHand!=null&&this._myTrackedHand.pp_setActive(!1),this._myCurrentInputSourceType=null}};R(_n,"TypeName","pp-switch-hand-object"),R(_n,"Properties",{_myHandedness:sm.enum(["Left","Right"],"Left"),_myGamepad:sm.object(),_myTrackedHand:sm.object()});import{Component as vR,MeshComponent as xR,Property as wr}from"@wonderlandengine/api";var ti=class extends vR{start(){this._myHandednessType=ie.getHandednessByIndex(this._myHandedness),this._myJointIDType=ie.getJointIDByIndex(this._myJointID),this._buildTrackedHandHierarchy()}update(e){}_buildTrackedHandHierarchy(){this._myJointMeshObject=this.object.pp_addObject();let e=this._myJointMeshObject.pp_addComponent(xR);e.mesh=this._myJointMesh,e.material=this._myJointMaterial,this._myJointMeshObject.pp_setScaleLocal(0)}};R(ti,"TypeName","pp-tracked-hand-draw-joint"),R(ti,"Properties",{_myHandedness:wr.enum(["Left","Right"],"Left"),_myJointID:wr.enum(["Wrist","Thumb Metacarpal","Thumb Phalanx Proximal","Thumb Phalanx Distal","Thumb Tip","Index Metacarpal","Index Phalanx Proximal","Index Phalanx Intermediate","Index Phalanx Distal","Index Tip","Middle Metacarpal","Middle Phalanx Proximal","Middle Phalanx Intermediate","Middle Phalanx Distal","Middle Tip","Ring Metacarpal","Ring Phalanx Proximal","Ring Phalanx Intermediate","Ring Phalanx Distal","Ring Tip","Pinky Metacarpal","Pinky Phalanx Proximal","Pinky Phalanx Intermediate","Pinky Phalanx Distal","Pinky Tip"],"Wrist"),_myJointMesh:wr.mesh(),_myJointMaterial:wr.material()});ti.prototype.update=function(){let i=N();return function(t){let n=r.getTrackedHandPose(this._myHandednessType,this.engine).getJointPose(this._myJointIDType);this._myJointMeshObject.pp_setTransformLocalQuat(n.getTransformQuat(i,null)),this._myJointMeshObject.pp_setScaleLocal(n.getJointRadius())}}();import{Component as MR,Property as jr}from"@wonderlandengine/api";var gn=class extends MR{start(){this._buildTrackedHandHierarchy()}_buildTrackedHandHierarchy(){this._myTrackedHandMeshObject=this.object.pp_addObject(),this._myJointMeshObjectList=[];for(let e in lt){let t=lt[e];if(!this._myHideMetacarpals||t!=lt.THUMB_METACARPAL&&t!=lt.INDEX_FINGER_METACARPAL&&t!=lt.MIDDLE_FINGER_METACARPAL&&t!=lt.RING_FINGER_METACARPAL&&t!=lt.PINKY_FINGER_METACARPAL){let n=this._myTrackedHandMeshObject.pp_addObject();this._myJointMeshObjectList[t]=n,n.pp_addComponent(ti,{_myHandedness:this._myHandedness,_myJointID:So[e],_myJointMesh:this._myJointMesh,_myJointMaterial:this._myJointMaterial})}}}};R(gn,"TypeName","pp-tracked-hand-draw-all-joints"),R(gn,"Properties",{_myHandedness:jr.enum(["Left","Right"],"Left"),_myHideMetacarpals:jr.bool(!0),_myJointMesh:jr.mesh(),_myJointMaterial:jr.material()});import{Component as DR,Property as JC}from"@wonderlandengine/api";var Li=class extends DR{start(){this._myHandednessType=ie.getHandednessByIndex(this._myHandedness),this._prepareJoints()}update(e){}_prepareJoints(){this._myJoints=[];let e=this._myHandSkin.jointIds;for(let t=0;t<e.length;t++)this._myJoints[t]=y.wrapObject(e[t])}};R(Li,"TypeName","pp-tracked-hand-draw-skin"),R(Li,"Properties",{_myHandedness:JC.enum(["Left","Right"],"Left"),_myHandSkin:JC.skin(null)});Li.prototype.update=function(){let i=N();return function(t){for(let n=0;n<this._myJoints.length;n++){let o=this._myJoints[n],s=o.pp_getName(),a=r.getTrackedHandPose(this._myHandednessType,this.engine).getJointPose(s);o.pp_setTransformLocalQuat(a.getTransformQuat(i,null))}}}();import{Component as ER,Property as St}from"@wonderlandengine/api";var Hi=class extends ER{start(){let e=null;this._myHandedness==Bi.LEFT?e=r.getLeftGamepad(this.engine):e=r.getRightGamepad(this.engine),this._mySelect!=null&&(this._mySelectOriginalRotation=this._mySelect.pp_getRotationLocalQuat(),this._mySelectOriginalLeft=this._mySelect.pp_getLeftLocal()),this._mySqueeze!=null&&(this._mySqueezeOriginalPosition=this._mySqueeze.pp_getPositionLocal(),this._mySqueezeOriginalRotation=this._mySqueeze.pp_getRotationLocalQuat(),this._mySqueezeOriginalLeft=this._mySqueeze.pp_getLeftLocal(),this._mySqueezeOriginalForward=this._mySqueeze.pp_getForwardLocal()),this._myThumbstick!=null&&(this._myThumbstickOriginalPosition=this._myThumbstick.pp_getPositionLocal(),this._myThumbstickOriginalRotation=this._myThumbstick.pp_getRotationLocalQuat(),this._myThumbstickOriginalLeft=this._myThumbstick.pp_getLeftLocal(),this._myThumbstickOriginalUp=this._myThumbstick.pp_getUpLocal(),this._myThumbstickOriginalForward=this._myThumbstick.pp_getForwardLocal()),this._myTopButton!=null&&(this._myTopButtonOriginalPosition=this._myTopButton.pp_getPositionLocal(),this._myTopButtonOriginalUp=this._myTopButton.pp_getUpLocal()),this._myBottomButton!=null&&(this._myBottomButtonOriginalPosition=this._myBottomButton.pp_getPositionLocal(),this._myBottomButtonOriginalUp=this._myBottomButton.pp_getUpLocal()),this._myThumbstick!=null&&(e.registerButtonEventListener(E.THUMBSTICK,re.PRESS_START,this,this._thumbstickPressedStart.bind(this)),e.registerButtonEventListener(E.THUMBSTICK,re.PRESS_END,this,this._thumbstickPressedEnd.bind(this))),this._myTopButton!=null&&(e.registerButtonEventListener(E.TOP_BUTTON,re.PRESS_START,this,this._topButtonPressedStart.bind(this)),e.registerButtonEventListener(E.TOP_BUTTON,re.PRESS_END,this,this._topButtonPressedEnd.bind(this))),this._myBottomButton!=null&&(e.registerButtonEventListener(E.BOTTOM_BUTTON,re.PRESS_START,this,this._bottomButtonPressedStart.bind(this)),e.registerButtonEventListener(E.BOTTOM_BUTTON,re.PRESS_END,this,this._bottomButtonPressedEnd.bind(this))),this._mySelect!=null&&e.registerButtonEventListener(E.SELECT,re.VALUE_CHANGED,this,this._selectValueChanged.bind(this)),this._mySqueeze!=null&&e.registerButtonEventListener(E.SQUEEZE,re.VALUE_CHANGED,this,this._squeezeValueChanged.bind(this)),this._myThumbstick!=null&&e.registerAxesEventListener(oe.THUMBSTICK,si.AXES_CHANGED,this,this._thumbstickValueChanged.bind(this))}_thumbstickPressedStart(){}_thumbstickPressedEnd(e,t){this._myThumbstick.pp_setPositionLocal(this._myThumbstickOriginalPosition)}_topButtonPressedStart(e,t){this._myTopButton.pp_translateAxisLocal(-this._myTopButtonPressOffset,this._myTopButtonOriginalUp)}_topButtonPressedEnd(e,t){this._myTopButton.pp_setPositionLocal(this._myTopButtonOriginalPosition)}_bottomButtonPressedStart(e,t){this._myBottomButton.pp_translateAxisLocal(-this._myBottomButtonPressOffset,this._myBottomButtonOriginalUp)}_bottomButtonPressedEnd(e,t){this._myBottomButton.pp_setPositionLocal(this._myBottomButtonOriginalPosition)}_selectValueChanged(e,t){this._mySelect.pp_setRotationLocalQuat(this._mySelectOriginalRotation),e.getValue()>1e-5&&this._mySelect.pp_rotateAxisLocal(this._mySelectRotateAngle*e.getValue(),this._mySelectOriginalLeft)}_squeezeValueChanged(e,t){if(this._mySqueeze.pp_setPositionLocal(this._mySqueezeOriginalPosition),this._mySqueeze.pp_setRotationLocalQuat(this._mySqueezeOriginalRotation),e.getValue()>1e-5)if(this._myUsePressForSqueeze){let n=this._mySqueezePressOffset;this._myHandedness==1&&(n*=-1),this._mySqueeze.pp_translateAxisLocal(n*e.getValue(),this._mySqueezeOriginalLeft)}else{let n=-this._mySqueezeRotateAngle;this._myHandedness==1&&(n*=-1),this._mySqueeze.pp_rotateAxisLocal(n*e.getValue(),this._mySqueezeOriginalForward)}}_thumbstickValueChanged(e,t){this._myThumbstick.pp_setRotationLocalQuat(this._myThumbstickOriginalRotation);let n=this._myThumbstickRotateAngle*e.myAxes[1],o=this._myThumbstickRotateAngle*e.myAxes[0];Math.abs(n)>1e-4&&this._myThumbstick.pp_rotateAxisLocal(n,this._myThumbstickOriginalLeft),Math.abs(o)>1e-4&&this._myThumbstick.pp_rotateAxisLocal(o,this._myThumbstickOriginalForward)}};R(Hi,"TypeName","pp-gamepad-mesh-animator"),R(Hi,"Properties",{_myHandedness:St.enum(["Left","Right"],"Left"),_mySelect:St.object(null),_mySqueeze:St.object(null),_myThumbstick:St.object(null),_myTopButton:St.object(null),_myBottomButton:St.object(null),_mySelectRotateAngle:St.float(15),_mySqueezeRotateAngle:St.float(11),_myThumbstickRotateAngle:St.float(15),_myThumbstickPressOffset:St.float(625e-6),_myTopButtonPressOffset:St.float(.0015),_myBottomButtonPressOffset:St.float(.0015),_myUsePressForSqueeze:St.bool(!1),_mySqueezePressOffset:St.float(.0015)});Hi.prototype._thumbstickPressedStart=function(){let i=c();return function(t,n){this._myThumbstickOriginalUp.vec3_scale(-this._myThumbstickPressOffset,i),this._myThumbstick.pp_translateLocal(i)}}();var zr=.15,Nr=.15;function ZC(i){zr=i}function YC(i){Nr=i}function $C(){return zr}function eb(){return Nr}function tb(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let o of t)if(o.length==1)for(let s in E)o.push(E[s]);let n=!1;for(let o of t){let s=o[0];for(let a=1;a<o.length;a++){let l=o[a];if(s.getButtonInfo(l).isPressStart(e)){n=!0;break}}if(n)break}return n}function ib(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let s of t)if(s.length==1)for(let a in E)s.push(E[a]);let n=!0,o=!1;for(let s of t){let a=s[0];for(let l=1;l<s.length;l++){let u=s[l],_=a.getButtonInfo(u);if(!(_.myPressed&&(e==null||_.myMultiplePressStartCount==e)&&_.myTimePressed<zr)){n=!1;break}_.isPressStart(e)&&(o=!0)}if(!n)break}return n&&o}function AR(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let o of t)if(o.length==1)for(let s in E)o.push(E[s]);let n=!1;for(let o of t){let s=o[0];for(let a=1;a<o.length;a++){let l=o[a];if(s.getButtonInfo(l).isPressEnd(e)){n=!0;break}}if(n)break}return n}function nb(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let s of t)if(s.length==1)for(let a in E)s.push(E[a]);let n=!0,o=!1;for(let s of t){let a=s[0];for(let l=1;l<s.length;l++){let u=s[l],_=a.getButtonInfo(u);if(!(!_.myPressed&&(e==null||_.myMultiplePressEndCount==e)&&_.myTimeNotPressed<zr)){n=!1;break}_.isPressEnd(e)&&(o=!0)}if(!n)break}return n&&o}function ob(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let o of t)if(o.length==1)for(let s in E)o.push(E[s]);let n=!1;for(let o of t){let s=o[0];for(let a=1;a<o.length;a++){let l=o[a];if(s.getButtonInfo(l).isTouchStart(e)){n=!0;break}}if(n)break}return n}function sb(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let s of t)if(s.length==1)for(let a in E)s.push(E[a]);let n=!0,o=!1;for(let s of t){let a=s[0];for(let l=1;l<s.length;l++){let u=s[l],_=a.getButtonInfo(u);if(!(_.myTouched&&(e==null||_.myMultipleTouchStartCount==e)&&_.myTimeTouched<Nr)){n=!1;break}_.isTouchStart(e)&&(o=!0)}if(!n)break}return n&&o}function ab(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let o of t)if(o.length==1)for(let s in E)o.push(E[s]);let n=!1;for(let o of t){let s=o[0];for(let a=1;a<o.length;a++){let l=o[a];if(s.getButtonInfo(l).isTouchEnd(e)){n=!0;break}}if(n)break}return n}function rb(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let s of t)if(s.length==1)for(let a in E)s.push(E[a]);let n=!0,o=!1;for(let s of t){let a=s[0];for(let l=1;l<s.length;l++){let u=s[l],_=a.getButtonInfo(u);if(!(!_.myTouched&&(e==null||_.myMultipleTouchEndCount==e)&&_.myTimeNotTouched<Nr)){n=!1;break}_.isTouchEnd(e)&&(o=!0)}if(!n)break}return n&&o}var RR={setSimultaneousPressMaxDelay:ZC,setSimultaneousTouchMaxDelay:YC,getSimultaneousPressMaxDelay:$C,getSimultaneousTouchMaxDelay:eb,isAnyButtonPressStart:tb,areButtonsPressStart:ib,areButtonsPressEnd:nb,isAnyButtonTouchStart:ob,areButtonsTouchStart:sb,isAnyButtonTouchEnd:ab,areButtonsTouchEnd:rb};import{Alignment as OR,Component as VR,Justification as IR,MeshComponent as BR,Property as Qe,TextComponent as LR}from"@wonderlandengine/api";var fn=class extends VR{start(){this._myTextMaterialFinal=this._myTextMaterial!=null?this._myTextMaterial:r.getDefaultMaterials(this.engine).myText.clone(),this._myLineMaterialFinal=this._myLineMaterial!=null?this._myLineMaterial:r.getDefaultMaterials(this.engine).myFlatOpaque.clone(),this._myHandednessType=ie.getHandednessByIndex(this._myHandedness),this._myControlSchemeDirection=this._myHandednessType==A.LEFT?1:-1,this._myVisible=!1,this._mySetVisibleNextUpdate=!1,this._createControlScheme(),this.setVisible(this._myShowOnStart),this._myVisibleBackup=this._myVisible}update(e){this._mySetVisibleNextUpdate&&(this._mySetVisibleNextUpdate=!1,this.setVisible(!1),this.setVisible(this._myVisibleBackup))}onActivate(){this._mySetVisibleNextUpdate=!0}onDeactivate(){this._myVisibleBackup=this._myVisible,this.setVisible(!1)}isVisible(){return this._myVisible}setVisible(e){this._myVisible=e,this._myParentObject!=null&&(this._myParentObject.pp_setActive(this._myVisible),this._myVisible&&this._hideEmptySchemes())}setSelectText(e){this._mySelectText=e,this._mySelectTextComponent.text=this._mySelectText,this.setVisible(this._myVisible)}setSqueezeText(e){this._mySqueezeText=e,this._mySqueezeTextComponent.text=this._mySqueezeText,this.setVisible(this._myVisible)}setThumbstickText(e){this._myThumbstickText=e,this._myThumbstickTextComponent.text=this._myThumbstickText,this.setVisible(this._myVisible)}setBottomButtonText(e){this._myBottomButtonText=e,this._myBottomButtonTextComponent.text=this._myBottomButtonText,this.setVisible(this._myVisible)}setTopButtonText(e){this._myTopButtonText=e,this._myTopButtonTextComponent.text=this._myTopButtonText,this.setVisible(this._myVisible)}_createControlScheme(){this._myParentObject=this.object.pp_addObject();let e=.02*this._myDistanceFromButtonsMultiplier,t=.0935*this._myLineLengthMultiplier,n=this._myThumbstick;this._mySelectObject=this._myParentObject.pp_addObject(),this._mySelectTextComponent=this._addScheme(this._mySelect,n,c(0,0,e),c(t*this._myControlSchemeDirection,0,0),this._mySelectObject),this._mySelectTextComponent.text=this._mySelectText,this._mySqueezeObject=this._myParentObject.pp_addObject(),this._mySqueezeTextComponent=this._addScheme(this._mySqueeze,n,c(e*this._myControlSchemeDirection,0,0),c(t*this._myControlSchemeDirection,0,0),this._mySqueezeObject),this._mySqueezeTextComponent.text=this._mySqueezeText,this._myThumbstickObject=this._myParentObject.pp_addObject(),this._myThumbstickTextComponent=this._addScheme(this._myThumbstick,n,c(0,e,0),c(-t*this._myControlSchemeDirection,0,0),this._myThumbstickObject),this._myThumbstickTextComponent.text=this._myThumbstickText;let o=this._myThumbstick.pp_getPositionLocal(),s=this._myThumbstick.pp_getUpLocal();{let u=this._myBottomButton.pp_getPositionLocal().vec3_sub(o).vec3_valueAlongAxis(s);this._myBottomButtonObject=this._myParentObject.pp_addObject(),this._myBottomButtonTextComponent=this._addScheme(this._myBottomButton,n,c(0,e-u,0),c(0,0,-t),this._myBottomButtonObject),this._myBottomButtonTextComponent.text=this._myBottomButtonText}{let u=this._myTopButton.pp_getPositionLocal().vec3_sub(o).vec3_valueAlongAxis(s);this._myTopButtonObject=this._myParentObject.pp_addObject(),this._myTopButtonTextComponent=this._addScheme(this._myTopButton,n,c(0,e-u,0),c(-t*this._myControlSchemeDirection,0,0).vec3_rotateAxis(-45*this._myControlSchemeDirection,c(0,1,0)),this._myTopButtonObject),this._myTopButtonTextComponent.text=this._myTopButtonText}}_addScheme(e,t,n,o,s){let a=e.pp_getPositionLocal(),l=t.pp_getForwardLocal(),u=t.pp_getRightLocal(),_=t.pp_getUpLocal(),m=a.vec3_add(u.vec3_scale(n[0]));m.vec3_add(_.vec3_scale(n[1]),m),m.vec3_add(l.vec3_scale(n[2]),m);let h=m.vec3_add(u.vec3_scale(o[0]));h.vec3_add(_.vec3_scale(o[1]),h),h.vec3_add(l.vec3_scale(o[2]),h);let d=.01*this._myTextOffsetMultiplier,g=h.vec3_add(l.vec3_scale(-d));return this._addLine(m,h,s),this._addText(g,l,_,s)}_addLine(e,t,n){let o=t.vec3_sub(e),s=o.vec3_length();o.vec3_normalize(o);let a=n.pp_addObject(),l=a.pp_addObject(),u=l.pp_addComponent(BR);u.mesh=r.getDefaultMeshes(this.engine).myCylinder,u.material=this._myLineMaterialFinal,a.pp_setPositionLocal(e);let _=.001*this._myLineThicknessMultiplier;l.pp_scaleObject(c(_/2,s/2,_/2)),l.pp_setUpLocal(o),l.pp_translateObject(c(0,s/2,0))}_addText(e,t,n,o){let s=o.pp_addObject();s.pp_setPositionLocal(e),s.pp_lookToLocal(n,t),s.pp_scaleObject(.0935*this._myTextScaleMultiplier);let a=s.pp_addComponent(LR);return a.alignment=OR.Center,a.justification=IR.Top,a.material=this._myTextMaterialFinal,a}_hideEmptySchemes(){this._mySelectText.length==0&&this._mySelectObject.pp_setActive(!1),this._mySqueezeText.length==0&&this._mySqueezeObject.pp_setActive(!1),this._myThumbstickText.length==0&&this._myThumbstickObject.pp_setActive(!1),this._myBottomButtonText.length==0&&this._myBottomButtonObject.pp_setActive(!1),this._myTopButtonText.length==0&&this._myTopButtonObject.pp_setActive(!1)}};R(fn,"TypeName","pp-gamepad-control-scheme"),R(fn,"Properties",{_myShowOnStart:Qe.bool(!0),_myHandedness:Qe.enum(["Left","Right"],"Left"),_mySelectText:Qe.string(""),_mySqueezeText:Qe.string(""),_myThumbstickText:Qe.string(""),_myBottomButtonText:Qe.string(""),_myTopButtonText:Qe.string(""),_mySelect:Qe.object(null),_mySqueeze:Qe.object(null),_myThumbstick:Qe.object(null),_myBottomButton:Qe.object(null),_myTopButton:Qe.object(null),_myTextScaleMultiplier:Qe.float(1),_myTextOffsetMultiplier:Qe.float(1),_myLineLengthMultiplier:Qe.float(1),_myLineThicknessMultiplier:Qe.float(1),_myDistanceFromButtonsMultiplier:Qe.float(1),_myTextMaterial:Qe.material(),_myLineMaterial:Qe.material()});var Jo=class extends zt{constructor(e,t){super(t),this._myVirtualGamepad=e,this._myButtonData=this._createButtonData(),this._myAxesData=this._createAxesData(),this._myHapticActuators=[]}isGamepadCoreActive(){return this._myVirtualGamepad.isVisible()}getButtonData(e){return this._myButtonData.myPressed=!1,this._myButtonData.myTouched=!1,this._myButtonData.myValue=0,this.isGamepadCoreActive()&&this._myVirtualGamepad.isButtonPressed(this.getHandedness(),e)&&(this._myButtonData.myPressed=!0,this._myButtonData.myTouched=!0,this._myButtonData.myValue=1),this._myButtonData}getAxesData(e){return this._myAxesData.vec2_zero(),this.isGamepadCoreActive()&&this._myVirtualGamepad.getAxes(this.getHandedness(),e,this._myAxesData),this._myAxesData}getHapticActuators(){return this._myHapticActuators}};var Ie={NONE:0,LABEL:1,IMAGE:2,DOT:3,CIRCLE:4,SQUARE:5,RING:6,FRAME:7},Zo=class{constructor(){this.myBackgroundColor="",this.myBackgroundPressedColor="",this.myIconColor="",this.myIconPressedColor="",this.myIconType=Ie.NONE,this.myOverallHoveredBrightness=1,this.myLabel="",this.myLabelFontSize=0,this.myLabelFontFamily="",this.myLabelFontWeight="",this.myImageURL="",this.myImagePressedBrightness=1}},ao=class{constructor(e,t,n,o,s=r.getMainEngine()){this._myEngine=s,this._myParams=t,this._myIconContainerElement=null,this._myBackgroundElement=null,this._myIconElement=null,this._myPressed=!1,this._myMouseHover=!1,this._myMouseHoverEnabled=!0,this._myDestroyed=!1,this._build(e,n,o)}update(e){this._myPressed||!this._myMouseHover||!this._myMouseHoverEnabled?this._myIconContainerElement.style.filter="none":this._myIconContainerElement.style.filter="brightness("+this._myParams.myOverallHoveredBrightness+")"}reset(){this.setPressed(!1),this._myMouseHover=!1,this._myIconContainerElement.style.filter="none"}setPressed(e){this._myPressed!=e&&(this._myPressed=e,this._myPressed?(this._myBackgroundElement.style.fill=this._myParams.myBackgroundPressedColor,this._myIconElement!=null&&(this._myIconElement.style.strokeWidth.length>0?this._myIconElement.style.stroke=this._myParams.myIconPressedColor:this._myIconElement.style.fill=this._myParams.myIconPressedColor,this._myParams.myIconType==Ie.IMAGE&&(this._myIconElement.style.filter="brightness("+this._myParams.myImagePressedBrightness+")"))):(this._myBackgroundElement.style.fill=this._myParams.myBackgroundColor,this._myIconElement!=null&&(this._myIconElement.style.strokeWidth.length>0?this._myIconElement.style.stroke=this._myParams.myIconColor:this._myIconElement.style.fill=this._myParams.myIconColor,this._myParams.myIconType==Ie.IMAGE&&(this._myIconElement.style.filter="none"))))}onMouseEnter(){this._myMouseHover=!0}onMouseLeave(){this._myMouseHover=!1}setMouseHoverEnabled(e){this._myMouseHoverEnabled=e}_build(e,t,n){switch(this._myIconContainerElement=r.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","svg"),this._myIconContainerElement.style.position="absolute",this._myIconContainerElement.style.width="100%",this._myIconContainerElement.style.height="100%",e.appendChild(this._myIconContainerElement),this._myBackgroundElement=r.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","circle"),this._myBackgroundElement.setAttributeNS(null,"cx","50%"),this._myBackgroundElement.setAttributeNS(null,"cy","50%"),this._myBackgroundElement.setAttributeNS(null,"r","50%"),this._myBackgroundElement.style.fill=this._myParams.myBackgroundColor,this._myIconContainerElement.appendChild(this._myBackgroundElement),this._myParams.myIconType){case Ie.NONE:break;case Ie.LABEL:this._myIconElement=r.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","text"),this._myIconElement.setAttributeNS(null,"x","50%"),this._myIconElement.setAttributeNS(null,"y","50%"),this._myIconElement.style.textAlign="center",this._myIconElement.style.textAnchor="middle",this._myIconElement.style.dominantBaseline="central",this._myIconElement.style.alignmentBaseline="central",this._myIconElement.style.fontFamily=this._myParams.myLabelFontFamily,this._myIconElement.style.fontWeight=this._myParams.myLabelFontWeight,this._myIconElement.style.fontSize=this._createSizeValue(this._myParams.myLabelFontSize*n,t),this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconElement.textContent=this._myParams.myLabel,this._myIconContainerElement.appendChild(this._myIconElement);break;case Ie.IMAGE:this._myIconElement=r.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","image"),this._myIconElement.setAttributeNS(null,"x","0%"),this._myIconElement.setAttributeNS(null,"y","0%"),this._myIconElement.setAttribute("href",this._myParams.myImageURL),this._myIconElement.style.width="100%",this._myIconElement.style.height="100%",this._myIconElement.style.filter="none",this._myIconContainerElement.appendChild(this._myIconElement);break;case Ie.DOT:this._myIconElement=r.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","circle"),this._myIconElement.setAttributeNS(null,"cx","50%"),this._myIconElement.setAttributeNS(null,"cy","50%"),this._myIconElement.setAttributeNS(null,"r","17.5%"),this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconContainerElement.appendChild(this._myIconElement);break;case Ie.CIRCLE:this._myIconElement=r.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","circle"),this._myIconElement.setAttributeNS(null,"cx","50%"),this._myIconElement.setAttributeNS(null,"cy","50%"),this._myIconElement.setAttributeNS(null,"r","24%"),this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconContainerElement.appendChild(this._myIconElement);break;case Ie.SQUARE:this._myIconElement=r.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","rect"),this._myIconElement.setAttributeNS(null,"x","28%"),this._myIconElement.setAttributeNS(null,"y","28%"),this._myIconElement.setAttributeNS(null,"rx","10%"),this._myIconElement.setAttributeNS(null,"ry","10%"),this._myIconElement.setAttributeNS(null,"width","44%"),this._myIconElement.setAttributeNS(null,"height","44%"),this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconElement.style.transformOrigin="center",this._myIconContainerElement.appendChild(this._myIconElement);break;case Ie.RING:this._myIconElement=r.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","circle"),this._myIconElement.setAttributeNS(null,"cx","50%"),this._myIconElement.setAttributeNS(null,"cy","50%"),this._myIconElement.setAttributeNS(null,"r","20%"),this._myIconElement.style.fill="#00000000",this._myIconElement.style.stroke=this._myParams.myIconColor,this._myIconElement.style.strokeWidth="10%",this._myIconContainerElement.appendChild(this._myIconElement);break;case Ie.FRAME:this._myIconElement=r.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","rect"),this._myIconElement.setAttributeNS(null,"x","31.5%"),this._myIconElement.setAttributeNS(null,"y","31.5%"),this._myIconElement.setAttributeNS(null,"rx","10%"),this._myIconElement.setAttributeNS(null,"ry","10%"),this._myIconElement.setAttributeNS(null,"width","37%"),this._myIconElement.setAttributeNS(null,"height","37%"),this._myIconElement.style.fill="#00000000",this._myIconElement.style.stroke=this._myParams.myIconColor,this._myIconElement.style.strokeWidth="10%",this._myIconElement.style.transformOrigin="center",this._myIconContainerElement.appendChild(this._myIconElement);break}}_createSizeValue(e,t){return"min("+e.toFixed(3)+"vmax,"+(e*t).toFixed(3)+"vw)"}_invertColors(){this._myIconElement.style.strokeWidth.length>0?(this._myBackgroundElement.style.fill=this._myParams.myIconColor,this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconElement.style.stroke=this._myParams.myBackgroundColor):(this._myBackgroundElement.style.fill=this._myParams.myIconColor,this._myIconElement.style.fill=this._myParams.myBackgroundColor)}destroy(){this._myDestroyed=!0,this._myIconContainerElement.remove()}isDestroyed(){return this._myDestroyed}};var Dt=class{constructor(){this.myIconParams=new Zo}},na=class{constructor(){this.myBackgroundColor="",this.myMaxDistanceFromCenterMultiplier=1,this.myReleaseTransitionSeconds=.2,this.myMoveTransitionSeconds=0,this.myIncludeBackgroundToDetection=!1,this.myIconParams=new Zo}},ro=class{constructor(e=r.getMainEngine()){this.myShowOnDesktop=!1,this.myShowOnMobile=!1,this.myShowOnHeadset=!1,this.myAutoUpdateVisibility=!1,this.myOpacity=1,this.myInterfaceScale=1,this.myMarginScale=1,this.myReleaseOnPointerLeave=!0,this.myStopPropagatingMouseDownEvents=!0,this.myButtonParams=[],this.myButtonParams[A.LEFT]=[],this.myButtonParams[A.RIGHT]=[],this.myButtonParams[A.LEFT][E.SELECT]=new Dt,this.myButtonParams[A.LEFT][E.SQUEEZE]=new Dt,this.myButtonParams[A.LEFT][E.THUMBSTICK]=new Dt,this.myButtonParams[A.LEFT][E.TOP_BUTTON]=new Dt,this.myButtonParams[A.LEFT][E.BOTTOM_BUTTON]=new Dt,this.myButtonParams[A.RIGHT][E.SELECT]=new Dt,this.myButtonParams[A.RIGHT][E.SQUEEZE]=new Dt,this.myButtonParams[A.RIGHT][E.THUMBSTICK]=new Dt,this.myButtonParams[A.RIGHT][E.TOP_BUTTON]=new Dt,this.myButtonParams[A.RIGHT][E.BOTTOM_BUTTON]=new Dt,this.myThumbstickParams=[],this.myThumbstickParams[A.LEFT]=[],this.myThumbstickParams[A.RIGHT]=[],this.myThumbstickParams[A.LEFT][oe.THUMBSTICK]=new na,this.myThumbstickParams[A.RIGHT][oe.THUMBSTICK]=new na,this.myButtonsOrder=[],this.myButtonsOrder[A.LEFT]=[null,null,null,null,null],this.myButtonsOrder[A.RIGHT]=[null,null,null,null,null],this.myThumbsticksOrder=[],this.myThumbsticksOrder[A.LEFT]=[null],this.myThumbsticksOrder[A.RIGHT]=[null],this.myValidPointerButtons=[],this.myMarginLeft=0,this.myMarginRight=0,this.myMarginBottom=0,this.myThumbstickSize=0,this.myButtonSize=0,this.myButtonsRingRadius=0,this.myButtonsRingStartAngle=0,this.myButtonsRingEndAngle=0,this.myFontSize=0,this.myMinSizeMultiplier=0,this.myDisableMouseHoverWhenPressed=!1,this.myEngine=e}defaultConfig(){this.myShowOnMobile=!0,this.myAutoUpdateVisibility=!0,this.myOpacity=.5;let e="#616161",t="#e0e0e0",n=.75,o=.75,s=!0;for(let a in this.myButtonParams)for(let l in this.myButtonParams[a]){let u=this.myButtonParams[a][l];u.myIconParams.myBackgroundColor=e,u.myIconParams.myBackgroundPressedColor=t,u.myIconParams.myIconColor=t,u.myIconParams.myIconPressedColor=e,u.myIconParams.myOverallHoveredBrightness=n}this.myButtonParams[A.LEFT][E.SQUEEZE].myIconParams.myIconType=Ie.SQUARE,this.myButtonParams[A.RIGHT][E.SQUEEZE].myIconParams.myIconType=Ie.SQUARE,this.myButtonParams[A.LEFT][E.SELECT].myIconParams.myIconType=Ie.FRAME,this.myButtonParams[A.RIGHT][E.SELECT].myIconParams.myIconType=Ie.FRAME,this.myButtonParams[A.LEFT][E.TOP_BUTTON].myIconParams.myIconType=Ie.CIRCLE,this.myButtonParams[A.RIGHT][E.TOP_BUTTON].myIconParams.myIconType=Ie.CIRCLE,this.myButtonParams[A.LEFT][E.BOTTOM_BUTTON].myIconParams.myIconType=Ie.RING,this.myButtonParams[A.RIGHT][E.BOTTOM_BUTTON].myIconParams.myIconType=Ie.RING,this.myButtonParams[A.LEFT][E.THUMBSTICK].myIconParams.myIconType=Ie.DOT,this.myButtonParams[A.RIGHT][E.THUMBSTICK].myIconParams.myIconType=Ie.DOT;for(let a in this.myThumbstickParams)for(let l in this.myThumbstickParams[a]){let u=this.myThumbstickParams[a][l];u.myBackgroundColor=e,u.myIconParams.myBackgroundColor=t,u.myIconParams.myBackgroundPressedColor=t,u.myIconParams.myIconColor=e,u.myIconParams.myIconPressedColor=e,u.myIconParams.myOverallHoveredBrightness=o,u.myIncludeBackgroundToDetection=s}this.myButtonsOrder[A.LEFT][0]=[A.LEFT,E.SQUEEZE],this.myButtonsOrder[A.LEFT][1]=[A.LEFT,E.SELECT],this.myButtonsOrder[A.LEFT][2]=[A.LEFT,E.TOP_BUTTON],this.myButtonsOrder[A.LEFT][3]=[A.LEFT,E.BOTTOM_BUTTON],this.myButtonsOrder[A.LEFT][4]=[A.LEFT,E.THUMBSTICK],this.myButtonsOrder[A.RIGHT][0]=[A.RIGHT,E.SQUEEZE],this.myButtonsOrder[A.RIGHT][1]=[A.RIGHT,E.SELECT],this.myButtonsOrder[A.RIGHT][2]=[A.RIGHT,E.TOP_BUTTON],this.myButtonsOrder[A.RIGHT][3]=[A.RIGHT,E.BOTTOM_BUTTON],this.myButtonsOrder[A.RIGHT][4]=[A.RIGHT,E.THUMBSTICK],this.myThumbsticksOrder[A.LEFT][0]=[A.LEFT,oe.THUMBSTICK],this.myThumbsticksOrder[A.RIGHT][0]=[A.RIGHT,oe.THUMBSTICK],this.myMarginLeft=3,this.myMarginRight=3,this.myMarginBottom=3,this.myThumbstickSize=15,this.myButtonSize=5,this.myButtonsRingRadius=12,this.myButtonsRingStartAngle=385,this.myButtonsRingEndAngle=245,this.myMinSizeMultiplier=5/3,this.myDisableMouseHoverWhenPressed=!0,this.myValidPointerButtons=[0]}};var oa=class{constructor(e,t,n,o,s,a){this._myButtonElement=null,this._myButtonIcon=null,this._myButtonDetectionElement=null,this._myActive=!0,this._myPointerID=null,this._myPointerButton=null,this._myPressed=!1,this._myVirtualGamepadParams=t,this._myParams=this._myVirtualGamepadParams.myButtonParams[s][a],this._build(e,n,o),this._myPointerDownEventListener=this._onPointerDown.bind(this,this._myVirtualGamepadParams.myStopPropagatingPointerDownEvents),this._myPointerUpEventListener=this._onPointerUp.bind(this),this._myPointerLeaveEventListener=this._onPointerLeave.bind(this),this._myMouseEnterEventListener=this._onButtonEnter.bind(this),this._myMouseLeaveEventListener=this._onButtonLeave.bind(this),this._myButtonDetectionElement.addEventListener("pointerdown",this._myPointerDownEventListener),r.getBody(this._myVirtualGamepadParams.myEngine).addEventListener("pointerup",this._myPointerUpEventListener),this._myVirtualGamepadParams.myReleaseOnPointerLeave&&r.getBody(this._myVirtualGamepadParams.myEngine).addEventListener("pointerleave",this._myPointerLeaveEventListener),this._myButtonDetectionElement.addEventListener("mouseenter",this._myMouseEnterEventListener),this._myButtonDetectionElement.addEventListener("mouseleave",this._myMouseLeaveEventListener),this._myDestroyed=!1}isPressed(){return this._myActive&&this._myPressed}setActive(e){this._myActive!=e&&(this.reset(),this._myButtonIcon.reset()),this._myActive=e}setMouseHoverEnabled(e){this._myButtonIcon.setMouseHoverEnabled(e)}reset(){this._myButtonIcon.setPressed(!1),this._myPressed=!1,this._myPointerID=null,this._myPointerButton=null}update(e){this._myButtonIcon.update(e)}_onPointerDown(e,t){!this._myActive||this._myPressed||!this._myVirtualGamepadParams.myValidPointerButtons.pp_hasEqual(t.button)||(e&&t.stopPropagation(),t.preventDefault(),this._myButtonIcon.setPressed(!0),this._myPointerID=t.pointerId,this._myPointerButton=t.button,this._myPressed=!0)}_onPointerUp(e){!this._myActive||!this._myPressed||this._myPointerID==e.pointerId&&(this._myPointerButton!=null&&this._myPointerButton!=e.button||this.reset())}_onPointerLeave(e){!this._myActive||this._myPointerID==e.pointerId&&this.reset()}_onButtonEnter(e){!this._myActive||this._myButtonIcon.onMouseEnter(e)}_onButtonLeave(e){!this._myActive||this._myButtonIcon.onMouseLeave(e)}_build(e,t,n){let o=this._myVirtualGamepadParams.myButtonSize*this._myVirtualGamepadParams.myInterfaceScale,s=this._myVirtualGamepadParams.myButtonsRingRadius*this._myVirtualGamepadParams.myInterfaceScale,a=this._myVirtualGamepadParams.myThumbstickSize*this._myVirtualGamepadParams.myInterfaceScale,l=this._myVirtualGamepadParams.myMarginBottom*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,u=this._myVirtualGamepadParams.myMarginLeft*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,_=this._myVirtualGamepadParams.myMarginRight*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,m=this._myVirtualGamepadParams.myButtonsRingStartAngle,h=this._myVirtualGamepadParams.myButtonsRingEndAngle,d=Math.max(1,this._myVirtualGamepadParams.myMinSizeMultiplier/this._myVirtualGamepadParams.myInterfaceScale),g=this._myVirtualGamepadParams.myButtonsOrder[A.LEFT].length,P=(h-m)/(g-1),C=Math.pp_angleClamp(m+P*n);t==A.RIGHT&&(C=270+(270-C),C=Math.pp_angleClamp(C,!0));let f=360-C;this._myButtonContainer=r.getDocument(this._myVirtualGamepadParams.myEngine).createElement("div"),this._myButtonContainer.style.position="absolute",this._myButtonContainer.style.width=this._createSizeValue(o,d),this._myButtonContainer.style.height=this._createSizeValue(o,d);let S=l+a/2-o/2;if(this._myButtonContainer.style.bottom=this._createSizeValue(S,d),t==A.LEFT){let b=u+a/2-o/2;this._myButtonContainer.style.left=this._createSizeValue(b,d)}else{let b=_+a/2-o/2;this._myButtonContainer.style.right=this._createSizeValue(b,d)}this._myButtonContainer.style.transform="rotate("+C+"deg) translateX("+this._createSizeValue(s,d)+")",e.appendChild(this._myButtonContainer),this._myButtonElement=r.getDocument(this._myVirtualGamepadParams.myEngine).createElement("div"),this._myButtonElement.style.position="absolute",this._myButtonElement.style.width="100%",this._myButtonElement.style.height="100%",this._myButtonElement.style.transform="rotate("+f+"deg)",this._myButtonContainer.appendChild(this._myButtonElement),this._myButtonIcon=new ao(this._myButtonElement,this._myParams.myIconParams,d,this._myVirtualGamepadParams.myInterfaceScale,this._myVirtualGamepadParams.myEngine);let M=r.getDocument(this._myVirtualGamepadParams.myEngine).createElement("div");M.style.position="absolute",M.style.width="100%",M.style.height="100%",M.style.transform="rotate("+f+"deg)",this._myButtonContainer.appendChild(M);let D=r.getDocument(this._myVirtualGamepadParams.myEngine).createElementNS("http://www.w3.org/2000/svg","svg");D.style.position="absolute",D.style.width="100%",D.style.height="100%",M.appendChild(D);let v=r.getDocument(this._myVirtualGamepadParams.myEngine).createElementNS("http://www.w3.org/2000/svg","circle");v.setAttributeNS(null,"cx","50%"),v.setAttributeNS(null,"cy","50%"),v.setAttributeNS(null,"r","50%"),v.style.fill="#00000000",D.appendChild(v),this._myButtonDetectionElement=v}_createSizeValue(e,t){return"min("+e.toFixed(3)+"vmax,"+(e*t).toFixed(3)+"vw)"}destroy(){this._myDestroyed=!0,this._myButtonDetectionElement.removeEventListener("pointerdown",this._myPointerDownEventListener),r.getBody(this._myVirtualGamepadParams.myEngine).removeEventListener("pointerup",this._myPointerUpEventListener),r.getBody(this._myVirtualGamepadParams.myEngine).removeEventListener("pointerleave",this._myPointerLeaveEventListener),this._myButtonDetectionElement.removeEventListener("mouseenter",this._myMouseEnterEventListener),this._myButtonDetectionElement.removeEventListener("mouseleave",this._myPointerUpEventLis_myMouseLeaveEventListenertener),this._myButtonIcon.destroy(),this._myButtonContainer.remove()}isDestroyed(){return this._myDestroyed}};var sa=class{constructor(e,t,n,o,s){this._myThumbstickElement=null,this._myThumbstickIcon=null,this._myThumbstickBackground=null,this._myThumbstickDetectionElement=null,this._myActive=!0,this._myPointerID=null,this._myPointerButton=null,this._myThumbstickDragStartPosition=Ae(),this._myAxes=Ae(),this._myPressed=!1,this._myVirtualGamepadParams=t,this._myParams=this._myVirtualGamepadParams.myThumbstickParams[o][s],this._build(e,n),this._myPointerDownEventListener=this._onPointerDown.bind(this,this._myVirtualGamepadParams.myStopPropagatingPointerDownEvents),this._myPointerUpEventListener=this._onPointerUp.bind(this),this._myPointerMoveEventListener=this._onPointerMove.bind(this),this._myPointerLeaveEventListener=this._onPointerLeave.bind(this),this._myMouseEnterEventListener=this._onThumbstickEnter.bind(this),this._myMouseLeaveEventListener=this._onThumbstickLeave.bind(this),this._myThumbstickDetectionElement.addEventListener("pointerdown",this._myPointerDownEventListener),r.getBody(this._myVirtualGamepadParams.myEngine).addEventListener("pointerup",this._myPointerUpEventListener),r.getBody(this._myVirtualGamepadParams.myEngine).addEventListener("pointermove",this._myPointerMoveEventListener),this._myVirtualGamepadParams.myReleaseOnPointerLeave&&r.getBody(this._myVirtualGamepadParams.myEngine).addEventListener("pointerleave",this._myPointerLeaveEventListener),this._myThumbstickDetectionElement.addEventListener("mouseenter",this._myMouseEnterEventListener),this._myThumbstickDetectionElement.addEventListener("mouseleave",this._myMouseLeaveEventListener),this._myDestroyed=!1}isPressed(){return this._myActive&&this._myPressed}getAxes(){return this._myAxes}setActive(e){this._myActive!=e&&(this.reset(),this._myThumbstickIcon.reset()),this._myActive=e}setMouseHoverEnabled(e){this._myThumbstickIcon.setMouseHoverEnabled(e)}reset(){this._myThumbstickIcon.setPressed(!1),this._myAxes[0]=0,this._myAxes[1]=0,this._myPressed=!1,this._myPointerID=null,this._myPointerButton=null,this._myThumbstickElement.style.transition="all "+this._myParams.myReleaseTransitionSeconds+"s ease 0s",this._myThumbstickElement.style.transform="translate(0px, 0px)"}update(e){this._myThumbstickIcon.update(e)}_onPointerDown(e,t){!this._myActive||this._myPressed||!this._myVirtualGamepadParams.myValidPointerButtons.pp_hasEqual(t.button)||(e&&t.stopPropagation(),t.preventDefault(),this._myThumbstickIcon.setPressed(!0),this._myPointerID=t.pointerId,this._myPointerButton=t.button,this._myThumbstickDragStartPosition[0]=t.clientX,this._myThumbstickDragStartPosition[1]=t.clientY,this._myPressed=!0)}_onPointerUp(e){!this._myActive||!this._myPressed||this._myPointerID==e.pointerId&&(this._myPointerButton!=null&&this._myPointerButton!=e.button||this.reset())}_onPointerLeave(e){!this._myActive||this._myPointerID==e.pointerId&&this.reset()}_onThumbstickEnter(e){this._myThumbstickIcon.onMouseEnter(e)}_onThumbstickLeave(e){this._myThumbstickIcon.onMouseLeave(e)}_onPointerMove(e){if(!this._myActive||!this._myPressed||e.pointerId!=this._myPointerID)return;let t=e.clientX,n=e.clientY,s=this._myThumbstickBackground.getBoundingClientRect().width/2*this._myParams.myMaxDistanceFromCenterMultiplier,a=t-this._myThumbstickDragStartPosition[0],l=n-this._myThumbstickDragStartPosition[1],u=Math.atan2(l,a),_=Math.min(s,Math.hypot(a,l)),m=_*Math.cos(u),h=_*Math.sin(u);this._myThumbstickElement.style.transition="all "+this._myParams.myMoveTransitionSeconds+"s ease-out 0s",this._myThumbstickElement.style.transform="translate("+m+"px, "+h+"px)",this._myAxes[0]=m/s,this._myAxes[1]=-(h/s)}_build(e,t){let n=this._myVirtualGamepadParams.myThumbstickSize*this._myVirtualGamepadParams.myInterfaceScale,o=this._myVirtualGamepadParams.myMarginBottom*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,s=this._myVirtualGamepadParams.myMarginLeft*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,a=this._myVirtualGamepadParams.myMarginRight*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,l=Math.max(1,this._myVirtualGamepadParams.myMinSizeMultiplier/this._myVirtualGamepadParams.myInterfaceScale);this._myThumbstickContainer=r.getDocument(this._myVirtualGamepadParams.myEngine).createElement("div"),this._myThumbstickContainer.style.position="absolute",this._myThumbstickContainer.style.width=this._createSizeValue(n,l),this._myThumbstickContainer.style.height=this._createSizeValue(n,l),this._myThumbstickContainer.style.bottom=this._createSizeValue(o,l),t==A.LEFT?this._myThumbstickContainer.style.left=this._createSizeValue(s,l):this._myThumbstickContainer.style.right=this._createSizeValue(a,l),e.appendChild(this._myThumbstickContainer);let u=r.getDocument(this._myVirtualGamepadParams.myEngine).createElementNS("http://www.w3.org/2000/svg","svg");if(u.style.position="absolute",u.style.width="100%",u.style.height="100%",this._myThumbstickContainer.appendChild(u),this._myThumbstickBackground=r.getDocument(this._myVirtualGamepadParams.myEngine).createElementNS("http://www.w3.org/2000/svg","circle"),this._myThumbstickBackground.setAttributeNS(null,"cx","50%"),this._myThumbstickBackground.setAttributeNS(null,"cy","50%"),this._myThumbstickBackground.setAttributeNS(null,"r","48%"),this._myThumbstickBackground.style.fill=this._myParams.myBackgroundColor,u.appendChild(this._myThumbstickBackground),this._myThumbstickElement=r.getDocument(this._myVirtualGamepadParams.myEngine).createElement("div"),this._myThumbstickElement.style.position="absolute",this._myThumbstickElement.style.width="34%",this._myThumbstickElement.style.height="34%",this._myThumbstickElement.style.top="33%",this._myThumbstickElement.style.left="33%",this._myThumbstickContainer.appendChild(this._myThumbstickElement),this._myThumbstickIcon=new ao(this._myThumbstickElement,this._myParams.myIconParams,l,this._myVirtualGamepadParams.myScale,this._myVirtualGamepadParams.myEngine),this._myParams.myIncludeBackgroundToDetection){let _=r.getDocument(this._myVirtualGamepadParams.myEngine).createElementNS("http://www.w3.org/2000/svg","svg");_.style.position="absolute",_.style.width="100%",_.style.height="100%",this._myThumbstickContainer.appendChild(_);let m=r.getDocument(this._myVirtualGamepadParams.myEngine).createElementNS("http://www.w3.org/2000/svg","circle");m.setAttributeNS(null,"cx","50%"),m.setAttributeNS(null,"cy","50%"),m.setAttributeNS(null,"r","48%"),m.style.fill="#00000000",_.appendChild(m),this._myThumbstickDetectionElement=m}else{let _=r.getDocument(this._myVirtualGamepadParams.myEngine).createElement("div");_.style.position="absolute",_.style.width="34%",_.style.height="34%",_.style.top="33%",_.style.left="33%",this._myThumbstickContainer.appendChild(_);let m=r.getDocument(this._myVirtualGamepadParams.myEngine).createElementNS("http://www.w3.org/2000/svg","svg");m.style.position="absolute",m.style.width="100%",m.style.height="100%",_.appendChild(m);let h=r.getDocument(this._myVirtualGamepadParams.myEngine).createElementNS("http://www.w3.org/2000/svg","circle");h.setAttributeNS(null,"cx","50%"),h.setAttributeNS(null,"cy","50%"),h.setAttributeNS(null,"r","50%"),h.style.fill="#00000000",m.appendChild(h),this._myThumbstickDetectionElement=h}}_createSizeValue(e,t){return"min("+e.toFixed(3)+"vmax,"+(e*t).toFixed(3)+"vw)"}destroy(){this._myDestroyed=!0,this._myThumbstickDetectionElement.removeEventListener("pointerdown",this._myPointerDownEventListener),r.getBody(this._myVirtualGamepadParams.myEngine).removeEventListener("pointerup",this._myPointerUpEventListener),r.getBody(this._myVirtualGamepadParams.myEngine).removeEventListener("pointermove",this._myPointerMoveEventListener),r.getBody(this._myVirtualGamepadParams.myEngine).removeEventListener("pointerleave",this._myPointerLeaveEventListener),this._myThumbstickDetectionElement.removeEventListener("mouseenter",this._myMouseEnterEventListener),this._myThumbstickDetectionElement.removeEventListener("mouseleave",this._myPointerUpEventLis_myMouseLeaveEventListenertener),this._myThumbstickIcon.destroy(),this._myThumbstickContainer.remove()}isDestroyed(){return this._myDestroyed}};var aa=class{constructor(e=new ro){this._myParams=e,this._myVisible=!0,this._myVirtualGamepadContainer=null,this._myVirtualGamepadVirtualButtons=[],this._myVirtualGamepadVirtualButtons[A.LEFT]=[],this._myVirtualGamepadVirtualButtons[A.RIGHT]=[],this._myVirtualGamepadVirtualButtons[A.LEFT][E.SELECT]=null,this._myVirtualGamepadVirtualButtons[A.LEFT][E.SQUEEZE]=null,this._myVirtualGamepadVirtualButtons[A.LEFT][E.THUMBSTICK]=null,this._myVirtualGamepadVirtualButtons[A.LEFT][E.TOP_BUTTON]=null,this._myVirtualGamepadVirtualButtons[A.LEFT][E.BOTTOM_BUTTON]=null,this._myVirtualGamepadVirtualButtons[A.RIGHT][E.SELECT]=null,this._myVirtualGamepadVirtualButtons[A.RIGHT][E.SQUEEZE]=null,this._myVirtualGamepadVirtualButtons[A.RIGHT][E.THUMBSTICK]=null,this._myVirtualGamepadVirtualButtons[A.RIGHT][E.TOP_BUTTON]=null,this._myVirtualGamepadVirtualButtons[A.RIGHT][E.BOTTOM_BUTTON]=null,this._myButtonsAmount=this._myVirtualGamepadVirtualButtons[A.LEFT].length,this._myVirtualGamepadVirtualThumbsticks=[],this._myVirtualGamepadVirtualThumbsticks[A.LEFT]=[],this._myVirtualGamepadVirtualThumbsticks[A.RIGHT]=[],this._myVirtualGamepadVirtualThumbsticks[A.LEFT][oe.THUMBSTICK]=null,this._myVirtualGamepadVirtualThumbsticks[A.RIGHT][oe.THUMBSTICK]=null,this._myGestureStartEventListener=null,this._myDestroyed=!1}isVisible(){return this._myVisible}setVisible(e){if(this._myVisible!=e&&(this._myVisible=e,this._myVirtualGamepadContainer!=null)){this._myVisible?this._myVirtualGamepadContainer.style.display="block":this._myVirtualGamepadContainer.style.display="none";for(let t in this._myVirtualGamepadVirtualButtons)for(let n in this._myVirtualGamepadVirtualButtons[t]){let o=this._myVirtualGamepadVirtualButtons[t][n];o?.setActive(this._myVisible)}for(let t in this._myVirtualGamepadVirtualThumbsticks)for(let n in this._myVirtualGamepadVirtualThumbsticks[t]){let o=this._myVirtualGamepadVirtualThumbsticks[t][n];o?.setActive(this._myVisible)}}}isButtonPressed(e,t){if(!this._myVisible)return!1;let n=this._myVirtualGamepadVirtualButtons[e][t];return n!=null?n.isPressed():!1}getAxes(e,t,n=Ae(0,0)){if(!this._myVisible)return n;let o=this._myVirtualGamepadVirtualThumbsticks[e][t];return o!=null&&n.vec2_copy(o.getAxes()),n}start(){this._buildVirtualGamepad();let e=this._myVisible;this._myVisible=!this._myVisible,this.setVisible(e)}update(e){if(this._myParams.myAutoUpdateVisibility&&(I.isSessionActive(this._myParams.myEngine)&&I.isVRSupported(this._myParams.myEngine)?this.setVisible(!1):this._myParams.myShowOnDesktop&&Jn.isDesktop(this._myParams.myEngine)&&!I.isVRSupported(this._myParams.myEngine)?this.setVisible(!0):this._myParams.myShowOnHeadset&&Jn.isDesktop(this._myParams.myEngine)&&I.isVRSupported(this._myParams.myEngine)?this.setVisible(!0):this._myParams.myShowOnMobile&&Jn.isMobile(this._myParams.myEngine)?this.setVisible(!0):this.setVisible(!1)),this._myVisible){for(let t in this._myVirtualGamepadVirtualButtons)for(let n in this._myVirtualGamepadVirtualButtons[t]){let o=this._myVirtualGamepadVirtualButtons[t][n];o?.update(e)}for(let t in this._myVirtualGamepadVirtualThumbsticks)for(let n in this._myVirtualGamepadVirtualThumbsticks[t]){let o=this._myVirtualGamepadVirtualThumbsticks[t][n];o?.update(e)}this._setMouseHoverEnabled(!(this._myParams.myDisableMouseHoverWhenPressed&&this._isAnyElementPressed()))}}_buildVirtualGamepad(){this._setupDocumentBody(),this._myVirtualGamepadContainer=r.getDocument(this._myParams.myEngine).createElement("div"),this._myVirtualGamepadContainer.style.display="block",this._myVirtualGamepadContainer.style.opacity=this._myParams.myOpacity.toString(),r.getBody(this._myParams.myEngine).appendChild(this._myVirtualGamepadContainer);let e=r.getDocument(this._myParams.myEngine).createElement("div");this._myVirtualGamepadContainer.appendChild(e);let t=r.getDocument(this._myParams.myEngine).createElement("div");this._myVirtualGamepadContainer.appendChild(t);let n=this._myParams.myButtonsOrder[A.LEFT].length;for(let s=0;s<n;s++){if(this._myParams.myButtonsOrder[A.LEFT][s]!=null){let a=this._myParams.myButtonsOrder[A.LEFT][s][0],l=this._myParams.myButtonsOrder[A.LEFT][s][1];this._buildButton(e,A.LEFT,s,a,l)}if(this._myParams.myButtonsOrder[A.RIGHT][s]!=null){let a=this._myParams.myButtonsOrder[A.RIGHT][s][0],l=this._myParams.myButtonsOrder[A.RIGHT][s][1];this._buildButton(t,A.RIGHT,s,a,l)}}let o=this._myParams.myThumbsticksOrder[A.LEFT].length;for(let s=0;s<o;s++){if(this._myParams.myThumbsticksOrder[A.LEFT][s]!=null){let a=this._myParams.myThumbsticksOrder[A.LEFT][s][0],l=this._myParams.myThumbsticksOrder[A.LEFT][s][1];this._buildThumbstick(e,A.LEFT,a,l)}if(this._myParams.myThumbsticksOrder[A.RIGHT][s]!=null){let a=this._myParams.myThumbsticksOrder[A.RIGHT][s][0],l=this._myParams.myThumbsticksOrder[A.RIGHT][s][1];this._buildThumbstick(t,A.RIGHT,a,l)}}}_setupDocumentBody(){r.getBody(this._myParams.myEngine).style.overflow="hidden",r.getBody(this._myParams.myEngine).style.userSelect="none",r.getBody(this._myParams.myEngine).style.webkitUserSelect="none",r.getBody(this._myParams.myEngine).style.webkitTapHighlightColor="transparent",r.getBody(this._myParams.myEngine).style.touchAction="none",this._myGestureStartEventListener=function(e){e.preventDefault()},r.getDocument(this._myParams.myEngine).addEventListener("gesturestart",this._myGestureStartEventListener)}_buildButton(e,t,n,o,s){let a=new oa(e,this._myParams,t,n,o,s);this._myVirtualGamepadVirtualButtons[o][s]=a}_buildThumbstick(e,t,n,o){let s=new sa(e,this._myParams,t,n,o);this._myVirtualGamepadVirtualThumbsticks[n][o]=s}_createSizeValue(e,t){return"min("+e.toFixed(3)+"vmax,"+(e*t).toFixed(3)+"vw)"}_isAnyElementPressed(){let e=!1;for(let t in this._myVirtualGamepadVirtualButtons)for(let n in this._myVirtualGamepadVirtualButtons[t]){let o=this._myVirtualGamepadVirtualButtons[t][n];if(o!=null&&o.isPressed()){e=!0;break}}if(!e)for(let t in this._myVirtualGamepadVirtualThumbsticks)for(let n in this._myVirtualGamepadVirtualThumbsticks[t]){let o=this._myVirtualGamepadVirtualThumbsticks[t][n];if(o!=null&&o.isPressed()){e=!0;break}}return e}_setMouseHoverEnabled(e){for(let t in this._myVirtualGamepadVirtualButtons)for(let n in this._myVirtualGamepadVirtualButtons[t]){let o=this._myVirtualGamepadVirtualButtons[t][n];o?.setMouseHoverEnabled(e)}for(let t in this._myVirtualGamepadVirtualThumbsticks)for(let n in this._myVirtualGamepadVirtualThumbsticks[t]){let o=this._myVirtualGamepadVirtualThumbsticks[t][n];o?.setMouseHoverEnabled(e)}}destroy(){this._myDestroyed=!0,r.getDocument(this._myParams.myEngine).removeEventListener("gesturestart",this._myGestureStartEventListener);for(let e in this._myVirtualGamepadVirtualButtons)for(let t in this._myVirtualGamepadVirtualButtons[e]){let n=this._myVirtualGamepadVirtualButtons[e][t];n?.destroy()}for(let e in this._myVirtualGamepadVirtualThumbsticks)for(let t in this._myVirtualGamepadVirtualThumbsticks[e]){let n=this._myVirtualGamepadVirtualThumbsticks[e][t];n?.destroy()}this._myVirtualGamepadContainer.remove()}isDestroyed(){return this._myDestroyed}};import{Component as HR,Property as J}from"@wonderlandengine/api";var Tn=class extends HR{start(){let e=new ro(this.engine);e.defaultConfig();for(let t in e.myButtonParams)for(let n in e.myButtonParams[t]){let o=e.myButtonParams[t][n];o.myIconParams.myBackgroundColor=this._myBackgroundColor,o.myIconParams.myBackgroundPressedColor=this._myIconColor,o.myIconParams.myIconColor=this._myIconColor,o.myIconParams.myIconPressedColor=this._myBackgroundColor}for(let t in e.myThumbstickParams)for(let n in e.myThumbstickParams[t]){let o=e.myThumbstickParams[t][n];o.myBackgroundColor=this._myBackgroundColor,o.myIconParams.myBackgroundColor=this._myIconColor,o.myIconParams.myBackgroundPressedColor=this._myIconColor,o.myIconParams.myIconColor=this._myBackgroundColor,o.myIconParams.myIconPressedColor=this._myBackgroundColor}e.myOpacity=this._myOpacity,e.myInterfaceScale=this._myInterfaceScale,e.myMarginScale=this._myMarginScale,e.myShowOnDesktop=this._myShowOnDesktop,e.myShowOnMobile=this._myShowOnMobile,e.myShowOnHeadset=this._myShowOnHeadset,e.myShowOnDesktop||e.myShowOnMobile||e.myShowOnHeadset?e.myAutoUpdateVisibility=!0:e.myAutoUpdateVisibility=!1,this._advancedConfig(e),this._myVirtualGamepad=new aa(e),this._myVirtualGamepad.setVisible(!1),this._myVirtualGamepad.start(),this._myFirstUpdate=!0,this._myLeftVirtualGamepadGamepadCore=null,this._myRightVirtualGamepadGamepadCore=null}update(e){this._myFirstUpdate&&(this._myFirstUpdate=!1,this._myAddToUniversalGamepad&&(this._myLeftVirtualGamepadGamepadCore=new Jo(this._myVirtualGamepad,r.getLeftGamepad(this.engine).getGamepadCore("pp_left_xr_gamepad").getHandPose()),this._myRightVirtualGamepadGamepadCore=new Jo(this._myVirtualGamepad,r.getRightGamepad(this.engine).getGamepadCore("pp_right_xr_gamepad").getHandPose()),r.getLeftGamepad(this.engine).addGamepadCore("pp_left_virtual_gamepad",this._myLeftVirtualGamepadGamepadCore),r.getRightGamepad(this.engine).addGamepadCore("pp_right_virtual_gamepad",this._myRightVirtualGamepadGamepadCore))),this._myVirtualGamepad.update(e)}_advancedConfig(e){e.myButtonsOrder[A.LEFT]=[null,null,null,null,null],e.myButtonsOrder[A.RIGHT]=[null,null,null,null,null];{let t=e.myButtonParams[A.LEFT][E.SELECT];t.myIconParams.myIconType=this._myLeftSelectButtonIconType,t.myIconParams.myLabel=this._myLeftSelectIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myLeftSelectIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftSelectButtonVisible&&(e.myButtonsOrder[A.LEFT][this._myLeftSelectButtonOrderIndex]=[A.LEFT,E.SELECT])}{let t=e.myButtonParams[A.LEFT][E.SQUEEZE];t.myIconParams.myIconType=this._myLeftSqueezeButtonIconType,t.myIconParams.myLabel=this._myLeftSqueezeIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myLeftSqueezeIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftSqueezeButtonVisible&&(e.myButtonsOrder[A.LEFT][this._myLeftSqueezeButtonOrderIndex]=[A.LEFT,E.SQUEEZE])}{let t=e.myButtonParams[A.LEFT][E.THUMBSTICK];t.myIconParams.myIconType=this._myLeftThumbstickButtonIconType,t.myIconParams.myLabel=this._myLeftThumbstickButtonIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myLeftThumbstickButtonIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftThumbstickButtonVisible&&(e.myButtonsOrder[A.LEFT][this._myLeftThumbstickButtonOrderIndex]=[A.LEFT,E.THUMBSTICK])}{let t=e.myButtonParams[A.LEFT][E.TOP_BUTTON];t.myIconParams.myIconType=this._myLeftTopButtonIconType,t.myIconParams.myLabel=this._myLeftTopButtonIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myLeftTopButtonIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftTopButtonVisible&&(e.myButtonsOrder[A.LEFT][this._myLeftTopButtonOrderIndex]=[A.LEFT,E.TOP_BUTTON])}{let t=e.myButtonParams[A.LEFT][E.BOTTOM_BUTTON];t.myIconParams.myIconType=this._myLeftBottomButtonIconType,t.myIconParams.myLabel=this._myLeftBottomButtonIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myLeftBottomButtonIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftBottomButtonVisible&&(e.myButtonsOrder[A.LEFT][this._myLeftBottomButtonOrderIndex]=[A.LEFT,E.BOTTOM_BUTTON])}{let t=e.myButtonParams[A.RIGHT][E.SELECT];t.myIconParams.myIconType=this._myRightSelectButtonIconType,t.myIconParams.myLabel=this._myRightSelectIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myRightSelectIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightSelectButtonVisible&&(e.myButtonsOrder[A.RIGHT][this._myRightSelectButtonOrderIndex]=[A.RIGHT,E.SELECT])}{let t=e.myButtonParams[A.RIGHT][E.SQUEEZE];t.myIconParams.myIconType=this._myRightSqueezeButtonIconType,t.myIconParams.myLabel=this._myRightSqueezeIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myRightSqueezeIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightSqueezeButtonVisible&&(e.myButtonsOrder[A.RIGHT][this._myRightSqueezeButtonOrderIndex]=[A.RIGHT,E.SQUEEZE])}{let t=e.myButtonParams[A.RIGHT][E.THUMBSTICK];t.myIconParams.myIconType=this._myRightThumbstickButtonIconType,t.myIconParams.myLabel=this._myRightThumbstickButtonIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myRightThumbstickButtonIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightThumbstickButtonVisible&&(e.myButtonsOrder[A.RIGHT][this._myRightThumbstickButtonOrderIndex]=[A.RIGHT,E.THUMBSTICK])}{let t=e.myButtonParams[A.RIGHT][E.TOP_BUTTON];t.myIconParams.myIconType=this._myRightTopButtonIconType,t.myIconParams.myLabel=this._myRightTopButtonIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myRightTopButtonIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightTopButtonVisible&&(e.myButtonsOrder[A.RIGHT][this._myRightTopButtonOrderIndex]=[A.RIGHT,E.TOP_BUTTON])}{let t=e.myButtonParams[A.RIGHT][E.BOTTOM_BUTTON];t.myIconParams.myIconType=this._myRightBottomButtonIconType,t.myIconParams.myLabel=this._myRightBottomButtonIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myRightBottomButtonIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightBottomButtonVisible&&(e.myButtonsOrder[A.RIGHT][this._myRightBottomButtonOrderIndex]=[A.RIGHT,E.BOTTOM_BUTTON])}}onDestroy(){r.getLeftGamepad(this.engine)?.removeGamepadCore("pp_left_virtual_gamepad"),r.getRightGamepad(this.engine)?.removeGamepadCore("pp_right_virtual_gamepad"),this._myLeftVirtualGamepadGamepadCore.destroy(),this._myRightVirtualGamepadGamepadCore.destroy(),this._myVirtualGamepad.destroy()}};R(Tn,"TypeName","pp-virtual-gamepad"),R(Tn,"Properties",{_myShowOnDesktop:J.bool(!1),_myShowOnMobile:J.bool(!0),_myShowOnHeadset:J.bool(!1),_myAddToUniversalGamepad:J.bool(!0),_myOpacity:J.float(.5),_myIconColor:J.string("#e0e0e0"),_myBackgroundColor:J.string("#616161"),_myInterfaceScale:J.float(1),_myMarginScale:J.float(1),ADVANCED_PARAMS_BELOW:J.string(""),_myLabelFontSize:J.float(2),_myLabelFontFamily:J.string("sans-serif"),_myLabelFontWeight:J.string("bold"),_myImagePressedBrightness:J.float(.5),_myLeftSelectButtonVisible:J.bool(!0),_myLeftSelectButtonOrderIndex:J.int(1),_myLeftSelectButtonIconType:J.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Frame"),_myLeftSelectButtonIconLabelOrImageUrl:J.string(""),_myLeftSqueezeButtonVisible:J.bool(!0),_myLeftSqueezeButtonOrderIndex:J.int(0),_myLeftSqueezeButtonIconType:J.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Square"),_myLeftSqueezeButtonIconLabelOrImageUrl:J.string(""),_myLeftThumbstickButtonVisible:J.bool(!0),_myLeftThumbstickButtonOrderIndex:J.int(4),_myLeftThumbstickButtonIconType:J.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Dot"),_myLeftThumbstickButtonIconLabelOrImageUrl:J.string(""),_myLeftTopButtonVisible:J.bool(!0),_myLeftTopButtonOrderIndex:J.int(2),_myLeftTopButtonIconType:J.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Circle"),_myLeftTopButtonIconLabelOrImageUrl:J.string(""),_myLeftBottomButtonVisible:J.bool(!0),_myLeftBottomButtonOrderIndex:J.int(3),_myLeftBottomButtonIconType:J.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Ring"),_myLeftBottomButtonIconLabelOrImageUrl:J.string(""),_myRightSelectButtonVisible:J.bool(!0),_myRightSelectButtonOrderIndex:J.int(1),_myRightSelectButtonIconType:J.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Frame"),_myRightSelectButtonIconLabelOrImageUrl:J.string(""),_myRightSqueezeButtonVisible:J.bool(!0),_myRightSqueezeButtonOrderIndex:J.int(0),_myRightSqueezeButtonIconType:J.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Square"),_myRightSqueezeButtonIconLabelOrImageUrl:J.string(""),_myRightThumbstickButtonVisible:J.bool(!0),_myRightThumbstickButtonOrderIndex:J.int(4),_myRightThumbstickButtonIconType:J.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Dot"),_myRightThumbstickButtonIconLabelOrImageUrl:J.string(""),_myRightTopButtonVisible:J.bool(!0),_myRightTopButtonOrderIndex:J.int(2),_myRightTopButtonIconType:J.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Circle"),_myRightTopButtonIconLabelOrImageUrl:J.string(""),_myRightBottomButtonVisible:J.bool(!0),_myRightBottomButtonOrderIndex:J.int(3),_myRightBottomButtonIconType:J.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Ring"),_myRightBottomButtonIconLabelOrImageUrl:J.string("")});import{Component as kR,Property as lb}from"@wonderlandengine/api";var Pn=class extends kR{start(){let e=this.object.pp_getPositionLocal();this.object.pp_setPositionLocal(c(e[0],this._myEyesHeight,e[2])),this._myHeightSetOnce=!1,I.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this.engine)}_onXRSessionStart(){if(this.active&&(!this._mySetOnlyOnStart||!this._myHeightSetOnce)){let e=this.object.pp_getPositionLocal();I.isReferenceSpaceFloorBased(this.engine)?this.object.pp_setPositionLocal(c(e[0],0,e[2])):I.isDeviceEmulated(this.engine)?this.object.pp_setPositionLocal(c(e[0],0,e[2])):this.object.pp_setPositionLocal(c(e[0],this._myEyesHeight,e[2])),this._myHeightSetOnce=!0}}_onXRSessionEnd(){if(this.active&&!this._mySetOnlyOnStart){let e=this.object.pp_getPositionLocal();this.object.pp_setPositionLocal(c(e[0],this._myEyesHeight,e[2]))}}};R(Pn,"TypeName","pp-set-player-height"),R(Pn,"Properties",{_myEyesHeight:lb.float(1.65),_mySetOnlyOnStart:lb.bool(!1)});import{Component as FR,Property as wR}from"@wonderlandengine/api";var ki=class extends FR{start(){this._myHandednessType=ie.getHandednessByIndex(this._myHandedness),r.getHandPose(this._myHandednessType,this.engine).registerPoseUpdatedEventListener(this,this.onPoseUpdated.bind(this))}onPoseUpdated(){}onDestroy(){r.getHandPose(this._myHandednessType,this.engine)?.unregisterPoseUpdatedEventListener(this)}};R(ki,"TypeName","pp-set-hand-local-transform"),R(ki,"Properties",{_myHandedness:wR.enum(["Left","Right"],"Left")});ki.prototype.onPoseUpdated=function(){let i=N();return function(t){this.active&&I.isSessionActive(this.engine)&&t.isValid()&&this.object.pp_setTransformLocalQuat(t.getTransformQuat(i,null))}}();import{Component as jR}from"@wonderlandengine/api";var Pi=class extends jR{start(){r.getHeadPose(this.engine).registerPoseUpdatedEventListener(this,this.onPoseUpdated.bind(this))}update(e){}onPoseUpdated(){}onDestroy(){r.getHeadPose(this.engine)?.unregisterPoseUpdatedEventListener(this)}};R(Pi,"TypeName","pp-set-head-local-transform"),R(Pi,"Properties",{});Pi.prototype.update=function(){let i=j(),e=c(),t=c();return function(o){if(!I.isSessionActive(this.engine)){let s=r.getPlayerObjects(this.engine).myCameraNonXR;i=s.pp_getRotationLocalQuat(i),r.isPoseForwardFixed(this.engine)&&i.quat_rotateAxisRadians(Math.PI,i.quat_getUp(e),i),this.object.pp_setPositionLocal(s.pp_getPositionLocal(t)),this.object.pp_setRotationLocalQuat(i)}}}();Pi.prototype.onPoseUpdated=function(){let i=N();return function(t){this.active&&I.isSessionActive(this.engine)&&t.isValid()&&this.object.pp_setTransformLocalQuat(t.getTransformQuat(i,null))}}();import{Component as zR,Property as am}from"@wonderlandengine/api";var Fi=class extends zR{start(){this._myHandednessType=ie.getHandednessByIndex(this._myHandedness),this._myJointIDType=ie.getJointIDByIndex(this._myJointID),r.getTrackedHandPose(this._myHandednessType,this.engine).getJointPose(this._myJointIDType).registerPoseUpdatedEventListener(this,this.onPoseUpdated.bind(this))}onPoseUpdated(){}onDestroy(){r.getTrackedHandPose(this._myHandednessType,this.engine)?.getJointPose(this._myJointIDType)?.unregisterPoseUpdatedEventListener(this)}};R(Fi,"TypeName","pp-set-tracked-hand-joint-local-transform"),R(Fi,"Properties",{_myHandedness:am.enum(["Left","Right"],"Left"),_mySetLocalScaleAsJointRadius:am.bool(!1),_myJointID:am.enum(["Wrist","Thumb Metacarpal","Thumb Phalanx Proximal","Thumb Phalanx Distal","Thumb Tip","Index Metacarpal","Index Phalanx Proximal","Index Phalanx Intermediate","Index Phalanx Distal","Index Tip","Middle Metacarpal","Middle Phalanx Proximal","Middle Phalanx Intermediate","Middle Phalanx Distal","Middle Tip","Ring Metacarpal","Ring Phalanx Proximal","Ring Phalanx Intermediate","Ring Phalanx Distal","Ring Tip","Pinky Metacarpal","Pinky Phalanx Proximal","Pinky Phalanx Intermediate","Pinky Phalanx Distal","Pinky Tip"],"Wrist")});Fi.prototype.onPoseUpdated=function(){let i=N();return function(t){this.active&&I.isSessionActive(this.engine)&&t.isValid()&&(this.object.pp_setTransformLocalQuat(t.getTransformQuat(i,null)),this._mySetLocalScaleAsJointRadius&&this.object.pp_setScaleLocal(t.getJointRadius()))}}();import{Component as NR,Property as GR}from"@wonderlandengine/api";var Cn=class extends NR{init(){this._myHandednessType=ie.getHandednessByIndex(this._myHandedness)}update(e){let t=r.getPlayerObjects(this.engine).myHands[this._myHandednessType];this.object.pp_setTransformQuat(t.pp_getTransformQuat()),this.object.pp_setScale(t.pp_getScale())}};R(Cn,"TypeName","pp-copy-hand-transform"),R(Cn,"Properties",{_myHandedness:GR.enum(["Left","Right"],"Left")});import{Component as WR}from"@wonderlandengine/api";var bn=class extends WR{update(e){let t=r.getPlayerObjects(this.engine).myHead;this.object.pp_setTransformQuat(t.pp_getTransformQuat()),this.object.pp_setScale(t.pp_getScale())}};R(bn,"TypeName","pp-copy-head-transform"),R(bn,"Properties",{});import{Component as UR}from"@wonderlandengine/api";var Sn=class extends UR{update(e){let t=r.getPlayerObjects(this.engine).myPlayer;this.object.pp_setTransformQuat(t.pp_getTransformQuat()),this.object.pp_setScale(t.pp_getScale())}};R(Sn,"TypeName","pp-copy-player-transform"),R(Sn,"Properties",{});import{Component as QR}from"@wonderlandengine/api";var vn=class extends QR{update(e){let t=r.getPlayerObjects(this.engine).myReferenceSpace;this.object.pp_setTransformQuat(t.pp_getTransformQuat()),this.object.pp_setScale(t.pp_getScale())}};R(vn,"TypeName","pp-copy-reference-space-transform"),R(vn,"Properties",{});var U={NONE:null,LEFT:"left",RIGHT:"right"},Re={NONE:null,GAMEPAD:0,TRACKED_HAND:1};import{Component as qR,MeshComponent as mb,Property as ra,ViewComponent as XR}from"@wonderlandengine/api";import{Cursor as yb,CursorTarget as KR}from"@wonderlandengine/components";var wi=class extends qR{init(){this._myHandednessType=ie.getHandednessByIndex(this._myHandedness),this._myCursorPositionDefaultOffset=c(0,-.035,.05),this._myCursorRotationDefaultOffset=c(30,0,0),this._myCursorMeshScale=c(.0025,.0025,.0025),this._myCursorColor=F(255/255,255/255,255/255,1),this._myCursorTargetCollisionGroup=7,this._myStarted=!1}start(){if(r.isToolEnabled(this.engine)){this._myToolCursorObject=this.object.pp_addObject(),this._myCursorObjectXR=this._myToolCursorObject.pp_addObject(),this._myApplyDefaultCursorOffset&&(this._myCursorObjectXR.pp_setPositionLocal(this._myCursorPositionDefaultOffset),this._myCursorObjectXR.pp_rotateObject(this._myCursorRotationDefaultOffset));{this._myCursorMeshobject=this._myCursorObjectXR.pp_addObject(),this._myCursorMeshobject.pp_setScale(this._myCursorMeshScale);let n=this._myCursorMeshobject.pp_addComponent(mb);n.mesh=r.getDefaultMeshes(this.engine).mySphere,n.material=r.getDefaultMaterials(this.engine).myFlatOpaque.clone(),n.material.color=this._myCursorColor,this._myCursorComponentXR=this._myCursorObjectXR.pp_addComponent(yb,{collisionGroup:this._myCursorTargetCollisionGroup,handedness:this._myHandedness+1,cursorObject:this._myCursorMeshobject,styleCursor:!1}),this._myCursorComponentXR.rayCastMode=0,this._myPulseOnHover&&this._myCursorComponentXR.globalTarget.onHover.add(this._pulseOnHover.bind(this),{id:this})}this._myCursorObjectNonXR=this._myToolCursorObject.pp_addObject(),this._myCursorComponentNonXR=this._myCursorObjectNonXR.pp_addComponent(yb,{collisionGroup:this._myCursorTargetCollisionGroup,handedness:this._myHandedness+1,styleCursor:this._myUpdatePointerCursorStyle}),this._myCursorComponentNonXR.rayCastMode=0,this._myPulseOnHover&&this._myCursorComponentNonXR.globalTarget.onHover.add(this._pulseOnHover.bind(this),{id:this}),this._myCursorComponentNonXR.pp_setViewComponent(r.getPlayerObjects(this.engine).myCameraNonXR.pp_getComponent(XR));let e=null,t=.0125;if(this._myShowFingerCursor){e=this._myToolCursorObject.pp_addObject();let n=e.pp_addComponent(mb);n.mesh=r.getDefaultMeshes(this.engine).mySphere,n.material=r.getDefaultMaterials(this.engine).myFlatOpaque.clone(),n.material.color=this._myCursorColor,e.pp_setScale(t)}this._myFingerCursorObject=this._myToolCursorObject.pp_addObject(),this._myFingerCursorComponent=this._myFingerCursorObject.pp_addComponent(Ti,{_myHandedness:this._myHandedness,_myMultipleClicksEnabled:!0,_myCollisionGroup:this._myCursorTargetCollisionGroup,_myCollisionSize:t,_myCursorObject:e}),this._myCursorComponentXR.active=!1,this._myCursorComponentNonXR.active=!1,this._myFingerCursorComponent.active=!1,this._myStarted=!0}}update(e){}_isUsingHand(){let e=!1;if(I.getSession(this.engine)&&I.getSession(this.engine).inputSources)for(let t=0;t<I.getSession(this.engine).inputSources.length;t++){let n=I.getSession(this.engine).inputSources[t];if(n.hand&&n.handedness==this._myHandednessType){e=!0;break}}return e}_pulseOnHover(e){let t=e.pp_getComponent(KR);t&&!t.isSurface&&(this._myHandedness==0?r.getLeftGamepad(this.engine)!=null&&r.getLeftGamepad(this.engine).pulse(.4,0):r.getRightGamepad(this.engine)!=null&&r.getRightGamepad(this.engine).pulse(.4,0))}onDestroy(){this._myStarted&&(this._myCursorComponentXR.globalTarget.onHover.remove(this),this._myCursorComponentNonXR.globalTarget.onHover.remove(this))}};R(wi,"TypeName","pp-tool-cursor"),R(wi,"Properties",{_myHandedness:ra.enum(["Left","Right"],"Left"),_myApplyDefaultCursorOffset:ra.bool(!0),_myPulseOnHover:ra.bool(!1),_myShowFingerCursor:ra.bool(!1),_myUpdatePointerCursorStyle:ra.bool(!0)});wi.prototype.update=function(){let i=N();return function(t){if(r.isToolEnabled(this.engine)&&this._myStarted){let n=this._isUsingHand();this._myFingerCursorComponent.active=n,n?(this._myCursorComponentXR.active=!1,this._myCursorComponentNonXR.active=!1):I.isSessionActive(this.engine)?(this._myCursorComponentXR.active=!n,this._myCursorComponentNonXR.active=!1):(this._myCursorComponentNonXR.active=!n,this._myCursorComponentXR.active=!1,this._myCursorObjectNonXR.pp_setTransformQuat(r.getPlayerObjects(this.engine).myCameraNonXR.pp_getTransformQuat(i)))}}}();import{Alignment as ub,Collider as JR,Justification as hb}from"@wonderlandengine/api";var le={DEBUG:0,WARN:1,ERROR:2,LOG:3,INFO:4,ASSERT:5},Be={BROWSER_CONSOLE:0,CONSOLE_VR:1,WINDOW:2},la={NEVER:0,ALWAYS:1,WHEN_HIDDEN:2},k={DEBUG:0,WARN:1,ERROR:2,LOG:3};var ma=class{constructor(){this._setupBuildConfig(),this._setupRuntimeConfig()}_setupBuildConfig(){this.myBackgroundColor=F(46/255,46/255,46/255,1),this.myCursorTargetCollisionCollider=JR.Box,this.myCursorTargetCollisionGroup=7,this.myCursorTargetCollisionThickness=.001,this.myDefaultTextColor=F(255/255,255/255,255/255,1),this.myTextAlignment=ub.Center,this.myTextJustification=hb.Middle,this.myTextColor=this.myDefaultTextColor,this.myMessageTypeColors=[],this.myMessageTypeColors[k.LOG]=this.myDefaultTextColor,this.myMessageTypeColors[k.ERROR]=F(255/255,40/255,40/255,1),this.myMessageTypeColors[k.WARN]=F(250/255,220/255,40/255,1),this.myMessageTypeColors[k.DEBUG]=F(60/255,200/255,255/255,1),this.myMessagesPanelPosition=c(0,.075,0),this.myMessagesBackgroundScale=c(.34,.15,1);{let e=.03,t=e*this.myMessagesBackgroundScale[0]/this.myMessagesBackgroundScale[1]*.8,n=-this.myMessagesBackgroundScale[0]+this.myMessagesBackgroundScale[0]*e,o=this.myMessagesBackgroundScale[1]-this.myMessagesBackgroundScale[1]*t;this.myMessagesTextsPanelPosition=c(n,o,.007)}this.myMessagesTextsPanelScale=c(.1,.1,.1),this.myMessagesTextStartString=`.
`,this.myMessagesTextAlignment=ub.Left,this.myMessagesTextJustification=hb.Top,this.myMessagesTextPositions=[],this.myMessagesTextPositions[k.LOG]=c(0,0,2e-4),this.myMessagesTextPositions[k.ERROR]=c(0,0,0),this.myMessagesTextPositions[k.WARN]=c(0,0,0),this.myMessagesTextPositions[k.DEBUG]=c(0,0,0),this.myMessagesTextColors=[],this.myMessagesTextColors[k.LOG]=this.myMessageTypeColors[k.LOG],this.myMessagesTextColors[k.ERROR]=this.myMessageTypeColors[k.ERROR],this.myMessagesTextColors[k.WARN]=this.myMessageTypeColors[k.WARN],this.myMessagesTextColors[k.DEBUG]=this.myMessageTypeColors[k.DEBUG],this.myButtonsPanelPosition=c(0,-.11,.015),this.myButtonBackgroundScale=c(.04,.02,1),this.myButtonTextPosition=c(0,0,.007),this.myButtonTextScale=c(.18,.18,.18),this.myButtonCursorTargetPosition=c(0,0,0),this.myButtonCursorTargetPosition[2]=this.myButtonTextPosition[2],this.myButtonsCollisionCollider=this.myCursorTargetCollisionCollider,this.myButtonsCollisionGroup=this.myCursorTargetCollisionGroup,this.myButtonsCollisionExtents=this.myButtonBackgroundScale.pp_clone(),this.myButtonsCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myClearButtonTextLabel="clear",this.myUpButtonTextLabel="up",this.myDownButtonTextLabel="down",this.myFilterButtonsTextColors=[],this.myFilterButtonsTextColors[k.LOG]=this.myMessageTypeColors[k.LOG],this.myFilterButtonsTextColors[k.ERROR]=this.myMessageTypeColors[k.ERROR],this.myFilterButtonsTextColors[k.WARN]=this.myMessageTypeColors[k.WARN],this.myFilterButtonsTextColors[k.DEBUG]=this.myMessageTypeColors[k.DEBUG],this.myFilterButtonsTextLabel=[],this.myFilterButtonsTextLabel[k.LOG]="log",this.myFilterButtonsTextLabel[k.ERROR]="error",this.myFilterButtonsTextLabel[k.WARN]="warn",this.myFilterButtonsTextLabel[k.DEBUG]="debug";{let e=7,t=Math.max(.68,this.myButtonBackgroundScale[0]*e),n=2+3+4+4+1+2,o=Math.max((t-e*this.myButtonBackgroundScale[0]*2)/n,0),s=this.myButtonBackgroundScale[0],a=-t/2;this.myFilterButtonsPositions=[],this.myFilterButtonsPositions[k.LOG]=[a+o*2+s,0,0],this.myFilterButtonsPositions[k.ERROR]=[this.myFilterButtonsPositions[k.LOG][0]+s+o+s,0,0],this.myFilterButtonsPositions[k.WARN]=[this.myFilterButtonsPositions[k.ERROR][0]+s+o+s,0,0],this.myFilterButtonsPositions[k.DEBUG]=[this.myFilterButtonsPositions[k.WARN][0]+s+o+s,0,0],this.myClearButtonPosition=[this.myFilterButtonsPositions[k.DEBUG][0]+s+o*4+s,0,0],this.myUpButtonPosition=[this.myClearButtonPosition[0]+s+o*4+s,0,0],this.myDownButtonPosition=[this.myUpButtonPosition[0]+s+o+s,0,0]}this.myNotifyIconBackgroundScale=c(.01,.01,1),this.myNotifyIconPanelPositions=[],this.myNotifyIconPanelPositions[U.NONE]=c(0,0,0),this.myNotifyIconPanelPositions[U.NONE][0]=-this.myMessagesBackgroundScale[0]+this.myNotifyIconBackgroundScale[0]+.01,this.myNotifyIconPanelPositions[U.NONE][1]=-this.myMessagesBackgroundScale[1]+this.myNotifyIconBackgroundScale[1]+.01,this.myNotifyIconPanelPositions[U.NONE][2]=this.myMessagesTextsPanelPosition[2]-1e-5,this.myNotifyIconPanelPositions[U.LEFT]=this.myNotifyIconPanelPositions[U.NONE],this.myNotifyIconPanelPositions[U.RIGHT]=this.myNotifyIconPanelPositions[U.NONE],this.myNotifyIconCursorTargetPosition=c(0,0,0),this.myNotifyIconCursorTargetPosition[2]=this.myButtonsPanelPosition[2]+this.myButtonTextPosition[2]-this.myMessagesTextsPanelPosition[2],this.myNotifyIconCollisionExtents=this.myNotifyIconBackgroundScale.pp_clone(),this.myNotifyIconCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myNotifyIconColor=F(210/255,210/255,210/255,1),this.myPointerCollisionCollider=this.myCursorTargetCollisionCollider,this.myPointerCollisionGroup=this.myCursorTargetCollisionGroup;{let e=Math.abs(this.myMessagesPanelPosition[1]-this.myMessagesBackgroundScale[1]-(this.myButtonsPanelPosition[1]+this.myButtonBackgroundScale[1])),t=this.myMessagesBackgroundScale[1]+this.myButtonBackgroundScale[1]+e/2;this.myPointerCollisionExtents=c(this.myMessagesBackgroundScale[0],t,this.myCursorTargetCollisionThickness)}this.myPointerCursorTargetPosition=c(0,0,0),this.myPointerCursorTargetPosition[1]=this.myMessagesPanelPosition[1]+this.myMessagesBackgroundScale[1]-this.myPointerCollisionExtents[1],this.myPointerCursorTargetPosition[2]=this.myButtonsPanelPosition[2]+this.myButtonTextPosition[2]-1e-4}_setupRuntimeConfig(){this.myTabString="     ",this.myAssertStartString="Assertion failed:",this.myMaxCharactersPerLine=100,this.myMaxLineSplits=500,this.myMaxLines=22,this.myMaxMessages=2e3,this.myMaxMessagesDeletePad=2e3,this.myLinesBetweenMessages=1,this.myButtonHoverColor=F(150/255,150/255,150/255,1),this.myButtonDisabledTextColor=this.myBackgroundColor,this.myButtonDisabledBackgroundColor=F(110/255,110/255,110/255,1),this.myFilterButtonDisabledTextColor=this.myButtonDisabledTextColor,this.myFilterButtonDisabledBackgroundColor=this.myButtonDisabledBackgroundColor,this.myScrollDelay=.1,this.myScrollAmount=1,this.myScrollThumbstickHandedness=U.RIGHT,this.myScrollThumbstickDelay=.1,this.myScrollThumbstickMinThreshold=.2,this.myScrollThumbstickAmount=3,this.myPulseDelay=5,this.myPulseIntensity=.3,this.myPulseDuration=.085,this.myClearBrowserConsoleWhenClearPressed=!0,this.myGamepadScrollOnlyOnHover=!0}};import{CollisionComponent as Yo,MeshComponent as $o,TextComponent as ya}from"@wonderlandengine/api";import{CursorTarget as es}from"@wonderlandengine/components";var ua=class{constructor(e=r.getMainEngine()){this._myEngine=e,this._myDestroyed=!1}build(e,t,n){this._myParentObject=e,this._myConfig=t,this._myParams=n,this._myPlaneMesh=r.getDefaultMeshes(this._myEngine).myDoubleSidedPlane,this._createSkeleton(),this._setTransforms(),this._addComponents(),this._setTransformForNonXR(),I.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this._myEngine)}setVisible(e){this.myPivotObject.pp_setActive(e)}_createSkeleton(){this.myPivotObject=this._myParentObject.pp_addObject(),this._createMessagesSkeleton(),this._createButtonsSkeleton(),this._createPointerSkeleton()}_createMessagesSkeleton(){this.myMessagesPanel=this.myPivotObject.pp_addObject(),this.myMessagesBackground=this.myMessagesPanel.pp_addObject(),this.myMessagesTextsPanel=this.myMessagesPanel.pp_addObject(),this.myMessagesTexts=[];for(let e in k)this.myMessagesTexts[k[e]]=this.myMessagesTextsPanel.pp_addObject();this.myNotifyIconPanel=this.myMessagesPanel.pp_addObject(),this.myNotifyIconBackground=this.myNotifyIconPanel.pp_addObject(),this.myNotifyIconCursorTarget=this.myNotifyIconPanel.pp_addObject()}_createButtonsSkeleton(){this.myButtonsPanel=this.myPivotObject.pp_addObject(),this.myFilterButtonsPanels=[],this.myFilterButtonsBackgrounds=[],this.myFilterButtonsTexts=[],this.myFilterButtonsCursorTargets=[];for(let e in k)this.myFilterButtonsPanels[k[e]]=this.myButtonsPanel.pp_addObject(),this.myFilterButtonsBackgrounds[k[e]]=this.myFilterButtonsPanels[k[e]].pp_addObject(),this.myFilterButtonsTexts[k[e]]=this.myFilterButtonsPanels[k[e]].pp_addObject(),this.myFilterButtonsCursorTargets[k[e]]=this.myFilterButtonsPanels[k[e]].pp_addObject();this.myClearButtonPanel=this.myButtonsPanel.pp_addObject(),this.myClearButtonBackground=this.myClearButtonPanel.pp_addObject(),this.myClearButtonText=this.myClearButtonPanel.pp_addObject(),this.myClearButtonCursorTarget=this.myClearButtonPanel.pp_addObject(),this.myUpButtonPanel=this.myButtonsPanel.pp_addObject(),this.myUpButtonBackground=this.myUpButtonPanel.pp_addObject(),this.myUpButtonText=this.myUpButtonPanel.pp_addObject(),this.myUpButtonCursorTarget=this.myUpButtonPanel.pp_addObject(),this.myDownButtonPanel=this.myButtonsPanel.pp_addObject(),this.myDownButtonBackground=this.myDownButtonPanel.pp_addObject(),this.myDownButtonText=this.myDownButtonPanel.pp_addObject(),this.myDownButtonCursorTarget=this.myDownButtonPanel.pp_addObject()}_createPointerSkeleton(){this.myPointerCursorTarget=this.myPivotObject.pp_addObject()}_setTransforms(){this.myPivotObject.pp_markDirty(),this._setMessagesTransforms(),this._setButtonsTransforms(),this._setPointerTransform()}_setMessagesTransforms(){this.myMessagesPanel.pp_setPositionLocal(this._myConfig.myMessagesPanelPosition),this.myMessagesBackground.pp_scaleObject(this._myConfig.myMessagesBackgroundScale),this.myMessagesTextsPanel.pp_setPositionLocal(this._myConfig.myMessagesTextsPanelPosition),this.myMessagesTextsPanel.pp_scaleObject(this._myConfig.myMessagesTextsPanelScale);for(let e in k)this.myMessagesTexts[k[e]].pp_setPositionLocal(this._myConfig.myMessagesTextPositions[k[e]]);this.myNotifyIconPanel.pp_setPositionLocal(this._myConfig.myNotifyIconPanelPositions[this._myParams.myHandedness]),this.myNotifyIconBackground.pp_scaleObject(this._myConfig.myNotifyIconBackgroundScale),this.myNotifyIconCursorTarget.pp_setPositionLocal(this._myConfig.myNotifyIconCursorTargetPosition)}_setButtonsTransforms(){this.myButtonsPanel.pp_setPositionLocal(this._myConfig.myButtonsPanelPosition);for(let e in k)this.myFilterButtonsPanels[k[e]].pp_setPositionLocal(this._myConfig.myFilterButtonsPositions[k[e]]),this.myFilterButtonsBackgrounds[k[e]].pp_scaleObject(this._myConfig.myButtonBackgroundScale),this.myFilterButtonsTexts[k[e]].pp_setPositionLocal(this._myConfig.myButtonTextPosition),this.myFilterButtonsTexts[k[e]].pp_scaleObject(this._myConfig.myButtonTextScale),this.myFilterButtonsCursorTargets[k[e]].pp_setPositionLocal(this._myConfig.myButtonCursorTargetPosition);this.myClearButtonPanel.pp_setPositionLocal(this._myConfig.myClearButtonPosition),this.myClearButtonBackground.pp_scaleObject(this._myConfig.myButtonBackgroundScale),this.myClearButtonText.pp_setPositionLocal(this._myConfig.myButtonTextPosition),this.myClearButtonText.pp_scaleObject(this._myConfig.myButtonTextScale),this.myClearButtonCursorTarget.pp_setPositionLocal(this._myConfig.myButtonCursorTargetPosition),this.myUpButtonPanel.pp_setPositionLocal(this._myConfig.myUpButtonPosition),this.myUpButtonBackground.pp_scaleObject(this._myConfig.myButtonBackgroundScale),this.myUpButtonText.pp_setPositionLocal(this._myConfig.myButtonTextPosition),this.myUpButtonText.pp_scaleObject(this._myConfig.myButtonTextScale),this.myUpButtonCursorTarget.pp_setPositionLocal(this._myConfig.myButtonCursorTargetPosition),this.myDownButtonPanel.pp_setPositionLocal(this._myConfig.myDownButtonPosition),this.myDownButtonBackground.pp_scaleObject(this._myConfig.myButtonBackgroundScale),this.myDownButtonText.pp_setPositionLocal(this._myConfig.myButtonTextPosition),this.myDownButtonText.pp_scaleObject(this._myConfig.myButtonTextScale),this.myDownButtonCursorTarget.pp_setPositionLocal(this._myConfig.myButtonCursorTargetPosition)}_setPointerTransform(){this.myPointerCursorTarget.pp_setPositionLocal(this._myConfig.myPointerCursorTargetPosition)}_addComponents(){this._addMessagesComponents(),this._addButtonsComponents(),this._addPointerComponents()}_addMessagesComponents(){let e=this.myMessagesBackground.pp_addComponent($o);e.mesh=this._myPlaneMesh,e.material=this._myParams.myPlaneMaterial.clone(),e.material.color=this._myConfig.myBackgroundColor,this.myMessagesTextComponents=[];for(let t in k){let n=this.myMessagesTexts[k[t]].pp_addComponent(ya);n.alignment=this._myConfig.myMessagesTextAlignment,n.justification=this._myConfig.myMessagesTextJustification,n.material=this._myParams.myTextMaterial.clone(),n.material.color=this._myConfig.myMessagesTextColors[k[t]],n.lineSpacing=1.2,n.text=this._myConfig.myMessagesTextStartString,this.myMessagesTextComponents[k[t]]=n}this.myNotifyIconBackgroundComponent=this.myNotifyIconBackground.pp_addComponent($o),this.myNotifyIconBackgroundComponent.mesh=this._myPlaneMesh,this.myNotifyIconBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myNotifyIconBackgroundComponent.material.color=this._myConfig.myNotifyIconColor,this.myNotifyIconCursorTargetComponent=this.myNotifyIconCursorTarget.pp_addComponent(es),this.myNotifyIconCollisionComponent=this.myNotifyIconCursorTarget.pp_addComponent(Yo),this.myNotifyIconCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myNotifyIconCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myNotifyIconCollisionComponent.extents=this._myConfig.myNotifyIconCollisionExtents}_addButtonsComponents(){this.myFilterButtonsBackgroundComponents=[],this.myFilterButtonsTextComponents=[],this.myFilterButtonsCursorTargetComponents=[],this.myFilterButtonsCollisionComponents=[];for(let e in k){let t=this.myFilterButtonsBackgrounds[k[e]].pp_addComponent($o);t.mesh=this._myPlaneMesh,t.material=this._myParams.myPlaneMaterial.clone(),t.material.color=this._myConfig.myBackgroundColor;let n=this.myFilterButtonsTexts[k[e]].pp_addComponent(ya);this._setupButtonTextComponent(n),n.material.color=this._myConfig.myFilterButtonsTextColors[k[e]],n.text=this._myConfig.myFilterButtonsTextLabel[k[e]];let o=this.myFilterButtonsCursorTargets[k[e]].pp_addComponent(es),s=this.myFilterButtonsCursorTargets[k[e]].pp_addComponent(Yo);s.collider=this._myConfig.myButtonsCollisionCollider,s.group=1<<this._myConfig.myButtonsCollisionGroup,s.extents=this._myConfig.myButtonsCollisionExtents,this.myFilterButtonsBackgroundComponents[k[e]]=t,this.myFilterButtonsTextComponents[k[e]]=n,this.myFilterButtonsCursorTargetComponents[k[e]]=o,this.myFilterButtonsCollisionComponents[k[e]]=s}{let e=this.myClearButtonBackground.pp_addComponent($o);e.mesh=this._myPlaneMesh,e.material=this._myParams.myPlaneMaterial.clone(),e.material.color=this._myConfig.myBackgroundColor;let t=this.myClearButtonText.pp_addComponent(ya);this._setupButtonTextComponent(t),t.text=this._myConfig.myClearButtonTextLabel;let n=this.myClearButtonCursorTarget.pp_addComponent(es),o=this.myClearButtonCursorTarget.pp_addComponent(Yo);o.collider=this._myConfig.myButtonsCollisionCollider,o.group=1<<this._myConfig.myButtonsCollisionGroup,o.extents=this._myConfig.myButtonsCollisionExtents,this.myClearButtonBackgroundComponent=e,this.myClearButtonTextComponent=t,this.myClearButtonCursorTargetComponent=n,this.myClearButtonCollisionComponent=o}{let e=this.myUpButtonBackground.pp_addComponent($o);e.mesh=this._myPlaneMesh,e.material=this._myParams.myPlaneMaterial.clone(),e.material.color=this._myConfig.myBackgroundColor;let t=this.myUpButtonText.pp_addComponent(ya);this._setupButtonTextComponent(t),t.text=this._myConfig.myUpButtonTextLabel;let n=this.myUpButtonCursorTarget.pp_addComponent(es),o=this.myUpButtonCursorTarget.pp_addComponent(Yo);o.collider=this._myConfig.myButtonsCollisionCollider,o.group=1<<this._myConfig.myButtonsCollisionGroup,o.extents=this._myConfig.myButtonsCollisionExtents,this.myUpButtonBackgroundComponent=e,this.myUpButtonTextComponent=t,this.myUpButtonCursorTargetComponent=n,this.myUpButtonCollisionComponent=o}{let e=this.myDownButtonBackground.pp_addComponent($o);e.mesh=this._myPlaneMesh,e.material=this._myParams.myPlaneMaterial.clone(),e.material.color=this._myConfig.myBackgroundColor;let t=this.myDownButtonText.pp_addComponent(ya);this._setupButtonTextComponent(t),t.text=this._myConfig.myDownButtonTextLabel;let n=this.myDownButtonCursorTarget.pp_addComponent(es),o=this.myDownButtonCursorTarget.pp_addComponent(Yo);o.collider=this._myConfig.myButtonsCollisionCollider,o.group=1<<this._myConfig.myButtonsCollisionGroup,o.extents=this._myConfig.myButtonsCollisionExtents,this.myDownButtonBackgroundComponent=e,this.myDownButtonTextComponent=t,this.myDownButtonCursorTargetComponent=n,this.myDownButtonCollisionComponent=o}}_addPointerComponents(){this.myPointerCursorTargetComponent=this.myPointerCursorTarget.pp_addComponent(es),this.myPointerCursorTargetComponent.isSurface=!0;let e=this.myPointerCursorTarget.pp_addComponent(Yo);e.collider=this._myConfig.myPointerCollisionCollider,e.group=1<<this._myConfig.myPointerCollisionGroup,e.extents=this._myConfig.myPointerCollisionExtents,this.myPointerCollisionComponent=e}_setupButtonTextComponent(e){e.alignment=this._myConfig.myTextAlignment,e.justification=this._myConfig.myTextJustification,e.material=this._myParams.myTextMaterial.clone(),e.material.color=this._myConfig.myTextColor,e.text=""}_onXRSessionStart(){this._setTransformForXR()}_onXRSessionEnd(){this._setTransformForNonXR()}_setTransformForXR(){this.myNotifyIconPanel.pp_setPositionLocal(this._myConfig.myNotifyIconPanelPositions[this._myParams.myHandedness])}_setTransformForNonXR(){this.myNotifyIconPanel.pp_setPositionLocal(this._myConfig.myNotifyIconPanelPositions[U.NONE])}destroy(){this._myDestroyed=!0,I.unregisterSessionStartEndEventListeners(this,this._myEngine)}isDestroyed(){return this._myDestroyed}};import{Emitter as gb}from"@wonderlandengine/api";import{Alignment as ZR,Collider as YR,Justification as $R}from"@wonderlandengine/api";var ha=class{constructor(e,t){this._setupBuildConfig(e,t),this._setupRuntimeConfig()}_setupBuildConfig(e,t){this.myBackgroundColor=F(46/255,46/255,46/255,1),this.myCursorTargetCollisionCollider=YR.Box,this.myCursorTargetCollisionGroup=7,this.myCursorTargetCollisionThickness=.001,this.myDefaultTextColor=F(255/255,255/255,255/255,1),this.myTextAlignment=ZR.Center,this.myTextJustification=$R.Middle,this.myTextColor=this.myDefaultTextColor,this.myButtonTextScale=c(.18,.18,.18),this.myVisibilityButtonBackgroundScale=c(.015,.015,1),this.myVisibilityButtonTextPosition=c(0,0,.007),this.myVisibilityButtonTextScale=this.myButtonTextScale;let n=.01,o=this.myVisibilityButtonBackgroundScale[0]*(2*t)+n*t;this.myVisibilityButtonPosition=[],this.myVisibilityButtonPosition[U.NONE]={},this.myVisibilityButtonPosition[U.NONE].myPosition=c(-.3+o,-.205,.035),this.myVisibilityButtonPosition[U.LEFT]={},this.myVisibilityButtonPosition[U.LEFT].myPosition=c(-.2+o,.025,.015),this.myVisibilityButtonPosition[U.RIGHT]={},this.myVisibilityButtonPosition[U.RIGHT].myPosition=c(.2-o,.025,.015),this.myVisibilityButtonText=e,this.myVisibilityButtonCursorTargetPosition=c(0,0,0),this.myVisibilityButtonCursorTargetPosition[2]=this.myVisibilityButtonTextPosition[2],this.myVisibilityButtonCollisionExtents=this.myVisibilityButtonBackgroundScale.pp_clone(),this.myVisibilityButtonCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myFlagButtonBackgroundScale=c(.0125,.0125,1),this.myFlagButtonTextPosition=c(0,0,.007),this.myFlagButtonTextScale=c(.15,.15,.15);let s=.0075,a=0,l=this.myVisibilityButtonBackgroundScale[1]+this.myFlagButtonBackgroundScale[1]+s+this.myFlagButtonBackgroundScale[1]*(2*a)+s*a;this.myPinButtonPosition=[],this.myPinButtonPosition[U.NONE]={},this.myPinButtonPosition[U.NONE].myPosition=this.myVisibilityButtonPosition[U.NONE].myPosition.pp_clone(),this.myPinButtonPosition[U.NONE].myPosition[1]+=l,this.myPinButtonPosition[U.LEFT]={},this.myPinButtonPosition[U.LEFT].myPosition=this.myVisibilityButtonPosition[U.LEFT].myPosition.pp_clone(),this.myPinButtonPosition[U.LEFT].myPosition[1]+=l,this.myPinButtonPosition[U.RIGHT]={},this.myPinButtonPosition[U.RIGHT].myPosition=this.myVisibilityButtonPosition[U.RIGHT].myPosition.pp_clone(),this.myPinButtonPosition[U.RIGHT].myPosition[1]+=l,this.myPinButtonText="P",this.myPinButtonCursorTargetPosition=c(0,0,0),this.myPinButtonCursorTargetPosition[2]=this.myFlagButtonTextPosition[2],this.myPinButtonCollisionExtents=this.myFlagButtonBackgroundScale.pp_clone(),this.myPinButtonCollisionExtents[2]=this.myCursorTargetCollisionThickness}_setupRuntimeConfig(){this._initializeObjectsTransforms(),this.myButtonHoverColor=F(150/255,150/255,150/255,1),this.myButtonDisabledTextColor=this.myBackgroundColor,this.myButtonDisabledBackgroundColor=F(110/255,110/255,110/255,1)}_initializeObjectsTransforms(){this.myPivotObjectTransforms=this._createDefaultObjectTransforms(),this.myPivotObjectTransforms[Re.GAMEPAD][U.LEFT].myRotation=j(-.645,.425,.25,.584),this.myPivotObjectTransforms[Re.GAMEPAD][U.LEFT].myRotation.quat_normalize(this.myPivotObjectTransforms[Re.GAMEPAD][U.LEFT].myRotation),this.myPivotObjectTransforms[Re.GAMEPAD][U.RIGHT].myRotation=j(-.645,-.425,-.25,.584),this.myPivotObjectTransforms[Re.GAMEPAD][U.RIGHT].myRotation.quat_normalize(this.myPivotObjectTransforms[Re.GAMEPAD][U.RIGHT].myRotation),this.myPivotObjectTransforms[Re.TRACKED_HAND][U.LEFT].myRotation=j(-.645,.425,.25,.584),this.myPivotObjectTransforms[Re.TRACKED_HAND][U.LEFT].myRotation.quat_normalize(this.myPivotObjectTransforms[Re.GAMEPAD][U.LEFT].myRotation),this.myPivotObjectTransforms[Re.TRACKED_HAND][U.RIGHT].myRotation=j(-.645,-.425,-.25,.584),this.myPivotObjectTransforms[Re.TRACKED_HAND][U.RIGHT].myRotation.quat_normalize(this.myPivotObjectTransforms[Re.GAMEPAD][U.RIGHT].myRotation),this.myWidgetObjectTransforms=this._createDefaultObjectTransforms(),this.myWidgetObjectTransforms[Re.GAMEPAD][U.LEFT].myPosition=c(.1,.23,-.02),this.myWidgetObjectTransforms[Re.GAMEPAD][U.RIGHT].myPosition=c(.07,.23,-.02),this.myWidgetObjectTransforms[Re.TRACKED_HAND][U.LEFT].myPosition=c(.1,.23,-.02),this.myWidgetObjectTransforms[Re.TRACKED_HAND][U.RIGHT].myPosition=c(.07,.23,-.02),this._myPivotObjectDistanceFromHeadNonXR=.6}_createDefaultObjectTransforms(){let e=[];for(let t in Re){let n=Re[t];e[n]=[];for(let o in U){let s=U[o];e[n][s]={},e[n][s].myPosition=c(0,0,0),e[n][s].myRotation=j(0,0,0,1)}}return e}};import{CollisionComponent as cb,MeshComponent as pb,TextComponent as db}from"@wonderlandengine/api";import{CursorTarget as _b}from"@wonderlandengine/components";var ca=class{constructor(e=r.getMainEngine()){this._myInputSourceType=null,this._myParentObject=null,this._myPinned=!1,this._myWidgetVisible=!0,this._myVisibilityButtonVisible=!0,this._myEngine=e,this._myDestroyed=!1}build(e,t,n){this._myParentObject=e,this._myConfig=t,this._myParams=n,this._myPlaneMesh=r.getDefaultMeshes(this._myEngine).myDoubleSidedPlane,this._createSkeleton(),this._setTransforms(),this._addComponents(),this._setTransformForNonXR(),I.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this._myEngine)}setWidgetVisible(e){this._myWidgetVisible=e,this.myFlagsButtonPanel.pp_setActive(e),e&&this._updateObjectsTransforms(!0)}setVisibilityButtonVisible(e){this._myVisibilityButtonVisible=e,this.myVisibilityButtonPanel.pp_setActive(e)}setPinned(e){e!=this._myPinned&&(this._myPinned=e,this._myPinned?this.myPivotObject.pp_setParent(r.getSceneObjects(this._myEngine).myTools):(this.myPivotObject.pp_setParent(this.myFixForwardObject),I.isSessionActive(this._myEngine)||this._setTransformForNonXR(),this._updateObjectsTransforms(!0)))}update(e){this._updateObjectsTransforms(!1)}_updateObjectsTransforms(e){if(I.isSessionActive(this._myEngine)){let t=ie.getInputSourceTypeByHandedness(this._myParams.myHandedness,this._myEngine);(t!=this._myInputSourceType||e)&&(this._myInputSourceType=t,this._myPinned||(this.myPivotObject.pp_setPositionLocal(this._myConfig.myPivotObjectTransforms[this._myInputSourceType][this._myParams.myHandedness].myPosition),this.myPivotObject.pp_resetRotationLocal(),this.myPivotObject.pp_rotateObjectQuat(this._myConfig.myPivotObjectTransforms[this._myInputSourceType][this._myParams.myHandedness].myRotation),this.myWidgetObject.pp_setPositionLocal(this._myConfig.myWidgetObjectTransforms[this._myInputSourceType][this._myParams.myHandedness].myPosition),this.myWidgetObject.pp_resetRotationLocal(),this.myWidgetObject.pp_rotateObjectQuat(this._myConfig.myWidgetObjectTransforms[this._myInputSourceType][this._myParams.myHandedness].myRotation),this.myVisibilityButtonPanel.pp_setPositionLocal(this._myConfig.myVisibilityButtonPosition[this._myParams.myHandedness].myPosition),this.myPinButtonPanel.pp_setPositionLocal(this._myConfig.myPinButtonPosition[this._myParams.myHandedness].myPosition)))}else this.myVisibilityButtonPanel.pp_setActive(this._myWidgetVisible||this._myVisibilityButtonVisible)}_createSkeleton(){this.myFixForwardObject=this._myParentObject.pp_addObject(),r.isPoseForwardFixed(this._myEngine)&&this.myFixForwardObject.pp_rotateObject(c(0,180,0)),this.myPivotObject=this.myFixForwardObject.pp_addObject(),this.myWidgetObject=this.myPivotObject.pp_addObject(),this.myVisibilityButtonPanel=this.myPivotObject.pp_addObject(),this.myVisibilityButtonBackground=this.myVisibilityButtonPanel.pp_addObject(),this.myVisibilityButtonText=this.myVisibilityButtonPanel.pp_addObject(),this.myVisibilityButtonCursorTarget=this.myVisibilityButtonPanel.pp_addObject(),this.myFlagsButtonPanel=this.myPivotObject.pp_addObject(),this.myPinButtonPanel=this.myFlagsButtonPanel.pp_addObject(),this.myPinButtonBackground=this.myPinButtonPanel.pp_addObject(),this.myPinButtonText=this.myPinButtonPanel.pp_addObject(),this.myPinButtonCursorTarget=this.myPinButtonPanel.pp_addObject(),this.myNonXRParentObject=r.getPlayerObjects(this._myEngine).myCameraNonXR.pp_addObject(),this.myNonXRParentObject.pp_translateLocal(c(0,0,-this._myConfig._myPivotObjectDistanceFromHeadNonXR)),this.myNonXRParentObject.pp_lookToLocal(c(0,0,1),c(0,1,0))}_setTransforms(){this.myPivotObject.pp_markDirty(),this.myVisibilityButtonPanel.pp_setPositionLocal(this._myConfig.myVisibilityButtonPosition[this._myParams.myHandedness].myPosition),this.myVisibilityButtonBackground.pp_scaleObject(this._myConfig.myVisibilityButtonBackgroundScale),this.myVisibilityButtonText.pp_setPositionLocal(this._myConfig.myVisibilityButtonTextPosition),this.myVisibilityButtonText.pp_scaleObject(this._myConfig.myVisibilityButtonTextScale),this.myVisibilityButtonCursorTarget.pp_setPositionLocal(this._myConfig.myVisibilityButtonCursorTargetPosition),this.myPinButtonPanel.pp_setPositionLocal(this._myConfig.myPinButtonPosition[this._myParams.myHandedness].myPosition),this.myPinButtonBackground.pp_scaleObject(this._myConfig.myFlagButtonBackgroundScale),this.myPinButtonText.pp_setPositionLocal(this._myConfig.myFlagButtonTextPosition),this.myPinButtonText.pp_scaleObject(this._myConfig.myFlagButtonTextScale),this.myPinButtonCursorTarget.pp_setPositionLocal(this._myConfig.myPinButtonCursorTargetPosition)}_addComponents(){this.myVisibilityButtonBackgroundComponent=this.myVisibilityButtonBackground.pp_addComponent(pb),this.myVisibilityButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myVisibilityButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myVisibilityButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myVisibilityButtonTextComponent=this.myVisibilityButtonText.pp_addComponent(db),this._setupButtonTextComponent(this.myVisibilityButtonTextComponent),this.myVisibilityButtonTextComponent.text=this._myConfig.myVisibilityButtonText,this.myVisibilityButtonCursorTargetComponent=this.myVisibilityButtonCursorTarget.pp_addComponent(_b),this.myVisibilityButtonCollisionComponent=this.myVisibilityButtonCursorTarget.pp_addComponent(cb),this.myVisibilityButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myVisibilityButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myVisibilityButtonCollisionComponent.extents=this._myConfig.myVisibilityButtonCollisionExtents,this.myPinButtonBackgroundComponent=this.myPinButtonBackground.pp_addComponent(pb),this.myPinButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPinButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myPinButtonBackgroundComponent.material.color=this._myConfig.myButtonDisabledBackgroundColor,this.myPinButtonTextComponent=this.myPinButtonText.pp_addComponent(db),this._setupButtonTextComponent(this.myPinButtonTextComponent),this.myPinButtonTextComponent.material.color=this._myConfig.myButtonDisabledTextColor,this.myPinButtonTextComponent.text=this._myConfig.myPinButtonText,this.myPinButtonCursorTargetComponent=this.myPinButtonCursorTarget.pp_addComponent(_b),this.myPinButtonCollisionComponent=this.myPinButtonCursorTarget.pp_addComponent(cb),this.myPinButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPinButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPinButtonCollisionComponent.extents=this._myConfig.myPinButtonCollisionExtents}_setupButtonTextComponent(e){e.alignment=this._myConfig.myTextAlignment,e.justification=this._myConfig.myTextJustification,e.material=this._myParams.myTextMaterial.clone(),e.material.color=this._myConfig.myTextColor,e.text=""}_onXRSessionStart(){this.myVisibilityButtonPanel.pp_setActive(this._myVisibilityButtonVisible),this._setTransformForXR()}_onXRSessionEnd(){this._setTransformForNonXR()}_setTransformForXR(){this.myFixForwardObject.pp_setParent(this._myParentObject),this.myFixForwardObject.pp_resetTransformLocal(),r.isPoseForwardFixed(this._myEngine)&&this.myFixForwardObject.pp_rotateObject(c(0,180,0)),this._updateObjectsTransforms(!0)}_setTransformForNonXR(){this._myPinned||(this.myFixForwardObject.pp_setParent(this.myNonXRParentObject),this.myFixForwardObject.pp_resetTransformLocal(),this.myPivotObject.pp_setPositionLocal(this._myConfig.myPivotObjectTransforms[Re.NONE][U.NONE].myPosition),this.myPivotObject.pp_resetRotationLocal(),this.myPivotObject.pp_rotateObjectQuat(this._myConfig.myPivotObjectTransforms[Re.NONE][U.NONE].myRotation),this.myWidgetObject.pp_setPositionLocal(this._myConfig.myWidgetObjectTransforms[Re.NONE][U.NONE].myPosition),this.myWidgetObject.pp_resetRotationLocal(),this.myWidgetObject.pp_rotateObjectQuat(this._myConfig.myWidgetObjectTransforms[Re.NONE][U.NONE].myRotation),this.myVisibilityButtonPanel.pp_setPositionLocal(this._myConfig.myVisibilityButtonPosition[U.NONE].myPosition),this.myPinButtonPanel.pp_setPositionLocal(this._myConfig.myPinButtonPosition[U.NONE].myPosition))}destroy(){this._myDestroyed=!0,I.unregisterSessionStartEndEventListeners(this,this._myEngine)}isDestroyed(){return this._myDestroyed}};var lo=class{constructor(){this.myHandedness=U.NONE,this.myPlaneMaterial=null,this.myTextMaterial=null}},mo=class{constructor(e,t,n=r.getMainEngine()){this._myWidgetVisible=!0,this._myPinned=!1,this._myConfig=new ha(e,t),this._myParams=null,this._myUI=new ca(n),this._myShowVisibilityButton=!1,this._myWidgetVisibleChangedEmitter=new gb,this._myPinChangedEmitter=new gb,this._myDestroyed=!0}getWidgetObject(){return this._myUI.myWidgetObject}setVisible(e){this._myWidgetVisible=!e,this._toggleVisibility(!1,!0)}isVisible(){return this._myWidgetVisible}toggleVisibility(){this._toggleVisibility(!1,!0)}togglePin(){this._togglePin(!1)}registerWidgetVisibleChangedEventListener(e,t){this._myWidgetVisibleChangedEmitter.add(t,{id:e})}unregisterWidgetVisibleChangedEventListener(e){this._myWidgetVisibleChangedEmitter.remove(e)}registerPinChangedEventListener(e,t){this._myPinChangedEmitter.add(t,{id:e})}unregisterPinChangedEventListener(e){this._myPinChangedEmitter.remove(e)}start(e,t){this._myParams=t,this._myUI.build(e,this._myConfig,t),this._myUI.setVisibilityButtonVisible(t.myShowVisibilityButton),this._myShowVisibilityButton=t.myShowVisibilityButton,t.myShowOnStart||this._toggleVisibility(!1,!1),this._addListeners()}update(e){this._myUI.update(e)}_addListeners(){let e=this._myUI;e.myPinButtonCursorTargetComponent.onClick.add(this._togglePin.bind(this,!0)),e.myPinButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myPinButtonBackgroundComponent.material)),e.myPinButtonCursorTargetComponent.onUnhover.add(this._pinUnhover.bind(this,e.myPinButtonBackgroundComponent.material)),e.myVisibilityButtonCursorTargetComponent.onClick.add(this._toggleVisibility.bind(this,!0,!0)),e.myVisibilityButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myVisibilityButtonBackgroundComponent.material)),e.myVisibilityButtonCursorTargetComponent.onUnhover.add(this._visibilityUnhover.bind(this,e.myVisibilityButtonBackgroundComponent.material))}_toggleVisibility(e,t){this._myWidgetVisible=!this._myWidgetVisible,this._myUI.setWidgetVisible(this._myWidgetVisible);let n=this._myUI.myVisibilityButtonTextComponent.material,o=this._myUI.myVisibilityButtonBackgroundComponent.material;this._myWidgetVisible?(n.color=this._myConfig.myDefaultTextColor,e||(o.color=this._myConfig.myBackgroundColor)):(n.color=this._myConfig.myButtonDisabledTextColor,e||(o.color=this._myConfig.myButtonDisabledBackgroundColor)),t&&this._myWidgetVisibleChangedEmitter.notify(this._myWidgetVisible),this._myUI.setVisibilityButtonVisible(this._myShowVisibilityButton)}_togglePin(e){if(this._myWidgetVisible){this._myPinned=!this._myPinned,this._myUI.setPinned(this._myPinned);let t=this._myUI.myPinButtonTextComponent.material,n=this._myUI.myPinButtonBackgroundComponent.material;this._myPinned?(t.color=this._myConfig.myDefaultTextColor,e||(n.color=this._myConfig.myBackgroundColor)):(t.color=this._myConfig.myButtonDisabledTextColor,e||(n.color=this._myConfig.myButtonDisabledBackgroundColor)),this._myPinChangedEmitter.notify(this._myPinned)}}_genericHover(e){e.color=this._myConfig.myButtonHoverColor}_visibilityUnhover(e){this._myWidgetVisible?e.color=this._myConfig.myBackgroundColor:e.color=this._myConfig.myButtonDisabledBackgroundColor}_pinUnhover(e){this._myPinned?e.color=this._myConfig.myBackgroundColor:e.color=this._myConfig.myButtonDisabledBackgroundColor}destroy(){this._myDestroyed=!0,this._myUI!=null&&this._myUI.destroy()}isDestroyed(){return this._myDestroyed}};var pa=class extends lo{constructor(){super(),this.myOverrideBrowserConsole=!1,this.myShowOnStart=!1,this.myShowVisibilityButton=!1,this.myPulseOnNewMessage=la.NEVER,this.myResetBrowserConsoleOriginalFunctionsOnDestroy=!0}},da=class{constructor(e,t){this.myType=e,this.myLines=t,this._myOriginalText=t.join(`
`),this._myMessagesCount=1}hasSameInfo(e){return this._myOriginalText==e._myOriginalText&&this.myType==e.myType}increaseCount(){this._myMessagesCount+=1;let e="(x".concat(this._myMessagesCount).concat(") "),t=this._myOriginalText;t=e.concat(t),this.myLines=t.split(`
`)}},_a=class{constructor(e=r.getMainEngine()){this._myWidgetFrame=new mo("C",0,e),this._myWidgetFrame.registerWidgetVisibleChangedEventListener(this,this._widgetVisibleChanged.bind(this)),this._myConfig=new ma,this._myParams=null,this._myUI=new ua(e),this._myMessages=[],this._myOldBrowserConsole=[],this._myOldConsoleVR=[],this._myTypeFilters=[];for(let t in k)this._myTypeFilters[k[t]]=!1;this._myScrollUp=!1,this._myScrollDown=!1,this._myScrollOffset=0,this._myScrollTimer=0,this._myScrollThumbstickTimer=0,this._myPulseTimer=0,this._myGamepadScrollEnabled=!0,this._myConfig.myGamepadScrollOnlyOnHover&&(this._myGamepadScrollEnabled=!1),this._myErrorEventListener=null,this._myUnhandledRejectionEventListener=null,this._myConsolePrintAddMessageEnabled=!0,this._myConsolePrintUpdateTextEnabled=!0,this._myConsolePrintAddMessageEnabledReset=!1,this._myConsolePrintUpdateTextEnabledReset=!1,this._myTextDirty=!1,this._myEngine=e,this._myDestroyed=!1}setVisible(e){this._myWidgetFrame.setVisible(e)}isVisible(){return this._myWidgetFrame.isVisible()}start(e,t){this._myLeftGamepad=r.getLeftGamepad(this._myEngine),this._myRightGamepad=r.getRightGamepad(this._myEngine),this._myParams=t,this._myWidgetFrame.start(e,t),this._myUI.build(this._myWidgetFrame.getWidgetObject(),this._myConfig,t),this._myUI.setVisible(this._myWidgetFrame.isVisible()),this._setNotifyIconActive(!1),this._addListeners(),this._overrideConsolesFunctions()}update(e){this._myWidgetFrame.update(e),this._myWidgetFrame.isVisible()&&(this._myConsolePrintAddMessageEnabledReset&&(this._myConsolePrintAddMessageEnabledReset=!1,this._myConsolePrintAddMessageEnabled=!0),this._myConsolePrintUpdateTextEnabledReset&&(this._myConsolePrintUpdateTextEnabledReset=!1,this._myConsolePrintUpdateTextEnabled=!0),this._myTextDirty&&(this._myTextDirty=!1,this._updateAllTexts()),this._updateScroll(e)),this._updateGamepadsExtraActions(e)}_overrideConsolesFunctions(){this._myOldBrowserConsole[le.LOG]=console.log,this._myOldBrowserConsole[le.ERROR]=console.error,this._myOldBrowserConsole[le.WARN]=console.warn,this._myOldBrowserConsole[le.INFO]=console.info,this._myOldBrowserConsole[le.DEBUG]=console.debug,this._myOldBrowserConsole[le.ASSERT]=console.assert,this._myOldBrowserConsoleClear=console.clear,this._myParams.myOverrideBrowserConsole&&(console.log=this._consolePrint.bind(this,le.LOG,Be.BROWSER_CONSOLE),console.error=this._consolePrint.bind(this,le.ERROR,Be.BROWSER_CONSOLE),console.warn=this._consolePrint.bind(this,le.WARN,Be.BROWSER_CONSOLE),console.info=this._consolePrint.bind(this,le.INFO,Be.BROWSER_CONSOLE),console.debug=this._consolePrint.bind(this,le.DEBUG,Be.BROWSER_CONSOLE),console.assert=this._consolePrint.bind(this,le.ASSERT,Be.BROWSER_CONSOLE),console.clear=this._clearConsole.bind(this,!0,Be.BROWSER_CONSOLE),this._myErrorEventListener=function(e){e.error!=null?this._consolePrint(le.ERROR,Be.WINDOW,"Uncaught",e.error.stack):this._consolePrint(le.ERROR,Be.WINDOW,"Uncaught",e.message)}.bind(this),this._myUnhandledRejectionEventListener=function(e){this._consolePrint(le.ERROR,Be.WINDOW,"Uncaught (in promise)",e.reason)}.bind(this),r.getWindow(this._myEngine).addEventListener("error",this._myErrorEventListener),r.getWindow(this._myEngine).addEventListener("unhandledrejection",this._myUnhandledRejectionEventListener)),this._myOldConsoleVR[le.LOG]=r.getConsoleVR(this._myEngine).log,this._myOldConsoleVR[le.ERROR]=r.getConsoleVR(this._myEngine).error,this._myOldConsoleVR[le.WARN]=r.getConsoleVR(this._myEngine).warn,this._myOldConsoleVR[le.INFO]=r.getConsoleVR(this._myEngine).info,this._myOldConsoleVR[le.DEBUG]=r.getConsoleVR(this._myEngine).debug,this._myOldConsoleVR[le.ASSERT]=r.getConsoleVR(this._myEngine).assert,this._myOldConsoleVRClear=r.getConsoleVR(this._myEngine).clear,r.getConsoleVR(this._myEngine).log=this._consolePrint.bind(this,le.LOG,Be.CONSOLE_VR),r.getConsoleVR(this._myEngine).error=this._consolePrint.bind(this,le.ERROR,Be.CONSOLE_VR),r.getConsoleVR(this._myEngine).warn=this._consolePrint.bind(this,le.WARN,Be.CONSOLE_VR),r.getConsoleVR(this._myEngine).info=this._consolePrint.bind(this,le.INFO,Be.CONSOLE_VR),r.getConsoleVR(this._myEngine).debug=this._consolePrint.bind(this,le.DEBUG,Be.CONSOLE_VR),r.getConsoleVR(this._myEngine).assert=this._consolePrint.bind(this,le.ASSERT,Be.CONSOLE_VR),r.getConsoleVR(this._myEngine).clear=this._clearConsole.bind(this,!0,Be.CONSOLE_VR)}_updateText(e){let t="";if(!this._myTypeFilters[e]){let n=0,o=this._myMessages.length-1,s=Math.round(this._myScrollOffset);for(;o>=0&&n<this._myConfig.myMaxLines;){let a=this._myMessages[o];if(this._myTypeFilters[a.myType]){o-=1;continue}let l=a.myLines.length,u=0;if(s>0){let m=0;o!=this._myMessages.length-1&&(m=this._myConfig.myLinesBetweenMessages),s>=l+m?(s-=l+m,u=l+m):(u=s,s=0)}if(o!=this._myMessages.length-1){let m=this._myConfig.myLinesBetweenMessages-Math.max(this._myConfig.myLinesBetweenMessages-u,0),h=this._myConfig.myLinesBetweenMessages-m;n+h>this._myConfig.myMaxLines&&(h=this._myMaxLines-n);for(let d=0;d<h;d++)t=`
`.concat(t);n+=h,u-=m}let _=l-u;if(n+_>this._myConfig.myMaxLines&&(_=this._myConfig.myMaxLines-n),_>0)if(a.myType==e)t=a.myLines.slice(l-_-u,l-u).join(`
`).concat(`
`).concat(t),n+=_;else{for(let m=0;m<_;m++)t=`
`.concat(t);n+=_}o-=1}}t=this._myConfig.myMessagesTextStartString.concat(t);try{this._myConsolePrintUpdateTextEnabled=!1,this._myUI.myMessagesTextComponents[e].text=t,this._myConsolePrintUpdateTextEnabled=!0}catch(n){throw this._myConsolePrintUpdateTextEnabledReset=!0,n}}_consolePrint(e,t,...n){if(this._myConsolePrintAddMessageEnabled&&(e!=le.ASSERT||n.length>0&&!n[0])){try{let o=this._argsToMessage(e,...n);this._addMessage(o),this._myMessages.length>=this._myConfig.myMaxMessages+this._myConfig.myMaxMessagesDeletePad&&(this._myMessages=this._myMessages.slice(this._myMessages.length-this._myConfig.myMaxMessages),this._clampScrollOffset())}catch(o){this._myConsolePrintAddMessageEnabled=!1,this._myConsolePrintAddMessageEnabledReset=!0,this._myTextDirty=!0;try{let s="An error occurred while trying to add a new message to the Console VR Widget",a=new da(k.ERROR,[s]);this._myMessages.push(a),Ee.error(this._myEngine,s)}catch{}throw o}this._myConsolePrintUpdateTextEnabled?(this._updateAllTexts(),this._pulseGamepad()):this._myTextDirty=!0}switch(t){case Be.BROWSER_CONSOLE:this._myOldBrowserConsole[e].apply(console,n);break;case Be.CONSOLE_VR:this._myOldConsoleVR[e].apply(r.getConsoleVR(this._myEngine),n);break;default:this._myOldBrowserConsole[e].apply(console,n);break}}_argsToMessage(e,...t){e==le.ASSERT&&(t=t.slice(1),t.splice(0,0,this._myConfig.myAssertStartString));let n=this._consoleFunctionToMessageType(e),o=this._formatArgs(...t),s=this._splitLongLines(o);return n==k.INFO?n=k.LOG:(n==k.EXCEPTION||n==k.ASSERT)&&(n=k.ERROR),new da(n,s)}_consoleFunctionToMessageType(e){let t=k.LOG;return e<le.INFO?t=e:e==le.INFO?t=k.LOG:t=k.ERROR,t}_formatArgs(...e){let t=[];for(let o=0;o<e.length;o++)e[o]===void 0?t.push("undefined"):t.push(this._stringifyItem(e[o]));return t.join(" ")}_stringifyItem(e){let t=null;if(e instanceof Error)t=e.stack;else if(typeof e=="object"){let n=2;try{t=JSON.stringify(e,this._jsonReplacer.bind(this),n)}catch{let s=new WeakSet;t=JSON.stringify(e,function(a,l){if(typeof l=="object"&&l!==null){if(s.has(l))return"<stringify error: object already stringified>";s.add(l)}return this._jsonReplacer(a,l)}.bind(this),n)}t=t.replaceAll('"[',"["),t=t.replaceAll("'[","["),t=t.replaceAll(']"',"]"),t=t.replaceAll("]'","]")}else t=e;return t}_splitLongLines(e){let t=e.split(`
`),n=[];for(let o=0;o<t.length;o++){let s=t[o];if(s.length>this._myConfig.myMaxCharactersPerLine){let a=this._getSpacesAtStart(s),l=this._myConfig.myTabString.concat(a),u=0;for(;s.length>this._myConfig.myMaxCharactersPerLine&&u<this._myConfig.myMaxLineSplits;){let _=s.substr(0,this._myConfig.myMaxCharactersPerLine-1),m=s.substr(this._myConfig.myMaxCharactersPerLine-1);m=l.concat(m),n.push(_),s=m,u++}n.push(s)}else n.push(s)}return n}_getSpacesAtStart(e){let t="",n=0;for(;n<e.length&&e[n]==" ";)t=t.concat(" "),n++;return t}_addMessage(e){let t=!1;if(this._myMessages.length>0){let n=this._myMessages[this._myMessages.length-1];n.hasSameInfo(e)&&(n.increaseCount(),t=!0)}t||this._myMessages.push(e),this._adjustScrollOffsetAfterMessageAdded(e,t),this._updateNotifyIcon(e)}_adjustScrollOffsetAfterMessageAdded(e,t){!t&&!this._myTypeFilters[e.myType]&&this._myScrollOffset>0&&(this._myScrollOffset+=e.myLines.length+this._myConfig.myLinesBetweenMessages)}_updateAllTexts(){if(this._myWidgetFrame.isVisible())for(let e in k)this._updateText(k[e])}_updateNotifyIcon(e){!this._myTypeFilters[e.myType]&&this._myScrollOffset>0&&this._setNotifyIconActive(!0)}_updateScroll(e){if(this._myScrollUp)for(this._myScrollTimer+=e;this._myScrollTimer>this._myConfig.myScrollDelay;)this._myScrollTimer-=this._myConfig.myScrollDelay,this._myScrollOffset+=this._myConfig.myScrollAmount;else if(this._myScrollDown)for(this._myScrollTimer+=e;this._myScrollTimer>this._myConfig.myScrollDelay;)this._myScrollTimer-=this._myConfig.myScrollDelay,this._myScrollOffset-=this._myConfig.myScrollAmount;this._clampScrollOffset(),(this._myScrollUp||this._myScrollDown)&&this._updateAllTexts(),this._myScrollOffset==0&&this._setNotifyIconActive(!1)}_clampScrollOffset(){let e=this._getMaxScrollOffset();this._myScrollOffset=Math.pp_clamp(this._myScrollOffset,0,e)}_getMaxScrollOffset(){return Math.max(this._getLinesCount()-this._myConfig.myMaxLines,0)}_getLinesCount(){let e=0;for(let t of this._myMessages)this._myTypeFilters[t.myType]||(e+=t.myLines.length+this._myConfig.myLinesBetweenMessages);return e-=this._myConfig.myLinesBetweenMessages,e=Math.max(e,0),e}_addListeners(){let e=this._myUI;for(let t in k){let n=e.myFilterButtonsCursorTargetComponents[k[t]],o=e.myFilterButtonsBackgroundComponents[k[t]].material,s=e.myFilterButtonsTextComponents[k[t]].material;n.onSingleClick.add(this._toggleFilter.bind(this,k[t],s)),n.onDoubleClick.add(this._filterAllButOne.bind(this,k[t],s)),n.onTripleClick.add(this._resetFilters.bind(this,k[t])),n.onHover.add(this._filterHover.bind(this,k[t],o)),n.onUnhover.add(this._filterUnhover.bind(this,k[t],o))}{let t=e.myClearButtonCursorTargetComponent,n=e.myClearButtonBackgroundComponent.material;t.onClick.add(this._clearConsole.bind(this,!1,null)),t.onHover.add(this._genericHover.bind(this,n)),t.onUnhover.add(this._genericUnhover.bind(this,n))}{let t=e.myUpButtonCursorTargetComponent,n=e.myUpButtonBackgroundComponent.material;t.onDoubleClick.add(this._instantScrollUp.bind(this,!0)),t.onDown.add(this._setScrollUp.bind(this,!0)),t.onDownOnHover.add(this._setScrollUp.bind(this,!0)),t.onUp.add(this._setScrollUp.bind(this,!1)),t.onUnhover.add(this._setScrollUp.bind(this,!1)),t.onHover.add(this._genericHover.bind(this,n)),t.onUnhover.add(this._genericUnhover.bind(this,n))}{let t=e.myDownButtonCursorTargetComponent,n=e.myDownButtonBackgroundComponent.material;t.onDoubleClick.add(this._instantScrollDown.bind(this)),t.onDown.add(this._setScrollDown.bind(this,!0)),t.onDownOnHover.add(this._setScrollDown.bind(this,!0)),t.onUp.add(this._setScrollDown.bind(this,!1)),t.onUnhover.add(this._setScrollDown.bind(this,!1)),t.onHover.add(this._genericHover.bind(this,n)),t.onUnhover.add(this._genericUnhover.bind(this,n))}{let t=e.myNotifyIconCursorTargetComponent,n=e.myNotifyIconBackgroundComponent.material;t.onClick.add(this._instantScrollDown.bind(this)),t.onHover.add(this._genericHover.bind(this,n)),t.onUnhover.add(this._notifyIconUnhover.bind(this))}e.myPointerCursorTargetComponent.onHover.add(this._setGamepadScrollEnabled.bind(this,!0)),e.myPointerCursorTargetComponent.onUnhover.add(this._setGamepadScrollEnabled.bind(this,!1))}_resetFilters(e){if(this._myWidgetFrame.isVisible()){for(let t in k){let n=this._myUI.myFilterButtonsBackgroundComponents[k[t]].material,o=this._myUI.myFilterButtonsTextComponents[k[t]].material;this._myTypeFilters[k[t]]=!1,o.color=this._myConfig.myMessageTypeColors[k[t]],k[t]!=e&&(n.color=this._myConfig.myBackgroundColor)}this._clampScrollOffset(),this._updateAllTexts()}}_filterAllButOne(e){if(this._myWidgetFrame.isVisible()){for(let t in k){let n=this._myUI.myFilterButtonsBackgroundComponents[k[t]].material,o=this._myUI.myFilterButtonsTextComponents[k[t]].material;k[t]!=e?(this._myTypeFilters[k[t]]=!0,n.color=this._myConfig.myFilterButtonDisabledBackgroundColor,o.color=this._myConfig.myFilterButtonDisabledTextColor):(this._myTypeFilters[k[t]]=!1,o.color=this._myConfig.myMessageTypeColors[e])}this._clampScrollOffset(),this._updateAllTexts()}}_toggleFilter(e,t){this._myWidgetFrame.isVisible()&&(this._myTypeFilters[e]=!this._myTypeFilters[e],this._myTypeFilters[e]?t.color=this._myConfig.myFilterButtonDisabledTextColor:t.color=this._myConfig.myMessageTypeColors[e],this._clampScrollOffset(),this._updateAllTexts())}_clearConsole(e=!1,t=null){if(this._myWidgetFrame.isVisible()||e)if(this._myMessages=[],this._clampScrollOffset(),this._updateAllTexts(),e)switch(t){case Be.BROWSER_CONSOLE:this._myOldBrowserConsoleClear.apply(console);break;case Be.CONSOLE_VR:this._myOldConsoleVRClear.apply(r.getConsoleVR(this._myEngine));break;default:break}else this._myConfig.myClearBrowserConsoleWhenClearPressed&&Ee.clear(this._myEngine)}_setScrollUp(e){(this._myWidgetFrame.isVisible()||!e)&&(e&&(this._myScrollTimer=0),this._myScrollUp=e)}_setScrollDown(e){(this._myWidgetFrame.isVisible()||!e)&&(e&&(this._myScrollTimer=0),this._myScrollDown=e)}_instantScrollUp(){this._myWidgetFrame.isVisible()&&(this._myScrollOffset=this._getMaxScrollOffset(),this._updateAllTexts())}_instantScrollDown(){this._myWidgetFrame.isVisible()&&(this._myScrollOffset=0,this._setNotifyIconActive(!1),this._updateAllTexts())}_setNotifyIconActive(e){this._myUI.myNotifyIconPanel.pp_setActive(e&&this._myWidgetFrame.isVisible())}_notifyIconUnhover(){let e=this._myUI.myNotifyIconBackgroundComponent.material;e.color=this._myConfig.myNotifyIconColor}_filterHover(e,t){this._genericHover(t)}_filterUnhover(e,t){this._myTypeFilters[e]?t.color=this._myConfig.myFilterButtonDisabledBackgroundColor:t.color=this._myConfig.myBackgroundColor}_genericHover(e){e.color=this._myConfig.myButtonHoverColor}_genericUnhover(e){e.color=this._myConfig.myBackgroundColor}_updateGamepadsExtraActions(e){this._myLeftGamepad&&this._myRightGamepad&&((this._myLeftGamepad.getButtonInfo(E.THUMBSTICK).isPressStart()&&this._myRightGamepad.getButtonInfo(E.THUMBSTICK).isPressed()||this._myRightGamepad.getButtonInfo(E.THUMBSTICK).isPressStart()&&this._myLeftGamepad.getButtonInfo(E.THUMBSTICK).isPressed())&&this._toggleVisibility(),this._myPulseTimer=Math.max(this._myPulseTimer-e,0),this._updateScrollWithThumbstick(e))}_toggleVisibility(){this._myWidgetFrame.toggleVisibility()}_widgetVisibleChanged(e){this._myUI.setVisible(e),e&&this._updateAllTexts()}_updateScrollWithThumbstick(e){if(this._myWidgetFrame.isVisible()&&this._myGamepadScrollEnabled){let t=[0,0];if(this._myConfig.myScrollThumbstickHandedness==U.LEFT?t=this._myLeftGamepad.getAxesInfo(oe.THUMBSTICK).myAxes:this._myConfig.myScrollThumbstickHandedness==U.RIGHT&&(t=this._myRightGamepad.getAxesInfo(oe.THUMBSTICK).myAxes),Math.abs(t[1])>this._myConfig.myScrollThumbstickMinThreshold){for(this._myScrollThumbstickTimer+=e;this._myScrollThumbstickTimer>this._myConfig.myScrollThumbstickDelay;){this._myScrollThumbstickTimer-=this._myConfig.myScrollThumbstickDelay;let n=(Math.abs(t[1])-this._myConfig.myScrollThumbstickMinThreshold)/(1-this._myConfig.myScrollThumbstickMinThreshold);this._myScrollOffset+=Math.sign(t[1])*n*this._myConfig.myScrollThumbstickAmount}this._clampScrollOffset(),this._updateAllTexts()}else this._myScrollThumbstickTimer=0}}_pulseGamepad(){if(this._myLeftGamepad&&this._myRightGamepad){let e=this._myParams.myPulseOnNewMessage;(e==la.ALWAYS||!this._myWidgetFrame.isVisible()&&e==la.WHEN_HIDDEN)&&this._myPulseTimer==0&&(this._myParams.myHandedness==U.RIGHT?this._myRightGamepad.pulse(this._myConfig.myPulseIntensity,this._myConfig.myPulseDuration):this._myLeftGamepad.pulse(this._myConfig.myPulseIntensity,this._myConfig.myPulseDuration),this._myPulseTimer=this._myConfig.myPulseDelay)}}_isSimpleArray(e){if(this._isSpecialSimpleArray(e))return!0;if(Array.isArray(e)){let t=!0;for(let n of e)if(n instanceof Object){t=!1;break}return t}return!1}_isSpecialSimpleArray(e){return e&&e.constructor&&(e.constructor.name=="Uint8ClampedArray"||e.constructor.name=="Uint8Array"||e.constructor.name=="Uint16Array"||e.constructor.name=="Uint32Array"||e.constructor.name=="Int8Array"||e.constructor.name=="Int16Array"||e.constructor.name=="Int32Array"||e.constructor.name=="Float32Array"||e.constructor.name=="Float64Array")}_setGamepadScrollEnabled(e){this._myGamepadScrollEnabled=e,this._myConfig.myGamepadScrollOnlyOnHover||(this._myGamepadScrollEnabled=!0)}_jsonReplacer(e,t){if(t instanceof Map)return Array.from(t.entries());if(this._isSimpleArray(t)){let n=t;if(this._isSpecialSimpleArray(n)){let s=[];for(let a=0;a<n.length;a++)s[a]=n[a];n=s}let o=JSON.stringify(n);return o=o.split(",").join(", "),o}else return t}destroy(){this._myDestroyed=!0,r.getWindow(this._myEngine).removeEventListener("error",this._myErrorEventListener),r.getWindow(this._myEngine).removeEventListener("unhandledrejection",this._myUnhandledRejectionEventListener),this._myUI.destroy(),this._myWidgetFrame.destroy(),this._myParams.myResetBrowserConsoleOriginalFunctionsOnDestroy?(console.log=Ee.getLog(this._myEngine),console.error=Ee.getError(this._myEngine),console.warn=Ee.getWarn(this._myEngine),console.info=Ee.getInfo(this._myEngine),console.debug=Ee.getDebug(this._myEngine),console.assert=Ee.getAssert(this._myEngine),console.clear=Ee.getClear(this._myEngine)):(console.log=this._myOldBrowserConsole[le.LOG],console.error=this._myOldBrowserConsole[le.ERROR],console.warn=this._myOldBrowserConsole[le.WARN],console.info=this._myOldBrowserConsole[le.INFO],console.debug=this._myOldBrowserConsole[le.DEBUG],console.assert=this._myOldBrowserConsole[le.ASSERT],console.clear=this._myOldBrowserConsoleClear)}isDestroyed(){return this._myDestroyed}};import{Component as eO,Property as ga}from"@wonderlandengine/api";var xn=class extends eO{start(){if(this._myStarted=!1,r.isToolEnabled(this.engine)){this.object.pp_addComponent(It),this._myWidget=new _a(this.engine);let e=new pa(this.engine);e.myHandedness=[null,"left","right"][this._myHandedness],e.myOverrideBrowserConsole=this._myOverrideBrowserConsole,e.myShowOnStart=this._myShowOnStart,e.myShowVisibilityButton=this._myShowVisibilityButton,e.myPulseOnNewMessage=this._myPulseOnNewMessage,e.myPlaneMaterial=r.getDefaultMaterials(this.engine).myFlatOpaque.clone(),e.myTextMaterial=r.getDefaultMaterials(this.engine).myText.clone(),this._myWidget.start(this.object,e),this._myWidgetVisibleBackup=null,this._myStarted=!0}}update(e){r.isToolEnabled(this.engine)?this._myStarted&&(this._myWidgetVisibleBackup!=null&&(this._myWidget.setVisible(!1),this._myWidget.setVisible(this._myWidgetVisibleBackup),this._myWidgetVisibleBackup=null),this._myWidget.update(e)):this._myStarted&&(this._myWidgetVisibleBackup==null&&(this._myWidgetVisibleBackup=this._myWidget.isVisible()),this._myWidget.isVisible()&&this._myWidget.setVisible(!1))}onDeactivate(){this._myStarted&&(this._myWidgetVisibleBackup==null&&(this._myWidgetVisibleBackup=this._myWidget.isVisible()),this._myWidget.isVisible()&&this._myWidget.setVisible(!1))}onDestroy(){this._myStarted&&this._myWidget.destroy()}};R(xn,"TypeName","pp-console-vr-tool"),R(xn,"Properties",{_myHandedness:ga.enum(["None","Left","Right"],"None"),_myOverrideBrowserConsole:ga.bool(!0),_myShowOnStart:ga.bool(!1),_myShowVisibilityButton:ga.bool(!1),_myPulseOnNewMessage:ga.enum(["Never","Always","When Hidden"],"Never")});import{Emitter as tO}from"@wonderlandengine/api";var yo=new WeakMap,uo=new WeakMap;function fb(i,e=r.getMainEngine()){if(yo.has(e))for(let t of yo.get(e).values())t(i)}function Tb(i=r.getMainEngine()){if(uo.has(i))for(let e of uo.get(i).values())e()}function Pb(i=null,e=!1,t=null,n=null,o=r.getMainEngine()){if(i==null||i.length==0)r.getNavigator(o).clipboard&&r.getNavigator(o).clipboard.readText().then(function(s){r.getEasyTuneVariables(o).fromJSON(s,e),ke.refreshWidget(o),t?.(),console.log("Easy Tune Variables Imported from: clipboard"),console.log(s)},function(){n?.(),console.error("An error occurred while importing the easy tune variables from: clipboard")}).catch(function(s){n?.(),console.error("An error occurred while importing the easy tune variables from: clipboard"),console.error(s)});else{let s=Mb(i,o);fetch(s).then(function(a){a.ok?a.text().then(function(l){r.getEasyTuneVariables(o).fromJSON(l,e),ke.refreshWidget(o),t?.(),console.log("Easy Tune Variables Imported from:",s),console.log(l)},function(l){n?.(),console.error("An error occurred while importing the easy tune variables from:",s),console.error(l)}):(n?.(),console.error("An error occurred while importing the easy tune variables from:",s),console.error(a))},function(a){n?.(),console.error("An error occurred while importing the easy tune variables from:",s),console.error(a)}).catch(function(a){n?.(),console.error("An error occurred while importing the easy tune variables from:",s),console.error(a)})}ke.refreshWidget(o)}function Cb(i=null,e=null,t=null,n=r.getMainEngine()){let o=r.getEasyTuneVariables(n).toJSON();if(i==null||i.length==0)r.getNavigator(n).clipboard&&r.getNavigator(n).clipboard.writeText(o).then(function(){e?.(),console.log("Easy Tune Variables Exported to: clipboard"),console.log(o)},function(){t?.(),console.error("An error occurred while exporting the easy tune variables to: clipboard")}).catch(function(s){t?.(),console.error("An error occurred while exporting the easy tune variables to: clipboard"),console.error(s)});else{let s=Mb(i,n);fetch(s,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:o}).then(function(a){a.ok?(e?.(),console.log("Easy Tune Variables Exported to:",s),console.log(o)):(t?.(),console.error("An error occurred while exporting the easy tune variables to:",s),console.error(a))},function(a){t?.(),console.error("An error occurred while exporting the easy tune variables to:",s),console.error(a)}).catch(function(a){t?.(),console.error("An error occurred while exporting the easy tune variables to:",s),console.error(a)})}}function bb(i,e,t=r.getMainEngine()){yo.has(t)||yo.set(t,new Map),yo.get(t).set(i,e)}function Sb(i,e=r.getMainEngine()){yo.has(e)&&yo.get(e).delete(i)}function vb(i,e,t=r.getMainEngine()){uo.has(t)||uo.set(t,new Map),uo.get(t).set(i,e)}function xb(i,e=r.getMainEngine()){uo.has(e)&&uo.get(e).delete(i)}var ke={setWidgetCurrentVariable:fb,refreshWidget:Tb,importVariables:Pb,exportVariables:Cb,addSetWidgetCurrentVariableCallback:bb,removeSetWidgetCurrentVariableCallback:Sb,addRefreshWidgetCallback:vb,removeRefreshWidgetCallback:xb},Mb=function(){let i=new RegExp("\\{.+?\\}","g");return function(t,n=r.getMainEngine()){let o=t.match(i);if(o==null||o.length==0)return t;for(let l=0;l<o.length;l++)o[l]=o[l].replace("{",""),o[l]=o[l].replace("}","");let s=new URL(r.getDocument(n).location).searchParams,a=t;for(let l of o){let u=s.get(l);u!=null&&(a=a.replace("{"+l+"}",u))}return a}}();var yi={NONE:0,NUMBER:1,BOOL:2,TRANSFORM:3},ho=class{constructor(e,t,n=null,o=!0,s=r.getMainEngine()){this._myName=e,this._myType=t,this._myValue=null,this._myDefaultValue=null,this._myShowOnWidget=o,this._myWidgetCurrentVariable=!1,this._myValueChangedEmitter=new tO,this._myEngine=s,n!=null&&this.registerValueChangedEventListener(this,n)}getName(){return this._myName}getType(){return this._myType}isWidgetCurrentVariable(){return this._myWidgetCurrentVariable}setWidgetCurrentVariable(e){this._myWidgetCurrentVariable=e}getValue(){return this._myValue}setValue(e,t=!1){let n=this._myValue!=e;this._myValue=e,t&&ho.prototype.setDefaultValue.call(this,e),ke.refreshWidget(this._myEngine),n&&this._myValueChangedEmitter.notify(this.getValue(),this)}getDefaultValue(){return this._myDefaultValue}setDefaultValue(e){this._myDefaultValue=e}shouldShowOnWidget(){return this._myShowOnWidget}setShowOnWidget(e){this._myShowOnWidget=e}fromJSON(e,t=!1){this.setValue(JSON.parse(e),t)}toJSON(){return JSON.stringify(this.getValue())}registerValueChangedEventListener(e,t){this._myValueChangedEmitter.add(t,{id:e})}unregisterValueChangedEventListener(e){this._myValueChangedEmitter.remove(e)}},mi=class extends ho{constructor(e,t,n,o,s,a){super(e,t,o,s,a),mi.prototype.setValue.call(this,n,!0)}setValue(e,t=!1){let n=this._myValue!=null&&!this._myValue.pp_equals(e);this._myValue==null?this._myValue=e.pp_clone():this._myValue.pp_copy(e),t&&mi.prototype.setDefaultValue.call(this,e),ke.refreshWidget(this._myEngine),n&&this._myValueChangedEmitter.notify(this.getValue(),this)}setDefaultValue(e){this._myDefaultValue==null?this._myDefaultValue=e.pp_clone():this._myDefaultValue.pp_copy(e)}},Di=class extends mi{constructor(e,t,n,o,s=3,a=1,l=null,u=null,_=!1,m){super(e,yi.NUMBER,t,n,o,m),this._myDecimalPlaces=s,this._myStepPerSecond=a,this._myDefaultStepPerSecond=this._myStepPerSecond,this._myMin=l,this._myMax=u,this._myEditAllValuesTogether=_,this._clampValue(!0)}setMax(e){this._myMax=e,this._clampValue(!1)}setMin(e){this._myMin=e,this._clampValue(!1)}_clampValue(e){let t=this._myValue.vec_clamp(this._myMin,this._myMax);if(!e){let n=this.getDefaultValue().vec_clamp(this._myMin,this._myMax);!n.vec_equals(this.getDefaultValue(),1e-5)&&mi.prototype.setDefaultValue.call(this,n)}mi.prototype.setValue.call(this,t,e)}},Xi=class extends Di{constructor(e,t,n,o,s,a,l,u,_){super(e,[t],n,o,s,a,l,u,_),this._myTempValue=[0],this._myTempDefaultValue=[0]}getValue(){return super.getValue()[0]}setValue(e,t=!1){this._myTempValue[0]=e,super.setValue(this._myTempValue,t)}getDefaultValue(){return super.getDefaultValue()[0]}setDefaultValue(e){this._myTempDefaultValue[0]=e,super.setDefaultValue(this._myTempValue)}},fa=class extends Xi{constructor(e,t,n,o,s,a,l,u){super(e,t,n,o,0,s,a,l,u)}},Ei=class extends Di{constructor(e,t,n,o,s,a,l,u,_){let m=t.pp_clone();for(let h=0;h<t.length;h++)m[h]=Math.round(m[h]);super(e,m,n,o,0,s,a!=null?Math.round(a):null,l!=null?Math.round(l):l,u,_)}},Gr=class extends mi{constructor(e,t,n,o,s){super(e,yi.BOOL,t,n,o,s)}},rm=class extends Gr{constructor(e,t,n,o,s){super(e,[t],n,o,s),this._myTempValue=[0],this._myTempDefaultValue=[0]}getValue(){return super.getValue()[0]}setValue(e,t=!1){this._myTempValue[0]=e,super.setValue(this._myTempValue,t)}getDefaultValue(){return super.getDefaultValue()[0]}setDefaultValue(e){this._myTempDefaultValue[0]=e,super.setDefaultValue(this._myTempValue)}},co=class extends ho{constructor(e,t,n,o,s=!0,a=3,l=1,u=50,_=1,m){super(e,yi.TRANSFORM,n,o,m),this._myDecimalPlaces=a,this._myPosition=t.mat4_getPosition(),this._myRotation=t.mat4_getRotationDegrees(),this._myScale=t.mat4_getScale();let h=Math.pow(10,this._myDecimalPlaces);for(let d=0;d<3;d++)this._myScale[d]=Math.max(this._myScale[d],1/h);this._myScaleAsOne=s,this._myPositionStepPerSecond=l,this._myRotationStepPerSecond=u,this._myScaleStepPerSecond=_,this._myDefaultPosition=this._myPosition.vec3_clone(),this._myDefaultRotation=this._myRotation.vec3_clone(),this._myDefaultScale=this._myScale.vec3_clone(),this._myDefaultPositionStepPerSecond=this._myPositionStepPerSecond,this._myDefaultRotationStepPerSecond=this._myRotationStepPerSecond,this._myDefaultScaleStepPerSecond=this._myScaleStepPerSecond,this._myTransform=be(),this._myTransform.mat4_setPositionRotationDegreesScale(this._myPosition,this._myRotation,this._myScale),this._myTempTransform=be()}getValue(){return this._myTransform.mat4_setPositionRotationDegreesScale(this._myPosition,this._myRotation,this._myScale),this._myTransform}setValue(e,t=!1){this._myTempTransform.mat4_setPositionRotationDegreesScale(this._myPosition,this._myRotation,this._myScale),e.mat4_getPosition(this._myPosition),e.mat4_getRotationDegrees(this._myRotation),e.mat4_getScale(this._myScale),this._myTransform.mat4_setPositionRotationDegreesScale(this._myPosition,this._myRotation,this._myScale);let n=!this._myTempTransform.pp_equals(this._myTransform);t&&co.prototype.setDefaultValue.call(this,e),ke.refreshWidget(this._myEngine),n&&this._myValueChangedEmitter.notify(this.getValue(),this)}setDefaultValue(e){this._myDefaultPosition=e.mat4_getPosition(),this._myDefaultRotation=e.mat4_getRotationDegrees(),this._myDefaultScale=e.mat4_getScale()}fromJSON(e,t=!1){this.setValue(JSON.parse(e),t)}toJSON(){return this.getValue().vec_toString()}};import{Component as lO,Property as Ai}from"@wonderlandengine/api";import{Emitter as iO}from"@wonderlandengine/api";var Ta=class{constructor(){this.myVariablesImportCallback=null,this.myVariablesExportCallback=null}},Ut=class{constructor(e){this._myConfig=null,this._myUI=null,this._myParams=e,this._myVariable=null,this._myVisible=!0,this._myScrollVariableRequestEmitter=new iO,this._myAppendToVariableName="",this._myScrollVariableActive=!1,this._myScrollDirection=0,this._myScrollVariableTimer=0,this._myHasScrolled=!1,this._myResetImportLabelTimer=new ne(0,!1),this._myResetExportLabelTimer=new ne(0,!1),this._myDestroyed=!1}setVisible(e){e&&this._refreshUI(),this._myUI.setVisible(e),this._myVisible=e}setEasyTuneVariable(e,t){this._myVariable=e,typeof t<"u"?this._myAppendToVariableName=t:this._myAppendToVariableName="",this._setEasyTuneVariableHook(),this._refreshUI()}isScrollVariableActive(){return this._myScrollVariableActive}getScrollVariableDirection(){return this._myScrollDirection}setScrollVariableActive(e,t){this._myScrollVariableActive=e,this._myScrollDirection=t,this._myScrollVariableTimer=this._myConfig.myScrollVariableDelay,this._myHasScrolled=!1}getWidget(){return this}syncWidget(e){e!=null?(e._myResetImportLabelTimer.isRunning()?this._myResetImportLabelTimer.start(e._myResetImportLabelTimer.getTimeLeft()):this._myResetImportLabelTimer.reset(),e._myResetExportLabelTimer.isRunning()?this._myResetExportLabelTimer.start(e._myResetExportLabelTimer.getTimeLeft()):this._myResetExportLabelTimer.reset(),this._myUI.myImportButtonTextComponent.text=e._myUI.myImportButtonTextComponent.text,this._myUI.myExportButtonTextComponent.text=e._myUI.myExportButtonTextComponent.text,this.setScrollVariableActive(e.isScrollVariableActive(),e.getScrollVariableDirection())):(this._myResetImportLabelTimer.reset(),this._myUI.myImportButtonTextComponent.text=this._myConfig.myImportButtonText,this._myResetExportLabelTimer.reset(),this._myUI.myExportButtonTextComponent.text=this._myConfig.myExportButtonText)}onImportSuccess(){this._myUI.myImportButtonTextComponent.text=this._myConfig.myImportSuccessButtonText,this._myResetImportLabelTimer.start(this._myConfig.myImportExportResetLabelSeconds)}onImportFailure(){this._myUI.myImportButtonTextComponent.text=this._myConfig.myImportFailureButtonText,this._myResetImportLabelTimer.start(this._myConfig.myImportExportResetLabelSeconds)}onExportSuccess(){this._myUI.myExportButtonTextComponent.text=this._myConfig.myExportSuccessButtonText,this._myResetExportLabelTimer.start(this._myConfig.myImportExportResetLabelSeconds)}onExportFailure(){this._myUI.myExportButtonTextComponent.text=this._myConfig.myExportFailureButtonText,this._myResetExportLabelTimer.start(this._myConfig.myImportExportResetLabelSeconds)}registerScrollVariableRequestEventListener(e,t){this._myScrollVariableRequestEmitter.add(t,{id:e})}unregisterScrollVariableRequestEventListener(e){this._myScrollVariableRequestEmitter.remove(e)}start(e,t){this._myConfig.build(),this._myResetImportLabelTimer.setDuration(this._myConfig.myImportExportResetLabelSeconds),this._myResetExportLabelTimer.setDuration(this._myConfig.myImportExportResetLabelSeconds),this._myUI.build(e,this._myConfig,t),this._myUI.setImportExportButtonsVisible(t.myShowVariablesImportExportButtons),this._startHook(e,t),this._addListeners()}update(e){this._isActive()&&(this._updateHook(e),this._updateScrollVariable(e),this._updateImportExportLabel(e))}_setEasyTuneVariableHook(){}_refreshUIHook(){}_startHook(e,t){}_addListenersHook(){}_updateHook(e){}_refreshUI(){if(this._myVariable){if(this._myVariable.getName()!=null)this._myUI.myVariableLabelTextComponent.text=this._myVariable.getName().concat(this._myAppendToVariableName);else{let e="Unknown";this._myUI.myVariableLabelTextComponent.text=e.concat(this._myAppendToVariableName)}this._refreshUIHook()}}_updateScrollVariable(e){this._myScrollVariableActive&&(this._myScrollVariableTimer<=0?(this._scrollVariableRequest(this._myScrollDirection),this._myScrollVariableTimer=this._myConfig.myScrollVariableDelay,this._myHasScrolled=!0):this._myScrollVariableTimer-=e)}_updateImportExportLabel(e){this._myResetImportLabelTimer.isRunning(e)&&(this._myResetImportLabelTimer.update(e),this._myResetImportLabelTimer.isDone()&&(this._myResetImportLabelTimer.reset(),this._myUI.myImportButtonTextComponent.text=this._myConfig.myImportButtonText)),this._myResetExportLabelTimer.isRunning(e)&&(this._myResetExportLabelTimer.update(e),this._myResetExportLabelTimer.isDone()&&(this._myResetExportLabelTimer.reset(),this._myUI.myExportButtonTextComponent.text=this._myConfig.myExportButtonText))}_isActive(){return this._myVisible&&this._myVariable}_addListeners(){let e=this._myUI;e.myNextButtonCursorTargetComponent.onDown.add(this._setScrollVariableActive.bind(this,!0,1,!1)),e.myNextButtonCursorTargetComponent.onDownOnHover.add(this._setScrollVariableActive.bind(this,!0,1,!1)),e.myNextButtonCursorTargetComponent.onUpWithDown.add(this._setScrollVariableActive.bind(this,!1,0,!1)),e.myNextButtonCursorTargetComponent.onUpWithNoDown.add(this._setScrollVariableActive.bind(this,!1,0,!0)),e.myNextButtonCursorTargetComponent.onUnhover.add(this._setScrollVariableActive.bind(this,!1,0,!0)),e.myNextButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myNextButtonBackgroundComponent.material)),e.myNextButtonCursorTargetComponent.onUnhover.add(this._genericUnhover.bind(this,e.myNextButtonBackgroundComponent.material)),e.myPreviousButtonCursorTargetComponent.onDown.add(this._setScrollVariableActive.bind(this,!0,-1,!1)),e.myPreviousButtonCursorTargetComponent.onDownOnHover.add(this._setScrollVariableActive.bind(this,!0,-1,!1)),e.myPreviousButtonCursorTargetComponent.onUpWithDown.add(this._setScrollVariableActive.bind(this,!1,0,!1)),e.myPreviousButtonCursorTargetComponent.onUpWithNoDown.add(this._setScrollVariableActive.bind(this,!1,0,!0)),e.myPreviousButtonCursorTargetComponent.onUnhover.add(this._setScrollVariableActive.bind(this,!1,0,!0)),e.myPreviousButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myPreviousButtonBackgroundComponent.material)),e.myPreviousButtonCursorTargetComponent.onUnhover.add(this._genericUnhover.bind(this,e.myPreviousButtonBackgroundComponent.material)),e.myImportButtonCursorTargetComponent.onUpWithDown.add(this._importVariables.bind(this)),e.myImportButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myImportButtonBackgroundComponent.material)),e.myImportButtonCursorTargetComponent.onUnhover.add(this._genericUnhover.bind(this,e.myImportButtonBackgroundComponent.material)),e.myExportButtonCursorTargetComponent.onUpWithDown.add(this._exportVariables.bind(this)),e.myExportButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myExportButtonBackgroundComponent.material)),e.myExportButtonCursorTargetComponent.onUnhover.add(this._genericUnhover.bind(this,e.myExportButtonBackgroundComponent.material)),this._addListenersHook()}_setScrollVariableActive(e,t,n){if(this._isActive()||!e){let o=!e&&!this._myHasScrolled&&!n,s=this._myScrollDirection;this.setScrollVariableActive(e,t),o&&this._scrollVariableRequest(s)}}_scrollVariableRequest(e){this._isActive()&&e!=0&&this._myScrollVariableRequestEmitter.notify(e)}_genericHover(e){e.color=this._myConfig.myButtonHoverColor}_genericUnhover(e){e.color=this._myConfig.myBackgroundColor}_importVariables(){this._myUI.myImportButtonTextComponent.text==this._myConfig.myImportButtonText&&(this._myUI.myImportButtonTextComponent.text=this._myConfig.myImportingButtonText,this._myResetImportLabelTimer.reset(),this._myParams.myVariablesImportCallback())}_exportVariables(){this._myUI.myExportButtonTextComponent.text==this._myConfig.myExportButtonText&&(this._myUI.myExportButtonTextComponent.text=this._myConfig.myExportingButtonText,this._myResetExportLabelTimer.reset(),this._myParams.myVariablesExportCallback())}destroy(){this._myDestroyed=!0,this._myUI!=null&&this._myUI.destroy()}isDestroyed(){return this._myDestroyed}};import{Emitter as nO}from"@wonderlandengine/api";var po=class{constructor(e,t,n=r.getMainEngine()){this._myGamepad=t,this._myParentObject=null,this._myParams=e,this._myEasyTuneParams=null,this._myWidgets=new Map,this._myVariable=null,this._myVisible=!0,this._myAppendToVariableName=null,this._myScrollVariableRequestEmitter=new nO,this._myCurrentArraySize=null,this._myEngine=n,this._myDestroyed=!1}setEasyTuneVariable(e,t){this._myVariable=e,this._myCurrentArraySize=this._myVariable.getValue().length,this._myAppendToVariableName=t,this._myWidgets.has(this._myCurrentArraySize)||this._createWidget(this._myCurrentArraySize);let n=this._myWidgets.get(this._myCurrentArraySize);n&&n.setEasyTuneVariable(e,t),this.setVisible(this._myVisible)}setVisible(e){for(let t of this._myWidgets.values())t.setVisible(!1);if(this._myVariable){this._sizeChangedCheck();let t=this._myWidgets.get(this._myCurrentArraySize);t&&t.setVisible(e)}this._myVisible=e}isScrollVariableActive(){let e=this._myWidgets.get(this._myCurrentArraySize);return e?e.isScrollVariableActive():!1}getScrollVariableDirection(){let e=this._myWidgets.get(this._myCurrentArraySize);return e?e.getScrollVariableDirection():0}setScrollVariableActive(e,t){let n=this._myWidgets.get(this._myCurrentArraySize);n&&n.setScrollVariableActive(e,t)}getWidget(){return this._myWidgets.get(this._myCurrentArraySize)}registerScrollVariableRequestEventListener(e,t){this._myScrollVariableRequestEmitter.add(t,{id:e})}unregisterScrollVariableRequestEventListener(e){this._myScrollVariableRequestEmitter.remove(e)}start(e,t){this._myParentObject=e,this._myEasyTuneParams=t,this._createWidget(1),this._myVariable&&this.setEasyTuneVariable(this._myVariable,this._myAppendToVariableName)}update(e){if(this._isActive()){this._sizeChangedCheck();let t=this._myWidgets.get(this._myCurrentArraySize);t&&t.update(e)}}onImportSuccess(){let e=this._myWidgets.get(this._myCurrentArraySize);e&&e.onImportSuccess()}onImportFailure(){let e=this._myWidgets.get(this._myCurrentArraySize);e&&e.onImportFailure()}onExportSuccess(){let e=this._myWidgets.get(this._myCurrentArraySize);e&&e.onExportSuccess()}onExportFailure(){let e=this._myWidgets.get(this._myCurrentArraySize);e&&e.onExportFailure()}_isActive(){return this._myVisible&&this._myVariable}_scrollVariableRequest(e){this._myScrollVariableRequestEmitter.notify(e)}_createWidget(e){this._myWidgets.set(e,this._getEasyTuneArrayWidget(e)),this._myWidgets.get(e).start(this._myParentObject,this._myEasyTuneParams),this._myWidgets.get(e).setVisible(!1),this._myWidgets.get(e).registerScrollVariableRequestEventListener(this,this._scrollVariableRequest.bind(this))}_sizeChangedCheck(){this._myVariable.getValue().length!=this._myCurrentArraySize&&this.setEasyTuneVariable(this._myVariable,this._myAppendToVariableName)}_getEasyTuneArrayWidget(e){return null}destroy(){this._myDestroyed=!0;for(let e of this._myWidgets.values())e.destroy()}isDestroyed(){return this._myDestroyed}};import{Alignment as oO,Collider as sO,Justification as aO}from"@wonderlandengine/api";var Qt=class{constructor(){}build(){this._setupBuildConfig(),this._setupRuntimeConfig()}_getBackPanelMaxY(){return this.myDisplayPanelPosition[1]+this.myVariableLabelPanelPosition[1]+this.mySideButtonBackgroundScale[1]+this._mySideButtonDistanceFromBorder*1.25}_getBackPanelMinY(){return this.myDisplayPanelPosition[1]-this._mySideButtonDistanceFromBorder*1.25-this.mySideButtonBackgroundScale[1]}_getBackPanelMaxX(){return this._mySideButtonPanelHalfWidth}_getBackPanelMinX(){return-this._mySideButtonPanelHalfWidth}_getPivotZOffset(){return 0}_setupBuildConfigHook(){}_setupRuntimeConfigHook(){}_setupBuildConfig(){this.myBackgroundColor=F(46/255,46/255,46/255,1),this.myCursorTargetCollisionCollider=sO.Box,this.myCursorTargetCollisionGroup=7,this.myCursorTargetCollisionThickness=.001,this.myDefaultTextColor=F(255/255,255/255,255/255,1),this.myTextAlignment=oO.Center,this.myTextJustification=aO.Middle,this.myTextColor=this.myDefaultTextColor,this.myLabelTextScale=c(.18,.18,.18),this.myButtonTextScale=c(.18,.18,.18),this._myPanelZOffset=.01,this._myColliderZOffset=.017,this._mySideButtonDistanceFromBorder=.0125,this._mySideButtonPanelHalfWidth=.2,this.myPivotObjectPositions=[],this.myPivotObjectPositions[U.NONE]=c(0,0,this._getPivotZOffset()),this.myPivotObjectPositions[U.LEFT]=c(-.04,.02,this._getPivotZOffset()),this.myPivotObjectPositions[U.RIGHT]=c(-.08,.02,this._getPivotZOffset()),this.mySideButtonBackgroundScale=c(.015,.015,1),this.mySideButtonTextScale=this.myButtonTextScale,this.mySideButtonTextPosition=c(0,0,.007),this.mySideButtonCursorTargetPosition=c(0,0,0),this.mySideButtonCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.mySideButtonCollisionExtents=this.mySideButtonBackgroundScale.pp_clone(),this.mySideButtonCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myLeftSideButtonPosition=c(0,0,-1e-5),this.myLeftSideButtonPosition[0]=-this._mySideButtonPanelHalfWidth+this.mySideButtonBackgroundScale[0]+this._mySideButtonDistanceFromBorder,this.myRightSideButtonPosition=c(0,0,-1e-5),this.myRightSideButtonPosition[0]=-this.myLeftSideButtonPosition[0],this.myDisplayPanelPosition=c(0,.1,0),this.myVariableLabelPanelPosition=c(0,.025,this._myPanelZOffset),this.myVariableLabelTextScale=this.myLabelTextScale,this.myVariableLabelCursorTargetPosition=c(0,0,0),this.myVariableLabelCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myVariableLabelCollisionExtents=c(.065,.0175,1),this.myVariableLabelCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myNextButtonText=">",this.myPreviousButtonText="<",this._setupBuildConfigHook();{let e=this._getBackPanelMaxX(),t=this._getBackPanelMinX(),n=this._getBackPanelMaxY(),o=this._getBackPanelMinY();this.myBackPanelPosition=[(e+t)/2,(n+o)/2,0],this.myBackBackgroundScale=[(e-t)/2,(n-o)/2,1],this.myBackBackgroundColor=F(70/255,70/255,70/255,1)}this.myImportExportButtonBackgroundScale=c(.04,.02,1),this.myImportExportButtonTextScale=this.myButtonTextScale,this.myImportExportButtonTextPosition=c(0,0,.007),this.myImportExportPanelPosition=[0,this._getBackPanelMaxY()+this._mySideButtonDistanceFromBorder+this.myImportExportButtonBackgroundScale[1],this._myPanelZOffset],this.myImportExportButtonCursorTargetPosition=c(0,0,0),this.myImportExportButtonCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myImportExportButtonCollisionExtents=this.myImportExportButtonBackgroundScale.pp_clone(),this.myImportExportButtonCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myImportButtonText="Import",this.myExportButtonText="Export",this.myImportExportResetLabelSeconds=2,this.myImportingButtonText="...",this.myImportSuccessButtonText="Done",this.myImportFailureButtonText="Error",this.myExportingButtonText="...",this.myExportSuccessButtonText="Done",this.myExportFailureButtonText="Error",this.myImportButtonPosition=c(0,0,-1e-5),this.myImportButtonPosition[0]=-this.myImportExportButtonBackgroundScale[0]-this._mySideButtonDistanceFromBorder/2,this.myExportButtonPosition=c(0,0,-1e-5),this.myExportButtonPosition[0]=-this.myImportButtonPosition[0],this.myPointerCollisionExtents=this.myBackBackgroundScale.pp_clone(),this.myPointerCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myPointerCursorTargetPosition=this.myBackPanelPosition.pp_clone(),this.myPointerCursorTargetPosition[2]=this._myColliderZOffset-1e-4}_setupRuntimeConfig(){this.myButtonHoverColor=F(150/255,150/255,150/255,1),this.myScrollVariableDelay=.5,this._setupRuntimeConfigHook()}};var Pa=class extends Qt{constructor(e){super(),this.myArraySize=e}_getBackPanelMinY(){let e=this.myValuePanelsPositions[this.myArraySize-1]?this.myValuePanelsPositions[this.myArraySize-1][1]:0;return super._getBackPanelMinY()+this.myValuesPanelPosition[1]+e}_getPivotZOffset(){return .00802713}_setupBuildConfigHook(){this.myIncreaseButtonText="+",this.myDecreaseButtonText="-",this._myValuePanelDistanceFromVariableLabelPanel=.055,this._myDistanceBetweenValues=this.mySideButtonBackgroundScale[1]*2+.015,this.myValuesPanelPosition=[0,this.myVariableLabelPanelPosition[1]-this._myValuePanelDistanceFromVariableLabelPanel,this._myPanelZOffset],this.myValueTextScale=c(.4,.4,.4),this.myValueCursorTargetPosition=c(0,0,0),this.myValueCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myValueCollisionExtents=c(.065,.02,1),this.myValueCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myValuePanelsPositions=[],this.myValuePanelsPositions[0]=c(0,0,0);for(let e=1;e<this.myArraySize;e++)this.myValuePanelsPositions[e]=this.myValuePanelsPositions[e-1].pp_clone(),this.myValuePanelsPositions[e][1]-=this._myDistanceBetweenValues}_setupRuntimeConfigHook(){this.myTextHoverScaleMultiplier=c(1.1,1.1,1.1),this.myThumbstickToggleThreshold=.6,this.myButtonEditDelay=0}};import{CollisionComponent as lm,MeshComponent as Db,TextComponent as mm}from"@wonderlandengine/api";import{CursorTarget as ym}from"@wonderlandengine/components";import{CollisionComponent as ts,MeshComponent as Ca,TextComponent as ba}from"@wonderlandengine/api";import{CursorTarget as Sa}from"@wonderlandengine/components";var qt=class{constructor(e=r.getMainEngine()){this._myEngine=e,this._myDestroyed=!1}build(e,t,n){this._myParentObject=e,this._myConfig=t,this._myParams=n,this._myImportExportButtonsVisible=!0,this._myPlaneMesh=r.getDefaultMeshes(this._myEngine).myDoubleSidedPlane,this._buildHook(),this._createSkeleton(),this._setTransforms(),this._addComponents(),this._setTransformForNonXR(),I.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this._myEngine)}setVisible(e){this.myPivotObject.pp_setActive(e),e&&this.setImportExportButtonsVisible(this._myImportExportButtonsVisible),this._setVisibleHook(e)}setImportExportButtonsVisible(e){this._myImportExportButtonsVisible=e,this.myImportExportPanel.pp_setActive(this._myImportExportButtonsVisible)}_buildHook(){}_setVisibleHook(e){}_createSkeletonHook(){}_setTransformHook(){}_addComponentsHook(){}_createSkeleton(){this.myPivotObject=this._myParentObject.pp_addObject(),this.myBackPanel=this.myPivotObject.pp_addObject(),this.myBackBackground=this.myBackPanel.pp_addObject(),this.myDisplayPanel=this.myPivotObject.pp_addObject(),this.myVariableLabelPanel=this.myDisplayPanel.pp_addObject(),this.myVariableLabelText=this.myVariableLabelPanel.pp_addObject(),this.myVariableLabelCursorTarget=this.myVariableLabelPanel.pp_addObject(),this.myNextButtonPanel=this.myVariableLabelPanel.pp_addObject(),this.myNextButtonBackground=this.myNextButtonPanel.pp_addObject(),this.myNextButtonText=this.myNextButtonPanel.pp_addObject(),this.myNextButtonCursorTarget=this.myNextButtonPanel.pp_addObject(),this.myPreviousButtonPanel=this.myVariableLabelPanel.pp_addObject(),this.myPreviousButtonBackground=this.myPreviousButtonPanel.pp_addObject(),this.myPreviousButtonText=this.myPreviousButtonPanel.pp_addObject(),this.myPreviousButtonCursorTarget=this.myPreviousButtonPanel.pp_addObject(),this.myImportExportPanel=this.myPivotObject.pp_addObject(),this.myImportButtonPanel=this.myImportExportPanel.pp_addObject(),this.myImportButtonBackground=this.myImportButtonPanel.pp_addObject(),this.myImportButtonText=this.myImportButtonPanel.pp_addObject(),this.myImportButtonCursorTarget=this.myImportButtonPanel.pp_addObject(),this.myExportButtonPanel=this.myImportExportPanel.pp_addObject(),this.myExportButtonBackground=this.myExportButtonPanel.pp_addObject(),this.myExportButtonText=this.myExportButtonPanel.pp_addObject(),this.myExportButtonCursorTarget=this.myExportButtonPanel.pp_addObject(),this.myPointerCursorTarget=this.myPivotObject.pp_addObject(),this._createSkeletonHook()}_setTransforms(){this.myPivotObject.pp_setPositionLocal(this._myConfig.myPivotObjectPositions[this._myParams.myHandedness]),this.myBackPanel.pp_setPositionLocal(this._myConfig.myBackPanelPosition),this.myBackBackground.pp_scaleObject(this._myConfig.myBackBackgroundScale),this.myDisplayPanel.pp_setPositionLocal(this._myConfig.myDisplayPanelPosition),this.myVariableLabelPanel.pp_setPositionLocal(this._myConfig.myVariableLabelPanelPosition),this.myVariableLabelText.pp_scaleObject(this._myConfig.myVariableLabelTextScale),this.myVariableLabelCursorTarget.pp_setPositionLocal(this._myConfig.myVariableLabelCursorTargetPosition),this.myNextButtonPanel.pp_setPositionLocal(this._myConfig.myRightSideButtonPosition),this.myNextButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myNextButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myNextButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myNextButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myPreviousButtonPanel.pp_setPositionLocal(this._myConfig.myLeftSideButtonPosition),this.myPreviousButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myPreviousButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myPreviousButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myPreviousButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myImportExportPanel.pp_setPositionLocal(this._myConfig.myImportExportPanelPosition),this.myImportButtonPanel.pp_setPositionLocal(this._myConfig.myImportButtonPosition),this.myImportButtonBackground.pp_scaleObject(this._myConfig.myImportExportButtonBackgroundScale),this.myImportButtonText.pp_setPositionLocal(this._myConfig.myImportExportButtonTextPosition),this.myImportButtonText.pp_scaleObject(this._myConfig.myImportExportButtonTextScale),this.myImportButtonCursorTarget.pp_setPositionLocal(this._myConfig.myImportExportButtonCursorTargetPosition),this.myExportButtonPanel.pp_setPositionLocal(this._myConfig.myExportButtonPosition),this.myExportButtonBackground.pp_scaleObject(this._myConfig.myImportExportButtonBackgroundScale),this.myExportButtonText.pp_setPositionLocal(this._myConfig.myImportExportButtonTextPosition),this.myExportButtonText.pp_scaleObject(this._myConfig.myImportExportButtonTextScale),this.myExportButtonCursorTarget.pp_setPositionLocal(this._myConfig.myImportExportButtonCursorTargetPosition),this.myPointerCursorTarget.pp_setPositionLocal(this._myConfig.myPointerCursorTargetPosition),this._setTransformHook()}_addComponents(){this.myBackBackgroundComponent=this.myBackBackground.pp_addComponent(Ca),this.myBackBackgroundComponent.mesh=this._myPlaneMesh,this.myBackBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myBackBackgroundComponent.material.color=this._myConfig.myBackBackgroundColor,this.myVariableLabelTextComponent=this.myVariableLabelText.pp_addComponent(ba),this._setupTextComponent(this.myVariableLabelTextComponent),this.myVariableLabelTextComponent.text=" ",this.myVariableLabelCursorTargetComponent=this.myVariableLabelCursorTarget.pp_addComponent(Sa),this.myVariableLabelCollisionComponent=this.myVariableLabelCursorTarget.pp_addComponent(ts),this.myVariableLabelCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myVariableLabelCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myVariableLabelCollisionComponent.extents=this._myConfig.myVariableLabelCollisionExtents,this.myNextButtonBackgroundComponent=this.myNextButtonBackground.pp_addComponent(Ca),this.myNextButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myNextButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myNextButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myNextButtonTextComponent=this.myNextButtonText.pp_addComponent(ba),this._setupTextComponent(this.myNextButtonTextComponent),this.myNextButtonTextComponent.text=this._myConfig.myNextButtonText,this.myNextButtonCursorTargetComponent=this.myNextButtonCursorTarget.pp_addComponent(Sa),this.myNextButtonCollisionComponent=this.myNextButtonCursorTarget.pp_addComponent(ts),this.myNextButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myNextButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myNextButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myPreviousButtonBackgroundComponent=this.myPreviousButtonBackground.pp_addComponent(Ca),this.myPreviousButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPreviousButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myPreviousButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myPreviousButtonTextComponent=this.myPreviousButtonText.pp_addComponent(ba),this._setupTextComponent(this.myPreviousButtonTextComponent),this.myPreviousButtonTextComponent.text=this._myConfig.myPreviousButtonText,this.myPreviousButtonCursorTargetComponent=this.myPreviousButtonCursorTarget.pp_addComponent(Sa),this.myPreviousButtonCollisionComponent=this.myPreviousButtonCursorTarget.pp_addComponent(ts),this.myPreviousButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPreviousButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPreviousButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myImportButtonBackgroundComponent=this.myImportButtonBackground.pp_addComponent(Ca),this.myImportButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myImportButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myImportButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myImportButtonTextComponent=this.myImportButtonText.pp_addComponent(ba),this._setupTextComponent(this.myImportButtonTextComponent),this.myImportButtonTextComponent.text=this._myConfig.myImportButtonText,this.myImportButtonCursorTargetComponent=this.myImportButtonCursorTarget.pp_addComponent(Sa),this.myImportButtonCollisionComponent=this.myImportButtonCursorTarget.pp_addComponent(ts),this.myImportButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myImportButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myImportButtonCollisionComponent.extents=this._myConfig.myImportExportButtonCollisionExtents,this.myExportButtonBackgroundComponent=this.myExportButtonBackground.pp_addComponent(Ca),this.myExportButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myExportButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myExportButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myExportButtonTextComponent=this.myExportButtonText.pp_addComponent(ba),this._setupTextComponent(this.myExportButtonTextComponent),this.myExportButtonTextComponent.text=this._myConfig.myExportButtonText,this.myExportButtonCursorTargetComponent=this.myExportButtonCursorTarget.pp_addComponent(Sa),this.myExportButtonCollisionComponent=this.myExportButtonCursorTarget.pp_addComponent(ts),this.myExportButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myExportButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myExportButtonCollisionComponent.extents=this._myConfig.myImportExportButtonCollisionExtents,this.myPointerCollisionComponent=this.myPointerCursorTarget.pp_addComponent(ts),this.myPointerCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPointerCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPointerCollisionComponent.extents=this._myConfig.myPointerCollisionExtents,this._addComponentsHook()}_setupTextComponent(e){e.alignment=this._myConfig.myTextAlignment,e.justification=this._myConfig.myTextJustification,e.material=this._myParams.myTextMaterial.clone(),e.material.color=this._myConfig.myTextColor,e.text=""}_onXRSessionStart(){this._setTransformForXR()}_onXRSessionEnd(){this._setTransformForNonXR()}_setTransformForXR(){this.myPivotObject.pp_setPositionLocal(this._myConfig.myPivotObjectPositions[this._myParams.myHandedness])}_setTransformForNonXR(){this.myPivotObject.pp_setPositionLocal(this._myConfig.myPivotObjectPositions[U.NONE])}destroy(){this._myDestroyed=!0,I.unregisterSessionStartEndEventListeners(this,this._myEngine)}isDestroyed(){return this._myDestroyed}};var va=class extends qt{constructor(e){super(e)}setAdditionalButtonsVisible(e){this._myAdditionalButtonsVisible=e;for(let t=0;t<this._myConfig.myArraySize;t++)this.myValueIncreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible),this.myValueDecreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible)}_buildHook(){this._myAdditionalButtonsVisible=!0}_createSkeletonHook(){this.myValuesPanel=this.myDisplayPanel.pp_addObject(),this.myValuePanels=[],this.myValueTexts=[],this.myValueCursorTargets=[],this.myValueIncreaseButtonPanels=[],this.myValueIncreaseButtonBackgrounds=[],this.myValueIncreaseButtonTexts=[],this.myValueIncreaseButtonCursorTargets=[],this.myValueDecreaseButtonPanels=[],this.myValueDecreaseButtonBackgrounds=[],this.myValueDecreaseButtonTexts=[],this.myValueDecreaseButtonCursorTargets=[];for(let e=0;e<this._myConfig.myArraySize;e++)this.myValuePanels[e]=this.myValuesPanel.pp_addObject(),this.myValueTexts[e]=this.myValuePanels[e].pp_addObject(),this.myValueCursorTargets[e]=this.myValuePanels[e].pp_addObject(),this.myValueIncreaseButtonPanels[e]=this.myValuePanels[e].pp_addObject(),this.myValueIncreaseButtonBackgrounds[e]=this.myValueIncreaseButtonPanels[e].pp_addObject(),this.myValueIncreaseButtonTexts[e]=this.myValueIncreaseButtonPanels[e].pp_addObject(),this.myValueIncreaseButtonCursorTargets[e]=this.myValueIncreaseButtonPanels[e].pp_addObject(),this.myValueDecreaseButtonPanels[e]=this.myValuePanels[e].pp_addObject(),this.myValueDecreaseButtonBackgrounds[e]=this.myValueDecreaseButtonPanels[e].pp_addObject(),this.myValueDecreaseButtonTexts[e]=this.myValueDecreaseButtonPanels[e].pp_addObject(),this.myValueDecreaseButtonCursorTargets[e]=this.myValueDecreaseButtonPanels[e].pp_addObject()}_setTransformHook(){this.myValuesPanel.pp_setPositionLocal(this._myConfig.myValuesPanelPosition);for(let e=0;e<this._myConfig.myArraySize;e++)this.myValuePanels[e].pp_setPositionLocal(this._myConfig.myValuePanelsPositions[e]),this.myValueTexts[e].pp_scaleObject(this._myConfig.myValueTextScale),this.myValueCursorTargets[e].pp_setPositionLocal(this._myConfig.myValueCursorTargetPosition),this.myValueIncreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myRightSideButtonPosition),this.myValueIncreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myValueIncreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myValueIncreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myValueIncreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myValueDecreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myLeftSideButtonPosition),this.myValueDecreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myValueDecreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myValueDecreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myValueDecreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition)}_addComponentsHook(){this.myValueTextComponents=[],this.myValueCursorTargetComponents=[],this.myValueCollisionComponents=[],this.myValueIncreaseButtonBackgroundComponents=[],this.myValueIncreaseButtonTextComponents=[],this.myValueIncreaseButtonCursorTargetComponents=[],this.myValueIncreaseButtonCollisionComponents=[],this.myValueDecreaseButtonBackgroundComponents=[],this.myValueDecreaseButtonTextComponents=[],this.myValueDecreaseButtonCursorTargetComponents=[],this.myValueDecreaseButtonCollisionComponents=[];for(let e=0;e<this._myConfig.myArraySize;e++)this.myValueTextComponents[e]=this.myValueTexts[e].pp_addComponent(mm),this._setupTextComponent(this.myValueTextComponents[e]),this.myValueTextComponents[e].text=" ",this.myValueCursorTargetComponents[e]=this.myValueCursorTargets[e].pp_addComponent(ym),this.myValueCollisionComponents[e]=this.myValueCursorTargets[e].pp_addComponent(lm),this.myValueCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myValueCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myValueCollisionComponents[e].extents=this._myConfig.myValueCollisionExtents,this.myValueIncreaseButtonBackgroundComponents[e]=this.myValueIncreaseButtonBackgrounds[e].pp_addComponent(Db),this.myValueIncreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myValueIncreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myValueIncreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myValueIncreaseButtonTextComponents[e]=this.myValueIncreaseButtonTexts[e].pp_addComponent(mm),this._setupTextComponent(this.myValueIncreaseButtonTextComponents[e]),this.myValueIncreaseButtonTextComponents[e].text=this._myConfig.myIncreaseButtonText,this.myValueIncreaseButtonCursorTargetComponents[e]=this.myValueIncreaseButtonCursorTargets[e].pp_addComponent(ym),this.myValueIncreaseButtonCollisionComponents[e]=this.myValueIncreaseButtonCursorTargets[e].pp_addComponent(lm),this.myValueIncreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myValueIncreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myValueIncreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents,this.myValueDecreaseButtonBackgroundComponents[e]=this.myValueDecreaseButtonBackgrounds[e].pp_addComponent(Db),this.myValueDecreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myValueDecreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myValueDecreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myValueDecreaseButtonTextComponents[e]=this.myValueDecreaseButtonTexts[e].pp_addComponent(mm),this._setupTextComponent(this.myValueDecreaseButtonTextComponents[e]),this.myValueDecreaseButtonTextComponents[e].text=this._myConfig.myDecreaseButtonText,this.myValueDecreaseButtonCursorTargetComponents[e]=this.myValueDecreaseButtonCursorTargets[e].pp_addComponent(ym),this.myValueDecreaseButtonCollisionComponents[e]=this.myValueDecreaseButtonCursorTargets[e].pp_addComponent(lm),this.myValueDecreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myValueDecreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myValueDecreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents}_setVisibleHook(e){e&&this.setAdditionalButtonsVisible(this._myAdditionalButtonsVisible)}};var xa=class extends Ut{constructor(e,t,n,o=r.getMainEngine()){super(e),this._myNonArray=t==null,this._myArraySize=this._myNonArray?1:t,this._myConfig=new Pa(this._myArraySize),this._myUI=new va(o),this._myGamepad=n,this._myValueEditIndex=0,this._myValueButtonEditIntensity=0,this._myValueButtonEditIntensityTimer=0,this._myValueEditEnabled=!1,this._myTempValue=[],this._myTempNonArrayValue=[0],this._myTempNonArrayDefaultValue=[0]}_refreshUIHook(){for(let e=0;e<this._myArraySize;e++)this._myUI.myValueTextComponents[e].text=this._getVariableValue()[e]?"true":"false"}_startHook(e,t){this._myUI.setAdditionalButtonsVisible(t.myShowAdditionalButtons)}_setEasyTuneVariableHook(){this._myVariable!=null&&this._myTempValue.pp_copy(this._getVariableValue())}_updateHook(e){this._updateValue(e)}_updateValue(e){let t=0;this._myGamepad&&(t=this._myGamepad.getAxesInfo(oe.THUMBSTICK).myAxes[1]);let n=0;this._myValueEditEnabled?n=t:this._myValueButtonEditIntensity!=0&&(this._myValueButtonEditIntensityTimer<=0?n=this._myValueButtonEditIntensity:this._myValueButtonEditIntensityTimer-=e),this._myValueEditIndex>=0&&this._myValueEditIndex<this._getVariableValue().length&&Math.abs(n)>this._myConfig.myThumbstickToggleThreshold&&(this._myTempValue.pp_copy(this._getVariableValue()),this._myTempValue[this._myValueEditIndex]=n>0,this._setVariableValue(this._myTempValue),this._refreshUI())}_addListenersHook(){let e=this._myUI;e.myVariableLabelCursorTargetComponent.onClick.add(this._resetAllValues.bind(this)),e.myVariableLabelCursorTargetComponent.onHover.add(this._genericTextHover.bind(this,e.myVariableLabelText)),e.myVariableLabelCursorTargetComponent.onUnhover.add(this._genericTextUnhover.bind(this,e.myVariableLabelText,this._myConfig.myVariableLabelTextScale));for(let t=0;t<this._myArraySize;t++)e.myValueIncreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,t,1)),e.myValueIncreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,t,1)),e.myValueIncreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,t,0)),e.myValueIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,t,0)),e.myValueDecreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,t,-1)),e.myValueDecreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,t,-1)),e.myValueDecreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,t,0)),e.myValueDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,t,0)),e.myValueIncreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myValueIncreaseButtonBackgroundComponents[t].material)),e.myValueIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnhover.bind(this,e.myValueIncreaseButtonBackgroundComponents[t].material)),e.myValueDecreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myValueDecreaseButtonBackgroundComponents[t].material)),e.myValueDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnhover.bind(this,e.myValueDecreaseButtonBackgroundComponents[t].material)),e.myValueCursorTargetComponents[t].onClick.add(this._resetValue.bind(this,t)),e.myValueCursorTargetComponents[t].onHover.add(this._setValueEditEnabled.bind(this,t,e.myValueTexts[t],!0)),e.myValueCursorTargetComponents[t].onUnhover.add(this._setValueEditEnabled.bind(this,t,e.myValueTexts[t],!1))}_setValueEditIntensity(e,t){(this._isActive()||t==0)&&(t!=0&&(this._myValueButtonEditIntensityTimer=this._myConfig.myButtonEditDelay,this._myValueEditIndex=e),this._myValueButtonEditIntensity=t)}_setValueEditEnabled(e,t,n){(this._isActive()||!n)&&(n?(this._myValueEditIndex=e,t.pp_scaleObject(this._myConfig.myTextHoverScaleMultiplier)):t.pp_setScaleLocal(this._myConfig.myValueTextScale),this._myValueEditEnabled=n)}_resetValue(e){this._isActive()&&(this._myTempValue.pp_copy(this._getVariableValue()),this._myTempValue[e]=this._getVariableDefaultValue()[e],this._setVariableValue(this._myTempValue),this._myUI.myValueTextComponents[e].text=this._getVariableValue()[e]?"true":"false")}_resetAllValues(){for(let e=0;e<this._myArraySize;e++)this._resetValue(e)}_genericTextHover(e){e.pp_scaleObject(this._myConfig.myTextHoverScaleMultiplier)}_genericTextUnhover(e,t){e.pp_setScaleLocal(t)}_getVariableValue(){return this._myNonArray?(this._myTempNonArrayValue[0]=this._myVariable.getValue(),this._myTempNonArrayValue):this._myVariable.getValue()}_getVariableDefaultValue(){return this._myNonArray?(this._myTempNonArrayDefaultValue[0]=this._myVariable.getDefaultValue(),this._myTempNonArrayDefaultValue):this._myVariable.getDefaultValue()}_setVariableValue(e){this._myNonArray?this._myVariable.setValue(e[0]):this._myVariable.setValue(this._myTempValue)}};var Ma=class extends po{_getEasyTuneArrayWidget(e){return new xa(this._myParams,e,this._myGamepad,this._myEngine)}};var Da=class{constructor(){this._setupRuntimeConfig()}_setupRuntimeConfig(){this.myGamepadHandedness=U.RIGHT,this.myScrollVariableDelay=.5,this.myScrollVariableMinXThreshold=.6,this.myScrollVariableMaxYThreshold=.25,this.myScrollVariableButtonID=null,this.myRefreshVariablesDelay=null}};var Ea=class extends Qt{_getBackPanelMinY(){return super._getBackPanelMinY()+this.myTypeNotSupportedPanelPosition[1]}_getPivotZOffset(){return .00804713}_setupBuildConfigHook(){this.myTypeNotSupportedPanelPosition=c(0,-.03,this._myPanelZOffset),this.myTypeNotSupportedTextScale=c(.275,.275,.275),this.myTypeNotSupportedText="Type Not Supported"}};import{TextComponent as rO}from"@wonderlandengine/api";var Aa=class extends qt{constructor(e){super(e)}_createSkeletonHook(){this.myTypeNotSupportedPanel=this.myDisplayPanel.pp_addObject(),this.myTypeNotSupportedText=this.myTypeNotSupportedPanel.pp_addObject(),this.myTypeNotSupportedCursorTarget=this.myTypeNotSupportedPanel.pp_addObject()}_setTransformHook(){this.myTypeNotSupportedPanel.pp_setPositionLocal(this._myConfig.myTypeNotSupportedPanelPosition),this.myTypeNotSupportedText.pp_scaleObject(this._myConfig.myTypeNotSupportedTextScale)}_addComponentsHook(){this.myTypeNotSupportedTextComponent=this.myTypeNotSupportedText.pp_addComponent(rO),this._setupTextComponent(this.myTypeNotSupportedTextComponent),this.myTypeNotSupportedTextComponent.text=this._myConfig.myTypeNotSupportedText}};var Ra=class extends Ut{constructor(e,t=r.getMainEngine()){super(e),this._myConfig=new Ea,this._myUI=new Aa(t)}};var Oa=class extends Qt{constructor(e){super(),this.myArraySize=e}_getBackPanelMinY(){return this.myStepPanelPosition[1]-this._mySideButtonDistanceFromBorder*1.25-this.mySideButtonBackgroundScale[1]}_getPivotZOffset(){return .00803713}_setupBuildConfigHook(){this.myIncreaseButtonText="+",this.myDecreaseButtonText="-",this._myValuePanelDistanceFromVariableLabelPanel=.055,this._myDistanceBetweenValues=this.mySideButtonBackgroundScale[1]*2+.015,this.myValuesPanelPosition=[0,this.myVariableLabelPanelPosition[1]-this._myValuePanelDistanceFromVariableLabelPanel,this._myPanelZOffset],this.myValueTextScale=c(.4,.4,.4),this.myValueCursorTargetPosition=c(0,0,0),this.myValueCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myValueCollisionExtents=c(.065,.02,1),this.myValueCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myValuePanelsPositions=[],this.myValuePanelsPositions[0]=c(0,0,0);for(let t=1;t<this.myArraySize;t++)this.myValuePanelsPositions[t]=this.myValuePanelsPositions[t-1].pp_clone(),this.myValuePanelsPositions[t][1]-=this._myDistanceBetweenValues;let e=this.myValuePanelsPositions[this.myArraySize-1]?this.myValuePanelsPositions[this.myArraySize-1][1]:0;this.myStepPanelPosition=[0,this.myDisplayPanelPosition[1]+this.myValuesPanelPosition[1]+e-this._myValuePanelDistanceFromVariableLabelPanel,this._myPanelZOffset],this.myStepTextScale=this.myLabelTextScale,this.myStepStartString="Step: ",this.myStepCursorTargetPosition=c(0,0,0),this.myStepCursorTargetPosition[2]=this._myColliderZOffset-this.myStepPanelPosition[2],this.myStepCollisionExtents=c(.065,.0175,1),this.myStepCollisionExtents[2]=this.myCursorTargetCollisionThickness}_setupRuntimeConfigHook(){this.myTextHoverScaleMultiplier=c(1.1,1.1,1.1),this.myEditThumbstickMinThreshold=.35,this.myStepMultiplierStepPerSecond=2.25,this.myButtonEditDelay=0}};import{CollisionComponent as is,MeshComponent as Wr,TextComponent as ns}from"@wonderlandengine/api";import{CursorTarget as os}from"@wonderlandengine/components";var Va=class extends qt{constructor(e){super(e)}setAdditionalButtonsVisible(e){this._myAdditionalButtonsVisible=e;for(let t=0;t<this._myConfig.myArraySize;t++)this.myValueIncreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible),this.myValueDecreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible);this.myStepIncreaseButtonPanel.pp_setActive(this._myAdditionalButtonsVisible),this.myStepDecreaseButtonPanel.pp_setActive(this._myAdditionalButtonsVisible)}_buildHook(){this._myAdditionalButtonsVisible=!0}_createSkeletonHook(){this.myValuesPanel=this.myDisplayPanel.pp_addObject(),this.myValuePanels=[],this.myValueTexts=[],this.myValueCursorTargets=[],this.myValueIncreaseButtonPanels=[],this.myValueIncreaseButtonBackgrounds=[],this.myValueIncreaseButtonTexts=[],this.myValueIncreaseButtonCursorTargets=[],this.myValueDecreaseButtonPanels=[],this.myValueDecreaseButtonBackgrounds=[],this.myValueDecreaseButtonTexts=[],this.myValueDecreaseButtonCursorTargets=[];for(let e=0;e<this._myConfig.myArraySize;e++)this.myValuePanels[e]=this.myValuesPanel.pp_addObject(),this.myValueTexts[e]=this.myValuePanels[e].pp_addObject(),this.myValueCursorTargets[e]=this.myValuePanels[e].pp_addObject(),this.myValueIncreaseButtonPanels[e]=this.myValuePanels[e].pp_addObject(),this.myValueIncreaseButtonBackgrounds[e]=this.myValueIncreaseButtonPanels[e].pp_addObject(),this.myValueIncreaseButtonTexts[e]=this.myValueIncreaseButtonPanels[e].pp_addObject(),this.myValueIncreaseButtonCursorTargets[e]=this.myValueIncreaseButtonPanels[e].pp_addObject(),this.myValueDecreaseButtonPanels[e]=this.myValuePanels[e].pp_addObject(),this.myValueDecreaseButtonBackgrounds[e]=this.myValueDecreaseButtonPanels[e].pp_addObject(),this.myValueDecreaseButtonTexts[e]=this.myValueDecreaseButtonPanels[e].pp_addObject(),this.myValueDecreaseButtonCursorTargets[e]=this.myValueDecreaseButtonPanels[e].pp_addObject();this.myStepPanel=this.myPivotObject.pp_addObject(),this.myStepText=this.myStepPanel.pp_addObject(),this.myStepCursorTarget=this.myStepPanel.pp_addObject(),this.myStepIncreaseButtonPanel=this.myStepPanel.pp_addObject(),this.myStepIncreaseButtonBackground=this.myStepIncreaseButtonPanel.pp_addObject(),this.myStepIncreaseButtonText=this.myStepIncreaseButtonPanel.pp_addObject(),this.myStepIncreaseButtonCursorTarget=this.myStepIncreaseButtonPanel.pp_addObject(),this.myStepDecreaseButtonPanel=this.myStepPanel.pp_addObject(),this.myStepDecreaseButtonBackground=this.myStepDecreaseButtonPanel.pp_addObject(),this.myStepDecreaseButtonText=this.myStepDecreaseButtonPanel.pp_addObject(),this.myStepDecreaseButtonCursorTarget=this.myStepDecreaseButtonPanel.pp_addObject()}_setTransformHook(){this.myValuesPanel.pp_setPositionLocal(this._myConfig.myValuesPanelPosition);for(let e=0;e<this._myConfig.myArraySize;e++)this.myValuePanels[e].pp_setPositionLocal(this._myConfig.myValuePanelsPositions[e]),this.myValueTexts[e].pp_scaleObject(this._myConfig.myValueTextScale),this.myValueCursorTargets[e].pp_setPositionLocal(this._myConfig.myValueCursorTargetPosition),this.myValueIncreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myRightSideButtonPosition),this.myValueIncreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myValueIncreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myValueIncreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myValueIncreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myValueDecreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myLeftSideButtonPosition),this.myValueDecreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myValueDecreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myValueDecreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myValueDecreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition);this.myStepPanel.pp_setPositionLocal(this._myConfig.myStepPanelPosition),this.myStepText.pp_scaleObject(this._myConfig.myStepTextScale),this.myStepCursorTarget.pp_setPositionLocal(this._myConfig.myStepCursorTargetPosition),this.myStepIncreaseButtonPanel.pp_setPositionLocal(this._myConfig.myRightSideButtonPosition),this.myStepIncreaseButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myStepIncreaseButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myStepIncreaseButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myStepIncreaseButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myStepDecreaseButtonPanel.pp_setPositionLocal(this._myConfig.myLeftSideButtonPosition),this.myStepDecreaseButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myStepDecreaseButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myStepDecreaseButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myStepDecreaseButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition)}_addComponentsHook(){this.myValueTextComponents=[],this.myValueCursorTargetComponents=[],this.myValueCollisionComponents=[],this.myValueIncreaseButtonBackgroundComponents=[],this.myValueIncreaseButtonTextComponents=[],this.myValueIncreaseButtonCursorTargetComponents=[],this.myValueIncreaseButtonCollisionComponents=[],this.myValueDecreaseButtonBackgroundComponents=[],this.myValueDecreaseButtonTextComponents=[],this.myValueDecreaseButtonCursorTargetComponents=[],this.myValueDecreaseButtonCollisionComponents=[];for(let e=0;e<this._myConfig.myArraySize;e++)this.myValueTextComponents[e]=this.myValueTexts[e].pp_addComponent(ns),this._setupTextComponent(this.myValueTextComponents[e]),this.myValueTextComponents[e].text=" ",this.myValueCursorTargetComponents[e]=this.myValueCursorTargets[e].pp_addComponent(os),this.myValueCollisionComponents[e]=this.myValueCursorTargets[e].pp_addComponent(is),this.myValueCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myValueCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myValueCollisionComponents[e].extents=this._myConfig.myValueCollisionExtents,this.myValueIncreaseButtonBackgroundComponents[e]=this.myValueIncreaseButtonBackgrounds[e].pp_addComponent(Wr),this.myValueIncreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myValueIncreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myValueIncreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myValueIncreaseButtonTextComponents[e]=this.myValueIncreaseButtonTexts[e].pp_addComponent(ns),this._setupTextComponent(this.myValueIncreaseButtonTextComponents[e]),this.myValueIncreaseButtonTextComponents[e].text=this._myConfig.myIncreaseButtonText,this.myValueIncreaseButtonCursorTargetComponents[e]=this.myValueIncreaseButtonCursorTargets[e].pp_addComponent(os),this.myValueIncreaseButtonCollisionComponents[e]=this.myValueIncreaseButtonCursorTargets[e].pp_addComponent(is),this.myValueIncreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myValueIncreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myValueIncreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents,this.myValueDecreaseButtonBackgroundComponents[e]=this.myValueDecreaseButtonBackgrounds[e].pp_addComponent(Wr),this.myValueDecreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myValueDecreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myValueDecreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myValueDecreaseButtonTextComponents[e]=this.myValueDecreaseButtonTexts[e].pp_addComponent(ns),this._setupTextComponent(this.myValueDecreaseButtonTextComponents[e]),this.myValueDecreaseButtonTextComponents[e].text=this._myConfig.myDecreaseButtonText,this.myValueDecreaseButtonCursorTargetComponents[e]=this.myValueDecreaseButtonCursorTargets[e].pp_addComponent(os),this.myValueDecreaseButtonCollisionComponents[e]=this.myValueDecreaseButtonCursorTargets[e].pp_addComponent(is),this.myValueDecreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myValueDecreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myValueDecreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents;this.myStepTextComponent=this.myStepText.pp_addComponent(ns),this._setupTextComponent(this.myStepTextComponent),this.myStepTextComponent.text=" ",this.myStepCursorTargetComponent=this.myStepCursorTarget.pp_addComponent(os),this.myStepCollisionComponent=this.myStepCursorTarget.pp_addComponent(is),this.myStepCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myStepCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myStepCollisionComponent.extents=this._myConfig.myStepCollisionExtents,this.myStepIncreaseButtonBackgroundComponent=this.myStepIncreaseButtonBackground.pp_addComponent(Wr),this.myStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myStepIncreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myStepIncreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myStepIncreaseButtonTextComponent=this.myStepIncreaseButtonText.pp_addComponent(ns),this._setupTextComponent(this.myStepIncreaseButtonTextComponent),this.myStepIncreaseButtonTextComponent.text=this._myConfig.myIncreaseButtonText,this.myStepIncreaseButtonCursorTargetComponent=this.myStepIncreaseButtonCursorTarget.pp_addComponent(os),this.myStepIncreaseButtonCollisionComponent=this.myStepIncreaseButtonCursorTarget.pp_addComponent(is),this.myStepIncreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myStepIncreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myStepIncreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myStepDecreaseButtonBackgroundComponent=this.myStepDecreaseButtonBackground.pp_addComponent(Wr),this.myStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myStepDecreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myStepDecreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myStepDecreaseButtonTextComponent=this.myStepDecreaseButtonText.pp_addComponent(ns),this._setupTextComponent(this.myStepDecreaseButtonTextComponent),this.myStepDecreaseButtonTextComponent.text=this._myConfig.myDecreaseButtonText,this.myStepDecreaseButtonCursorTargetComponent=this.myStepDecreaseButtonCursorTarget.pp_addComponent(os),this.myStepDecreaseButtonCollisionComponent=this.myStepDecreaseButtonCursorTarget.pp_addComponent(is),this.myStepDecreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myStepDecreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myStepDecreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents}_setVisibleHook(e){e&&this.setAdditionalButtonsVisible(this._myAdditionalButtonsVisible)}};var Ia=class extends Ut{constructor(e,t,n,o=r.getMainEngine()){super(e),this._myGamepad=n,this._myNonArray=t==null,this._myArraySize=this._myNonArray?1:t,this._myConfig=new Oa(this._myArraySize),this._myUI=new Va(o),this._myValueEditIndex=-1,this._myValueButtonEditIntensity=0,this._myValueButtonEditIntensityTimer=0,this._myStepButtonEditIntensity=0,this._myStepButtonEditIntensityTimer=0,this._myValueEditEnabled=!1,this._myStepEditEnabled=!1,this._myValueRealValue=0,this._myStepMultiplierValue=0,this._myStepFastEdit=!1,this._myTempValue=[],this._myTempNonArrayValue=[0],this._myTempNonArrayDefaultValue=[0]}_refreshUIHook(){for(let e=0;e<this._myArraySize;e++)this._myUI.myValueTextComponents[e].text=this._getVariableValue()[e].toFixed(this._myVariable._myDecimalPlaces);this._myUI.myStepTextComponent.text=this._myConfig.myStepStartString.concat(this._myVariable._myStepPerSecond)}_startHook(e,t){this._myUI.setAdditionalButtonsVisible(t.myShowAdditionalButtons)}_setEasyTuneVariableHook(){this._myVariable!=null&&this._myTempValue.pp_copy(this._getVariableValue())}_updateHook(e){this._updateValue(e)}_updateValue(e){let t=0;if(this._myGamepad){let s=this._myGamepad.getAxesInfo(oe.THUMBSTICK).myAxes[1];if(Math.abs(s)>this._myConfig.myEditThumbstickMinThreshold){let a=(Math.abs(s)-this._myConfig.myEditThumbstickMinThreshold)/(1-this._myConfig.myEditThumbstickMinThreshold);t=Math.sign(s)*a}}let n=0;if(this._myValueEditEnabled?n=t:this._myValueButtonEditIntensity!=0&&(this._myValueButtonEditIntensityTimer<=0?n=this._myValueButtonEditIntensity:this._myValueButtonEditIntensityTimer-=e),this._myValueEditIndex>=0&&this._myValueEditIndex<this._getVariableValue().length)if(n!=0){let s=n*this._myVariable._myStepPerSecond*e;this._myValueRealValue+=s,this._myVariable._myMin!=null&&this._myVariable._myMax!=null?this._myValueRealValue=Math.pp_clamp(this._myValueRealValue,this._myVariable._myMin,this._myVariable._myMax):this._myVariable._myMin!=null?this._myValueRealValue=Math.max(this._myValueRealValue,this._myVariable._myMin):this._myVariable._myMax!=null&&(this._myValueRealValue=Math.min(this._myValueRealValue,this._myVariable._myMax));let a=Math.pow(10,this._myVariable._myDecimalPlaces);if(this._myTempValue.pp_copy(this._getVariableValue()),this._myVariable._myEditAllValuesTogether){let u=Math.round(this._myValueRealValue*a+Number.EPSILON)/a-this._myTempValue[this._myValueEditIndex];for(let _=0;_<this._myArraySize;_++)this._myTempValue[_]=Math.round((this._myTempValue[_]+u)*a+Number.EPSILON)/a,this._myVariable._myMin!=null&&this._myVariable._myMax!=null?this._myTempValue[_]=Math.pp_clamp(this._myTempValue[_],this._myVariable._myMin,this._myVariable._myMax):this._myVariable._myMin!=null?this._myTempValue[_]=Math.max(this._myTempValue[_],this._myVariable._myMin):this._myVariable._myMax!=null&&(this._myTempValue[_]=Math.min(this._myTempValue[_],this._myVariable._myMax)),this._myUI.myValueTextComponents[_].text=this._myTempValue[_].toFixed(this._myVariable._myDecimalPlaces)}else this._myTempValue[this._myValueEditIndex]=Math.round(this._myValueRealValue*a+Number.EPSILON)/a,this._myVariable._myMin!=null&&this._myVariable._myMax!=null?this._myTempValue[this._myValueEditIndex]=Math.pp_clamp(this._myTempValue[this._myValueEditIndex],this._myVariable._myMin,this._myVariable._myMax):this._myVariable._myMin!=null?this._myTempValue[this._myValueEditIndex]=Math.max(this._myTempValue[this._myValueEditIndex],this._myVariable._myMin):this._myVariable._myMax!=null&&(this._myTempValue[this._myValueEditIndex]=Math.min(this._myTempValue[this._myValueEditIndex],this._myVariable._myMax)),this._myUI.myValueTextComponents[this._myValueEditIndex].text=this._myTempValue[this._myValueEditIndex].toFixed(this._myVariable._myDecimalPlaces);this._setVariableValue(this._myTempValue)}else this._myValueRealValue=this._getVariableValue()[this._myValueEditIndex];let o=0;if(this._myStepEditEnabled?o=t:this._myStepButtonEditIntensity!=0&&(this._myStepButtonEditIntensityTimer<=0?o=this._myStepButtonEditIntensity:this._myStepButtonEditIntensityTimer-=e),o!=0){let s=0;this._myStepFastEdit?(s=Math.sign(o)*1,this._myStepFastEdit=!1):s=o*this._myConfig.myStepMultiplierStepPerSecond*e,this._myStepMultiplierValue+=s,Math.abs(this._myStepMultiplierValue)>=1&&(Math.sign(this._myStepMultiplierValue)>0?(this._myStepMultiplierValue-=1,this._changeStep(this._myVariable._myStepPerSecond*10)):(this._myStepMultiplierValue+=1,this._changeStep(this._myVariable._myStepPerSecond*.1)))}else this._myStepMultiplierValue=0,this._myStepFastEdit=!0}_addListenersHook(){let e=this._myUI;e.myVariableLabelCursorTargetComponent.onClick.add(this._resetAllValues.bind(this)),e.myVariableLabelCursorTargetComponent.onHover.add(this._genericTextHover.bind(this,e.myVariableLabelText)),e.myVariableLabelCursorTargetComponent.onUnhover.add(this._genericTextUnhover.bind(this,e.myVariableLabelText,this._myConfig.myVariableLabelTextScale));for(let t=0;t<this._myArraySize;t++)e.myValueIncreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,t,1)),e.myValueIncreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,t,1)),e.myValueIncreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,t,0)),e.myValueIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,t,0)),e.myValueDecreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,t,-1)),e.myValueDecreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,t,-1)),e.myValueDecreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,t,0)),e.myValueDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,t,0)),e.myValueIncreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myValueIncreaseButtonBackgroundComponents[t].material)),e.myValueIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnhover.bind(this,e.myValueIncreaseButtonBackgroundComponents[t].material)),e.myValueDecreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myValueDecreaseButtonBackgroundComponents[t].material)),e.myValueDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnhover.bind(this,e.myValueDecreaseButtonBackgroundComponents[t].material)),e.myValueCursorTargetComponents[t].onClick.add(this._resetValue.bind(this,t)),e.myValueCursorTargetComponents[t].onHover.add(this._setValueEditEnabled.bind(this,t,e.myValueTexts[t],!0)),e.myValueCursorTargetComponents[t].onUnhover.add(this._setValueEditEnabled.bind(this,t,e.myValueTexts[t],!1));e.myStepCursorTargetComponent.onClick.add(this._resetStep.bind(this)),e.myStepCursorTargetComponent.onHover.add(this._setStepEditEnabled.bind(this,e.myStepText,!0)),e.myStepCursorTargetComponent.onUnhover.add(this._setStepEditEnabled.bind(this,e.myStepText,!1)),e.myStepIncreaseButtonCursorTargetComponent.onDown.add(this._setStepEditIntensity.bind(this,1)),e.myStepIncreaseButtonCursorTargetComponent.onDownOnHover.add(this._setStepEditIntensity.bind(this,1)),e.myStepIncreaseButtonCursorTargetComponent.onUp.add(this._setStepEditIntensity.bind(this,0)),e.myStepIncreaseButtonCursorTargetComponent.onUnhover.add(this._setStepEditIntensity.bind(this,0)),e.myStepDecreaseButtonCursorTargetComponent.onDown.add(this._setStepEditIntensity.bind(this,-1)),e.myStepDecreaseButtonCursorTargetComponent.onDownOnHover.add(this._setStepEditIntensity.bind(this,-1)),e.myStepDecreaseButtonCursorTargetComponent.onUp.add(this._setStepEditIntensity.bind(this,0)),e.myStepDecreaseButtonCursorTargetComponent.onUnhover.add(this._setStepEditIntensity.bind(this,0)),e.myStepIncreaseButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myStepIncreaseButtonBackgroundComponent.material)),e.myStepIncreaseButtonCursorTargetComponent.onUnhover.add(this._genericUnhover.bind(this,e.myStepIncreaseButtonBackgroundComponent.material)),e.myStepDecreaseButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myStepDecreaseButtonBackgroundComponent.material)),e.myStepDecreaseButtonCursorTargetComponent.onUnhover.add(this._genericUnhover.bind(this,e.myStepDecreaseButtonBackgroundComponent.material))}_setValueEditIntensity(e,t){(this._isActive()||t==0)&&(t!=0&&(this._myValueButtonEditIntensityTimer=this._myConfig.myButtonEditDelay,this._myValueRealValue=this._getVariableValue()[e],this._myValueEditIndex=e),this._myValueButtonEditIntensity=t)}_setStepEditIntensity(e){(this._isActive()||e==0)&&(e!=0&&(this._myStepButtonEditIntensityTimer=this._myConfig.myButtonEditDelay),this._myStepButtonEditIntensity=e)}_setValueEditEnabled(e,t,n){(this._isActive()||!n)&&(n?(this._myValueRealValue=this._getVariableValue()[e],this._myValueEditIndex=e,t.pp_scaleObject(this._myConfig.myTextHoverScaleMultiplier)):t.pp_setScaleLocal(this._myConfig.myValueTextScale),this._myValueEditEnabled=n)}_setStepEditEnabled(e,t){(this._isActive()||!t)&&(t?e.pp_scaleObject(this._myConfig.myTextHoverScaleMultiplier):e.pp_setScaleLocal(this._myConfig.myStepTextScale),this._myStepEditEnabled=t)}_resetValue(e){this._isActive()&&(this._myTempValue.pp_copy(this._getVariableValue()),this._myTempValue[e]=this._getVariableDefaultValue()[e],this._setVariableValue(this._myTempValue),this._myUI.myValueTextComponents[e].text=this._getVariableValue()[e].toFixed(this._myVariable._myDecimalPlaces))}_resetAllValues(){for(let e=0;e<this._myArraySize;e++)this._resetValue(e)}_resetStep(){this._isActive()&&this._changeStep(this._myVariable._myDefaultStepPerSecond)}_changeStep(e){e=Math.pp_roundDecimal(e,10),this._myVariable._myStepPerSecond=e,this._myUI.myStepTextComponent.text=this._myConfig.myStepStartString.concat(this._myVariable._myStepPerSecond)}_genericTextHover(e){e.pp_scaleObject(this._myConfig.myTextHoverScaleMultiplier)}_genericTextUnhover(e,t){e.pp_setScaleLocal(t)}_getVariableValue(){return this._myNonArray?(this._myTempNonArrayValue[0]=this._myVariable.getValue(),this._myTempNonArrayValue):this._myVariable.getValue()}_getVariableDefaultValue(){return this._myNonArray?(this._myTempNonArrayDefaultValue[0]=this._myVariable.getDefaultValue(),this._myTempNonArrayDefaultValue):this._myVariable.getDefaultValue()}_setVariableValue(e){this._myNonArray?this._myVariable.setValue(e[0]):this._myVariable.setValue(this._myTempValue)}};var Ba=class extends po{_getEasyTuneArrayWidget(e){return new Ia(this._myParams,e,this._myGamepad,this._myEngine)}};var La=class extends Qt{_getBackPanelMinY(){return super._getBackPanelMinY()+this.myPositionPanelPosition[1]+this.myStepPanelPosition[1]}_getBackPanelMaxX(){return this.myDisplayPanelPosition[0]+this.myRotationPanelPosition[0]+this.myIncreaseButtonPosition[0]+this.mySideButtonBackgroundScale[0]+this._mySideButtonDistanceFromBorder}_getBackPanelMinX(){return this.myDisplayPanelPosition[0]+this.myScalePanelPosition[0]+this.myDecreaseButtonPosition[0]-this.mySideButtonBackgroundScale[0]-this._mySideButtonDistanceFromBorder}_getPivotZOffset(){return .00805713}_setupBuildConfigHook(){this.myIncreaseButtonText="+",this.myDecreaseButtonText="-",this.myDecreaseButtonPosition=c(-.13,0,-1e-5),this.myIncreaseButtonPosition=c(-this.myDecreaseButtonPosition[0],0,-1e-5);let e=Math.abs(this.myIncreaseButtonPosition[0])+Math.abs(this.myRightSideButtonPosition[0]),t=.045;this.myPositionPanelPosition=[0,this.myVariableLabelPanelPosition[1]-t,this._myPanelZOffset],this.myRotationPanelPosition=[this.myPositionPanelPosition[0]+e,this.myVariableLabelPanelPosition[1]-t,this._myPanelZOffset],this.myScalePanelPosition=[this.myPositionPanelPosition[0]-e,this.myVariableLabelPanelPosition[1]-t,this._myPanelZOffset],this.myPositionText="Position",this.myRotationText="Rotation",this.myScaleText="Scale",this.myComponentLabelTextScale=this.myLabelTextScale,this.myComponentLabelCursorTargetPosition=c(0,0,0),this.myComponentLabelCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myComponentLabelCollisionExtents=c(.065,.0175,1),this.myComponentLabelCollisionExtents[2]=this.myCursorTargetCollisionThickness,this._myValuePanelDistanceFromVariableLabelPanel=.055,this._myDistanceBetweenValues=this.mySideButtonBackgroundScale[1]*2+.015,this.myValueTextScale=c(.4,.4,.4),this.myValueCursorTargetPosition=c(0,0,0),this.myValueCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myValueCollisionExtents=c(.065,.02,1),this.myValueCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myValuePanelsPositions=[],this.myValuePanelsPositions[0]=c(0,-this._myValuePanelDistanceFromVariableLabelPanel,0);for(let o=1;o<3;o++)this.myValuePanelsPositions[o]=this.myValuePanelsPositions[o-1].pp_clone(),this.myValuePanelsPositions[o][1]-=this._myDistanceBetweenValues;let n=this.myValuePanelsPositions[2][1];this.myStepPanelPosition=[0,n-this._myValuePanelDistanceFromVariableLabelPanel,0],this.myStepTextScale=this.myLabelTextScale,this.myStepStartString="Step: ",this.myStepCursorTargetPosition=c(0,0,0),this.myStepCursorTargetPosition[2]=this._myColliderZOffset-this.myStepPanelPosition[2],this.myStepCollisionExtents=c(.065,.0175,1),this.myStepCollisionExtents[2]=this.myCursorTargetCollisionThickness}_setupRuntimeConfigHook(){this.myTextHoverScaleMultiplier=c(1.1,1.1,1.1),this.myEditThumbstickMinThreshold=.35,this.myStepMultiplierStepPerSecond=2.25,this.myButtonEditDelay=0}};import{CollisionComponent as ge,MeshComponent as Ke,TextComponent as fe}from"@wonderlandengine/api";import{CursorTarget as Te}from"@wonderlandengine/components";var Ha=class extends qt{constructor(e){super(e)}setAdditionalButtonsVisible(e){this._myAdditionalButtonsVisible=e;for(let t=0;t<3;t++)this.myPositionIncreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible),this.myPositionDecreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible);this.myPositionStepIncreaseButtonPanel.pp_setActive(this._myAdditionalButtonsVisible),this.myPositionStepDecreaseButtonPanel.pp_setActive(this._myAdditionalButtonsVisible);for(let t=0;t<3;t++)this.myRotationIncreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible),this.myRotationDecreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible);this.myRotationStepIncreaseButtonPanel.pp_setActive(this._myAdditionalButtonsVisible),this.myRotationStepDecreaseButtonPanel.pp_setActive(this._myAdditionalButtonsVisible);for(let t=0;t<3;t++)this.myScaleIncreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible),this.myScaleDecreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible);this.myScaleStepIncreaseButtonPanel.pp_setActive(this._myAdditionalButtonsVisible),this.myScaleStepDecreaseButtonPanel.pp_setActive(this._myAdditionalButtonsVisible)}_buildHook(){this._myAdditionalButtonsVisible=!0}_createSkeletonHook(){this.myPositionPanel=this.myDisplayPanel.pp_addObject(),this.myPositionLabelText=this.myPositionPanel.pp_addObject(),this.myPositionLabelCursorTarget=this.myPositionPanel.pp_addObject(),this.myPositionPanels=[],this.myPositionTexts=[],this.myPositionCursorTargets=[],this.myPositionIncreaseButtonPanels=[],this.myPositionIncreaseButtonBackgrounds=[],this.myPositionIncreaseButtonTexts=[],this.myPositionIncreaseButtonCursorTargets=[],this.myPositionDecreaseButtonPanels=[],this.myPositionDecreaseButtonBackgrounds=[],this.myPositionDecreaseButtonTexts=[],this.myPositionDecreaseButtonCursorTargets=[];for(let e=0;e<3;e++)this.myPositionPanels[e]=this.myPositionPanel.pp_addObject(),this.myPositionTexts[e]=this.myPositionPanels[e].pp_addObject(),this.myPositionCursorTargets[e]=this.myPositionPanels[e].pp_addObject(),this.myPositionIncreaseButtonPanels[e]=this.myPositionPanels[e].pp_addObject(),this.myPositionIncreaseButtonBackgrounds[e]=this.myPositionIncreaseButtonPanels[e].pp_addObject(),this.myPositionIncreaseButtonTexts[e]=this.myPositionIncreaseButtonPanels[e].pp_addObject(),this.myPositionIncreaseButtonCursorTargets[e]=this.myPositionIncreaseButtonPanels[e].pp_addObject(),this.myPositionDecreaseButtonPanels[e]=this.myPositionPanels[e].pp_addObject(),this.myPositionDecreaseButtonBackgrounds[e]=this.myPositionDecreaseButtonPanels[e].pp_addObject(),this.myPositionDecreaseButtonTexts[e]=this.myPositionDecreaseButtonPanels[e].pp_addObject(),this.myPositionDecreaseButtonCursorTargets[e]=this.myPositionDecreaseButtonPanels[e].pp_addObject();this.myRotationPanel=this.myDisplayPanel.pp_addObject(),this.myRotationLabelText=this.myRotationPanel.pp_addObject(),this.myRotationLabelCursorTarget=this.myRotationPanel.pp_addObject(),this.myRotationPanels=[],this.myRotationTexts=[],this.myRotationCursorTargets=[],this.myRotationIncreaseButtonPanels=[],this.myRotationIncreaseButtonBackgrounds=[],this.myRotationIncreaseButtonTexts=[],this.myRotationIncreaseButtonCursorTargets=[],this.myRotationDecreaseButtonPanels=[],this.myRotationDecreaseButtonBackgrounds=[],this.myRotationDecreaseButtonTexts=[],this.myRotationDecreaseButtonCursorTargets=[];for(let e=0;e<3;e++)this.myRotationPanels[e]=this.myRotationPanel.pp_addObject(),this.myRotationTexts[e]=this.myRotationPanels[e].pp_addObject(),this.myRotationCursorTargets[e]=this.myRotationPanels[e].pp_addObject(),this.myRotationIncreaseButtonPanels[e]=this.myRotationPanels[e].pp_addObject(),this.myRotationIncreaseButtonBackgrounds[e]=this.myRotationIncreaseButtonPanels[e].pp_addObject(),this.myRotationIncreaseButtonTexts[e]=this.myRotationIncreaseButtonPanels[e].pp_addObject(),this.myRotationIncreaseButtonCursorTargets[e]=this.myRotationIncreaseButtonPanels[e].pp_addObject(),this.myRotationDecreaseButtonPanels[e]=this.myRotationPanels[e].pp_addObject(),this.myRotationDecreaseButtonBackgrounds[e]=this.myRotationDecreaseButtonPanels[e].pp_addObject(),this.myRotationDecreaseButtonTexts[e]=this.myRotationDecreaseButtonPanels[e].pp_addObject(),this.myRotationDecreaseButtonCursorTargets[e]=this.myRotationDecreaseButtonPanels[e].pp_addObject();this.myScalePanel=this.myDisplayPanel.pp_addObject(),this.myScaleLabelText=this.myScalePanel.pp_addObject(),this.myScaleLabelCursorTarget=this.myScalePanel.pp_addObject(),this.myScalePanels=[],this.myScaleTexts=[],this.myScaleCursorTargets=[],this.myScaleIncreaseButtonPanels=[],this.myScaleIncreaseButtonBackgrounds=[],this.myScaleIncreaseButtonTexts=[],this.myScaleIncreaseButtonCursorTargets=[],this.myScaleDecreaseButtonPanels=[],this.myScaleDecreaseButtonBackgrounds=[],this.myScaleDecreaseButtonTexts=[],this.myScaleDecreaseButtonCursorTargets=[];for(let e=0;e<3;e++)this.myScalePanels[e]=this.myScalePanel.pp_addObject(),this.myScaleTexts[e]=this.myScalePanels[e].pp_addObject(),this.myScaleCursorTargets[e]=this.myScalePanels[e].pp_addObject(),this.myScaleIncreaseButtonPanels[e]=this.myScalePanels[e].pp_addObject(),this.myScaleIncreaseButtonBackgrounds[e]=this.myScaleIncreaseButtonPanels[e].pp_addObject(),this.myScaleIncreaseButtonTexts[e]=this.myScaleIncreaseButtonPanels[e].pp_addObject(),this.myScaleIncreaseButtonCursorTargets[e]=this.myScaleIncreaseButtonPanels[e].pp_addObject(),this.myScaleDecreaseButtonPanels[e]=this.myScalePanels[e].pp_addObject(),this.myScaleDecreaseButtonBackgrounds[e]=this.myScaleDecreaseButtonPanels[e].pp_addObject(),this.myScaleDecreaseButtonTexts[e]=this.myScaleDecreaseButtonPanels[e].pp_addObject(),this.myScaleDecreaseButtonCursorTargets[e]=this.myScaleDecreaseButtonPanels[e].pp_addObject();this.myPositionStepPanel=this.myPositionPanel.pp_addObject(),this.myPositionStepText=this.myPositionStepPanel.pp_addObject(),this.myPositionStepCursorTarget=this.myPositionStepPanel.pp_addObject(),this.myPositionStepIncreaseButtonPanel=this.myPositionStepPanel.pp_addObject(),this.myPositionStepIncreaseButtonBackground=this.myPositionStepIncreaseButtonPanel.pp_addObject(),this.myPositionStepIncreaseButtonText=this.myPositionStepIncreaseButtonPanel.pp_addObject(),this.myPositionStepIncreaseButtonCursorTarget=this.myPositionStepIncreaseButtonPanel.pp_addObject(),this.myPositionStepDecreaseButtonPanel=this.myPositionStepPanel.pp_addObject(),this.myPositionStepDecreaseButtonBackground=this.myPositionStepDecreaseButtonPanel.pp_addObject(),this.myPositionStepDecreaseButtonText=this.myPositionStepDecreaseButtonPanel.pp_addObject(),this.myPositionStepDecreaseButtonCursorTarget=this.myPositionStepDecreaseButtonPanel.pp_addObject(),this.myRotationStepPanel=this.myRotationPanel.pp_addObject(),this.myRotationStepText=this.myRotationStepPanel.pp_addObject(),this.myRotationStepCursorTarget=this.myRotationStepPanel.pp_addObject(),this.myRotationStepIncreaseButtonPanel=this.myRotationStepPanel.pp_addObject(),this.myRotationStepIncreaseButtonBackground=this.myRotationStepIncreaseButtonPanel.pp_addObject(),this.myRotationStepIncreaseButtonText=this.myRotationStepIncreaseButtonPanel.pp_addObject(),this.myRotationStepIncreaseButtonCursorTarget=this.myRotationStepIncreaseButtonPanel.pp_addObject(),this.myRotationStepDecreaseButtonPanel=this.myRotationStepPanel.pp_addObject(),this.myRotationStepDecreaseButtonBackground=this.myRotationStepDecreaseButtonPanel.pp_addObject(),this.myRotationStepDecreaseButtonText=this.myRotationStepDecreaseButtonPanel.pp_addObject(),this.myRotationStepDecreaseButtonCursorTarget=this.myRotationStepDecreaseButtonPanel.pp_addObject(),this.myScaleStepPanel=this.myScalePanel.pp_addObject(),this.myScaleStepText=this.myScaleStepPanel.pp_addObject(),this.myScaleStepCursorTarget=this.myScaleStepPanel.pp_addObject(),this.myScaleStepIncreaseButtonPanel=this.myScaleStepPanel.pp_addObject(),this.myScaleStepIncreaseButtonBackground=this.myScaleStepIncreaseButtonPanel.pp_addObject(),this.myScaleStepIncreaseButtonText=this.myScaleStepIncreaseButtonPanel.pp_addObject(),this.myScaleStepIncreaseButtonCursorTarget=this.myScaleStepIncreaseButtonPanel.pp_addObject(),this.myScaleStepDecreaseButtonPanel=this.myScaleStepPanel.pp_addObject(),this.myScaleStepDecreaseButtonBackground=this.myScaleStepDecreaseButtonPanel.pp_addObject(),this.myScaleStepDecreaseButtonText=this.myScaleStepDecreaseButtonPanel.pp_addObject(),this.myScaleStepDecreaseButtonCursorTarget=this.myScaleStepDecreaseButtonPanel.pp_addObject()}_setTransformHook(){this.myPositionPanel.pp_setPositionLocal(this._myConfig.myPositionPanelPosition),this.myPositionLabelText.pp_scaleObject(this._myConfig.myComponentLabelTextScale),this.myPositionLabelCursorTarget.pp_setPositionLocal(this._myConfig.myComponentLabelCursorTargetPosition);for(let e=0;e<3;e++)this.myPositionPanels[e].pp_setPositionLocal(this._myConfig.myValuePanelsPositions[e]),this.myPositionTexts[e].pp_scaleObject(this._myConfig.myValueTextScale),this.myPositionCursorTargets[e].pp_setPositionLocal(this._myConfig.myValueCursorTargetPosition),this.myPositionIncreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myIncreaseButtonPosition),this.myPositionIncreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myPositionIncreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myPositionIncreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myPositionIncreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myPositionDecreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myDecreaseButtonPosition),this.myPositionDecreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myPositionDecreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myPositionDecreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myPositionDecreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition);this.myRotationPanel.pp_setPositionLocal(this._myConfig.myRotationPanelPosition),this.myRotationLabelText.pp_scaleObject(this._myConfig.myComponentLabelTextScale),this.myRotationLabelCursorTarget.pp_setPositionLocal(this._myConfig.myComponentLabelCursorTargetPosition);for(let e=0;e<3;e++)this.myRotationPanels[e].pp_setPositionLocal(this._myConfig.myValuePanelsPositions[e]),this.myRotationTexts[e].pp_scaleObject(this._myConfig.myValueTextScale),this.myRotationCursorTargets[e].pp_setPositionLocal(this._myConfig.myValueCursorTargetPosition),this.myRotationIncreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myIncreaseButtonPosition),this.myRotationIncreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myRotationIncreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myRotationIncreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myRotationIncreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myRotationDecreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myDecreaseButtonPosition),this.myRotationDecreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myRotationDecreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myRotationDecreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myRotationDecreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition);this.myScalePanel.pp_setPositionLocal(this._myConfig.myScalePanelPosition),this.myScaleLabelText.pp_scaleObject(this._myConfig.myComponentLabelTextScale),this.myScaleLabelCursorTarget.pp_setPositionLocal(this._myConfig.myComponentLabelCursorTargetPosition);for(let e=0;e<3;e++)this.myScalePanels[e].pp_setPositionLocal(this._myConfig.myValuePanelsPositions[e]),this.myScaleTexts[e].pp_scaleObject(this._myConfig.myValueTextScale),this.myScaleCursorTargets[e].pp_setPositionLocal(this._myConfig.myValueCursorTargetPosition),this.myScaleIncreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myIncreaseButtonPosition),this.myScaleIncreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myScaleIncreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myScaleIncreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myScaleIncreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myScaleDecreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myDecreaseButtonPosition),this.myScaleDecreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myScaleDecreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myScaleDecreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myScaleDecreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition);this.myPositionStepPanel.pp_setPositionLocal(this._myConfig.myStepPanelPosition),this.myPositionStepText.pp_scaleObject(this._myConfig.myStepTextScale),this.myPositionStepCursorTarget.pp_setPositionLocal(this._myConfig.myStepCursorTargetPosition),this.myPositionStepIncreaseButtonPanel.pp_setPositionLocal(this._myConfig.myIncreaseButtonPosition),this.myPositionStepIncreaseButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myPositionStepIncreaseButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myPositionStepIncreaseButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myPositionStepIncreaseButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myPositionStepDecreaseButtonPanel.pp_setPositionLocal(this._myConfig.myDecreaseButtonPosition),this.myPositionStepDecreaseButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myPositionStepDecreaseButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myPositionStepDecreaseButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myPositionStepDecreaseButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myRotationStepPanel.pp_setPositionLocal(this._myConfig.myStepPanelPosition),this.myRotationStepText.pp_scaleObject(this._myConfig.myStepTextScale),this.myRotationStepCursorTarget.pp_setPositionLocal(this._myConfig.myStepCursorTargetPosition),this.myRotationStepIncreaseButtonPanel.pp_setPositionLocal(this._myConfig.myIncreaseButtonPosition),this.myRotationStepIncreaseButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myRotationStepIncreaseButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myRotationStepIncreaseButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myRotationStepIncreaseButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myRotationStepDecreaseButtonPanel.pp_setPositionLocal(this._myConfig.myDecreaseButtonPosition),this.myRotationStepDecreaseButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myRotationStepDecreaseButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myRotationStepDecreaseButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myRotationStepDecreaseButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myScaleStepPanel.pp_setPositionLocal(this._myConfig.myStepPanelPosition),this.myScaleStepText.pp_scaleObject(this._myConfig.myStepTextScale),this.myScaleStepCursorTarget.pp_setPositionLocal(this._myConfig.myStepCursorTargetPosition),this.myScaleStepIncreaseButtonPanel.pp_setPositionLocal(this._myConfig.myIncreaseButtonPosition),this.myScaleStepIncreaseButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myScaleStepIncreaseButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myScaleStepIncreaseButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myScaleStepIncreaseButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myScaleStepDecreaseButtonPanel.pp_setPositionLocal(this._myConfig.myDecreaseButtonPosition),this.myScaleStepDecreaseButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myScaleStepDecreaseButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myScaleStepDecreaseButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myScaleStepDecreaseButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition)}_addComponentsHook(){this.myPositionLabelTextComponent=this.myPositionLabelText.pp_addComponent(fe),this._setupTextComponent(this.myPositionLabelTextComponent),this.myPositionLabelTextComponent.text=this._myConfig.myPositionText,this.myPositionLabelCursorTargetComponent=this.myPositionLabelCursorTarget.pp_addComponent(Te),this.myPositionLabelCollisionComponent=this.myPositionLabelCursorTarget.pp_addComponent(ge),this.myPositionLabelCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionLabelCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionLabelCollisionComponent.extents=this._myConfig.myComponentLabelCollisionExtents,this.myPositionTextComponents=[],this.myPositionCursorTargetComponents=[],this.myPositionCollisionComponents=[],this.myPositionIncreaseButtonBackgroundComponents=[],this.myPositionIncreaseButtonTextComponents=[],this.myPositionIncreaseButtonCursorTargetComponents=[],this.myPositionIncreaseButtonCollisionComponents=[],this.myPositionDecreaseButtonBackgroundComponents=[],this.myPositionDecreaseButtonTextComponents=[],this.myPositionDecreaseButtonCursorTargetComponents=[],this.myPositionDecreaseButtonCollisionComponents=[];for(let e=0;e<3;e++)this.myPositionTextComponents[e]=this.myPositionTexts[e].pp_addComponent(fe),this._setupTextComponent(this.myPositionTextComponents[e]),this.myPositionTextComponents[e].text=" ",this.myPositionCursorTargetComponents[e]=this.myPositionCursorTargets[e].pp_addComponent(Te),this.myPositionCollisionComponents[e]=this.myPositionCursorTargets[e].pp_addComponent(ge),this.myPositionCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionCollisionComponents[e].extents=this._myConfig.myValueCollisionExtents,this.myPositionIncreaseButtonBackgroundComponents[e]=this.myPositionIncreaseButtonBackgrounds[e].pp_addComponent(Ke),this.myPositionIncreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myPositionIncreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myPositionIncreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myPositionIncreaseButtonTextComponents[e]=this.myPositionIncreaseButtonTexts[e].pp_addComponent(fe),this._setupTextComponent(this.myPositionIncreaseButtonTextComponents[e]),this.myPositionIncreaseButtonTextComponents[e].text=this._myConfig.myIncreaseButtonText,this.myPositionIncreaseButtonCursorTargetComponents[e]=this.myPositionIncreaseButtonCursorTargets[e].pp_addComponent(Te),this.myPositionIncreaseButtonCollisionComponents[e]=this.myPositionIncreaseButtonCursorTargets[e].pp_addComponent(ge),this.myPositionIncreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionIncreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionIncreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents,this.myPositionDecreaseButtonBackgroundComponents[e]=this.myPositionDecreaseButtonBackgrounds[e].pp_addComponent(Ke),this.myPositionDecreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myPositionDecreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myPositionDecreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myPositionDecreaseButtonTextComponents[e]=this.myPositionDecreaseButtonTexts[e].pp_addComponent(fe),this._setupTextComponent(this.myPositionDecreaseButtonTextComponents[e]),this.myPositionDecreaseButtonTextComponents[e].text=this._myConfig.myDecreaseButtonText,this.myPositionDecreaseButtonCursorTargetComponents[e]=this.myPositionDecreaseButtonCursorTargets[e].pp_addComponent(Te),this.myPositionDecreaseButtonCollisionComponents[e]=this.myPositionDecreaseButtonCursorTargets[e].pp_addComponent(ge),this.myPositionDecreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionDecreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionDecreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents;this.myRotationLabelTextComponent=this.myRotationLabelText.pp_addComponent(fe),this._setupTextComponent(this.myRotationLabelTextComponent),this.myRotationLabelTextComponent.text=this._myConfig.myRotationText,this.myRotationLabelCursorTargetComponent=this.myRotationLabelCursorTarget.pp_addComponent(Te),this.myRotationLabelCollisionComponent=this.myRotationLabelCursorTarget.pp_addComponent(ge),this.myRotationLabelCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationLabelCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationLabelCollisionComponent.extents=this._myConfig.myComponentLabelCollisionExtents,this.myRotationTextComponents=[],this.myRotationCursorTargetComponents=[],this.myRotationCollisionComponents=[],this.myRotationIncreaseButtonBackgroundComponents=[],this.myRotationIncreaseButtonTextComponents=[],this.myRotationIncreaseButtonCursorTargetComponents=[],this.myRotationIncreaseButtonCollisionComponents=[],this.myRotationDecreaseButtonBackgroundComponents=[],this.myRotationDecreaseButtonTextComponents=[],this.myRotationDecreaseButtonCursorTargetComponents=[],this.myRotationDecreaseButtonCollisionComponents=[];for(let e=0;e<3;e++)this.myRotationTextComponents[e]=this.myRotationTexts[e].pp_addComponent(fe),this._setupTextComponent(this.myRotationTextComponents[e]),this.myRotationTextComponents[e].text=" ",this.myRotationCursorTargetComponents[e]=this.myRotationCursorTargets[e].pp_addComponent(Te),this.myRotationCollisionComponents[e]=this.myRotationCursorTargets[e].pp_addComponent(ge),this.myRotationCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationCollisionComponents[e].extents=this._myConfig.myValueCollisionExtents,this.myRotationIncreaseButtonBackgroundComponents[e]=this.myRotationIncreaseButtonBackgrounds[e].pp_addComponent(Ke),this.myRotationIncreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myRotationIncreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myRotationIncreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myRotationIncreaseButtonTextComponents[e]=this.myRotationIncreaseButtonTexts[e].pp_addComponent(fe),this._setupTextComponent(this.myRotationIncreaseButtonTextComponents[e]),this.myRotationIncreaseButtonTextComponents[e].text=this._myConfig.myIncreaseButtonText,this.myRotationIncreaseButtonCursorTargetComponents[e]=this.myRotationIncreaseButtonCursorTargets[e].pp_addComponent(Te),this.myRotationIncreaseButtonCollisionComponents[e]=this.myRotationIncreaseButtonCursorTargets[e].pp_addComponent(ge),this.myRotationIncreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationIncreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationIncreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents,this.myRotationDecreaseButtonBackgroundComponents[e]=this.myRotationDecreaseButtonBackgrounds[e].pp_addComponent(Ke),this.myRotationDecreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myRotationDecreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myRotationDecreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myRotationDecreaseButtonTextComponents[e]=this.myRotationDecreaseButtonTexts[e].pp_addComponent(fe),this._setupTextComponent(this.myRotationDecreaseButtonTextComponents[e]),this.myRotationDecreaseButtonTextComponents[e].text=this._myConfig.myDecreaseButtonText,this.myRotationDecreaseButtonCursorTargetComponents[e]=this.myRotationDecreaseButtonCursorTargets[e].pp_addComponent(Te),this.myRotationDecreaseButtonCollisionComponents[e]=this.myRotationDecreaseButtonCursorTargets[e].pp_addComponent(ge),this.myRotationDecreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationDecreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationDecreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents;this.myScaleLabelTextComponent=this.myScaleLabelText.pp_addComponent(fe),this._setupTextComponent(this.myScaleLabelTextComponent),this.myScaleLabelTextComponent.text=this._myConfig.myScaleText,this.myScaleLabelCursorTargetComponent=this.myScaleLabelCursorTarget.pp_addComponent(Te),this.myScaleLabelCollisionComponent=this.myScaleLabelCursorTarget.pp_addComponent(ge),this.myScaleLabelCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleLabelCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleLabelCollisionComponent.extents=this._myConfig.myComponentLabelCollisionExtents,this.myScaleTextComponents=[],this.myScaleCursorTargetComponents=[],this.myScaleCollisionComponents=[],this.myScaleIncreaseButtonBackgroundComponents=[],this.myScaleIncreaseButtonTextComponents=[],this.myScaleIncreaseButtonCursorTargetComponents=[],this.myScaleIncreaseButtonCollisionComponents=[],this.myScaleDecreaseButtonBackgroundComponents=[],this.myScaleDecreaseButtonTextComponents=[],this.myScaleDecreaseButtonCursorTargetComponents=[],this.myScaleDecreaseButtonCollisionComponents=[];for(let e=0;e<3;e++)this.myScaleTextComponents[e]=this.myScaleTexts[e].pp_addComponent(fe),this._setupTextComponent(this.myScaleTextComponents[e]),this.myScaleTextComponents[e].text=" ",this.myScaleCursorTargetComponents[e]=this.myScaleCursorTargets[e].pp_addComponent(Te),this.myScaleCollisionComponents[e]=this.myScaleCursorTargets[e].pp_addComponent(ge),this.myScaleCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleCollisionComponents[e].extents=this._myConfig.myValueCollisionExtents,this.myScaleIncreaseButtonBackgroundComponents[e]=this.myScaleIncreaseButtonBackgrounds[e].pp_addComponent(Ke),this.myScaleIncreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myScaleIncreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myScaleIncreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myScaleIncreaseButtonTextComponents[e]=this.myScaleIncreaseButtonTexts[e].pp_addComponent(fe),this._setupTextComponent(this.myScaleIncreaseButtonTextComponents[e]),this.myScaleIncreaseButtonTextComponents[e].text=this._myConfig.myIncreaseButtonText,this.myScaleIncreaseButtonCursorTargetComponents[e]=this.myScaleIncreaseButtonCursorTargets[e].pp_addComponent(Te),this.myScaleIncreaseButtonCollisionComponents[e]=this.myScaleIncreaseButtonCursorTargets[e].pp_addComponent(ge),this.myScaleIncreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleIncreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleIncreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents,this.myScaleDecreaseButtonBackgroundComponents[e]=this.myScaleDecreaseButtonBackgrounds[e].pp_addComponent(Ke),this.myScaleDecreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myScaleDecreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myScaleDecreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myScaleDecreaseButtonTextComponents[e]=this.myScaleDecreaseButtonTexts[e].pp_addComponent(fe),this._setupTextComponent(this.myScaleDecreaseButtonTextComponents[e]),this.myScaleDecreaseButtonTextComponents[e].text=this._myConfig.myDecreaseButtonText,this.myScaleDecreaseButtonCursorTargetComponents[e]=this.myScaleDecreaseButtonCursorTargets[e].pp_addComponent(Te),this.myScaleDecreaseButtonCollisionComponents[e]=this.myScaleDecreaseButtonCursorTargets[e].pp_addComponent(ge),this.myScaleDecreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleDecreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleDecreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents;this.myPositionStepTextComponent=this.myPositionStepText.pp_addComponent(fe),this._setupTextComponent(this.myPositionStepTextComponent),this.myPositionStepTextComponent.text=" ",this.myPositionStepCursorTargetComponent=this.myPositionStepCursorTarget.pp_addComponent(Te),this.myPositionStepCollisionComponent=this.myPositionStepCursorTarget.pp_addComponent(ge),this.myPositionStepCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionStepCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionStepCollisionComponent.extents=this._myConfig.myStepCollisionExtents,this.myPositionStepIncreaseButtonBackgroundComponent=this.myPositionStepIncreaseButtonBackground.pp_addComponent(Ke),this.myPositionStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPositionStepIncreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myPositionStepIncreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myPositionStepIncreaseButtonTextComponent=this.myPositionStepIncreaseButtonText.pp_addComponent(fe),this._setupTextComponent(this.myPositionStepIncreaseButtonTextComponent),this.myPositionStepIncreaseButtonTextComponent.text=this._myConfig.myIncreaseButtonText,this.myPositionStepIncreaseButtonCursorTargetComponent=this.myPositionStepIncreaseButtonCursorTarget.pp_addComponent(Te),this.myPositionStepIncreaseButtonCollisionComponent=this.myPositionStepIncreaseButtonCursorTarget.pp_addComponent(ge),this.myPositionStepIncreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionStepIncreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionStepIncreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myPositionStepDecreaseButtonBackgroundComponent=this.myPositionStepDecreaseButtonBackground.pp_addComponent(Ke),this.myPositionStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPositionStepDecreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myPositionStepDecreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myPositionStepDecreaseButtonTextComponent=this.myPositionStepDecreaseButtonText.pp_addComponent(fe),this._setupTextComponent(this.myPositionStepDecreaseButtonTextComponent),this.myPositionStepDecreaseButtonTextComponent.text=this._myConfig.myDecreaseButtonText,this.myPositionStepDecreaseButtonCursorTargetComponent=this.myPositionStepDecreaseButtonCursorTarget.pp_addComponent(Te),this.myPositionStepDecreaseButtonCollisionComponent=this.myPositionStepDecreaseButtonCursorTarget.pp_addComponent(ge),this.myPositionStepDecreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionStepDecreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionStepDecreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myRotationStepTextComponent=this.myRotationStepText.pp_addComponent(fe),this._setupTextComponent(this.myRotationStepTextComponent),this.myRotationStepTextComponent.text=" ",this.myRotationStepCursorTargetComponent=this.myRotationStepCursorTarget.pp_addComponent(Te),this.myRotationStepCollisionComponent=this.myRotationStepCursorTarget.pp_addComponent(ge),this.myRotationStepCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationStepCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationStepCollisionComponent.extents=this._myConfig.myStepCollisionExtents,this.myRotationStepIncreaseButtonBackgroundComponent=this.myRotationStepIncreaseButtonBackground.pp_addComponent(Ke),this.myRotationStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myRotationStepIncreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myRotationStepIncreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myRotationStepIncreaseButtonTextComponent=this.myRotationStepIncreaseButtonText.pp_addComponent(fe),this._setupTextComponent(this.myRotationStepIncreaseButtonTextComponent),this.myRotationStepIncreaseButtonTextComponent.text=this._myConfig.myIncreaseButtonText,this.myRotationStepIncreaseButtonCursorTargetComponent=this.myRotationStepIncreaseButtonCursorTarget.pp_addComponent(Te),this.myRotationStepIncreaseButtonCollisionComponent=this.myRotationStepIncreaseButtonCursorTarget.pp_addComponent(ge),this.myRotationStepIncreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationStepIncreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationStepIncreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myRotationStepDecreaseButtonBackgroundComponent=this.myRotationStepDecreaseButtonBackground.pp_addComponent(Ke),this.myRotationStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myRotationStepDecreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myRotationStepDecreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myRotationStepDecreaseButtonTextComponent=this.myRotationStepDecreaseButtonText.pp_addComponent(fe),this._setupTextComponent(this.myRotationStepDecreaseButtonTextComponent),this.myRotationStepDecreaseButtonTextComponent.text=this._myConfig.myDecreaseButtonText,this.myRotationStepDecreaseButtonCursorTargetComponent=this.myRotationStepDecreaseButtonCursorTarget.pp_addComponent(Te),this.myRotationStepDecreaseButtonCollisionComponent=this.myRotationStepDecreaseButtonCursorTarget.pp_addComponent(ge),this.myRotationStepDecreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationStepDecreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationStepDecreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myScaleStepTextComponent=this.myScaleStepText.pp_addComponent(fe),this._setupTextComponent(this.myScaleStepTextComponent),this.myScaleStepTextComponent.text=" ",this.myScaleStepCursorTargetComponent=this.myScaleStepCursorTarget.pp_addComponent(Te),this.myScaleStepCollisionComponent=this.myScaleStepCursorTarget.pp_addComponent(ge),this.myScaleStepCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleStepCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleStepCollisionComponent.extents=this._myConfig.myStepCollisionExtents,this.myScaleStepIncreaseButtonBackgroundComponent=this.myScaleStepIncreaseButtonBackground.pp_addComponent(Ke),this.myScaleStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myScaleStepIncreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myScaleStepIncreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myScaleStepIncreaseButtonTextComponent=this.myScaleStepIncreaseButtonText.pp_addComponent(fe),this._setupTextComponent(this.myScaleStepIncreaseButtonTextComponent),this.myScaleStepIncreaseButtonTextComponent.text=this._myConfig.myIncreaseButtonText,this.myScaleStepIncreaseButtonCursorTargetComponent=this.myScaleStepIncreaseButtonCursorTarget.pp_addComponent(Te),this.myScaleStepIncreaseButtonCollisionComponent=this.myScaleStepIncreaseButtonCursorTarget.pp_addComponent(ge),this.myScaleStepIncreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleStepIncreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleStepIncreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myScaleStepDecreaseButtonBackgroundComponent=this.myScaleStepDecreaseButtonBackground.pp_addComponent(Ke),this.myScaleStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myScaleStepDecreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myScaleStepDecreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myScaleStepDecreaseButtonTextComponent=this.myScaleStepDecreaseButtonText.pp_addComponent(fe),this._setupTextComponent(this.myScaleStepDecreaseButtonTextComponent),this.myScaleStepDecreaseButtonTextComponent.text=this._myConfig.myDecreaseButtonText,this.myScaleStepDecreaseButtonCursorTargetComponent=this.myScaleStepDecreaseButtonCursorTarget.pp_addComponent(Te),this.myScaleStepDecreaseButtonCollisionComponent=this.myScaleStepDecreaseButtonCursorTarget.pp_addComponent(ge),this.myScaleStepDecreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleStepDecreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleStepDecreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents}_addStepComponents(){this.myPositionStepTextComponent=this.myPositionStepText.pp_addComponent(fe),this._setupTextComponent(this.myPositionStepTextComponent),this.myPositionStepTextComponent.text=" ",this.myPositionStepCursorTargetComponent=this.myPositionStepCursorTarget.pp_addComponent(Te),this.myPositionStepCollisionComponent=this.myPositionStepCursorTarget.pp_addComponent(ge),this.myPositionStepCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionStepCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionStepCollisionComponent.extents=this._myConfig.myStepCollisionExtents,this.myPositionStepIncreaseButtonBackgroundComponent=this.myPositionStepIncreaseButtonBackground.pp_addComponent(Ke),this.myPositionStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPositionStepIncreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myPositionStepIncreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myPositionStepIncreaseButtonTextComponent=this.myPositionStepIncreaseButtonText.pp_addComponent(fe),this._setupTextComponent(this.myPositionStepIncreaseButtonTextComponent),this.myPositionStepIncreaseButtonTextComponent.text=this._myConfig.myIncreaseButtonText,this.myPositionStepIncreaseButtonCursorTargetComponent=this.myPositionStepIncreaseButtonCursorTarget.pp_addComponent(Te),this.myPositionStepIncreaseButtonCollisionComponent=this.myPositionStepIncreaseButtonCursorTarget.pp_addComponent(ge),this.myPositionStepIncreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionStepIncreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionStepIncreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myPositionStepDecreaseButtonBackgroundComponent=this.myPositionStepDecreaseButtonBackground.pp_addComponent(Ke),this.myPositionStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPositionStepDecreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myPositionStepDecreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myPositionStepDecreaseButtonTextComponent=this.myPositionStepDecreaseButtonText.pp_addComponent(fe),this._setupTextComponent(this.myPositionStepDecreaseButtonTextComponent),this.myPositionStepDecreaseButtonTextComponent.text=this._myConfig.myDecreaseButtonText,this.myPositionStepDecreaseButtonCursorTargetComponent=this.myPositionStepDecreaseButtonCursorTarget.pp_addComponent(Te),this.myPositionStepDecreaseButtonCollisionComponent=this.myPositionStepDecreaseButtonCursorTarget.pp_addComponent(ge),this.myPositionStepDecreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionStepDecreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionStepDecreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myRotationStepTextComponent=this.myRotationStepText.pp_addComponent(fe),this._setupTextComponent(this.myRotationStepTextComponent),this.myRotationStepTextComponent.text=" ",this.myRotationStepCursorTargetComponent=this.myRotationStepCursorTarget.pp_addComponent(Te),this.myRotationStepCollisionComponent=this.myRotationStepCursorTarget.pp_addComponent(ge),this.myRotationStepCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationStepCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationStepCollisionComponent.extents=this._myConfig.myStepCollisionExtents,this.myRotationStepIncreaseButtonBackgroundComponent=this.myRotationStepIncreaseButtonBackground.pp_addComponent(Ke),this.myRotationStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myRotationStepIncreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myRotationStepIncreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myRotationStepIncreaseButtonTextComponent=this.myRotationStepIncreaseButtonText.pp_addComponent(fe),this._setupTextComponent(this.myRotationStepIncreaseButtonTextComponent),this.myRotationStepIncreaseButtonTextComponent.text=this._myConfig.myIncreaseButtonText,this.myRotationStepIncreaseButtonCursorTargetComponent=this.myRotationStepIncreaseButtonCursorTarget.pp_addComponent(Te),this.myRotationStepIncreaseButtonCollisionComponent=this.myRotationStepIncreaseButtonCursorTarget.pp_addComponent(ge),this.myRotationStepIncreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationStepIncreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationStepIncreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myRotationStepDecreaseButtonBackgroundComponent=this.myRotationStepDecreaseButtonBackground.pp_addComponent(Ke),this.myRotationStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myRotationStepDecreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myRotationStepDecreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myRotationStepDecreaseButtonTextComponent=this.myRotationStepDecreaseButtonText.pp_addComponent(fe),this._setupTextComponent(this.myRotationStepDecreaseButtonTextComponent),this.myRotationStepDecreaseButtonTextComponent.text=this._myConfig.myDecreaseButtonText,this.myRotationStepDecreaseButtonCursorTargetComponent=this.myRotationStepDecreaseButtonCursorTarget.pp_addComponent(Te),this.myRotationStepDecreaseButtonCollisionComponent=this.myRotationStepDecreaseButtonCursorTarget.pp_addComponent(ge),this.myRotationStepDecreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationStepDecreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationStepDecreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myScaleStepTextComponent=this.myScaleStepText.pp_addComponent(fe),this._setupTextComponent(this.myScaleStepTextComponent),this.myScaleStepTextComponent.text=" ",this.myScaleStepCursorTargetComponent=this.myScaleStepCursorTarget.pp_addComponent(Te),this.myScaleStepCollisionComponent=this.myScaleStepCursorTarget.pp_addComponent(ge),this.myScaleStepCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleStepCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleStepCollisionComponent.extents=this._myConfig.myStepCollisionExtents,this.myScaleStepIncreaseButtonBackgroundComponent=this.myScaleStepIncreaseButtonBackground.pp_addComponent(Ke),this.myScaleStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myScaleStepIncreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myScaleStepIncreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myScaleStepIncreaseButtonTextComponent=this.myScaleStepIncreaseButtonText.pp_addComponent(fe),this._setupTextComponent(this.myScaleStepIncreaseButtonTextComponent),this.myScaleStepIncreaseButtonTextComponent.text=this._myConfig.myIncreaseButtonText,this.myScaleStepIncreaseButtonCursorTargetComponent=this.myScaleStepIncreaseButtonCursorTarget.pp_addComponent(Te),this.myScaleStepIncreaseButtonCollisionComponent=this.myScaleStepIncreaseButtonCursorTarget.pp_addComponent(ge),this.myScaleStepIncreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleStepIncreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleStepIncreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myScaleStepDecreaseButtonBackgroundComponent=this.myScaleStepDecreaseButtonBackground.pp_addComponent(Ke),this.myScaleStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myScaleStepDecreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myScaleStepDecreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myScaleStepDecreaseButtonTextComponent=this.myScaleStepDecreaseButtonText.pp_addComponent(fe),this._setupTextComponent(this.myScaleStepDecreaseButtonTextComponent),this.myScaleStepDecreaseButtonTextComponent.text=this._myConfig.myDecreaseButtonText,this.myScaleStepDecreaseButtonCursorTargetComponent=this.myScaleStepDecreaseButtonCursorTarget.pp_addComponent(Te),this.myScaleStepDecreaseButtonCollisionComponent=this.myScaleStepDecreaseButtonCursorTarget.pp_addComponent(ge),this.myScaleStepDecreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleStepDecreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleStepDecreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents}};var ka=class extends Ut{constructor(e,t,n=r.getMainEngine()){super(e),this._myGamepad=t,this._myConfig=new La,this._myUI=new Ha(n),this._myValueButtonEditIntensity=0,this._myValueButtonEditIntensityTimer=0,this._myStepButtonEditIntensity=0,this._myStepButtonEditIntensityTimer=0,this._myValueEditEnabled=!1,this._myStepEditEnabled=!1,this._myValueRealValue=0,this._myComponentStepValue=0,this._myStepMultiplierValue=0,this._myStepFastEdit=!1,this._myValueEditIndex=-1,this._myComponentIndex=0,this._myStepIndex=0,this._myTempTransformValue=be(),this._myTempPositionValue=c(),this._myTempRotationValue=c(),this._myTempScaleValue=c()}_refreshUIHook(){for(let e=0;e<3;e++)this._myUI.myPositionTextComponents[e].text=this._myVariable._myPosition[e].toFixed(this._myVariable._myDecimalPlaces);this._myUI.myPositionStepTextComponent.text=this._myConfig.myStepStartString.concat(this._myVariable._myPositionStepPerSecond);for(let e=0;e<3;e++)this._myUI.myRotationTextComponents[e].text=this._myVariable._myRotation[e].toFixed(this._myVariable._myDecimalPlaces);this._myUI.myRotationStepTextComponent.text=this._myConfig.myStepStartString.concat(this._myVariable._myRotationStepPerSecond);for(let e=0;e<3;e++)this._myUI.myScaleTextComponents[e].text=this._myVariable._myScale[e].toFixed(this._myVariable._myDecimalPlaces);this._myUI.myScaleStepTextComponent.text=this._myConfig.myStepStartString.concat(this._myVariable._myScaleStepPerSecond)}_startHook(e,t){this._myUI.setAdditionalButtonsVisible(t.myShowAdditionalButtons)}_setEasyTuneVariableHook(){this._myVariable!=null&&(this._myTempPositionValue.pp_copy(this._myVariable._myPosition),this._myTempRotationValue.pp_copy(this._myVariable._myRotation),this._myTempScaleValue.pp_copy(this._myVariable._myScale))}_updateHook(e){this._updateValue(e)}_updateValue(e){let t=0;if(this._myGamepad){let s=this._myGamepad.getAxesInfo(oe.THUMBSTICK).myAxes[1];if(Math.abs(s)>this._myConfig.myEditThumbstickMinThreshold){let a=(Math.abs(s)-this._myConfig.myEditThumbstickMinThreshold)/(1-this._myConfig.myEditThumbstickMinThreshold);t=Math.sign(s)*a}}let n=0;if(this._myValueEditEnabled?n=t:this._myValueButtonEditIntensity!=0&&(this._myValueButtonEditIntensityTimer<=0?n=this._myValueButtonEditIntensity:this._myValueButtonEditIntensityTimer-=e),this._myValueEditIndex>=0&&this._myValueEditIndex<3)if(n!=0){this._myTempPositionValue.pp_copy(this._myVariable._myPosition),this._myTempRotationValue.pp_copy(this._myVariable._myRotation),this._myTempScaleValue.pp_copy(this._myVariable._myScale);let s=n*this._myComponentStepValue*e;this._myValueRealValue+=s;let a=Math.pow(10,this._myVariable._myDecimalPlaces);switch(this._myComponentIndex){case 0:this._myTempPositionValue[this._myValueEditIndex]=Math.round(this._myValueRealValue*a+Number.EPSILON)/a,this._myUI.myPositionTextComponents[this._myValueEditIndex].text=this._myTempPositionValue[this._myValueEditIndex].toFixed(this._myVariable._myDecimalPlaces);break;case 1:if(this._myValueRealValue>180){for(;this._myValueRealValue>180;)this._myValueRealValue-=180;this._myValueRealValue=-180+this._myValueRealValue}if(this._myValueRealValue<-180){for(;this._myValueRealValue<-180;)this._myValueRealValue+=180;this._myValueRealValue=180-this._myValueRealValue}this._myTempRotationValue[this._myValueEditIndex]=Math.round(this._myValueRealValue*a+Number.EPSILON)/a,this._myUI.myRotationTextComponents[this._myValueEditIndex].text=this._myTempRotationValue[this._myValueEditIndex].toFixed(this._myVariable._myDecimalPlaces);break;case 2:if(this._myValueRealValue<=0&&(this._myValueRealValue=1/a),this._myVariable._myScaleAsOne){let u=Math.round(this._myValueRealValue*a+Number.EPSILON)/a-this._myTempScaleValue[this._myValueEditIndex];for(let _=0;_<3;_++)this._myTempScaleValue[_]=Math.round((this._myTempScaleValue[_]+u)*a+Number.EPSILON)/a,this._myTempScaleValue[_]=Math.max(this._myTempScaleValue[_],1/a),this._myUI.myScaleTextComponents[_].text=this._myTempScaleValue[_].toFixed(this._myVariable._myDecimalPlaces)}else this._myTempScaleValue[this._myValueEditIndex]=Math.round(this._myValueRealValue*a+Number.EPSILON)/a,this._myTempScaleValue[this._myValueEditIndex]=Math.max(this._myTempScaleValue[this._myValueEditIndex],1/a),this._myUI.myScaleTextComponents[this._myValueEditIndex].text=this._myTempScaleValue[this._myValueEditIndex].toFixed(this._myVariable._myDecimalPlaces);break}this._myTempTransformValue.mat4_setPositionRotationDegreesScale(this._myTempPositionValue,this._myTempRotationValue,this._myTempScaleValue),this._myVariable.setValue(this._myTempTransformValue)}else switch(this._myComponentIndex){case 0:this._myValueRealValue=this._myVariable._myPosition[this._myValueEditIndex];break;case 1:this._myValueRealValue=this._myVariable._myRotation[this._myValueEditIndex];break;case 2:this._myValueRealValue=this._myVariable._myScale[this._myValueEditIndex];break}let o=0;if(this._myStepEditEnabled?o=t:this._myStepButtonEditIntensity!=0&&(this._myStepButtonEditIntensityTimer<=0?o=this._myStepButtonEditIntensity:this._myStepButtonEditIntensityTimer-=e),o!=0){let s=0;if(this._myStepFastEdit?(s=Math.sign(o)*1,this._myStepFastEdit=!1):s=o*this._myConfig.myStepMultiplierStepPerSecond*e,this._myStepMultiplierValue+=s,Math.abs(this._myStepMultiplierValue)>=1){let a=0;switch(this._myStepIndex){case 0:a=this._myVariable._myPositionStepPerSecond;break;case 1:a=this._myVariable._myRotationStepPerSecond;break;case 2:a=this._myVariable._myScaleStepPerSecond;break;default:a=0}Math.sign(this._myStepMultiplierValue)>0?(this._myStepMultiplierValue-=1,this._changeStep(this._myStepIndex,a*10)):(this._myStepMultiplierValue+=1,this._changeStep(this._myStepIndex,a*.1))}}else this._myStepMultiplierValue=0,this._myStepFastEdit=!0}_addListenersHook(){let e=this._myUI;e.myVariableLabelCursorTargetComponent.onClick.add(this._resetAllValues.bind(this)),e.myVariableLabelCursorTargetComponent.onHover.add(this._genericTextHover.bind(this,e.myVariableLabelText)),e.myVariableLabelCursorTargetComponent.onUnhover.add(this._genericTextUnhover.bind(this,e.myVariableLabelText,this._myConfig.myVariableLabelTextScale)),e.myPositionLabelCursorTargetComponent.onClick.add(this._resetComponentValues.bind(this,0)),e.myPositionLabelCursorTargetComponent.onHover.add(this._genericTextHover.bind(this,e.myPositionLabelText)),e.myPositionLabelCursorTargetComponent.onUnhover.add(this._genericTextUnhover.bind(this,e.myPositionLabelText,this._myConfig.myComponentLabelTextScale));for(let t=0;t<3;t++)e.myPositionIncreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,0,t,1)),e.myPositionIncreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,0,t,1)),e.myPositionIncreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,0,t,0)),e.myPositionIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,0,t,0)),e.myPositionDecreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,0,t,-1)),e.myPositionDecreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,0,t,-1)),e.myPositionDecreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,0,t,0)),e.myPositionDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,0,t,0)),e.myPositionIncreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myPositionIncreaseButtonBackgroundComponents[t].material)),e.myPositionIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnhover.bind(this,e.myPositionIncreaseButtonBackgroundComponents[t].material)),e.myPositionDecreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myPositionDecreaseButtonBackgroundComponents[t].material)),e.myPositionDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnhover.bind(this,e.myPositionDecreaseButtonBackgroundComponents[t].material)),e.myPositionCursorTargetComponents[t].onClick.add(this._resetValue.bind(this,0,t)),e.myPositionCursorTargetComponents[t].onHover.add(this._setValueEditEnabled.bind(this,0,t,e.myPositionTexts[t],!0)),e.myPositionCursorTargetComponents[t].onUnhover.add(this._setValueEditEnabled.bind(this,0,t,e.myPositionTexts[t],!1));e.myRotationLabelCursorTargetComponent.onClick.add(this._resetComponentValues.bind(this,1)),e.myRotationLabelCursorTargetComponent.onHover.add(this._genericTextHover.bind(this,e.myRotationLabelText)),e.myRotationLabelCursorTargetComponent.onUnhover.add(this._genericTextUnhover.bind(this,e.myRotationLabelText,this._myConfig.myComponentLabelTextScale));for(let t=0;t<3;t++)e.myRotationIncreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,1,t,1)),e.myRotationIncreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,1,t,1)),e.myRotationIncreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,1,t,0)),e.myRotationIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,1,t,0)),e.myRotationDecreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,1,t,-1)),e.myRotationDecreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,1,t,-1)),e.myRotationDecreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,1,t,0)),e.myRotationDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,1,t,0)),e.myRotationIncreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myRotationIncreaseButtonBackgroundComponents[t].material)),e.myRotationIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnhover.bind(this,e.myRotationIncreaseButtonBackgroundComponents[t].material)),e.myRotationDecreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myRotationDecreaseButtonBackgroundComponents[t].material)),e.myRotationDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnhover.bind(this,e.myRotationDecreaseButtonBackgroundComponents[t].material)),e.myRotationCursorTargetComponents[t].onClick.add(this._resetValue.bind(this,1,t)),e.myRotationCursorTargetComponents[t].onHover.add(this._setValueEditEnabled.bind(this,1,t,e.myRotationTexts[t],!0)),e.myRotationCursorTargetComponents[t].onUnhover.add(this._setValueEditEnabled.bind(this,1,t,e.myRotationTexts[t],!1));e.myScaleLabelCursorTargetComponent.onClick.add(this._resetComponentValues.bind(this,2)),e.myScaleLabelCursorTargetComponent.onHover.add(this._genericTextHover.bind(this,e.myScaleLabelText)),e.myScaleLabelCursorTargetComponent.onUnhover.add(this._genericTextUnhover.bind(this,e.myScaleLabelText,this._myConfig.myComponentLabelTextScale));for(let t=0;t<3;t++)e.myScaleIncreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,2,t,1)),e.myScaleIncreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,2,t,1)),e.myScaleIncreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,2,t,0)),e.myScaleIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,2,t,0)),e.myScaleDecreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,2,t,-1)),e.myScaleDecreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,2,t,-1)),e.myScaleDecreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,2,t,0)),e.myScaleDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,2,t,0)),e.myScaleIncreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myScaleIncreaseButtonBackgroundComponents[t].material)),e.myScaleIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnhover.bind(this,e.myScaleIncreaseButtonBackgroundComponents[t].material)),e.myScaleDecreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myScaleDecreaseButtonBackgroundComponents[t].material)),e.myScaleDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnhover.bind(this,e.myScaleDecreaseButtonBackgroundComponents[t].material)),e.myScaleCursorTargetComponents[t].onClick.add(this._resetValue.bind(this,2,t)),e.myScaleCursorTargetComponents[t].onHover.add(this._setValueEditEnabled.bind(this,2,t,e.myScaleTexts[t],!0)),e.myScaleCursorTargetComponents[t].onUnhover.add(this._setValueEditEnabled.bind(this,2,t,e.myScaleTexts[t],!1));e.myPositionStepCursorTargetComponent.onClick.add(this._resetStep.bind(this,0)),e.myPositionStepCursorTargetComponent.onHover.add(this._setStepEditEnabled.bind(this,0,e.myPositionStepText,!0)),e.myPositionStepCursorTargetComponent.onUnhover.add(this._setStepEditEnabled.bind(this,0,e.myPositionStepText,!1)),e.myPositionStepIncreaseButtonCursorTargetComponent.onDown.add(this._setStepEditIntensity.bind(this,0,1)),e.myPositionStepIncreaseButtonCursorTargetComponent.onDownOnHover.add(this._setStepEditIntensity.bind(this,0,1)),e.myPositionStepIncreaseButtonCursorTargetComponent.onUp.add(this._setStepEditIntensity.bind(this,0,0)),e.myPositionStepIncreaseButtonCursorTargetComponent.onUnhover.add(this._setStepEditIntensity.bind(this,0,0)),e.myPositionStepDecreaseButtonCursorTargetComponent.onDown.add(this._setStepEditIntensity.bind(this,0,-1)),e.myPositionStepDecreaseButtonCursorTargetComponent.onDownOnHover.add(this._setStepEditIntensity.bind(this,0,-1)),e.myPositionStepDecreaseButtonCursorTargetComponent.onUp.add(this._setStepEditIntensity.bind(this,0,0)),e.myPositionStepDecreaseButtonCursorTargetComponent.onUnhover.add(this._setStepEditIntensity.bind(this,0,0)),e.myPositionStepIncreaseButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myPositionStepIncreaseButtonBackgroundComponent.material)),e.myPositionStepIncreaseButtonCursorTargetComponent.onUnhover.add(this._genericUnhover.bind(this,e.myPositionStepIncreaseButtonBackgroundComponent.material)),e.myPositionStepDecreaseButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myPositionStepDecreaseButtonBackgroundComponent.material)),e.myPositionStepDecreaseButtonCursorTargetComponent.onUnhover.add(this._genericUnhover.bind(this,e.myPositionStepDecreaseButtonBackgroundComponent.material)),e.myRotationStepCursorTargetComponent.onClick.add(this._resetStep.bind(this,1)),e.myRotationStepCursorTargetComponent.onHover.add(this._setStepEditEnabled.bind(this,1,e.myRotationStepText,!0)),e.myRotationStepCursorTargetComponent.onUnhover.add(this._setStepEditEnabled.bind(this,1,e.myRotationStepText,!1)),e.myRotationStepIncreaseButtonCursorTargetComponent.onDown.add(this._setStepEditIntensity.bind(this,1,1)),e.myRotationStepIncreaseButtonCursorTargetComponent.onDownOnHover.add(this._setStepEditIntensity.bind(this,1,1)),e.myRotationStepIncreaseButtonCursorTargetComponent.onUp.add(this._setStepEditIntensity.bind(this,1,0)),e.myRotationStepIncreaseButtonCursorTargetComponent.onUnhover.add(this._setStepEditIntensity.bind(this,1,0)),e.myRotationStepDecreaseButtonCursorTargetComponent.onDown.add(this._setStepEditIntensity.bind(this,1,-1)),e.myRotationStepDecreaseButtonCursorTargetComponent.onDownOnHover.add(this._setStepEditIntensity.bind(this,1,-1)),e.myRotationStepDecreaseButtonCursorTargetComponent.onUp.add(this._setStepEditIntensity.bind(this,1,0)),e.myRotationStepDecreaseButtonCursorTargetComponent.onUnhover.add(this._setStepEditIntensity.bind(this,1,0)),e.myRotationStepIncreaseButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myRotationStepIncreaseButtonBackgroundComponent.material)),e.myRotationStepIncreaseButtonCursorTargetComponent.onUnhover.add(this._genericUnhover.bind(this,e.myRotationStepIncreaseButtonBackgroundComponent.material)),e.myRotationStepDecreaseButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myRotationStepDecreaseButtonBackgroundComponent.material)),e.myRotationStepDecreaseButtonCursorTargetComponent.onUnhover.add(this._genericUnhover.bind(this,e.myRotationStepDecreaseButtonBackgroundComponent.material)),e.myScaleStepCursorTargetComponent.onClick.add(this._resetStep.bind(this,2)),e.myScaleStepCursorTargetComponent.onHover.add(this._setStepEditEnabled.bind(this,2,e.myScaleStepText,!0)),e.myScaleStepCursorTargetComponent.onUnhover.add(this._setStepEditEnabled.bind(this,2,e.myScaleStepText,!1)),e.myScaleStepIncreaseButtonCursorTargetComponent.onDown.add(this._setStepEditIntensity.bind(this,2,1)),e.myScaleStepIncreaseButtonCursorTargetComponent.onDownOnHover.add(this._setStepEditIntensity.bind(this,2,1)),e.myScaleStepIncreaseButtonCursorTargetComponent.onUp.add(this._setStepEditIntensity.bind(this,2,0)),e.myScaleStepIncreaseButtonCursorTargetComponent.onUnhover.add(this._setStepEditIntensity.bind(this,2,0)),e.myScaleStepDecreaseButtonCursorTargetComponent.onDown.add(this._setStepEditIntensity.bind(this,2,-1)),e.myScaleStepDecreaseButtonCursorTargetComponent.onDownOnHover.add(this._setStepEditIntensity.bind(this,2,-1)),e.myScaleStepDecreaseButtonCursorTargetComponent.onUp.add(this._setStepEditIntensity.bind(this,2,0)),e.myScaleStepDecreaseButtonCursorTargetComponent.onUnhover.add(this._setStepEditIntensity.bind(this,2,0)),e.myScaleStepIncreaseButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myScaleStepIncreaseButtonBackgroundComponent.material)),e.myScaleStepIncreaseButtonCursorTargetComponent.onUnhover.add(this._genericUnhover.bind(this,e.myScaleStepIncreaseButtonBackgroundComponent.material)),e.myScaleStepDecreaseButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myScaleStepDecreaseButtonBackgroundComponent.material)),e.myScaleStepDecreaseButtonCursorTargetComponent.onUnhover.add(this._genericUnhover.bind(this,e.myScaleStepDecreaseButtonBackgroundComponent.material))}_setValueEditIntensity(e,t,n){if(this._isActive()||n==0){if(n!=0){switch(e){case 0:this._myValueRealValue=this._myVariable._myPosition[t],this._myComponentStepValue=this._myVariable._myPositionStepPerSecond;break;case 1:this._myValueRealValue=this._myVariable._myRotation[t],this._myComponentStepValue=this._myVariable._myRotationStepPerSecond;break;case 2:this._myValueRealValue=this._myVariable._myScale[t],this._myComponentStepValue=this._myVariable._myScaleStepPerSecond;break}this._myValueButtonEditIntensityTimer=this._myConfig.myButtonEditDelay,this._myValueEditIndex=t,this._myComponentIndex=e}this._myValueButtonEditIntensity=n}}_setStepEditIntensity(e,t){(this._isActive()||t==0)&&(t!=0&&(this._myStepButtonEditIntensityTimer=this._myConfig.myButtonEditDelay),this._myStepButtonEditIntensity=t,this._myStepIndex=e)}_setValueEditEnabled(e,t,n,o){if(this._isActive()||!o){if(o){switch(e){case 0:this._myValueRealValue=this._myVariable._myPosition[t],this._myComponentStepValue=this._myVariable._myPositionStepPerSecond;break;case 1:this._myValueRealValue=this._myVariable._myRotation[t],this._myComponentStepValue=this._myVariable._myRotationStepPerSecond;break;case 2:this._myValueRealValue=this._myVariable._myScale[t],this._myComponentStepValue=this._myVariable._myScaleStepPerSecond;break}this._myValueEditIndex=t,this._myComponentIndex=e,n.pp_scaleObject(this._myConfig.myTextHoverScaleMultiplier)}else n.pp_setScaleLocal(this._myConfig.myValueTextScale);this._myValueEditEnabled=o}}_setStepEditEnabled(e,t,n){(this._isActive()||!n)&&(n?t.pp_scaleObject(this._myConfig.myTextHoverScaleMultiplier):t.pp_setScaleLocal(this._myConfig.myStepTextScale),this._myStepEditEnabled=n,this._myStepIndex=e)}_resetValue(e,t){if(this._isActive()){switch(this._myTempPositionValue.pp_copy(this._myVariable._myPosition),this._myTempRotationValue.pp_copy(this._myVariable._myRotation),this._myTempScaleValue.pp_copy(this._myVariable._myScale),e){case 0:this._myTempPositionValue[t]=this._myVariable._myDefaultPosition[t],this._myUI.myPositionTextComponents[t].text=this._myTempPositionValue[t].toFixed(this._myVariable._myDecimalPlaces);break;case 1:this._myTempRotationValue[t]=this._myVariable._myDefaultRotation[t],this._myUI.myRotationTextComponents[t].text=this._myTempRotationValue[t].toFixed(this._myVariable._myDecimalPlaces);break;case 2:this._myTempScaleValue[t]=this._myVariable._myDefaultScale[t],this._myUI.myScaleTextComponents[t].text=this._myTempScaleValue[t].toFixed(this._myVariable._myDecimalPlaces);break}this._myTempTransformValue.mat4_setPositionRotationDegreesScale(this._myTempPositionValue,this._myTempRotationValue,this._myTempScaleValue),this._myVariable.setValue(this._myTempTransformValue)}}_resetAllValues(){for(let e=0;e<3;e++)this._resetComponentValues(e)}_resetComponentValues(e){for(let t=0;t<3;t++)this._resetValue(e,t)}_resetStep(e){if(this._isActive()){let t=0;switch(e){case 0:t=this._myVariable._myDefaultPositionStepPerSecond;break;case 1:t=this._myVariable._myDefaultRotationStepPerSecond;break;case 2:t=this._myVariable._myDefaultScaleStepPerSecond;break;default:t=0}this._changeStep(e,t)}}_changeStep(e,t){switch(t=Math.pp_roundDecimal(t,10),e){case 0:this._myVariable._myPositionStepPerSecond=t,this._myUI.myPositionStepTextComponent.text=this._myConfig.myStepStartString.concat(this._myVariable._myPositionStepPerSecond);break;case 1:this._myVariable._myRotationStepPerSecond=t,this._myUI.myRotationStepTextComponent.text=this._myConfig.myStepStartString.concat(this._myVariable._myRotationStepPerSecond);break;case 2:this._myVariable._myScaleStepPerSecond=t,this._myUI.myScaleStepTextComponent.text=this._myConfig.myStepStartString.concat(this._myVariable._myScaleStepPerSecond);break}}_genericTextHover(e){e.pp_scaleObject(this._myConfig.myTextHoverScaleMultiplier)}_genericTextUnhover(e,t){e.pp_setScaleLocal(t)}};var Fa=class extends lo{constructor(){super(),this.myShowOnStart=!1,this.myShowVisibilityButton=!1,this.myShowAdditionalButtons=!1,this.myGamepadScrollVariableEnabled=!1,this.myShowVariablesImportExportButtons=!1,this.myVariablesImportCallback=null,this.myVariablesExportCallback=null}},wa=class{constructor(e=r.getMainEngine()){this._myStarted=!1,this._myStartVariable=null,this._myWidgetFrame=new mo("E",1,e),this._myWidgetFrame.registerWidgetVisibleChangedEventListener(this,this._widgetVisibleChanged.bind(this)),this._myConfig=new Da,this._myParams=null,this._myWidgets=[],this._myEasyTuneVariables=null,this._myEasyTuneLastSize=0,this._myVariableNames=null,this._myCurrentWidget=null,this._myCurrentVariable=null,this._myScrollVariableTimer=0,this._myGamepad=null,this._myRefreshVariablesTimer=0,this._myDirty=!1,this._myEngine=e,this._myDestroyed=!1}setCurrentVariable(e){this._myStarted?this._myEasyTuneVariables.has(e)?(this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(e),this._selectCurrentWidget()):console.warn("Can't change easy tune current variable to inexistent variable:",e):this._myStartVariable=e}refresh(){this._myWidgetFrame.isVisible()&&(this._myDirty=!0)}setVisible(e){this._myWidgetFrame.setVisible(e)}isVisible(){return this._myWidgetFrame.isVisible()}start(e,t,n){this._myRightGamepad=r.getRightGamepad(this._myEngine),this._myLeftGamepad=r.getLeftGamepad(this._myEngine),this._myConfig.myGamepadHandedness==U.RIGHT?this._myGamepad=this._myRightGamepad:this._myConfig.myGamepadHandedness==U.LEFT&&(this._myGamepad=this._myLeftGamepad),this._myStarted=!0,this._myParams=t,this._myWidgetFrame.start(e,t),this._myEasyTuneVariables=n,this._myEasyTuneLastSize=this.getValidEasyTuneVariablesLength(),this._myVariableNames=this.getValidEasyTuneVariablesNames(),this.getValidEasyTuneVariablesLength()>0&&(this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(this._myVariableNames[0])),this._myStartVariable!=null&&(this._myEasyTuneVariables.has(this._myStartVariable)?this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(this._myStartVariable):console.warn("Can't change easy tune current variable to inexistent variable:",this._myStartVariable)),this._initializeWidgets()}update(e){this._myWidgetFrame.update(e),(this.getValidEasyTuneVariablesLength()!=this._myEasyTuneLastSize||this._myDirty)&&this._refreshEasyTuneVariables(),this._myWidgetFrame.isVisible()&&this.getValidEasyTuneVariablesLength()>0&&(this._myConfig.myRefreshVariablesDelay!=null&&(this._myRefreshVariablesTimer+=e,this._myRefreshVariablesTimer>this._myConfig.myRefreshVariablesDelay&&(this._myRefreshVariablesTimer=0,this._refreshEasyTuneVariables())),this._myCurrentWidget&&this._myCurrentWidget.update(e),this._myParams.myGamepadScrollVariableEnabled&&this._updateGamepadScrollVariable(e)),this._updateGamepadWidgetVisibility(),this._updateWidgetCurrentVariable()}_initializeWidgets(){let e=new Ta;e.myVariablesImportCallback=this._importVariables.bind(this),e.myVariablesExportCallback=this._exportVariables.bind(this),this._myWidgets[yi.NONE]=new Ra(e,this._myEngine),this._myWidgets[yi.NUMBER]=new Ba(e,this._myGamepad,this._myEngine),this._myWidgets[yi.BOOL]=new Ma(e,this._myGamepad,this._myEngine),this._myWidgets[yi.TRANSFORM]=new ka(e,this._myGamepad,this._myEngine);for(let t of this._myWidgets)t!=null&&(t.start(this._myWidgetFrame.getWidgetObject(),this._myParams),t.setVisible(!1),t.registerScrollVariableRequestEventListener(this,this._scrollVariable.bind(this)));this._selectCurrentWidget()}_selectCurrentWidget(){if(this.getValidEasyTuneVariablesLength()<=0)return;this._myCurrentVariable==null&&(this._myVariableNames=this.getValidEasyTuneVariablesNames(),this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(this._myVariableNames[0]));let e=null;this._myCurrentWidget!=null&&(e=this._myCurrentWidget.getWidget()),this._myCurrentVariable.getType()in this._myWidgets?this._myCurrentWidget=this._myWidgets[this._myCurrentVariable.getType()]:this._myCurrentWidget=this._myWidgets[yi.NONE],this._myCurrentWidget.setEasyTuneVariable(this._myCurrentVariable,this._createIndexString()),this._myCurrentWidget.getWidget().syncWidget(e),e?.setVisible(!1),this._myCurrentWidget.setVisible(this._myWidgetFrame.isVisible())}_refreshEasyTuneVariables(){this._myVariableNames=this.getValidEasyTuneVariablesNames(),this._myEasyTuneLastSize=this.getValidEasyTuneVariablesLength(),this.getValidEasyTuneVariablesLength()>0?(this._myCurrentVariable&&this._myVariableNames.pp_hasEqual(this._myCurrentVariable.getName())?this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(this._myCurrentVariable.getName()):this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(this._myVariableNames[0]),this._selectCurrentWidget()):(this._myCurrentVariable=null,this._myCurrentWidget&&(this._myCurrentWidget.setVisible(!1),this._myCurrentWidget=null)),this._myDirty=!1}_updateGamepadWidgetVisibility(){this._myGamepad&&(this._myGamepad.getButtonInfo(E.BOTTOM_BUTTON).isPressStart()&&this._myGamepad.getButtonInfo(E.TOP_BUTTON).isPressed()||this._myGamepad.getButtonInfo(E.TOP_BUTTON).isPressStart()&&this._myGamepad.getButtonInfo(E.BOTTOM_BUTTON).isPressed())&&this._toggleVisibility()}_toggleVisibility(){this._myWidgetFrame.toggleVisibility()}_widgetVisibleChanged(e){for(let t of this._myWidgets)t?.setVisible(!1);this._myCurrentWidget&&(this.getValidEasyTuneVariablesLength()>0?this._myCurrentWidget.setVisible(e):this._myCurrentWidget.setVisible(!1)),e&&this._refreshEasyTuneVariables()}_updateGamepadScrollVariable(e){if(this._myGamepad&&(!this._myConfig.myScrollVariableButtonID||this._myGamepad.getButtonInfo(this._myConfig.myScrollVariableButtonID).isPressed())){let t=this._myGamepad.getAxesInfo(oe.THUMBSTICK).myAxes[0],n=this._myGamepad.getAxesInfo(oe.THUMBSTICK).myAxes[1];if(Math.abs(t)>this._myConfig.myScrollVariableMinXThreshold&&Math.abs(n)<this._myConfig.myScrollVariableMaxYThreshold)for(this._myScrollVariableTimer+=e;this._myScrollVariableTimer>this._myConfig.myScrollVariableDelay;)this._myScrollVariableTimer-=this._myConfig.myScrollVariableDelay,this._scrollVariable(Math.sign(t));else this._myScrollVariableTimer=this._myConfig.myScrollVariableDelay}else this._myScrollVariableTimer=this._myConfig.myScrollVariableDelay}_scrollVariable(e){if(this.getValidEasyTuneVariablesLength()<=0)return;let t=this._getVariableIndex(this._myCurrentVariable);if(t>=0){let n=((t+e)%this._myVariableNames.length+this._myVariableNames.length)%this._myVariableNames.length;this._myEasyTuneVariables.has(this._myVariableNames[n])?(this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(this._myVariableNames[n]),this._selectCurrentWidget()):this._refreshEasyTuneVariables()}else this._refreshEasyTuneVariables()}_createIndexString(){let e=" (",t=(this._getVariableIndex(this._myCurrentVariable)+1).toString(),n=this.getValidEasyTuneVariablesLength().toString();for(;t.length<n.length;)t="0".concat(t);return e=e.concat(t).concat(" - ").concat(n).concat(")"),e}_getVariableIndex(e){return this._myVariableNames.indexOf(e.getName())}_updateWidgetCurrentVariable(){for(let e of this._myEasyTuneVariables.getEasyTuneVariablesList())e.setWidgetCurrentVariable(!1);this._myWidgetFrame.isVisible()&&this._myCurrentVariable&&this._myCurrentVariable.setWidgetCurrentVariable(!0)}_importVariables(){this._myParams.myVariablesImportCallback(this._onImportSuccess.bind(this),this._onImportFailure.bind(this))}_exportVariables(){this._myParams.myVariablesExportCallback(this._onExportSuccess.bind(this),this._onExportFailure.bind(this))}_onImportSuccess(){this._myCurrentWidget&&this._myCurrentWidget.onImportSuccess()}_onImportFailure(){this._myCurrentWidget&&this._myCurrentWidget.onImportFailure()}_onExportSuccess(){this._myCurrentWidget&&this._myCurrentWidget.onExportSuccess()}_onExportFailure(){this._myCurrentWidget&&this._myCurrentWidget.onExportFailure()}destroy(){this._myDestroyed=!0;for(let e of this._myWidgets)e.destroy();this._myWidgetFrame.destroy()}isDestroyed(){return this._myDestroyed}getValidEasyTuneVariablesLength(){return this.getValidEasyTuneVariablesNames().length}getValidEasyTuneVariablesNames(){let e=this._myEasyTuneVariables.getEasyTuneVariablesNames(),t=[];for(let n of e)this._myEasyTuneVariables.getEasyTuneVariable(n).shouldShowOnWidget()&&t.push(n);return t}};var Mn=class extends lO{init(){this.object.pp_addComponent(Bt),this._myWidget=new wa(this.engine),ke.addSetWidgetCurrentVariableCallback(this,function(e){this._myWidget.setCurrentVariable(e)}.bind(this),this.engine),ke.addRefreshWidgetCallback(this,function(){this._myWidget.refresh()}.bind(this),this.engine),this._myStarted=!1}start(){if(r.isToolEnabled(this.engine)){let e=new Fa;e.myHandedness=[null,"left","right"][this._myHandedness],e.myShowOnStart=this._myShowOnStart,e.myShowVisibilityButton=this._myShowVisibilityButton,e.myShowAdditionalButtons=!0,e.myGamepadScrollVariableEnabled=this._myGamepadScrollVariableEnabled,e.myPlaneMaterial=r.getDefaultMaterials(this.engine).myFlatOpaque.clone(),e.myTextMaterial=r.getDefaultMaterials(this.engine).myText.clone(),e.myShowVariablesImportExportButtons=this._myShowVariablesImportExportButtons,e.myVariablesImportCallback=function(t,n){ke.importVariables(this._myVariablesImportURL,this._myResetVariablesDefaultValueOnImport,t,n,this.engine)}.bind(this),e.myVariablesExportCallback=function(t,n){ke.exportVariables(this._myVariablesExportURL,t,n,this.engine)}.bind(this),this._myWidget.start(this.object,e,r.getEasyTuneVariables(this.engine)),this._myWidgetVisibleBackup=null,this._myStarted=!0,this._myFirstUpdate=!0}}update(e){r.isToolEnabled(this.engine)?this._myStarted&&(this._myFirstUpdate&&(this._myFirstUpdate=!1,this._myImportVariablesOnStart&&ke.importVariables(this._myVariablesImportURL,this._myResetVariablesDefaultValueOnImport,void 0,void 0,this.engine)),this._myWidgetVisibleBackup!=null&&(this._myWidget.setVisible(!1),this._myWidget.setVisible(this._myWidgetVisibleBackup),this._myWidgetVisibleBackup=null),this._myWidget.update(e)):this._myStarted&&(this._myWidgetVisibleBackup==null&&(this._myWidgetVisibleBackup=this._myWidget.isVisible()),this._myWidget.isVisible()&&this._myWidget.setVisible(!1))}onDeactivate(){this._myStarted&&(this._myWidgetVisibleBackup==null&&(this._myWidgetVisibleBackup=this._myWidget.isVisible()),this._myWidget.isVisible()&&this._myWidget.setVisible(!1))}onDestroy(){this._myWidget.destroy(),ke.removeSetWidgetCurrentVariableCallback(this,this.engine),ke.removeRefreshWidgetCallback(this,this.engine)}};R(Mn,"TypeName","pp-easy-tune-tool"),R(Mn,"Properties",{_myHandedness:Ai.enum(["None","Left","Right"],"None"),_myShowOnStart:Ai.bool(!1),_myShowVisibilityButton:Ai.bool(!1),_myGamepadScrollVariableEnabled:Ai.bool(!0),_myShowVariablesImportExportButtons:Ai.bool(!1),_myVariablesImportURL:Ai.string(""),_myVariablesExportURL:Ai.string(""),_myImportVariablesOnStart:Ai.bool(!1),_myResetVariablesDefaultValueOnImport:Ai.bool(!1)});import{Component as mO,Property as Eb}from"@wonderlandengine/api";var Dn=class extends mO{start(){this._myFirstUpdate=!0}update(e){this._myFirstUpdate&&(this._myFirstUpdate=!1,ke.importVariables(this._myVariablesImportURL,this._myResetVariablesDefaultValueOnImport,void 0,void 0,this.engine))}};R(Dn,"TypeName","pp-easy-tune-import-variables"),R(Dn,"Properties",{_myVariablesImportURL:Eb.string(""),_myResetVariablesDefaultValueOnImport:Eb.bool(!0)});var rt=class{constructor(e,t,n,o,s=r.getMainEngine()){this._myObject=e,this._myUseTuneTarget=o,this._mySetAsWidgetCurrentVariable=n,this._myEasyObject=this._myObject,this._myUseTuneTarget&&(this._myEasyObject=r.getEasyTuneTarget(s)),this._myPrevEasyObject=null;let a=this._getVariableNamePrefix();if(t==""){let l=this._myObject.pp_getName();l!=""?this._myEasyTuneVariableName=a.concat(l):this._myEasyTuneVariableName=a.concat(this._myObject.pp_getID())}else this._myEasyTuneVariableName=a.concat(t);this._myEngine=s}start(){let e=this._createEasyTuneVariable(this._myEasyTuneVariableName);r.getEasyTuneVariables(this._myEngine).add(e),this._mySetAsWidgetCurrentVariable&&ke.setWidgetCurrentVariable(this._myEasyTuneVariableName,this._myEngine)}update(e){if(r.getEasyTuneVariables(this._myEngine).isWidgetCurrentVariable(this._myEasyTuneVariableName)){if(this._myUseTuneTarget&&(this._myEasyObject=r.getEasyTuneTarget(this._myEngine)),this._myPrevEasyObject!=this._myEasyObject)if(this._myPrevEasyObject=this._myEasyObject,this._myEasyObject){let t=this._getObjectValue(this._myEasyObject);r.getEasyTuneVariables(this._myEngine).set(this._myEasyTuneVariableName,t,!0)}else{let t=this._getDefaultValue();r.getEasyTuneVariables(this._myEngine).set(this._myEasyTuneVariableName,t,!0)}this._myEasyObject&&this._updateObjectValue(this._myEasyObject,r.getEasyTuneVariables(this._myEngine).get(this._myEasyTuneVariableName))}}};import{LightComponent as Ab}from"@wonderlandengine/api";var ja=class extends rt{constructor(e,t,n,o){super(e,t,n,o)}_getVariableNamePrefix(){return"Light Attenuation "}_createEasyTuneVariable(e){return new Xi(e,this._getDefaultValue(),null,!0,3,.01,0,1)}_getObjectValue(e){return this._getLightAttenuation(e)}_getDefaultValue(){return 0}_updateObjectValue(e,t){let n=t,o=e.pp_getComponent(Ab);o&&(o.color[3]=n)}_getLightAttenuation(e){let t=this._getDefaultValue(),n=e.pp_getComponent(Ab);return n&&(t=n.color[3]),t}};import{LightComponent as Rb}from"@wonderlandengine/api";var za=class extends rt{constructor(e,t,n,o,s,a){super(t,n,o,s,a),this._myColorModel=e}_getVariableNamePrefix(){let e=null;return this._myColorModel==0?e="Light RGB ":e="Light HSV ",e}_createEasyTuneVariable(e){return new Ei(e,this._getDefaultValue(),null,!0,100,0,255)}_getObjectValue(e){let t=null,n=this._getLightColor(e);return n?this._myColorModel==0?t=ce.rgbCodeToHuman(n):t=ce.hsvCodeToHuman(ce.rgbToHSV(n)):t=this._getDefaultValue(),t}_getDefaultValue(){return c()}_updateObjectValue(e,t){let n=t;this._myColorModel==0?n=ce.rgbHumanToCode(n):n=ce.hsvToRGB(ce.hsvHumanToCode(n));let o=e.pp_getComponent(Rb);if(o!=null&&(o.color[0]=n[0],o.color[1]=n[1],o.color[2]=n[2]),r.getRightGamepad(this._myEngine).getButtonInfo(E.TOP_BUTTON).isPressStart()&&r.getLeftGamepad(this._myEngine).getButtonInfo(E.TOP_BUTTON).isPressed()||r.getLeftGamepad(this._myEngine).getButtonInfo(E.TOP_BUTTON).isPressStart()&&r.getRightGamepad(this._myEngine).getButtonInfo(E.TOP_BUTTON).isPressed()){let s=ce.color1To255(ce.rgbToHSV(n)),a=ce.color1To255(n);console.log("RGB:",a.vec_toString(0),"- HSV:",s.vec_toString(0))}}_getLightColor(e){let t=null,n=e.pp_getComponent(Rb);return n&&(t=n.color.slice(0,3)),t}};import{MeshComponent as yO}from"@wonderlandengine/api";var Na=class extends rt{constructor(e,t,n,o,s,a,l){super(n,o,s,a,l),this._myColorModel=e,this._myColorType=t,this._myColorVariableNames=["color","diffuseColor","ambientColor","specularColor","emissiveColor","fogColor","ambientFactor"]}_getVariableNamePrefix(){let e=null;return this._myColorModel==0?e="Mesh RGB ":e="Mesh HSV ",e}_createEasyTuneVariable(e){return this._myColorType==6?new Di(e,this._getDefaultValue(),null,!0,3,.1,0,1):new Ei(e,this._getDefaultValue(),null,!0,100,0,255)}_getObjectValue(e){let t=null,n=this._getMeshMaterial(e);return n?this._myColorType!=6?(t=n[this._myColorVariableNames[this._myColorType]].pp_clone(),this._myColorModel==0?t=ce.rgbCodeToHuman(t):t=ce.hsvCodeToHuman(ce.rgbToHSV(t))):t=[n[this._myColorVariableNames[this._myColorType]]]:t=this._getDefaultValue(),t}_getDefaultValue(){return this._myColorType==6?[0]:F()}_updateObjectValue(e,t){let n=t;this._myColorType!=6&&(this._myColorModel==0?n=ce.rgbHumanToCode(n):n=ce.hsvToRGB(ce.hsvHumanToCode(n)));let o=this._getMeshMaterial(e);if(o&&(o[this._myColorVariableNames[this._myColorType]]=n),this._myColorType!=6&&(r.getRightGamepad(this._myEngine).getButtonInfo(E.TOP_BUTTON).isPressStart()&&r.getLeftGamepad(this._myEngine).getButtonInfo(E.TOP_BUTTON).isPressed()||r.getLeftGamepad(this._myEngine).getButtonInfo(E.TOP_BUTTON).isPressStart()&&r.getRightGamepad(this._myEngine).getButtonInfo(E.TOP_BUTTON).isPressed())){let s=ce.color1To255(ce.rgbToHSV(n)),a=ce.color1To255(n);console.log("RGB:",a.vec_toString(0),"- HSV:",s.vec_toString(0))}}_getMeshMaterial(e){let t=null,n=e.pp_getComponent(yO);return n&&(t=n.material),t}};var Ga=class extends rt{constructor(e,t,n,o,s,a,l){super(n,o,s,a,l),this._myLocal=e,this._myScaleAsOne=t}_getVariableNamePrefix(){return"Scale "}_createEasyTuneVariable(e){return new Di(e,this._getDefaultValue(),null,!0,3,1,.001,null,this._myScaleAsOne)}_getObjectValue(e){return this._myLocal?e.pp_getScaleLocal():e.pp_getScale()}_getDefaultValue(){return c(1,1,1)}_updateObjectValue(e,t){this._myLocal?e.pp_setScaleLocal(t):e.pp_setScale(t)}};var Wa=class extends rt{constructor(e,t,n,o,s,a,l){super(n,o,s,a,l),this._myLocal=e,this._myScaleAsOne=t}_getVariableNamePrefix(){return"Transform "}_createEasyTuneVariable(e){return new co(e,this._getDefaultValue(),null,!0,this._myScaleAsOne,3)}_getObjectValue(e){return this._myLocal?e.pp_getTransformLocal():e.pp_getTransform()}_getDefaultValue(){return be()}_updateObjectValue(e,t){this._myLocal?e.pp_setTransformLocal(t):e.pp_setTransform(t)}};import{MeshComponent as uO}from"@wonderlandengine/api";var Ua=class extends rt{constructor(e,t,n,o,s){super(e,t,n,o,s)}_getVariableNamePrefix(){let e=null;return this._myColorModel==0,e="Mesh AF ",e}_createEasyTuneVariable(e){return new Xi(e,this._getDefaultValue(),null,!0,3,.1,0,1)}_getObjectValue(e){let t=null,n=this._getMeshMaterial(e);return n?t=n.ambientFactor:t=this._getDefaultValue(),t}_getDefaultValue(){return 0}_updateObjectValue(e,t){let n=t,o=this._getMeshMaterial(e);o&&(o.ambientFactor=n)}_getMeshMaterial(e){let t=null,n=e.pp_getComponent(uO);return n&&(t=n.material),t}};import{TextComponent as hO}from"@wonderlandengine/api";var Qa=class extends rt{constructor(e,t,n,o,s,a,l){super(n,o,s,a,l),this._myColorModel=e,this._myColorType=t,this._myColorVariableNames=["color","effectColor"]}_getVariableNamePrefix(){let e=null;return this._myColorModel==0?e="Text RGB ":e="Text HSV ",e}_createEasyTuneVariable(e){return new Ei(e,this._getDefaultValue(),null,!0,100,0,255)}_getObjectValue(e){let t=null,n=this._getTextMaterial(e);return n?(t=n[this._myColorVariableNames[this._myColorType]].pp_clone(),this._myColorModel==0?t=ce.rgbCodeToHuman(t):t=ce.hsvCodeToHuman(ce.rgbToHSV(t))):t=this._getDefaultValue(),t}_getDefaultValue(){return F()}_updateObjectValue(e,t){let n=t;this._myColorModel==0?n=ce.rgbHumanToCode(n):n=ce.hsvToRGB(ce.hsvHumanToCode(n));let o=this._getTextMaterial(e);if(o&&(o[this._myColorVariableNames[this._myColorType]]=n),r.getRightGamepad(this._myEngine).getButtonInfo(E.TOP_BUTTON).isPressStart()&&r.getLeftGamepad(this._myEngine).getButtonInfo(E.TOP_BUTTON).isPressed()||r.getLeftGamepad(this._myEngine).getButtonInfo(E.TOP_BUTTON).isPressStart()&&r.getRightGamepad(this._myEngine).getButtonInfo(E.TOP_BUTTON).isPressed()){let s=ce.color1To255(ce.rgbToHSV(n)),a=ce.color1To255(n);console.log("RGB:",a.vec_toString(0),"- HSV:",s.vec_toString(0))}}_getTextMaterial(e){let t=null,n=e.pp_getComponent(hO);return n&&(t=n.material),t}};import{Component as cO,Property as um}from"@wonderlandengine/api";var En=class extends cO{init(){this._myEasyObjectTuner=null,r.isToolEnabled(this.engine)&&(this._myEasyObjectTuner=new ja(this.object,this._myVariableName,this._mySetAsWidgetCurrentVariable,this._myUseTuneTarget))}start(){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.start()}update(e){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.update(e)}};R(En,"TypeName","pp-easy-light-attenuation"),R(En,"Properties",{_myVariableName:um.string(""),_mySetAsWidgetCurrentVariable:um.bool(!1),_myUseTuneTarget:um.bool(!1)});import{Component as pO,Property as Ur}from"@wonderlandengine/api";var An=class extends pO{init(){this._myEasyObjectTuner=null,r.isToolEnabled(this.engine)&&(this._myEasyObjectTuner=new za(this._myColorModel,this.object,this._myVariableName,this._mySetAsWidgetCurrentVariable,this._myUseTuneTarget))}start(){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.start()}update(e){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.update(e)}};R(An,"TypeName","pp-easy-light-color"),R(An,"Properties",{_myVariableName:Ur.string(""),_mySetAsWidgetCurrentVariable:Ur.bool(!1),_myUseTuneTarget:Ur.bool(!1),_myColorModel:Ur.enum(["RGB","HSV"],"HSV")});import{Component as dO,Property as hm}from"@wonderlandengine/api";var Rn=class extends dO{init(){this._myEasyObjectTuner=null,r.isToolEnabled(this.engine)&&(this._myEasyObjectTuner=new Ua(this.object,this._myVariableName,this._mySetAsWidgetCurrentVariable,this._myUseTuneTarget))}start(){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.start()}update(e){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.update(e)}pp_clone(e){return z.cloneDefault(this,e)}};R(Rn,"TypeName","pp-easy-mesh-ambient-factor"),R(Rn,"Properties",{_myVariableName:hm.string(""),_myUseTuneTarget:hm.bool(!1),_mySetAsWidgetCurrentVariable:hm.bool(!1)});import{Component as _O,Property as qa}from"@wonderlandengine/api";var On=class extends _O{init(){this._myEasyObjectTuner=null,r.isToolEnabled(this.engine)&&(this._myEasyObjectTuner=new Na(this._myColorModel,this._myColorType,this.object,this._myVariableName,this._mySetAsWidgetCurrentVariable,this._myUseTuneTarget))}start(){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.start()}update(e){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.update(e)}pp_clone(e){return z.cloneDefault(this,e)}};R(On,"TypeName","pp-easy-mesh-color"),R(On,"Properties",{_myVariableName:qa.string(""),_myUseTuneTarget:qa.bool(!1),_mySetAsWidgetCurrentVariable:qa.bool(!1),_myColorModel:qa.enum(["RGB","HSV"],"HSV"),_myColorType:qa.enum(["Color","Diffuse Color","Ambient Color","Specular Color","Emissive Color","Fog Color","Ambient Factor"],"Color")});import{Component as gO,Property as Xa}from"@wonderlandengine/api";var Vn=class extends gO{init(){this._myEasyObjectTuner=null,r.isToolEnabled(this.engine)&&(this._myEasyObjectTuner=new Ga(this._myLocal,this._myScaleAsOne,this.object,this._myVariableName,this._mySetAsWidgetCurrentVariable,this._myUseTuneTarget))}start(){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.start()}update(e){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.update(e)}};R(Vn,"TypeName","pp-easy-scale"),R(Vn,"Properties",{_myVariableName:Xa.string(""),_mySetAsWidgetCurrentVariable:Xa.bool(!1),_myUseTuneTarget:Xa.bool(!1),_myLocal:Xa.bool(!1),_myScaleAsOne:Xa.bool(!0)});import{Component as fO,Property as Ob}from"@wonderlandengine/api";var In=class extends fO{start(){if(r.isToolEnabled(this.engine)){this._myEasyTuneVariableName="Target Child ",this._myVariableName==""?this._myEasyTuneVariableName=this._myEasyTuneVariableName.concat(this.object.pp_getID()):this._myEasyTuneVariableName=this._myEasyTuneVariableName.concat(this._myVariableName);let e=this.object.pp_getChildren().length,t=1,n=e;e==0&&(t=0,n=0),r.getEasyTuneVariables(this.engine).add(new fa(this._myEasyTuneVariableName,0,null,!0,10,t,n)),this._mySetAsWidgetCurrentVariable&&ke.setWidgetCurrentVariable(this._myEasyTuneVariableName,this.engine),this._myCurrentChildIndex=-1,this._myCurrentChildrenCount=e,this._myEasyTuneTarget=null}}update(e){if(r.isToolEnabled(this.engine)&&r.getEasyTuneVariables(this.engine).isWidgetCurrentVariable(this._myEasyTuneVariableName)){let t=this.object.pp_getChildren().length;if(t!=this._myCurrentChildrenCount){this._myCurrentChildrenCount=t;let o=1,s=t;t==0&&(o=0,s=0);let a=r.getEasyTuneVariables(this.engine).getEasyTuneVariable(this._myEasyTuneVariableName);a.setMin(o),a.setMax(s)}let n=r.getEasyTuneVariables(this.engine).get(this._myEasyTuneVariableName);n!=this._myCurrentChildIndex&&(n==0&&this._myCurrentChildIndex!=-1?(r.getEasyTuneTarget(this.engine)==this._myEasyTuneTarget&&r.removeEasyTuneTarget(this.engine),this._myEasyTuneTarget=null):n>0&&(this._myEasyTuneTarget=this.object.pp_getChildren()[n-1],r.setEasyTuneTarget(this._myEasyTuneTarget,this.engine)),this._myCurrentChildIndex=n)}}};R(In,"TypeName","pp-easy-set-tune-target-child-number"),R(In,"Properties",{_myVariableName:Ob.string(""),_mySetAsWidgetCurrentVariable:Ob.bool(!1)});import{Component as TO}from"@wonderlandengine/api";var Bn=class extends TO{start(){this._myGrabber=null,r.isToolEnabled(this.engine)&&(this._myGrabber=this.object.pp_getComponent(fi),this._myEasyTuneTarget=null)}_onRelease(e,t){r.isToolEnabled(this.engine)&&(this._myEasyTuneTarget=t.object,r.setEasyTuneTarget(this._myEasyTuneTarget,this.engine))}_onGrab(e,t){r.isToolEnabled(this.engine)&&(r.getEasyTuneTarget(this.engine)==this._myEasyTuneTarget&&r.removeEasyTuneTarget(this.engine),this._myEasyTuneTarget=null)}onActivate(){this._myGrabber!=null&&this._myGrabber.registerThrowEventListener(this,this._onRelease.bind(this))}onDeactivate(){this._myGrabber!=null&&this._myGrabber.unregisterThrowEventListener(this)}};R(Bn,"TypeName","pp-easy-set-tune-target-grab"),R(Bn,"Properties",{});import{Component as PO,Property as Ka}from"@wonderlandengine/api";var Ln=class extends PO{init(){this._myEasyObjectTuner=null,r.isToolEnabled(this.engine)&&(this._myEasyObjectTuner=new Qa(this._myColorModel,this._myColorType,this.object,this._myVariableName,this._mySetAsWidgetCurrentVariable,this._myUseTuneTarget))}start(){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.start()}update(e){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.update(e)}};R(Ln,"TypeName","pp-easy-text-color"),R(Ln,"Properties",{_myVariableName:Ka.string(""),_mySetAsWidgetCurrentVariable:Ka.bool(!1),_myUseTuneTarget:Ka.bool(!1),_myColorModel:Ka.enum(["RGB","HSV"],"HSV"),_myColorType:Ka.enum(["Color","Effect Color"],"Color")});import{Component as CO,Property as Ja}from"@wonderlandengine/api";var Hn=class extends CO{init(){this._myEasyObjectTuner=null,r.isToolEnabled(this.engine)&&(this._myEasyObjectTuner=new Wa(this._myLocal,this._myScaleAsOne,this.object,this._myVariableName,this._mySetAsWidgetCurrentVariable,this._myUseTuneTarget))}start(){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.start()}update(e){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.update(e)}pp_clone(e){return z.cloneDefault(this,e)}};R(Hn,"TypeName","pp-easy-transform"),R(Hn,"Properties",{_myVariableName:Ja.string(""),_mySetAsWidgetCurrentVariable:Ja.bool(!1),_myUseTuneTarget:Ja.bool(!1),_myLocal:Ja.bool(!0),_myScaleAsOne:Ja.bool(!0)});export{_i as AddPPToWindowComponent,ci as AddWLToWindowComponent,sn as AdjustHierarchyPhysXScaleComponent,K as ArrayUtils,ys as AudioEvent,us as AudioManager,Zt as AudioManagerComponent,kn as AudioPlayer,ji as AudioSetup,EA as AudioUtils,_s as BaseGamepad,Ge as BasePose,Mt as BasePoseParams,en as BenchmarkMaxPhysXComponent,tn as BenchmarkMaxVisibleTrianglesComponent,Jn as BrowserUtils,cn as CADisplayLeaderboardComponent,Vs as CADummyServer,we as CAError,de as CAUtils,Fs as CharacterColliderAdditionalParams,ws as CharacterColliderDebugParams,Bs as CharacterColliderHorizontalCheckParams,qC as CharacterColliderHorizontalPositionVerticalCheckDirection,to as CharacterColliderSetup,io as CharacterColliderSetupSimplifiedCreationAccuracyLevel,zs as CharacterColliderSetupSimplifiedCreationParams,nm as CharacterColliderSetupUtils,js as CharacterColliderSlideFlickerPreventionMode,ks as CharacterColliderSplitMovementParams,Qo as CharacterColliderSurfaceParams,Ls as CharacterColliderVerticalCheckParams,Hs as CharacterColliderWallSlideParams,No as CharacterCollisionCheckTransformResults,Qi as CharacterCollisionCheckType,Wo as CharacterCollisionDebugResults,Uo as CharacterCollisionInternalResults,Ui as CharacterCollisionMovementResults,Ue as CharacterCollisionResults,Go as CharacterCollisionSplitMovementResults,$n as CharacterCollisionSurfaceInfo,eo as CharacterCollisionSurfaceResults,qo as CharacterCollisionSystem,pn as CharacterCollisionSystemComponent,zo as CharacterCollisionTeleportResults,jo as CharacterCollisionTransformResults,wo as CharacterCollisionWallSlideResults,xo as ClassicGamepadCore,nn as ClearConsoleOnXRSessionStartComponent,Xt as CloneParams,G as CollisionCheck,q as CollisionCheckBridge,st as CollisionCheckParams,Is as CollisionCheckUtils,_e as CollisionRuntimeParams,ce as ColorUtils,z as ComponentUtils,Ee as ConsoleOriginalFunctions,Cs as ConsoleVR,xn as ConsoleVRToolComponent,_a as ConsoleVRWidget,ma as ConsoleVRWidgetConfig,le as ConsoleVRWidgetConsoleFunction,da as ConsoleVRWidgetMessage,k as ConsoleVRWidgetMessageType,pa as ConsoleVRWidgetParams,la as ConsoleVRWidgetPulseOnNewMessage,Be as ConsoleVRWidgetSender,ua as ConsoleVRWidgetUI,Cn as CopyHandTransformComponent,bn as CopyHeadTransformComponent,Sn as CopyPlayerTransformComponent,vn as CopyReferenceSpaceTransformComponent,as as CustomCloneParams,mn as DebugArrayFunctionsPerformanceAnalyzerComponent,ko as DebugFunctionPerformanceAnalysisResults,Ho as DebugFunctionsOverwriter,Lo as DebugFunctionsOverwriterParams,Rs as DebugFunctionsPerformanceAnalysisResultsLogger,As as DebugFunctionsPerformanceAnalysisResultsLoggerParams,Zn as DebugFunctionsPerformanceAnalyzer,$e as DebugFunctionsPerformanceAnalyzerComponent,Fo as DebugFunctionsPerformanceAnalyzerParams,Gt as DebugFunctionsPerformanceAnalyzerSortOrder,ps as DebugManager,ei as DebugManagerComponent,yn as DebugPPArrayCreationPerformanceAnalyzerComponent,ln as DebugPPFunctionsPerformanceAnalyzerComponent,rn as DebugTransformComponent,Ni as DebugVisualManager,hn as DebugWLComponentsFunctionsPerformanceAnalyzerComponent,un as DebugWLFunctionsPerformanceAnalyzerComponent,Kt as DeepCloneParams,ms as DefaultResources,Mr as DefaultResourcesMaterials,xr as DefaultResourcesMeshes,bo as DefaultWLComponentCloneCallbacks,ri as Direction2DTo3DConverter,Yn as Direction2DTo3DConverterParams,ir as EPSILON,Bm as EPSILON_DEGREES,Im as EPSILON_SQUARED,he as EasingFunction,ja as EasyLightAttenuation,En as EasyLightAttenuationComponent,za as EasyLightColor,An as EasyLightColorComponent,Ua as EasyMeshAmbientFactor,Rn as EasyMeshAmbientFactorComponent,Na as EasyMeshColor,On as EasyMeshColorComponent,rt as EasyObjectTuner,Ga as EasyScale,Vn as EasyScaleComponent,Bn as EasySetTuneTargeetGrabComponent,In as EasySetTuneTargetChildNumberComponent,Qa as EasyTextColor,Ln as EasyTextColorComponent,Wa as EasyTransform,Hn as EasyTransformComponent,po as EasyTuneBaseArrayWidgetSelector,Ut as EasyTuneBaseWidget,Qt as EasyTuneBaseWidgetConfig,Ta as EasyTuneBaseWidgetParams,qt as EasyTuneBaseWidgetUI,rm as EasyTuneBool,Gr as EasyTuneBoolArray,xa as EasyTuneBoolArrayWidget,Pa as EasyTuneBoolArrayWidgetConfig,Ma as EasyTuneBoolArrayWidgetSelector,va as EasyTuneBoolArrayWidgetUI,Dn as EasyTuneImportVariablesComponent,fa as EasyTuneInt,Ei as EasyTuneIntArray,Ra as EasyTuneNoneWidget,Ea as EasyTuneNoneWidgetConfig,Aa as EasyTuneNoneWidgetUI,Xi as EasyTuneNumber,Di as EasyTuneNumberArray,Ia as EasyTuneNumberArrayWidget,Oa as EasyTuneNumberArrayWidgetConfig,Ba as EasyTuneNumberArrayWidgetSelector,Va as EasyTuneNumberArrayWidgetUI,Mn as EasyTuneToolComponent,co as EasyTuneTransform,ka as EasyTuneTransformWidget,La as EasyTuneTransformWidgetConfig,Ha as EasyTuneTransformWidgetUI,ke as EasyTuneUtils,ho as EasyTuneVariable,mi as EasyTuneVariableArray,yi as EasyTuneVariableType,bs as EasyTuneVariables,wa as EasyTuneWidget,Da as EasyTuneWidgetConfig,Fa as EasyTuneWidgetParams,pi as EnableDebugComponent,di as EnableToolComponent,it as FSM,Ti as FingerCursorComponent,si as GamepadAxesEvent,oe as GamepadAxesID,Gn as GamepadAxesInfo,re as GamepadButtonEvent,E as GamepadButtonID,Nn as GamepadButtonInfo,fn as GamepadControlSchemeComponent,zt as GamepadCore,Hi as GamepadMeshAnimatorComponent,Wn as GamepadPulseInfo,RR as GamepadUtils,gs as GamepadsManager,Lt as GetDefaultResourcesComponent,Ht as GetSceneObjectsComponent,r as Globals,gi as GrabbableComponent,fi as GrabberHandComponent,Qn as HandPose,Un as HandPoseParams,A as Handedness,Bi as HandednessIndex,fs as HeadPose,Ql as HowlerAudioPlayer,It as InitConsoleVRComponent,Bt as InitEasyTuneVariablesComponent,Ps as InputManager,Vt as InputManagerComponent,Ye as InputSourceType,ie as InputUtils,Yl as IntOverFactor,$l as IntRangeOverFactor,$ as JSUtils,ee as KeyID,ds as Keyboard,Mo as KeyboardGamepadCore,Y as Mat3Utils,O as Mat4Utils,Es as MaterialUtils,L as MathUtils,Co as MeshCreationParams,Ii as MeshCreationTriangleParams,Po as MeshCreationVertexParams,Oe as MeshUtils,Ts as Mouse,Gi as MouseButtonID,Yi as MuteEverythingComponent,xi as NumberOverFactor,Br as NumberRangeOverFactor,wn as ObjectPool,hs as ObjectPoolManager,Yt as ObjectPoolManagerComponent,Fn as ObjectPoolParams,y as ObjectUtils,Zi as PPGatewayComponent,vs as PerformDelayedMode,vi as PerformMode,Si as PhysicsCollisionCollector,Ve as PhysicsLayerFlags,De as PhysicsUtils,ae as PlayerHeadManager,Xo as PlayerHeadManagerParams,ea as PlayerLocomotion,dn as PlayerLocomotionComponent,Fr as PlayerLocomotionDirectionReferenceType,no as PlayerLocomotionMovement,Ws as PlayerLocomotionMovementRuntimeParams,$s as PlayerLocomotionParams,Mi as PlayerLocomotionRotate,Gs as PlayerLocomotionRotateParams,li as PlayerLocomotionSmooth,ta as PlayerLocomotionSmoothParams,Ko as PlayerLocomotionTeleport,Xs as PlayerLocomotionTeleportDetectionParams,Hr as PlayerLocomotionTeleportDetectionRuntimeParams,dt as PlayerLocomotionTeleportDetectionState,qi as PlayerLocomotionTeleportDetectionVisualizer,qs as PlayerLocomotionTeleportDetectionVisualizerParams,Wt as PlayerLocomotionTeleportParable,Ys as PlayerLocomotionTeleportParams,kr as PlayerLocomotionTeleportRuntimeParams,bt as PlayerLocomotionTeleportState,Ks as PlayerLocomotionTeleportTeleportBlinkState,Js as PlayerLocomotionTeleportTeleportParams,oo as PlayerLocomotionTeleportTeleportShiftState,Zs as PlayerLocomotionTeleportTeleportState,so as PlayerLocomotionTeleportTeleportType,om as PlayerLocomotionType,vr as PlayerObjects,Qs as PlayerObscureManager,Us as PlayerObscureManagerParams,at as PlayerTransformManager,Ns as PlayerTransformManagerParams,pe as PlayerTransformManagerSyncFlag,xe as PluginUtils,V as Quat2Utils,T as QuatUtils,mt as RaycastHit,ct as RaycastParams,Fe as RaycastResults,Kl as SaveManager,Nt as SaveUtils,ls as SceneObjects,Z as SceneUtils,on as SetActiveComponent,ki as SetHandLocalTransformComponent,Pi as SetHeadLocalTransformComponent,Pn as SetPlayerHeightComponent,Fi as SetTrackedHandJointLocalTransformComponent,an as ShowFPSComponent,Vo as SkipStateFunction,$i as SpatialAudioListenerComponent,Kn as State,Io as StateData,_n as SwitchHandObjectComponent,XA as TextUtils,ne as Timer,Ms as TimerState,wi as ToolCursorComponent,U as ToolHandedness,Re as ToolInputSourceType,gn as TrackedHandDrawAllJointsComponent,ti as TrackedHandDrawJointComponent,Li as TrackedHandDrawSkinComponent,lt as TrackedHandJointID,So as TrackedHandJointIDIndex,Ao as TrackedHandJointPose,Ro as TrackedHandPose,qn as TrackedHandPoseParams,Zl as Transition,Bo as TransitionData,Eo as UniversalGamepad,ft as Vec2Utils,p as Vec3Utils,Vi as Vec4Utils,Tt as VecUtils,aa as VirtualGamepad,Dt as VirtualGamepadButtonParams,Tn as VirtualGamepadComponent,Jo as VirtualGamepadGamepadCore,ao as VirtualGamepadIcon,Zo as VirtualGamepadIconParams,Ie as VirtualGamepadIconType,ro as VirtualGamepadParams,na as VirtualGamepadThumbstickParams,oa as VirtualGamepadVirtualButton,sa as VirtualGamepadVirtualThumbstick,tt as VisualArrow,Ne as VisualArrowParams,Me as VisualElementType,ht as VisualLine,et as VisualLineParams,zn as VisualManager,$t as VisualManagerComponent,Ci as VisualMesh,ii as VisualMeshParams,kt as VisualPoint,xt as VisualPointParams,jn as VisualRaycast,ni as VisualRaycastParams,cs as VisualResources,Dr as VisualResourcesMaterials,zi as VisualText,Ft as VisualTextParams,jt as VisualTorus,wt as VisualTorusParams,oi as VisualTransform,Rt as VisualTransformParams,mo as WidgetFrame,ha as WidgetFrameConfig,ca as WidgetFrameUI,lo as WidgetParams,Do as XRGamepadCore,I as XRUtils,Ly as add,Fd as addComponent,sl as addEngine,vb as addRefreshWidgetCallback,bb as addSetWidgetCurrentVariableCallback,Ry as angle,Jm as angleClamp,Zm as angleClampDegrees,Ym as angleClampRadians,Oy as angleDegrees,Wm as angleDistance,Um as angleDistanceDegrees,Qm as angleDistanceRadians,qm as angleDistanceSigned,Xm as angleDistanceSignedDegrees,Km as angleDistanceSignedRadians,Xy as anglePivoted,Ky as anglePivotedDegrees,Jy as anglePivotedRadians,Zy as anglePivotedSigned,Yy as anglePivotedSignedDegrees,$y as anglePivotedSignedRadians,Vy as angleRadians,Uy as angleSigned,Qy as angleSignedDegrees,qy as angleSignedRadians,nb as areButtonsPressEnd,ib as areButtonsPressStart,rb as areButtonsTouchEnd,sb as areButtonsTouchStart,LP as assert,Nf as ceil,wC as checkMovement,jC as checkTeleportToTransform,zC as checkTransform,tT as cleanObjectProperties,dT as cloneCollision,LT as cloneDefault,pT as cloneMesh,gT as clonePhysX,BT as clonePostProcess,_T as cloneText,aC as color1To255,sC as color255To1,iu as componentAlongAxis,QC as convertCharacterColliderSetupToCollisionCheckParams,WC as convertCharacterCollisionResultsToCollisionRuntimeParams,UC as convertCollisionRuntimeParamsToCharacterCollisionResults,Td as convertDirectionLocalToObject,cd as convertDirectionLocalToWorld,gd as convertDirectionObjectToLocal,md as convertDirectionObjectToWorld,Su as convertDirectionToLocal,xu as convertDirectionToLocalMatrix,Du as convertDirectionToLocalQuat,bu as convertDirectionToWorld,vu as convertDirectionToWorldMatrix,Mu as convertDirectionToWorldQuat,dd as convertDirectionWorldToLocal,ud as convertDirectionWorldToObject,fd as convertPositionLocalToObject,hd as convertPositionLocalToWorld,_d as convertPositionObjectToLocal,ld as convertPositionObjectToWorld,gu as convertPositionToLocal,Tu as convertPositionToLocalMatrix,Cu as convertPositionToLocalQuat,_u as convertPositionToWorld,fu as convertPositionToWorldMatrix,Pu as convertPositionToWorldQuat,pd as convertPositionWorldToLocal,yd as convertPositionWorldToObject,Ld as convertTransformLocalToObject,Hd as convertTransformLocalToObjectMatrix,kd as convertTransformLocalToObjectQuat,Md as convertTransformLocalToWorld,Dd as convertTransformLocalToWorldMatrix,Ed as convertTransformLocalToWorldQuat,Vd as convertTransformObjectToLocal,Id as convertTransformObjectToLocalMatrix,Bd as convertTransformObjectToLocalQuat,Pd as convertTransformObjectToWorld,Cd as convertTransformObjectToWorldMatrix,bd as convertTransformObjectToWorldQuat,Ad as convertTransformWorldToLocal,Rd as convertTransformWorldToLocalMatrix,Od as convertTransformWorldToLocalQuat,Sd as convertTransformWorldToObject,vd as convertTransformWorldToObjectMatrix,xd as convertTransformWorldToObjectQuat,su as copyComponentAlongAxis,eT as copyObjectProperties,hT as createPlane,XC as createSimplified,KC as createTeleportColliderSetupFromMovementColliderSetup,jy as cross,BP as debug,Eu as degreesAddRotation,Au as degreesAddRotationDegrees,Ou as degreesAddRotationQuat,Ru as degreesAddRotationRadians,Hu as degreesToMatrix,tu as degreesToQuat,q_ as destroy,Iy as distance,By as distanceSquared,ky as div,iT as doesObjectPropertyUseAccessors,Fy as dot,sP as exitSession,Cb as exportVariables,sy as find,ry as findAll,yy as findAllEqual,ly as findAllIndexes,hy as findAllIndexesEqual,my as findEqual,ay as findIndex,uy as findIndexEqual,iy as first,zf as floor,Ju as fromAxis,Zu as fromAxisDegrees,Yu as fromAxisRadians,eh as fromDegrees,Sy as fromMatrix,Ay as fromQuat,$u as fromRadians,ch as fromTwistSwing,LC as generate360TeleportParamsFromMovementParams,Wu as getAngle,Uu as getAngleDegrees,Qu as getAngleRadians,zP as getAssert,dm as getAudioManager,jh as getAxesLocal,wh as getAxesWorld,Gu as getAxis,qu as getAxisScaled,Xu as getAxisScaledDegrees,Ku as getAxisScaledRadians,Wh as getBackwardLocal,Gh as getBackwardWorld,Pm as getBody,Dg as getCanvas,Fg as getCharacterCollisionSystem,w_ as getChildren,vT as getClassFromType,NP as getClear,FT as getCloneCallback,NT as getClonePostProcessCallback,HC as getCollisionCheck,pg as getComponentBreadth,Qd as getComponentChildren,dg as getComponentDepth,Gd as getComponentDescendants,Wd as getComponentDescendantsBreadth,Ud as getComponentDescendantsDepth,jd as getComponentHierarchy,zd as getComponentHierarchyBreadth,Nd as getComponentHierarchyDepth,ng as getComponentObjects,wd as getComponentSelf,ig as getComponentsAmountMapChildren,tg as getComponentsAmountMapDescendants,eg as getComponentsAmountMapHierarchy,$_ as getComponentsAmountMapSelf,_g as getComponentsBreadth,e_ as getComponentsChildren,gg as getComponentsDepth,Zd as getComponentsDescendants,Yd as getComponentsDescendantsBreadth,$d as getComponentsDescendantsDepth,Xd as getComponentsHierarchy,Kd as getComponentsHierarchyBreadth,Jd as getComponentsHierarchyDepth,og as getComponentsObjects,qd as getComponentsSelf,_f as getConsoleVR,jP as getDebug,yl as getDebugManager,Ig as getDebugVisualManager,Vf as getDefaultMaterials,Of as getDefaultMeshes,pr as getDefaultResources,WT as getDefaultWLComponentCloneCallback,H_ as getDescendants,k_ as getDescendantsBreadth,F_ as getDescendantsDepth,Zr as getDocument,Xh as getDownLocal,qh as getDownWorld,xC as getDummyServer,vf as getEasyTuneTarget,Pf as getEasyTuneVariables,G_ as getEngine,xg as getEngines,kP as getError,Nh as getForwardLocal,zh as getForwardWorld,iP as getFrame,Xg as getGamepad,Kg as getGamepads,qg as getGamepadsManager,$g as getHandPose,ef as getHandPoses,_P as getHandednessByIndex,Yg as getHeadPose,I_ as getHierarchy,B_ as getHierarchyBreadth,L_ as getHierarchyDepth,W_ as getID,wP as getInfo,Xe as getInputManager,gP as getInputSource,TP as getInputSourceType,fP as getInputSourceTypeByHandedness,DT as getJavascriptComponentClass,ET as getJavascriptComponentClassesByIndex,MT as getJavascriptComponentInstances,OT as getJavascriptComponentTypeFromIndex,AT as getJavascriptComponentTypeIndex,RT as getJavascriptComponentTypeIndexes,CP as getJointIDByIndex,Qg as getKeyboard,DP as getLayerFlagsNames,EC as getLeaderboard,AC as getLeaderboardDummy,Jg as getLeftGamepad,tf as getLeftHandPose,Jh as getLeftLocal,af as getLeftTrackedHandPose,Kh as getLeftWorld,HP as getLog,Jt as getMainEngine,Ug as getMouse,z_ as getName,Tm as getNavigator,bg as getObjectByIDBreadth,V_ as getObjectByIDChildren,Sg as getObjectByIDDepth,A_ as getObjectByIDDescendants,R_ as getObjectByIDDescendantsBreadth,O_ as getObjectByIDDescendantsDepth,M_ as getObjectByIDHierarchy,D_ as getObjectByIDHierarchyBreadth,E_ as getObjectByIDHierarchyDepth,lg as getObjectByIDObjects,fg as getObjectByNameBreadth,f_ as getObjectByNameChildren,Tg as getObjectByNameDepth,d_ as getObjectByNameDescendants,__ as getObjectByNameDescendantsBreadth,g_ as getObjectByNameDescendantsDepth,h_ as getObjectByNameHierarchy,c_ as getObjectByNameHierarchyBreadth,p_ as getObjectByNameHierarchyDepth,ag as getObjectByNameObjects,Jf as getObjectFromPath,Zf as getObjectNameFromPath,Yf as getObjectParentFromPath,Cm as getObjectPoolManager,Qf as getObjectProperty,Uf as getObjectPropertyDescriptor,Wf as getObjectPropertyNames,Xf as getObjectPropertyOwnParent,Kf as getObjectPropertyOwnParents,Gf as getObjectPrototypes,ug as getObjects,hg as getObjectsBreadth,mg as getObjectsByIDObjects,Pg as getObjectsByNameBreadth,x_ as getObjectsByNameChildren,Cg as getObjectsByNameDepth,b_ as getObjectsByNameDescendants,S_ as getObjectsByNameDescendantsBreadth,v_ as getObjectsByNameDescendantsDepth,T_ as getObjectsByNameHierarchy,P_ as getObjectsByNameHierarchyBreadth,C_ as getObjectsByNameHierarchyDepth,rg as getObjectsByNameObjects,cg as getObjectsDepth,PP as getOppositeHandedness,rd as getParent,Mg as getPhysics,Hf as getPlayerObjects,_h as getPositionLocal,dh as getPositionWorld,eP as getReferenceSpace,tP as getReferenceSpaceType,Zg as getRightGamepad,nf as getRightHandPose,Yh as getRightLocal,rf as getRightTrackedHandPose,Zh as getRightWorld,Sh as getRotationLocal,vh as getRotationLocalDegrees,Mh as getRotationLocalMatrix,Dh as getRotationLocalQuat,xh as getRotationLocalRadians,gh as getRotationMatrix,fh as getRotationWorld,Th as getRotationWorldDegrees,Ch as getRotationWorldMatrix,bh as getRotationWorldQuat,Ph as getRotationWorldRadians,DC as getSDK,Ah as getScaleLocal,Eh as getScaleWorld,ll as getScene,fl as getSceneObjects,j_ as getSelf,YT as getSession,$T as getSessionMode,$C as getSimultaneousPressMaxDelay,eb as getSimultaneousTouchMaxDelay,yh as getSwing,uh as getSwingFromTwist,of as getTrackedHandPose,sf as getTrackedHandPoses,Rh as getTransform,Hh as getTransformLocal,kh as getTransformLocalMatrix,Fh as getTransformLocalQuat,Oh as getTransformMatrix,Vh as getTransformQuat,Ih as getTransformWorld,Bh as getTransformWorldMatrix,Lh as getTransformWorldQuat,mh as getTwist,hh as getTwistFromSwing,ST as getTypeFromTypeOrClass,Qh as getUpLocal,Uh as getUpWorld,VC as getUser,IC as getUserDummy,Am as getVisualManager,xm as getVisualResources,Eg as getWASM,bT as getWLJavascriptComponentTypes,CT as getWLNativeComponentTypes,FP as getWarn,Ya as getWindow,Ag as getXR,fm as hasAudioManager,zg as hasCharacterCollisionSystem,wT as hasCloneCallback,IT as hasClonePostProcess,GT as hasClonePostProcessCallback,Tf as hasConsoleVR,kg as hasDebugEnabled,Vg as hasDebugManager,Rf as hasDefaultResources,UT as hasDefaultWLComponentCloneCallback,Df as hasEasyTuneTarget,Sf as hasEasyTuneVariables,rl as hasEngine,oy as hasEqual,Wg as hasInputManager,vm as hasObjectPoolManager,uf as hasPoseForwardFixed,Lf as hasSceneObjects,df as hasToolEnabled,u_ as hasUniformScaleLocal,y_ as hasUniformScaleWorld,Vm as hasVisualManager,Em as hasVisualResources,nC as hsvCodeToHuman,oC as hsvHumanToCode,eC as hsvToRGB,Pb as importVariables,IP as info,Cl as initArrayExtension,yT as initArrayExtensionProtoype,FC as initBridge,kl as initComponentMods,Bl as initCursorComponentMod,bP as initCursorComponentModPrototype,Ll as initCursorTargetComponentMod,SP as initCursorTargetComponentModPrototype,vg as initEngine,El as initJSExtensions,Al as initJSPlugins,Ml as initMathExtension,XT as initMathExtensionStatic,Hl as initMouseLookComponentMod,vP as initMouseLookComponentModPrototype,Dl as initNumberExtension,KT as initNumberExtensionPrototype,Rl as initObjectExtension,JT as initObjectExtensionProtoype,Nl as initPP,jl as initPlugins,Ol as initSceneExtension,ZT as initSceneExtensionPrototype,Vl as initWLExtensions,Fl as initWLMods,wl as initWLPlugins,mT as injectProperties,pP as isARSupported,AR as isAnyButtonPressEnd,tb as isAnyButtonPressStart,ab as isAnyButtonTouchEnd,ob as isAnyButtonTouchStart,rT as isClass,oT as isClassByName,au as isConcordant,Bg as isDebugEnabled,dC as isDesktop,dP as isDeviceEmulated,ru as isFartherAlongAxis,aT as isFunction,nT as isFunctionByName,$m as isInsideAngleRange,ey as isInsideAngleRangeDegrees,ty as isInsideAngleRangeRadians,pC as isMobile,lT as isObject,sT as isObjectByName,pu as isOnAxis,du as isOnPlane,UP as isPlaybackBlocked,lf as isPoseForwardFixed,oP as isReferenceSpaceFloorBased,xT as isRegistered,MC as isSDKAvailable,nP as isSessionActive,lu as isToTheRight,hf as isToolEnabled,Q_ as isTransformChanged,vC as isUseDummyServerOnError,SC as isUseDummyServerOnSDKMissing,cP as isVRSupported,fT as isWLComponent,PT as isWLJavascriptComponent,TT as isWLNativeComponent,VT as isWLNativeComponentRegistered,hP as isXRSupported,ny as last,Wy as lengthSigned,KP as load,YP as loadBool,ZP as loadNumber,JP as loadString,ed as lookAt,id as lookAtLocal,td as lookAtWorld,nd as lookTo,sd as lookToLocal,od as lookToWorld,uT as makeDoubleSided,km as mapToRange,U_ as markDirty,KD as mat3_create,be as mat4_create,wy as negate,_C as openLink,gC as openLinkOnClick,$f as overwriteObjectProperty,Nu as perpendicularRandom,yu as projectOnAxis,uu as projectOnAxisAlongAxis,hu as projectOnPlane,cu as projectOnPlaneAlongAxis,fy as pushUnique,N as quat2_create,j as quat_create,Vu as radiansAddRotation,Iu as radiansAddRotationDegrees,Lu as radiansAddRotationQuat,Bu as radiansAddRotationRadians,ku as radiansToMatrix,eu as radiansToQuat,Fm as random,jm as randomBool,wm as randomInt,Nm as randomPick,zm as randomSign,Gm as randomUUID,EP as raycast,Tb as refreshWidget,zl as registerPPComponents,lP as registerSessionEndEventListener,yP as registerSessionStartEndEventListeners,aP as registerSessionStartEventListener,Kr as registerWLComponents,dy as removeAll,gy as removeAllEqual,py as removeAllIndexes,gm as removeAudioManager,jg as removeCharacterCollisionSystem,kT as removeCloneCallback,zT as removeClonePostProcessCallback,ou as removeComponentAlongAxis,ff as removeConsoleVR,Hg as removeDebugEnabled,Og as removeDebugManager,Af as removeDefaultResources,qT as removeDefaultWLComponentCloneCallbacks,Mf as removeEasyTuneTarget,bf as removeEasyTuneVariables,al as removeEngine,_y as removeEqual,cy as removeIndex,Gg as removeInputManager,ol as removeMainEngine,Sm as removeObjectPoolManager,yf as removePoseForwardFixed,xb as removeRefreshWidgetCallback,Bf as removeSceneObjects,Sb as removeSetWidgetCurrentVariableCallback,pf as removeToolEnabled,Om as removeVisualManager,Dm as removeVisualResources,X_ as reserveObjects,Y_ as reserveObjectsChildren,Z_ as reserveObjectsDescendants,J_ as reserveObjectsHierarchy,K_ as reserveObjectsSelf,kc as resetPosition,wc as resetPositionLocal,Fc as resetPositionWorld,jc as resetRotation,Nc as resetRotationLocal,zc as resetRotationWorld,Gc as resetScale,Uc as resetScaleLocal,Wc as resetScaleWorld,Qc as resetTransform,Xc as resetTransformLocal,qc as resetTransformWorld,tC as rgbCodeToHuman,iC as rgbHumanToCode,$P as rgbToHSV,qp as rotateAroundAxisLocal,Xp as rotateAroundAxisLocalDegrees,Kp as rotateAroundAxisLocalRadians,Jp as rotateAroundAxisObject,Zp as rotateAroundAxisObjectDegrees,Yp as rotateAroundAxisObjectRadians,Wp as rotateAroundAxisWorld,Up as rotateAroundAxisWorldDegrees,Qp as rotateAroundAxisWorldRadians,Bp as rotateAroundLocal,Lp as rotateAroundLocalDegrees,kp as rotateAroundLocalMatrix,Fp as rotateAroundLocalQuat,Hp as rotateAroundLocalRadians,Ep as rotateAroundMatrix,wp as rotateAroundObject,jp as rotateAroundObjectDegrees,Np as rotateAroundObjectMatrix,Gp as rotateAroundObjectQuat,zp as rotateAroundObjectRadians,Ap as rotateAroundWorld,Rp as rotateAroundWorldDegrees,Vp as rotateAroundWorldMatrix,Ip as rotateAroundWorldQuat,Op as rotateAroundWorldRadians,bp as rotateAxisLocal,Sp as rotateAxisLocalDegrees,vp as rotateAxisLocalRadians,xp as rotateAxisObject,Mp as rotateAxisObjectDegrees,Dp as rotateAxisObjectRadians,Tp as rotateAxisWorld,Pp as rotateAxisWorldDegrees,Cp as rotateAxisWorldRadians,mp as rotateLocal,yp as rotateLocalDegrees,hp as rotateLocalMatrix,cp as rotateLocalQuat,up as rotateLocalRadians,np as rotateMatrix,pp as rotateObject,dp as rotateObjectDegrees,gp as rotateObjectMatrix,fp as rotateObjectQuat,_p as rotateObjectRadians,op as rotateWorld,sp as rotateWorldDegrees,rp as rotateWorldMatrix,lp as rotateWorldQuat,ap as rotateWorldRadians,sh as rotationAroundAxis,ah as rotationAroundAxisDegrees,lh as rotationAroundAxisQuat,rh as rotationAroundAxisRadians,Fu as rotationToPivoted,wu as rotationToPivotedDegrees,zu as rotationToPivotedQuat,ju as rotationToPivotedRadians,jf as round,Hm as roundDecimal,XP as save,$p as scaleObject,t_ as setActive,m_ as setActiveChildren,a_ as setActiveDescendants,r_ as setActiveDescendantsBreadth,l_ as setActiveDescendantsDepth,n_ as setActiveHierarchy,o_ as setActiveHierarchyBreadth,s_ as setActiveHierarchyDepth,sg as setActiveObjects,i_ as setActiveSelf,rC as setAlpha,_m as setAudioManager,dc as setAxesLocal,pc as setAxesWorld,Tc as setBackwardLocal,fc as setBackwardWorld,wg as setCharacterCollisionSystem,HT as setCloneCallback,jT as setClonePostProcessCallback,cC as setClonedMaterials,kC as setCollisionCheck,gf as setConsoleVR,Lg as setDebugEnabled,Rg as setDebugManager,Ef as setDefaultResources,QT as setDefaultWLComponentCloneCallbacks,Sc as setDownLocal,bc as setDownWorld,bC as setDummyServer,xf as setEasyTuneTarget,Cf as setEasyTuneVariables,gc as setForwardLocal,_c as setForwardWorld,Ng as setInputManager,MP as setLayerFlagsNames,xc as setLeftLocal,vc as setLeftWorld,nl as setMainEngine,N_ as setName,lC as setObjectAlpha,yC as setObjectClonedMaterials,hC as setObjectFogColor,mC as setObjectMaterial,bm as setObjectPoolManager,qf as setObjectProperty,uC as setObjectSpecularColor,ad as setParent,mf as setPoseForwardFixed,ec as setPositionLocal,My as setPositionRotationDegreesScale,Ey as setPositionRotationQuatScale,Dy as setPositionRotationRadiansScale,xy as setPositionRotationScale,$h as setPositionWorld,Dc as setRightLocal,Mc as setRightWorld,rc as setRotationLocal,lc as setRotationLocalDegrees,yc as setRotationLocalMatrix,uc as setRotationLocalQuat,mc as setRotationLocalRadians,tc as setRotationMatrix,ic as setRotationWorld,nc as setRotationWorldDegrees,sc as setRotationWorldMatrix,ac as setRotationWorldQuat,oc as setRotationWorldRadians,cc as setScaleLocal,hc as setScaleWorld,If as setSceneObjects,ZC as setSimultaneousPressMaxDelay,YC as setSimultaneousTouchMaxDelay,cf as setToolEnabled,Ec as setTransform,Bc as setTransformLocal,Lc as setTransformLocalMatrix,Hc as setTransformLocalQuat,Ac as setTransformMatrix,Rc as setTransformQuat,Oc as setTransformWorld,Vc as setTransformWorldMatrix,Ic as setTransformWorldQuat,Cc as setUpLocal,Pc as setUpWorld,CC as setUseDummyServerOnError,PC as setUseDummyServerOnSDKMissing,Rm as setVisualManager,Mm as setVisualResources,fb as setWidgetCurrentVariable,Lm as sign,mu as signTo,Hy as sub,th as subRotation,ih as subRotationDegrees,oh as subRotationQuat,nh as subRotationRadians,RC as submitScore,OC as submitScoreDummy,Ny as transformMat3,Gy as transformMat4,zy as transformQuat,Kc as translate,$c as translateAxis,tp as translateAxisLocal,ip as translateAxisObject,ep as translateAxisWorld,Zc as translateLocal,Yc as translateObject,Jc as translateWorld,mP as unregisterSessionEndEventListener,uP as unregisterSessionStartEndEventListeners,rP as unregisterSessionStartEventListener,Ty as unshiftUnique,GC as updateCeilingInfo,NC as updateGroundInfo,nu as valueAlongAxis,Ae as vec2_create,c as vec3_create,F as vec4_create,yg as wrapObject};
//# sourceMappingURL=wle_pp_bundle.js.map
