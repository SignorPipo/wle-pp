var vm=Object.defineProperty;var Vb=(i,e,t)=>e in i?vm(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var bt=(i,e)=>{for(var t in e)vm(i,t,{get:e[t],enumerable:!0})};var R=(i,e,t)=>(Vb(i,typeof e!="symbol"?e+"":e,t),t);var im={};bt(im,{AddPPToWindowComponent:()=>Ci,AddWLToWindowComponent:()=>gi,AdjustHierarchyPhysXScaleComponent:()=>dn,ArrayUtils:()=>q,AudioEvent:()=>Ms,AudioManager:()=>Es,AudioManagerComponent:()=>$t,AudioPlayer:()=>Zn,AudioSetup:()=>Ji,AudioUtils:()=>oR,BaseGamepad:()=>Os,BasePose:()=>je,BasePoseParams:()=>xt,BenchmarkMaxPhysXComponent:()=>un,BenchmarkMaxVisibleTrianglesComponent:()=>hn,BrowserUtils:()=>Zo,CADisplayLeaderboardComponent:()=>Tn,CADummyServer:()=>Xs,CAError:()=>ot,CAUtils:()=>Te,CharacterColliderAdditionalParams:()=>ta,CharacterColliderDebugParams:()=>ia,CharacterColliderHorizontalCheckParams:()=>Zs,CharacterColliderHorizontalPositionVerticalCheckDirection:()=>HT,CharacterColliderSetup:()=>co,CharacterColliderSetupSimplifiedCreationAccuracyLevel:()=>po,CharacterColliderSetupSimplifiedCreationParams:()=>oa,CharacterColliderSetupUtils:()=>cm,CharacterColliderSlideFlickerPreventionMode:()=>na,CharacterColliderSplitMovementParams:()=>ea,CharacterColliderSurfaceParams:()=>ms,CharacterColliderVerticalCheckParams:()=>Ys,CharacterColliderWallSlideParams:()=>$s,CharacterCollisionCheckTransformResults:()=>ss,CharacterCollisionCheckType:()=>en,CharacterCollisionDebugResults:()=>rs,CharacterCollisionInternalResults:()=>ls,CharacterCollisionMovementResults:()=>$i,CharacterCollisionResults:()=>Ge,CharacterCollisionSplitMovementResults:()=>as,CharacterCollisionSurfaceInfo:()=>uo,CharacterCollisionSurfaceResults:()=>ho,CharacterCollisionSystem:()=>ys,CharacterCollisionSystemComponent:()=>vn,CharacterCollisionTeleportResults:()=>os,CharacterCollisionTransformResults:()=>ns,CharacterCollisionWallSlideResults:()=>is,CharacterController:()=>_o,CharacterControllerComponent:()=>xn,CharacterControllerUtils:()=>qR,ClassicGamepadCore:()=>No,CleanedPlayerLocomotion:()=>_a,CleanedPlayerLocomotionSmooth:()=>ui,CleanedPlayerTransformManager:()=>yt,ClearConsoleOnXRSessionStartComponent:()=>cn,CloneParams:()=>Zt,CollisionCheck:()=>G,CollisionCheckBridge:()=>mi,CollisionCheckParams:()=>Ae,CollisionCheckUtils:()=>Bi,CollisionRuntimeParams:()=>re,ColorUtils:()=>he,ComponentUtils:()=>N,ConsoleOriginalFunctions:()=>qt,ConsoleVR:()=>Aa,ConsoleVRToolComponent:()=>wn,ConsoleVRWidget:()=>Ra,ConsoleVRWidgetConfig:()=>Sa,ConsoleVRWidgetConsoleFunction:()=>pe,ConsoleVRWidgetMessage:()=>el,ConsoleVRWidgetMessageType:()=>k,ConsoleVRWidgetParams:()=>Da,ConsoleVRWidgetPulseOnNewMessage:()=>ba,ConsoleVRWidgetSender:()=>Oe,ConsoleVRWidgetUI:()=>xa,CopyHandTransformComponent:()=>Hn,CopyHeadTransformComponent:()=>Ln,CopyPlayerPivotTransformComponent:()=>Fn,CopyPlayerTransformComponent:()=>kn,CustomCloneParams:()=>Ts,DebugArrayFunctionsPerformanceAnalyzerComponent:()=>fn,DebugFunctionPerformanceAnalysisResults:()=>es,DebugFunctionsOverwriter:()=>$o,DebugFunctionsOverwriterParams:()=>Yo,DebugFunctionsPerformanceAnalysisResultsLogger:()=>Qs,DebugFunctionsPerformanceAnalysisResultsLoggerParams:()=>Ws,DebugFunctionsPerformanceAnalyzer:()=>yo,DebugFunctionsPerformanceAnalyzerComponent:()=>et,DebugFunctionsPerformanceAnalyzerParams:()=>ts,DebugFunctionsPerformanceAnalyzerSortOrder:()=>Ut,DebugManager:()=>As,DebugManagerComponent:()=>ti,DebugPPFunctionsPerformanceAnalyzerComponent:()=>gn,DebugTransformComponent:()=>_n,DebugVisualManager:()=>to,DebugWLComponentsFunctionsPerformanceAnalyzerComponent:()=>Cn,DebugWLFunctionsPerformanceAnalyzerComponent:()=>Pn,DeepCloneParams:()=>Yt,DefaultResources:()=>xs,DefaultResourcesMaterials:()=>Lr,DefaultResourcesMeshes:()=>Hr,DefaultWLComponentCloneCallbacks:()=>wo,Direction2DTo3DConverter:()=>Mt,Direction2DTo3DConverterParams:()=>li,EPSILON:()=>pr,EPSILON_DEGREES:()=>jm,EPSILON_SQUARED:()=>wm,EasingFunction:()=>ue,EasyLightAttenuation:()=>$a,EasyLightAttenuationComponent:()=>Nn,EasyLightColor:()=>er,EasyLightColorComponent:()=>Gn,EasyMeshAmbientFactor:()=>or,EasyMeshAmbientFactorComponent:()=>Un,EasyMeshColor:()=>tr,EasyMeshColorComponent:()=>Wn,EasyObjectTuner:()=>st,EasyScale:()=>ir,EasyScaleComponent:()=>Qn,EasySetTuneTargeetGrabComponent:()=>Xn,EasySetTuneTargetChildNumberComponent:()=>qn,EasyTextColor:()=>sr,EasyTextColorComponent:()=>Kn,EasyTransform:()=>nr,EasyTransformComponent:()=>Jn,EasyTuneBaseArrayWidgetSelector:()=>Bo,EasyTuneBaseWidget:()=>Xt,EasyTuneBaseWidgetConfig:()=>Kt,EasyTuneBaseWidgetParams:()=>Oa,EasyTuneBaseWidgetUI:()=>Jt,EasyTuneBool:()=>gm,EasyTuneBoolArray:()=>tl,EasyTuneBoolArrayWidget:()=>Fa,EasyTuneBoolArrayWidgetConfig:()=>Ba,EasyTuneBoolArrayWidgetSelector:()=>wa,EasyTuneBoolArrayWidgetUI:()=>ka,EasyTuneImportVariablesComponent:()=>zn,EasyTuneInt:()=>_m,EasyTuneIntArray:()=>ki,EasyTuneNoneWidget:()=>Ga,EasyTuneNoneWidgetConfig:()=>za,EasyTuneNoneWidgetUI:()=>Na,EasyTuneNumber:()=>sn,EasyTuneNumberArray:()=>Li,EasyTuneNumberArrayWidget:()=>Qa,EasyTuneNumberArrayWidgetConfig:()=>Ua,EasyTuneNumberArrayWidgetSelector:()=>qa,EasyTuneNumberArrayWidgetUI:()=>Wa,EasyTuneToolComponent:()=>jn,EasyTuneTransform:()=>Oo,EasyTuneTransformWidget:()=>Ja,EasyTuneTransformWidgetConfig:()=>Xa,EasyTuneTransformWidgetUI:()=>Ka,EasyTuneUtils:()=>He,EasyTuneVariable:()=>Vo,EasyTuneVariableArray:()=>hi,EasyTuneVariableType:()=>ci,EasyTuneVariables:()=>ks,EasyTuneWidget:()=>Ya,EasyTuneWidgetConfig:()=>ja,EasyTuneWidgetParams:()=>Za,EnableDebugsComponent:()=>fi,EnableToolsComponent:()=>Pi,FSM:()=>ze,FingerCursorComponent:()=>Si,GamepadAxesEvent:()=>ai,GamepadAxesID:()=>oe,GamepadAxesInfo:()=>no,GamepadButtonEvent:()=>ae,GamepadButtonID:()=>M,GamepadButtonInfo:()=>io,GamepadControlSchemeComponent:()=>On,GamepadCore:()=>Nt,GamepadMeshAnimatorComponent:()=>Qi,GamepadPulseInfo:()=>oo,GamepadUtils:()=>pA,GamepadsManager:()=>Bs,GetDefaultResourcesComponent:()=>kt,GetSceneObjectsComponent:()=>Ft,Globals:()=>r,GrabbableComponent:()=>Ti,GrabberHandComponent:()=>bi,HandPose:()=>ao,HandPoseParams:()=>so,Handedness:()=>A,HandednessIndex:()=>Gi,HeadPose:()=>Is,HowlerAudioPlayer:()=>nm,InitConsoleVRComponent:()=>xi,InitEasyTuneVariablesComponent:()=>Lt,InputManager:()=>Ls,InputManagerComponent:()=>Ht,InputSourceType:()=>$e,InputUtils:()=>ee,IntOverValue:()=>mm,IntRangeOverValue:()=>ym,JSUtils:()=>$,KeyID:()=>te,Keyboard:()=>Vs,KeyboardGamepadCore:()=>Go,Mat3Utils:()=>Y,Mat4Utils:()=>V,MaterialUtils:()=>Us,MathUtils:()=>H,MeshCreationParams:()=>Fo,MeshCreationTriangleParams:()=>Ni,MeshCreationVertexParams:()=>ko,MeshUtils:()=>Xe,Mouse:()=>Hs,MouseButtonID:()=>Zi,MuteEverythingComponent:()=>mn,NumberOverValue:()=>Oi,NumberRangeOverValue:()=>Ur,ObjectPool:()=>Yn,ObjectPoolParams:()=>Mi,ObjectPoolsManager:()=>Ds,ObjectUtils:()=>u,PPGatewayComponent:()=>ln,PerformDelayedMode:()=>js,PerformMode:()=>Vi,PhysicsCollisionCollector:()=>Ai,PhysicsLayerFlags:()=>Re,PhysicsUtils:()=>Me,PlayerCharacterController:()=>sa,PlayerCharacterControllerComponent:()=>Mn,PlayerHandCharacterController:()=>ra,PlayerHandCharacterControllerComponent:()=>Dn,PlayerHeadCharacterController:()=>aa,PlayerHeadCharacterControllerComponent:()=>En,PlayerHeadController:()=>Ks,PlayerHeadControllerComponent:()=>bn,PlayerHeadManager:()=>se,PlayerHeadManagerParams:()=>tn,PlayerLocomotion:()=>da,PlayerLocomotionComponent:()=>Rn,PlayerLocomotionDirectionReferenceType:()=>Xr,PlayerLocomotionMovement:()=>Hi,PlayerLocomotionMovementRuntimeParams:()=>go,PlayerLocomotionParams:()=>pa,PlayerLocomotionRotate:()=>Wt,PlayerLocomotionRotateParams:()=>fo,PlayerLocomotionSmooth:()=>yi,PlayerLocomotionSmoothParams:()=>So,PlayerLocomotionTeleport:()=>on,PlayerLocomotionTeleportDetectionParams:()=>ma,PlayerLocomotionTeleportDetectionRuntimeParams:()=>Qr,PlayerLocomotionTeleportDetectionState:()=>dt,PlayerLocomotionTeleportDetectionVisualizer:()=>nn,PlayerLocomotionTeleportDetectionVisualizerParams:()=>la,PlayerLocomotionTeleportParable:()=>Qt,PlayerLocomotionTeleportParams:()=>bo,PlayerLocomotionTeleportRuntimeParams:()=>qr,PlayerLocomotionTeleportState:()=>Ct,PlayerLocomotionTeleportTeleportBlinkState:()=>ya,PlayerLocomotionTeleportTeleportParams:()=>ha,PlayerLocomotionTeleportTeleportShiftState:()=>To,PlayerLocomotionTeleportTeleportState:()=>ca,PlayerLocomotionTeleportTeleportType:()=>ua,PlayerObjects:()=>Ir,PlayerObscureManager:()=>Co,PlayerObscureManagerParams:()=>Po,PlayerTransformManager:()=>mt,PlayerTransformManagerParams:()=>vo,PlayerTransformManagerSyncFlag:()=>le,PlayerViewOcclusion:()=>Js,PlayerViewOcclusionComponent:()=>Sn,PluginUtils:()=>Ce,Quat2Utils:()=>O,QuatUtils:()=>f,RaycastHit:()=>lt,RaycastParams:()=>ct,RaycastResults:()=>Le,SaveManager:()=>am,SaveUtils:()=>Gt,SceneObjects:()=>vs,SceneUtils:()=>J,SetActiveComponent:()=>pn,SetHandLocalTransformComponent:()=>qi,SetHeadLocalTransformComponent:()=>vi,SetPlayerHeightComponent:()=>In,SetTrackedHandJointLocalTransformComponent:()=>Xi,ShowFPSComponent:()=>Ui,SkipStateFunction:()=>Xo,SpatialAudioListenerComponent:()=>yn,State:()=>mo,StateData:()=>Ko,SwitchHandObjectComponent:()=>An,SyncedCharacterController:()=>Ii,TextUtils:()=>bR,Timer:()=>ie,TimerState:()=>Ns,ToolCursorComponent:()=>Ki,ToolHandedness:()=>U,ToolInputSourceType:()=>Ee,TrackedHandDrawAllJointsComponent:()=>Vn,TrackedHandDrawJointComponent:()=>ii,TrackedHandDrawSkinComponent:()=>Wi,TrackedHandJointID:()=>at,TrackedHandJointIDIndex:()=>jo,TrackedHandJointPose:()=>Qo,TrackedHandPose:()=>qo,TrackedHandPoseParams:()=>ro,Transition:()=>lm,TransitionData:()=>Jo,UniversalGamepad:()=>Wo,Vec2Utils:()=>gt,Vec3Utils:()=>p,Vec4Utils:()=>zi,VecUtils:()=>At,VirtualGamepad:()=>Ta,VirtualGamepadButtonParams:()=>Et,VirtualGamepadComponent:()=>Bn,VirtualGamepadGamepadCore:()=>us,VirtualGamepadIcon:()=>xo,VirtualGamepadIconParams:()=>hs,VirtualGamepadIconType:()=>Ve,VirtualGamepadParams:()=>Mo,VirtualGamepadThumbstickParams:()=>fa,VirtualGamepadVirtualButton:()=>Pa,VirtualGamepadVirtualThumbstick:()=>Ca,VisualArrow:()=>ht,VisualArrowParams:()=>tt,VisualElementType:()=>xe,VisualLine:()=>rt,VisualLineParams:()=>Ke,VisualManager:()=>eo,VisualManagerComponent:()=>ei,VisualMesh:()=>Ei,VisualMeshParams:()=>ni,VisualPoint:()=>wt,VisualPointParams:()=>vt,VisualRaycast:()=>$n,VisualRaycastParams:()=>oi,VisualResources:()=>Rs,VisualResourcesMaterials:()=>kr,VisualText:()=>Di,VisualTextParams:()=>Vt,VisualTorus:()=>zt,VisualTorusParams:()=>jt,VisualTransform:()=>si,VisualTransformParams:()=>Ot,WidgetFrame:()=>Do,WidgetFrameConfig:()=>Ma,WidgetFrameUI:()=>Ea,WidgetParams:()=>Eo,XRGamepadCore:()=>Uo,XRUtils:()=>B,add:()=>jy,addComponent:()=>Hd,addEngine:()=>pl,addRefreshWidgetCallback:()=>Sb,addSetWidgetActiveVariableCallback:()=>Tb,angle:()=>Hy,angleClamp:()=>ty,angleClampDegrees:()=>iy,angleClampRadians:()=>ny,angleDegrees:()=>Ly,angleDistance:()=>Km,angleDistanceDegrees:()=>Jm,angleDistanceRadians:()=>Zm,angleDistanceSigned:()=>Ym,angleDistanceSignedDegrees:()=>$m,angleDistanceSignedRadians:()=>ey,angleRadians:()=>ky,angleSigned:()=>Jy,angleSignedDegrees:()=>Zy,angleSignedRadians:()=>Yy,areButtonsPressEnd:()=>KT,areButtonsPressStart:()=>XT,areButtonsTouchEnd:()=>$T,areButtonsTouchStart:()=>ZT,ceil:()=>Wf,checkMovement:()=>ET,checkTeleportToTransform:()=>DT,checkTransform:()=>RT,cleanObjectProperties:()=>oP,cloneCollision:()=>fP,cloneDefault:()=>FP,cloneMesh:()=>gP,clonePhysX:()=>CP,clonePostProcess:()=>kP,cloneText:()=>PP,color1To255:()=>ZC,color255To1:()=>JC,componentAlongAxis:()=>tu,computeCeilingPerceivedAngle:()=>wT,computeGroundPerceivedAngle:()=>FT,computeSurfacePerceivedAngle:()=>jT,convertCharacterColliderSetupToCollisionCheckParams:()=>IT,convertCharacterCollisionResultsToCollisionRuntimeParams:()=>OT,convertCollisionRuntimeParamsToCharacterCollisionResults:()=>BT,convertDirectionLocalToObject:()=>_d,convertDirectionLocalToWorld:()=>yd,convertDirectionObjectToLocal:()=>pd,convertDirectionObjectToWorld:()=>ad,convertDirectionToLocal:()=>bu,convertDirectionToLocalMatrix:()=>vu,convertDirectionToLocalQuat:()=>Mu,convertDirectionToWorld:()=>Tu,convertDirectionToWorldMatrix:()=>Su,convertDirectionToWorldQuat:()=>xu,convertDirectionWorldToLocal:()=>hd,convertDirectionWorldToObject:()=>ld,convertPositionLocalToObject:()=>dd,convertPositionLocalToWorld:()=>md,convertPositionObjectToLocal:()=>cd,convertPositionObjectToWorld:()=>sd,convertPositionToLocal:()=>_u,convertPositionToLocalMatrix:()=>fu,convertPositionToLocalQuat:()=>Cu,convertPositionToWorld:()=>du,convertPositionToWorldMatrix:()=>gu,convertPositionToWorldQuat:()=>Pu,convertPositionWorldToLocal:()=>ud,convertPositionWorldToObject:()=>rd,convertTransformLocalToObject:()=>Od,convertTransformLocalToObjectMatrix:()=>Bd,convertTransformLocalToObjectQuat:()=>Id,convertTransformLocalToWorld:()=>Sd,convertTransformLocalToWorldMatrix:()=>vd,convertTransformLocalToWorldQuat:()=>xd,convertTransformObjectToLocal:()=>Rd,convertTransformObjectToLocalMatrix:()=>Ad,convertTransformObjectToLocalQuat:()=>Vd,convertTransformObjectToWorld:()=>gd,convertTransformObjectToWorldMatrix:()=>fd,convertTransformObjectToWorldQuat:()=>Pd,convertTransformWorldToLocal:()=>Md,convertTransformWorldToLocalMatrix:()=>Ed,convertTransformWorldToLocalQuat:()=>Dd,convertTransformWorldToObject:()=>Cd,convertTransformWorldToObjectMatrix:()=>Td,convertTransformWorldToObjectQuat:()=>bd,copyComponentAlongAxis:()=>ou,copyObjectProperties:()=>nP,createPlane:()=>pP,createSimplified:()=>LT,createTeleportColliderSetupFromMovementColliderSetup:()=>kT,cross:()=>Wy,degreesAddRotation:()=>Eu,degreesAddRotationDegrees:()=>Du,degreesAddRotationQuat:()=>Au,degreesAddRotationRadians:()=>Ru,degreesToMatrix:()=>Hu,degreesToQuat:()=>eu,destroy:()=>U_,distance:()=>Fy,distanceSquared:()=>wy,div:()=>Ny,doesObjectPropertyUseAccessors:()=>sP,dot:()=>Gy,error:()=>zf,exportVariables:()=>Cb,find:()=>yy,findAll:()=>hy,findAllEqual:()=>dy,findAllIndexes:()=>cy,findAllIndexesEqual:()=>gy,findEqual:()=>py,findIndex:()=>uy,findIndexEqual:()=>_y,first:()=>ry,floor:()=>Uf,fromAxis:()=>Ku,fromAxisDegrees:()=>Ju,fromAxisRadians:()=>Zu,fromDegrees:()=>$u,fromMatrix:()=>Dy,fromQuat:()=>Iy,fromRadians:()=>Yu,fromTwistSwing:()=>lh,generate360TeleportParamsFromMovementParams:()=>vT,getAngle:()=>Gu,getAngleDegrees:()=>Uu,getAngleRadians:()=>Wu,getAudioManager:()=>xm,getAxesLocal:()=>kh,getAxesWorld:()=>Lh,getAxis:()=>Nu,getAxisScaled:()=>Qu,getAxisScaledDegrees:()=>qu,getAxisScaledRadians:()=>Xu,getBackwardLocal:()=>zh,getBackwardWorld:()=>jh,getBody:()=>Am,getCanvas:()=>xg,getCharacterCollisionSystem:()=>Lg,getChildren:()=>L_,getClassFromType:()=>EP,getCloneCallback:()=>zP,getClonePostProcessCallback:()=>WP,getComponentBreadth:()=>ug,getComponentChildren:()=>Gd,getComponentDepth:()=>hg,getComponentDescendants:()=>jd,getComponentDescendantsBreadth:()=>zd,getComponentDescendantsDepth:()=>Nd,getComponentHierarchy:()=>kd,getComponentHierarchyBreadth:()=>Fd,getComponentHierarchyDepth:()=>wd,getComponentObjects:()=>eg,getComponentSelf:()=>Ld,getComponentsAmountMapChildren:()=>$_,getComponentsAmountMapDescendants:()=>Y_,getComponentsAmountMapHierarchy:()=>Z_,getComponentsAmountMapSelf:()=>J_,getComponentsBreadth:()=>cg,getComponentsChildren:()=>Zd,getComponentsDepth:()=>pg,getComponentsDescendants:()=>Xd,getComponentsDescendantsBreadth:()=>Kd,getComponentsDescendantsDepth:()=>Jd,getComponentsHierarchy:()=>Wd,getComponentsHierarchyBreadth:()=>Qd,getComponentsHierarchyDepth:()=>qd,getComponentsObjects:()=>tg,getComponentsSelf:()=>Ud,getConsoleOriginalAssert:()=>db,getConsoleOriginalClear:()=>_b,getConsoleOriginalDebug:()=>pb,getConsoleOriginalError:()=>ub,getConsoleOriginalInfo:()=>cb,getConsoleOriginalLog:()=>yb,getConsoleOriginalWarn:()=>hb,getConsoleVR:()=>df,getDebugManager:()=>Pl,getDebugVisualManager:()=>Vg,getDefaultMaterials:()=>Vf,getDefaultMeshes:()=>Af,getDefaultResources:()=>Mr,getDefaultWLComponentCloneCallback:()=>qP,getDescendants:()=>B_,getDescendantsBreadth:()=>I_,getDescendantsDepth:()=>H_,getDocument:()=>ml,getDownLocal:()=>Wh,getDownWorld:()=>Uh,getDummyServer:()=>pT,getEasyTuneTarget:()=>Sf,getEasyTuneVariables:()=>Pf,getEngine:()=>j_,getEngines:()=>Sg,getForwardLocal:()=>wh,getForwardWorld:()=>Fh,getFrame:()=>sC,getGamepad:()=>qg,getGamepads:()=>Xg,getGamepadsManager:()=>Qg,getHandPose:()=>Yg,getHandPoses:()=>$g,getHandednessByIndex:()=>gC,getHeadPose:()=>Zg,getHierarchy:()=>A_,getHierarchyBreadth:()=>V_,getHierarchyDepth:()=>O_,getID:()=>z_,getInputManager:()=>qe,getInputSource:()=>fC,getInputSourceType:()=>CC,getInputSourceTypeByHandedness:()=>PC,getJavascriptComponentClass:()=>AP,getJavascriptComponentClassesByIndex:()=>VP,getJavascriptComponentInstances:()=>RP,getJavascriptComponentTypeFromIndex:()=>IP,getJavascriptComponentTypeIndex:()=>OP,getJavascriptComponentTypeIndexes:()=>BP,getJointIDByIndex:()=>bC,getKeyboard:()=>Wg,getLayerFlagsNames:()=>RC,getLeaderboard:()=>gT,getLeaderboardDummy:()=>fT,getLeftGamepad:()=>Kg,getLeftHandPose:()=>ef,getLeftLocal:()=>qh,getLeftTrackedHandPose:()=>sf,getLeftWorld:()=>Qh,getMainEngine:()=>pi,getMouse:()=>Ug,getName:()=>F_,getNavigator:()=>Rm,getObjectByIDBreadth:()=>Pg,getObjectByIDChildren:()=>R_,getObjectByIDDepth:()=>Cg,getObjectByIDDescendants:()=>M_,getObjectByIDDescendantsBreadth:()=>E_,getObjectByIDDescendantsDepth:()=>D_,getObjectByIDHierarchy:()=>S_,getObjectByIDHierarchyBreadth:()=>v_,getObjectByIDHierarchyDepth:()=>x_,getObjectByIDObjects:()=>sg,getObjectByNameBreadth:()=>dg,getObjectByNameChildren:()=>d_,getObjectByNameDepth:()=>_g,getObjectByNameDescendants:()=>h_,getObjectByNameDescendantsBreadth:()=>c_,getObjectByNameDescendantsDepth:()=>p_,getObjectByNameHierarchy:()=>m_,getObjectByNameHierarchyBreadth:()=>y_,getObjectByNameHierarchyDepth:()=>u_,getObjectByNameObjects:()=>ng,getObjectFromPath:()=>$f,getObjectNameFromPath:()=>eP,getObjectParentFromPath:()=>tP,getObjectProperty:()=>Kf,getObjectPropertyDescriptor:()=>Xf,getObjectPropertyNames:()=>qf,getObjectPropertyOwnParent:()=>Zf,getObjectPropertyOwnParents:()=>Yf,getObjectPrototypes:()=>Qf,getObjects:()=>lg,getObjectsBreadth:()=>mg,getObjectsByIDObjects:()=>ag,getObjectsByNameBreadth:()=>gg,getObjectsByNameChildren:()=>b_,getObjectsByNameDepth:()=>fg,getObjectsByNameDescendants:()=>P_,getObjectsByNameDescendantsBreadth:()=>C_,getObjectsByNameDescendantsDepth:()=>T_,getObjectsByNameHierarchy:()=>__,getObjectsByNameHierarchyBreadth:()=>g_,getObjectsByNameHierarchyDepth:()=>f_,getObjectsByNameObjects:()=>og,getObjectsDepth:()=>yg,getOppositeHandedness:()=>TC,getParent:()=>od,getPhysics:()=>vg,getPlayerObjects:()=>Lf,getPositionLocal:()=>ch,getPositionWorld:()=>hh,getReferenceSpace:()=>nC,getReferenceSpaceType:()=>oC,getRightGamepad:()=>Jg,getRightHandPose:()=>tf,getRightLocal:()=>Kh,getRightTrackedHandPose:()=>af,getRightWorld:()=>Xh,getRotationLocal:()=>Ch,getRotationLocalDegrees:()=>Th,getRotationLocalMatrix:()=>Sh,getRotationLocalQuat:()=>vh,getRotationLocalRadians:()=>bh,getRotationMatrix:()=>ph,getRotationWorld:()=>dh,getRotationWorldDegrees:()=>_h,getRotationWorldMatrix:()=>fh,getRotationWorldQuat:()=>Ph,getRotationWorldRadians:()=>gh,getSDK:()=>_T,getScaleLocal:()=>Mh,getScaleWorld:()=>xh,getScene:()=>gl,getSceneObjects:()=>Of,getSelf:()=>k_,getSession:()=>tC,getSessionMode:()=>iC,getSimultaneousPressMaxDelay:()=>WT,getSimultaneousTouchMaxDelay:()=>QT,getSwing:()=>sh,getSwingFromTwist:()=>ah,getTrackedHandPose:()=>nf,getTrackedHandPoses:()=>of,getTransform:()=>Eh,getTransformLocal:()=>Bh,getTransformLocalMatrix:()=>Ih,getTransformLocalQuat:()=>Hh,getTransformMatrix:()=>Dh,getTransformQuat:()=>Rh,getTransformWorld:()=>Ah,getTransformWorldMatrix:()=>Vh,getTransformWorldQuat:()=>Oh,getTwist:()=>oh,getTwistFromSwing:()=>rh,getTypeFromTypeOrClass:()=>MP,getUpLocal:()=>Gh,getUpWorld:()=>Nh,getUser:()=>TT,getUserDummy:()=>bT,getVisualManager:()=>Hm,getVisualResources:()=>Vm,getWASM:()=>Mg,getWLJavascriptComponentTypes:()=>xP,getWLNativeComponentTypes:()=>vP,getWindow:()=>ur,getXR:()=>Eg,hasAudioManager:()=>Dm,hasCharacterCollisionSystem:()=>wg,hasCloneCallback:()=>NP,hasClonePostProcess:()=>LP,hasClonePostProcessCallback:()=>QP,hasConsoleVR:()=>ff,hasDebugEnabled:()=>Hg,hasDebugManager:()=>Ag,hasDefaultResources:()=>Rf,hasDefaultWLComponentCloneCallback:()=>XP,hasEasyTuneTarget:()=>Mf,hasEasyTuneVariables:()=>bf,hasEngine:()=>_l,hasEqual:()=>my,hasInputManager:()=>Gg,hasPoseForwardFixed:()=>yf,hasSceneObjects:()=>Hf,hasToolEnabled:()=>pf,hasUniformScaleLocal:()=>l_,hasUniformScaleWorld:()=>r_,hasVisualManager:()=>Fm,hasVisualResources:()=>Im,hsvCodeToHuman:()=>XC,hsvHumanToCode:()=>KC,hsvToRGB:()=>WC,importVariables:()=>Pb,initArrayExtension:()=>Rl,initArrayExtensionProtoype:()=>cP,initBridge:()=>MT,initComponentMods:()=>ql,initCursorComponentMod:()=>Ul,initCursorComponentModPrototype:()=>SC,initCursorTargetComponentMod:()=>Wl,initCursorTargetComponentModPrototype:()=>vC,initEmitterMod:()=>Xl,initEmitterModPrototype:()=>MC,initEngine:()=>bg,initJSExtensions:()=>Fl,initJSPlugins:()=>wl,initMathExtension:()=>Ll,initMathExtensionStatic:()=>ZP,initMouseLookComponentMod:()=>Ql,initMouseLookComponentModPrototype:()=>xC,initNumberExtension:()=>kl,initNumberExtensionPrototype:()=>YP,initObjectExtension:()=>jl,initObjectExtensionProtoype:()=>$P,initPP:()=>$l,initPlugins:()=>Zl,initSceneExtension:()=>zl,initSceneExtensionPrototype:()=>eC,initWLExtensions:()=>Nl,initWLMods:()=>Kl,initWLPlugins:()=>Jl,injectProperties:()=>hP,isARSupported:()=>dC,isAnyButtonPressEnd:()=>cA,isAnyButtonPressStart:()=>qT,isAnyButtonTouchEnd:()=>YT,isAnyButtonTouchStart:()=>JT,isClass:()=>yP,isClassByName:()=>rP,isConcordant:()=>su,isDebugEnabled:()=>Og,isDesktop:()=>aT,isDeviceEmulated:()=>_C,isFartherAlongAxis:()=>au,isFunction:()=>mP,isFunctionByName:()=>aP,isInsideAngleRange:()=>oy,isInsideAngleRangeDegrees:()=>sy,isInsideAngleRangeRadians:()=>ay,isMobile:()=>sT,isObject:()=>uP,isObjectByName:()=>lP,isOnAxis:()=>cu,isOnPlane:()=>pu,isPlaybackBlocked:()=>HC,isPoseForwardFixed:()=>rf,isReferenceSpaceFloorBased:()=>rC,isSDKAvailable:()=>dT,isSessionActive:()=>aC,isToTheRight:()=>ru,isToolEnabled:()=>uf,isTransformChanged:()=>G_,isTypeRegistered:()=>DP,isUseDummyServerOnError:()=>cT,isUseDummyServerOnSDKMissing:()=>hT,isVRSupported:()=>pC,isWLComponent:()=>TP,isWLJavascriptComponent:()=>SP,isWLNativeComponent:()=>bP,isWLNativeComponentRegistered:()=>HP,last:()=>ly,lengthSigned:()=>Ky,load:()=>wC,loadBool:()=>NC,loadNumber:()=>zC,loadString:()=>jC,log:()=>jf,lookAt:()=>Zp,lookAtLocal:()=>$p,lookAtWorld:()=>Yp,lookTo:()=>ed,lookToLocal:()=>id,lookToWorld:()=>td,mapToRange:()=>Gm,markDirty:()=>N_,mat3_create:()=>wE,mat4_create:()=>be,negate:()=>Uy,overwriteObjectProperty:()=>iP,perpendicularRandom:()=>zu,projectOnAxis:()=>mu,projectOnAxisAlongAxis:()=>yu,projectOnPlane:()=>uu,projectOnPlaneAlongAxis:()=>hu,pushUnique:()=>Sy,quat2_create:()=>j,quat_create:()=>z,radiansAddRotation:()=>Vu,radiansAddRotationDegrees:()=>Ou,radiansAddRotationQuat:()=>Iu,radiansAddRotationRadians:()=>Bu,radiansToMatrix:()=>Lu,radiansToQuat:()=>$y,random:()=>Um,randomBool:()=>Qm,randomInt:()=>Wm,randomPick:()=>Xm,randomSign:()=>qm,raycast:()=>AC,refreshWidget:()=>fb,registerPPComponents:()=>Yl,registerSessionEndEventListener:()=>yC,registerSessionStartEndEventListeners:()=>hC,registerSessionStartEventListener:()=>lC,registerWLComponents:()=>rl,removeAll:()=>Cy,removeAllEqual:()=>by,removeAllIndexes:()=>Py,removeAudioManager:()=>Em,removeCharacterCollisionSystem:()=>Fg,removeCloneCallback:()=>jP,removeClonePostProcessCallback:()=>UP,removeComponentAlongAxis:()=>nu,removeConsoleVR:()=>gf,removeDebugEnabled:()=>Ig,removeDebugManager:()=>Rg,removeDefaultResources:()=>Df,removeDefaultWLComponentCloneCallbacks:()=>JP,removeEasyTuneTarget:()=>xf,removeEasyTuneVariables:()=>Tf,removeEngine:()=>dl,removeEqual:()=>Ty,removeIndex:()=>fy,removeInputManager:()=>Ng,removePoseForwardFixed:()=>mf,removeRefreshWidgetCallback:()=>vb,removeSceneObjects:()=>If,removeSetWidgetActiveVariableCallback:()=>bb,removeToolEnabled:()=>cf,removeVisualManager:()=>km,removeVisualResources:()=>Bm,reserveObjects:()=>W_,reserveObjectsChildren:()=>K_,reserveObjectsDescendants:()=>X_,reserveObjectsHierarchy:()=>q_,reserveObjectsSelf:()=>Q_,resetPosition:()=>Ic,resetPositionLocal:()=>Lc,resetPositionWorld:()=>Hc,resetRotation:()=>kc,resetRotationLocal:()=>wc,resetRotationWorld:()=>Fc,resetScale:()=>jc,resetScaleLocal:()=>Nc,resetScaleWorld:()=>zc,resetTransform:()=>Gc,resetTransformLocal:()=>Wc,resetTransformWorld:()=>Uc,rgbCodeToHuman:()=>QC,rgbHumanToCode:()=>qC,rgbToHSV:()=>UC,rotateAroundAxisLocal:()=>Up,rotateAroundAxisLocalDegrees:()=>Wp,rotateAroundAxisLocalRadians:()=>Qp,rotateAroundAxisObject:()=>qp,rotateAroundAxisObjectDegrees:()=>Xp,rotateAroundAxisObjectRadians:()=>Kp,rotateAroundAxisWorld:()=>zp,rotateAroundAxisWorldDegrees:()=>Np,rotateAroundAxisWorldRadians:()=>Gp,rotateAroundLocal:()=>Vp,rotateAroundLocalDegrees:()=>Op,rotateAroundLocalMatrix:()=>Ip,rotateAroundLocalQuat:()=>Hp,rotateAroundLocalRadians:()=>Bp,rotateAroundMatrix:()=>xp,rotateAroundObject:()=>Lp,rotateAroundObjectDegrees:()=>kp,rotateAroundObjectMatrix:()=>wp,rotateAroundObjectQuat:()=>jp,rotateAroundObjectRadians:()=>Fp,rotateAroundWorld:()=>Mp,rotateAroundWorldDegrees:()=>Ep,rotateAroundWorldMatrix:()=>Rp,rotateAroundWorldQuat:()=>Ap,rotateAroundWorldRadians:()=>Dp,rotateAxisLocal:()=>Pp,rotateAxisLocalDegrees:()=>Cp,rotateAxisLocalRadians:()=>Tp,rotateAxisObject:()=>bp,rotateAxisObjectDegrees:()=>Sp,rotateAxisObjectRadians:()=>vp,rotateAxisWorld:()=>_p,rotateAxisWorldDegrees:()=>gp,rotateAxisWorldRadians:()=>fp,rotateLocal:()=>ap,rotateLocalDegrees:()=>rp,rotateLocalMatrix:()=>mp,rotateLocalQuat:()=>yp,rotateLocalRadians:()=>lp,rotateMatrix:()=>ep,rotateObject:()=>up,rotateObjectDegrees:()=>hp,rotateObjectMatrix:()=>pp,rotateObjectQuat:()=>dp,rotateObjectRadians:()=>cp,rotateWorld:()=>tp,rotateWorldDegrees:()=>ip,rotateWorldMatrix:()=>op,rotateWorldQuat:()=>sp,rotateWorldRadians:()=>np,rotationToPivoted:()=>ku,rotationToPivotedDegrees:()=>Fu,rotationToPivotedQuat:()=>ju,rotationToPivotedRadians:()=>wu,round:()=>Gf,roundDecimal:()=>Nm,save:()=>FC,scaleObject:()=>Jp,setActive:()=>Yd,setActiveChildren:()=>a_,setActiveDescendants:()=>n_,setActiveDescendantsBreadth:()=>o_,setActiveDescendantsDepth:()=>s_,setActiveHierarchy:()=>e_,setActiveHierarchyBreadth:()=>t_,setActiveHierarchyDepth:()=>i_,setActiveObjects:()=>ig,setActiveSelf:()=>$d,setAlpha:()=>YC,setAudioManager:()=>Mm,setAxesLocal:()=>hc,setAxesWorld:()=>uc,setBackwardLocal:()=>_c,setBackwardWorld:()=>dc,setCharacterCollisionSystem:()=>kg,setCloneCallback:()=>wP,setClonePostProcessCallback:()=>GP,setClonedMaterials:()=>oT,setConsoleVR:()=>_f,setDebugEnabled:()=>Bg,setDebugManager:()=>Dg,setDefaultResources:()=>Ef,setDefaultWLComponentCloneCallbacks:()=>KP,setDownLocal:()=>Cc,setDownWorld:()=>Pc,setDummyServer:()=>uT,setEasyTuneTarget:()=>vf,setEasyTuneVariables:()=>Cf,setForwardLocal:()=>pc,setForwardWorld:()=>cc,setInputManager:()=>zg,setLayerFlagsNames:()=>DC,setLeftLocal:()=>bc,setLeftWorld:()=>Tc,setMainEngine:()=>cl,setName:()=>w_,setObjectAlpha:()=>$C,setObjectClonedMaterials:()=>tT,setObjectFogColor:()=>nT,setObjectMaterial:()=>eT,setObjectProperty:()=>Jf,setObjectSpecularColor:()=>iT,setParent:()=>nd,setPoseForwardFixed:()=>lf,setPositionLocal:()=>Zh,setPositionRotationDegreesScale:()=>Vy,setPositionRotationQuatScale:()=>By,setPositionRotationRadiansScale:()=>Oy,setPositionRotationScale:()=>Ay,setPositionWorld:()=>Jh,setRightLocal:()=>vc,setRightWorld:()=>Sc,setRotationLocal:()=>oc,setRotationLocalDegrees:()=>sc,setRotationLocalMatrix:()=>rc,setRotationLocalQuat:()=>lc,setRotationLocalRadians:()=>ac,setRotationMatrix:()=>Yh,setRotationWorld:()=>$h,setRotationWorldDegrees:()=>ec,setRotationWorldMatrix:()=>ic,setRotationWorldQuat:()=>nc,setRotationWorldRadians:()=>tc,setScaleLocal:()=>yc,setScaleWorld:()=>mc,setSceneObjects:()=>Bf,setSimultaneousPressMaxDelay:()=>GT,setSimultaneousTouchMaxDelay:()=>UT,setToolEnabled:()=>hf,setTransform:()=>xc,setTransformLocal:()=>Vc,setTransformLocalMatrix:()=>Oc,setTransformLocalQuat:()=>Bc,setTransformMatrix:()=>Mc,setTransformQuat:()=>Ec,setTransformWorld:()=>Dc,setTransformWorldMatrix:()=>Rc,setTransformWorldQuat:()=>Ac,setUpLocal:()=>fc,setUpWorld:()=>gc,setUseDummyServerOnError:()=>yT,setUseDummyServerOnSDKMissing:()=>mT,setVisualManager:()=>Lm,setVisualResources:()=>Om,setWidgetActiveVariable:()=>gb,sign:()=>zm,signTo:()=>lu,sinterpolate:()=>yh,slerp:()=>mh,sub:()=>zy,subRotation:()=>eh,subRotationDegrees:()=>th,subRotationQuat:()=>nh,subRotationRadians:()=>ih,submitScore:()=>PT,submitScoreDummy:()=>CT,transformMat3:()=>qy,transformMat4:()=>Xy,transformQuat:()=>Qy,translate:()=>Qc,translateAxis:()=>Jc,translateAxisLocal:()=>Yc,translateAxisObject:()=>$c,translateAxisWorld:()=>Zc,translateLocal:()=>Xc,translateObject:()=>Kc,translateWorld:()=>qc,unregisterSessionEndEventListener:()=>uC,unregisterSessionStartEndEventListeners:()=>cC,unregisterSessionStartEventListener:()=>mC,unshiftUnique:()=>vy,updateCeilingInfo:()=>VT,updateGroundInfo:()=>AT,valueAlongAxis:()=>iu,vec2_create:()=>De,vec3_create:()=>m,vec4_create:()=>w,warn:()=>Nf,wrapObject:()=>rg});import{ARCamera8thwall as Ob,Cursor as Bb,CursorTarget as Ib,DebugObject as Hb,DeviceOrientationLook as Lb,FingerCursor as kb,FixedFoveation as Fb,HandTracking as wb,HitTestLocation as jb,HowlerAudioListener as zb,HowlerAudioSource as Nb,ImageTexture as Gb,MouseLookComponent as Ub,PlayerHeight as Wb,TargetFramerate as Qb,TeleportComponent as qb,Trail as Xb,TwoJointIkSolver as Kb,VideoTexture as Jb,VrModeActiveSwitch as Zb,Vrm as Yb,WasdControlsComponent as $b}from"@wonderlandengine/components";function rl(i){i.registerComponent(Ob,Bb,Ib,Hb,Lb,kb,Fb,wb,jb,zb,Nb,Gb,Ub,Wb,Qb,qb,Xb,Kb,Jb,Zb,Yb,$b)}import{AnimationComponent as Ol,CollisionComponent as Ar,InputComponent as Bl,LightComponent as Il,MeshComponent as Vr,PhysXComponent as Or,TextComponent as Br,ViewComponent as Hl}from"@wonderlandengine/api";import{ARCamera8thwall as GE,Anchor as UE,Cursor as WE,CursorTarget as QE,DebugObject as qE,DeviceOrientationLook as XE,FingerCursor as KE,FixedFoveation as JE,HandTracking as ZE,HitTestLocation as YE,HowlerAudioListener as $E,HowlerAudioSource as eD,ImageTexture as tD,MouseLookComponent as iD,PlaneDetection as nD,PlayerHeight as oD,TargetFramerate as sD,TeleportComponent as aD,Trail as rD,TwoJointIkSolver as lD,VideoTexture as mD,VrModeActiveSwitch as yD,Vrm as uD,WasdControlsComponent as hD}from"@wonderlandengine/components";var ll={};bt(ll,{getAudioManager:()=>xm,hasAudioManager:()=>Dm,removeAudioManager:()=>Em,setAudioManager:()=>Mm});var yr=new WeakMap;function xm(i=r.getMainEngine()){return yr.get(i)}function Mm(i,e=r.getMainEngine()){yr.set(e,i)}function Em(i=r.getMainEngine()){yr.delete(i)}function Dm(i=r.getMainEngine()){return yr.has(i)}var yl={};bt(yl,{getBody:()=>Am,getDocument:()=>ml,getNavigator:()=>Rm,getWindow:()=>ur});function ur(i=r.getMainEngine()){return window}function Rm(i=r.getMainEngine()){return ur(i).navigator}function ml(i=r.getMainEngine()){return ur(i).document}function Am(i=r.getMainEngine()){return ml(i).body}var ul={};bt(ul,{getVisualManager:()=>Hm,getVisualResources:()=>Vm,hasVisualManager:()=>Fm,hasVisualResources:()=>Im,removeVisualManager:()=>km,removeVisualResources:()=>Bm,setVisualManager:()=>Lm,setVisualResources:()=>Om});var hr=new WeakMap,cr=new WeakMap;function Vm(i=r.getMainEngineinEngine()){return hr.get(i)}function Om(i,e=r.getMainEngine()){hr.set(e,i)}function Bm(i=r.getMainEngine()){hr.delete(i)}function Im(i=r.getMainEngine()){return hr.has(i)}function Hm(i=r.getMainEngine()){return cr.get(i)}function Lm(i,e=r.getMainEngine()){cr.set(e,i)}function km(i=r.getMainEngine()){cr.delete(i)}function Fm(i=r.getMainEngine()){return cr.has(i)}var fl={};bt(fl,{addEngine:()=>pl,getCanvas:()=>xg,getEngines:()=>Sg,getMainEngine:()=>pi,getPhysics:()=>vg,getRoot:()=>xE,getScene:()=>gl,getWASM:()=>Mg,getXR:()=>Eg,hasEngine:()=>_l,initEngine:()=>bg,removeEngine:()=>dl,setMainEngine:()=>cl});var ue={linear:i=>i,easeIn:i=>i*i*i,easeOut:i=>(i-1)*(i-1)*(i-1)+1,easeInOut:i=>i<.5?4*i*i*i:(i-1)*(2*i-2)*(2*i-2)+1},pr=1e-6,wm=pr*pr,jm=1e-5;function eS(i,e,t){let n=e??-Number.MAX_VALUE,o=t??Number.MAX_VALUE,s=Math.min(n,o),a=Math.max(n,o);return Math.min(Math.max(i,s),a)}function zm(i,e=1){let t=Math.sign(i);return t==0&&(t=Math.sign(e)),t}function tS(i){return i*(180/Math.PI)}function iS(i){return i*(Math.PI/180)}function Nm(i,e){let t=Math.pow(10,e);return i=Math.round(i*t)/t,i}function Gm(i,e,t,n,o){if(e==t)return n;let s=H.clamp(i,e,t);if(s==e)return n;if(s==t)return o;let a=n+(o-n)/(t-e)*(s-e);return H.clamp(a,n,o)}function Um(i=0,e=1){return Math.random()*(e-i)+i}function Wm(i,e){let t=Math.min(i,e),n=Math.max(i,e);return Math.floor(Math.random()*(n-t+1)+t)}function Qm(){return H.randomInt(0,1)==0}function qm(){return Math.random()<.5?1:-1}function Xm(...i){let e=null;if(i.length>0)if(i.length==1&&i[0].length!=null){if(i[0].length>0){let t=H.randomInt(0,i[0].length-1);e=i[0][t]}}else{let t=H.randomInt(0,i.length-1);e=i[t]}return e}function nS(i,e,t){return t<=0?i:t>=1?e:t*(e-i)+i}function oS(i,e,t,n=ue.linear){let o=n(t);return H.lerp(i,e,o)}function Km(i,e){return H.angleDistanceDegrees(i,e)}function Jm(i,e){return Math.abs(H.angleDistanceSignedDegrees(i,e))}function Zm(i,e){return Math.abs(H.angleDistanceSignedRadians(i,e))}function Ym(i,e){return H.angleDistanceSignedDegrees(i,e)}function $m(i,e){let t=H.angleClampDegrees(i,!0),n=H.angleClampDegrees(e,!0),o=n-t;return n-t>180?o=n-t-360:n-t<-180&&(o=n-t+360),o}function ey(i,e){return H.toRadians(H.angleDistanceSignedDegrees(H.toDegrees(i),H.toDegrees(e)))}function ty(i,e=!1){return H.angleClampDegrees(i,e)}function iy(i,e=!1){let t=i%360;return t<0&&(t+=360),e||t>180&&(t-=360),t}function ny(i,e=!1){return H.toRadians(H.angleClampDegrees(H.toDegrees(i),e))}function oy(i,e,t,n=!1){return H.isInsideAngleRangeDegrees(i,e,t,n)}function sy(i,e,t,n=!1){let o=!1,s=H.angleClampDegrees(i,!0),a=H.angleClampDegrees(e,!0),l=H.angleClampDegrees(t,!0);if(n&&H.angleDistanceSignedDegrees(a,l)<0){let h=a;a=l,l=h}return a<l?o=s>=a&&s<=l:o=s>=a||s<=l,o}function ay(i,e,t,n=!1){return H.isInsideAngleRangeDegrees(H.toDegrees(i),H.toDegrees(e),H.toDegrees(t),n)}var H={EPSILON:pr,EPSILON_SQUARED:wm,EPSILON_DEGREES:jm,clamp:eS,sign:zm,toDegrees:tS,toRadians:iS,roundDecimal:Nm,mapToRange:Gm,random:Um,randomInt:Wm,randomBool:Qm,randomSign:qm,randomPick:Xm,lerp:nS,interpolate:oS,angleDistance:Km,angleDistanceDegrees:Jm,angleDistanceRadians:Zm,angleDistanceSigned:Ym,angleDistanceSignedDegrees:$m,angleDistanceSignedRadians:ey,angleClamp:ty,angleClampDegrees:iy,angleClampRadians:ny,isInsideAngleRange:oy,isInsideAngleRangeDegrees:sy,isInsideAngleRangeRadians:ay};import{mat3 as hl,quat as mM}from"gl-matrix";import{mat3 as px,quat as Ye}from"gl-matrix";function ry(i){return i.length>0?i[0]:void 0}function ly(i){return i.length>0?i[i.length-1]:void 0}function sS(i,e){return q.find(i,e)!=null}function my(i,e,t=null){return q.findEqual(i,e,t)!=null}function yy(i,e){let t,n=i.findIndex(e);return n>=0&&(t=i[n]),t}function uy(i,e){return i.findIndex(e)}function hy(i,e){return i.filter(e)}function cy(i,e){let t=[];for(let n=0;n<i.length;n++){let o=i[n];e(o)&&t.push(n)}return t}function py(i,e,t=null){if(t==null){let o=q.findIndexEqual(i,e);return o<0?void 0:i[o]}let n;for(let o=0;o<i.length;o++){let s=i[o];if(t(s,e)){n=s;break}}return n}function dy(i,e,t=null){if(t==null)return xy(i,e,!1);let n=[];for(let o=0;o<i.length;o++){let s=i[o];t(s,e)&&n.push(s)}return n}function _y(i,e,t=null){if(t==null)return i.indexOf(e);let n=-1;for(let o=0;o<i.length;o++){let s=i[o];if(t(s,e)){n=o;break}}return n}function gy(i,e,t=null){if(t==null)return xy(i,e,!0);let n=[];for(let o=0;o<i.length;o++){let s=i[o];t(s,e)&&n.push(o)}return n}function fy(i,e){let t;if(e>=0&&e<i.length){let n=i.splice(e,1);n.length==1&&(t=n[0])}return t}function Py(i,e){let t=[];for(let n of e){let o=q.removeIndex(i,n);o!==void 0&&t.push(o)}return t}function aS(i,e){let t,n=i.findIndex(e);return n>=0&&(t=q.removeIndex(i,n)),t}function Cy(i,e){let t=[],n;do n=q.remove(i,e),n!==void 0&&t.push(n);while(n!==void 0);return t}function Ty(i,e,t=null){return q.removeIndex(i,q.findIndexEqual(i,e,t))}function by(i,e,t=null){return q.removeAllIndexes(i,q.findAllIndexesEqual(i,e,t))}function Sy(i,e,t=null){let n=i.length;return q.hasEqual(i,e,t)||(n=i.push(e)),n}function vy(i,e,t=null){let n=i.length;return q.hasEqual(i,e,t)||(n=i.unshift(e)),n}function rS(i,e,t=null){for(;e.length>i.length;)e.pop();for(let n=0;n<i.length;n++)t==null?e[n]=i[n]:e[n]=t(e[n],i[n]);return e}function lS(i,e=null){if(e==null)return i.slice(0);let t=null;switch(i.constructor.name){case"Array":t=new Array(i.length);break;case"Uint8ClampedArray":t=new Uint8ClampedArray(i.length);break;case"Uint8Array":t=new Uint8Array(i.length);break;case"Uint16Array":t=new Uint16Array(i.length);break;case"Uint32Array":t=new Uint32Array(i.length);break;case"Int8Array":t=new Int8Array(i.length);break;case"Int16Array":t=new Int16Array(i.length);break;case"Int32Array":t=new Int32Array(i.length);break;case"Float32Array":t=new Float32Array(i.length);break;case"Float64Array":t=new Float64Array(i.length);break;default:t=new Array(i.length),console.error("Cloned array type not supported!");break}for(let n=0;n<i.length;n++)t[n]=q.cloneCallback(i[n]);return t}function mS(i,e,t=null){let n=!0;if(e!=null&&i.length==e.length){for(let o=0;o<i.length;o++)if(t!=null&&!t(i[o],e[o])||t==null&&i[o]!=e[o]){n=!1;break}}else n=!1;return n}function yS(i){return i.length=0,i}var q={first:ry,last:ly,has:sS,hasEqual:my,find:yy,findIndex:uy,findAll:hy,findAllIndexes:cy,findEqual:py,findAllEqual:dy,findIndexEqual:_y,findAllIndexesEqual:gy,removeIndex:fy,removeAllIndexes:Py,remove:aS,removeAll:Cy,removeEqual:Ty,removeAllEqual:by,pushUnique:Sy,unshiftUnique:vy,copy:rS,clone:lS,equals:mS,clear:yS};function xy(i,e,t){let n=[],o=-1;for(;(o=i.indexOf(e,o+1))>=0;)n.push(t?o:i[o]);return n}import{vec3 as Ie}from"gl-matrix";import{mat4 as St}from"gl-matrix";import{mat4 as uS,quat2 as _t}from"gl-matrix";function My(i,e,t,n,o,s,a,l){let h=_t.create();return i!==void 0&&Ey(h,i,e,t,n,o,s,a,l),h}function Ey(i,e,t,n,o,s,a,l,h){return t===void 0?_t.set(i,e,e,e,e,e,e,e,e):_t.set(i,e,t,n,o,s,a,l,h),i}function hS(i,e=O.create()){return _t.normalize(e,i),e}function cS(i,e=O.create()){return _t.invert(e,i),e}function pS(i,e=O.create()){return _t.conjugate(e,i),e}function dS(i,e){return _t.copy(e,i),e}function _S(i){return _t.identity(i),i}function gS(i,e=p.create()){return _t.getTranslation(e,i),e}function fS(i,e){return O.getRotationDegrees(i,e)}var PS=function(){let i=X();return function(t,n=p.create()){return f.toDegrees(O.getRotationQuat(t,i),n),n}}(),CS=function(){let i=X();return function(t,n=p.create()){return f.toRadians(O.getRotationQuat(t,i),n),n}}();function TS(i,e=f.create()){return f.copy(i,e),e}var bS=function(){let i=X();return function(t,n){return O.getRotationQuat(t,i),O.setPositionRotationQuat(t,n,i),t}}();function SS(i,e){return O.setRotationDegrees(i,e)}var vS=function(){let i=W();return function(t,n){return O.getPosition(t,i),O.setPositionRotationDegrees(t,i,n),t}}(),xS=function(){let i=W();return function(t,n){return O.getPosition(t,i),O.setPositionRotationRadians(t,i,n),t}}(),MS=function(){let i=W();return function(t,n){return O.getPosition(t,i),O.setPositionRotationQuat(t,i,n),t}}();function ES(i,e,t){return O.setPositionRotationDegrees(i,e,t)}var DS=function(){let i=X();return function(t,n,o){return p.degreesToQuat(o,i),O.setPositionRotationQuat(t,n,i),t}}(),RS=function(){let i=X();return function(t,n,o){return p.radiansToQuat(o,i),O.setPositionRotationQuat(t,n,i),t}}();function AS(i,e,t){return _t.fromRotationTranslation(i,t,e),i}function VS(i,e=MathUtils.EPSILON){return Math.abs(O.lengthSquared(i)-1)<e}function OS(i){return _t.length(i)}function BS(i){return _t.squaredLength(i)}function IS(i,e,t=O.create()){return _t.mul(t,i,e),t}function HS(i,e=[p.create(),p.create(),p.create()]){return O.getLeft(i,e[0]),O.getUp(i,e[1]),O.getForward(i,e[2]),e}var LS=function(){let i=Rt();return function(t,n=p.create()){return f.toMatrix(t,i),p.set(n,i[6],i[7],i[8]),p.normalize(n,n),n}}();function kS(i,e){return O.getForward(i,e),p.negate(e,e),e}var FS=function(){let i=Rt();return function(t,n=p.create()){return f.toMatrix(t,i),p.set(n,i[0],i[1],i[2]),p.normalize(n,n),n}}();function wS(i,e){return O.getLeft(i,e),p.negate(e,e),e}var jS=function(){let i=Rt();return function(t,n=p.create()){return f.toMatrix(t,i),p.set(n,i[3],i[4],i[5]),p.normalize(n,n),n}}();function zS(i,e){return O.getUp(i,e),p.negate(e,e),e}function NS(i,e,t=O.create()){return O.mul(e,i,t),t}var GS=function(){let i=My();return function(t,n,o=O.create()){return O.conjugate(n,i),O.mul(i,t,o),o}}();function US(i,e,t,n){return O.rotateAxisDegrees(i,e,t,n)}function WS(i,e,t,n){return O.rotateAxisRadians(i,MathUtils.toRadians(e),t,n)}var QS=function(){let i=X();return function(t,n,o,s){return O.getRotationQuat(t,i),f.rotateAxisRadians(i,n,o,i),O.copy(t,s),O.setRotationQuat(s,i),s}}();function qS(i,e=V.create()){return uS.fromQuat2(e,i),e}function Dy(i,e=O.create()){return V.toQuat(i,e),e}function XS(i,e,t,n=O.create()){return t<=0?(O.copy(i,n),n):t>=1?(O.copy(e,n),n):(_t.lerp(n,i,e,t),n)}function KS(i,e,t,n=ue.linear,o=O.create()){let s=n(t);return O.lerp(i,e,s,o)}var O={create:My,set:Ey,normalize:hS,invert:cS,conjugate:pS,copy:dS,identity:_S,getPosition:gS,getRotation:fS,getRotationDegrees:PS,getRotationRadians:CS,getRotationQuat:TS,setPosition:bS,setRotation:SS,setRotationDegrees:vS,setRotationRadians:xS,setRotationQuat:MS,setPositionRotation:ES,setPositionRotationDegrees:DS,setPositionRotationRadians:RS,setPositionRotationQuat:AS,isNormalized:VS,length:OS,lengthSquared:BS,mul:IS,getAxes:HS,getForward:LS,getBackward:kS,getLeft:FS,getRight:wS,getUp:jS,getDown:zS,toWorld:NS,toLocal:GS,rotateAxis:US,rotateAxisDegrees:WS,rotateAxisRadians:QS,toMatrix:qS,fromMatrix:Dy,lerp:XS,interpolate:KS};function wi(i,e,t,n,o,s,a,l,h,_,y,c,d,g,P,T){let C=St.create();return i!==void 0&&Ry(C,i,e,t,n,o,s,a,l,h,_,y,c,d,g,P,T),C}function Ry(i,e,t,n,o,s,a,l,h,_,y,c,d,g,P,T,C){return t===void 0?St.set(i,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e,e):St.set(i,e,t,n,o,s,a,l,h,_,y,c,d,g,P,T,C),i}function JS(i,e){return St.copy(e,i),e}function ZS(i){return St.identity(i),i}function YS(i,e=V.create()){return St.invert(e,i),e}function $S(i,e,t=V.create()){return St.mul(t,i,e),t}function ev(i,e,t=V.create()){return St.scale(t,i,e),t}function tv(i,e=V.create()){return V.copy(i,e),e}function iv(i,e=p.create()){return St.getTranslation(e,i),e}function nv(i,e=p.create()){return V.getRotationDegrees(i,e)}var ov=function(){let i=X();return function(t,n=p.create()){return V.getRotationQuat(t,i),f.toDegrees(i,n),n}}(),sv=function(){let i=X();return function(t,n=p.create()){return V.getRotationQuat(t,i),f.toRadians(i,n),n}}(),av=function(){let i=W(),e=wi(),t=W(),n=W();return ji(n,1,1,1),function(s,a=f.create()){return V.getScale(s,i),p.div(n,i,t),V.scale(s,t,e),St.getRotation(a,e),f.normalize(a,a),a}}();function rv(i,e=p.create()){return St.getScaling(e,i),e}function lv(i,e){return i[12]=e[0],i[13]=e[1],i[14]=e[2],i}function mv(i,e){return V.setRotationDegrees(i,e),i}var yv=function(){let i=X();return function(t,n){return V.setRotationQuat(t,p.degreesToQuat(n,i)),t}}(),uv=function(){let i=W();return function(t,n){return V.setRotationDegrees(t,p.toDegrees(n,i)),t}}(),hv=function(){let i=W(),e=W();return function(n,o){return V.getPosition(n,i),V.getScale(n,e),V.setPositionRotationQuatScale(n,i,o,e),n}}(),cv=function(){let i=W();return function(t,n){return V.getScale(t,i),p.div(n,i,i),V.scale(t,i,t),t}}();function Ay(i,e,t,n){return V.setPositionRotationDegreesScale(i,e,t,n),i}var Vy=function(){let i=X();return function(t,n,o,s){return V.setPositionRotationQuatScale(t,n,p.degreesToQuat(o,i),s),t}}(),Oy=function(){let i=W();return function(t,n,o,s){return V.setPositionRotationDegreesScale(t,n,p.toDegrees(o,i),s),t}}();function By(i,e,t,n){return St.fromRotationTranslationScale(i,t,e,n),i}function pv(i,e,t){return V.setPositionRotationDegrees(i,e,t),i}var dv=function(){let i=X();return function(t,n,o){return V.setPositionRotationQuat(t,n,p.degreesToQuat(o,i)),t}}(),_v=function(){let i=W();return function(t,n,o){return V.setPositionRotationDegrees(t,n,p.toDegrees(o,i)),t}}();function gv(i,e,t){return St.fromRotationTranslation(i,t,e),i}function fv(i,e=[p.create(),p.create(),p.create()]){return V.getLeft(i,e[0]),V.getUp(i,e[1]),V.getForward(i,e[2]),e}function Pv(i,e=p.create()){return p.set(e,i[8],i[9],i[10]),p.normalize(e,e),e}function Cv(i,e){return V.getForward(i,e),p.negate(e,e),e}function Tv(i,e=p.create()){return p.set(e,i[0],i[1],i[2]),p.normalize(e,e),e}function bv(i,e){return V.getLeft(i,e),p.negate(e,e),e}function Sv(i,e=p.create()){return p.set(e,i[4],i[5],i[6]),p.normalize(e,e),e}function vv(i,e){return V.getUp(i,e),p.negate(e,e),e}var xv=function(){let i=wi(),e=W(),t=W(),n=W(),o=W();return ji(o,1,1,1),function(a,l,h=V.create()){return V.hasUniformScale(l)?V.mul(l,a,h):(p.set(e,a[12],a[13],a[14]),p.convertPositionToWorldMatrix(e,l,e),V.getScale(l,t),p.div(o,t,n),V.scale(l,n,i),V.mul(i,a,h),V.scale(h,t,h),h[12]=e[0],h[13]=e[1],h[14]=e[2],h[15]=1),h}}(),Mv=function(){let i=wi(),e=W(),t=W(),n=W(),o=W();return ji(o,1,1,1),function(a,l,h=V.create()){return V.hasUniformScale(l)?(V.invert(l,i),V.mul(i,a,h)):(p.set(e,a[12],a[13],a[14]),p.convertPositionToLocalMatrix(e,l,e),V.getScale(l,t),p.div(o,t,n),V.scale(l,n,i),V.invert(i,i),V.mul(i,a,h),V.scale(h,n,h),h[12]=e[0],h[13]=e[1],h[14]=e[2],h[15]=1),h}}(),Ev=function(){let i=W();return function(t){return V.getScale(t,i),Math.abs(i[0]-i[1])<H.EPSILON&&Math.abs(i[1]-i[2])<H.EPSILON&&Math.abs(i[0]-i[2])<H.EPSILON}}(),Dv=function(){let i=W(),e=X();return function(n,o=O.create()){return V.getPosition(n,i),V.getRotationQuat(n,e),O.setPositionRotationQuat(o,i,e),o}}();function Iy(i,e=V.create()){return O.toMatrix(i,e),e}var V={create:wi,set:Ry,copy:JS,identity:ZS,invert:YS,mul:$S,scale:ev,clone:tv,getPosition:iv,getRotation:nv,getRotationDegrees:ov,getRotationRadians:sv,getRotationQuat:av,getScale:rv,setPosition:lv,setRotation:mv,setRotationDegrees:yv,setRotationRadians:uv,setRotationQuat:hv,setScale:cv,setPositionRotationScale:Ay,setPositionRotationDegreesScale:Vy,setPositionRotationRadiansScale:Oy,setPositionRotationQuatScale:By,setPositionRotation:pv,setPositionRotationDegrees:dv,setPositionRotationRadians:_v,setPositionRotationQuat:gv,getAxes:fv,getForward:Pv,getBackward:Cv,getLeft:Tv,getRight:bv,getUp:Sv,getDown:vv,toWorld:xv,toLocal:Mv,hasUniformScale:Ev,toQuat:Dv,fromQuat:Iy};function W(i,e,t){let n=Ie.create();return i!==void 0&&ji(n,i,e,t),n}function ji(i,e,t,n){return t===void 0?Ie.set(i,e,e,e):Ie.set(i,e,t,n),i}function Rv(i,e=p.create()){return Ie.normalize(e,i),e}function Av(i,e){return Ie.copy(e,i),e}function Vv(i,e=p.create()){return p.copy(i,e),e}function Ov(i){return Ie.zero(i),i}function Hy(i,e){return p.angleDegrees(i,e)}function Ly(i,e){return H.toDegrees(p.angleRadians(i,e))}function ky(i,e){let t=i[0],n=i[1],o=i[2],s=e[0],a=e[1],l=e[2],h=t*t+n*n+o*o,_=s*s+a*a+l*l,y=h*_,c=0;if(y>H.EPSILON_SQUARED){let d=Math.sqrt(y),g=p.dot(i,e)/d;c=Math.acos(H.clamp(g,-1,1))}return c}function Bv(i,e,t=0){let n=i.length==e.length;return n&&(n&&=Math.abs(i[0]-e[0])<=t,n&&=Math.abs(i[1]-e[1])<=t,n&&=Math.abs(i[2]-e[2])<=t),n}function Iv(i){return Ie.length(i)}function Hv(i){return Ie.squaredLength(i)}function Fy(i,e){return Ie.dist(i,e)}function wy(i,e){return Ie.squaredDistance(i,e)}function jy(i,e,t=p.create()){return Ie.add(t,i,e),t}function zy(i,e,t=p.create()){return Ie.sub(t,i,e),t}function Lv(i,e,t=p.create()){return Ie.mul(t,i,e),t}function Ny(i,e,t=p.create()){return Ie.div(t,i,e),t}function kv(i,e,t=p.create()){return Ie.scale(t,i,e),t}function Gy(i,e){return Ie.dot(i,e)}function Uy(i,e=p.create()){return Ie.negate(e,i),e}function Wy(i,e,t=p.create()){return Ie.cross(t,i,e),t}function Qy(i,e,t=p.create()){return Ie.transformQuat(t,i,e),t}function qy(i,e,t=p.create()){return Ie.transformMat3(t,i,e),t}function Xy(i,e,t=p.create()){return Ie.transformMat4(t,i,e),t}function Ky(i,e){let t=p.length(i);return p.isConcordant(i,e)||(t*=-1),t}function Jy(i,e,t){return p.angleSignedDegrees(i,e,t)}function Zy(i,e,t){return H.toDegrees(p.angleSignedRadians(i,e,t))}var Yy=function(){let i=W();return function(t,n,o){p.cross(t,n,i);let s=p.angleRadians(t,n);return p.isConcordant(i,o)||(s=-s),s}}();function Fv(i,e=p.create()){return p.set(e,H.toRadians(i[0]),H.toRadians(i[1]),H.toRadians(i[2])),e}function wv(i,e=p.create()){return p.set(e,H.toDegrees(i[0]),H.toDegrees(i[1]),H.toDegrees(i[2])),e}function jv(i,e){return p.degreesToQuat(i,e)}function $y(i,e=f.create()){return f.fromRadians(i,e),e}function eu(i,e=f.create()){return f.fromDegrees(i,e),e}function zv(i,e=H.EPSILON){return Math.abs(p.lengthSquared(i)-1)<e}function Nv(i,e=0){return p.lengthSquared(i)<=e*e}function tu(i,e,t=p.create()){let n=p.dot(i,e);return p.copy(e,t),p.scale(t,n,t),t}function iu(i,e){return p.dot(i,e)}var nu=function(){let i=W();return function(t,n,o=p.create()){return p.componentAlongAxis(t,n,i),p.sub(t,i,o),o}}(),ou=function(){let i=W();return function(t,n,o,s=p.create()){return p.removeComponentAlongAxis(n,o,s),p.componentAlongAxis(t,o,i),p.add(s,i,s),s}}();function su(i,e){return p.dot(i,e)>=0}function au(i,e,t){return p.valueAlongAxis(i,t)>p.valueAlongAxis(e,t)}function ru(i,e,t){return p.signTo(i,e,t)>=0}var lu=function(){let i=W(),e=W();return function(n,o,s,a=1){p.removeComponentAlongAxis(n,s,i),p.removeComponentAlongAxis(o,s,e);let l=p.angleSigned(n,o,s);return l>0?1:l==0?a:-1}}();function mu(i,e,t=p.create()){return p.componentAlongAxis(i,e,t),t}var yu=function(){let i=W(),e=W(),t=W();return function(o,s,a,l=p.create()){if(p.isOnAxis(o,s)||p.isOnAxis(a,s))p.copy(o,l);else if(p.cross(a,s,i),p.normalize(i,i),p.removeComponentAlongAxis(o,i,l),!p.isOnAxis(l,s)){p.projectOnAxis(l,s,e),p.sub(e,l,e),p.isConcordant(e,a)?p.copy(a,t):p.negate(a,t);let h=p.angleRadians(t,e),_=p.length(e)/Math.cos(h);p.normalize(t,t),p.scale(t,_,t),p.add(l,t,l),p.projectOnAxis(l,s,l)}return l}}();function uu(i,e,t=p.create()){return p.removeComponentAlongAxis(i,e,t),t}var hu=function(){let i=W(),e=W();return function(n,o,s,a=p.create()){if(p.isOnPlane(n,o)||p.isOnPlane(s,o))p.copy(n,a);else{p.copy(n,a),p.projectOnPlane(a,o,i),p.sub(i,a,i),p.isConcordant(i,s)?p.copy(s,e):p.negate(s,e);let l=p.angleRadians(e,i),h=p.length(i)/Math.cos(l);p.normalize(e,e),p.scale(e,h,e),p.add(a,e,a),p.projectOnPlane(a,o,a)}return a}}();function cu(i,e){let t=p.angle(i,e);return Math.abs(t)<H.EPSILON_DEGREES||Math.abs(t-180)<H.EPSILON_DEGREES}function pu(i,e){let t=p.angle(i,e);return Math.abs(t-90)<H.EPSILON_DEGREES}function Gv(i,e,t){return p.rotateDegrees(i,e,t)}var Uv=function(){let i=W();return function(t,n,o){return p.rotateAroundDegrees(t,n,i,o)}}(),Wv=function(){let i=W();return function(t,n,o){return p.rotateAroundRadians(t,n,i,o)}}(),Qv=function(){let i=W();return function(t,n,o){return p.rotateAroundQuat(t,n,i,o)}}();function qv(i,e,t,n){return p.rotateAxisDegrees(i,e,t,n)}var Xv=function(){let i=W();return function(t,n,o,s){return p.rotateAroundAxisDegrees(t,n,o,i,s)}}(),Kv=function(){let i=W();return function(t,n,o,s){return p.rotateAroundAxisRadians(t,n,o,i,s)}}();function Jv(i,e,t,n){return p.rotateAroundDegrees(i,e,t,n)}var Zv=function(){let i=X();return function(t,n,o,s=p.create()){return p.degreesToQuat(n,i),p.rotateAroundQuat(t,i,o,s)}}(),Yv=function(){let i=X();return function(t,n,o,s=p.create()){return p.radiansToQuat(n,i),p.rotateAroundQuat(t,i,o,s)}}();function $v(i,e,t,n=p.create()){return p.sub(i,t,n),p.transformQuat(n,e,n),p.add(n,t,n),n}function ex(i,e,t,n,o){return p.rotateAroundAxisDegrees(i,e,t,n,o)}function tx(i,e,t,n,o){return p.rotateAroundAxisRadians(i,H.toRadians(e),t,n,o)}var ix=function(){let i=X();return function(t,n,o,s,a=p.create()){return f.fromAxisRadians(n,o,i),p.rotateAroundQuat(t,i,s,a)}}();function du(i,e,t){return p.convertPositionToWorldMatrix(i,e,t)}function _u(i,e,t){return p.convertPositionToLocalMatrix(i,e,t)}function gu(i,e,t=p.create()){return p.transformMat4(i,e,t),t}var fu=function(){let i=wi();return function(t,n,o=p.create()){return V.invert(n,i),p.transformMat4(t,i,o),o}}(),Pu=function(){let i=wi(),e=W(),t=X(),n=W();return ji(n,1,1,1),function(s,a,l=p.create()){return O.getPosition(a,e),O.getRotationQuat(a,t),V.setPositionRotationQuatScale(i,e,t,n),p.convertPositionToWorldMatrix(s,i,l)}}(),Cu=function(){let i=wi(),e=W(),t=X(),n=W();return ji(n,1,1,1),function(s,a,l=p.create()){return O.getPosition(a,e),O.getRotationQuat(a,t),V.setPositionRotationQuatScale(i,e,t,n),p.convertPositionToLocalMatrix(s,i,l)}}();function Tu(i,e,t){return p.convertDirectionToWorldMatrix(i,e,t)}function bu(i,e,t){return p.convertDirectionToLocalMatrix(i,e,t)}var Su=function(){let i=X();return function(t,n,o=p.create()){return V.getRotationQuat(n,i),p.transformQuat(t,i,o),o}}(),vu=function(){let i=X();return function(t,n,o=p.create()){return V.getRotationQuat(n,i),f.conjugate(i,i),p.transformQuat(t,i,o),o}}(),xu=function(){let i=X();return function(t,n,o=p.create()){return O.getRotationQuat(n,i),p.transformQuat(t,i,o),o}}(),Mu=function(){let i=X();return function(t,n,o=p.create()){return O.getRotationQuat(n,i),f.conjugate(i,i),p.transformQuat(t,i,o),o}}();function nx(i,e,t){return p.degreesAddRotation(i,e,t)}function ox(i,e,t){return p.degreesAddRotationDegrees(i,e,t)}function sx(i,e,t){return p.degreesAddRotationRadians(i,e,t)}function ax(i,e,t){return p.degreesAddRotationQuat(i,e,t)}function Eu(i,e,t){return p.degreesAddRotationDegrees(i,e,t)}var Du=function(){let i=X();return function(t,n,o=p.create()){return p.degreesToQuat(t,i),f.toDegrees(f.addRotationDegrees(i,n,i),o)}}(),Ru=function(){let i=X();return function(t,n,o=p.create()){return p.degreesToQuat(t,i),f.toDegrees(f.addRotationRadians(i,n,i),o)}}(),Au=function(){let i=X();return function(t,n,o=p.create()){return p.degreesToQuat(t,i),f.toDegrees(f.addRotationQuat(i,n,i),o)}}();function Vu(i,e,t){return p.radiansAddRotationDegrees(i,e,t)}var Ou=function(){let i=X();return function(t,n,o=p.create()){return p.radiansToQuat(t,i),f.toRadians(f.addRotationDegrees(i,n,i),o)}}(),Bu=function(){let i=X();return function(t,n,o=p.create()){return p.radiansToQuat(t,i),f.toRadians(f.addRotationRadians(i,n,i),o)}}(),Iu=function(){let i=X();return function(t,n,o=p.create()){return p.radiansToQuat(t,i),f.toRadians(f.addRotationQuat(i,n,i),o)}}();function rx(i,e=Y.create()){return p.degreesToMatrix(i,e)}var Hu=function(){let i=X();return function(t,n=Y.create()){return p.degreesToQuat(t,i),f.toMatrix(i,n)}}(),Lu=function(){let i=X();return function(t,n=Y.create()){return p.radiansToQuat(t,i),f.toMatrix(i,n)}}();function lx(i,e,t){return p.rotationToDegrees(i,e,t)}var mx=function(){let i=X();return function(t,n,o=p.create()){return p.rotationToQuat(t,n,i),f.toDegrees(i,o),o}}(),yx=function(){let i=X();return function(t,n,o=p.create()){return p.rotationToQuat(t,n,i),f.toRadians(i,o),o}}(),ux=function(){let i=W();return function(t,n,o=f.create()){p.cross(t,n,i),p.normalize(i,i);let s=p.angleSigned(t,n,i);return f.fromAxisRadians(s,i,o),o}}();function ku(i,e,t,n){return p.rotationToPivotedDegrees(i,e,t,n)}var Fu=function(){let i=X();return function(t,n,o,s=p.create()){return p.rotationToPivotedQuat(t,n,o,i),f.toDegrees(i,s),s}}(),wu=function(){let i=X();return function(t,n,o,s=p.create()){return p.rotationToPivotedQuat(t,n,o,i),f.toRadians(i,s),s}}(),ju=function(){let i=W(),e=W(),t=W();return function(o,s,a,l=f.create()){p.removeComponentAlongAxis(o,a,i),p.removeComponentAlongAxis(s,a,e),p.cross(i,e,t),p.normalize(t,t);let h=p.angleSigned(i,e,t);return f.fromAxisRadians(h,t,l),l}}();function hx(i,e,t,n=p.create()){return t<=0?(p.copy(i,n),n):t>=1?(p.copy(e,n),n):(Ie.lerp(n,i,e,t),n)}function cx(i,e,t,n=ue.linear,o=p.create()){let s=n(t);return p.lerp(i,e,s,o)}var zu=function(){let i=W();return function(t,n=p.create()){if(p.isZero(t))return p.zero(n);p.copy(t,i);let o=!1;for(let s=0;s<3;s++)t[s]==0&&o++;return o==2?i[0]==0?i[0]=1:i[1]==0?i[1]=1:i[2]==0&&(i[2]=1):i[0]!=0?i[0]=-i[0]:i[1]!=0?i[1]=-i[1]:i[2]!=0&&(i[2]=-i[2]),p.cross(i,t,n),n}}(),p={create:W,set:ji,normalize:Rv,copy:Av,clone:Vv,zero:Ov,angle:Hy,angleDegrees:Ly,angleRadians:ky,equals:Bv,length:Iv,lengthSquared:Hv,distance:Fy,distanceSquared:wy,add:jy,sub:zy,mul:Lv,div:Ny,scale:kv,dot:Gy,negate:Uy,cross:Wy,transformQuat:Qy,transformMat3:qy,transformMat4:Xy,lengthSigned:Ky,angleSigned:Jy,angleSignedDegrees:Zy,angleSignedRadians:Yy,toRadians:Fv,toDegrees:wv,toQuat:jv,radiansToQuat:$y,degreesToQuat:eu,isNormalized:zv,isZero:Nv,componentAlongAxis:tu,valueAlongAxis:iu,removeComponentAlongAxis:nu,copyComponentAlongAxis:ou,isConcordant:su,isFartherAlongAxis:au,isToTheRight:ru,signTo:lu,projectOnAxis:mu,projectOnAxisAlongAxis:yu,projectOnPlane:uu,projectOnPlaneAlongAxis:hu,isOnAxis:cu,isOnPlane:pu,rotate:Gv,rotateDegrees:Uv,rotateRadians:Wv,rotateQuat:Qv,rotateAxis:qv,rotateAxisDegrees:Xv,rotateAxisRadians:Kv,rotateAround:Jv,rotateAroundDegrees:Zv,rotateAroundRadians:Yv,rotateAroundQuat:$v,rotateAroundAxis:ex,rotateAroundAxisDegrees:tx,rotateAroundAxisRadians:ix,convertPositionToWorld:du,convertPositionToLocal:_u,convertPositionToWorldMatrix:gu,convertPositionToLocalMatrix:fu,convertPositionToWorldQuat:Pu,convertPositionToLocalQuat:Cu,convertDirectionToWorld:Tu,convertDirectionToLocal:bu,convertDirectionToWorldMatrix:Su,convertDirectionToLocalMatrix:vu,convertDirectionToWorldQuat:xu,convertDirectionToLocalQuat:Mu,addRotation:nx,addRotationDegrees:ox,addRotationRadians:sx,addRotationQuat:ax,degreesAddRotation:Eu,degreesAddRotationDegrees:Du,degreesAddRotationRadians:Ru,degreesAddRotationQuat:Au,radiansAddRotation:Vu,radiansAddRotationDegrees:Ou,radiansAddRotationRadians:Bu,radiansAddRotationQuat:Iu,toMatrix:rx,degreesToMatrix:Hu,radiansToMatrix:Lu,rotationTo:lx,rotationToDegrees:mx,rotationToRadians:yx,rotationToQuat:ux,rotationToPivoted:ku,rotationToPivotedDegrees:Fu,rotationToPivotedRadians:wu,rotationToPivotedQuat:ju,lerp:hx,interpolate:cx,perpendicularRandom:zu};function X(i,e,t,n){let o=Ye.create();return i!==void 0&&f.set(o,i,e,t,n),o}function dx(i,e,t,n,o){return t===void 0?Ye.set(i,e,e,e,e):Ye.set(i,e,t,n,o),i}function _x(i,e=f.create()){return Ye.normalize(e,i),e}function gx(i,e){return Ye.copy(e,i),e}function fx(i,e=f.create()){return f.copy(i,e),e}function Px(i){return Ye.identity(i),i}function Cx(i){return Ye.length(i)}function Tx(i){return Ye.squaredLength(i)}function bx(i,e=f.create()){return Ye.invert(e,i),e}function Sx(i,e=f.create()){return Ye.conjugate(e,i),e}function vx(i,e,t=f.create()){return Ye.mul(t,i,e),t}var Nu=function(){let i=W(0,0,0);return function(t,n=p.create()){return Ye.getAxisAngle(n,t)<=H.EPSILON&&p.copy(i,n),n}}();function Gu(i){return f.getAngleDegrees(i)}function Uu(i){let e=f.getAngleRadians(i);return H.toDegrees(e)}var Wu=function(){let i=W();return function(t){return Ye.getAxisAngle(i,t)}}();function Qu(i,e=p.create()){return f.getAxisScaledDegrees(i,e)}function qu(i,e=p.create()){f.getAxis(i,e);let t=f.getAngleDegrees(i);return p.scale(e,t,e),e}var Xu=function(){let i=W(0,0,0);return function(t,n=p.create()){f.getAxis(t,n);let o=f.getAngleRadians(t);return o<=H.EPSILON?p.copy(i,n):p.scale(n,o,n),n}}();function xx(i,e=[p.create(),p.create(),p.create()]){return f.getLeft(i,e[0]),f.getUp(i,e[1]),f.getForward(i,e[2]),e}var Mx=function(){let i=Rt();return function(t,n=p.create()){return f.toMatrix(t,i),p.set(n,i[6],i[7],i[8]),p.normalize(n,n),n}}();function Ex(i,e){return f.getForward(i,e),p.negate(e,e),e}var Dx=function(){let i=Rt();return function(t,n=p.create()){return f.toMatrix(t,i),p.set(n,i[0],i[1],i[2]),p.normalize(n,n),n}}();function Rx(i,e){return f.getLeft(i,e),p.negate(e,e),e}var Ax=function(){let i=Rt();return function(t,n=p.create()){return f.toMatrix(t,i),p.set(n,i[3],i[4],i[5]),p.normalize(n,n),n}}();function Vx(i,e){return f.getUp(i,e),p.negate(e,e),e}function Ox(i,e,t,n){return n!=null?f.setForward(i,n,t,e):t!=null?f.setUp(i,t,n,e):f.setLeft(i,e,t,n)}function Bx(i,e,t=null,n=null){return Lo(i,[n,t,e],[2,1,0])}var Ix=function(){let i=W();return function(t,n,o=null,s=null){return p.negate(n,i),Lo(t,[s,o,i],[2,1,0])}}();function Hx(i,e,t=null,n=null){return Lo(i,[n,e,t],[1,2,0])}var Lx=function(){let i=W();return function(t,n,o=null,s=null){return p.negate(n,i),Lo(t,[s,i,o],[1,2,0])}}();function kx(i,e,t=null,n=null){return Lo(i,[e,t,n],[0,1,2])}var Fx=function(){let i=W();return function(t,n,o=null,s=null){return p.negate(n,i),Lo(t,[i,o,s],[0,1,2])}}();function wx(i,e,t=f.create()){return f.mul(e,i,t),t}var jx=function(){let i=X();return function(t,n,o=f.create()){return f.conjugate(n,i),f.mul(i,t,o),o}}();function Ku(i,e,t=f.create()){return f.fromAxisDegrees(i,e,t)}function Ju(i,e,t=f.create()){return f.fromAxisRadians(H.toRadians(i),e,t),t}function Zu(i,e,t=f.create()){return Ye.setAxisAngle(t,e,i),t}var zx=function(){let i=Rt();return function(t,n,o,s=f.create()){return Y.fromAxes(t,n,o,i),Y.toQuat(i,s)}}(),Yu=function(){let i=W();return function(t,n=f.create()){return p.toDegrees(t,i),f.fromDegrees(i,n)}}();function $u(i,e=f.create()){return Ye.fromEuler(e,i[0],i[1],i[2]),e}var Nx=function(){let i=Rt();return function(t,n=p.create()){return f.toMatrix(t,i),n[1]=Math.asin(-H.clamp(i[2],-1,1)),Math.abs(i[2])<1-H.EPSILON?(n[0]=Math.atan2(i[5],i[8]),n[2]=Math.atan2(i[1],i[0])):(n[0]=0,n[2]=Math.atan2(-i[3],i[4])),n}}();function Gx(i,e=p.create()){return f.toRadians(i,e),p.toDegrees(e,e),e}function Ux(i,e=H.EPSILON){return Math.abs(f.lengthSquared(i)-1)<e}function Wx(i,e,t){return f.addRotationDegrees(i,e,t)}var Qx=function(){let i=X();return function(t,n,o){return p.degreesToQuat(n,i),f.addRotationQuat(t,i,o)}}(),qx=function(){let i=X();return function(t,n,o){return p.radiansToQuat(n,i),f.addRotationQuat(t,i,o)}}();function Xx(i,e,t=f.create()){return f.mul(e,i,t),t}function eh(i,e,t){return f.subRotationDegrees(i,e,t)}var th=function(){let i=X();return function(t,n,o){return p.degreesToQuat(n,i),f.subRotationQuat(t,i,o)}}(),ih=function(){let i=X();return function(t,n,o){return p.radiansToQuat(n,i),f.subRotationQuat(t,i,o)}}(),nh=function(){let i=X();return function(t,n,o=f.create()){return f.invert(n,i),f.mul(t,i,o),f.isNormalized(t)&&f.isNormalized(n)&&f.normalize(o,o),o}}();function Kx(i,e,t){return f.rotationToDegrees(i,e,t)}var Jx=function(){let i=X();return function(t,n,o){return p.degreesToQuat(n,i),f.rotationToQuat(t,i,o)}}(),Zx=function(){let i=X();return function(t,n,o){return p.radiansToQuat(n,i),f.rotationToQuat(t,i,o)}}();function Yx(i,e,t){return f.subRotationQuat(e,i,t)}var oh=function(){let i=W(),e=W(),t=X();return function(o,s,a=f.create()){i[0]=o[0],i[1]=o[1],i[2]=o[2];let l=p.dot(s,i);return p.scale(s,l,e),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=o[3],f.normalize(t,t),l<0&&(t[0]=-t[0],t[1]=-t[1],t[2]=-t[2],t[3]=-t[3]),f.copy(t,a)}}(),sh=function(){let i=X();return function(t,n,o=f.create()){return f.getTwist(t,n,i),f.getSwingFromTwist(t,i,o),o}}();function ah(i,e,t=f.create()){return f.subRotationQuat(i,e,t)}var rh=function(){let i=X();return function(t,n,o=f.create()){return f.invert(n,i),f.addRotationQuat(t,i,o),o}}();function lh(i,e,t=f.create()){return f.addRotationQuat(i,e,t)}function $x(i,e=Y.create()){return px.fromQuat(e,i),e}function eM(i,e,t){return f.rotateDegrees(i,e,t)}function tM(i,e,t){return f.addRotationDegrees(i,e,t)}function iM(i,e,t){return f.addRotationRadians(i,e,t)}function nM(i,e,t){return f.addRotationQuat(i,e,t)}function oM(i,e,t,n){return f.rotateAxisDegrees(i,e,t,n)}var sM=function(){let i=X();return function(t,n,o,s){return f.fromAxisDegrees(n,o,i),f.rotateQuat(t,i,s)}}(),aM=function(){let i=X();return function(t,n,o,s){return f.fromAxisRadians(n,o,i),f.rotateQuat(t,i,s)}}();function rM(i,e,t,n=f.create()){return t<=0?(f.copy(i,n),n):t>=1?(f.copy(e,n),n):(Ye.lerp(n,i,e,t),n)}function lM(i,e,t,n=ue.linear,o=f.create()){let s=n(t);return f.lerp(i,e,s,o)}function mh(i,e,t,n=f.create()){return t<=0?(f.copy(i,n),n):t>=1?(f.copy(e,n),n):(Ye.slerp(n,i,e,t),n)}function yh(i,e,t,n=ue.linear,o=f.create()){let s=n(t);return f.slerp(i,e,s,o)}var f={create:X,set:dx,normalize:_x,copy:gx,clone:fx,identity:Px,length:Cx,lengthSquared:Tx,invert:bx,conjugate:Sx,mul:vx,getAxis:Nu,getAngle:Gu,getAngleDegrees:Uu,getAngleRadians:Wu,getAxisScaled:Qu,getAxisScaledDegrees:qu,getAxisScaledRadians:Xu,getAxes:xx,getForward:Mx,getBackward:Ex,getLeft:Dx,getRight:Rx,getUp:Ax,getDown:Vx,setAxes:Ox,setForward:Bx,setBackward:Ix,setUp:Hx,setDown:Lx,setLeft:kx,setRight:Fx,toWorld:wx,toLocal:jx,fromAxis:Ku,fromAxisDegrees:Ju,fromAxisRadians:Zu,fromAxes:zx,fromRadians:Yu,fromDegrees:$u,toRadians:Nx,toDegrees:Gx,isNormalized:Ux,addRotation:Wx,addRotationDegrees:Qx,addRotationRadians:qx,addRotationQuat:Xx,subRotation:eh,subRotationDegrees:th,subRotationRadians:ih,subRotationQuat:nh,rotationTo:Kx,rotationToDegrees:Jx,rotationToRadians:Zx,rotationToQuat:Yx,getTwist:oh,getSwing:sh,getSwingFromTwist:ah,getTwistFromSwing:rh,fromTwistSwing:lh,toMatrix:$x,rotate:eM,rotateDegrees:tM,rotateRadians:iM,rotateQuat:nM,rotateAxis:oM,rotateAxisDegrees:sM,rotateAxisRadians:aM,lerp:rM,interpolate:lM,slerp:mh,sinterpolate:yh},Lo=function(){let i=[W(),W(),W()],e=[[1,-1,1],[1,1,-1],[-1,1,-1]],t=W(),n=W(),o=W(),s=W(),a=W(),l=Rt(),h=X();return function(y,c,d){let g=c[d[0]],P=c[d[1]],T=c[d[2]];if(g==null||p.isZero(g,H.EPSILON))return;let C=!1;P!=null&&p.angleRadians(g,P)>H.EPSILON&&(C=!0);let x=!1;if(T!=null&&p.angleRadians(g,T)>H.EPSILON&&(x=!0),C||x){let D=null,E=null,S=null;C?(D=P,E=1,S=2):(D=T,E=2,S=1);let b=e[d[0]];p.cross(g,D,i[S]),p.scale(i[S],b[d[S]],i[S]),p.cross(g,i[S],i[E]),p.scale(i[E],b[d[E]],i[E]),p.cross(i[1],i[2],i[0]),p.scale(i[0],b[d[0]],i[0]),p.normalize(i[q.findIndexEqual(d,0)],t),p.normalize(i[q.findIndexEqual(d,1)],n),p.normalize(i[q.findIndexEqual(d,2)],o),Y.set(l,t[0],t[1],t[2],n[0],n[1],n[2],o[0],o[1],o[2]),Y.toQuat(l,h),f.normalize(h,h),f.copy(h,y)}else{d[0]==0?f.getLeft(y,s):d[0]==1?f.getUp(y,s):f.getForward(y,s);let D=p.angleRadians(g,s);D>H.EPSILON&&(p.cross(s,g,a),p.normalize(a,a),p.isZero(a)&&p.perpendicularRandom(s,a),f.fromAxisRadians(D,a,h),f.rotateQuat(y,h,y))}return y}}();function Rt(i,e,t,n,o,s,a,l,h){let _=hl.create();return i!==void 0&&uh(_,i,e,t,n,o,s,a,l,h),_}function uh(i,e,t,n,o,s,a,l,h,_){return t===void 0?hl.set(i,e,e,e,e,e,e,e,e,e):hl.set(i,e,t,n,o,s,a,l,h,_),i}var yM=function(){let i=X();return function(t,n=p.create()){return Y.toQuat(t,i),f.toDegrees(i,n),n}}(),uM=function(){let i=X();return function(t,n=p.create()){return Y.toQuat(t,i),f.toRadians(i,n),n}}();function hM(i,e=f.create()){return mM.fromMat3(e,i),e}function cM(i,e,t,n=Y.create()){return Y.set(n,i[0],i[1],i[2],e[0],e[1],e[2],t[0],t[1],t[2]),n}var Y={create:Rt,set:uh,toDegrees:yM,toRadians:uM,toQuat:hM,fromAxes:cM};var Zt=class{constructor(){this.myIgnoreNonCloneable=!1,this.myIgnoreComponents=!1,this.myIgnoreChildren=!1,this.myComponentsToIgnore=[],this.myComponentsToInclude=[],this.myIgnoreComponentCallback=null,this.myChildrenToIgnore=[],this.myChildrenToInclude=[],this.myIgnoreChildCallback=null,this.myUseDefaultComponentClone=!1,this.myUseDefaultComponentCloneAsFallback=!1,this.myDefaultComponentCloneAutoStartIfNotActive=!0,this.myComponentDeepCloneParams=new Yt,this.myComponentCustomCloneParams=new Ts}};function pM(i,e){return u.getPositionWorld(i,e)}function hh(i,e=p.create()){return i.getPositionWorld(e),e}function ch(i,e=p.create()){return i.getPositionLocal(e),e}function dM(i,e){return u.getRotationWorld(i,e)}function _M(i,e){return u.getRotationWorldDegrees(i,e)}function gM(i,e){return u.getRotationWorldRadians(i,e)}function ph(i,e){return u.getRotationWorldMatrix(i,e)}function fM(i,e){return u.getRotationWorldQuat(i,e)}function dh(i,e){return u.getRotationWorldDegrees(i,e)}function _h(i,e){return e=u.getRotationWorldRadians(i,e),e=p.toDegrees(e,e),e}var gh=function(){let i=f.create();return function(t,n=p.create()){return u.getRotationWorldQuat(t,i),f.toRadians(i,n),n}}(),fh=function(){let i=f.create();return function(t,n=Y.create()){return u.getRotationWorldQuat(t,i),f.toMatrix(i,n),n}}();function Ph(i,e=f.create()){return i.getRotationWorld(e),e}function Ch(i,e){return u.getRotationLocalDegrees(i,e)}function Th(i,e){return e=u.getRotationLocalRadians(i,e),e=p.toDegrees(e,e),e}var bh=function(){let i=f.create();return function(t,n=p.create()){return u.getRotationLocalQuat(t,i),f.toRadians(i,n),n}}(),Sh=function(){let i=f.create();return function(t,n=Y.create()){return u.getRotationLocalQuat(t,i),f.toMatrix(i,n),n}}();function vh(i,e=f.create()){return i.getRotationLocal(e),e}function PM(i,e){return u.getScaleWorld(i,e)}function xh(i,e=p.create()){return i.getScalingWorld(e),e}function Mh(i,e=p.create()){return i.getScalingLocal(e),e}function Eh(i,e){return u.getTransformWorld(i,e)}function Dh(i,e){return u.getTransformWorldMatrix(i,e)}function Rh(i,e){return u.getTransformWorldQuat(i,e)}function Ah(i,e){return u.getTransformWorldMatrix(i,e)}var Vh=function(){let i=O.create(),e=p.create();return function(n,o=V.create()){return u.getTransformWorldQuat(n,i),u.getScaleWorld(n,e),V.fromQuat(i,o),V.scale(o,e,o),o}}();function Oh(i,e=O.create()){return i.getTransformWorld(e),e}function Bh(i,e){return u.getTransformLocalMatrix(i,e)}var Ih=function(){let i=O.create(),e=p.create();return function(n,o=V.create()){return u.getTransformLocalQuat(n,i),u.getScaleLocal(n,e),V.fromQuat(i,o),V.scale(o,e,o),o}}();function Hh(i,e=O.create()){return i.getTransformLocal(e),e}function CM(i,e){return u.getAxesWorld(i,e)}function Lh(i,e=[p.create(),p.create(),p.create()]){return u.getLeftWorld(i,e[0]),u.getUpWorld(i,e[1]),u.getForwardWorld(i,e[2]),e}function kh(i,e=[p.create(),p.create(),p.create()]){return u.getLeftLocal(i,e[0]),u.getUpLocal(i,e[1]),u.getForwardLocal(i,e[2]),e}function TM(i,e){return u.getForwardWorld(i,e)}var Fh=function(){let i=Y.create();return function(t,n=p.create()){return u.getRotationWorldMatrix(t,i),n[0]=i[6],n[1]=i[7],n[2]=i[8],n}}(),wh=function(){let i=Y.create();return function(t,n=p.create()){return u.getRotationLocalMatrix(t,i),n[0]=i[6],n[1]=i[7],n[2]=i[8],n}}();function bM(i,e){return u.getBackwardWorld(i,e)}var jh=function(){let i=Y.create();return function(t,n=p.create()){return u.getRotationWorldMatrix(t,i),n[0]=-i[6],n[1]=-i[7],n[2]=-i[8],n}}(),zh=function(){let i=Y.create();return function(t,n=p.create()){return u.getRotationLocalMatrix(t,i),n[0]=-i[6],n[1]=-i[7],n[2]=-i[8],n}}();function SM(i,e){return u.getUpWorld(i,e)}var Nh=function(){let i=Y.create();return function(t,n=p.create()){return u.getRotationWorldMatrix(t,i),n[0]=i[3],n[1]=i[4],n[2]=i[5],n}}(),Gh=function(){let i=Y.create();return function(t,n=p.create()){return u.getRotationLocalMatrix(t,i),n[0]=i[3],n[1]=i[4],n[2]=i[5],n}}();function vM(i,e){return u.getDownWorld(i,e)}var Uh=function(){let i=Y.create();return function(t,n=p.create()){return u.getRotationWorldMatrix(t,i),n[0]=-i[3],n[1]=-i[4],n[2]=-i[5],n}}(),Wh=function(){let i=Y.create();return function(t,n=p.create()){return u.getRotationLocalMatrix(t,i),n[0]=-i[3],n[1]=-i[4],n[2]=-i[5],n}}();function xM(i,e){return u.getLeftWorld(i,e)}var Qh=function(){let i=Y.create();return function(t,n=p.create()){return u.getRotationWorldMatrix(t,i),n[0]=i[0],n[1]=i[1],n[2]=i[2],n}}(),qh=function(){let i=Y.create();return function(t,n=p.create()){return u.getRotationLocalMatrix(t,i),n[0]=i[0],n[1]=i[1],n[2]=i[2],n}}();function MM(i,e){return u.getRightWorld(i,e)}var Xh=function(){let i=Y.create();return function(t,n=p.create()){return u.getRotationWorldMatrix(t,i),n[0]=-i[0],n[1]=-i[1],n[2]=-i[2],n}}(),Kh=function(){let i=Y.create();return function(t,n=p.create()){return u.getRotationLocalMatrix(t,i),n[0]=-i[0],n[1]=-i[1],n[2]=-i[2],n}}();function EM(i,e){u.setPositionWorld(i,e)}function Jh(i,e){i.setTranslationWorld(e)}function Zh(i,e){i.setTranslationLocal(e)}function DM(i,e){u.setRotationWorld(i,e)}function RM(i,e){u.setRotationWorldDegrees(i,e)}function AM(i,e){u.setRotationWorldRadians(i,e)}function Yh(i,e){u.setRotationWorldMatrix(i,e)}function VM(i,e){u.setRotationWorldQuat(i,e)}function $h(i,e){u.setRotationWorldDegrees(i,e)}var ec=function(){let i=f.create();return function(t,n){p.degreesToQuat(n,i),u.setRotationWorldQuat(t,i)}}(),tc=function(){let i=p.create();return function(t,n){i=p.toDegrees(n,i),u.setRotationWorldDegrees(t,i)}}(),ic=function(){let i=f.create();return function(t,n){Y.toQuat(n,i),u.setRotationWorldQuat(t,i)}}();function nc(i,e){i.setRotationWorld(e)}function oc(i,e){u.setRotationLocalDegrees(i,e)}var sc=function(){let i=f.create();return function(t,n){p.degreesToQuat(n,i),u.setRotationLocalQuat(t,i)}}(),ac=function(){let i=p.create();return function(t,n){i=p.toDegrees(n,i),u.setRotationLocalDegrees(t,i)}}(),rc=function(){let i=f.create();return function(t,n){Y.toQuat(n,i),u.setRotationLocalQuat(t,i)}}();function lc(i,e){i.setRotationLocal(e)}function OM(i,e){u.setScaleWorld(i,e)}var mc=function(){let i=p.create();return function(t,n){isNaN(n)?t.setScalingWorld(n):(p.set(i,n),t.setScalingWorld(i))}}(),yc=function(){let i=p.create();return function(t,n){isNaN(n)?t.setScalingLocal(n):(p.set(i,n),t.setScalingLocal(i))}}();function BM(i,e,t,n){u.setAxesWorld(i,e,t,n)}function uc(i,e,t,n){n!=null?u.setForwardWorld(i,n,t,e):t!=null?u.setUpWorld(i,t,n,e):u.setLeftWorld(i,e,t,n)}function hc(i,e,t,n){n!=null?u.setForwardLocal(i,n,t,e):t!=null?u.setUpLocal(i,t,n,e):u.setLeftLocal(i,e,t,n)}function IM(i,e,t,n){u.setForwardWorld(i,e,t,n)}var cc=function(){let i=f.create();return function(t,n,o=null,s=null){u.getRotationWorldQuat(t,i),f.setForward(i,n,o,s),u.setRotationWorldQuat(t,i)}}(),pc=function(){let i=f.create();return function(t,n,o=null,s=null){u.getRotationLocalQuat(t,i),f.setForward(i,n,o,s),u.setRotationLocalQuat(t,i)}}();function HM(i,e,t,n){u.setBackwardWorld(i,e,t,n)}var dc=function(){let i=f.create();return function(t,n,o=null,s=null){u.getRotationWorldQuat(t,i),f.setBackward(i,n,o,s),u.setRotationWorldQuat(t,i)}}(),_c=function(){let i=f.create();return function(t,n,o=null,s=null){u.getRotationLocalQuat(t,i),f.setBackward(i,n,o,s),u.setRotationLocalQuat(t,i)}}();function LM(i,e,t,n){u.setUpWorld(i,e,t,n)}var gc=function(){let i=f.create();return function(t,n,o=null,s=null){u.getRotationWorldQuat(t,i),f.setUp(i,n,o,s),u.setRotationWorldQuat(t,i)}}(),fc=function(){let i=f.create();return function(t,n,o=null,s=null){u.getRotationLocalQuat(t,i),f.setUp(i,n,o,s),u.setRotationLocalQuat(t,i)}}();function kM(i,e,t,n){u.setDownWorld(i,e,t,n)}var Pc=function(){let i=f.create();return function(t,n,o=null,s=null){u.getRotationWorldQuat(t,i),f.setDown(i,n,o,s),u.setRotationWorldQuat(t,i)}}(),Cc=function(){let i=f.create();return function(t,n,o=null,s=null){u.getRotationLocalQuat(t,i),f.setDown(i,n,o,s),u.setRotationLocalQuat(t,i)}}();function FM(i,e,t,n){u.setLeftWorld(i,e,t,n)}var Tc=function(){let i=f.create();return function(t,n,o=null,s=null){u.getRotationWorldQuat(t,i),f.setLeft(i,n,o,s),u.setRotationWorldQuat(t,i)}}(),bc=function(){let i=f.create();return function(t,n,o=null,s=null){u.getRotationLocalQuat(t,i),f.setLeft(i,n,o,s),u.setRotationLocalQuat(t,i)}}();function wM(i,e,t,n){u.setRightWorld(i,e,t,n)}var Sc=function(){let i=f.create();return function(t,n,o=null,s=null){u.getRotationWorldQuat(t,i),f.setRight(i,n,o,s),u.setRotationWorldQuat(t,i)}}(),vc=function(){let i=f.create();return function(t,n,o=null,s=null){u.getRotationLocalQuat(t,i),f.setRight(i,n,o,s),u.setRotationLocalQuat(t,i)}}();function xc(i,e){u.setTransformWorld(i,e)}function Mc(i,e){u.setTransformWorldMatrix(i,e)}function Ec(i,e){u.setTransformWorldQuat(i,e)}function Dc(i,e){return u.setTransformWorldMatrix(i,e)}var Rc=function(){let i=p.create(),e=f.create(),t=p.create(),n=V.create(),o=p.create(),s=p.create(1);return function(l,h){V.getPosition(h,i),V.getScale(h,t),p.div(s,t,o),V.scale(h,o,n),V.getRotationQuat(n,e),f.normalize(e,e),u.setScaleWorld(l,t),u.setRotationWorldQuat(l,e),u.setPositionWorld(l,i)}}();function Ac(i,e){i.setTransformWorld(e)}function Vc(i,e){return u.setTransformLocalMatrix(i,e)}var Oc=function(){let i=p.create(),e=f.create(),t=p.create(),n=V.create(),o=p.create(),s=p.create(1);return function(l,h){V.getPosition(h,i),V.getScale(h,t),p.div(s,t,o),V.scale(h,o,n),V.getRotationQuat(n,e),f.normalize(e,e),u.setScaleLocal(l,t),u.setRotationLocalQuat(l,e),u.setPositionLocal(l,i)}}();function Bc(i,e){i.setTransformLocal(e)}function Ic(i){u.resetPositionWorld(i)}var Hc=function(){let i=p.create();return function(t){u.setPositionWorld(t,i)}}(),Lc=function(){let i=p.create();return function(t){u.setPositionLocal(t,i)}}();function kc(i){u.resetRotationWorld(i)}var Fc=function(){let i=f.create();return function(t){u.setRotationWorldQuat(t,i)}}(),wc=function(){let i=f.create();return function(t){u.setRotationLocalQuat(t,i)}}();function jc(i){u.resetScaleWorld(i)}var zc=function(){let i=p.create(1);return function(t){u.setScaleWorld(t,i)}}(),Nc=function(){let i=p.create(1);return function(t){u.setScaleLocal(t,i)}}();function Gc(i){u.resetTransformWorld(i)}function Uc(i){u.resetScaleWorld(i),u.resetRotationWorld(i),u.resetPositionWorld(i)}function Wc(i){u.resetScaleLocal(i),u.resetRotationLocal(i),u.resetPositionLocal(i)}function Qc(i,e){u.translateWorld(i,e)}function qc(i,e){i.translateWorld(e)}function Xc(i,e){i.translate(e)}function Kc(i,e){i.translateObject(e)}function Jc(i,e,t){u.translateAxisWorld(i,e,t)}var Zc=function(){let i=p.create();return function(t,n,o){p.scale(o,n,i),u.translateWorld(t,i)}}(),Yc=function(){let i=p.create();return function(t,n,o){p.scale(o,n,i),u.translateLocal(t,i)}}(),$c=function(){let i=p.create();return function(t,n,o){p.scale(o,n,i),u.translateObject(t,i)}}();function jM(i,e){u.rotateWorld(i,e)}function zM(i,e){u.rotateWorldDegrees(i,e)}function NM(i,e){u.rotateWorldRadians(i,e)}function ep(i,e){u.rotateWorldMatrix(i,e)}function GM(i,e){u.rotateWorldQuat(i,e)}function tp(i,e){u.rotateWorldDegrees(i,e)}var ip=function(){let i=f.create();return function(t,n){p.degreesToQuat(n,i),u.rotateWorldQuat(t,i)}}(),np=function(){let i=p.create();return function(t,n){i=p.toDegrees(n,i),u.rotateWorldDegrees(t,i)}}(),op=function(){let i=f.create();return function(t,n){Y.toQuat(n,i),f.normalize(i,i),u.rotateWorldQuat(t,i)}}(),sp=function(){let i=f.create();return function(t,n){u.getRotationWorldQuat(t,i),f.mul(n,i,i),f.normalize(i,i),u.setRotationWorldQuat(t,i)}}();function ap(i,e){u.rotateLocalDegrees(i,e)}var rp=function(){let i=f.create();return function(t,n){p.degreesToQuat(n,i),u.rotateLocalQuat(t,i)}}(),lp=function(){let i=p.create();return function(t,n){i=p.toDegrees(n,i),u.rotateLocalDegrees(t,i)}}(),mp=function(){let i=f.create();return function(t,n){Y.toQuat(n,i),f.normalize(i,i),u.rotateLocalQuat(t,i)}}(),yp=function(){let i=f.create();return function(t,n){u.getRotationLocalQuat(t,i),f.mul(n,i,i),f.normalize(i,i),u.setRotationLocalQuat(t,i)}}();function up(i,e){u.rotateObjectDegrees(i,e)}var hp=function(){let i=f.create();return function(t,n){p.degreesToQuat(n,i),u.rotateObjectQuat(t,i)}}(),cp=function(){let i=p.create();return function(t,n){i=p.toDegrees(n,i),u.rotateObjectDegrees(t,i)}}(),pp=function(){let i=f.create();return function(t,n){Y.toQuat(n,i),f.normalize(i,i),u.rotateObjectQuat(t,i)}}();function dp(i,e){i.rotateObject(e)}function UM(i,e,t){u.rotateAxisWorld(i,e,t)}function WM(i,e,t){u.rotateAxisWorldDegrees(i,e,t)}function QM(i,e,t){u.rotateAxisWorldRadians(i,e,t)}function _p(i,e,t){u.rotateAxisWorldDegrees(i,e,t)}function gp(i,e,t){u.rotateAxisWorldRadians(i,H.toRadians(e),t)}var fp=function(){let i=f.create();return function(t,n,o){f.fromAxisRadians(n,o,i),u.rotateWorldQuat(t,i)}}();function Pp(i,e,t){u.rotateAxisLocalDegrees(i,e,t)}function Cp(i,e,t){u.rotateAxisLocalRadians(i,H.toRadians(e),t)}var Tp=function(){let i=f.create();return function(t,n,o){f.fromAxisRadians(n,o,i),u.rotateLocalQuat(t,i)}}();function bp(i,e,t){u.rotateAxisObjectDegrees(i,e,t)}function Sp(i,e,t){u.rotateAxisObjectRadians(i,H.toRadians(e),t)}var vp=function(){let i=f.create();return function(t,n,o){f.fromAxisRadians(n,o,i),u.rotateObjectQuat(t,i)}}();function qM(i,e,t){u.rotateAroundWorld(i,e,t)}function XM(i,e,t){u.rotateAroundWorldDegrees(i,e,t)}function KM(i,e,t){u.rotateAroundWorldRadians(i,e,t)}function xp(i,e,t){u.rotateAroundWorldMatrix(i,e,t)}function JM(i,e,t){u.rotateAroundWorldQuat(i,e,t)}function Mp(i,e,t){u.rotateAroundWorldDegrees(i,e,t)}var Ep=function(){let i=f.create();return function(t,n,o){p.degreesToQuat(n,i),u.rotateAroundWorldQuat(t,i,o)}}(),Dp=function(){let i=p.create();return function(t,n,o){i=p.toDegrees(n,i),u.rotateAroundWorldDegrees(t,i,o)}}(),Rp=function(){let i=f.create();return function(t,n,o){Y.toQuat(n,i),f.normalize(i,i),u.rotateAroundWorldQuat(t,i,o)}}(),Ap=function(){let i=p.create();return function(t,n,o){f.getAxis(n,i);let s=f.getAngleRadians(n);u.rotateAroundAxisWorldRadians(t,s,i,o)}}();function Vp(i,e,t){u.rotateAroundLocalDegrees(i,e,t)}var Op=function(){let i=f.create();return function(t,n,o){p.degreesToQuat(n,i),u.rotateAroundLocalQuat(t,i,o)}}(),Bp=function(){let i=p.create();return function(t,n,o){i=p.toDegrees(n,i),u.rotateAroundLocalDegrees(t,i,o)}}(),Ip=function(){let i=f.create();return function(t,n,o){Y.toQuat(n,i),f.normalize(i,i),u.rotateAroundLocalQuat(t,i,o)}}(),Hp=function(){let i=p.create();return function(t,n,o){f.getAxis(n,i);let s=f.getAngleRadians(n);u.rotateAroundAxisLocalRadians(t,s,i,o)}}();function Lp(i,e,t){u.rotateAroundObjectDegrees(i,e,t)}var kp=function(){let i=f.create();return function(t,n,o){p.degreesToQuat(n,i),u.rotateAroundObjectQuat(t,i,o)}}(),Fp=function(){let i=p.create();return function(t,n,o){i=p.toDegrees(n,i),u.rotateAroundObjectDegrees(t,i,o)}}(),wp=function(){let i=f.create();return function(t,n,o){Y.toQuat(n,i),f.normalize(i,i),u.rotateAroundObjectQuat(t,i,o)}}(),jp=function(){let i=p.create();return function(t,n,o){f.getAxis(n,i);let s=f.getAngleRadians(n);u.rotateAroundAxisObjectRadians(t,s,i,o)}}();function ZM(i,e,t,n){u.rotateAroundAxisWorld(i,e,t,n)}function YM(i,e,t,n){u.rotateAroundAxisWorldDegrees(i,e,t,n)}function $M(i,e,t,n){u.rotateAroundAxisWorldRadians(i,e,t,n)}function zp(i,e,t,n){u.rotateAroundAxisWorldDegrees(i,e,t,n)}function Np(i,e,t,n){u.rotateAroundAxisWorldRadians(i,H.toRadians(e),t,n)}var Gp=function(){let i=O.create(),e=O.create(),t=O.create(),n=f.create();return function(s,a,l,h){O.setPositionRotationQuat(i,h,n),u.getTransformWorldQuat(s,t),O.conjugate(i,e),O.mul(e,t,t),O.rotateAxisRadians(i,a,l,i),O.mul(i,t,t),u.setTransformWorldQuat(s,t)}}();function Up(i,e,t,n){u.rotateAroundAxisLocalDegrees(i,e,t,n)}function Wp(i,e,t,n){u.rotateAroundAxisLocalRadians(i,H.toRadians(e),t,n)}var Qp=function(){let i=p.create(),e=p.create();return function(n,o,s,a){u.convertPositionLocalToWorld(n,a,i),u.convertDirectionLocalToWorld(n,s,e),u.rotateAroundAxisWorldRadians(n,o,e,i)}}();function qp(i,e,t,n){u.rotateAroundAxisObjectDegrees(i,e,t,n)}function Xp(i,e,t,n){u.rotateAroundAxisObjectRadians(i,H.toRadians(e),t,n)}var Kp=function(){let i=p.create(),e=p.create();return function(n,o,s,a){u.convertPositionObjectToWorld(n,a,i),u.convertDirectionObjectToWorld(n,s,e),u.rotateAroundAxisWorldRadians(n,o,e,i)}}(),Jp=function(){let i=p.create();return function(t,n){isNaN(n)?t.scale(n):(p.set(i,n),t.scale(i))}}();function Zp(i,e,t){u.lookAtWorld(i,e,t)}var Yp=function(){let i=p.create();return function(t,n,o){u.getPositionWorld(t,i),p.sub(n,i,i),u.lookToWorld(t,i,o)}}(),$p=function(){let i=p.create();return function(t,n,o){u.getPositionLocal(t,i),p.sub(n,i,i),u.lookToLocal(t,i,o)}}();function ed(i,e,t){u.lookToWorld(i,e,t)}var td=function(){let i=p.create();return function(t,n,o=u.getUpWorld(t,i)){u.setForwardWorld(t,n,o)}}(),id=function(){let i=p.create();return function(t,n,o=u.getUpLocal(t,i)){u.setForwardLocal(t,n,o)}}(),nd=function(){let i=p.create(),e=f.create(),t=p.create();return function(o,s,a=!0){a?(u.getPositionWorld(o,i),u.getRotationWorldQuat(o,e),u.getScaleWorld(o,t),o.parent=s,u.setScaleWorld(o,t),u.setRotationWorldQuat(o,e),u.setPositionWorld(o,i)):o.parent=s}}();function od(i){return i.parent}var sd=function(){let i=V.create();return function(t,n,o=p.create()){return u.getTransformWorldMatrix(t,i),p.transformMat4(n,i,o),o}}(),ad=function(){let i=f.create();return function(t,n,o=p.create()){return u.getRotationWorldQuat(t,i),p.transformQuat(n,i,o),o}}(),rd=function(){let i=V.create();return function(t,n,o=p.create()){return u.getTransformWorldMatrix(t,i),V.invert(i,i),p.transformMat4(n,i,o),o}}(),ld=function(){let i=f.create();return function(t,n,o=p.create()){return u.getRotationWorldQuat(t,i),f.conjugate(i,i),p.transformQuat(n,i,o),o}}();function md(i,e,t=p.create()){return u.getParent(i)?u.convertPositionObjectToWorld(u.getParent(i),e,t):p.copy(e,t),t}function yd(i,e,t=p.create()){return u.getParent(i)?u.convertDirectionObjectToWorld(u.getParent(i),e,t):p.copy(e,t),t}function ud(i,e,t=p.create()){return u.getParent(i)?u.convertPositionWorldToObject(u.getParent(i),e,t):p.copy(e,t),t}function hd(i,e,t=p.create()){return u.getParent(i)?u.convertDirectionWorldToObject(u.getParent(i),e,t):p.copy(e,t),t}function cd(i,e,t=p.create()){return u.convertPositionObjectToWorld(i,e,t),u.convertPositionWorldToLocal(i,t,t),t}function pd(i,e,t=p.create()){return u.convertDirectionObjectToWorld(i,e,t),u.convertDirectionWorldToLocal(i,t,t),t}function dd(i,e,t=p.create()){return u.convertPositionLocalToWorld(i,e,t),u.convertPositionWorldToObject(i,t,t),t}function _d(i,e,t=p.create()){return u.convertDirectionLocalToWorld(i,e,t),u.convertDirectionWorldToObject(i,t,t),t}function gd(i,e,t){return u.convertTransformObjectToWorldMatrix(i,e,t)}var fd=function(){let i=V.create(),e=p.create(),t=p.create(),n=p.create(),o=p.create(1);return function(a,l,h=V.create()){return u.getTransformWorldMatrix(a,i),u.hasUniformScaleWorld(a)?V.mul(i,l,h):(p.set(e,l[12],l[13],l[14]),u.convertPositionObjectToWorld(a,e,e),V.getScale(i,t),p.div(o,t,n),V.scale(i,n,i),V.mul(i,l,h),V.scale(h,t,h),h[12]=e[0],h[13]=e[1],h[14]=e[2],h[15]=1),h}}(),Pd=function(){let i=p.create(),e=f.create();return function(n,o,s=O.create()){return u.getRotationWorldQuat(n,e),f.mul(e,o,e),O.getPosition(o,i),u.convertPositionObjectToWorld(n,i,i),O.setPositionRotationQuat(s,i,e),s}}();function Cd(i,e,t){return u.convertTransformWorldToObjectMatrix(i,e,t)}var Td=function(){let i=V.create(),e=p.create(),t=p.create(),n=p.create(),o=p.create(1);return function(a,l,h=V.create()){return u.getTransformWorldMatrix(a,i),u.hasUniformScaleWorld(a)?(V.invert(i,i),V.mul(i,l,h)):(p.set(e,l[12],l[13],l[14]),u.convertPositionWorldToObject(a,e,e),V.getScale(i,t),p.div(o,t,n),V.scale(i,n,i),V.invert(i,i),V.mul(i,l,h),V.scale(h,n,h),h[12]=e[0],h[13]=e[1],h[14]=e[2],h[15]=1),h}}(),bd=function(){let i=p.create(),e=f.create();return function(n,o,s=O.create()){return u.getRotationWorldQuat(n,e),f.conjugate(e,e),f.mul(e,o,e),O.getPosition(o,i),u.convertPositionWorldToObject(n,i,i),O.setPositionRotationQuat(s,i,e),s}}();function Sd(i,e,t){return u.convertTransformLocalToWorldMatrix(i,e,t)}function vd(i,e,t=V.create()){return u.getParent(i)?u.convertTransformObjectToWorldMatrix(u.getParent(i),e,t):V.copy(e,t),t}function xd(i,e,t=O.create()){return u.getParent(i)?u.convertTransformObjectToWorldQuat(u.getParent(i),e,t):O.copy(e,t),t}function Md(i,e,t){return u.convertTransformWorldToLocalMatrix(i,e,t)}function Ed(i,e,t=V.create()){return u.getParent(i)?u.convertTransformWorldToObjectMatrix(u.getParent(i),e,t):V.copy(e,t),t}function Dd(i,e,t=O.create()){return u.getParent(i)?u.convertTransformWorldToObjectQuat(u.getParent(i),e,t):O.copy(e,t),t}function Rd(i,e,t){return u.convertTransformObjectToLocalMatrix(i,e,t)}function Ad(i,e,t=V.create()){return u.convertTransformObjectToWorldMatrix(i,e,t),u.convertTransformWorldToLocalMatrix(i,t,t),t}function Vd(i,e,t=O.create()){return u.convertTransformObjectToWorldQuat(i,e,t),u.convertTransformWorldToLocalQuat(i,t,t),t}function Od(i,e,t){return u.convertTransformLocalToObjectMatrix(i,e,t)}function Bd(i,e,t=V.create()){return u.convertTransformLocalToWorldMatrix(i,e,t),u.convertTransformWorldToObjectMatrix(i,t,t),t}function Id(i,e,t=O.create()){return u.convertTransformLocalToWorldQuat(i,e,t),u.convertTransformWorldToObjectQuat(i,t,t),t}function Hd(i,e,t,n=null){let o=null;return typeof t=="boolean"?(o={},o.active=t):(o=t,n!=null&&(o==null&&(o={}),o.active=n)),i.addComponent(e,o)}function eE(i,e,t=0){return u.getComponentHierarchy(i,e,t)}function Ld(i,e,t=0){return i.getComponent(e,t)}function kd(i,e,t=0){return u.getComponentHierarchyBreadth(i,e,t)}function Fd(i,e,t=0){let n=u.getHierarchyBreadth(i);return u.getComponentObjects(n,e,t)}function wd(i,e,t=0){let n=u.getHierarchyDepth(i);return u.getComponentObjects(n,e,t)}function jd(i,e,t=0){return u.getComponentDescendantsBreadth(i,e,t)}function zd(i,e,t=0){let n=u.getDescendantsBreadth(i);return u.getComponentObjects(n,e,t)}function Nd(i,e,t=0){let n=u.getDescendantsDepth(i);return u.getComponentObjects(n,e,t)}function Gd(i,e,t=0){let n=u.getChildren(i);return u.getComponentObjects(n,e,t)}function tE(i,e){return u.getComponentsHierarchy(i,e)}function Ud(i,e){return i.getComponents(e)}function Wd(i,e){return u.getComponentsHierarchyBreadth(i,e)}function Qd(i,e){let t=u.getHierarchyBreadth(i);return u.getComponentsObjects(t,e)}function qd(i,e){let t=u.getHierarchyDepth(i);return u.getComponentsObjects(t,e)}function Xd(i,e){return u.getComponentsDescendantsBreadth(i,e)}function Kd(i,e){let t=u.getDescendantsBreadth(i);return u.getComponentsObjects(t,e)}function Jd(i,e){let t=u.getDescendantsDepth(i);return u.getComponentsObjects(t,e)}function Zd(i,e){let t=u.getChildren(i);return u.getComponentsObjects(t,e)}function Yd(i,e,t=!0){t?u.setActiveHierarchy(i,e):i.active=e}function $d(i,e){u.setActive(i,e,!1)}function e_(i,e){u.setActiveHierarchyBreadth(i,e)}function t_(i,e){let t=u.getHierarchyBreadth(i);u.setActiveObjects(t,e)}function i_(i,e){let t=u.getHierarchyDepth(i);u.setActiveObjects(t,e)}function n_(i,e){u.setActiveDescendantsBreadth(i,e)}function o_(i,e){let t=u.getDescendantsBreadth(i);u.setActiveObjects(t,e)}function s_(i,e){let t=u.getDescendantsDepth(i);u.setActiveObjects(t,e)}function a_(i,e){let t=u.getChildren(i);u.setActiveObjects(t,e)}function iE(i){return u.hasUniformScaleWorld(i)}var r_=function(){let i=p.create();return function(t){return u.getScaleWorld(t,i),Math.abs(i[0]-i[1])<H.EPSILON&&Math.abs(i[1]-i[2])<H.EPSILON&&Math.abs(i[0]-i[2])<H.EPSILON}}(),l_=function(){let i=p.create();return function(t){return u.getScaleLocal(t,i),Math.abs(i[0]-i[1])<H.EPSILON&&Math.abs(i[1]-i[2])<H.EPSILON&&Math.abs(i[0]-i[2])<H.EPSILON}}(),nE=function(){let i=p.create(),e=O.create();return function(n,o=new Zt){let s=null;if(u.isCloneable(n,o)){let a=[];a.push([u.getParent(n),n]);let l=[];for(;a.length>0;){let y=a.shift(),c=y[0],d=y[1],g=c!=null?u.addObject(c):J.addObject(r.getScene(u.getEngine(n)));if(u.setName(g,u.getName(d)),u.setScaleLocal(g,u.getScaleLocal(d,i)),u.setTransformLocalQuat(g,u.getTransformLocalQuat(d,e)),o.myIgnoreComponents||l.push([d,g]),!o.myIgnoreChildren)for(let P of u.getChildren(d)){let T=!1;o.myChildrenToInclude.length>0?T=o.myChildrenToInclude.find(C=>u.equals(C,P))!=null:T=o.myChildrenToIgnore.find(C=>u.equals(C,P))==null,T&&o.myIgnoreChildCallback!=null&&(T=!o.myIgnoreChildCallback(P)),T&&a.push([g,P])}s==null&&(s=g)}let h=[];for(;l.length>0;){let y=l.shift(),c=y[0],d=y[1],g=u.getComponentsSelf(c);for(let P of g)if(N.isCloneable(P.type,o.myUseDefaultComponentClone||o.myUseDefaultComponentCloneAsFallback)){let T=!1;o.myComponentsToInclude.length>0?T=o.myComponentsToInclude.indexOf(P.type)!=-1:T=o.myComponentsToIgnore.indexOf(P.type)==-1,T&&o.myIgnoreComponentCallback!=null&&(T=!o.myIgnoreComponentCallback(P)),T&&h.push([P,d])}}let _=[];for(;h.length>0;){let y=h.shift(),c=y[0],d=y[1],g=null;o.myUseDefaultComponentClone?g=N.cloneDefault(c,d,o.myDefaultComponentCloneAutoStartIfNotActive):g=N.clone(c,d,o.myComponentDeepCloneParams,o.myComponentCustomCloneParams,o.myUseDefaultComponentCloneAsFallback,o.myDefaultComponentCloneAutoStartIfNotActive),g!=null&&N.hasClonePostProcess(c.type)&&_.push([c,g])}for(;_.length>0;){let y=_.shift(),c=y[0],d=y[1];N.clonePostProcess(c,d,o.myComponentDeepCloneParams,o.myComponentCustomCloneParams)}}return s}}();function oE(i,e=new Zt){if(e.myIgnoreNonCloneable||e.myIgnoreComponents||e.myUseDefaultComponentClone||e.myUseDefaultComponentCloneAsFallback)return!0;let t=!0,n=[];for(n.push(i);t&&n.length>0;){let o=n.shift(),s=u.getComponentsSelf(o);for(let a of s){let l=!1;if(e.myComponentsToInclude.length>0?l=e.myComponentsToInclude.indexOf(a.type)!=-1:l=e.myComponentsToIgnore.indexOf(a.type)==-1,l&&e.myIgnoreComponentCallback!=null&&(l=!e.myIgnoreComponentCallback(a)),l&&!N.isCloneable(a.type)){t=!1;break}}if(t&&!e.myIgnoreChildren)for(let a of u.getChildren(o)){let l=!1;e.myChildrenToInclude.length>0?l=e.myChildrenToInclude.find(h=>u.equals(h,a))!=null:l=e.myChildrenToIgnore.find(h=>u.equals(h,a))==null,l&&e.myIgnoreChildCallback!=null&&(l=!e.myIgnoreChildCallback(a)),l&&n.push(a)}}return t}function sE(i){return u.toStringCompact(i)}var aE=function(){let i="    ",e=`
`,t="{",n="}",o="name: ",s="id: ",a="components: ",l="type: ",h="children: ",_="[",y="]",c=_,d=y,g=",",P=e.concat(i,i);return function(C){let x="";x=x.concat(t,e);let D=u.getComponentsSelf(C),E=u.getChildren(C),S=u.getName(C);if(D.length>0||E.length>0||S.length>0?x=x.concat(i,s,u.getID(C),g,e):x=x.concat(i,s,u.getID(C),e),S.length>0&&(D.length>0||E.length>0?x=x.concat(i,o,u.getName(C),g,e):x=x.concat(i,o,u.getName(C),e)),D.length>0){x=x.concat(i,a,e,i,_,e);for(let b=0;b<D.length;b++){let v=D[b];x=x.concat(i,i,t,e),x=x.concat(i,i,i,l,v.type,g,e),x=x.concat(i,i,i,s,v._id,g,e),x=x.concat(i,i,n),b!=D.length-1?x=x.concat(g,e):x=x.concat(e)}E.length>0?x=x.concat(i,y,g,e):x=x.concat(i,y,e)}if(E.length>0){x=x.concat(i,h,e,i,c,e);for(let b=0;b<E.length;b++){let v=E[b],I=u.toStringExtended(v);I=I.replaceAll(e,P),I=i.concat(i,I),x=x.concat(I),b!=E.length-1?x=x.concat(g,e):x=x.concat(e)}x=x.concat(i,d,e)}return x=x.concat(n),x}}(),rE=function(){let i="    ",e=`
`,t="<none>",n="name: ",o="components: ",s=", ",a=e.concat(i);return function(h){let _="",y=u.getName(h);y.length>0?_=_.concat(n,y):_=_.concat(n,t);let c=u.getComponentsSelf(h);if(c.length>0){_=_.concat(s,o);for(let g=0;g<c.length;g++){let P=c[g];_=_.concat(P.type),g!=c.length-1&&(_=_.concat(s))}}let d=u.getChildren(h);if(d.length>0){_=_.concat(e);for(let g=0;g<d.length;g++){let P=d[g],T=u.toStringCompact(P);T=T.replaceAll(e,a),T=i.concat(T),_=_.concat(T),g!=d.length-1&&(_=_.concat(e))}}return _}}();function lE(i,e,t=!1,n=0){return u.getObjectByNameHierarchy(i,e,t,n)}function m_(i,e,t=!1,n=0){return u.getObjectByNameHierarchyBreadth(i,e,t,n)}function y_(i,e,t=!1,n=0){let o=u.getHierarchyBreadth(i);return u.getObjectByNameObjects(o,e,t,n)}function u_(i,e,t=!1,n=0){let o=u.getHierarchyDepth(i);return u.getObjectByNameObjects(o,e,t,n)}function h_(i,e,t=!1,n=0){return u.getObjectByNameDescendantsBreadth(i,e,t,n)}function c_(i,e,t=!1,n=0){let o=u.getDescendantsBreadth(i);return u.getObjectByNameObjects(o,e,t,n)}function p_(i,e,t=!1,n=0){let o=u.getDescendantsDepth(i);return u.getObjectByNameObjects(o,e,t,n)}function d_(i,e,t=!1,n=0){let o=u.getChildren(i);return u.getObjectByNameObjects(o,e,t,n)}function mE(i,e,t=!1){return u.getObjectsByNameHierarchy(i,e,t)}function __(i,e,t=!1){return u.getObjectsByNameHierarchyBreadth(i,e,t)}function g_(i,e,t=!1){let n=u.getHierarchyBreadth(i);return u.getObjectsByNameObjects(n,e,t)}function f_(i,e,t=!1){let n=u.getHierarchyDepth(i);return u.getObjectsByNameObjects(n,e,t)}function P_(i,e,t=!1){return u.getObjectsByNameDescendantsBreadth(i,e,t)}function C_(i,e,t=!1){let n=u.getDescendantsBreadth(i);return u.getObjectsByNameObjects(n,e,t)}function T_(i,e,t=!1){let n=u.getDescendantsDepth(i);return u.getObjectsByNameObjects(n,e,t)}function b_(i,e,t=!1){let n=u.getChildren(i);return u.getObjectsByNameObjects(n,e,t)}function yE(i,e){return u.getObjectByIDHierarchy(i,e)}function S_(i,e){return u.getObjectByIDHierarchyBreadth(i,e)}function v_(i,e){let t=u.getHierarchyBreadth(i);return u.getObjectByIDObjects(t,e)}function x_(i,e){let t=u.getHierarchyDepth(i);return u.getObjectByIDObjects(t,e)}function M_(i,e){return u.getObjectByIDDescendantsBreadth(i,e)}function E_(i,e){let t=u.getDescendantsBreadth(i);return u.getObjectByIDObjects(t,e)}function D_(i,e){let t=u.getDescendantsDepth(i);return u.getObjectByIDObjects(t,e)}function R_(i,e){let t=u.getChildren(i);return u.getObjectByIDObjects(t,e)}function A_(i){return u.getHierarchyBreadth(i)}function V_(i){let e=u.getDescendantsBreadth(i);return e.unshift(i),e}function O_(i){let e=u.getDescendantsDepth(i);return e.unshift(i),e}function B_(i){return u.getDescendantsBreadth(i)}function I_(i){let e=[],t=u.getChildren(i);for(;t.length>0;){let n=t.shift();e.push(n);for(let o of u.getChildren(n))t.push(o)}return e}function H_(i){let e=[],t=u.getChildren(i);for(let n of t){e.push(n);let o=u.getDescendantsDepth(n);o.length>0&&e.push(...o)}return e}function L_(i){return i.children}function k_(i){return i}function uE(i){return r.getScene(u.getEngine(i)).addObject(i)}function F_(i){return i.name}function w_(i,e){i.name=e}function j_(i){return i.engine}function z_(i){return i.objectId}function N_(i){return i.setDirty()}function G_(i){return i.changed}function hE(i,e){return i.equals(e)}function U_(i){return i.destroy()}function W_(i,e){u.reserveObjectsHierarchy(i,e)}function Q_(i,e){let t=u.getComponentsAmountMapSelf(i);dr(e,t,r.getScene(u.getEngine(i)))}function q_(i,e){let t=u.getComponentsAmountMapHierarchy(i);dr(e,t,r.getScene(u.getEngine(i)))}function X_(i,e){let t=u.getComponentsAmountMapDescendants(i);dr(e,t,r.getScene(u.getEngine(i)))}function K_(i,e){let t=u.getComponentsAmountMapChildren(i);dr(e,t,r.getScene(u.getEngine(i)))}function cE(i,e=new Map){return u.getComponentsAmountMapHierarchy(i,e)}function J_(i,e=new Map){let t=e.get("object");t==null&&(t=0),t+=1,e.set("object",t);let n=u.getComponentsSelf(i);for(let o of n){let s=o.type,a=e.get(s);a==null&&(a=0),a+=1,e.set(s,a)}return e}function Z_(i,e=new Map){let t=u.getHierarchy(i);for(let n of t)u.getComponentsAmountMapSelf(n,e);return e}function Y_(i,e=new Map){let t=u.getDescendants(i);for(let n of t)u.getComponentsAmountMapSelf(n,e);return e}function $_(i,e=new Map){let t=u.getChildren(i);for(let n of t)u.getComponentsAmountMapSelf(n,e);return e}function eg(i,e,t=0){let n=null;for(let o of i)if(n=o.getComponent(e,t),n!=null)break;return n}function tg(i,e){let t=[];for(let n of i)t.push(...n.getComponents(e));return t}function ig(i,e){for(let t of i)t.active=e}function ng(i,e,t=!1,n=0){let o=null,s=n;for(let a of i){let l=u.getName(a);if(!t&&l==e||t&&l.match(e)){if(s==0){o=a;break}s--}}return o}function og(i,e,t=!1){let n=[];for(let o of i){let s=u.getName(o);(!t&&s==e||t&&s.match(e))&&n.push(o)}return n}function sg(i,e,t=0){let n=null,o=t;for(let s of i)if(u.getID(s)==e){if(o==0){n=s;break}o--}return n}function ag(i,e){let t=[];for(let n of i)u.getID(n)==e&&t.push(n);return t}function rg(i,e=r.getMainEngine()){return e.wrapObject(i)}var u={getPosition:pM,getPositionWorld:hh,getPositionLocal:ch,getRotation:dM,getRotationDegrees:_M,getRotationRadians:gM,getRotationMatrix:ph,getRotationQuat:fM,getRotationWorld:dh,getRotationWorldDegrees:_h,getRotationWorldRadians:gh,getRotationWorldMatrix:fh,getRotationWorldQuat:Ph,getRotationLocal:Ch,getRotationLocalDegrees:Th,getRotationLocalRadians:bh,getRotationLocalMatrix:Sh,getRotationLocalQuat:vh,getScale:PM,getScaleWorld:xh,getScaleLocal:Mh,getTransform:Eh,getTransformMatrix:Dh,getTransformQuat:Rh,getTransformWorld:Ah,getTransformWorldMatrix:Vh,getTransformWorldQuat:Oh,getTransformLocal:Bh,getTransformLocalMatrix:Ih,getTransformLocalQuat:Hh,getAxes:CM,getAxesWorld:Lh,getAxesLocal:kh,getForward:TM,getForwardWorld:Fh,getForwardLocal:wh,getBackward:bM,getBackwardWorld:jh,getBackwardLocal:zh,getUp:SM,getUpWorld:Nh,getUpLocal:Gh,getDown:vM,getDownWorld:Uh,getDownLocal:Wh,getLeft:xM,getLeftWorld:Qh,getLeftLocal:qh,getRight:MM,getRightWorld:Xh,getRightLocal:Kh,setPosition:EM,setPositionWorld:Jh,setPositionLocal:Zh,setRotation:DM,setRotationDegrees:RM,setRotationRadians:AM,setRotationMatrix:Yh,setRotationQuat:VM,setRotationWorld:$h,setRotationWorldDegrees:ec,setRotationWorldRadians:tc,setRotationWorldMatrix:ic,setRotationWorldQuat:nc,setRotationLocal:oc,setRotationLocalDegrees:sc,setRotationLocalRadians:ac,setRotationLocalMatrix:rc,setRotationLocalQuat:lc,setScale:OM,setScaleWorld:mc,setScaleLocal:yc,setAxes:BM,setAxesWorld:uc,setAxesLocal:hc,setForward:IM,setForwardWorld:cc,setForwardLocal:pc,setBackward:HM,setBackwardWorld:dc,setBackwardLocal:_c,setUp:LM,setUpWorld:gc,setUpLocal:fc,setDown:kM,setDownWorld:Pc,setDownLocal:Cc,setLeft:FM,setLeftWorld:Tc,setLeftLocal:bc,setRight:wM,setRightWorld:Sc,setRightLocal:vc,setTransform:xc,setTransformMatrix:Mc,setTransformQuat:Ec,setTransformWorld:Dc,setTransformWorldMatrix:Rc,setTransformWorldQuat:Ac,setTransformLocal:Vc,setTransformLocalMatrix:Oc,setTransformLocalQuat:Bc,resetPosition:Ic,resetPositionWorld:Hc,resetPositionLocal:Lc,resetRotation:kc,resetRotationWorld:Fc,resetRotationLocal:wc,resetScale:jc,resetScaleWorld:zc,resetScaleLocal:Nc,resetTransform:Gc,resetTransformWorld:Uc,resetTransformLocal:Wc,translate:Qc,translateWorld:qc,translateLocal:Xc,translateObject:Kc,translateAxis:Jc,translateAxisWorld:Zc,translateAxisLocal:Yc,translateAxisObject:$c,rotate:jM,rotateDegrees:zM,rotateRadians:NM,rotateMatrix:ep,rotateQuat:GM,rotateWorld:tp,rotateWorldDegrees:ip,rotateWorldRadians:np,rotateWorldMatrix:op,rotateWorldQuat:sp,rotateLocal:ap,rotateLocalDegrees:rp,rotateLocalRadians:lp,rotateLocalMatrix:mp,rotateLocalQuat:yp,rotateObject:up,rotateObjectDegrees:hp,rotateObjectRadians:cp,rotateObjectMatrix:pp,rotateObjectQuat:dp,rotateAxis:UM,rotateAxisDegrees:WM,rotateAxisRadians:QM,rotateAxisWorld:_p,rotateAxisWorldDegrees:gp,rotateAxisWorldRadians:fp,rotateAxisLocal:Pp,rotateAxisLocalDegrees:Cp,rotateAxisLocalRadians:Tp,rotateAxisObject:bp,rotateAxisObjectDegrees:Sp,rotateAxisObjectRadians:vp,rotateAround:qM,rotateAroundDegrees:XM,rotateAroundRadians:KM,rotateAroundMatrix:xp,rotateAroundQuat:JM,rotateAroundWorld:Mp,rotateAroundWorldDegrees:Ep,rotateAroundWorldRadians:Dp,rotateAroundWorldMatrix:Rp,rotateAroundWorldQuat:Ap,rotateAroundLocal:Vp,rotateAroundLocalDegrees:Op,rotateAroundLocalRadians:Bp,rotateAroundLocalMatrix:Ip,rotateAroundLocalQuat:Hp,rotateAroundObject:Lp,rotateAroundObjectDegrees:kp,rotateAroundObjectRadians:Fp,rotateAroundObjectMatrix:wp,rotateAroundObjectQuat:jp,rotateAroundAxis:ZM,rotateAroundAxisDegrees:YM,rotateAroundAxisRadians:$M,rotateAroundAxisWorld:zp,rotateAroundAxisWorldDegrees:Np,rotateAroundAxisWorldRadians:Gp,rotateAroundAxisLocal:Up,rotateAroundAxisLocalDegrees:Wp,rotateAroundAxisLocalRadians:Qp,rotateAroundAxisObject:qp,rotateAroundAxisObjectDegrees:Xp,rotateAroundAxisObjectRadians:Kp,scaleObject:Jp,lookAt:Zp,lookAtWorld:Yp,lookAtLocal:$p,lookTo:ed,lookToWorld:td,lookToLocal:id,setParent:nd,getParent:od,convertPositionObjectToWorld:sd,convertDirectionObjectToWorld:ad,convertPositionWorldToObject:rd,convertDirectionWorldToObject:ld,convertPositionLocalToWorld:md,convertDirectionLocalToWorld:yd,convertPositionWorldToLocal:ud,convertDirectionWorldToLocal:hd,convertPositionObjectToLocal:cd,convertDirectionObjectToLocal:pd,convertPositionLocalToObject:dd,convertDirectionLocalToObject:_d,convertTransformObjectToWorld:gd,convertTransformObjectToWorldMatrix:fd,convertTransformObjectToWorldQuat:Pd,convertTransformWorldToObject:Cd,convertTransformWorldToObjectMatrix:Td,convertTransformWorldToObjectQuat:bd,convertTransformLocalToWorld:Sd,convertTransformLocalToWorldMatrix:vd,convertTransformLocalToWorldQuat:xd,convertTransformWorldToLocal:Md,convertTransformWorldToLocalMatrix:Ed,convertTransformWorldToLocalQuat:Dd,convertTransformObjectToLocal:Rd,convertTransformObjectToLocalMatrix:Ad,convertTransformObjectToLocalQuat:Vd,convertTransformLocalToObject:Od,convertTransformLocalToObjectMatrix:Bd,convertTransformLocalToObjectQuat:Id,addComponent:Hd,getComponent:eE,getComponentSelf:Ld,getComponentHierarchy:kd,getComponentHierarchyBreadth:Fd,getComponentHierarchyDepth:wd,getComponentDescendants:jd,getComponentDescendantsBreadth:zd,getComponentDescendantsDepth:Nd,getComponentChildren:Gd,getComponents:tE,getComponentsSelf:Ud,getComponentsHierarchy:Wd,getComponentsHierarchyBreadth:Qd,getComponentsHierarchyDepth:qd,getComponentsDescendants:Xd,getComponentsDescendantsBreadth:Kd,getComponentsDescendantsDepth:Jd,getComponentsChildren:Zd,setActive:Yd,setActiveSelf:$d,setActiveHierarchy:e_,setActiveHierarchyBreadth:t_,setActiveHierarchyDepth:i_,setActiveDescendants:n_,setActiveDescendantsBreadth:o_,setActiveDescendantsDepth:s_,setActiveChildren:a_,hasUniformScale:iE,hasUniformScaleWorld:r_,hasUniformScaleLocal:l_,clone:nE,isCloneable:oE,toString:sE,toStringExtended:aE,toStringCompact:rE,getObjectByName:lE,getObjectByNameHierarchy:m_,getObjectByNameHierarchyBreadth:y_,getObjectByNameHierarchyDepth:u_,getObjectByNameDescendants:h_,getObjectByNameDescendantsBreadth:c_,getObjectByNameDescendantsDepth:p_,getObjectByNameChildren:d_,getObjectsByName:mE,getObjectsByNameHierarchy:__,getObjectsByNameHierarchyBreadth:g_,getObjectsByNameHierarchyDepth:f_,getObjectsByNameDescendants:P_,getObjectsByNameDescendantsBreadth:C_,getObjectsByNameDescendantsDepth:T_,getObjectsByNameChildren:b_,getObjectByID:yE,getObjectByIDHierarchy:S_,getObjectByIDHierarchyBreadth:v_,getObjectByIDHierarchyDepth:x_,getObjectByIDDescendants:M_,getObjectByIDDescendantsBreadth:E_,getObjectByIDDescendantsDepth:D_,getObjectByIDChildren:R_,getHierarchy:A_,getHierarchyBreadth:V_,getHierarchyDepth:O_,getDescendants:B_,getDescendantsBreadth:I_,getDescendantsDepth:H_,getChildren:L_,getSelf:k_,addObject:uE,getName:F_,setName:w_,getEngine:j_,getID:z_,markDirty:N_,isTransformChanged:G_,equals:hE,destroy:U_,reserveObjects:W_,reserveObjectsSelf:Q_,reserveObjectsHierarchy:q_,reserveObjectsDescendants:X_,reserveObjectsChildren:K_,getComponentsAmountMap:cE,getComponentsAmountMapSelf:J_,getComponentsAmountMapHierarchy:Z_,getComponentsAmountMapDescendants:Y_,getComponentsAmountMapChildren:$_,getComponentObjects:eg,getComponentsObjects:tg,setActiveObjects:ig,getObjectByNameObjects:ng,getObjectsByNameObjects:og,getObjectByIDObjects:sg,getObjectsByIDObjects:ag,wrapObject:rg};function dr(i,e,t){let n=e.get("object")*i;e.delete("object");let o={};for(let[s,a]of e.entries())o[s]=a*i;t.reserveObjects(n,o)}function pE(i){return u.wrapObject(0,i.engine)}function dE(i){return u.addObject(J.getRoot(i))}function lg(i){return J.getObjectsBreadth(i)}function mg(i){return u.getHierarchyBreadth(J.getRoot(i))}function yg(i){return u.getHierarchyDepth(J.getRoot(i))}function _E(i,e,t=0){return J.getComponentBreadth(i,e,t)}function ug(i,e,t=0){return u.getComponentHierarchyBreadth(J.getRoot(i),e,t)}function hg(i,e,t=0){return u.getComponentHierarchyDepth(J.getRoot(i),e,t)}function gE(i,e){return J.getComponentsBreadth(i,e)}function cg(i,e){return u.getComponentsHierarchyBreadth(J.getRoot(i),e)}function pg(i,e){return u.getComponentsHierarchyDepth(J.getRoot(i),e)}function fE(i,e,t=0){return J.getObjectByNameBreadth(i,e,t)}function dg(i,e,t=0){return u.getObjectByNameHierarchyBreadth(J.getRoot(i),e,t)}function _g(i,e,t=0){return u.getObjectByNameHierarchyDepth(J.getRoot(i),e,t)}function PE(i,e,t=0){return J.getObjectsByNameBreadth(i,e,t)}function gg(i,e,t=0){return u.getObjectsByNameHierarchyBreadth(J.getRoot(i),e,t)}function fg(i,e,t=0){return u.getObjectsByNameHierarchyDepth(J.getRoot(i),e,t)}function CE(i,e){return J.getObjectByIDBreadth(i,e)}function Pg(i,e){return u.getObjectByIDHierarchyBreadth(J.getRoot(i),e)}function Cg(i,e){return u.getObjectByIDHierarchyDepth(J.getRoot(i),e)}function TE(i){return J.toStringCompact(i)}function bE(i){return u.toStringCompact(J.getRoot(i))}function SE(i){return u.toStringExtended(J.getRoot(i))}function vE(i,e=new Map){return u.getComponentsAmountMap(J.getRoot(i),e)}var J={getRoot:pE,addObject:dE,getObjects:lg,getObjectsBreadth:mg,getObjectsDepth:yg,getComponent:_E,getComponentBreadth:ug,getComponentDepth:hg,getComponents:gE,getComponentsBreadth:cg,getComponentsDepth:pg,getObjectByName:fE,getObjectByNameBreadth:dg,getObjectByNameDepth:_g,getObjectsByName:PE,getObjectsByNameBreadth:gg,getObjectsByNameDepth:fg,getObjectByID:CE,getObjectByIDBreadth:Pg,getObjectByIDDepth:Cg,toString:TE,toStringCompact:bE,toStringExtended:SE,getComponentsAmountMap:vE};var Tg=null,bs=[];function bg(i){i!=null&&(pl(i),pi()==null&&cl(i))}function pi(){return Tg}function cl(i){_l(i)&&(Tg=i)}function Sg(){return bs}function pl(i){dl(i),bs.push(i)}function dl(i){let e=bs.indexOf(i);e>=0&&bs.splice(e,1)}function _l(i){return bs.indexOf(i)>=0}function gl(i=pi()){let e=null;return i!=null&&(e=i.scene),e}function xE(i=pi()){let e=null,t=gl(i);return t!=null&&(e=J.getRoot(t)),e}function vg(i=pi()){let e=null;return i!=null&&(e=i.physics),e}function xg(i=pi()){let e=null;return i!=null&&(e=i.canvas),e}function Mg(i=pi()){let e=null;return i!=null&&(e=i.wasm),e}function Eg(i=pi()){let e=null;return i!=null&&(e=i.xr),e}var Cl={};bt(Cl,{getDebugManager:()=>Pl,getDebugVisualManager:()=>Vg,hasDebugEnabled:()=>Hg,hasDebugManager:()=>Ag,isDebugEnabled:()=>Og,removeDebugEnabled:()=>Ig,removeDebugManager:()=>Rg,setDebugEnabled:()=>Bg,setDebugManager:()=>Dg});var _r=new WeakMap,gr=new WeakMap;function Pl(i=r.getMainEngine()){return _r.get(i)}function Dg(i,e=r.getMainEngine()){_r.set(e,i)}function Rg(i=r.getMainEngine()){_r.delete(i)}function Ag(i=r.getMainEngine()){return _r.has(i)}function Vg(i=r.getMainEngine()){let e=Pl(i);return e!=null?e.getDebugVisualManager():null}function Og(i=r.getMainEngine()){return gr.get(i)}function Bg(i,e=r.getMainEngine()){gr.set(e,i)}function Ig(i=r.getMainEngine()){gr.delete(i)}function Hg(i=r.getMainEngine()){return gr.has(i)}var Tl={};bt(Tl,{getCharacterCollisionSystem:()=>Lg,hasCharacterCollisionSystem:()=>wg,removeCharacterCollisionSystem:()=>Fg,setCharacterCollisionSystem:()=>kg});var fr=new WeakMap;function Lg(i=r.getMainEngine()){return fr.get(i)}function kg(i,e=r.getMainEngine()){fr.set(e,i)}function Fg(i=r.getMainEngine()){fr.delete(i)}function wg(i=r.getMainEngine()){return fr.has(i)}var jg={};var bl={};bt(bl,{getGamepad:()=>qg,getGamepads:()=>Xg,getGamepadsManager:()=>Qg,getHandPose:()=>Yg,getHandPoses:()=>$g,getHeadPose:()=>Zg,getInputManager:()=>qe,getKeyboard:()=>Wg,getLeftGamepad:()=>Kg,getLeftHandPose:()=>ef,getLeftTrackedHandPose:()=>sf,getMouse:()=>Ug,getRightGamepad:()=>Jg,getRightHandPose:()=>tf,getRightTrackedHandPose:()=>af,getTrackedHandPose:()=>nf,getTrackedHandPoses:()=>of,hasInputManager:()=>Gg,hasPoseForwardFixed:()=>yf,isPoseForwardFixed:()=>rf,removeInputManager:()=>Ng,removePoseForwardFixed:()=>mf,setInputManager:()=>zg,setPoseForwardFixed:()=>lf});var Pr=new WeakMap,Cr=new WeakMap;function qe(i=r.getMainEngine()){return Pr.get(i)}function zg(i,e=r.getMainEngine()){Pr.set(e,i)}function Ng(i=r.getMainEngine()){Pr.delete(i)}function Gg(i=r.getMainEngine()){return Pr.has(i)}function Ug(i=r.getMainEngine()){let e=qe(i);return e!=null?e.getMouse():null}function Wg(i=r.getMainEngine()){let e=qe(i);return e!=null?e.getKeyboard():null}function Qg(i=r.getMainEngine()){let e=qe(i);return e!=null?e.getGamepadsManager():null}function qg(i,e=r.getMainEngine()){let t=qe(e);return t!=null?t.getGamepadsManager().getGamepad(i):null}function Xg(i=r.getMainEngine()){let e=qe(i);return e!=null?e.getGamepadsManager().getGamepads():null}function Kg(i=r.getMainEngine()){let e=qe(i);return e!=null?e.getGamepadsManager().getLeftGamepad():null}function Jg(i=r.getMainEngine()){let e=qe(i);return e!=null?e.getGamepadsManager().getRightGamepad():null}function Zg(i=r.getMainEngine()){let e=qe(i);return e!=null?e.getHeadPose():null}function Yg(i,e=r.getMainEngine()){let t=qe(e);return t!=null?t.getHandPose(i):null}function $g(i=r.getMainEngine()){let e=qe(i);return e!=null?e.getHandPoses():null}function ef(i=r.getMainEngine()){let e=qe(i);return e!=null?e.getLeftHandPose():null}function tf(i=r.getMainEngine()){let e=qe(i);return e!=null?e.getRightHandPose():null}function nf(i,e=r.getMainEngine()){let t=qe(e);return t!=null?t.getTrackedHandPose(i):null}function of(i=r.getMainEngine()){let e=qe(i);return e!=null?e.getTrackedHandPoses():null}function sf(i=r.getMainEngine()){let e=qe(i);return e!=null?e.getLeftTrackedHandPose():null}function af(i=r.getMainEngine()){let e=qe(i);return e!=null?e.getRightTrackedHandPose():null}function rf(i=r.getMainEngine()){return Cr.get(i)}function lf(i,e=r.getMainEngine()){Cr.set(e,i)}function mf(i=r.getMainEngine()){Cr.delete(i)}function yf(i=r.getMainEngine()){return Cr.has(i)}var Sl={};bt(Sl,{hasToolEnabled:()=>pf,isToolEnabled:()=>uf,removeToolEnabled:()=>cf,setToolEnabled:()=>hf});var Tr=new WeakMap;function uf(i=r.getMainEngine()){return Tr.get(i)}function hf(i,e=r.getMainEngine()){Tr.set(e,i)}function cf(i=r.getMainEngine()){Tr.delete(i)}function pf(i=r.getMainEngine()){return Tr.has(i)}var vl={};bt(vl,{getConsoleVR:()=>df,hasConsoleVR:()=>ff,removeConsoleVR:()=>gf,setConsoleVR:()=>_f});var br=new WeakMap;function df(i=r.getMainEngine()){return br.get(i)}function _f(i,e=r.getMainEngine()){br.set(e,i)}function gf(i=r.getMainEngine()){br.delete(i)}function ff(i=r.getMainEngine()){return br.has(i)}var xl={};bt(xl,{getEasyTuneTarget:()=>Sf,getEasyTuneVariables:()=>Pf,hasEasyTuneTarget:()=>Mf,hasEasyTuneVariables:()=>bf,removeEasyTuneTarget:()=>xf,removeEasyTuneVariables:()=>Tf,setEasyTuneTarget:()=>vf,setEasyTuneVariables:()=>Cf});var Sr=new WeakMap,vr=new WeakMap;function Pf(i=r.getMainEngine()){return Sr.get(i)}function Cf(i,e=r.getMainEngine()){Sr.set(e,i)}function Tf(i=r.getMainEngine()){Sr.delete(i)}function bf(i=r.getMainEngine()){return Sr.has(i)}function Sf(i=r.getMainEngine()){return vr.get(i)}function vf(i,e=r.getMainEngine()){vr.set(e,i)}function xf(i=r.getMainEngine()){vr.delete(i)}function Mf(i=r.getMainEngine()){return vr.has(i)}var Ml={};bt(Ml,{getDefaultMaterials:()=>Vf,getDefaultMeshes:()=>Af,getDefaultResources:()=>Mr,hasDefaultResources:()=>Rf,removeDefaultResources:()=>Df,setDefaultResources:()=>Ef});var xr=new WeakMap;function Mr(i=r.getMainEngine()){return xr.get(i)}function Ef(i,e=r.getMainEngine()){xr.set(e,i)}function Df(i=r.getMainEngine()){xr.delete(i)}function Rf(i=r.getMainEngine()){return xr.has(i)}function Af(i=r.getMainEngine()){let e=Mr(i);return e!=null?e.myMeshes:null}function Vf(i=r.getMainEngine()){let e=Mr(i);return e!=null?e.myMaterials:null}var El={};bt(El,{getPlayerObjects:()=>Lf,getSceneObjects:()=>Of,hasSceneObjects:()=>Hf,removeSceneObjects:()=>If,setSceneObjects:()=>Bf});var Er=new WeakMap;function Of(i=r.getMainEngine()){return Er.get(i)}function Bf(i,e=r.getMainEngine()){Er.set(e,i)}function If(i=r.getMainEngine()){Er.delete(i)}function Hf(i=r.getMainEngine()){return Er.has(i)}function Lf(i=r.getMainEngine()){let e=r.getSceneObjects(i);return e!=null?e.myPlayerObjects:null}var r={...fl,...El,...Ml,...ll,...ul,...Cl,...yl,...Tl,...jg,...bl,...Sl,...vl,...xl};import{MeshComponent as dP,TextComponent as _P}from"@wonderlandengine/api";import{Mesh as Al,MeshAttribute as ke,MeshIndexType as Vl}from"@wonderlandengine/api";import{vec2 as rn}from"gl-matrix";function Dl(i,e){let t=rn.create();return i!==void 0&&kf(t,i,e),t}function kf(i,e,t){return t===void 0?rn.set(i,e,e):rn.set(i,e,t),i}function ME(i){return rn.length(i)}function EE(i,e=Dl()){return rn.normalize(e,i),e}function DE(i,e){return rn.copy(e,i),e}function RE(i,e=Dl()){return gt.copy(i,e),e}function AE(i){return rn.zero(i),i}function VE(i,e=0){return gt.length(i)<=e}var gt={create:Dl,set:kf,length:ME,normalize:EE,copy:DE,clone:RE,zero:AE,isZero:VE};import{vec4 as Dr}from"gl-matrix";function Ff(i,e,t,n){let o=Dr.create();return i!==void 0&&wf(o,i,e,t,n),o}function wf(i,e,t,n,o){return t===void 0?Dr.set(i,e,e,e,e):Dr.set(i,e,t,n,o),i}function OE(i,e){return Dr.copy(e,i),e}function BE(i,e=Ff()){return zi.copy(i,e),e}var zi={create:Ff,set:wf,copy:OE,clone:BE};function IE(i,e=null){return Rr(i,e)}function jf(i,e=4){let t=Rr(i,e);console.log(t)}function zf(i,e=4){let t=Rr(i,e);console.error(t)}function Nf(i,e=4){let t=Rr(i,e);console.warn(t)}function HE(i,e,t=null){t=Ss(i,t);for(let n=0;n<t.length;n++)t[n]=t[n]*e;return t}function Gf(i,e=null){e=Ss(i,e);for(let t=0;t<e.length;t++)e[t]=Math.round(e[t]);return e}function Uf(i,e=null){e=Ss(i,e);for(let t=0;t<e.length;t++)e[t]=Math.floor(e[t]);return e}function Wf(i,e=null){e=Ss(i,e);for(let t=0;t<e.length;t++)e[t]=Math.ceil(e[t]);return e}function LE(i,e,t,n=null){n=Ss(i,n);let o=e??-Number.MAX_VALUE,s=t??Number.MAX_VALUE,a=Math.min(o,s),l=Math.max(o,s);for(let h=0;h<n.length;h++)n[h]=H.clamp(n[h],a,l);return n}function kE(i,e,t=0){let n=i.length==e.length;for(let o=0;o<i.length&&n;o++)n=n&&Math.abs(i[o]-e[o])<=t;return n}var At={toString:IE,log:jf,error:zf,warn:Nf,scale:HE,round:Gf,floor:Uf,ceil:Wf,clamp:LE,equals:kE};function Rr(i,e){let t="[";for(let n=0;n<i.length;n++)n!=0&&(t=t.concat(", ")),e!=null?t=t.concat(i[n].toFixed(e)):t=t.concat(i[n].toString());return t=t.concat("]"),t}function Ss(i,e){return e==null?e=q.clone(i):e!=i&&q.copy(i,e),e}function Qf(i){let e=[];e.push(i);let t=Object.getPrototypeOf(i);for(;t!=null;)q.pushUnique(e,t),t=Object.getPrototypeOf(t);let n=[i];for(;n.length>0;){let o=n.shift();o!=null&&(q.pushUnique(e,o),q.pushUnique(n,Object.getPrototypeOf(o)),q.pushUnique(n,o.prototype))}return e}function qf(i){let e=[],t=$.getObjectPrototypes(i);for(let n of t)if(n!=null){let o=Object.getOwnPropertyNames(n);for(let s of o)q.pushUnique(e,s)}return e}function Xf(i,e){let t=null,n=$.getObjectPropertyOwnParent(i,e);return n!=null&&(t=Object.getOwnPropertyDescriptor(n,e)),t}function Kf(i,e){let t,n=$.getObjectPropertyDescriptor(i,e);return n!=null&&(n.get!=null?t=n.get.bind(i)():t=n.value),t}function Jf(i,e,t){let n=$.getObjectPropertyDescriptor(e,t),o=!1;if(n!=null&&n.set!=null&&(o=!0,n.set.bind(e)(i)),!o){let s=$.getObjectPropertyOwnParent(e,t);s==null&&(s=e),Object.defineProperty(s,t,{value:i})}}function Zf(i,e){let t=null,n=$.getObjectPropertyOwnParents(i,e);return n.length>0&&(t=n[0]),t}function Yf(i,e){let t=[],n=$.getObjectPrototypes(i);for(let o of n){let s=Object.getOwnPropertyNames(o);q.hasEqual(s,e)&&t.push(o)}return t}function $f(i,e=r.getWindow()){let t=null,n=$.getObjectNameFromPath(i);return n!=null&&(t=$.getObjectProperty($.getObjectParentFromPath(i,e),n)),t}function eP(i){let e=null;if(i!=null){let t=i.split(".");t.length>0&&(e=t[t.length-1])}return e}function tP(i,e=r.getWindow()){let t=i.split("."),n=e;for(let o=0;o<t.length-1;o++)n=$.getObjectProperty(n,t[o]);return n}function iP(i,e,t,n=!0,o=!1,s=!1){let a=!1;try{let l=$.getObjectPropertyOwnParent(e,t);if(l!=null){let h=Object.getOwnPropertyDescriptor(l,t);if(h!=null){let _=$.getObjectProperty(l,t);$.copyObjectProperties(_,i,!0,o,s);let y=e;n&&(y=l),Object.defineProperty(y,t,{value:i,enumerable:h.enumerable,writable:h.writable,configurable:h.configurable}),a=!0}else Object.defineProperty(e,t,{value:i}),a=!0}else Object.defineProperty(e,t,{value:i}),a=!0}catch{s&&console.error("Property:",t,"of:",e,"can't be overwritten.")}return a}function nP(i,e,t=!1,n=!1,o=!1){if(i!=null){t&&$.cleanObjectProperties(e),Object.setPrototypeOf(e,Object.getPrototypeOf(i));let s=Object.getOwnPropertyNames(i);for(let a of s)try{let l=Object.getOwnPropertyDescriptor(i,a);Object.defineProperty(e,a,{value:l.value,enumerable:l.enumerable,writable:l.writable,configurable:l.configurable})}catch{o&&console.error("Property:",a,"of:",i.name,"can't be overwritten.")}n&&FE(i,e)}}function oP(i){let e=Object.getOwnPropertyNames(i);q.pushUnique(e,"__proto__");for(let t of e){try{Object.defineProperty(i,t,{value:void 0})}catch{}try{delete i[t]}catch{}}Object.setPrototypeOf(i,null)}function sP(i,e){let t=!1,n=$.getObjectPropertyDescriptor(i,e);return n!=null&&(n.get!=null||n.set!=null)&&(t=!0),t}function aP(i,e){let t=!1,n=$.getObjectProperty(i,e);return n!=null&&(t=$.isFunction(n)&&!$.isClassByName(i,e)),t}function rP(i,e){let t=!1,n=$.getObjectProperty(i,e);return n!=null&&(t=$.isClass(n)&&e!="constructor"),t}function lP(i,e){let t=!1,n=$.getObjectProperty(i,e);return n!=null&&(t=$.isObject(n)),t}function mP(i){return typeof i=="function"&&!$.isClass(i)}function yP(i){return typeof i=="function"&&i.prototype!=null&&typeof i.prototype.constructor=="function"&&i.toString!=null&&typeof i.toString=="function"&&/^class/.test(i.toString())}function uP(i){return typeof i=="object"}var $={getObjectPrototypes:Qf,getObjectPropertyNames:qf,getObjectPropertyDescriptor:Xf,getObjectProperty:Kf,setObjectProperty:Jf,getObjectPropertyOwnParent:Zf,getObjectPropertyOwnParents:Yf,getObjectFromPath:$f,getObjectNameFromPath:eP,getObjectParentFromPath:tP,overwriteObjectProperty:iP,copyObjectProperties:nP,cleanObjectProperties:oP,doesObjectPropertyUseAccessors:sP,isFunctionByName:aP,isClassByName:rP,isObjectByName:lP,isFunction:mP,isClass:yP,isObject:uP};function FE(i,e){try{if(typeof e=="function"&&typeof i=="function"){let t=["toString","toLocaleString","valueOf"];for(let n of t){let o=$.getObjectPropertyDescriptor(i,n);if(o!=null&&o.value!=null&&o.value==Object[n]){let s=Object[n].bind(i)(),a=function(){return s};$.overwriteObjectProperty(a,e,n,!1,!1)}}}}catch{}}function hP(i,e,t=!0,n=!0,o=!0,s=!0,a=!1,l=null,h=[]){let _=Object.getOwnPropertyNames(i);for(let y of _){if(h.includes(y))continue;let c=t,d=n,g=o;if(s){let x=Object.getOwnPropertyDescriptor(e,y);x!=null&&(c=x.enumerable,d=x.writable,g=x.configurable)}let P=y;l!=null&&(P.length>0&&P[0]==P[0].toUpperCase()?P=l.toUpperCase()+P:P=l+P);let T=Object.getOwnPropertyDescriptor(i,y);if(T!=null&&(T.get!=null||T.set!=null))Object.defineProperty(e,P,{get:T.get,set:T.set,enumerable:c,configurable:g});else{let x=i[y];if(a&&$.isFunction(x)){let D=i[y];x=function(){return D(this,...arguments)},Object.defineProperty(x,"name",{value:P})}Object.defineProperty(e,P,{value:x,enumerable:c,writable:d,configurable:g})}}}var Ce={injectProperties:hP};function Rl(){cP()}function De(i,e){return gt.create(...arguments)}function m(i,e,t){return p.create(...arguments)}function w(i,e,t,n){return zi.create(...arguments)}function z(i,e,t,n){return f.create(...arguments)}function j(i,e,t,n,o,s,a,l){return O.create(...arguments)}function wE(i,e,t,n,o,s,a,l,h){return Y.create(...arguments)}function be(i,e,t,n,o,s,a,l,h,_,y,c,d,g,P,T){return V.create(...arguments)}function cP(){let i={};i.pp_first=function(){return q.first(this,...arguments)},i.pp_last=function(){return q.last(this,...arguments)},i.pp_has=function(c){return q.has(this,...arguments)},i.pp_hasEqual=function(c,d=null){return q.hasEqual(this,...arguments)},i.pp_find=function(c){return q.find(this,...arguments)},i.pp_findIndex=function(c){return q.findIndex(this,...arguments)},i.pp_findAll=function(c){return q.findAll(this,...arguments)},i.pp_findAllIndexes=function(c){return q.findAllIndexes(this,...arguments)},i.pp_findEqual=function(c,d=null){return q.findEqual(this,...arguments)},i.pp_findAllEqual=function(c,d=null){return q.findAllEqual(this,...arguments)},i.pp_findIndexEqual=function(c,d=null){return q.findIndexEqual(this,...arguments)},i.pp_findAllIndexesEqual=function(c,d=null){return q.findAllIndexesEqual(this,...arguments)},i.pp_removeIndex=function(c){return q.removeIndex(this,...arguments)},i.pp_removeAllIndexes=function(c){return q.removeAllIndexes(this,...arguments)},i.pp_remove=function(c){return q.remove(this,...arguments)},i.pp_removeAll=function(c){return q.removeAll(this,...arguments)},i.pp_removeEqual=function(c,d=null){return q.removeEqual(this,...arguments)},i.pp_removeAllEqual=function(c,d=null){return q.removeAllEqual(this,...arguments)},i.pp_pushUnique=function(c,d=null){return q.pushUnique(this,...arguments)},i.pp_unshiftUnique=function(c,d=null){return q.unshiftUnique(this,...arguments)},i.pp_copy=function(c,d=null){return q.copy(c,this,d)},i.pp_clone=function(c=null){return q.clone(this,...arguments)},i.pp_equals=function(c,d=null){return q.equals(this,...arguments)},i.pp_clear=function(){return q.clear(this,...arguments)};let e={};e.vec_toString=function(c=null){return At.toString(this,...arguments)},e.vec_log=function(c=4){return At.log(this,...arguments)},e.vec_error=function(c=4){return At.error(this,...arguments)},e.vec_warn=function(c=4){return At.warn(this,...arguments)},e.vec_scale=function(c,d=null){return At.scale(this,...arguments)},e.vec_round=function(c=null){return At.round(this,...arguments)},e.vec_floor=function(c=null){return At.floor(this,...arguments)},e.vec_ceil=function(c=null){return At.ceil(this,...arguments)},e.vec_clamp=function(c,d,g=null){return At.clamp(this,...arguments)},e.vec_equals=function(c,d=0){return At.equals(this,...arguments)};let t={};t.vec2_set=function(c,d){return gt.set(this,...arguments)},t.vec2_length=function(){return gt.length(this,...arguments)},t.vec2_normalize=function(c=gt.create()){return gt.normalize(this,...arguments)},t.vec2_copy=function(c){return gt.copy(c,this)},t.vec2_clone=function(c=gt.create()){return gt.clone(this,...arguments)},t.vec2_zero=function(){return gt.zero(this,...arguments)},t.vec2_isZero=function(c=0){return gt.isZero(this,...arguments)};let n={};n.vec3_set=function(c,d,g){return p.set(this,...arguments)},n.vec3_normalize=function(c=p.create()){return p.normalize(this,...arguments)},n.vec3_copy=function(c){return p.copy(c,this)},n.vec3_clone=function(c=p.create()){return p.clone(this,...arguments)},n.vec3_zero=function(){return p.zero(this,...arguments)},n.vec3_angle=function(c){return p.angle(this,...arguments)},n.vec3_angleDegrees=function(c){return p.angleDegrees(this,...arguments)},n.vec3_angleRadians=function(c){return p.angleRadians(this,...arguments)},n.vec3_equals=function(c,d=0){return p.equals(this,...arguments)},n.vec3_length=function(){return p.length(this,...arguments)},n.vec3_lengthSquared=function(){return p.lengthSquared(this,...arguments)},n.vec3_distance=function(c){return p.distance(this,...arguments)},n.vec3_distanceSquared=function(c){return p.distanceSquared(this,...arguments)},n.vec3_add=function(c,d=p.create()){return p.add(this,...arguments)},n.vec3_sub=function(c,d=p.create()){return p.sub(this,...arguments)},n.vec3_mul=function(c,d=p.create()){return p.mul(this,...arguments)},n.vec3_div=function(c,d=p.create()){return p.div(this,...arguments)},n.vec3_scale=function(c,d=p.create()){return p.scale(this,...arguments)},n.vec3_dot=function(c){return p.dot(this,...arguments)},n.vec3_negate=function(c=p.create()){return p.negate(this,...arguments)},n.vec3_cross=function(c,d=p.create()){return p.cross(this,...arguments)},n.vec3_transformQuat=function(c,d=p.create()){return p.transformQuat(this,...arguments)},n.vec3_transformMat3=function(c,d=p.create()){return p.transformMat3(this,...arguments)},n.vec3_transformMat4=function(c,d=p.create()){return p.transformMat4(this,...arguments)},n.vec3_lengthSigned=function(c){return p.lengthSigned(this,...arguments)},n.vec3_angleSigned=function(c,d){return p.angleSigned(this,...arguments)},n.vec3_angleSignedDegrees=function(c,d){return p.angleSignedDegrees(this,...arguments)},n.vec3_angleSignedRadians=function(c,d){return p.angleSignedRadians(this,...arguments)},n.vec3_toRadians=function(c=p.create()){return p.toRadians(this,...arguments)},n.vec3_toDegrees=function(c=p.create()){return p.toDegrees(this,...arguments)},n.vec3_toQuat=function(c){return p.toQuat(this,...arguments)},n.vec3_radiansToQuat=function(c=f.create()){return p.radiansToQuat(this,...arguments)},n.vec3_degreesToQuat=function(c=f.create()){return p.degreesToQuat(this,...arguments)},n.vec3_isNormalized=function(c=H.EPSILON){return p.isNormalized(this,...arguments)},n.vec3_isZero=function(c=0){return p.isZero(this,...arguments)},n.vec3_componentAlongAxis=function(c,d=p.create()){return p.componentAlongAxis(this,...arguments)},n.vec3_valueAlongAxis=function(c){return p.valueAlongAxis(this,...arguments)},n.vec3_removeComponentAlongAxis=function(c,d=p.create()){return p.removeComponentAlongAxis(this,...arguments)},n.vec3_copyComponentAlongAxis=function(c,d,g=p.create()){return p.copyComponentAlongAxis(c,this,d,g)},n.vec3_isConcordant=function(c){return p.isConcordant(this,...arguments)},n.vec3_isFartherAlongAxis=function(c,d){return p.isFartherAlongAxis(this,...arguments)},n.vec3_isToTheRight=function(c,d){return p.isToTheRight(this,...arguments)},n.vec3_signTo=function(c,d,g=1){return p.signTo(this,...arguments)},n.vec3_projectOnAxis=function(c,d=p.create()){return p.projectOnAxis(this,...arguments)},n.vec3_projectOnAxisAlongAxis=function(c,d,g=p.create()){return p.projectOnAxisAlongAxis(this,...arguments)},n.vec3_projectOnPlane=function(c,d=p.create()){return p.projectOnPlane(this,...arguments)},n.vec3_projectOnPlaneAlongAxis=function(c,d,g=p.create()){return p.projectOnPlaneAlongAxis(this,...arguments)},n.vec3_isOnAxis=function(c){return p.isOnAxis(this,...arguments)},n.vec3_isOnPlane=function(c){return p.isOnPlane(this,...arguments)},n.vec3_rotate=function(c,d){return p.rotate(this,...arguments)},n.vec3_rotateDegrees=function(c,d){return p.rotateDegrees(this,...arguments)},n.vec3_rotateRadians=function(c,d){return p.rotateRadians(this,...arguments)},n.vec3_rotateQuat=function(c,d){return p.rotateQuat(this,...arguments)},n.vec3_rotateAxis=function(c,d,g){return p.rotateAxis(this,...arguments)},n.vec3_rotateAxisDegrees=function(c,d,g){return p.rotateAxisDegrees(this,...arguments)},n.vec3_rotateAxisRadians=function(c,d,g){return p.rotateAxisRadians(this,...arguments)},n.vec3_rotateAround=function(c,d,g){return p.rotateAround(this,...arguments)},n.vec3_rotateAroundDegrees=function(c,d,g=p.create()){return p.rotateAroundDegrees(this,...arguments)},n.vec3_rotateAroundRadians=function(c,d,g=p.create()){return p.rotateAroundRadians(this,...arguments)},n.vec3_rotateAroundQuat=function(c,d,g=p.create()){return p.rotateAroundQuat(this,...arguments)},n.vec3_rotateAroundAxis=function(c,d,g,P){return p.rotateAroundAxis(this,...arguments)},n.vec3_rotateAroundAxisDegrees=function(c,d,g,P){return p.rotateAroundAxisDegrees(this,...arguments)},n.vec3_rotateAroundAxisRadians=function(c,d,g,P=p.create()){return p.rotateAroundAxisRadians(this,...arguments)},n.vec3_convertPositionToWorld=function(c,d){return p.convertPositionToWorld(this,...arguments)},n.vec3_convertPositionToLocal=function(c,d){return p.convertPositionToLocal(this,...arguments)},n.vec3_convertPositionToWorldMatrix=function(c,d=p.create()){return p.convertPositionToWorldMatrix(this,...arguments)},n.vec3_convertPositionToLocalMatrix=function(c,d=p.create()){return p.convertPositionToLocalMatrix(this,...arguments)},n.vec3_convertPositionToWorldQuat=function(c,d=p.create()){return p.convertPositionToWorldQuat(this,...arguments)},n.vec3_convertPositionToLocalQuat=function(c,d=p.create()){return p.convertPositionToLocalQuat(this,...arguments)},n.vec3_convertDirectionToWorld=function(c,d){return p.convertDirectionToWorld(this,...arguments)},n.vec3_convertDirectionToLocal=function(c,d){return p.convertDirectionToLocal(this,...arguments)},n.vec3_convertDirectionToWorldMatrix=function(c,d=p.create()){return p.convertDirectionToWorldMatrix(this,...arguments)},n.vec3_convertDirectionToLocalMatrix=function(c,d=p.create()){return p.convertDirectionToLocalMatrix(this,...arguments)},n.vec3_convertDirectionToWorldQuat=function(c,d=p.create()){return p.convertDirectionToWorldQuat(this,...arguments)},n.vec3_convertDirectionToLocalQuat=function(c,d=p.create()){return p.convertDirectionToLocalQuat(this,...arguments)},n.vec3_addRotation=function(c,d){return p.addRotation(this,...arguments)},n.vec3_addRotationDegrees=function(c,d){return p.addRotationDegrees(this,...arguments)},n.vec3_addRotationRadians=function(c,d){return p.addRotationRadians(this,...arguments)},n.vec3_addRotationQuat=function(c,d){return p.addRotationQuat(this,...arguments)},n.vec3_degreesAddRotation=function(c,d){return p.degreesAddRotation(this,...arguments)},n.vec3_degreesAddRotationDegrees=function(c,d=p.create()){return p.degreesAddRotationDegrees(this,...arguments)},n.vec3_degreesAddRotationRadians=function(c,d=p.create()){return p.degreesAddRotationRadians(this,...arguments)},n.vec3_degreesAddRotationQuat=function(c,d=p.create()){return p.degreesAddRotationQuat(this,...arguments)},n.vec3_radiansAddRotation=function(c,d){return p.radiansAddRotation(this,...arguments)},n.vec3_radiansAddRotationDegrees=function(c,d=p.create()){return p.radiansAddRotationDegrees(this,...arguments)},n.vec3_radiansAddRotationRadians=function(c,d=p.create()){return p.radiansAddRotationRadians(this,...arguments)},n.vec3_radiansAddRotationQuat=function(c,d=p.create()){return p.radiansAddRotationQuat(this,...arguments)},n.vec3_toMatrix=function(c=Y.create()){return p.toMatrix(this,...arguments)},n.vec3_degreesToMatrix=function(c=Y.create()){return p.degreesToMatrix(this,...arguments)},n.vec3_radiansToMatrix=function(c=Y.create()){return p.radiansToMatrix(this,...arguments)},n.vec3_rotationTo=function(c,d){return p.rotationTo(this,...arguments)},n.vec3_rotationToDegrees=function(c,d=p.create()){return p.rotationToDegrees(this,...arguments)},n.vec3_rotationToRadians=function(c,d=p.create()){return p.rotationToRadians(this,...arguments)},n.vec3_rotationToQuat=function(c,d=f.create()){return p.rotationToQuat(this,...arguments)},n.vec3_rotationToPivoted=function(c,d,g){return p.rotationToPivoted(this,...arguments)},n.vec3_rotationToPivotedDegrees=function(c,d,g=p.create()){return p.rotationToPivotedDegrees(this,...arguments)},n.vec3_rotationToPivotedRadians=function(c,d,g=p.create()){return p.rotationToPivotedRadians(this,...arguments)},n.vec3_rotationToPivotedQuat=function(c,d,g=f.create()){return p.rotationToPivotedQuat(this,...arguments)},n.vec3_lerp=function(c,d,g=p.create()){return p.lerp(this,...arguments)},n.vec3_interpolate=function(c,d,g=ue.linear,P=p.create()){return p.interpolate(this,...arguments)},n.vec3_perpendicularRandom=function(c=p.create()){return p.perpendicularRandom(this,...arguments)};let o={};o.vec4_set=function(c,d,g,P){return zi.set(this,...arguments)},o.vec4_copy=function(c){return zi.set(c,this)},o.vec4_clone=function(c=zi.create()){return zi.set(this,...arguments)};let s={};s.quat_set=function(c,d,g,P){return f.set(this,...arguments)},s.quat_normalize=function(c=f.create()){return f.normalize(this,...arguments)},s.quat_copy=function(c){return f.copy(c,this)},s.quat_clone=function(c=f.create()){return f.clone(this,...arguments)},s.quat_identity=function(){return f.identity(this,...arguments)},s.quat_length=function(){return f.length(this,...arguments)},s.quat_lengthSquared=function(){return f.lengthSquared(this,...arguments)},s.quat_invert=function(c=f.create()){return f.invert(this,...arguments)},s.quat_conjugate=function(c=f.create()){return f.conjugate(this,...arguments)},s.quat_mul=function(c,d=f.create()){return f.mul(this,...arguments)},s.quat_getAxis=function(c=p.create()){return f.getAxis(this,...arguments)},s.quat_getAngle=function(){return f.getAngle(this,...arguments)},s.quat_getAngleDegrees=function(){return f.getAngleDegrees(this,...arguments)},s.quat_getAngleRadians=function(){return f.getAngleRadians(this,...arguments)},s.quat_getAxisScaled=function(c=p.create()){return f.getAxisScaled(this,...arguments)},s.quat_getAxisScaledDegrees=function(c=p.create()){return f.getAxisScaledDegrees(this,...arguments)},s.quat_getAxisScaledRadians=function(c=p.create()){return f.getAxisScaledRadians(this,...arguments)},s.quat_getAxes=function(c=[p.create(),p.create(),p.create()]){return f.getAxes(this,...arguments)},s.quat_getForward=function(c=p.create()){return f.getForward(this,...arguments)},s.quat_getBackward=function(c){return f.getBackward(this,...arguments)},s.quat_getLeft=function(c=p.create()){return f.getLeft(this,...arguments)},s.quat_getRight=function(c){return f.getRight(this,...arguments)},s.quat_getUp=function(c=p.create()){return f.getUp(this,...arguments)},s.quat_getDown=function(c){return f.getDown(this,...arguments)},s.quat_setAxes=function(c,d,g){return f.setAxes(this,...arguments)},s.quat_setForward=function(c,d=null,g=null){return f.setForward(this,...arguments)},s.quat_setBackward=function(c,d=null,g=null){return f.setBackward(this,...arguments)},s.quat_setUp=function(c,d=null,g=null){return f.setUp(this,...arguments)},s.quat_setDown=function(c,d=null,g=null){return f.setDown(this,...arguments)},s.quat_setLeft=function(c,d=null,g=null){return f.setLeft(this,...arguments)},s.quat_setRight=function(c,d=null,g=null){return f.setRight(this,...arguments)},s.quat_toWorld=function(c,d=f.create()){return f.toWorld(this,...arguments)},s.quat_toLocal=function(c,d=f.create()){return f.toLocal(this,...arguments)},s.quat_fromAxis=function(c,d){return f.fromAxis(c,d,this)},s.quat_fromAxisDegrees=function(c,d){return f.fromAxisDegrees(c,d,this)},s.quat_fromAxisRadians=function(c,d){return f.fromAxisRadians(c,d,this)},s.quat_fromAxes=function(c,d,g){return f.fromAxes(c,d,g,this)},s.quat_fromRadians=function(c){return f.fromRadians(c,this)},s.quat_fromDegrees=function(c){return f.fromDegrees(c,this)},s.quat_toRadians=function(c=p.create()){return f.toRadians(this,...arguments)},s.quat_toDegrees=function(c=p.create()){return f.toDegrees(this,...arguments)},s.quat_isNormalized=function(c=H.EPSILON){return f.isNormalized(this,...arguments)},s.quat_addRotation=function(c,d){return f.addRotation(this,...arguments)},s.quat_addRotationDegrees=function(c,d){return f.addRotationDegrees(this,...arguments)},s.quat_addRotationRadians=function(c,d){return f.addRotationRadians(this,...arguments)},s.quat_addRotationQuat=function(c,d=f.create()){return f.addRotationQuat(this,...arguments)},s.quat_subRotation=function(c,d){return f.subRotation(this,...arguments)},s.quat_subRotationDegrees=function(c,d){return f.subRotationDegrees(this,...arguments)},s.quat_subRotationRadians=function(c,d){return f.subRotationRadians(this,...arguments)},s.quat_subRotationQuat=function(c,d=f.create()){return f.subRotationQuat(this,...arguments)},s.quat_rotationTo=function(c,d){return f.rotationTo(this,...arguments)},s.quat_rotationToDegrees=function(c,d){return f.rotationToDegrees(this,...arguments)},s.quat_rotationToRadians=function(c,d){return f.rotationToRadians(this,...arguments)},s.quat_rotationToQuat=function(c,d){return f.rotationToQuat(this,...arguments)},s.quat_getTwist=function(c,d=f.create()){return f.getTwist(this,...arguments)},s.quat_getSwing=function(c,d=f.create()){return f.getSwing(this,...arguments)},s.quat_getSwingFromTwist=function(c,d=f.create()){return f.getSwingFromTwist(this,...arguments)},s.quat_getTwistFromSwing=function(c,d=f.create()){return f.getTwistFromSwing(this,...arguments)},s.quat_fromTwistSwing=function(c,d){return f.fromTwistSwing(c,d,this)},s.quat_toMatrix=function(c=Y.create()){return f.toMatrix(this,...arguments)},s.quat_rotate=function(c,d){return f.rotate(this,...arguments)},s.quat_rotateDegrees=function(c,d){return f.rotateDegrees(this,...arguments)},s.quat_rotateRadians=function(c,d){return f.rotateRadians(this,...arguments)},s.quat_rotateQuat=function(c,d){return f.rotateQuat(this,...arguments)},s.quat_rotateAxis=function(c,d,g){return f.rotateAxis(this,...arguments)},s.quat_rotateAxisDegrees=function(c,d,g){return f.rotateAxisDegrees(this,...arguments)},s.quat_rotateAxisRadians=function(c,d,g){return f.rotateAxisRadians(this,...arguments)},s.quat_lerp=function(c,d,g=f.create()){return f.lerp(this,...arguments)},s.quat_interpolate=function(c,d,g=ue.linear,P=f.create()){return f.interpolate(this,...arguments)},s.quat_slerp=function(c,d,g=f.create()){return f.slerp(this,...arguments)},s.quat_sinterpolate=function(c,d,g=ue.linear,P=f.create()){return f.sinterpolate(this,...arguments)};let a={};a.quat2_set=function(c,d,g,P,T,C,x,D){return O.set(this,...arguments)},a.quat2_normalize=function(c=O.create()){return O.normalize(this,...arguments)},a.quat2_invert=function(c=O.create()){return O.invert(this,...arguments)},a.quat2_conjugate=function(c=O.create()){return O.conjugate(this,...arguments)},a.quat2_copy=function(c){return O.copy(c,this)},a.quat2_identity=function(){return O.identity(this,...arguments)},a.quat2_getPosition=function(c=p.create()){return O.getPosition(this,...arguments)},a.quat2_getRotation=function(c){return O.getRotation(this,...arguments)},a.quat2_getRotationDegrees=function(c=p.create()){return O.getRotationDegrees(this,...arguments)},a.quat2_getRotationRadians=function(c=p.create()){return O.getRotationRadians(this,...arguments)},a.quat2_getRotationQuat=function(c=f.create()){return O.getRotationQuat(this,...arguments)},a.quat2_setPosition=function(c){return O.setPosition(this,...arguments)},a.quat2_setRotation=function(c){return O.setRotation(this,...arguments)},a.quat2_setRotationDegrees=function(c){return O.setRotationDegrees(this,...arguments)},a.quat2_setRotationRadians=function(c){return O.setRotationRadians(this,...arguments)},a.quat2_setRotationQuat=function(c){return O.setRotationQuat(this,...arguments)},a.quat2_setPositionRotation=function(c,d){return O.setPositionRotation(this,...arguments)},a.quat2_setPositionRotationDegrees=function(c,d){return O.setPositionRotationDegrees(this,...arguments)},a.quat2_setPositionRotationRadians=function(c,d){return O.setPositionRotationRadians(this,...arguments)},a.quat2_setPositionRotationQuat=function(c,d){return O.setPositionRotationQuat(this,...arguments)},a.quat2_isNormalized=function(c=H.EPSILON){return O.isNormalized(this,...arguments)},a.quat2_length=function(){return O.length(this,...arguments)},a.quat2_lengthSquared=function(){return O.lengthSquared(this,...arguments)},a.quat2_mul=function(c,d=O.create()){return O.mul(this,...arguments)},a.quat2_getAxes=function(c=[p.create(),p.create(),p.create()]){return O.getAxes(this,...arguments)},a.quat2_getForward=function(c=p.create()){return O.getForward(this,...arguments)},a.quat2_getBackward=function(c){return O.getBackward(this,...arguments)},a.quat2_getLeft=function(c=p.create()){return O.getLeft(this,...arguments)},a.quat2_getRight=function(c){return O.getRight(this,...arguments)},a.quat2_getUp=function(c=p.create()){return O.getUp(this,...arguments)},a.quat2_getDown=function(c){return O.getDown(this,...arguments)},a.quat2_toWorld=function(c,d=O.create()){return O.toWorld(this,...arguments)},a.quat2_toLocal=function(c,d=O.create()){return O.toLocal(this,...arguments)},a.quat2_rotateAxis=function(c,d,g){return O.rotateAxis(this,...arguments)},a.quat2_rotateAxisDegrees=function(c,d,g){return O.rotateAxisDegrees(this,...arguments)},a.quat2_rotateAxisRadians=function(c,d,g){return O.rotateAxisRadians(this,...arguments)},a.quat2_toMatrix=function(c=V.create()){return O.toMatrix(this,...arguments)},a.quat2_fromMatrix=function(c){return O.fromMatrix(c,this)},a.quat2_lerp=function(c,d,g=O.create()){return O.lerp(this,...arguments)},a.quat2_interpolate=function(c,d,g=ue.linear,P=O.create()){return O.interpolate(this,...arguments)};let l={};l.mat3_set=function(c,d,g,P,T,C,x,D,E){return Y.set(this,...arguments)},l.mat3_toDegrees=function(c=p.create()){return Y.toDegrees(this,...arguments)},l.mat3_toRadians=function(c=p.create()){return Y.toRadians(this,...arguments)},l.mat3_toQuat=function(c=f.create()){return Y.toQuat(this,...arguments)},l.mat3_fromAxes=function(c,d,g){return Y.fromAxes(c,d,g,this)};let h={};h.mat4_set=function(c,d,g,P,T,C,x,D,E,S,b,v,I,L,F,Q){return V.set(this,...arguments)},h.mat4_copy=function(c){return V.copy(c,this)},h.mat4_identity=function(){return V.identity(this,...arguments)},h.mat4_invert=function(c=V.create()){return V.invert(this,...arguments)},h.mat4_mul=function(c,d=V.create()){return V.mul(this,...arguments)},h.mat4_scale=function(c,d=V.create()){return V.scale(this,...arguments)},h.mat4_clone=function(c=V.create()){return V.clone(this,...arguments)},h.mat4_getPosition=function(c=p.create()){return V.getPosition(this,...arguments)},h.mat4_getRotation=function(c=p.create()){return V.getRotation(this,...arguments)},h.mat4_getRotationDegrees=function(c=p.create()){return V.getRotationDegrees(this,...arguments)},h.mat4_getRotationRadians=function(c=p.create()){return V.getRotationRadians(this,...arguments)},h.mat4_getRotationQuat=function(c=f.create()){return V.getRotationQuat(this,...arguments)},h.mat4_getScale=function(c=p.create()){return V.getScale(this,...arguments)},h.mat4_setPosition=function(c){return V.setPosition(this,...arguments)},h.mat4_setRotation=function(c){return V.setRotation(this,...arguments)},h.mat4_setRotationDegrees=function(c){return V.setRotationDegrees(this,...arguments)},h.mat4_setRotationRadians=function(c){return V.setRotationRadians(this,...arguments)},h.mat4_setRotationQuat=function(c){return V.setRotationQuat(this,...arguments)},h.mat4_setScale=function(c){return V.setScale(this,...arguments)},h.mat4_setPositionRotationScale=function(c,d,g){return V.setPositionRotationScale(this,...arguments)},h.mat4_setPositionRotationDegreesScale=function(c,d,g){return V.setPositionRotationDegreesScale(this,...arguments)},h.mat4_setPositionRotationRadiansScale=function(c,d,g){return V.setPositionRotationRadiansScale(this,...arguments)},h.mat4_setPositionRotationQuatScale=function(c,d,g){return V.setPositionRotationQuatScale(this,...arguments)},h.mat4_setPositionRotation=function(c,d){return V.setPositionRotation(this,...arguments)},h.mat4_setPositionRotationDegrees=function(c,d){return V.setPositionRotationDegrees(this,...arguments)},h.mat4_setPositionRotationRadians=function(c,d){return V.setPositionRotationRadians(this,...arguments)},h.mat4_setPositionRotationQuat=function(c,d){return V.setPositionRotationQuat(this,...arguments)},h.mat4_getAxes=function(c=[p.create(),p.create(),p.create()]){return V.getAxes(this,...arguments)},h.mat4_getForward=function(c=p.create()){return V.getForward(this,...arguments)},h.mat4_getBackward=function(c){return V.getBackward(this,...arguments)},h.mat4_getLeft=function(c=p.create()){return V.getLeft(this,...arguments)},h.mat4_getRight=function(c){return V.getRight(this,...arguments)},h.mat4_getUp=function(c=p.create()){return V.getUp(this,...arguments)},h.mat4_getDown=function(c){return V.getDown(this,...arguments)},h.mat4_toWorld=function(c,d=V.create()){return V.toWorld(this,...arguments)},h.mat4_toLocal=function(c,d=V.create()){return V.toLocal(this,...arguments)},h.mat4_hasUniformScale=function(){return V.hasUniformScale(this,...arguments)},h.mat4_toQuat=function(c=O.create()){return V.toQuat(this,...arguments)},h.mat4_fromQuat=function(c){return V.fromQuat(c,this)};let _=[Array.prototype,Uint8ClampedArray.prototype,Uint8Array.prototype,Uint16Array.prototype,Uint32Array.prototype,Int8Array.prototype,Int16Array.prototype,Int32Array.prototype,Float32Array.prototype,Float64Array.prototype];for(let y of _)Ce.injectProperties(i,y,!1,!0,!0),Ce.injectProperties(e,y,!1,!0,!0),Ce.injectProperties(t,y,!1,!0,!0),Ce.injectProperties(n,y,!1,!0,!0),Ce.injectProperties(o,y,!1,!0,!0),Ce.injectProperties(s,y,!1,!0,!0),Ce.injectProperties(a,y,!1,!0,!0),Ce.injectProperties(l,y,!1,!0,!0),Ce.injectProperties(h,y,!1,!0,!0),Ce.injectProperties(i,y,!1,!0,!0)}var ko=class{constructor(){this.myPosition=null,this.myTextureCoordinates=null,this.myNormal=null,this.myColor=null}},Ni=class{constructor(){this.myIndexes=new Uint32Array(3)}},Fo=class{constructor(e=r.getMainEngine()){this.myVertexes=[],this.myTriangles=[],this.myEngine=e}};function jE(i){let e=[];for(let _ of i.myTriangles)e.push(_.myIndexes[0]),e.push(_.myIndexes[1]),e.push(_.myIndexes[2]);let t=new Uint32Array(e.length);t.pp_copy(e);let n=i.myVertexes.length,o=new Al(i.myEngine,{vertexCount:n,indexData:t,indexType:Vl.UnsignedInt}),s=null,a=null,l=null,h=null;try{s=o.attribute(ke.Position)}catch{s=null}try{a=o.attribute(ke.TextureCoordinate)}catch{a=null}try{l=o.attribute(ke.Normal)}catch{l=null}try{h=o.attribute(ke.Color)}catch{h=null}for(let _=0;_<i.myVertexes.length;_++){let y=i.myVertexes[_];s!=null&&y.myPosition&&s.set(_,y.myPosition),a!=null&&y.myTextureCoordinates&&a.set(_,y.myTextureCoordinates),l!=null&&y.myNormal&&l.set(_,y.myNormal),h!=null&&y.myColor&&h.set(_,y.myColor)}return o}var zE=function(){let i=m(),e=De(),t=m(),n=w();return function(s){if(s==null)return null;let a=s.indexData.pp_clone(),l=new Al(s.engine,{vertexCount:s.vertexCount,indexData:a,indexType:Vl.UnsignedInt}),h=null,_=null,y=null,c=null,d=null,g=null,P=null,T=null;try{h=s.attribute(ke.Position),d=l.attribute(ke.Position)}catch{h=null,d=null}try{_=s.attribute(ke.TextureCoordinate),g=l.attribute(ke.TextureCoordinate)}catch{_=null,g=null}try{y=s.attribute(ke.Normal),P=l.attribute(ke.Normal)}catch{y=null,P=null}try{c=s.attribute(ke.Color),T=l.attribute(ke.Color)}catch{c=null,T=null}for(let C=0;C<s.vertexCount;C++)h!=null&&d!=null&&d.set(C,h.get(C,i)),_!=null&&g!=null&&g.set(C,_.get(C,e)),y!=null&&P!=null&&P.set(C,y.get(C,t)),c!=null&&T!=null&&T.set(C,c.get(C,n));return l}}(),NE=function(){let i=m(),e=De(),t=m(),n=w();return function(s){if(s==null)return null;let a=new Uint32Array(s.indexData.length);for(let C=0;C<s.indexData.length/3;C++)a[C*3+0]=s.indexData[C*3+2],a[C*3+1]=s.indexData[C*3+1],a[C*3+2]=s.indexData[C*3+0];let l=new Al(s.engine,{vertexCount:s.vertexCount,indexData:a,indexType:Vl.UnsignedInt}),h=null,_=null,y=null,c=null,d=null,g=null,P=null,T=null;try{h=s.attribute(ke.Position),d=l.attribute(ke.Position)}catch{h=null,d=null}try{_=s.attribute(ke.TextureCoordinate),g=l.attribute(ke.TextureCoordinate)}catch{_=null,g=null}try{y=s.attribute(ke.Normal),P=l.attribute(ke.Normal)}catch{y=null,P=null}try{c=s.attribute(ke.Color),T=l.attribute(ke.Color)}catch{c=null,T=null}for(let C=0;C<s.vertexCount;C++)h!=null&&d!=null&&d.set(C,h.get(C,i)),_!=null&&g!=null&&g.set(C,_.get(C,e)),y!=null&&P!=null&&(y.get(C,t),t.vec3_negate(t),P.set(C,t)),c!=null&&T!=null&&T.set(C,c.get(C,n));return l}}();function pP(i=r.getMainEngine()){let e=4,t=new Fo(i);for(let a=0;a<e;++a){let l=new ko;l.myPosition=new m,l.myPosition[0]=-1+(a&1)*2,l.myPosition[1]=-1+((a&2)>>1)*2,l.myPosition[2]=0,l.myTextureCoordinates=new De,l.myTextureCoordinates[0]=a&1,l.myTextureCoordinates[1]=(a&2)>>1,l.myNormal=new m,l.myNormal[0]=0,l.myNormal[1]=0,l.myNormal[2]=1,t.myVertexes.push(l)}let n=new Ni;n.myIndexes[0]=0,n.myIndexes[1]=1,n.myIndexes[2]=2;let o=new Ni;return o.myIndexes[0]=2,o.myIndexes[1]=1,o.myIndexes[2]=3,t.myTriangles.push(n),t.myTriangles.push(o),Xe.create(t)}var Xe={create:jE,clone:zE,invert:NE,createPlane:pP};function gP(i,e,t=new Yt,n=null){let o=N.cloneDefault(i,e,!0);return t.isDeepCloneComponentVariable(dP.TypeName,"material")&&(o.material=i.material.clone()),t.isDeepCloneComponentVariable(dP.TypeName,"mesh")&&(o.mesh=Xe.clone(i.mesh)),o}function fP(i,e,t=new Yt,n=null){return N.cloneDefault(i,e)}function PP(i,e,t=new Yt,n=null){let o=N.cloneDefault(i,e);return t.isDeepCloneComponent(_P.TypeName)&&(o.text=i.text.slice(0)),t.isDeepCloneComponentVariable(_P.TypeName,"material")&&(o.material=i.material.clone()),o}function CP(i,e,t=new Yt,n=null){return N.cloneDefault(i,e)}var wo={cloneMesh:gP,cloneCollision:fP,cloneText:PP,clonePhysX:CP};var di=new WeakMap,_i=new WeakMap,Yt=class{constructor(){this._myDeepCloneComponents=!1,this._myDeepCloneOverrideComponentsMap=new Map,this._myDeepCloneOverrideComponentsVariablesMap=new Map}setDeepCloneComponents(e){this._myDeepCloneComponents=e}setDeepCloneComponent(e,t){this._myDeepCloneOverrideComponentsMap.set(e,t)}setDeepCloneComponentVariable(e,t,n){let o=null;this._myDeepCloneOverrideComponentsVariablesMap.has(e)||this._myDeepCloneOverrideComponentsVariablesMap.set(e,new Map),o=this._myDeepCloneOverrideComponentsVariablesMap.get(e),o.set(t,n)}isDeepCloneComponent(e){let t=this._myDeepCloneOverrideComponentsMap.get(e);return t??this._myDeepCloneComponents}isDeepCloneComponentVariable(e,t){let n=this._myDeepCloneOverrideComponentsVariablesMap.get(e);if(n!=null){let o=n.get(t);if(o!=null)return o}return this.isDeepCloneComponent(e)}},Ts=class{constructor(){this._myParams=new Map}addParam(e,t){this._myParams.set(e,t)}removeParam(e){this._myParams.delete(e)}getParam(e){this._myParams.get(e)}hasParam(e){this._myParams.has(e)}};function TP(i){return N.isWLNativeComponent(i)||N.isWLJavascriptComponent(i)}function bP(i){let e=!1,t=N.getTypeFromTypeOrClass(i);return N.getWLNativeComponentTypes().includes(t)&&(e=!0),e}function SP(i){let e=!1,t=N.getTypeFromTypeOrClass(i);return N.getWLJavascriptComponentTypes().includes(t)&&(e=!0),e}function vP(){return dD}function xP(){return _D}function MP(i){if(i==null)return;let e=i;return i.TypeName!=null&&(e=i.TypeName),e}function EP(i){let e=null;if(N.isWLNativeComponent(i)){if(N.isWLNativeComponentRegistered(i))switch(i){case Ol.TypeName:e=Ol;break;case Ar.TypeName:e=Ar;break;case Bl.TypeName:e=Bl;break;case Il.TypeName:e=Il;break;case Vr.TypeName:e=Vr;break;case Or.TypeName:e=Or;break;case Br.TypeName:e=Br;break;case Hl.TypeName:e=Hl;break;default:e=null}}else e=N.getJavascriptComponentClass(i);return e}function DP(i){let e=N.getTypeFromTypeOrClass(i);return N.getClassFromType(e)!=null}function RP(i=r.getMainEngine()){return r.getWASM(i)._components}function AP(i,e=r.getMainEngine()){return N.getJavascriptComponentClassesByIndex(e)[N.getJavascriptComponentTypeIndex(i)]}function VP(i=r.getMainEngine()){return r.getWASM(i)._componentTypes}function OP(i,e=r.getMainEngine()){let t=N.getTypeFromTypeOrClass(i);return N.getJavascriptComponentTypeIndexes(e)[t]}function BP(i=r.getMainEngine()){return r.getWASM(i)._componentTypeIndices}function IP(i,e=r.getMainEngine()){let t=null,n=N.getJavascriptComponentClassesByIndex(e)[i];return n!=null&&(t=n.TypeName),t}function HP(i,e=r.getMainEngine()){let t=r.getWASM(e),n=N.getTypeFromTypeOrClass(i);return t._wl_get_component_manager_index(t.tempUTF8(n))>=0}function cD(i,e=!1){let t=N.getTypeFromTypeOrClass(i);return e||N.hasCloneCallback(t)||N.getClassFromType(t)?.prototype.pp_clone!=null}function LP(i){let e=N.getTypeFromTypeOrClass(i);return N.hasClonePostProcessCallback(e)||N.getClassFromType(e)?.prototype.pp_clonePostProcess!=null}function pD(i,e,t,n,o=!1,s=!0){let a=null,l=N.getCloneCallback(i.type);return l!=null?a=l(i,e,t,n):i.pp_clone!=null?a=i.pp_clone(e,t,n):o&&(a=N.cloneDefault(i,e,s)),a}function kP(i,e,t,n){let o=N.getClonePostProcessCallback(i.type);return o!=null?o(i,e,t,n):i.pp_clonePostProcess!=null&&i.pp_clonePostProcess(e,t,n),e}function FP(i,e,t=!0){let n=u.addComponent(e,i.type,i);return t&&!n.active&&(n.active=!0,n.active=!1),n}function wP(i,e,t=r.getMainEngine()){let n=N.getTypeFromTypeOrClass(i);di.has(t)||di.set(t,new Map),di.get(t).set(n,e)}function jP(i,e=r.getMainEngine()){let t=N.getTypeFromTypeOrClass(i);di.has(e)&&di.get(e).delete(t)}function zP(i,e=r.getMainEngine()){let t=null,n=N.getTypeFromTypeOrClass(i);return di.has(e)&&(t=di.get(e).get(n)),t}function NP(i,e=r.getMainEngine()){let t=!1,n=N.getTypeFromTypeOrClass(i);return di.has(e)&&(t=di.get(e).has(n)),t}function GP(i,e,t=r.getMainEngine()){let n=N.getTypeFromTypeOrClass(i);_i.has(t)||_i.set(t,new Map),_i.get(t).set(n,e)}function UP(i,e=r.getMainEngine()){let t=N.getTypeFromTypeOrClass(i);_i.has(e)&&_i.get(e).delete(t)}function WP(i,e=r.getMainEngine()){let t=null,n=N.getTypeFromTypeOrClass(i);return _i.has(e)&&(t=_i.get(e).get(n)),t}function QP(i,e=r.getMainEngine()){let t=!1,n=N.getTypeFromTypeOrClass(i);return _i.has(e)&&(t=_i.get(e).has(n)),t}function qP(i,e=r.getMainEngine()){let t=null;switch(N.getTypeFromTypeOrClass(i)){case Vr.TypeName:t=wo.cloneMesh;break;case Ar.TypeName:t=wo.cloneCollision;break;case Br.TypeName:t=wo.cloneText;break;case Or.TypeName:t=wo.clonePhysX;break;default:t=null}return t}function XP(i,e=r.getMainEngine()){return N.getDefaultWLComponentCloneCallback(i,e)!=null}function KP(i=r.getMainEngine()){for(let e of N.getWLNativeComponentTypes()){let t=N.getDefaultWLComponentCloneCallback(e,i);t!=null&&N.setCloneCallback(e,t,i)}for(let e of N.getWLJavascriptComponentTypes()){let t=N.getDefaultWLComponentCloneCallback(e,i);t!=null&&N.setCloneCallback(e,t,i)}}function JP(i=r.getMainEngine()){for(let e of N.getWLNativeComponentTypes()){let t=N.getDefaultWLComponentCloneCallback(e,i);t!=null&&N.getCloneCallback(e,i)==t&&N.removeCloneCallback(e,i)}for(let e of N.getWLNativeComponentTypes()){let t=N.getDefaultWLComponentCloneCallback(e,i);t!=null&&N.getCloneCallback(e,i)==t&&N.removeCloneCallback(e,i)}}var N={isWLComponent:TP,isWLNativeComponent:bP,isWLJavascriptComponent:SP,getWLNativeComponentTypes:vP,getWLJavascriptComponentTypes:xP,getTypeFromTypeOrClass:MP,getClassFromType:EP,isTypeRegistered:DP,getJavascriptComponentInstances:RP,getJavascriptComponentClass:AP,getJavascriptComponentClassesByIndex:VP,getJavascriptComponentTypeIndex:OP,getJavascriptComponentTypeIndexes:BP,getJavascriptComponentTypeFromIndex:IP,isWLNativeComponentRegistered:HP,isCloneable:cD,hasClonePostProcess:LP,clone:pD,clonePostProcess:kP,cloneDefault:FP,setCloneCallback:wP,removeCloneCallback:jP,getCloneCallback:zP,hasCloneCallback:NP,setClonePostProcessCallback:GP,removeClonePostProcessCallback:UP,getClonePostProcessCallback:WP,hasClonePostProcessCallback:QP,setDefaultWLComponentCloneCallbacks:KP,removeDefaultWLComponentCloneCallbacks:JP,getDefaultWLComponentCloneCallback:qP,hasDefaultWLComponentCloneCallback:XP},dD=[Ol.TypeName,Ar.TypeName,Bl.TypeName,Il.TypeName,Vr.TypeName,Or.TypeName,Br.TypeName,Hl.TypeName],_D=[GE.TypeName,UE.TypeName,WE.TypeName,QE.TypeName,qE.TypeName,XE.TypeName,KE.TypeName,JE.TypeName,ZE.TypeName,YE.TypeName,$E.TypeName,eD.TypeName,tD.TypeName,iD.TypeName,nD.TypeName,oD.TypeName,sD.TypeName,aD.TypeName,rD.TypeName,lD.TypeName,mD.TypeName,yD.TypeName,uD.TypeName,hD.TypeName];function Ll(){ZP()}function ZP(){let i={};Object.defineProperty(i,"PP_EPSILON",{get(){return H.EPSILON},set(e){H.EPSILON=e}}),Object.defineProperty(i,"PP_EPSILON_SQUARED",{get(){return H.EPSILON_SQUARED},set(e){H.EPSILON=e}}),Object.defineProperty(i,"PP_EPSILON_DEGREES",{get(){return H.EPSILON_DEGREES},set(e){H.EPSILON=e}}),i.pp_clamp=function(t,n,o){return H.clamp(...arguments)},i.pp_sign=function(t,n=1){return H.sign(...arguments)},i.pp_toDegrees=function(t){return H.toDegrees(...arguments)},i.pp_toRadians=function(t){return H.toRadians(...arguments)},i.pp_roundDecimal=function(t,n){return H.roundDecimal(...arguments)},i.pp_mapToRange=function(t,n,o,s,a){return H.mapToRange(...arguments)},i.pp_random=function(t=0,n=1){return H.random(...arguments)},i.pp_randomInt=function(t,n){return H.randomInt(...arguments)},i.pp_randomBool=function(){return H.randomBool(...arguments)},i.pp_randomSign=function(){return H.randomSign(...arguments)},i.pp_randomPick=function(...t){return H.randomPick(...arguments)},i.pp_lerp=function(t,n,o){return H.lerp(...arguments)},i.pp_interpolate=function(t,n,o,s=ue.linear){return H.interpolate(...arguments)},i.pp_angleDistance=function(t,n){return H.angleDistance(...arguments)},i.pp_angleDistanceDegrees=function(t,n){return H.angleDistanceDegrees(...arguments)},i.pp_angleDistanceRadians=function(t,n){return H.angleDistanceRadians(...arguments)},i.pp_angleDistanceSigned=function(t,n){return H.angleDistanceSigned(...arguments)},i.pp_angleDistanceSignedDegrees=function(t,n){return H.angleDistanceSignedDegrees(...arguments)},i.pp_angleDistanceSignedRadians=function(t,n){return H.angleDistanceSignedRadians(...arguments)},i.pp_angleClamp=function(t,n=!1){return H.angleClamp(...arguments)},i.pp_angleClampDegrees=function(t,n=!1){return H.angleClampDegrees(...arguments)},i.pp_angleClampRadians=function(t,n=!1){return H.angleClampRadians(...arguments)},i.pp_isInsideAngleRange=function(t,n,o,s=!1){return H.isInsideAngleRange(...arguments)},i.pp_isInsideAngleRangeDegrees=function(t,n,o,s=!1){return H.isInsideAngleRangeDegrees(...arguments)},i.pp_isInsideAngleRangeRadians=function(t,n,o,s=!1){return H.isInsideAngleRangeRadians(...arguments)},Ce.injectProperties(i,Math,!1,!0,!0)}function kl(i){YP()}function YP(){let i={};i.get=function(){return this.valueOf()},Ce.injectProperties(i,Number.prototype,!1,!0,!0)}function Fl(){Ll(),Rl(),kl()}function wl(i){Fl(i)}import{Object3D as gD}from"@wonderlandengine/api";function jl(){$P()}function $P(){let i={};i.pp_getPosition=function(t){return u.getPosition(this,...arguments)},i.pp_getPositionWorld=function(t=p.create()){return u.getPositionWorld(this,...arguments)},i.pp_getPositionLocal=function(t=p.create()){return u.getPositionLocal(this,...arguments)},i.pp_getRotation=function(t){return u.getRotation(this,...arguments)},i.pp_getRotationDegrees=function(t){return u.getRotationDegrees(this,...arguments)},i.pp_getRotationRadians=function(t){return u.getRotationRadians(this,...arguments)},i.pp_getRotationMatrix=function(t){return u.getRotationMatrix(this,...arguments)},i.pp_getRotationQuat=function(t){return u.getRotationQuat(this,...arguments)},i.pp_getRotationWorld=function(t){return u.getRotationWorld(this,...arguments)},i.pp_getRotationWorldDegrees=function(t){return u.getRotationWorldDegrees(this,...arguments)},i.pp_getRotationWorldRadians=function(t=p.create()){return u.getRotationWorldRadians(this,...arguments)},i.pp_getRotationWorldMatrix=function(t=Y.create()){return u.getRotationWorldMatrix(this,...arguments)},i.pp_getRotationWorldQuat=function(t=f.create()){return u.getRotationWorldQuat(this,...arguments)},i.pp_getRotationLocal=function(t){return u.getRotationLocal(this,...arguments)},i.pp_getRotationLocalDegrees=function(t){return u.getRotationLocalDegrees(this,...arguments)},i.pp_getRotationLocalRadians=function(t=p.create()){return u.getRotationLocalRadians(this,...arguments)},i.pp_getRotationLocalMatrix=function(t=Y.create()){return u.getRotationLocalMatrix(this,...arguments)},i.pp_getRotationLocalQuat=function(t=f.create()){return u.getRotationLocalQuat(this,...arguments)},i.pp_getScale=function(t){return u.getScale(this,...arguments)},i.pp_getScaleWorld=function(t=p.create()){return u.getScaleWorld(this,...arguments)},i.pp_getScaleLocal=function(t=p.create()){return u.getScaleLocal(this,...arguments)},i.pp_getTransform=function(t){return u.getTransform(this,...arguments)},i.pp_getTransformMatrix=function(t){return u.getTransformMatrix(this,...arguments)},i.pp_getTransformQuat=function(t){return u.getTransformQuat(this,...arguments)},i.pp_getTransformWorld=function(t){return u.getTransformWorld(this,...arguments)},i.pp_getTransformWorldMatrix=function(t=V.create()){return u.getTransformWorldMatrix(this,...arguments)},i.pp_getTransformWorldQuat=function(t=O.create()){return u.getTransformWorldQuat(this,...arguments)},i.pp_getTransformLocal=function(t){return u.getTransformLocal(this,...arguments)},i.pp_getTransformLocalMatrix=function(t=V.create()){return u.getTransformLocalMatrix(this,...arguments)},i.pp_getTransformLocalQuat=function(t=O.create()){return u.getTransformLocalQuat(this,...arguments)},i.pp_getAxes=function(t){return u.getAxes(this,...arguments)},i.pp_getAxesWorld=function(t=[p.create(),p.create(),p.create()]){return u.getAxesWorld(this,...arguments)},i.pp_getAxesLocal=function(t=[p.create(),p.create(),p.create()]){return u.getAxesLocal(this,...arguments)},i.pp_getForward=function(t){return u.getForward(this,...arguments)},i.pp_getForwardWorld=function(t=p.create()){return u.getForwardWorld(this,...arguments)},i.pp_getForwardLocal=function(t=p.create()){return u.getForwardLocal(this,...arguments)},i.pp_getBackward=function(t){return u.getBackward(this,...arguments)},i.pp_getBackwardWorld=function(t=p.create()){return u.getBackwardWorld(this,...arguments)},i.pp_getBackwardLocal=function(t=p.create()){return u.getBackwardLocal(this,...arguments)},i.pp_getUp=function(t){return u.getUp(this,...arguments)},i.pp_getUpWorld=function(t=p.create()){return u.getUpWorld(this,...arguments)},i.pp_getUpLocal=function(t=p.create()){return u.getUpLocal(this,...arguments)},i.pp_getDown=function(t){return u.getDown(this,...arguments)},i.pp_getDownWorld=function(t=p.create()){return u.getDownWorld(this,...arguments)},i.pp_getDownLocal=function(t=p.create()){return u.getDownLocal(this,...arguments)},i.pp_getLeft=function(t){return u.getLeft(this,...arguments)},i.pp_getLeftWorld=function(t=p.create()){return u.getLeftWorld(this,...arguments)},i.pp_getLeftLocal=function(t=p.create()){return u.getLeftLocal(this,...arguments)},i.pp_getRight=function(t){return u.getRight(this,...arguments)},i.pp_getRightWorld=function(t=p.create()){return u.getRightWorld(this,...arguments)},i.pp_getRightLocal=function(t=p.create()){return u.getRightLocal(this,...arguments)},i.pp_setPosition=function(t){return u.setPosition(this,...arguments)},i.pp_setPositionWorld=function(t){return u.setPositionWorld(this,...arguments)},i.pp_setPositionLocal=function(t){return u.setPositionLocal(this,...arguments)},i.pp_setRotation=function(t){return u.setRotation(this,...arguments)},i.pp_setRotationDegrees=function(t){return u.setRotationDegrees(this,...arguments)},i.pp_setRotationRadians=function(t){return u.setRotationRadians(this,...arguments)},i.pp_setRotationMatrix=function(t){return u.setRotationMatrix(this,...arguments)},i.pp_setRotationQuat=function(t){return u.setRotationQuat(this,...arguments)},i.pp_setRotationWorld=function(t){return u.setRotationWorld(this,...arguments)},i.pp_setRotationWorldDegrees=function(t){return u.setRotationWorldDegrees(this,...arguments)},i.pp_setRotationWorldRadians=function(t){return u.setRotationWorldRadians(this,...arguments)},i.pp_setRotationWorldMatrix=function(t){return u.setRotationWorldMatrix(this,...arguments)},i.pp_setRotationWorldQuat=function(t){return u.setRotationWorldQuat(this,...arguments)},i.pp_setRotationLocal=function(t){return u.setRotationLocal(this,...arguments)},i.pp_setRotationLocalDegrees=function(t){return u.setRotationLocalDegrees(this,...arguments)},i.pp_setRotationLocalRadians=function(t){return u.setRotationLocalRadians(this,...arguments)},i.pp_setRotationLocalMatrix=function(t){return u.setRotationLocalMatrix(this,...arguments)},i.pp_setRotationLocalQuat=function(t){return u.setRotationLocalQuat(this,...arguments)},i.pp_setScale=function(t){return u.setScale(this,...arguments)},i.pp_setScaleWorld=function(t){return u.setScaleWorld(this,...arguments)},i.pp_setScaleLocal=function(t){return u.setScaleLocal(this,...arguments)},i.pp_setAxes=function(t,n,o){return u.setAxes(this,...arguments)},i.pp_setAxesWorld=function(t,n,o){return u.setAxesWorld(this,...arguments)},i.pp_setAxesLocal=function(t,n,o){return u.setAxesLocal(this,...arguments)},i.pp_setForward=function(t,n,o){return u.setForward(this,...arguments)},i.pp_setForwardWorld=function(t,n=null,o=null){return u.setForwardWorld(this,...arguments)},i.pp_setForwardLocal=function(t,n=null,o=null){return u.setForwardLocal(this,...arguments)},i.pp_setBackward=function(t,n,o){return u.setBackward(this,...arguments)},i.pp_setBackwardWorld=function(t,n=null,o=null){return u.setBackwardWorld(this,...arguments)},i.pp_setBackwardLocal=function(t,n=null,o=null){return u.setBackwardLocal(this,...arguments)},i.pp_setUp=function(t,n,o){return u.setUp(this,...arguments)},i.pp_setUpWorld=function(t,n=null,o=null){return u.setUpWorld(this,...arguments)},i.pp_setUpLocal=function(t,n=null,o=null){return u.setUpLocal(this,...arguments)},i.pp_setDown=function(t,n,o){return u.setDown(this,...arguments)},i.pp_setDownWorld=function(t,n=null,o=null){return u.setDownWorld(this,...arguments)},i.pp_setDownLocal=function(t,n=null,o=null){return u.setDownLocal(this,...arguments)},i.pp_setLeft=function(t,n,o){return u.setLeft(this,...arguments)},i.pp_setLeftWorld=function(t,n=null,o=null){return u.setLeftWorld(this,...arguments)},i.pp_setLeftLocal=function(t,n=null,o=null){return u.setLeftLocal(this,...arguments)},i.pp_setRight=function(t,n,o){return u.setRight(this,...arguments)},i.pp_setRightWorld=function(t,n=null,o=null){return u.setRightWorld(this,...arguments)},i.pp_setRightLocal=function(t,n=null,o=null){return u.setRightLocal(this,...arguments)},i.pp_setTransform=function(t){return u.setTransform(this,...arguments)},i.pp_setTransformMatrix=function(t){return u.setTransformMatrix(this,...arguments)},i.pp_setTransformQuat=function(t){return u.setTransformQuat(this,...arguments)},i.pp_setTransformWorld=function(t){return u.setTransformWorld(this,...arguments)},i.pp_setTransformWorldMatrix=function(t){return u.setTransformWorldMatrix(this,...arguments)},i.pp_setTransformWorldQuat=function(t){return u.setTransformWorldQuat(this,...arguments)},i.pp_setTransformLocal=function(t){return u.setTransformLocal(this,...arguments)},i.pp_setTransformLocalMatrix=function(t){return u.setTransformLocalMatrix(this,...arguments)},i.pp_setTransformLocalQuat=function(t){return u.setTransformLocalQuat(this,...arguments)},i.pp_resetPosition=function(){return u.resetPosition(this,...arguments)},i.pp_resetPositionWorld=function(){return u.resetPositionWorld(this,...arguments)},i.pp_resetPositionLocal=function(){return u.resetPositionLocal(this,...arguments)},i.pp_resetRotation=function(){return u.resetRotation(this,...arguments)},i.pp_resetRotationWorld=function(){return u.resetRotationWorld(this,...arguments)},i.pp_resetRotationLocal=function(){return u.resetRotationLocal(this,...arguments)},i.pp_resetScale=function(){return u.resetScale(this,...arguments)},i.pp_resetScaleWorld=function(){return u.resetScaleWorld(this,...arguments)},i.pp_resetScaleLocal=function(){return u.resetScaleLocal(this,...arguments)},i.pp_resetTransform=function(){return u.resetTransform(this,...arguments)},i.pp_resetTransformWorld=function(){return u.resetTransformWorld(this,...arguments)},i.pp_resetTransformLocal=function(){return u.resetTransformLocal(this,...arguments)},i.pp_translate=function(t){return u.translate(this,...arguments)},i.pp_translateWorld=function(t){return u.translateWorld(this,...arguments)},i.pp_translateLocal=function(t){return u.translateLocal(this,...arguments)},i.pp_translateObject=function(t){return u.translateObject(this,...arguments)},i.pp_translateAxis=function(t,n){return u.translateAxis(this,...arguments)},i.pp_translateAxisWorld=function(t,n){return u.translateAxisWorld(this,...arguments)},i.pp_translateAxisLocal=function(t,n){return u.translateAxisLocal(this,...arguments)},i.pp_translateAxisObject=function(t,n){return u.translateAxisObject(this,...arguments)},i.pp_rotate=function(t){return u.rotate(this,...arguments)},i.pp_rotateDegrees=function(t){return u.rotateDegrees(this,...arguments)},i.pp_rotateRadians=function(t){return u.rotateRadians(this,...arguments)},i.pp_rotateMatrix=function(t){return u.rotateMatrix(this,...arguments)},i.pp_rotateQuat=function(t){return u.rotateQuat(this,...arguments)},i.pp_rotateWorld=function(t){return u.rotateWorld(this,...arguments)},i.pp_rotateWorldDegrees=function(t){return u.rotateWorldDegrees(this,...arguments)},i.pp_rotateWorldRadians=function(t){return u.rotateWorldRadians(this,...arguments)},i.pp_rotateWorldMatrix=function(t){return u.rotateWorldMatrix(this,...arguments)},i.pp_rotateWorldQuat=function(t){return u.rotateWorldQuat(this,...arguments)},i.pp_rotateLocal=function(t){return u.rotateLocal(this,...arguments)},i.pp_rotateLocalDegrees=function(t){return u.rotateLocalDegrees(this,...arguments)},i.pp_rotateLocalRadians=function(t){return u.rotateLocalRadians(this,...arguments)},i.pp_rotateLocalMatrix=function(t){return u.rotateLocalMatrix(this,...arguments)},i.pp_rotateLocalQuat=function(t){return u.rotateLocalQuat(this,...arguments)},i.pp_rotateObject=function(t){return u.rotateObject(this,...arguments)},i.pp_rotateObjectDegrees=function(t){return u.rotateObjectDegrees(this,...arguments)},i.pp_rotateObjectRadians=function(t){return u.rotateObjectRadians(this,...arguments)},i.pp_rotateObjectMatrix=function(t){return u.rotateObjectMatrix(this,...arguments)},i.pp_rotateObjectQuat=function(t){return u.rotateObjectQuat(this,...arguments)},i.pp_rotateAxis=function(t,n){return u.rotateAxis(this,...arguments)},i.pp_rotateAxisDegrees=function(t,n){return u.rotateAxisDegrees(this,...arguments)},i.pp_rotateAxisRadians=function(t,n){return u.rotateAxisRadians(this,...arguments)},i.pp_rotateAxisWorld=function(t,n){return u.rotateAxisWorld(this,...arguments)},i.pp_rotateAxisWorldDegrees=function(t,n){return u.rotateAxisWorldDegrees(this,...arguments)},i.pp_rotateAxisWorldRadians=function(t,n){return u.rotateAxisWorldRadians(this,...arguments)},i.pp_rotateAxisLocal=function(t,n){return u.rotateAxisLocal(this,...arguments)},i.pp_rotateAxisLocalDegrees=function(t,n){return u.rotateAxisLocalDegrees(this,...arguments)},i.pp_rotateAxisLocalRadians=function(t,n){return u.rotateAxisLocalRadians(this,...arguments)},i.pp_rotateAxisObject=function(t,n){return u.rotateAxisObject(this,...arguments)},i.pp_rotateAxisObjectDegrees=function(t,n){return u.rotateAxisObjectDegrees(this,...arguments)},i.pp_rotateAxisObjectRadians=function(t,n){return u.rotateAxisObjectRadians(this,...arguments)},i.pp_rotateAround=function(t,n){return u.rotateAround(this,...arguments)},i.pp_rotateAroundDegrees=function(t,n){return u.rotateAroundDegrees(this,...arguments)},i.pp_rotateAroundRadians=function(t,n){return u.rotateAroundRadians(this,...arguments)},i.pp_rotateAroundMatrix=function(t,n){return u.rotateAroundMatrix(this,...arguments)},i.pp_rotateAroundQuat=function(t,n){return u.rotateAroundQuat(this,...arguments)},i.pp_rotateAroundWorld=function(t,n){return u.rotateAroundWorld(this,...arguments)},i.pp_rotateAroundWorldDegrees=function(t,n){return u.rotateAroundWorldDegrees(this,...arguments)},i.pp_rotateAroundWorldRadians=function(t,n){return u.rotateAroundWorldRadians(this,...arguments)},i.pp_rotateAroundWorldMatrix=function(t,n){return u.rotateAroundWorldMatrix(this,...arguments)},i.pp_rotateAroundWorldQuat=function(t,n){return u.rotateAroundWorldQuat(this,...arguments)},i.pp_rotateAroundLocal=function(t,n){return u.rotateAroundLocal(this,...arguments)},i.pp_rotateAroundLocalDegrees=function(t,n){return u.rotateAroundLocalDegrees(this,...arguments)},i.pp_rotateAroundLocalRadians=function(t,n){return u.rotateAroundLocalRadians(this,...arguments)},i.pp_rotateAroundLocalMatrix=function(t,n){return u.rotateAroundLocalMatrix(this,...arguments)},i.pp_rotateAroundLocalQuat=function(t,n){return u.rotateAroundLocalQuat(this,...arguments)},i.pp_rotateAroundObject=function(t,n){return u.rotateAroundObject(this,...arguments)},i.pp_rotateAroundObjectDegrees=function(t,n){return u.rotateAroundObjectDegrees(this,...arguments)},i.pp_rotateAroundObjectRadians=function(t,n){return u.rotateAroundObjectRadians(this,...arguments)},i.pp_rotateAroundObjectMatrix=function(t,n){return u.rotateAroundObjectMatrix(this,...arguments)},i.pp_rotateAroundObjectQuat=function(t,n){return u.rotateAroundObjectQuat(this,...arguments)},i.pp_rotateAroundAxis=function(t,n,o){return u.rotateAroundAxis(this,...arguments)},i.pp_rotateAroundAxisDegrees=function(t,n,o){return u.rotateAroundAxisDegrees(this,...arguments)},i.pp_rotateAroundAxisRadians=function(t,n,o){return u.rotateAroundAxisRadians(this,...arguments)},i.pp_rotateAroundAxisWorld=function(t,n,o){return u.rotateAroundAxisWorld(this,...arguments)},i.pp_rotateAroundAxisWorldDegrees=function(t,n,o){return u.rotateAroundAxisWorldDegrees(this,...arguments)},i.pp_rotateAroundAxisWorldRadians=function(t,n,o){return u.rotateAroundAxisWorldRadians(this,...arguments)},i.pp_rotateAroundAxisLocal=function(t,n,o){return u.rotateAroundAxisLocal(this,...arguments)},i.pp_rotateAroundAxisLocalDegrees=function(t,n,o){return u.rotateAroundAxisLocalDegrees(this,...arguments)},i.pp_rotateAroundAxisLocalRadians=function(t,n,o){return u.rotateAroundAxisLocalRadians(this,...arguments)},i.pp_rotateAroundAxisObject=function(t,n,o){return u.rotateAroundAxisObject(this,...arguments)},i.pp_rotateAroundAxisObjectDegrees=function(t,n,o){return u.rotateAroundAxisObjectDegrees(this,...arguments)},i.pp_rotateAroundAxisObjectRadians=function(t,n,o){return u.rotateAroundAxisObjectRadians(this,...arguments)},i.pp_scaleObject=function(t){return u.scaleObject(this,...arguments)},i.pp_lookAt=function(t,n){return u.lookAt(this,...arguments)},i.pp_lookAtWorld=function(t,n){return u.lookAtWorld(this,...arguments)},i.pp_lookAtLocal=function(t,n){return u.lookAtLocal(this,...arguments)},i.pp_lookTo=function(t,n){return u.lookTo(this,...arguments)},i.pp_lookToWorld=function(t,n=this.pp_getUpWorld(internalUp)){return u.lookToWorld(this,...arguments)},i.pp_lookToLocal=function(t,n=this.pp_getUpLocal(internalUp)){return u.lookToLocal(this,...arguments)},i.pp_setParent=function(t,n=!0){return u.setParent(this,...arguments)},i.pp_getParent=function(){return u.getParent(this,...arguments)},i.pp_convertPositionObjectToWorld=function(t,n=p.create()){return u.convertPositionObjectToWorld(this,...arguments)},i.pp_convertDirectionObjectToWorld=function(t,n=p.create()){return u.convertDirectionObjectToWorld(this,...arguments)},i.pp_convertPositionWorldToObject=function(t,n=p.create()){return u.convertPositionWorldToObject(this,...arguments)},i.pp_convertDirectionWorldToObject=function(t,n=p.create()){return u.convertDirectionWorldToObject(this,...arguments)},i.pp_convertPositionLocalToWorld=function(t,n=p.create()){return u.convertPositionLocalToWorld(this,...arguments)},i.pp_convertDirectionLocalToWorld=function(t,n=p.create()){return u.convertDirectionLocalToWorld(this,...arguments)},i.pp_convertPositionWorldToLocal=function(t,n=p.create()){return u.convertPositionWorldToLocal(this,...arguments)},i.pp_convertDirectionWorldToLocal=function(t,n=p.create()){return u.convertDirectionWorldToLocal(this,...arguments)},i.pp_convertPositionObjectToLocal=function(t,n=p.create()){return u.convertPositionObjectToLocal(this,...arguments)},i.pp_convertDirectionObjectToLocal=function(t,n=p.create()){return u.convertDirectionObjectToLocal(this,...arguments)},i.pp_convertPositionLocalToObject=function(t,n=p.create()){return u.convertPositionLocalToObject(this,...arguments)},i.pp_convertDirectionLocalToObject=function(t,n=p.create()){return u.convertDirectionLocalToObject(this,...arguments)},i.pp_convertTransformObjectToWorld=function(t,n){return u.convertTransformObjectToWorld(this,...arguments)},i.pp_convertTransformObjectToWorldMatrix=function(t,n=V.create()){return u.convertTransformObjectToWorldMatrix(this,...arguments)},i.pp_convertTransformObjectToWorldQuat=function(t,n=O.create()){return u.convertTransformObjectToWorldQuat(this,...arguments)},i.pp_convertTransformWorldToObject=function(t,n){return u.convertTransformWorldToObject(this,...arguments)},i.pp_convertTransformWorldToObjectMatrix=function(t,n=V.create()){return u.convertTransformWorldToObjectMatrix(this,...arguments)},i.pp_convertTransformWorldToObjectQuat=function(t,n=O.create()){return u.convertTransformWorldToObjectQuat(this,...arguments)},i.pp_convertTransformLocalToWorld=function(t,n){return u.convertTransformLocalToWorld(this,...arguments)},i.pp_convertTransformLocalToWorldMatrix=function(t,n=V.create()){return u.convertTransformLocalToWorldMatrix(this,...arguments)},i.pp_convertTransformLocalToWorldQuat=function(t,n=O.create()){return u.convertTransformLocalToWorldQuat(this,...arguments)},i.pp_convertTransformWorldToLocal=function(t,n){return u.convertTransformWorldToLocal(this,...arguments)},i.pp_convertTransformWorldToLocalMatrix=function(t,n=V.create()){return u.convertTransformWorldToLocalMatrix(this,...arguments)},i.pp_convertTransformWorldToLocalQuat=function(t,n=O.create()){return u.convertTransformWorldToLocalQuat(this,...arguments)},i.pp_convertTransformObjectToLocal=function(t,n){return u.convertTransformObjectToLocal(this,...arguments)},i.pp_convertTransformObjectToLocalMatrix=function(t,n=V.create()){return u.convertTransformObjectToLocalMatrix(this,...arguments)},i.pp_convertTransformObjectToLocalQuat=function(t,n=O.create()){return u.convertTransformObjectToLocalQuat(this,...arguments)},i.pp_convertTransformLocalToObject=function(t,n){return u.convertTransformLocalToObject(this,...arguments)},i.pp_convertTransformLocalToObjectMatrix=function(t,n=V.create()){return u.convertTransformLocalToObjectMatrix(this,...arguments)},i.pp_convertTransformLocalToObjectQuat=function(t,n=O.create()){return u.convertTransformLocalToObjectQuat(this,...arguments)},i.pp_addComponent=function(t,n,o=null){return u.addComponent(this,...arguments)},i.pp_getComponent=function(t,n=0){return u.getComponent(this,...arguments)},i.pp_getComponentSelf=function(t,n=0){return u.getComponentSelf(this,...arguments)},i.pp_getComponentHierarchy=function(t,n=0){return u.getComponentHierarchy(this,...arguments)},i.pp_getComponentHierarchyBreadth=function(t,n=0){return u.getComponentHierarchyBreadth(this,...arguments)},i.pp_getComponentHierarchyDepth=function(t,n=0){return u.getComponentHierarchyDepth(this,...arguments)},i.pp_getComponentDescendants=function(t,n=0){return u.getComponentDescendants(this,...arguments)},i.pp_getComponentDescendantsBreadth=function(t,n=0){return u.getComponentDescendantsBreadth(this,...arguments)},i.pp_getComponentDescendantsDepth=function(t,n=0){return u.getComponentDescendantsDepth(this,...arguments)},i.pp_getComponentChildren=function(t,n=0){return u.getComponentChildren(this,...arguments)},i.pp_getComponents=function(t){return u.getComponents(this,...arguments)},i.pp_getComponentsSelf=function(t){return u.getComponentsSelf(this,...arguments)},i.pp_getComponentsHierarchy=function(t){return u.getComponentsHierarchy(this,...arguments)},i.pp_getComponentsHierarchyBreadth=function(t){return u.getComponentsHierarchyBreadth(this,...arguments)},i.pp_getComponentsHierarchyDepth=function(t){return u.getComponentsHierarchyDepth(this,...arguments)},i.pp_getComponentsDescendants=function(t){return u.getComponentsDescendants(this,...arguments)},i.pp_getComponentsDescendantsBreadth=function(t){return u.getComponentsDescendantsBreadth(this,...arguments)},i.pp_getComponentsDescendantsDepth=function(t){return u.getComponentsDescendantsDepth(this,...arguments)},i.pp_getComponentsChildren=function(t){return u.getComponentsChildren(this,...arguments)},i.pp_setActive=function(t,n=!0){return u.setActive(this,...arguments)},i.pp_setActiveSelf=function(t){return u.setActiveSelf(this,...arguments)},i.pp_setActiveHierarchy=function(t){return u.setActiveHierarchy(this,...arguments)},i.pp_setActiveHierarchyBreadth=function(t){return u.setActiveHierarchyBreadth(this,...arguments)},i.pp_setActiveHierarchyDepth=function(t){return u.setActiveHierarchyDepth(this,...arguments)},i.pp_setActiveDescendants=function(t){return u.setActiveDescendants(this,...arguments)},i.pp_setActiveDescendantsBreadth=function(t){return u.setActiveDescendantsBreadth(this,...arguments)},i.pp_setActiveDescendantsDepth=function(t){return u.setActiveDescendantsDepth(this,...arguments)},i.pp_setActiveChildren=function(t){return u.setActiveChildren(this,...arguments)},i.pp_hasUniformScale=function(){return u.hasUniformScale(this,...arguments)},i.pp_hasUniformScaleWorld=function(){return u.hasUniformScaleWorld(this,...arguments)},i.pp_hasUniformScaleLocal=function(){return u.hasUniformScaleLocal(this,...arguments)},i.pp_clone=function(t=new Zt){return u.clone(this,...arguments)},i.pp_isCloneable=function(t=new Zt){return u.isCloneable(this,...arguments)},i.pp_toString=function(){return u.toString(this,...arguments)},i.pp_toStringExtended=function(){return u.toStringExtended(this,...arguments)},i.pp_toStringCompact=function(){return u.toStringCompact(this,...arguments)},i.pp_getObjectByName=function(t,n=!1,o=0){return u.getObjectByName(this,...arguments)},i.pp_getObjectByNameHierarchy=function(t,n=!1,o=0){return u.getObjectByNameHierarchy(this,...arguments)},i.pp_getObjectByNameHierarchyBreadth=function(t,n=!1,o=0){return u.getObjectByNameHierarchyBreadth(this,...arguments)},i.pp_getObjectByNameHierarchyDepth=function(t,n=!1,o=0){return u.getObjectByNameHierarchyDepth(this,...arguments)},i.pp_getObjectByNameDescendants=function(t,n=!1,o=0){return u.getObjectByNameDescendants(this,...arguments)},i.pp_getObjectByNameDescendantsBreadth=function(t,n=!1,o=0){return u.getObjectByNameDescendantsBreadth(this,...arguments)},i.pp_getObjectByNameDescendantsDepth=function(t,n=!1,o=0){return u.getObjectByNameDescendantsDepth(this,...arguments)},i.pp_getObjectByNameChildren=function(t,n=!1,o=0){return u.getObjectByNameChildren(this,...arguments)},i.pp_getObjectsByName=function(t,n=!1){return u.getObjectsByName(this,...arguments)},i.pp_getObjectsByNameHierarchy=function(t,n=!1){return u.getObjectsByNameHierarchy(this,...arguments)},i.pp_getObjectsByNameHierarchyBreadth=function(t,n=!1){return u.getObjectsByNameHierarchyBreadth(this,...arguments)},i.pp_getObjectsByNameHierarchyDepth=function(t,n=!1){return u.getObjectsByNameHierarchyDepth(this,...arguments)},i.pp_getObjectsByNameDescendants=function(t,n=!1){return u.getObjectsByNameDescendants(this,...arguments)},i.pp_getObjectsByNameDescendantsBreadth=function(t,n=!1){return u.getObjectsByNameDescendantsBreadth(this,...arguments)},i.pp_getObjectsByNameDescendantsDepth=function(t,n=!1){return u.getObjectsByNameDescendantsDepth(this,...arguments)},i.pp_getObjectsByNameChildren=function(t,n=!1){return u.getObjectsByNameChildren(this,...arguments)},i.pp_getObjectByID=function(t){return u.getObjectByID(this,...arguments)},i.pp_getObjectByIDHierarchy=function(t){return u.getObjectByIDHierarchy(this,...arguments)},i.pp_getObjectByIDHierarchyBreadth=function(t){return u.getObjectByIDHierarchyBreadth(this,...arguments)},i.pp_getObjectByIDHierarchyDepth=function(t){return u.getObjectByIDHierarchyDepth(this,...arguments)},i.pp_getObjectByIDDescendants=function(t){return u.getObjectByIDDescendants(this,...arguments)},i.pp_getObjectByIDDescendantsBreadth=function(t){return u.getObjectByIDDescendantsBreadth(this,...arguments)},i.pp_getObjectByIDDescendantsDepth=function(t){return u.getObjectByIDDescendantsDepth(this,...arguments)},i.pp_getObjectByIDChildren=function(t){return u.getObjectByIDChildren(this,...arguments)},i.pp_getHierarchyBreadth=function(){return u.getHierarchyBreadth(this,...arguments)},i.pp_getHierarchyDepth=function(){return u.getHierarchyDepth(this,...arguments)},i.pp_getDescendants=function(){return u.getDescendants(this,...arguments)},i.pp_getDescendantsBreadth=function(){return u.getDescendantsBreadth(this,...arguments)},i.pp_getDescendantsDepth=function(){return u.getDescendantsDepth(this,...arguments)},i.pp_getChildren=function(){return u.getChildren(this,...arguments)},i.pp_getSelf=function(){return u.getSelf(this,...arguments)},i.pp_addObject=function(){return u.addObject(this,...arguments)},i.pp_getName=function(){return u.getName(this,...arguments)},i.pp_setName=function(t){return u.setName(this,...arguments)},i.pp_getEngine=function(){return u.getEngine(this,...arguments)},i.pp_getID=function(){return u.getID(this,...arguments)},i.pp_markDirty=function(){return u.markDirty(this,...arguments)},i.pp_isTransformChanged=function(){return u.isTransformChanged(this,...arguments)},i.pp_equals=function(t){return u.equals(this,...arguments)},i.pp_destroy=function(){return u.destroy(this,...arguments)},i.pp_reserveObjects=function(t){return u.reserveObjects(this,...arguments)},i.pp_reserveObjectsSelf=function(t){return u.reserveObjectsSelf(this,...arguments)},i.pp_reserveObjectsHierarchy=function(t){return u.reserveObjectsHierarchy(this,...arguments)},i.pp_reserveObjectsDescendants=function(t){return u.reserveObjectsDescendants(this,...arguments)},i.pp_reserveObjectsChildren=function(t){return u.reserveObjectsChildren(this,...arguments)},i.pp_getComponentsAmountMap=function(t=new Map){return u.getComponentsAmountMap(this,...arguments)},i.pp_getComponentsAmountMapSelf=function(t=new Map){return u.getComponentsAmountMapSelf(this,...arguments)},i.pp_getComponentsAmountMapHierarchy=function(t=new Map){return u.getComponentsAmountMapHierarchy(this,...arguments)},i.pp_getComponentsAmountMapDescendants=function(t=new Map){return u.getComponentsAmountMapDescendants(this,...arguments)},i.pp_getComponentsAmountMapChildren=function(t=new Map){return u.getComponentsAmountMapChildren(this,...arguments)},Ce.injectProperties(i,gD.prototype,!1,!0,!0)}import{Scene as fD}from"@wonderlandengine/api";function zl(i){eC()}function eC(){let i={};i.pp_getRoot=function(){return J.getRoot(this,...arguments)},i.pp_addObject=function(){return J.addObject(this,...arguments)},i.pp_getObjects=function(){return J.getObjects(this,...arguments)},i.pp_getObjectsBreadth=function(){return J.getObjectsBreadth(this,...arguments)},i.pp_getObjectsDepth=function(){return J.getObjectsDepth(this,...arguments)},i.pp_getComponent=function(t,n=0){return J.getComponent(this,...arguments)},i.pp_getComponentBreadth=function(t,n=0){return J.getComponentBreadth(this,...arguments)},i.pp_getComponentDepth=function(t,n=0){return J.getComponentDepth(this,...arguments)},i.pp_getComponents=function(t){return J.getComponents(this,...arguments)},i.pp_getComponentsBreadth=function(t){return J.getComponentsBreadth(this,...arguments)},i.pp_getComponentsDepth=function(t){return J.getComponentsDepth(this,...arguments)},i.pp_getObjectByName=function(t,n=0){return J.getObjectByName(this,...arguments)},i.pp_getObjectByNameBreadth=function(t,n=0){return J.getObjectByNameBreadth(this,...arguments)},i.pp_getObjectByNameDepth=function(t,n=0){return J.getObjectByNameDepth(this,...arguments)},i.pp_getObjectsByName=function(t,n=0){return J.getObjectsByName(this,...arguments)},i.pp_getObjectsByNameBreadth=function(t,n=0){return J.getObjectsByNameBreadth(this,...arguments)},i.pp_getObjectsByNameDepth=function(t,n=0){return J.getObjectsByNameDepth(this,...arguments)},i.pp_getObjectByID=function(t){return J.getObjectByID(this,...arguments)},i.pp_getObjectByIDBreadth=function(t){return J.getObjectByIDBreadth(this,...arguments)},i.pp_getObjectByIDDepth=function(t){return J.getObjectByIDDepth(this,...arguments)},i.pp_toString=function(){return J.toString(this,...arguments)},i.pp_toStringCompact=function(){return J.toStringCompact(this,...arguments)},i.pp_toStringExtended=function(){return J.toStringExtended(this,...arguments)},i.pp_getComponentsAmountMap=function(t=new Map){return J.getComponentsAmountMap(this,...arguments)},Ce.injectProperties(i,fD.prototype,!1,!0,!0)}function Nl(i){jl(),zl(i)}import{InputComponent as PD,ViewComponent as CD}from"@wonderlandengine/api";import{Cursor as TD,CursorTarget as Gl,HitTestLocation as bD}from"@wonderlandengine/components";function tC(i=r.getMainEngine()){let e=r.getXR(i);return e!=null?e.session:null}function iC(i=r.getMainEngine()){let e=r.getXR(i);return e!=null?e.sessionMode:null}function nC(i=r.getMainEngine()){let e=r.getXR(i);return e!=null?e.currentReferenceSpace:null}function oC(i=r.getMainEngine()){let e="local";try{let t=r.getXR(i);e=t!=null?t.currentReferenceSpaceType:null}catch{}return e}function sC(i=r.getMainEngine()){let e=r.getXR(i);return e!=null?e.frame:null}function aC(i=r.getMainEngine()){return B.getSession(i)!=null}function rC(i=r.getMainEngine()){return B.getReferenceSpaceType(i).includes("floor")}function lC(i,e,t=!1,n=!1,o=r.getMainEngine()){e!=null&&(t&&B.isSessionActive(o)&&(n?e(!0,B.getSession(o),B.getSessionMode(o)):e(B.getSession(o),B.getSessionMode(o))),n?o.onXRSessionStart.add(e.bind(void 0,!1),{id:i,immediate:!1}):o.onXRSessionStart.add(e,{id:i,immediate:!1}))}function mC(i,e=r.getMainEngine()){e.onXRSessionStart.remove(i)}function yC(i,e,t=r.getMainEngine()){e!=null&&t.onXRSessionEnd.add(e,{id:i})}function uC(i,e=r.getMainEngine()){return e.onXRSessionEnd.remove(i)}function hC(i,e,t,n=!1,o=!1,s=r.getMainEngine()){B.registerSessionStartEventListener(i,e,n,o,s),B.registerSessionEndEventListener(i,t,s)}function cC(i,e=r.getMainEngine()){B.unregisterSessionStartEventListener(i,e),B.unregisterSessionEndEventListener(i,e)}function pC(i=r.getMainEngine()){return i.vrSupported}function dC(i=r.getMainEngine()){return i.arSupported}function _C(i=r.getMainEngine()){return"CustomWebXRPolyfill"in r.getWindow(i)}var B={getSession:tC,getSessionMode:iC,getReferenceSpace:nC,getReferenceSpaceType:oC,getFrame:sC,isSessionActive:aC,registerSessionStartEventListener:lC,unregisterSessionStartEventListener:mC,registerSessionEndEventListener:yC,unregisterSessionEndEventListener:uC,registerSessionStartEndEventListeners:hC,unregisterSessionStartEndEventListeners:cC,isReferenceSpaceFloorBased:rC,isVRSupported:pC,isARSupported:dC,isDeviceEmulated:_C};var A={LEFT:"left",RIGHT:"right"},Gi={LEFT:0,RIGHT:1},$e={GAMEPAD:0,TRACKED_HAND:1},at={WRIST:"wrist",THUMB_METACARPAL:"thumb-metacarpal",THUMB_PHALANX_PROXIMAL:"thumb-phalanx-proximal",THUMB_PHALANX_DISTAL:"thumb-phalanx-distal",THUMB_TIP:"thumb-tip",INDEX_FINGER_METACARPAL:"index-finger-metacarpal",INDEX_FINGER_PHALANX_PROXIMAL:"index-finger-phalanx-proximal",INDEX_FINGER_PHALANX_INTERMEDIATE:"index-finger-phalanx-intermediate",INDEX_FINGER_PHALANX_DISTAL:"index-finger-phalanx-distal",INDEX_FINGER_TIP:"index-finger-tip",MIDDLE_FINGER_METACARPAL:"middle-finger-metacarpal",MIDDLE_FINGER_PHALANX_PROXIMAL:"middle-finger-phalanx-proximal",MIDDLE_FINGER_PHALANX_INTERMEDIATE:"middle-finger-phalanx-intermediate",MIDDLE_FINGER_PHALANX_DISTAL:"middle-finger-phalanx-distal",MIDDLE_FINGER_TIP:"middle-finger-tip",RING_FINGER_METACARPAL:"ring-finger-metacarpal",RING_FINGER_PHALANX_PROXIMAL:"ring-finger-phalanx-proximal",RING_FINGER_PHALANX_INTERMEDIATE:"ring-finger-phalanx-intermediate",RING_FINGER_PHALANX_DISTAL:"ring-finger-phalanx-distal",RING_FINGER_TIP:"ring-finger-tip",PINKY_FINGER_METACARPAL:"pinky-finger-metacarpal",PINKY_FINGER_PHALANX_PROXIMAL:"pinky-finger-phalanx-proximal",PINKY_FINGER_PHALANX_INTERMEDIATE:"pinky-finger-phalanx-intermediate",PINKY_FINGER_PHALANX_DISTAL:"pinky-finger-phalanx-distal",PINKY_FINGER_TIP:"pinky-finger-tip"},jo={WRIST:0,THUMB_METACARPAL:1,THUMB_PHALANX_PROXIMAL:2,THUMB_PHALANX_DISTAL:3,THUMB_TIP:4,INDEX_FINGER_METACARPAL:5,INDEX_FINGER_PHALANX_PROXIMAL:6,INDEX_FINGER_PHALANX_INTERMEDIATE:7,INDEX_FINGER_PHALANX_DISTAL:8,INDEX_FINGER_TIP:9,MIDDLE_FINGER_METACARPAL:10,MIDDLE_FINGER_PHALANX_PROXIMAL:11,MIDDLE_FINGER_PHALANX_INTERMEDIATE:12,MIDDLE_FINGER_PHALANX_DISTAL:13,MIDDLE_FINGER_TIP:14,RING_FINGER_METACARPAL:15,RING_FINGER_PHALANX_PROXIMAL:16,RING_FINGER_PHALANX_INTERMEDIATE:17,RING_FINGER_PHALANX_DISTAL:18,RING_FINGER_TIP:19,PINKY_FINGER_METACARPAL:20,PINKY_FINGER_PHALANX_PROXIMAL:21,PINKY_FINGER_PHALANX_INTERMEDIATE:22,PINKY_FINGER_PHALANX_DISTAL:23,PINKY_FINGER_TIP:24};function gC(i){let e=null;switch(i){case Gi.LEFT:e=A.LEFT;break;case Gi.RIGHT:e=A.RIGHT;break}return e}function fC(i,e=null,t=r.getMainEngine()){let n=null,o=B.getSession(t);if(o!=null&&o.inputSources)for(let s=0;s<o.inputSources.length;s++){let a=o.inputSources[s];if((!e||e==$e.GAMEPAD&&!a.hand||e==$e.TRACKED_HAND&&a.hand)&&a.handedness==i){n=a;break}}return n}function PC(i,e){let t=ee.getInputSource(i,void 0,e);return ee.getInputSourceType(t)}function CC(i){let e=null;return i&&(i.hand?e=$e.TRACKED_HAND:e=$e.GAMEPAD),e}function TC(i){let e=null;switch(i){case A.LEFT:e=A.RIGHT;break;case A.RIGHT:e=A.LEFT;break}return e}function bC(i){let e=null,t=null;for(let n in jo)if(jo[n]==i){t=n;break}return t!=null&&(e=at[t]),e}var ee={getHandednessByIndex:gC,getInputSource:fC,getInputSourceTypeByHandedness:PC,getInputSourceType:CC,getOppositeHandedness:TC,getJointIDByIndex:bC};function Ul(){SC()}function SC(){let i={};i.init=function(){this.maxDistance=100,this.visible=!1,this.globalTarget=this.object.pp_addComponent(Gl),this.hitTestTarget=this.object.pp_addComponent(Gl),this.hoveringObject=null,this.hoveringObjectTarget=null,this._collisionMask=1<<this.collisionGroup,this._doubleClickTimer=0,this._tripleClickTimer=0,this._multipleClickObject=null,this._multipleClickDelay=.3,this._onDestroyListeners=[],this._prevHitLocationLocalToTarget=m(),this._pointerID=null,this._updatePointerStyle=!1,this._lastClientX=null,this._lastClientY=null,this._lastWidth=null,this._lastHeight=null,this._lastPointerID=null,this._handedness=null,this._transformQuat=j(),this._origin=m(),this._direction=m(),this._isHovering=!1,this._isDown=!1,this._lastIsDown=!1,this._isRealDown=!1,this._isDownForUpWithDown=!1,this._isUpWithNoDown=!1,this._cursorPos=m(),this._tempVec=m(),this._viewComponent=null,this._cursorRayOrigin=m(),this._cursorRayScale=m(),this._projectionMatrix=be(),this._hitTestLocation=null,this._hitTestObject=null,this._rayHitLocation=m(),this._hitObjectData=[null,null,null],this._myViewEventListenersRegistered=!1},i.start=function(){if(this.handedness==0){let t=this.object.pp_getComponent(PD);t?(this._handedness=t.handedness,this.input=t):console.warn("cursor component on object "+this.object.pp_getName()+' was configured with handedness "input component", but object has no input component.')}else this._handedness=ee.getHandednessByIndex(this.handedness-1);this.pp_setViewComponent(this.object.pp_getComponent(CD)),B.registerSessionStartEventListener(this,this.setupXREvents.bind(this),this.engine),this._onDestroyListeners.push(()=>{B.unregisterSessionStartEventListener(this,this.engine)}),this.cursorRayObject&&(this.cursorRayObject.pp_setActive(!0),this._cursorRayScale.set(this.cursorRayObject.pp_getScaleLocal()),this._setCursorRayTransform(null)),this._setCursorVisibility(!1),this.useWebXRHitTest&&(this._hitTestObject=this.object.pp_addObject(),this._hitTestLocation=this.hitTestObject.pp_addComponent(bD,{scaleObject:!1}))},i._onViewportResize=function(){!this._viewComponent||this._viewComponent.projectionMatrix.mat4_invert(this._projectionMatrix)},i._setCursorRayTransform=function(t){if(!!this.cursorRayObject&&this.cursorRayScalingAxis!=4&&(this.cursorRayObject.pp_resetScaleLocal(),t!=null)){this.cursorRayObject.pp_getPosition(this._cursorRayOrigin);let n=this._cursorRayOrigin.vec3_distance(t);this._cursorRayScale[this.cursorRayScalingAxis]=n,this.cursorRayObject.pp_scaleObject(this._cursorRayScale)}},i._setCursorVisibility=function(t){this.visible=t,this.cursorObject&&this.cursorObject.pp_setActive(t)},i.rayCast=function(){let t=this.rayCastMode==0?r.getScene(this.engine).rayCast(this._origin,this._direction,this._collisionMask):r.getPhysics(this.engine).rayCast(this._origin,this._direction,this._collisionMask,this.maxDistance);this._hitObjectData[0]=null,this._hitObjectData[1]=null,this._hitObjectData[2]=null;let n=1/0;this._hitTestLocation!=null&&this._hitTestLocation.visible&&(this._hitTestObject.pp_getPositionWorld(this._cursorPos),this._rayHitLocation.vec3_copy(this._cursorPos),n=this._cursorPos.vec3_distance(this.object.pp_getPositionWorld(this._tempVec)),this._hitObjectData[0]=this._hitTestObject,this._hitObjectData[1]=this._rayHitLocation),this.hoveringReality=!1,t.hitCount>0?t.distances[0]<=n?(this._cursorPos.vec3_copy(t.locations[0]),this._rayHitLocation.vec3_copy(this._cursorPos),this._hitObjectData[0]=t.objects[0],this._hitObjectData[1]=this._rayHitLocation):this.hoveringReality=!0:n==1/0&&(this._cursorPos.vec3_zero(),this._hitObjectData[0]=null,this._hitObjectData[1]=null);let o=B.getFrame(this.engine);return this.hoveringReality&&o!=null&&(this._hitObjectData[2]=this._hitTestLocation.getHitTestResults(o)[0]),this._hitObjectData},i.update=function(t){if(this._doubleClickTimer>0&&(this._doubleClickTimer-=t),this._tripleClickTimer>0&&(this._tripleClickTimer-=t),B.isSessionActive(this.engine)){if(this.arTouchDown&&this.input&&B.getSession(this.engine).inputSources[0].handedness==="none"&&B.getSession(this.engine).inputSources[0].gamepad){let o=B.getSession(this.engine).inputSources[0].gamepad.axes;this._direction.vec3_set(o[0],-o[1],-1),this.updateDirection()}else this.object.pp_getPosition(this._origin),this.object.pp_getForward(this._direction);let n=this.rayCast();this.hoverBehaviour(n[0],n[1],n[2])}else if(this._viewComponent!=null)if(this._lastPointerID!=null){this.updateMousePos(this._lastClientX,this._lastClientY,this._lastWidth,this._lastHeight);let n=this.rayCast();this.hoverBehaviour(n[0],n[1],n[2]),this.hoveringObject!=null?this._pointerID=this._lastPointerID:this._pointerID=null}else this.hoveringObject!=null&&this.hoverBehaviour(null,null,null,!0);this.cursorObject&&(this.hoveringObject&&(this._cursorPos[0]!=0||this._cursorPos[1]!=0||this._cursorPos[2]!=0)?(this._setCursorVisibility(!0),this.cursorObject.pp_setPosition(this._cursorPos),this.cursorObject.pp_setTransformLocalQuat(this.cursorObject.pp_getTransformLocalQuat(this._transformQuat).quat2_normalize(this._transformQuat)),this._setCursorRayTransform(this._cursorPos)):(this.visible&&this.cursorRayObject&&this._setCursorRayTransform(null),this._setCursorVisibility(!1))),this.cursorRayObject&&this.cursorRayObject.pp_setActive(!0),this.hoveringObject==null&&(this._pointerID=null),this._updatePointerStyle=!1},i.hoverBehaviour=function(t,n,o,s=!1){if(!s&&t!=null){let a=!1;(!this.hoveringObject||!this.hoveringObject.pp_equals(t))&&(this.hoveringObject&&(this.hoveringReality?this.hitTestTarget.onUnhover.notify(null,this):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onUnhover.notify(this.hoveringObject,this),this.globalTarget.onUnhover.notify(this.hoveringObject,this))),a=!0,this.hoveringObject=t,this.hoveringObjectTarget=this.hoveringObject.pp_getComponent(Gl),this.hoveringReality?this.hitTestTarget.onHover.notify(o,this):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onHover.notify(this.hoveringObject,this),this.globalTarget.onHover.notify(this.hoveringObject,this)),this.styleCursor&&!this._isRealDown&&this.hoveringObjectTarget!=null&&!this.hoveringObjectTarget.isSurface?r.getBody(this.engine).style.cursor="pointer":r.getBody(this.engine).style.cursor=="pointer"&&(r.getBody(this.engine).style.cursor="default"),!this._pp_isDownToProcess()&&this._isRealDown&&(this._isDown=!0,this._lastIsDown=!0,this._isDownForUpWithDown=!1,this._isUpWithNoDown=!1,this.hoveringReality?this.hitTestTarget.onDownOnHover.notify(o,this):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onDownOnHover.notify(this.hoveringObject,this),this.globalTarget.onDownOnHover.notify(this.hoveringObject,this)))),this._updatePointerStyle&&(this.styleCursor&&!this._isRealDown&&this.hoveringObjectTarget!=null&&!this.hoveringObjectTarget.isSurface?r.getBody(this.engine).style.cursor="pointer":r.getBody(this.engine).style.cursor=="pointer"&&(r.getBody(this.engine).style.cursor="default")),!a&&this._pp_isMoving(n)&&(this.hoveringReality?this.hitTestTarget.onMove.notify(o,this):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onMove.notify(this.hoveringObject,this),this.globalTarget.onMove.notify(this.hoveringObject,this))),this._pp_isDownToProcess()?(this.hoveringReality?this.hitTestTarget.onDown.notify(o,this):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onDown.notify(this.hoveringObject,this),this.globalTarget.onDown.notify(this.hoveringObject,this)),this.hoveringReality?this.hitTestTarget.onClick.notify(o,this):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onClick.notify(this.hoveringObject,this),this.globalTarget.onClick.notify(this.hoveringObject,this)),this._tripleClickTimer>0&&this._multipleClickObject&&this._multipleClickObject.pp_equals(this.hoveringObject)?(this.hoveringReality?this.hitTestTarget.onTripleClick.notify(o,this):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onTripleClick.notify(this.hoveringObject,this),this.globalTarget.onTripleClick.notify(this.hoveringObject,this)),this._tripleClickTimer=0):this._doubleClickTimer>0&&this._multipleClickObject&&this._multipleClickObject.pp_equals(this.hoveringObject)?(this.hoveringReality?this.hitTestTarget.onDoubleClick.notify(o,this):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onDoubleClick.notify(this.hoveringObject,this),this.globalTarget.onDoubleClick.notify(this.hoveringObject,this)),this._tripleClickTimer=this._multipleClickDelay,this._doubleClickTimer=0):(this.hoveringReality?this.hitTestTarget.onSingleClick.notify(o,this):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onSingleClick.notify(this.hoveringObject,this),this.globalTarget.onSingleClick.notify(this.hoveringObject,this)),this._tripleClickTimer=0,this._doubleClickTimer=this._multipleClickDelay,this._multipleClickObject=this.hoveringObject)):!this._isUpWithNoDown&&!a&&this._pp_isUpToProcess()?this.hoveringReality?(this.hitTestTarget.onUp.notify(o,this),this.hitTestTarget.onUpWithDown.notify(o,this)):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onUp.notify(this.hoveringObject,this),this.globalTarget.onUp.notify(this.hoveringObject,this),this.hoveringObjectTarget&&this.hoveringObjectTarget.onUpWithDown.notify(this.hoveringObject,this),this.globalTarget.onUpWithDown.notify(this.hoveringObject,this)):(this._isUpWithNoDown||a&&this._pp_isUpToProcess())&&(this.hoveringReality?(this.hitTestTarget.onUp.notify(o,this),this.hitTestTarget.onUpWithNoDown.notify(o,this)):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onUp.notify(this.hoveringObject,this),this.globalTarget.onUp.notify(this.hoveringObject,this),this.hoveringObjectTarget&&this.hoveringObjectTarget.onUpWithNoDown.notify(this.hoveringObject,this),this.globalTarget.onUpWithNoDown.notify(this.hoveringObject,this))),this._prevHitLocationLocalToTarget=this.hoveringObject.pp_convertPositionWorldToLocal(n,this._prevHitLocationLocalToTarget)}else this.hoveringObject&&(s||t==null)&&(this.hoveringReality?this.hitTestTarget.onUnhover.notify(null,this):(this.hoveringObjectTarget&&this.hoveringObjectTarget.onUnhover.notify(this.hoveringObject,this),this.globalTarget.onUnhover.notify(this.hoveringObject,this)),this.hoveringObject=null,this.hoveringObjectTarget=null,this.styleCursor&&!this._isRealDown&&(r.getBody(this.engine).style.cursor="default"));this.hoveringObject?this._lastIsDown=this._isDown:(this._isDown=!1,this._lastIsDown=!1,this._isDownForUpWithDown=!1),this._isUpWithNoDown=!1},i.setupXREvents=function(t){let n=this.onSelect.bind(this);t.addEventListener("select",n);let o=this.onSelectStart.bind(this);t.addEventListener("selectstart",o);let s=this.onSelectEnd.bind(this);t.addEventListener("selectend",s),this._onDestroyListeners.push(()=>{if(!B.isSessionActive(this.engine))return;let a=B.getSession(this.engine);a.removeEventListener("select",n),a.removeEventListener("selectstart",o),a.removeEventListener("selectend",s)}),this._onViewportResize()},i.onSelect=function(t){},i.onSelectStart=function(t){this.active&&(this.arTouchDown=!0,t.inputSource.handedness==this._handedness&&(this._isDown=!0,this._isRealDown=!0,this._lastIsDown||(this._isDownForUpWithDown=!0))),t.inputSource.handedness==this._handedness&&(this._isRealDown=!0)},i.onSelectEnd=function(t){this.active&&(this.arTouchDown=!1,t.inputSource.handedness==this._handedness&&(this._isDownForUpWithDown||(this._isUpWithNoDown=!0),this._isDown=!1,this._isRealDown=!1,this._isDownForUpWithDown=!1)),t.inputSource.handedness==this._handedness&&(this._isRealDown=!1)},i.onPointerMove=function(t){if(this.active){if(this._pointerID!=null&&this._pointerID!=t.pointerId)return;let n=r.getBody(this.engine).getBoundingClientRect();this.updateMouseData(t.clientX,t.clientY,n.width,n.height,t.pointerId)}},i.onClick=function(t){},i.onPointerDown=function(t){if(!(this._pointerID!=null&&this._pointerID!=t.pointerId||t.button!==0))if(this.active){let n=r.getBody(this.engine).getBoundingClientRect();this.updateMouseData(t.clientX,t.clientY,n.width,n.height,t.pointerId),this._isDown=!0,this._isRealDown=!0,this._lastIsDown||(this._isDownForUpWithDown=!0)}else this._isRealDown=!0},i.onPointerUp=function(t){if(!(this._pointerID!=null&&this._pointerID!=t.pointerId||t.button!==0))if(this.active){let n=r.getBody(this.engine).getBoundingClientRect();this.updateMouseData(t.clientX,t.clientY,n.width,n.height,t.pointerId),this._isDownForUpWithDown||(this._isUpWithNoDown=!0),this._isDown=!1,this._isRealDown=!1,this._isDownForUpWithDown=!1,this._updatePointerStyle=!0}else this._isRealDown=!1},i.updateMousePos=function(t,n,o,s){let a=t/o,l=n/s;this._direction.vec3_set(a*2-1,-l*2+1,-1),this.updateDirection()},i.updateMouseData=function(t,n,o,s,a){this._lastClientX=t,this._lastClientY=n,this._lastWidth=o,this._lastHeight=s,this._lastPointerID=a},i.updateDirection=function(){let e=j();return function(){this.object.pp_getPosition(this._origin),this._direction.vec3_transformMat4(this._projectionMatrix,this._direction),this._direction.vec3_normalize(this._direction),this._direction.vec3_transformQuat(this.object.pp_getTransformQuat(e),this._direction)}}(),i.onActivate=function(){this._isDown=!1,this._lastIsDown=!1,this._isDownForUpWithDown=!1,this._isUpWithNoDown=!1},i.onDeactivate=function(){this.hoveringObject&&(this.hoveringReality||(this.hoveringObjectTarget&&this.hoveringObjectTarget.onUnhover.notify(this.hoveringObject,this),this.globalTarget.onUnhover.notify(this.hoveringObject,this))),this.hoveringObject=null,this.hoveringObjectTarget=null,this.styleCursor&&(r.getBody(this.engine).style.cursor="default"),this._isDown=!1,this._lastIsDown=!1,this._isDownForUpWithDown=!1,this._isUpWithNoDown=!1,this._setCursorVisibility(!1),this.cursorRayObject&&this.cursorRayObject.pp_setActive(!1),this._pointerID=null,this._lastClientX=null,this._lastClientY=null,this._lastWidth=null,this._lastHeight=null},i.onDestroy=function(){this._hitTestObject!=null&&this._hitTestObject.pp_destroy();for(let t of this._onDestroyListeners)t()},i.notify=function(t,n=null){this.hoveringObject&&(this.hoveringObjectTarget&&this.hoveringObjectTarget[t].notify(target,this,n??void 0),this.globalTarget[t].notify(target,this,n??void 0))},i.pp_setViewComponent=function(t){if(this._viewComponent=t,this._viewComponent!=null&&(this._viewComponent.projectionMatrix.mat4_invert(this._projectionMatrix),!this._myViewEventListenersRegistered)){this._myViewEventListenersRegistered=!0;let n=this.onClick.bind(this);r.getCanvas(this.engine).addEventListener("click",n);let o=this.onPointerDown.bind(this);r.getCanvas(this.engine).addEventListener("pointerdown",o);let s=this.onPointerMove.bind(this);r.getCanvas(this.engine).addEventListener("pointermove",s);let a=this.onPointerUp.bind(this);r.getCanvas(this.engine).addEventListener("pointerup",a);let l=this._pp_onPointerLeave.bind(this);r.getCanvas(this.engine).addEventListener("pointerleave",l);let h=this._onViewportResize.bind(this);this.engine.onResize.add(h),this._onDestroyListeners.push(()=>{r.getCanvas(this.engine).removeEventListener("click",n),r.getCanvas(this.engine).removeEventListener("pointerdown",o),r.getCanvas(this.engine).removeEventListener("pointermove",s),r.getCanvas(this.engine).removeEventListener("pointerup",a),r.getCanvas(this.engine).removeEventListener("pointerleave",l),this.engine.onResize.remove(h),this._myViewEventListenersRegistered=!1})}},i._pp_onPointerLeave=function(t){(this._pointerID==null||this._pointerID==t.pointerId)&&(this._lastPointerID=null,this._lastClientX=null,this._lastClientY=null,this._lastWidth=null,this._lastHeight=null)},i._pp_isDownToProcess=function(){return this._isDown!==this._lastIsDown&&this._isDown},i._pp_isUpToProcess=function(){return this._isDown!==this._lastIsDown&&!this._isDown},i._pp_isMoving=function(){let e=m();return function(n){let o=!1;return e=this.hoveringObject.pp_convertPositionWorldToLocal(n,e),e.vec_equals(this._prevHitLocationLocalToTarget,1e-4)||(o=!0),o}}(),Ce.injectProperties(i,TD.prototype,!1,!0,!0)}import{Emitter as zo}from"@wonderlandengine/api";import{CursorTarget as SD}from"@wonderlandengine/components";function Wl(){vC()}function vC(){let i={};i.init=function(){this.onSingleClick=new zo,this.onDoubleClick=new zo,this.onTripleClick=new zo,this.onDownOnHover=new zo,this.onUpWithDown=new zo,this.onUpWithNoDown=new zo,this.isSurface=!1},i.start=function(){},i.update=function(t){},i.onActivate=function(){},i.onDeactivate=function(){},i.onDestroy=function(){},Ce.injectProperties(i,SD.prototype,!1,!0,!0)}import{MouseLookComponent as xD}from"@wonderlandengine/components";import{Emitter as vD}from"@wonderlandengine/api";var ie=class{constructor(e,t=!0){this._myDuration=e,this._myOnEndEmitter=new vD,this._myDone=!1,this._myJustDone=!1,this._myStarted=!1,t?this.start():this.reset()}start(e=null){this.reset(e),this._myStarted=!0}end(){this._done()}reset(e=null){e!=null&&(this._myDuration=Math.max(0,e)),this._myTimeLeft=this._myDuration,this._myDone=!1,this._myJustDone=!1,this._myStarted=!1}update(e){this._myJustDone=!1,this.isRunning()&&(this._myTimeLeft=Math.max(0,this._myTimeLeft-e),this._myTimeLeft==0&&this._done())}isDone(){return this._myDone}isJustDone(){return this._myJustDone}isStarted(){return this._myStarted}isRunning(){return this.isStarted()&&!this.isDone()}getDuration(){return this._myDuration}setDuration(e){this._myDuration=Math.max(0,e)}getTimeLeft(){return this._myTimeLeft}getPercentage(){let e=1;return this._myTimeLeft>0&&this._myDuration>0&&(e=(this._myDuration-this._myTimeLeft)/this._myDuration),Math.pp_clamp(e,0,1)}setPercentage(e){if(this.isRunning()){let t=Math.pp_clamp(1-e,0,1);this._myTimeLeft=this._myDuration*t}}onEnd(e,t=null){this._myOnEndEmitter.add(e,{id:t})}unregisterOnEnd(e=null){this._myOnEndEmitter.remove(e)}_done(){this._myTimeLeft=0,this._myDone=!0,this._myJustDone=!0,this._myOnEndEmitter.notify()}};function Ql(){xC()}function xC(){let i={};i.init=function(){this.pointerId=null,this.prevMoveEvent=null,this.resetMovingDelay=.15,this.resetMovingTimer=new ie(this.resetMovingDelay,!1),this.isMoving=!1,this.pointerMoveListener=this._onMove.bind(this),this.contextMenuListener=function(t){this.active&&t.preventDefault()}.bind(this),this.pointerDown=function(t){if(this.active){if(this.pointerId!=null)return;if(!this.mouseDown&&t.button==this.mouseButtonIndex&&(this.pointerId=t.pointerId,this.mouseDown=!0,r.getBody(this.engine).style.cursor="grabbing",t.button==1))return t.preventDefault(),!1}}.bind(this),this.pointerUp=function(t){if(this.active){if(t.pointerId!=this.pointerId)return;this.mouseDown&&t.button==this.mouseButtonIndex&&(this.mouseDown=!1,r.getBody(this.engine).style.cursor="initial")}}.bind(this),this.pointerLeave=function(t){if(this.active){if(t.pointerId!=this.pointerId)return;this.pointerId=null,this.prevMoveEvent=null,this.mouseDown&&(this.mouseDown=!1,r.getBody(this.engine).style.cursor="initial")}}.bind(this),r.getBody(this.engine).addEventListener("pointermove",this.pointerMoveListener),this.requireMouseDown&&(this.mouseButtonIndex==2&&r.getCanvas(this.engine).addEventListener("contextmenu",this.contextMenuListener,!1),r.getCanvas(this.engine).addEventListener("pointerdown",this.pointerDown),r.getBody(this.engine).addEventListener("pointerup",this.pointerUp)),r.getBody(this.engine).addEventListener("pointerleave",this.pointerLeave)},i.start=function(){},i.onActivate=function(){},i.onDeactivate=function(){},i.onDestroy=function(){r.getBody(this.engine).removeEventListener("pointermove",this.pointerMoveListener),r.getCanvas(this.engine).removeEventListener("contextmenu",this.contextMenuListener),r.getCanvas(this.engine).removeEventListener("pointerdown",this.pointerDown),r.getBody(this.engine).removeEventListener("pointerup",this.pointerUp),r.getBody(this.engine).removeEventListener("pointerleave",this.pointerLeave)},i.update=function(t){this.resetMovingTimer.isRunning()&&(this.resetMovingTimer.update(t),this.resetMovingTimer.isDone()&&(this.resetMovingTimer.reset(),this.isMoving=!1)),this.isMoving||((!this.requireMouseDown||!this.mouseDown)&&(this.pointerId=null),this.prevMoveEvent=null)},i._onMove=function(){let e=m(),t=m(),n=m(),o=m(),s=m(),a=m();return function(h){if(this.active){if(this.pointerId!=null&&h.pointerId!=this.pointerId)return;if(this.mouseDown||!this.requireMouseDown){e=this.object.pp_getBackward(e),t=this.object.pp_getUp(t),n.vec3_set(0,1,0),this.object.pp_getParent()!=null&&(n=this.object.pp_getParent().pp_getUp(n)),s=e.vec3_cross(n,s);let _=1;e.vec3_angle(n)<_?s=t.vec3_negate(s).vec3_cross(n,s):e.vec3_angle(n.vec3_negate(o))<_?s=t.vec3_cross(n,s):t.vec3_isConcordant(n)||s.vec3_negate(s),s.vec3_normalize(s);let y=h.movementX,c=h.movementY;(y==null||c==null)&&(this.prevMoveEvent!=null?(y=h.pageX-this.prevMoveEvent.pageX,c=h.pageY-this.prevMoveEvent.pageY):(y=0,c=0)),this.rotationX=-this.sensitity*y,this.rotationY=-this.sensitity*c,this.object.pp_rotateAxis(this.rotationY,s);let d=90-.001;a=this.object.pp_getUp(a);let g=Math.pp_angleClamp(a.vec3_angleSigned(n,s));if(Math.abs(g)>d){let P=(Math.abs(g)-d)*Math.pp_sign(g);this.object.pp_rotateAxis(P,s)}this.object.pp_rotateAxis(this.rotationX,n),this.prevMoveEvent=h,this.pointerId=h.pointerId,this.resetMovingTimer.start(this.resetMovingDelay),this.isMoving=!0}}}}(),Ce.injectProperties(i,xD.prototype,!1,!0,!0)}function ql(){Ul(),Wl(),Ql()}import{Emitter as MD}from"@wonderlandengine/api";function Xl(){MC()}function MC(){let i={};i._find=function(t){let n=this._listeners,o=null;for(let s=0;s<n.length;++s)if(n[s].id===t||n[s].callback===t){o=s;break}return o},i.pp_isEmpty=function(){return this._listeners.length<=0},Ce.injectProperties(i,MD.prototype,!1,!0,!0)}function Kl(){ql(),Xl()}function Jl(i){Nl(i),Kl()}function Zl(i){wl(),Jl(i)}function Yl(i){i.registerComponent(Ci,gi,dn,$t,un,hn,Tn,vn,xn,cn,wn,Hn,Ln,Fn,kn,fn,et,ti,gn,_n,Cn,Pn,Nn,Gn,Un,Wn,Qn,Xn,qn,Kn,Jn,zn,jn,fi,Pi,Si,On,Qi,kt,Ft,Ti,bi,xi,Lt,Ht,mn,ln,Mn,Dn,En,bn,Rn,Sn,pn,qi,vi,In,Xi,Ui,yn,An,Ki,Vn,ii,Wi,Bn,ei)}function $l(i){r.initEngine(i),N.setDefaultWLComponentCloneCallbacks(i),rl(i),Yl(i),Zl(i)}var vs=class{constructor(){this.myScene=null,this.myCauldron=null,this.myDynamics=null,this.myParticles=null,this.myVisualElements=null,this.myTools=null,this.myPlayerObjects=new Ir}},Ir=class{constructor(){this.myPlayer=null,this.myPlayerCauldron=null,this.myPlayerPivot=null,this.myCameraNonXR=null,this.myEyes=[],this.myEyeLeft=null,this.myEyeRight=null,this.myHands=[],this.myHandLeft=null,this.myHandRight=null,this.myHead=null}};var xs=class{constructor(){this.myMeshes=new Hr,this.myMaterials=new Lr}},Hr=class{constructor(){this.myPlane=null,this.myCube=null,this.mySphere=null,this.myCone=null,this.myCylinder=null,this.myCircle=null,this.myInvertedCube=null,this.myInvertedSphere=null,this.myInvertedCone=null,this.myInvertedCylinder=null}},Lr=class{constructor(){this.myFlatOpaque=null,this.myFlatTransparentNoDepth=null,this.myPhongOpaque=null,this.myText=null}};import{Component as nR,Property as Fs}from"@wonderlandengine/api";import{Component as RD}from"@wonderlandengine/api";import{Howler as em}from"howler";import{Emitter as ED}from"@wonderlandengine/api";import{Howl as DD}from"howler";var Ji=class{constructor(e=null){this.myAudioFilePath=e?e.slice(0):null,this.myLoop=!1,this.myAutoplay=!1,this.myVolume=1,this._myRate=1,this.myPool=5,this.myPreload=!0,this.myPreventPlayWhenAudioContextNotRunning=!1,this.myPosition=null,this.mySpatial=!0,this.myReferenceDistance=1}clone(){let e=new Ji;return e.myAudioFilePath=this.myAudioFilePath.slice(0),e.myLoop=this.myLoop,e.myAutoplay=this.myAutoplay,e.myVolume=this.myVolume,e.myPitch=this.myPitch,e.myRate=this.myRate,e.myPool=this.myPool,e.myPreload=this.myPreload,e.myPreventPlayWhenAudioContextNotRunning=this.myPreventPlayWhenAudioContextNotRunning,this.myPosition!=null?e.myPosition=this.myPosition.vec3_clone():e.myPosition=null,e.mySpatial=this.mySpatial,e.myReferenceDistance=this.myReferenceDistance,e}get myPitch(){return this._myRate}get myRate(){return this._myRate}set myPitch(e){this._myRate=e}set myRate(e){this._myRate=e}};var Ms={END:"end",STOP:"stop",LOAD:"load",LOAD_ERROR:"loaderror",PLAY:"play",PLAY_ERROR:"playerror",PAUSE:"pause",MUTE:"mute",VOLUME:"volume",RATE:"rate",SEEK:"seek",FADE:"fade",UNLOCK:"unlock"},Zn=class{constructor(e,t=!0){e==null?this._myAudioSetup=new Ji:typeof e=="string"?this._myAudioSetup=new Ji(e):this._myAudioSetup=e.clone(),this._myAudio=null,t&&(this._myAudio=new DD({src:[this._myAudioSetup.myAudioFilePath],loop:this._myAudioSetup.myLoop,volume:this._myAudioSetup.myVolume,autoplay:this._myAudioSetup.myAutoplay,rate:this._myAudioSetup.myRate,pool:this._myAudioSetup.myPool,pos:this._myAudioSetup.mySpatial?this._myAudioSetup.myPosition:null,refDistance:this._myAudioSetup.myReferenceDistance,preload:this._myAudioSetup.myPreload}),this._myAudio._pannerAttr.refDistance=this._myAudioSetup.myReferenceDistance),this._myLastAudioID=null,this._myAudioEventEmitters=new Map;for(let n in Ms)this._myAudioEventEmitters.set(Ms[n],new ED);t&&this._addListeners()}isValid(){return this._myAudio!=null}play(){if(Howler.state!="running"&&this._myAudioSetup.myPreventPlayWhenAudioContextNotRunning)return!1;let e=this._myAudio.play();return e!=null&&(this._myLastAudioID=e,this.updatePosition(this._myAudioSetup.myPosition,!0),this.updatePitch(this._myAudioSetup.myPitch,!0),this.updateVolume(this._myAudioSetup.myVolume,!0)),e!=null}stop(){this._myAudio.stop()}pause(){this._myAudio.pause()}resume(){this._myAudio.play()}isPlaying(e=!1){let t=!1;return e?t=this._myAudio.playing(this._myLastAudioID):t=this._myAudio.playing(),t}isLoaded(){return this._myAudio.state()=="loaded"}fade(e,t,n,o=!1){this.setVolume(t),o?this._myAudio.fade(e,t,n*1e3,this._myLastAudioID):this._myAudio.fade(e,t,n*1e3)}updatePosition(e,t=!1){this.setPosition(e),this._myAudioSetup.mySpatial&&e&&(t?this._myAudio.pos(e[0],e[1],e[2],this._myLastAudioID):this._myAudio.pos(e[0],e[1],e[2]))}updatePitch(e,t=!1){this.updateRate(e,t)}updateRate(e,t=!1){this.setRate(e),e!=null&&(t?this._myAudio.rate(e,this._myLastAudioID):this._myAudio.rate(e))}updateVolume(e,t=!1){this.setVolume(e),e!=null&&(t?this._myAudio.volume(e,this._myLastAudioID):this._myAudio.volume(e))}setSpatial(e){this._myAudioSetup.mySpatial=e}setPosition(e){this._myAudioSetup.myPosition=e}setPitch(e){this._myAudioSetup.myPitch=e}setRate(e){this._myAudioSetup.myRate=e}setVolume(e){this._myAudioSetup.myVolume=e}getDuration(){return this._myAudio.duration()}getVolume(){return this._myAudioSetup.myVolume}getPitch(){return this._myAudioSetup.myPitch}getRate(){return this._myAudioSetup.myRate}registerAudioEventListener(e,t,n){this._myAudioEventEmitters.get(e).add(t,n)}unregisterAudioEventListener(e,t){this._myAudioEventEmitters.get(e).remove(t)}_addListeners(){if(this._myAudio!=null)for(let e in Ms){let t=Ms[e];this._myAudio.on(t,function(n){this._myAudioEventEmitters.get(t).notify(n)}.bind(this))}}};var Es=class{constructor(){this._myAudioSetups=new Map}createAudioPlayer(e){return this.getAudioSetup(e)!=null?new Zn(this.getAudioSetup(e)):null}getAudioSetup(e){return this._myAudioSetups.get(e)}addAudioSetup(e,t,n=!0){this._myAudioSetups.set(e,t),n&&this.createAudioPlayer(e)}removeAudioSetup(e){this._myAudioSetups.delete(e)}setVolume(e){em.volume(e)}setMute(e){em.mute(e)}stop(){em.stop()}};var $t=class extends RD{init(){this._myAudioManager=null,r.hasAudioManager(this.engine)||(this._myAudioManager=new Es,r.setAudioManager(this._myAudioManager,this.engine))}onDestroy(){this._myAudioManager!=null&&r.getAudioManager(this.engine)==this._myAudioManager&&r.removeAudioManager(this.engine)}};R($t,"TypeName","pp-audio-manager"),R($t,"Properties",{});import{Component as kD}from"@wonderlandengine/api";var Mi=class{constructor(){this.myInitialPoolSize=0,this.myAmountToAddWhenEmpty=0,this.myPercentageToAddWhenEmpty=0,this.myCloneParams=void 0,this.myOptimizeObjectsAllocation=!0,this.myCloneCallback=void 0,this.mySetActiveCallback=void 0,this.myEqualCallback=void 0,this.myDestroyCallback=void 0,this.myOptimizeObjectsAllocationCallback=void 0,this.myLogEnabled=!1}},Yn=class{constructor(e,t){this._myObjectPoolParams=t,this._myPrototype=this._clone(e),this._myAvailableObjects=[],this._myBusyObjects=[],this._addToPool(t.myInitialPoolSize,!1),this._myDestroyed=!1}get(){let e=this._myAvailableObjects.shift();if(e==null){let t=Math.ceil(this._myBusyObjects.length*this._myObjectPoolParams.myPercentageToAddWhenEmpty);t+=this._myObjectPoolParams.myAmountToAddWhenEmpty,this._addToPool(t,this._myObjectPoolParams.myLogEnabled),e=this._myAvailableObjects.shift()}return e!=null&&this._myBusyObjects.push(e),e}release(e){let t=this._myBusyObjects.pp_remove(this._equals.bind(this,e));t!=null&&(this._setActive(t,!1),this._myAvailableObjects.push(t))}releaseAll(){for(let e of this._myBusyObjects)this._setActive(e,!1),this._myAvailableObjects.push(e)}increase(e){this._addToPool(e,!1)}increasePercentage(e){let t=Math.ceil(this.getSize()*e);this._addToPool(t,!1)}getSize(){return this._myBusyObjects.length+this._myAvailableObjects.length}getAvailableSize(){return this._myAvailableObjects.length}getBusySize(){return this._myAvailableObjects.length}_addToPool(e,t){if(!(e<=0)){this._myObjectPoolParams.myOptimizeObjectsAllocation&&(this._myObjectPoolParams.myOptimizeObjectsAllocationCallback!=null?this._myObjectPoolParams.myOptimizeObjectsAllocationCallback(this._myPrototype,e):this._myPrototype.pp_reserveObjects!=null&&this._myPrototype.pp_reserveObjects(e));for(let n=0;n<e;n++)this._myAvailableObjects.push(this._clone(this._myPrototype));t&&console.warn("Added new elements to the pool:",e)}}_clone(e){let t=null;return this._myObjectPoolParams.myCloneCallback!=null?t=this._myObjectPoolParams.myCloneCallback(e,this._myObjectPoolParams.myCloneParams):e.pp_clone!=null?t=e.pp_clone(this._myObjectPoolParams.myCloneParams):e.clone!=null&&(t=e.clone(this._myObjectPoolParams.myCloneParams)),t==null?console.error("Object not cloneable, pool will return null"):this._setActive(t,!1),t}_setActive(e,t){this._myObjectPoolParams.mySetActiveCallback!=null?this._myObjectPoolParams.mySetActiveCallback(e,t):e.pp_setActive!=null?e.pp_setActive(t):e.setActive!=null&&e.setActive(t)}_equals(e,t){let n=!1;return this._myObjectPoolParams.myEqualCallback!=null?n=this._myObjectPoolParams.myEqualCallback(e,t):e.pp_equals!=null?n=e.pp_equals(t):e.equals!=null?n=e.equals(t):n=e==t,n}destroy(){this._myDestroyed=!0;for(let e of this._myAvailableObjects)this._destroyObject(e);for(let e of this._myBusyObjects)this._destroyObject(e);this._destroyObject(this._myPrototype)}isDestroyed(){return this._myDestroyed}_destroyObject(e){this._myObjectPoolParams.myDestroyCallback!=null?this._myObjectPoolParams.myDestroyCallback(e):e.pp_destroy!=null?e.pp_destroy(active):e.destroy!=null&&e.destroy(active)}};var Ds=class{constructor(){this._myPools=new Map,this._myDestroyed=!1}addPool(e,t,n=new Mi){if(this._myPools.has(e))console.error("Pool already created with this ID");else{let o=new Yn(t,n);this._myPools.set(e,o)}}get(e){return this._myPools.has(e)?this._myPools.get(e).get():null}release(e,t){if(t===void 0)for(let n of this._myPools.values())n.release(e);else this._myPools.get(e).release(t)}releaseAll(e=void 0){if(e===void 0)for(let t of this._myPools.values())t.releaseAll();else this._myPools.get(e).releaseAll()}increase(e,t){let n=this._myPools.get(e);n&&n.increase(t)}increasePercentage(e,t){let n=this._myPools.get(e);n&&n.increasePercentage(t)}getPool(e){return this._myPools.get(e)}hasPool(e){return this._myPools.has(e)}destroy(){this._myDestroyed=!0;for(let e of this._myPools.values())e.destroy()}isDestroyed(){return this._myDestroyed}};import{MeshComponent as VD}from"@wonderlandengine/api";var xe={MESH:0,LINE:1,POINT:2,TEXT:3,ARROW:4,TRANSFORM:5,RAYCAST:6,TORUS:7};import{MeshComponent as AD}from"@wonderlandengine/api";var Ke=class{constructor(e=r.getMainEngine()){this.myStart=m(),this.myDirection=m(0,0,1),this.myLength=0,this.myThickness=.005,this.myMesh=null,this.myMaterial=null,this.myColor=null,this.myParent=r.getSceneObjects(e).myVisualElements,this.myLocal=!1,this.myType=xe.LINE}setStartEnd(e,t){return t.vec3_sub(e,this.myDirection),this.myLength=this.myDirection.vec3_length(),this.myDirection.vec3_normalize(this.myDirection),this.myStart.vec3_copy(e),this}copy(e){}},rt=class{constructor(e=new Ke){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myLineParentObject=null,this._myLineObject=null,this._myLineMeshComponent=null,this._myFlatOpaqueMaterial=null,this._myDestroyed=!1,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){this._myVisible!=e&&(this._myVisible=e,this._myLineParentObject.pp_setActive(e))}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1)}_build(){this._myLineParentObject=r.getSceneObjects(this._myParams.myParent.pp_getEngine()).myVisualElements.pp_addObject(),this._myLineObject=this._myLineParentObject.pp_addObject(),this._myLineMeshComponent=this._myLineObject.pp_addComponent(AD)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new Ke(this._myParams.myParent.pp_getEngine());e.copy(this._myParams);let t=new rt(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}_refresh(){}destroy(){this._myDestroyed=!0,this._myLineParentObject.pp_destroy()}isDestroyed(){return this._myDestroyed}};rt.prototype._refresh=function(){let i=m(),e=m(),t=m(0,1,0);return function(){this._myLineParentObject.pp_setParent(this._myParams.myParent,!1),this._myParams.myLocal?this._myLineParentObject.pp_setPositionLocal(this._myParams.myStart):this._myLineParentObject.pp_setPosition(this._myParams.myStart),i.vec3_set(this._myParams.myThickness/2,this._myParams.myLength/2,this._myParams.myThickness/2),this._myParams.myLocal?this._myLineObject.pp_setScaleLocal(i):this._myLineObject.pp_setScale(i),this._myParams.myLocal?this._myLineObject.pp_setUpLocal(this._myParams.myDirection,t):this._myLineObject.pp_setUp(this._myParams.myDirection,t),this._myLineObject.pp_resetPositionLocal(),e.vec3_set(0,this._myParams.myLength/2,0),this._myLineObject.pp_translateObject(e),this._myParams.myMesh!=null?this._myLineMeshComponent.mesh=this._myParams.myMesh:this._myLineMeshComponent.mesh=r.getDefaultMeshes(this._myParams.myParent.pp_getEngine()).myCylinder,this._myParams.myMaterial==null?this._myParams.myColor==null?this._myLineMeshComponent.material=r.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myMesh:(this._myFlatOpaqueMaterial==null&&(this._myFlatOpaqueMaterial=r.getDefaultMaterials(this._myParams.myParent.pp_getEngine()).myFlatOpaque.clone()),this._myLineMeshComponent.material=this._myFlatOpaqueMaterial,this._myFlatOpaqueMaterial.color=this._myParams.myColor):this._myLineMeshComponent.material=this._myParams.myMaterial}}();Ke.prototype.copy=function(e){this.myStart.vec3_copy(e.myStart),this.myDirection.vec3_copy(e.myDirection),this.myLength=e.myLength,this.myThickness=e.myThickness,this.myMesh=e.myMesh,e.myMaterial!=null?this.myMaterial=e.myMaterial.clone():this.myMaterial=null,e.myColor!=null?this.myColor!=null?this.myColor.vec4_copy(e.myColor):this.myColor=e.myColor.vec4_clone():this.myColor=null,this.myParent=e.myParent,this.myLocal=e.myLocal,this.myType=e.myType};var tt=class{constructor(e=r.getMainEngine()){this.myStart=m(),this.myDirection=m(0,0,1),this.myLength=0,this.myThickness=.005,this.myLineMesh=null,this.myArrowMesh=null,this.myMaterial=null,this.myColor=null,this.myParent=r.getSceneObjects(e).myVisualElements,this.myLocal=!1,this.myType=xe.ARROW}setStartEnd(e,t){return t.vec3_sub(e,this.myDirection),this.myLength=this.myDirection.vec3_length(),this.myDirection.vec3_normalize(this.myDirection),this.myStart.vec3_copy(e),this}copy(e){}},ht=class{constructor(e=new tt){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myVisualLine=new rt(new Ke(this._myParams.myParent.pp_getEngine())),this._myVisualLine.setAutoRefresh(!1),this._myArrowParentObject=null,this._myArrowObject=null,this._myArrowMeshComponent=null,this._myFlatOpaqueMaterial=null,this._myDestroyed=!1,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){this._myVisible!=e&&(this._myVisible=e,this._myVisualLine.setVisible(e),this._myArrowParentObject.pp_setActive(e))}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh(),this._myVisualLine.forceRefresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1),this._myVisualLine.update(e)}_build(){this._myArrowParentObject=r.getSceneObjects(this._myParams.myParent.pp_getEngine()).myVisualElements.pp_addObject(),this._myArrowObject=this._myArrowParentObject.pp_addObject(),this._myArrowMeshComponent=this._myArrowObject.pp_addComponent(VD)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new tt(this._myParams.myParent.pp_getEngine());e.copy(this._myParams);let t=new ht(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}_refresh(){}destroy(){this._myDestroyed=!0,this._myVisualLine.destroy(),this._myArrowParentObject.pp_destroy()}isDestroyed(){return this._myDestroyed}};ht.prototype._refresh=function(){let i=m(),e=m(),t=m(),n=m(),o=m(0,1,0);return function(){this._myArrowParentObject.pp_setParent(this._myParams.myParent,!1),this._myParams.myDirection.vec3_scale(Math.max(.001,this._myParams.myLength-this._myParams.myThickness*4),i),i.vec3_add(this._myParams.myStart,i),this._myParams.myLocal?(this._myArrowParentObject.pp_setPositionLocal(i),this._myArrowParentObject.pp_setUpLocal(this._myParams.myDirection,o)):(this._myArrowParentObject.pp_setPosition(i),this._myArrowParentObject.pp_setUp(this._myParams.myDirection,o)),e.vec3_set(0,this._myParams.myThickness*2-1e-5,0),this._myArrowParentObject.pp_translateObject(e),t.vec3_set(this._myParams.myThickness*1.25,this._myParams.myThickness*2,this._myParams.myThickness*1.25),this._myParams.myLocal?this._myArrowObject.pp_setScaleLocal(t):this._myArrowObject.pp_setScale(t),this._myParams.myArrowMesh!=null?this._myArrowMeshComponent.mesh=this._myParams.myArrowMesh:this._myArrowMeshComponent.mesh=r.getDefaultMeshes(this._myParams.myParent.pp_getEngine()).myCone,this._myParams.myMaterial==null?this._myParams.myColor==null?this._myArrowMeshComponent.material=r.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myMesh:(this._myFlatOpaqueMaterial==null&&(this._myFlatOpaqueMaterial=r.getDefaultMaterials(this._myParams.myParent.pp_getEngine()).myFlatOpaque.clone()),this._myArrowMeshComponent.material=this._myFlatOpaqueMaterial,this._myFlatOpaqueMaterial.color=this._myParams.myColor):this._myArrowMeshComponent.material=this._myParams.myMaterial,n=i.vec3_sub(this._myParams.myStart,n);let a=this._myVisualLine.getParams();a.myStart.vec3_copy(this._myParams.myStart),a.myDirection=n.vec3_normalize(a.myDirection),a.myLength=n.vec3_length(),a.myThickness=this._myParams.myThickness,a.myMesh=this._myParams.myLineMesh,a.myMaterial=this._myArrowMeshComponent.material,a.myParent=this._myParams.myParent,a.myLocal=this._myParams.myLocal,this._myVisualLine.paramsUpdated()}}();tt.prototype.copy=function(e){this.myStart.vec3_copy(e.myStart),this.myDirection.vec3_copy(e.myDirection),this.myLength=e.myLength,this.myThickness=e.myThickness,this.myArrowMesh=e.myArrowMesh,this.myLineMesh=e.myLineMesh,e.myMaterial!=null?this.myMaterial=e.myMaterial.clone():this.myMaterial=null,e.myColor!=null?this.myColor!=null?this.myColor.vec4_copy(e.myColor):this.myColor=e.myColor.vec4_clone():this.myColor=null,this.myParent=e.myParent,this.myLocal=e.myLocal,this.myType=e.myType};import{MeshComponent as OD}from"@wonderlandengine/api";var ni=class{constructor(e=r.getMainEngine()){this.myTransform=be(),this.myMesh=null,this.myMaterial=null,this.myParent=r.getSceneObjects(e).myVisualElements,this.myLocal=!1,this.myType=xe.MESH}copy(e){}},Ei=class{constructor(e=new ni){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myMeshObject=null,this._myMeshComponent=null,this._myDestroyed=!1,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){this._myVisible!=e&&(this._myVisible=e,this._myMeshObject.pp_setActive(e))}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1)}_refresh(){this._myMeshObject.pp_setParent(this._myParams.myParent,!1),this._myParams.myLocal?this._myMeshObject.pp_setTransformLocal(this._myParams.myTransform):this._myMeshObject.pp_setTransform(this._myParams.myTransform),this._myParams.myMesh==null?this._myMeshComponent.mesh=r.getDefaultMeshes(this._myParams.myParent.pp_getEngine()).mySphere:this._myMeshComponent.mesh=this._myParams.myMesh,this._myParams.myMaterial==null?this._myMeshComponent.material=r.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myMesh:this._myMeshComponent.material=this._myParams.myMaterial}_build(){this._myMeshObject=r.getSceneObjects(this._myParams.myParent.pp_getEngine()).myVisualElements.pp_addObject(),this._myMeshComponent=this._myMeshObject.pp_addComponent(OD)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new ni(this._myParams.myParent.pp_getEngine());e.copy(this._myParams);let t=new Ei(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}destroy(){this._myDestroyed=!0,this._myMeshObject.pp_destroy()}isDestroyed(){return this._myDestroyed}};ni.prototype.copy=function(e){this.myTransform.pp_copy(e.myTransform),e.myMesh!=null?this.myMesh=e.myMesh:this.myMesh=null,e.myMaterial!=null?this.myMaterial=e.myMaterial.clone():this.myMaterial=null,this.myParent=e.myParent,this.myLocal=e.myLocal,this.myType=e.myType};import{MeshComponent as BD}from"@wonderlandengine/api";var vt=class{constructor(e=r.getMainEngine()){this.myPosition=m(),this.myRadius=.005,this.myMesh=null,this.myMaterial=null,this.myColor=null,this.myParent=r.getSceneObjects(e).myVisualElements,this.myLocal=!1,this.myType=xe.POINT}copy(e){}},wt=class{constructor(e=new vt){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myPointObject=null,this._myPointMeshComponent=null,this._myFlatOpaqueMaterial=null,this._myDestroyed=!1,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){this._myVisible!=e&&(this._myVisible=e,this._myPointObject.pp_setActive(e))}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1)}_build(){this._myPointObject=r.getSceneObjects(this._myParams.myParent.pp_getEngine()).myVisualElements.pp_addObject(),this._myPointMeshComponent=this._myPointObject.pp_addComponent(BD)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new vt(this._myParams.myParent.pp_getEngine());e.copy(this._myParams);let t=new wt(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}_refresh(){}destroy(){this._myDestroyed=!0,this._myPointObject.pp_destroy()}isDestroyed(){return this._myDestroyed}};wt.prototype._refresh=function(){let i=m(0,0,0);return function(){this._myPointObject.pp_setParent(this._myParams.myParent,!1),this._myParams.myLocal?(this._myPointObject.pp_setPositionLocal(this._myParams.myPosition),this._myPointObject.pp_setRotationLocal(i),this._myPointObject.pp_setScaleLocal(this._myParams.myRadius)):(this._myPointObject.pp_setPosition(this._myParams.myPosition),this._myPointObject.pp_setRotation(i),this._myPointObject.pp_setScale(this._myParams.myRadius)),this._myParams.myMesh!=null?this._myPointMeshComponent.mesh=this._myParams.myMesh:this._myPointMeshComponent.mesh=r.getDefaultMeshes(this._myParams.myParent.pp_getEngine()).mySphere,this._myParams.myMaterial==null?this._myParams.myColor==null?this._myPointMeshComponent.material=r.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myMesh:(this._myFlatOpaqueMaterial==null&&(this._myFlatOpaqueMaterial=r.getDefaultMaterials(this._myParams.myParent.pp_getEngine()).myFlatOpaque.clone()),this._myPointMeshComponent.material=this._myFlatOpaqueMaterial,this._myFlatOpaqueMaterial.color=this._myParams.myColor):this._myPointMeshComponent.material=this._myParams.myMaterial}}();vt.prototype.copy=function(e){this.myPosition.vec3_copy(e.myPosition),this.myRadius=e.myRadius,this.myMesh=e.myMesh,e.myMaterial!=null?this.myMaterial=e.myMaterial.clone():this.myMaterial=null,e.myColor!=null?this.myColor!=null?this.myColor.vec4_copy(e.myColor):this.myColor=e.myColor.vec4_clone():this.myColor=null,this.myParent=e.myParent,this.myLocal=e.myLocal,this.myType=e.myType};var EC=["0","1","2","3","4","5","6","7"];function DC(i){EC=i}function RC(){return EC}var AC=function(){let i=m(),e=m(),t=(n,o)=>n.pp_equals(o);return function(o,s=new Le){let a=o.myPhysics.rayCast(o.myOrigin,o.myDirection,o.myBlockLayerFlags.getMask(),o.myDistance);s.myRaycastParams==null&&(s.myRaycastParams=new ct(o.myPhysics)),s.myRaycastParams.copy(o);let l=0,h=0,_=a.hitCount;if(_!=0){let y=null,c=null,d=null,g=null;e=o.myDirection.vec3_negate(e);for(let P=0;P<_;P++){if(o.myObjectsToIgnore.length!=0&&(y==null&&(y=a.objects),o.myObjectsToIgnore.pp_hasEqual(y[P],t)))continue;c==null&&(c=a.distances);let T=c[P]==0;if(T&&(d==null&&(d=a.locations),T&&=o.myOrigin.vec3_sub(d[P],i).vec3_isZero(Math.PP_EPSILON),T&&(g||(g=a.normals),T&&=e.vec3_equals(g[P],Math.PP_EPSILON_DEGREES))),!o.myIgnoreHitsInsideCollision||!T){let C=null;l<s.myHits.length?C=s.myHits[l]:s._myUnusedHits!=null&&s._myUnusedHits.length>0?(C=s._myUnusedHits.pop(),s.myHits.push(C)):(C=new lt,s.myHits.push(C)),y==null&&(y=a.objects),d==null&&(d=a.locations),g==null&&(g=a.normals),C.myPosition.vec3_copy(d[P]),C.myNormal.vec3_copy(g[P]),C.myDistance=c[P],C.myObject=y[P],C.myInsideCollision=T,h++,l++}}}if(s.myHits.length>h){s._myUnusedHits==null&&(s._myUnusedHits=[]);let y=s.myHits.length-h;for(let c=0;c<y;c++)s._myUnusedHits.push(s.myHits.pop())}return s}}(),Me={setLayerFlagsNames:DC,getLayerFlagsNames:RC,raycast:AC};var Re=class{constructor(){this._myLayerMask=0}setFlagActive(e,t){let n=e;if(isNaN(e)&&(n=Me.getLayerFlagsNames().pp_findIndexEqual(e)),n>=0&&n<Me.getLayerFlagsNames().length){let o=1<<n;t?this._myLayerMask=this._myLayerMask|o:this._myLayerMask=this._myLayerMask&~o}}isFlagActive(e){let t=e;isNaN(e)&&(t=Me.getLayerFlagsNames().pp_findIndexEqual(e));let n=!1;if(t>=0&&t<Me.getLayerFlagsNames().length){let o=1<<t;n=!!(this._myLayerMask&o)}return n}setAllFlagsActive(e){e?this._myLayerMask=Math.pow(2,Me.getLayerFlagsNames().length)-1:this._myLayerMask=0}add(e){this._myLayerMask=this._myLayerMask|e.getMask()}remove(e){this._myLayerMask=this._myLayerMask&~e.getMask()}intersect(e){this._myLayerMask=this._myLayerMask&e.getMask()}copy(e){this._myLayerMask=e._myLayerMask}getMask(){return this._myLayerMask}setMask(e){this._myLayerMask=e}};var ct=class{constructor(e=r.getPhysics()){this.myOrigin=m(),this.myDirection=m(),this.myDistance=0,this.myBlockLayerFlags=new Re,this.myObjectsToIgnore=[],this.myIgnoreHitsInsideCollision=!1,this.myPhysics=e}copy(e){this.myOrigin.vec3_copy(e.myOrigin),this.myDirection.vec3_copy(e.myDirection),this.myDistance=e.myDistance,this.myBlockLayerFlags.copy(e.myBlockLayerFlags),this.myObjectsToIgnore.pp_copy(e.myObjectsToIgnore),this.myIgnoreHitsInsideCollision=e.myIgnoreHitsInsideCollision,this.myPhysics=e.myPhysics}reset(){this.myOrigin.vec3_zero(),this.myDirection.vec3_zero(),this.myDistance=0,this.myBlockLayerFlags.setAllFlagsActive(!1),this.myObjectsToIgnore.pp_clear(),this.myIgnoreHitsInsideCollision=!1}},Le=class{constructor(){this.myRaycastParams=null,this.myHits=[],this._myUnusedHits=null}isColliding(e=!1){return e?this.getFirstHitOutsideCollision()!=null:this.myHits.length>0}getFirstHitInsideCollision(){let e=null;for(let t of this.myHits)if(t.myInsideCollision){e=t;break}return e}getFirstHitOutsideCollision(){let e=null;for(let t of this.myHits)if(!t.myInsideCollision){e=t;break}return e}getHitsInsideCollision(){let e=[];for(let t of this.myHits)t.myInsideCollision&&e.push(t);return e}getHitsOutsideCollision(){let e=[];for(let t of this.myHits)t.myInsideCollision||e.push(t);return e}removeHit(e){let t=this.myHits.pp_removeIndex(e);return t!=null&&(this._myUnusedHits==null&&(this._myUnusedHits=[]),this._myUnusedHits.push(t)),t}removeAllHits(){this._myUnusedHits==null&&(this._myUnusedHits=[]),this._myUnusedHits.push(...this.myHits),this.myHits.pp_clear()}copy(e){}reset(){this.myRaycastParams!=null&&this.myRaycastParams.reset(),this.removeAllHits()}},lt=class{constructor(){this.myPosition=m(),this.myNormal=m(),this.myDistance=0,this.myObject=null,this.myInsideCollision=!1}isValid(){return this.myObject!=null}copy(e){this.myPosition.vec3_copy(e.myPosition),this.myNormal.vec3_copy(e.myNormal),this.myDistance=e.myDistance,this.myObject=e.myObject,this.myInsideCollision=e.myInsideCollision}reset(){this.myPosition.vec3_zero(),this.myNormal.vec3_zero(),this.myDistance=0,this.myObject=null,this.myInsideCollision=!1}};Le.prototype.copy=function(){let i=function(e,t){return e==null&&(e=new lt),e.copy(t),e};return function(t){if(t.myRaycastParams==null?this.myRaycastParams=null:(this.myRaycastParams==null&&(this.myRaycastParams=new ct(t.myRaycastParams.myPhysics)),this.myRaycastParams.copy(t.myRaycastParams)),this.myHits.length>t.myHits.length){this._myUnusedHits==null&&(this._myUnusedHits=[]);for(let n=0;n<this.myHits.length-t.myHits.length;n++)this._myUnusedHits.push(this.myHits.pop())}else if(this.myHits.length<t.myHits.length&&this._myUnusedHits!=null){let n=Math.min(this._myUnusedHits.length,t.myHits.length-this.myHits.length);for(let o=0;o<n;o++)this.myHits.push(this._myUnusedHits.pop())}this.myHits.pp_copy(t.myHits,i)}}();var oi=class{constructor(e=r.getMainEngine()){this._myRaycastResults=new Le,this.myHitNormalLength=.2,this.myThickness=.005,this.myShowOnlyFirstHit=!0,this.myRayMaterial=null,this.myHitNormalMaterial=null,this.myParent=r.getSceneObjects(e).myVisualElements,this.myLocal=!1,this.myType=xe.RAYCAST}get myRaycastResults(){return this._myRaycastResults}set myRaycastResults(e){this._myRaycastResults.copy(e)}copy(e){}},$n=class{constructor(e=new oi){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myVisualRaycast=new ht(new tt(this._myParams.myParent.pp_getEngine())),this._myVisualRaycast.setAutoRefresh(!1),this._myVisualRaycastHitList=[],this._myDestroyed=!1,this._addVisualRaycastHit(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){if(this._myVisible!=e)if(this._myVisible=e,this._myVisible){if(this._myParams.myRaycastResults.myRaycastParams!=null&&this._myVisualRaycast.setVisible(!0),this._myParams.myRaycastResults.myHits.length>0){let t=Math.min(this._myParams.myRaycastResults.myHits.length,this._myVisualRaycastHitList.length);for(let n=0;n<t;n++)this._myVisualRaycastHitList[n].setVisible(!0)}}else{this._myVisualRaycast.setVisible(!1);for(let t of this._myVisualRaycastHitList)t.setVisible(!1)}}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){if(this._refresh(),this._myVisualRaycast.forceRefresh(),this._myParams.myRaycastResults.myHits.length>0){let e=Math.min(this._myParams.myRaycastResults.myHits.length,this._myVisualRaycastHitList.length);for(let t=0;t<e;t++)this._myVisualRaycastHitList[t].forceRefresh()}}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1),this._myVisualRaycast.update(e);for(let t of this._myVisualRaycastHitList)t.update(e)}_refresh(){for(let e of this._myVisualRaycastHitList)e.setVisible(!1);if(this._myParams.myRaycastResults.myHits.length>0){let e=this._myParams.myShowOnlyFirstHit?this._myParams.myRaycastResults.myHits.pp_first().myDistance:this._myParams.myRaycastResults.myHits.pp_last().myDistance;{let n=this._myVisualRaycast.getParams();n.myStart.vec3_copy(this._myParams.myRaycastResults.myRaycastParams.myOrigin),n.myDirection.vec3_copy(this._myParams.myRaycastResults.myRaycastParams.myDirection),n.myLength=e,n.myThickness=this._myParams.myThickness,this._myParams.myRayMaterial==null?n.myMaterial=r.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myRay:n.myMaterial=this._myParams.myRayMaterial,n.myParent=this._myParams.myParent,n.myLocal=this._myParams.myLocal,this._myVisualRaycast.paramsUpdated(),this._myVisualRaycast.setVisible(this._myVisible)}let t=this._myParams.myShowOnlyFirstHit?1:this._myParams.myRaycastResults.myHits.length;for(;t>this._myVisualRaycastHitList.length;)this._addVisualRaycastHit();for(let n=0;n<t;n++){let o=this._myVisualRaycastHitList[n];{let s=o.getParams();s.myStart.vec3_copy(this._myParams.myRaycastResults.myHits[n].myPosition),s.myDirection.vec3_copy(this._myParams.myRaycastResults.myHits[n].myNormal),s.myLength=this._myParams.myHitNormalLength,s.myThickness=this._myParams.myThickness,this._myParams.myHitNormalMaterial==null?s.myMaterial=r.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myHitNormal:s.myMaterial=this._myParams.myHitNormalMaterial,s.myParent=this._myParams.myParent,s.myLocal=this._myParams.myLocal,o.paramsUpdated(),o.setVisible(this._myVisible)}}}else if(this._myParams.myRaycastResults.myRaycastParams!=null){let e=this._myVisualRaycast.getParams();e.myStart.vec3_copy(this._myParams.myRaycastResults.myRaycastParams.myOrigin),e.myDirection.vec3_copy(this._myParams.myRaycastResults.myRaycastParams.myDirection),e.myLength=this._myParams.myRaycastResults.myRaycastParams.myDistance,e.myThickness=this._myParams.myThickness,this._myParams.myRayMaterial==null?e.myMaterial=r.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myRay:e.myMaterial=this._myParams.myRayMaterial,e.myParent=this._myParams.myParent,e.myLocal=this._myParams.myLocal,this._myVisualRaycast.paramsUpdated(),this._myVisualRaycast.setVisible(this._myVisible)}else this._myVisualRaycast.setVisible(!1)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new oi(this._myParams.myParent.pp_getEngine());e.copy(this._myParams);let t=new $n(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}_addVisualRaycastHit(){let e=new ht(new tt(this._myParams.myParent.pp_getEngine()));e.setAutoRefresh(!1),e.setVisible(!1),this._myVisualRaycastHitList.push(e)}destroy(){this._myDestroyed=!0,this._myVisualRaycast.destroy();for(let e of this._myVisualRaycastHitList)e.destroy()}isDestroyed(){return this._myDestroyed}};oi.prototype.copy=function(e){this.myRaycastResults=e.myRaycastResults,this.myHitNormalLength=e.myHitNormalLength,this.myThickness=e.myThickness,this.myShowOnlyFirstHit=e.myShowOnlyFirstHit,e.myRayMaterial!=null?this.myRayMaterial=e.myRayMaterial.clone():this.myRayMaterial=null,e.myHitNormalMaterial!=null?this.myHitNormalMaterial=e.myHitNormalMaterial.clone():this.myHitNormalMaterial=null,this.myParent=e.myParent,this.myLocal=e.myLocal,this.myType=e.myType};import{Alignment as ID,Justification as HD,TextComponent as LD}from"@wonderlandengine/api";var Vt=class{constructor(e=r.getMainEngine()){this.myText="",this.myAlignment=ID.Center,this.myJustification=HD.Middle,this.myTransform=be(),this.myMaterial=null,this.myColor=null,this.myParent=r.getSceneObjects(e).myVisualElements,this.myLocal=!1,this.myType=xe.TEXT}copy(e){}},Di=class{constructor(e=new Vt){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myTextObject=null,this._myTextComponent=null,this._myTextMaterial=null,this._myDestroyed=!1,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){this._myVisible!=e&&(this._myVisible=e,this._myTextObject.pp_setActive(e))}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1)}_refresh(){this._myTextObject.pp_setParent(this._myParams.myParent,!1),this._myParams.myLocal?this._myTextObject.pp_setTransformLocal(this._myParams.myTransform):this._myTextObject.pp_setTransform(this._myParams.myTransform),this._myParams.myMaterial==null?this._myParams.myColor==null?this._myTextComponent.material=r.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myText:(this._myTextMaterial==null&&(this._myTextMaterial=r.getDefaultMaterials(this._myParams.myParent.pp_getEngine()).myText.clone()),this._myTextComponent.material=this._myTextMaterial,this._myTextMaterial.color=this._myParams.myColor):this._myTextComponent.material=this._myParams.myMaterial,this._myTextComponent.text=this._myParams.myText,this._myTextComponent.alignment=this._myParams.myAlignment,this._myTextComponent.justification=this._myParams.myJustification,this._myDirty=!1}_build(){this._myTextObject=r.getSceneObjects(this._myParams.myParent.pp_getEngine()).myVisualElements.pp_addObject(),this._myTextComponent=this._myTextObject.pp_addComponent(LD)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new Vt(this._myParams.myParent.pp_getEngine());e.copy(this._myParams);let t=new Di(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}destroy(){this._myDestroyed=!0,this._myTextObject.pp_destroy()}isDestroyed(){return this._myDestroyed}};Vt.prototype.copy=function(e){this.myText=e.myText,this.myAlignment=e.myAlignment,this.myJustification=e.myJustification,this.myTransform.mat4_copy(e.myTransform),e.myMaterial!=null?this.myMaterial=e.myMaterial.clone():this.myMaterial=null,e.myColor!=null?this.myColor!=null?this.myColor.vec4_copy(e.myColor):this.myColor=e.myColor.vec4_clone():this.myColor=null,this.myParent=e.myParent,this.myLocal=e.myLocal,this.myType=e.myType};var jt=class{constructor(e=r.getMainEngine()){this.myTransform=be(),this.myRadius=0,this.mySegmentsAmount=12,this.mySegmentThickness=.05,this.mySegmentMesh=null,this.myMaterial=null,this.myColor=null,this.myParent=r.getSceneObjects(e).myVisualElements,this.myLocal=!1,this.myType=xe.TORUS}copy(e){}},zt=class{constructor(e=new jt){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myTorusParentObject=null,this._myVisualSegmentList=[],this._myFlatOpaqueMaterial=null,this._myDestroyed=!1,this._build(),this.forceRefresh(),this.setVisible(!0)}setVisible(e){if(this._myVisible!=e)if(this._myVisible=e,this._myVisible){let t=Math.min(this._myParams.mySegmentsAmount,this._myVisualSegmentList.length);for(let n=0;n<t;n++)this._myVisualSegmentList[n].setVisible(!0)}else for(let t of this._myVisualSegmentList)t.setVisible(!1)}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh();let e=Math.min(this._myParams.mySegmentsAmount,this._myVisualSegmentList.length);for(let t=0;t<e;t++)this._myVisualSegmentList[t].forceRefresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1);for(let t of this._myVisualSegmentList)t.update(e)}_build(){this._myTorusParentObject=r.getSceneObjects(this._myParams.myParent.pp_getEngine()).myVisualElements.pp_addObject(),this._fillSegmentList()}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}_fillSegmentList(){for(;this._myVisualSegmentList.length<this._myParams.mySegmentsAmount;){let e=new rt(new Ke(this._myParams.myParent.pp_getEngine()));e.setAutoRefresh(!1),e.setVisible(!1),e.getParams().myParent=this._myTorusParentObject,e.getParams().myLocal=!0,this._myVisualSegmentList.push(e)}}clone(){let e=new jt(this._myParams.myParent.pp_getEngine());e.copy(this._myParams);let t=new zt(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}_refresh(){}destroy(){this._myDestroyed=!0;for(let e of this._myVisualSegmentList)e.destroy();this._myTorusParentObject.pp_destroy()}isDestroyed(){return this._myDestroyed}};zt.prototype._refresh=function(){let i=m(),e=m(),t=m(),n=m(),o=m(),s=m(0,1,0);return function(){this._fillSegmentList();for(let h of this._myVisualSegmentList)h.setVisible(!1);this._myTorusParentObject.pp_setParent(this._myParams.myParent,!1),this._myParams.myLocal?this._myTorusParentObject.pp_setTransformLocal(this._myParams.myTransform):this._myTorusParentObject.pp_setTransform(this._myParams.myTransform);let l=2*Math.PI/this._myParams.mySegmentsAmount;i.vec3_set(this._myParams.myRadius,0,0);for(let h=0;h<this._myParams.mySegmentsAmount;h++){e=i.vec3_rotateAxisRadians(l,s,e),t=e.vec3_sub(i,t).vec3_normalize(t);let _=Math.tan(l/2)*this._myParams.mySegmentThickness/2;n=i.vec3_sub(t.vec3_scale(_,n),n),o=e.vec3_add(t.vec3_scale(_,o),o);let y=this._myVisualSegmentList[h],c=y.getParams();c.setStartEnd(n,o),c.myThickness=this._myParams.mySegmentThickness,c.myMesh=this._myParams.mySegmentMesh,this._myParams.myMaterial==null?this._myParams.myColor==null?c.myMaterial=r.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myMesh:(this._myFlatOpaqueMaterial==null&&(this._myFlatOpaqueMaterial=r.getDefaultMaterials(this._myParams.myParent.pp_getEngine()).myFlatOpaque.clone()),c.myMaterial=this._myFlatOpaqueMaterial,this._myFlatOpaqueMaterial.color=this._myParams.myColor):c.myMaterial=this._myParams.myMaterial,y.paramsUpdated(),y.setVisible(this._myVisible),i.vec3_copy(e)}}}();jt.prototype.copy=function(e){this.myRadius=e.myRadius,this.mySegmentsAmount=e.mySegmentsAmount,this.mySegmentThickness=e.mySegmentThickness,this.myTransform.mat4_copy(e.myTransform),this.mySegmentMesh=e.mySegmentMesh,e.myMaterial!=null?this.myMaterial=e.myMaterial.clone():this.myMaterial=null,e.myColor!=null?this.myColor!=null?this.myColor.vec4_copy(e.myColor):this.myColor=e.myColor.vec4_clone():this.myColor=null,this.myParent=e.myParent,this.myLocal=e.myLocal,this.myType=e.myType};var Ot=class{constructor(e=r.getMainEngine()){this.myTransform=be(),this.myLength=.2,this.myThickness=.005,this.myForwardMaterial=null,this.myUpMaterial=null,this.myRightMaterial=null,this.myParent=r.getSceneObjects(e).myVisualElements,this.myLocal=!1,this.myType=xe.TRANSFORM}copy(e){}},si=class{constructor(e=new Ot){this._myParams=e,this._myVisible=!1,this._myAutoRefresh=!0,this._myDirty=!1,this._myVisualRight=new ht(new tt(this._myParams.myParent.pp_getEngine())),this._myVisualUp=new ht(new tt(this._myParams.myParent.pp_getEngine())),this._myVisualForward=new ht(new tt(this._myParams.myParent.pp_getEngine())),this._myVisualRight.setAutoRefresh(!1),this._myVisualUp.setAutoRefresh(!1),this._myVisualForward.setAutoRefresh(!1),this._myDestroyed=!1,this.forceRefresh(),this.setVisible(!0)}setVisible(e){this._myVisible!=e&&(this._myVisible=e,this._myVisualRight.setVisible(e),this._myVisualUp.setVisible(e),this._myVisualForward.setVisible(e))}setAutoRefresh(e){this._myAutoRefresh=e}getParams(){return this._myParams}setParams(e){this._myParams=e,this._markDirty()}copyParams(e){this._myParams.copy(e),this._markDirty()}paramsUpdated(){this._markDirty()}refresh(){this.update(0)}forceRefresh(){this._refresh(),this._myVisualRight.forceRefresh(),this._myVisualUp.forceRefresh(),this._myVisualForward.forceRefresh()}update(e){this._myDirty&&(this._refresh(),this._myDirty=!1),this._myVisualRight.update(e),this._myVisualUp.update(e),this._myVisualForward.update(e)}_markDirty(){this._myDirty=!0,this._myAutoRefresh&&this.update(0)}clone(){let e=new Ot(this._myParams.myParent.pp_getEngine());e.copy(this._myParams);let t=new si(e);return t.setAutoRefresh(this._myAutoRefresh),t.setVisible(this._myVisible),t._myDirty=this._myDirty,t}_refresh(){}destroy(){this._myDestroyed=!0,this._myVisualRight.destroy(),this._myVisualUp.destroy(),this._myVisualForward.destroy()}isDestroyed(){return this._myDestroyed}};si.prototype._refresh=function(){let i=[m(),m(),m()],e=m(),t=m();return function(){i=this._myParams.myTransform.mat4_getAxes(i),e=this._myParams.myTransform.mat4_getScale(e);let o=0;for(let s of e)o=Math.max(s,o);o==0?(e[0]=1,e[1]=1,e[2]=1):(e[0]=e[0]/o,e[1]=e[1]/o,e[2]=e[2]/o),t=this._myParams.myTransform.mat4_getPosition(t);{let s=this._myVisualRight.getParams();s.myStart.vec3_copy(t),s.myDirection=i[0].vec3_negate(s.myDirection).vec3_normalize(s.myDirection),s.myLength=Math.max(this._myParams.myLength*e[0],.001),s.myThickness=this._myParams.myThickness,this._myParams.myRightMaterial==null?s.myMaterial=r.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myRight:s.myMaterial=this._myParams.myRightMaterial,s.myParent=this._myParams.myParent,s.myLocal=this._myParams.myLocal,this._myVisualRight.paramsUpdated()}{let s=this._myVisualUp.getParams();s.myStart.vec3_copy(t),s.myDirection=i[1].vec3_normalize(s.myDirection),s.myLength=Math.max(this._myParams.myLength*e[1],.001),s.myThickness=this._myParams.myThickness,this._myParams.myUpMaterial==null?s.myMaterial=r.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myUp:s.myMaterial=this._myParams.myUpMaterial,s.myParent=this._myParams.myParent,s.myLocal=this._myParams.myLocal,this._myVisualUp.paramsUpdated()}{let s=this._myVisualForward.getParams();s.myStart.vec3_copy(t),s.myDirection=i[2].vec3_normalize(s.myDirection),s.myLength=Math.max(this._myParams.myLength*e[2],.001),s.myThickness=this._myParams.myThickness,this._myParams.myForwardMaterial==null?s.myMaterial=r.getVisualResources(this._myParams.myParent.pp_getEngine()).myDefaultMaterials.myForward:s.myMaterial=this._myParams.myForwardMaterial,s.myParent=this._myParams.myParent,s.myLocal=this._myParams.myLocal,this._myVisualForward.paramsUpdated()}}}();Ot.prototype.copy=function(e){this.myTransform.mat4_copy(e.myTransform),this.myLength=e.myLength,this.myThickness=e.myThickness,e.myRightMaterial!=null?this.myRightMaterial=e.myRightMaterial.clone():this.myRightMaterial=null,e.myUpMaterial!=null?this.myUpMaterial=e.myUpMaterial.clone():this.myUpMaterial=null,e.myForwardMaterial!=null?this.myForwardMaterial=e.myForwardMaterial.clone():this.myForwardMaterial=null,this.myParent=e.myParent,this.myLocal=e.myLocal,this.myType=e.myType};var eo=class{constructor(e=r.getMainEngine()){this._myEngine=e,this._myVisualElementPrototypeCreationCallbacks=new Map,this._myVisualElementsTypeMap=new Map,this._myVisualElementLastID=0,this._myVisualElementsPool=new Ds,this._myVisualElementsToShow=[],this._myActive=!0,this._myDestroyed=!1,this._addStandardVisualElementTypes()}setActive(e){this._myActive!=e&&(this._myActive=e,this._myActive||this.clearDraw())}isActive(){return this._myActive}start(){}update(e){this._myActive&&this._updateDraw(e)}draw(e,t=0,n=null){if(!this._myActive)return 0;let o=null,s=!1;if(n!=null&&this._myVisualElementsTypeMap.has(e.myType)){let h=this._myVisualElementsTypeMap.get(e.myType);h.has(n)&&(o=h.get(n)[0],o.copyParams(e),o.setVisible(!1),s=!0)}if(o==null&&(o=this._getVisualElement(e)),o==null)return console.error("Couldn't create the requested visual element"),null;this._myVisualElementsTypeMap.has(e.myType)||this._myVisualElementsTypeMap.set(e.myType,new Map);let a=this._myVisualElementsTypeMap.get(e.myType),l=null;if(!s)l=this._myVisualElementLastID+1,this._myVisualElementLastID=l,a.set(l,[o,new ie(t,t!=null)]);else{l=n;let h=a.get(l);h[0]=o,h[1].reset(t),t!=null&&h[1].start()}return this._myVisualElementsToShow.push(o),l}getDraw(e){let t=null;for(let n of this._myVisualElementsTypeMap.values())if(n.has(e)){t=n.get(e)[0];break}return t}clearDraw(e=null){if(e==null){for(let t of this._myVisualElementsTypeMap.values())for(let n of t.values())this._myVisualElementsPool.release(n[0].getParams().myType,n[0]);this._myVisualElementsToShow=[],this._myVisualElementsTypeMap=new Map,this._myVisualElementLastID=0}else for(let t of this._myVisualElementsTypeMap.values())if(t.has(e)){let n=t.get(e);this._myVisualElementsPool.release(n[0].getParams().myType,n[0]),t.delete(e),this._myVisualElementsToShow.pp_removeEqual(n[0]);break}}allocateDraw(e,t){this._myVisualElementsPool.hasPool(e)||this._addVisualElementTypeToPool(e);let n=this._myVisualElementsPool.getPool(e),o=n.getAvailableSize()-t;o<0&&n.increase(-o)}addVisualElementType(e,t){this._myVisualElementPrototypeCreationCallbacks.set(e,t)}removeVisualElementType(e){this._myVisualElementPrototypeCreationCallbacks.delete(e)}_updateDraw(e){for(let t of this._myVisualElementsToShow)t.setVisible(!0);this._myVisualElementsToShow=[];for(let t of this._myVisualElementsTypeMap.values()){let n=[];for(let o of t.entries()){let s=o[1];s[1].isDone()&&(this._myVisualElementsPool.release(s[0].getParams().myType,s[0]),n.push(o[0])),s[1].update(e)}for(let o of n)t.delete(o)}}_getVisualElement(e){let t=null;return this._myVisualElementsPool.hasPool(e.myType)||this._addVisualElementTypeToPool(e.myType),t=this._myVisualElementsPool.get(e.myType),t?.copyParams(e),t}_addVisualElementTypeToPool(e){let t=new Mi;t.myInitialPoolSize=10,t.myAmountToAddWhenEmpty=0,t.myPercentageToAddWhenEmpty=.5,t.mySetActiveCallback=function(o,s){o.setVisible(s)};let n=null;this._myVisualElementPrototypeCreationCallbacks.has(e)&&(n=this._myVisualElementPrototypeCreationCallbacks.get(e)()),n!=null?(n.setVisible(!1),n.setAutoRefresh(!0),this._myVisualElementsPool.addPool(e,n,t)):console.error("Visual element type not supported")}_addStandardVisualElementTypes(){this.addVisualElementType(xe.LINE,()=>new rt(new Ke(this._myEngine))),this.addVisualElementType(xe.MESH,()=>new Ei(new ni(this._myEngine))),this.addVisualElementType(xe.POINT,()=>new wt(new vt(this._myEngine))),this.addVisualElementType(xe.ARROW,()=>new ht(new tt(this._myEngine))),this.addVisualElementType(xe.TEXT,()=>new Di(new Vt(this._myEngine))),this.addVisualElementType(xe.TRANSFORM,()=>new si(new Ot(this._myEngine))),this.addVisualElementType(xe.RAYCAST,()=>new $n(new oi(this._myEngine))),this.addVisualElementType(xe.TORUS,()=>new zt(new jt(this._myEngine)))}destroy(){this._myDestroyed=!0,this._myVisualElementsPool.destroy()}isDestroyed(){return this._myDestroyed}};var Rs=class{constructor(){this.myDefaultMaterials=new kr}},kr=class{constructor(){this.myMesh=null,this.myText=null,this.myRight=null,this.myUp=null,this.myForward=null,this.myRay=null,this.myHitNormal=null}};var ei=class extends kD{init(){this._myVisualManager=null,r.hasVisualManager(this.engine)||(this._myVisualManager=new eo(this.engine),r.setVisualManager(this._myVisualManager,this.engine)),r.hasVisualResources(this.engine)||(this._myVisualResources=new Rs,r.setVisualResources(this._myVisualResources,this.engine))}start(){this._myVisualResources!=null&&(this._myVisualResources.myDefaultMaterials.myMesh=r.getDefaultMaterials(this.engine).myFlatOpaque.clone(),this._myVisualResources.myDefaultMaterials.myText=r.getDefaultMaterials(this.engine).myText.clone(),this._myVisualResources.myDefaultMaterials.myRight=r.getDefaultMaterials(this.engine).myFlatOpaque.clone(),this._myVisualResources.myDefaultMaterials.myRight.color=w(1,0,0,1),this._myVisualResources.myDefaultMaterials.myUp=r.getDefaultMaterials(this.engine).myFlatOpaque.clone(),this._myVisualResources.myDefaultMaterials.myUp.color=w(0,1,0,1),this._myVisualResources.myDefaultMaterials.myForward=r.getDefaultMaterials(this.engine).myFlatOpaque.clone(),this._myVisualResources.myDefaultMaterials.myForward.color=w(0,0,1,1),this._myVisualResources.myDefaultMaterials.myRay=r.getDefaultMaterials(this.engine).myFlatOpaque.clone(),this._myVisualResources.myDefaultMaterials.myRay.color=w(0,1,0,1),this._myVisualResources.myDefaultMaterials.myHitNormal=r.getDefaultMaterials(this.engine).myFlatOpaque.clone(),this._myVisualResources.myDefaultMaterials.myHitNormal.color=w(1,0,0,1)),this.myVisualManager!=null&&this.myVisualManager.start()}update(e){this.myVisualManager!=null&&this.myVisualManager.update(e)}onDestroy(){this._myVisualManager!=null&&r.getVisualManager(this.engine)==this._myVisualManager&&(r.removeVisualManager(this.engine),this._myVisualManager.destroy()),this._myVisualResources!=null&&r.getVisualResources(this.engine)==this._myVisualResources&&r.removeVisualResources(this.engine)}};R(ei,"TypeName","pp-visual-manager"),R(ei,"Properties",{});import*as FD from"@wonderlandengine/api";import{Component as wD,Property as jD}from"@wonderlandengine/api";import*as zD from"@wonderlandengine/components";var gi=class extends wD{init(){this._myAdd&&(r.getWindow(this.engine).WL={},this._addProperties(FD),this._addProperties(zD))}_addProperties(e){let t=Object.getOwnPropertyNames(e);for(let n of t)e[n]!=null&&(r.getWindow(this.engine).WL[n]=e[n])}onDestroy(){r.getWindow(this.engine).WL=void 0}};R(gi,"TypeName","pp-add-wl-to-window"),R(gi,"Properties",{_myAdd:jD.bool(!0)});import{Component as UD}from"@wonderlandengine/api";import{Alignment as ND,Justification as GD}from"@wonderlandengine/api";var to=class extends eo{constructor(e){super(e)}drawLine(e,t,n,o,s=w(0,1,0,1),a=.005){if(this.isActive()){let l=new Ke(this._myEngine);l.myStart.vec3_copy(t),l.myDirection.vec3_copy(n),l.myLength=o,l.myThickness=a,l.myColor=w(),l.myColor.vec4_copy(s),this.draw(l,e)}}drawLineEnd(e,t,n,o=w(0,1,0,1),s=.005){}drawArrow(e,t,n,o,s=w(0,1,0,1),a=.005){if(this.isActive()){let l=new tt(this._myEngine);l.myStart.vec3_copy(t),l.myDirection.vec3_copy(n),l.myLength=o,l.myThickness=a,l.myColor=w(),l.myColor.vec4_copy(s),this.draw(l,e)}}drawArrowEnd(e,t,n,o=w(0,1,0,1),s=.005){}drawPoint(e,t,n=w(0,1,0,1),o=.005){if(this.isActive()){let s=new vt(this._myEngine);s.myPosition.vec3_copy(t),s.myRadius=o,s.myColor=w(),s.myColor.vec4_copy(n),this.draw(s,e)}}drawText(e,t,n,o=w(0,1,0,1),s=ND.Center,a=GD.Middle){if(this.isActive()){let l=new Vt(this._myEngine);l.myText=t,l.myAlignment=s,l.myJustification=a,l.myTransform.mat4_copy(n),l.myColor=w(),l.myColor.vec4_copy(o),this.draw(l,e)}}drawRaycast(e,t,n=!0,o=.2,s=.005){if(this.isActive()){let a=new oi(this._myEngine);a.myRaycastResults=t,a.myShowOnlyFirstHit=n,a.myHitNormalLength=o,a.myThickness=s,this.draw(a,e)}}drawTransform(e,t,n=.2,o=.005){if(this.isActive()){let s=new Ot(this._myEngine);s.myTransform.mat4_copy(t),s.myLength=n,s.myThickness=o,this.draw(s,e)}}};to.prototype.drawLineEnd=function(){let i=m();return function(t,n,o,s=w(0,1,0,1),a=.005){this.isActive()&&(i=o.vec3_sub(n,i),length=i.vec3_length(),i.vec3_normalize(i),this.drawLine(t,n,i,length,s,a))}}();to.prototype.drawArrowEnd=function(){let i=m();return function(t,n,o,s=w(0,1,0,1),a=.005){this.isActive()&&(i=o.vec3_sub(n,i),length=i.vec3_length(),i.vec3_normalize(i),this.drawArrow(t,n,i,length,s,a))}}();var As=class{constructor(e=r.getMainEngine()){this._myEngine=e,this._myDebugVisualManager=new to(this._myEngine),this._myDestroyed=!1}getDebugVisualManager(){return this._myDebugVisualManager}start(){this._myDebugVisualManager.start()}update(e){this._myDebugVisualManager.setActive(r.isDebugEnabled(this._myEngine)),this._myDebugVisualManager.update(e)}destroy(){this._myDestroyed=!0,this._myDebugVisualManager.destroy()}isDestroyed(){return this._myDestroyed}};var ti=class extends UD{init(){this._myDebugManager=null,r.hasDebugManager(this.engine)||(this._myDebugManager=new As(this.engine),r.setDebugManager(this._myDebugManager,this.engine))}start(){this._myDebugManager!=null&&this._myDebugManager.start()}update(e){this._myDebugManager!=null&&this._myDebugManager.update(e)}onDestroy(){this._myDebugManager!=null&&r.getDebugManager(this.engine)==this._myDebugManager&&(r.removeDebugManager(this.engine),this._myDebugManager.destroy())}};R(ti,"TypeName","pp-debug-manager"),R(ti,"Properties",{});import{Component as WD,Property as QD}from"@wonderlandengine/api";var fi=class extends WD{init(){this._myDebugEnabled=null,r.hasDebugEnabled(this.engine)||(this._myDebugEnabled=this._myEnable,r.setDebugEnabled(this._myDebugEnabled,this.engine))}onDestroy(){this._myDebugEnabled!=null&&r.isDebugEnabled(this.engine)==this._myDebugEnabled&&r.removeDebugEnabled(this.engine)}};R(fi,"TypeName","pp-enable-debugs"),R(fi,"Properties",{_myEnable:QD.bool(!0)});import{Component as XD,Property as tm}from"@wonderlandengine/api";var M={SELECT:0,SQUEEZE:1,TOUCHPAD:2,THUMBSTICK:3,BOTTOM_BUTTON:4,TOP_BUTTON:5,THUMB_REST:6},ae={PRESS_START:0,PRESS_END:1,PRESSED:2,NOT_PRESSED:3,TOUCH_START:4,TOUCH_END:5,TOUCHED:6,NOT_TOUCHED:7,VALUE_CHANGED:8,ALWAYS:9},oe={THUMBSTICK:0},ai={X_CHANGED:0,Y_CHANGED:1,AXES_CHANGED:2,ALWAYS:3},io=class{constructor(e,t){this.myID=e,this.myHandedness=t,this.myPressed=!1,this.myPrevIsPressed=!1,this.myTouched=!1,this.myPrevIsTouched=!1,this.myValue=0,this.myPrevValue=0,this.myTimePressed=0,this.myPrevTimePressed=0,this.myTimeNotPressed=0,this.myPrevTimeNotPressed=0,this.myTimeTouched=0,this.myPrevTimeTouched=0,this.myTimeNotTouched=0,this.myPrevTimeNotTouched=0,this.myMultiplePressStartCount=0,this.myPrevMultiplePressStartCount=0,this.myMultiplePressEndCount=0,this.myPrevMultiplePressEndCount=0,this.myMultipleTouchStartCount=0,this.myPrevMultipleTouchStartCount=0,this.myMultipleTouchEndCount=0,this.myPrevMultipleTouchEndCount=0}getID(){return this.myID}getHandedness(){return this.myHandedness}getValue(){return this.myValue}isPressed(){return this.myPressed}isTouched(){return this.myTouched}isPressStart(e=null){return this.myPressed&&!this.myPrevIsPressed&&(e==null||this.myMultiplePressStartCount==e)}isPressEnd(e=null){return!this.myPressed&&this.myPrevIsPressed&&(e==null||this.myMultiplePressEndCount==e)}isTouchStart(e=null){return this.myTouched&&!this.myPrevIsTouched&&(e==null||this.myMultipleTouchStartCount==e)}isTouchEnd(e=null){return!this.myTouched&&this.myPrevIsTouched&&(e==null||this.myMultipleTouchEndCount==e)}clone(){let e=new io(this.myID,this.myHandedness);return e.myPressed=this.myPressed,e.myPrevIsPressed=this.myPrevIsPressed,e.myTouched=this.myTouched,e.myPrevIsTouched=this.myPrevIsTouched,e.myValue=this.myValue,e.myPrevValue=this.myPrevValue,e.myTimePressed=this.myTimePressed,e.myPrevTimePressed=this.myPrevTimePressed,e.myTimeNotPressed=this.myTimeNotPressed,e.myPrevTimeNotPressed=this.myPrevTimeNotPressed,e.myTimeTouched=this.myTimeTouched,e.myPrevTimeTouched=this.myPrevTimeTouched,e.myTimeNotTouched=this.myTimeNotTouched,e.myPrevTimeNotTouched=this.myPrevTimeNotTouched,e.myMultiplePressStartCount=this.myMultiplePressStartCount,e.myPrevMultiplePressStartCount=this.myPrevMultiplePressStartCount,e.myMultiplePressEndCount=this.myMultiplePressEndCount,e.myPrevMultiplePressEndCount=this.myPrevMultiplePressEndCount,e.myMultipleTouchStartCount=this.myMultipleTouchStartCount,e.myPrevMultipleTouchStartCount=this.myPrevMultipleTouchStartCount,e.myMultipleTouchEndCount=this.myMultipleTouchEndCount,e.myPrevMultipleTouchEndCount=this.myPrevMultipleTouchEndCount,e}},no=class{constructor(e,t){this.myID=e,this.myHandedness=t,this.myAxes=De(0,0),this.myPrevAxes=De(0,0)}getID(){return this.myID}getAxes(){return this.myAxes}getHandedness(){return this.myHandedness}clone(){let e=new no(this.myID,this.myHandedness);return e.myAxes.vec2_copy(this.myAxes),e.myPrevAxes.vec2_copy(this.myPrevAxes),e}},oo=class{constructor(){this.myIntensity=0,this.myDuration=0,this.myDevicePulsing=!1}clone(){let e=new oo;return e.myIntensity=this.myIntensity,e.myDuration=this.myDuration,e.myDevicePulsing=this.myDevicePulsing,e}};var Nt=class{constructor(e){this._myHandPose=e,this._myManagingHandPose=!1,this._myDestroyed=!1}getHandedness(){return this.getHandPose().getHandedness()}getHandPose(){return this._myHandPose}getEngine(){return this.getHandPose().getEngine()}isGamepadCoreActive(){return!0}setManageHandPose(e){this._myManagingHandPose=e}isManagingHandPose(){return this._myManagingHandPose}start(){this.getHandPose()&&this.isManagingHandPose()&&this.getHandPose().start(),this._startHook()}preUpdate(e){this.getHandPose()&&this.isManagingHandPose()&&this.getHandPose().update(e),this._preUpdateHook(e)}postUpdate(e){this._postUpdateHook(e)}getButtonData(e){return this._createButtonData()}getAxesData(e){return this._createAxesData()}getHapticActuators(){return[]}_startHook(){}_preUpdateHook(e){}_postUpdateHook(e){}_destroyHook(){}_createButtonData(){return{myPressed:!1,myTouched:!1,myValue:0}}_createAxesData(){return De(0,0)}destroy(){this._myDestroyed=!0,this._destroyHook(),this.isManagingHandPose()&&this.getHandPose().destroy()}isDestroyed(){return this._myDestroyed}};var No=class extends Nt{constructor(e,t){super(t),this._myGamepadIndex=e,this._myButtonData=this._createButtonData(),this._myAxesData=this._createAxesData(),this._myHapticActuators=[]}isGamepadCoreActive(){let e=this._getClassicGamepad();return e!=null&&(e.connected==null||e.connected)}getButtonData(e){this._myButtonData.myPressed=!1,this._myButtonData.myTouched=!1,this._myButtonData.myValue=0;let t=this._getClassicGamepad();if(t!=null&&this.isGamepadCoreActive()){let n=null;if(this.getHandedness()==A.LEFT)switch(e){case M.SELECT:n=t.buttons[4];break;case M.SQUEEZE:n=t.buttons[6];break;case M.TOUCHPAD:n=null;break;case M.THUMBSTICK:n=t.buttons[10];break;case M.BOTTOM_BUTTON:n=t.buttons[13];break;case M.TOP_BUTTON:n=t.buttons[12];break;case M.THUMB_REST:n=null;break}else switch(e){case M.SELECT:n=t.buttons[5];break;case M.SQUEEZE:n=t.buttons[7];break;case M.TOUCHPAD:n=null;break;case M.THUMBSTICK:n=t.buttons[11];break;case M.BOTTOM_BUTTON:n=t.buttons[0];break;case M.TOP_BUTTON:n=t.buttons[3];break;case M.THUMB_REST:n=null;break}n!=null&&(this._myButtonData.myPressed=n.pressed,this._myButtonData.myTouched=n.touched,this._myButtonData.myValue=n.value)}return this._myButtonData}getAxesData(e){this._myAxesData.vec2_zero();let t=this._getClassicGamepad();return t!=null&&this.isGamepadCoreActive()&&(this.getHandedness()==A.LEFT?(this._myAxesData[0]=t.axes[0],this._myAxesData[1]=t.axes[1]):(this._myAxesData[0]=t.axes[2],this._myAxesData[1]=t.axes[3])),this._myAxesData}getHapticActuators(){this._myHapticActuators.pp_clear();let e=this._getClassicGamepad();return e!=null&&this.isGamepadCoreActive()&&(e.hapticActuators!=null&&e.hapticActuators.length>0&&this._myHapticActuators.push(...e.hapticActuators),e.vibrationActuator!=null&&this._myHapticActuators.push(e.vibrationActuator)),this._myHapticActuators}_getClassicGamepad(){let e=null,t=r.getNavigator(this.getEngine()).getGamepads();if(this._myGamepadIndex!=null)this._myGamepadIndex<t.length&&(e=t[this._myGamepadIndex]);else for(let n of t)if(n!=null&&(n.connected==null||n.connected)){e=n;break}return e}};var te={_0:"0",_1:"1",_2:"2",_3:"3",_4:"4",_5:"5",_6:"6",_7:"7",_8:"8",_9:"9",A:"A",B:"B",C:"C",D:"D",E:"E",F:"F",G:"G",H:"H",I:"I",J:"J",K:"K",L:"L",M:"M",N:"N",O:"O",P:"P",Q:"Q",R:"R",S:"S",T:"T",U:"U",V:"V",W:"W",X:"X",Y:"Y",Z:"Z",a:"a",b:"b",c:"c",d:"d",e:"e",f:"f",g:"g",h:"h",i:"i",j:"j",k:"k",l:"l",m:"m",n:"n",o:"o",p:"p",q:"q",r:"r",s:"s",t:"t",u:"u",v:"v",w:"w",x:"x",y:"y",z:"z",UP:"ArrowUp",DOWN:"ArrowDown",LEFT:"ArrowLeft",RIGHT:"ArrowRight",SPACE:" ",ENTER:"Enter",BACKSPACE:"Backspace",ESC:"Escape",SHIFT_LEFT:"ShiftLeft",SHIFT_RIGHT:"ShiftRight",CONTROL_LEFT:"ControlLeft",CONTROL_RIGHT:"ControlRight",ALT_LEFT:"AltLeft",ALT_RIGHT:"AltRight"},Vs=class{constructor(e=r.getMainEngine()){this._myEngine=e,this._myKeyInfos=new Map;for(let t in te)this.addKey(te[t]);this._myOnKeyDownEventListener=null,this._myOnKeyUpEventListener=null,this._myDestroyed=!1}isKeyPressed(e){let t=!1;return this._myKeyInfos.has(e)&&(t=this._myKeyInfos.get(e).myPressed),t}isKeyPressStart(e){let t=!1;return this._myKeyInfos.has(e)&&(t=this._myKeyInfos.get(e).myPressStart),t}isKeyPressEnd(e){let t=!1;return this._myKeyInfos.has(e)&&(t=this._myKeyInfos.get(e).myPressEnd),t}addKey(e){this._myKeyInfos.set(e,this._createKeyInfo())}start(){this._myOnKeyDownEventListener=this._keyDown.bind(this),r.getWindow(this._myEngine).addEventListener("keydown",this._myOnKeyDownEventListener),this._myOnKeyUpEventListener=this._keyUp.bind(this),r.getWindow(this._myEngine).addEventListener("keyup",this._myOnKeyUpEventListener)}update(e){if(!r.getDocument(this._myEngine).hasFocus())for(let t of this._myKeyInfos.values())t.myPressed&&(t.myPressed=!1,t.myPressEndToProcess=!0);for(let t of this._myKeyInfos.values())t.myPressStart=t.myPressStartToProcess,t.myPressEnd=t.myPressEndToProcess,t.myPressStartToProcess=!1,t.myPressEndToProcess=!1}_keyDown(e){this._keyPressedChanged(e.key,!0),e.key!=e.code&&this._keyPressedChanged(e.code,!0)}_keyUp(e){this._keyPressedChanged(e.key,!1),e.key!=e.code&&this._keyPressedChanged(e.code,!1)}_keyPressedChanged(e,t){if(this._myKeyInfos.has(e)){let n=this._myKeyInfos.get(e);t?(n.myPressed=!0,n.myPressStartToProcess=!0):(n.myPressed=!1,n.myPressEndToProcess=!0)}}_createKeyInfo(){return{myPressed:!1,myPressStart:!1,myPressStartToProcess:!1,myPressEnd:!1,myPressEndToProcess:!1}}destroy(){this._myDestroyed=!0,r.getWindow(this._myEngine).removeEventListener("keydown",this._myOnKeyDownEventListener),r.getWindow(this._myEngine).removeEventListener("keyup",this._myOnKeyUpEventListener)}isDestroyed(){return this._myDestroyed}};var Go=class extends Nt{constructor(e){super(e),this._myButtonData=this._createButtonData(),this._myAxesData=this._createAxesData(),this._myHapticActuators=[]}isGamepadCoreActive(){return!0}getButtonData(e){this._myButtonData.myPressed=!1,this._myButtonData.myTouched=!1,this._myButtonData.myValue=0;let t=r.getKeyboard(this.getEngine());if(this.isGamepadCoreActive())if(this.getHandedness()==A.LEFT)switch(e){case M.SELECT:this._myButtonData.myPressed=t.isKeyPressed(te.E)||t.isKeyPressed(te.e);break;case M.SQUEEZE:this._myButtonData.myPressed=t.isKeyPressed(te.Q)||t.isKeyPressed(te.q);break;case M.TOUCHPAD:this._myButtonData.myPressed=t.isKeyPressed(te.X)||t.isKeyPressed(te.x);break;case M.THUMBSTICK:this._myButtonData.myPressed=t.isKeyPressed(te.R)||t.isKeyPressed(te.r);break;case M.BOTTOM_BUTTON:this._myButtonData.myPressed=t.isKeyPressed(te.C)||t.isKeyPressed(te.c);break;case M.TOP_BUTTON:this._myButtonData.myPressed=t.isKeyPressed(te.F)||t.isKeyPressed(te.f);break;case M.THUMB_REST:this._myButtonData.myPressed=t.isKeyPressed(te.V)||t.isKeyPressed(te.v);break}else switch(e){case M.SELECT:this._myButtonData.myPressed=t.isKeyPressed(te.U)||t.isKeyPressed(te.u);break;case M.SQUEEZE:this._myButtonData.myPressed=t.isKeyPressed(te.O)||t.isKeyPressed(te.o);break;case M.TOUCHPAD:this._myButtonData.myPressed=t.isKeyPressed(te.M)||t.isKeyPressed(te.m);break;case M.THUMBSTICK:this._myButtonData.myPressed=t.isKeyPressed(te.Y)||t.isKeyPressed(te.y);break;case M.BOTTOM_BUTTON:this._myButtonData.myPressed=t.isKeyPressed(te.N)||t.isKeyPressed(te.n);break;case M.TOP_BUTTON:this._myButtonData.myPressed=t.isKeyPressed(te.H)||t.isKeyPressed(te.h);break;case M.THUMB_REST:this._myButtonData.myPressed=t.isKeyPressed(te.B)||t.isKeyPressed(te.b);break}return this._myButtonData.myPressed&&(this._myButtonData.myTouched=!0,this._myButtonData.myValue=1),this._myButtonData}getAxesData(e){this._myAxesData.vec2_zero();let t=r.getKeyboard(this.getEngine());return this.isGamepadCoreActive()&&(this.getHandedness()==A.LEFT?((t.isKeyPressed(te.W)||t.isKeyPressed(te.w))&&(this._myAxesData[1]+=1),(t.isKeyPressed(te.S)||t.isKeyPressed(te.s))&&(this._myAxesData[1]+=-1),(t.isKeyPressed(te.D)||t.isKeyPressed(te.d))&&(this._myAxesData[0]+=1),(t.isKeyPressed(te.A)||t.isKeyPressed(te.a))&&(this._myAxesData[0]+=-1)):((t.isKeyPressed(te.I)||t.isKeyPressed(te.i)||t.isKeyPressed(te.UP))&&(this._myAxesData[1]+=1),(t.isKeyPressed(te.K)||t.isKeyPressed(te.k)||t.isKeyPressed(te.DOWN))&&(this._myAxesData[1]+=-1),(t.isKeyPressed(te.L)||t.isKeyPressed(te.l)||t.isKeyPressed(te.RIGHT))&&(this._myAxesData[0]+=1),(t.isKeyPressed(te.J)||t.isKeyPressed(te.j)||t.isKeyPressed(te.LEFT))&&(this._myAxesData[0]+=-1))),this._myAxesData}getHapticActuators(){return this._myHapticActuators}};var Uo=class extends Nt{constructor(e){super(e),this._mySelectPressed=!1,this._mySqueezePressed=!1,this._myXRSessionActive=!1,this._myInputSource=null,this._myGamepad=null,this._mySelectStartEventListener=null,this._mySelectEndEventListener=null,this._mySqueezeStartEventListener=null,this._mySqueezeEndEventListener=null,this._myButtonData=this._createButtonData(),this._myAxesData=this._createAxesData(),this._myHapticActuators=[]}isGamepadCoreActive(){return this._myXRSessionActive&&this._myGamepad!=null&&(this._myGamepad.connected==null||this._myGamepad.connected)}_startHook(){B.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this.getEngine())}_preUpdateHook(e){this._myInputSource=this.getHandPose().getInputSource(),this._myInputSource!=null?this._myGamepad=this._myInputSource.gamepad:this._myGamepad=null}getButtonData(e){if(this._myButtonData.myPressed=!1,this._myButtonData.myTouched=!1,this._myButtonData.myValue=0,this.isGamepadCoreActive()){if(e<this._myGamepad.buttons.length){let t=this._myGamepad.buttons[e];e!=M.SELECT&&e!=M.SQUEEZE?this._myButtonData.myPressed=t.pressed:this._myButtonData.myPressed=this._getSpecialButtonPressed(e),this._myButtonData.myTouched=t.touched,this._myButtonData.myValue=t.value}else if(e==M.TOP_BUTTON&&this._myGamepad.buttons.length>=3){let t=this._myGamepad.buttons[2];this._myButtonData.myPressed=t.pressed,this._myButtonData.myTouched=t.touched,this._myButtonData.myValue=t.value}}return this._myButtonData}getAxesData(e){if(this._myAxesData.vec2_zero(),this.isGamepadCoreActive()){let t=this._myGamepad.axes;t.length==4?(Math.abs(t[0])>Math.abs(t[2])?this._myAxesData[0]=t[0]:this._myAxesData[0]=t[2],Math.abs(t[1])>Math.abs(t[3])?this._myAxesData[1]=t[1]:this._myAxesData[1]=t[3]):t.length==2&&(this._myAxesData[0]=t[0],this._myAxesData[1]=t[1]),this._myAxesData[1]=-this._myAxesData[1]}return this._myAxesData}getHapticActuators(){return this._myHapticActuators.pp_clear(),this.isGamepadCoreActive()&&(this._myGamepad.hapticActuators!=null&&this._myGamepad.hapticActuators.length>0&&this._myHapticActuators.push(...this._myGamepad.hapticActuators),this._myGamepad.vibrationActuator!=null&&this._myHapticActuators.push(this._myGamepad.vibrationActuator)),this._myHapticActuators}_getSpecialButtonPressed(e){let t=!1;return this.isGamepadCoreActive()&&(e==M.SELECT?t=this._mySelectPressed:e==M.SQUEEZE&&(t=this._mySqueezePressed)),t}_onXRSessionStart(e){this._mySelectStartEventListener=this._selectStart.bind(this),this._mySelectEndEventListener=this._selectEnd.bind(this),this._mySqueezeStartEventListener=this._squeezeStart.bind(this),this._mySqueezeEndEventListener=this._squeezeEnd.bind(this),e.addEventListener("selectstart",this._mySelectStartEventListener),e.addEventListener("selectend",this._mySelectEndEventListener),e.addEventListener("squeezestart",this._mySqueezeStartEventListener),e.addEventListener("squeezeend",this._mySqueezeEndEventListener),this._myXRSessionActive=!0}_onXRSessionEnd(e){this._mySelectStartEventListener=null,this._mySelectEndEventListener=null,this._mySqueezeStartEventListener=null,this._mySqueezeEndEventListener=null,this._myXRSessionActive=!1}_selectStart(e){this._myInputSource!=null&&this._myInputSource==e.inputSource&&(this._mySelectPressed=!0)}_selectEnd(e){this._myInputSource!=null&&this._myInputSource==e.inputSource&&(this._mySelectPressed=!1)}_squeezeStart(e){this._myInputSource!=null&&this._myInputSource==e.inputSource&&(this._mySqueezePressed=!0)}_squeezeEnd(e){this._myInputSource!=null&&this._myInputSource==e.inputSource&&(this._mySqueezePressed=!1)}_destroyHook(){B.getSession(this.getEngine())?.removeEventListener("selectstart",this._mySelectStartEventListener),B.getSession(this.getEngine())?.removeEventListener("selectend",this._mySelectEndEventListener),B.getSession(this.getEngine())?.removeEventListener("squeezestart",this._mySqueezeStartEventListener),B.getSession(this.getEngine())?.removeEventListener("squeezeend",this._mySqueezeEndEventListener),B.unregisterSessionStartEndEventListeners(this,this.getEngine())}};import{Emitter as VC}from"@wonderlandengine/api";var Os=class{constructor(e){this._myHandedness=e,this._myButtonInfos=[];for(let t in M)this._myButtonInfos[M[t]]=new io(M[t],this._myHandedness);this._myAxesInfos=[];for(let t in oe)this._myAxesInfos[oe[t]]=new no(oe[t],this._myHandedness);this._myButtonEmitters=[];for(let t in M){this._myButtonEmitters[M[t]]=[];for(let n in ae)this._myButtonEmitters[M[t]][ae[n]]=new VC}this._myAxesEmitters=[];for(let t in oe){this._myAxesEmitters[oe[t]]=[];for(let n in ai)this._myAxesEmitters[oe[t]][ai[n]]=new VC}this._myPulseInfo=new oo,this._myDestroyed=!1,this._myMultiplePressMaxDelay=.4,this._myMultipleTouchMaxDelay=.4}getHandedness(){return this._myHandedness}getButtonInfo(e){return this._myButtonInfos[e]}registerButtonEventListener(e,t,n,o){this._myButtonEmitters[e][t].add(o,{id:n})}unregisterButtonEventListener(e,t,n){this._myButtonEmitters[e][t].remove(n)}getAxesInfo(e){return this._myAxesInfos[e]}registerAxesEventListener(e,t,n,o){this._myAxesEmitters[e][t].add(o,{id:n})}unregisterAxesEventListener(e,t,n){this._myAxesEmitters[e][t].remove(n)}pulse(e,t=0){this._myPulseInfo.myIntensity=Math.pp_clamp(e,0,1),this._myPulseInfo.myDuration=Math.max(t,0)}stopPulse(){this._myPulseInfo.myIntensity=0,this._myPulseInfo.myDuration=0}isPulsing(){return this._myPulseInfo.myIntensity>0||this._myPulseInfo.myDuration>0}getPulseInfo(){return this._myPulseInfo}getMultiplePressMaxDelay(){return this._myMultiplePressMaxDelay}setMultiplePressMaxDelay(e){this._myMultiplePressMaxDelay=e}getMultipleTouchMaxDelay(){return this._myMultipleTouchMaxDelay}setMultipleTouchMaxDelay(e){this._myMultipleTouchMaxDelay=e}getHandPose(){return null}_startHook(){}_preUpdate(e){}_postUpdate(e){}_getButtonData(e){return this._createButtonData()}_getAxesData(e){return this._createAxesData()}_getHapticActuators(){return[]}_destroyHook(){}start(){this._startHook()}update(e){this._preUpdate(e),this._preUpdateButtonInfos(),this._updateButtonInfos(),this._postUpdateButtonInfos(e),this._preUpdateAxesInfos(),this._updateAxesInfos(),this._postUpdateAxesInfos(),this._updatePulse(e),this._postUpdate(e)}_preUpdateButtonInfos(){for(let e of this._myButtonInfos)e.myPrevIsPressed=e.myPressed,e.myPrevIsTouched=e.myTouched,e.myPrevValue=e.myValue}_updateButtonInfos(){this._updateSingleButtonInfo(M.SELECT),this._updateSingleButtonInfo(M.SQUEEZE),this._updateSingleButtonInfo(M.TOUCHPAD),this._updateSingleButtonInfo(M.THUMBSTICK),this._updateSingleButtonInfo(M.BOTTOM_BUTTON),this._updateSingleButtonInfo(M.TOP_BUTTON),this._updateSingleButtonInfo(M.THUMB_REST)}_updateSingleButtonInfo(e){let t=this._myButtonInfos[e],n=this._getButtonData(e);t.myPressed=n.myPressed,t.myTouched=n.myTouched,t.myValue=n.myValue}_postUpdateButtonInfos(e){for(let t of this._myButtonInfos)t.myPressed?(t.myTimePressed+=e,t.myPrevIsPressed||(t.myMultiplePressStartCount+=1,t.myPrevTimeNotPressed=t.myTimeNotPressed,t.myTimeNotPressed=0),t.myPrevTimeNotPressed+t.myTimePressed>this._myMultiplePressMaxDelay&&t.myMultiplePressEndCount>0&&(t.myPrevMultiplePressEndCount=t.myMultiplePressEndCount,t.myMultiplePressEndCount=0),t.myTimePressed>this._myMultiplePressMaxDelay&&t.myMultiplePressStartCount>0&&(t.myPrevMultiplePressStartCount=t.myMultiplePressStartCount,t.myMultiplePressStartCount=0)):(t.myTimeNotPressed+=e,t.myPrevIsPressed&&(t.myMultiplePressEndCount+=1,t.myPrevTimePressed=t.myTimePressed,t.myTimePressed=0),t.myPrevTimePressed+t.myTimeNotPressed>this._myMultiplePressMaxDelay&&t.myMultiplePressStartCount>0&&(t.myPrevMultiplePressStartCount=t.myMultiplePressStartCount,t.myMultiplePressStartCount=0),t.myTimeNotPressed>this._myMultiplePressMaxDelay&&t.myMultiplePressEndCount>0&&(t.myPrevMultiplePressEndCount=t.myMultiplePressEndCount,t.myMultiplePressEndCount=0)),t.myTouched?(t.myTimeTouched+=e,t.myPrevIsTouched||(t.myMultipleTouchStartCount+=1,t.myPrevTimeNotTouched=t.myTimeNotTouched,t.myTimeNotTouched=0),t.myPrevTimeNotTouched+t.myTimeTouched>this._myMultipleTouchMaxDelay&&t.myMultipleTouchEndCount>0&&(t.myPrevMultipleTouchEndCount=t.myMultipleTouchEndCount,t.myMultipleTouchEndCount=0),t.myTimeTouched>this._myMultipleTouchMaxDelay&&t.myMultipleTouchStartCount>0&&(t.myPrevMultipleTouchStartCount=t.myMultipleTouchStartCount,t.myMultipleTouchStartCount=0)):(t.myTimeNotTouched+=e,t.myPrevIsTouched&&(t.myMultipleTouchEndCount+=1,t.myPrevTimeTouched=t.myTimeTouched,t.myTimeTouched=0),t.myPrevTimeTouched+t.myTimeNotTouched>this._myMultipleTouchMaxDelay&&t.myMultipleTouchStartCount>0&&(t.myPrevMultipleTouchStartCount=t.myMultipleTouchStartCount,t.myMultipleTouchStartCount=0),t.myTimeNotTouched>this._myMultipleTouchMaxDelay&&t.myMultipleTouchEndCount>0&&(t.myPrevMultipleTouchEndCount=t.myMultipleTouchEndCount,t.myMultipleTouchEndCount=0));for(let t in M){let n=this._myButtonInfos[M[t]],o=this._myButtonEmitters[M[t]];n.myPressed&&!n.myPrevIsPressed&&o[ae.PRESS_START].notify(n,this),!n.myPressed&&n.myPrevIsPressed&&o[ae.PRESS_END].notify(n,this),n.myPressed?o[ae.PRESSED].notify(n,this):o[ae.NOT_PRESSED].notify(n,this),n.myTouched&&!n.myPrevIsTouched&&o[ae.TOUCH_START].notify(n,this),!n.myTouched&&n.myPrevIsTouched&&o[ae.TOUCH_END].notify(n,this),n.myTouched?o[ae.TOUCHED].notify(n,this):o[ae.NOT_TOUCHED].notify(n,this),n.myValue!=n.myPrevValue&&o[ae.VALUE_CHANGED].notify(n,this),o[ae.ALWAYS].notify(n,this)}this._mySelectStart=!1,this._mySelectEnd=!1,this._mySqueezeStart=!1,this._mySqueezeEnd=!1}_preUpdateAxesInfos(){for(let e of this._myAxesInfos)e.myPrevAxes[0]=e.myAxes[0],e.myPrevAxes[1]=e.myAxes[1]}_updateAxesInfos(){this._updateSingleAxesInfo(oe.THUMBSTICK)}_updateSingleAxesInfo(e){let t=this._myAxesInfos[e],n=this._getAxesData(e);t.myAxes[0]=n[0],t.myAxes[1]=n[1]}_postUpdateAxesInfos(){for(let e in oe){let t=this._myAxesInfos[oe[e]],n=this._myAxesEmitters[oe[e]];t.myAxes[0]!=t.myPrevAxes[0]&&n[ai.X_CHANGED].notify(t,this),t.myAxes[1]!=t.myPrevAxes[1]&&n[ai.Y_CHANGED].notify(t,this),(t.myAxes[0]!=t.myPrevAxes[0]||t.myAxes[1]!=t.myPrevAxes[1])&&n[ai.AXES_CHANGED].notify(t,this),n[ai.ALWAYS].notify(t,this)}}_updatePulse(e){if(this._myPulseInfo.myDevicePulsing||this._myPulseInfo.myIntensity>0){let t=this._getHapticActuators();if(t.length>0){if(this._myPulseInfo.myIntensity>0){for(let n of t)n.pulse(this._myPulseInfo.myIntensity,1e3);this._myPulseInfo.myDevicePulsing=!0}else if(this._myPulseInfo.myDevicePulsing){for(let n of t)n.reset();this._myPulseInfo.myDevicePulsing=!1}}else this._myPulseInfo.myDevicePulsing=!1}this._myPulseInfo.myDuration-=e,this._myPulseInfo.myDuration<=0&&(this._myPulseInfo.myIntensity=0,this._myPulseInfo.myDuration=0)}_createButtonData(){return{myPressed:!1,myTouched:!1,myValue:0}}_createAxesData(){return De(0,0)}destroy(){this._myDestroyed=!0,this._destroyHook()}isDestroyed(){return this._myDestroyed}};var Wo=class extends Os{constructor(e){super(e),this._myGamepadCores=new Map,this._myStarted=!1,this._myButtonData=this._createButtonData(),this._myAxesData=this._createAxesData(),this._myHapticActuators=[]}addGamepadCore(e,t){t.getHandedness()==this.getHandedness()&&(this._myGamepadCores.set(e,t),this._myStarted&&t.start())}getGamepadCore(e){return this._myGamepadCores.get(e)}removeGamepadCore(e){this._myGamepadCores.get(e)&&this._myGamepadCores.delete(e)}removeAllGamepadCores(){for(let e of this._myGamepadCores.keys())this.removeGamepadCore(e)}getHandPose(){let e=null;for(let t of this._myGamepadCores.values()){if(t.isGamepadCoreActive()){let n=t.getHandPose();(e==null||n!=null&&n.isValid())&&(e=n)}if(e!=null&&e.isValid())break}return e}_startHook(){for(let e of this._myGamepadCores.values())e.start();this._myStarted=!0}_preUpdate(e){for(let t of this._myGamepadCores.values())t.preUpdate(e)}_postUpdate(e){for(let t of this._myGamepadCores.values())t.postUpdate(e)}_getButtonData(e){this._myButtonData.myPressed=!1,this._myButtonData.myTouched=!1,this._myButtonData.myValue=0;for(let t of this._myGamepadCores.values())if(t.isGamepadCoreActive()){let n=t.getButtonData(e);this._myButtonData.myPressed=this._myButtonData.myPressed||n.myPressed,this._myButtonData.myTouched=this._myButtonData.myTouched||n.myTouched,Math.abs(n.myValue)>Math.abs(this._myButtonData.myValue)&&(this._myButtonData.myValue=n.myValue)}return this._myButtonData}_getAxesData(e){this._myAxesData.vec2_zero();for(let t of this._myGamepadCores.values())if(t.isGamepadCoreActive()){let n=t.getAxesData(e);Math.abs(n[0])>Math.abs(this._myAxesData[0])&&(this._myAxesData[0]=n[0]),Math.abs(n[1])>Math.abs(this._myAxesData[1])&&(this._myAxesData[1]=n[1])}return this._myAxesData}_getHapticActuators(){this._myHapticActuators.pp_clear();for(let e of this._myGamepadCores.values())e.isGamepadCoreActive()&&this._myHapticActuators.push(...e.getHapticActuators());return this._myHapticActuators}_destroyHook(){for(let e of this._myGamepadCores.values())e.destroy()}};var Bs=class{constructor(){this._myGamepads=[],this._myGamepads[A.LEFT]=new Wo(A.LEFT),this._myGamepads[A.RIGHT]=new Wo(A.RIGHT),this._myDestroyed=!1}start(){for(let e in this._myGamepads)this._myGamepads[e].start()}update(e){for(let t in this._myGamepads)this._myGamepads[t].update(e)}getLeftGamepad(){return this._myGamepads[A.LEFT]}getRightGamepad(){return this._myGamepads[A.RIGHT]}getGamepad(e){return this._myGamepads[e]}getGamepads(){return this._myGamepads}destroy(){this._myDestroyed=!0;for(let e in this._myGamepads)this._myGamepads[e].destroy()}isDestroyed(){return this._myDestroyed}};import{Emitter as qD}from"@wonderlandengine/api";var xt=class{constructor(e=r.getMainEngine()){this.myReferenceObject=null,this.myForwardFixed=!0,this.myUpdateOnViewReset=!0,this.myForceEmulatedVelocities=!1,this.myEngine=e}},je=class{constructor(e=new xt){this._myForwardFixed=e.myForwardFixed,this._myForceEmulatedVelocities=e.myForceEmulatedVelocities,this._myUpdateOnViewReset=e.myUpdateOnViewReset,this._myReferenceObject=e.myReferenceObject,this._myEngine=e.myEngine,this._myPosition=m(),this._myRotationQuat=j(),this._myPrevPosition=m(),this._myPrevRotationQuat=z(),this._myLinearVelocity=m(),this._myAngularVelocityRadians=m(),this._myValid=!1,this._myLinearVelocityEmulated=!0,this._myAngularVelocityEmulated=!0,this._myPoseUpdatedEmitter=new qD,this._myViewResetEventListener=null,this._myDestroyed=!1}getEngine(){return this._myEngine}setReferenceObject(e){this._myReferenceObject=e}getReferenceObject(){return this._myReferenceObject}setForwardFixed(e){this._myForwardFixed=e}isForwardFixed(){return this._myForwardFixed}setForceEmulatedVelocities(e){this._myForceEmulatedVelocities=e}isForceEmulatedVelocities(){return this._myForceEmulatedVelocities}setUpdateOnViewReset(e){this._myUpdateOnViewReset=e}isUpdateOnViewReset(){return this._myUpdateOnViewReset}getReferenceSpace(){return B.getReferenceSpace(this._myEngine)}getPosition(e=m(),t=void 0){}getRotation(e=m(),t=void 0){return this.getRotationDegrees(e,t)}getRotationDegrees(e=m(),t=void 0){}getRotationRadians(e=m(),t=void 0){}getRotationQuat(e=z(),t=void 0){}getTransform(e=be(),t=void 0){return this.getTransformMatrix(e,t)}getTransformMatrix(e=be(),t=void 0){}getTransformQuat(e=j(),t=void 0){}getLinearVelocity(e=m(),t=void 0){}getAngularVelocity(e=m(),t=void 0){return this.getAngularVelocityDegrees(e,t)}getAngularVelocityDegrees(e=m(),t=void 0){}getAngularVelocityRadians(e=m(),t=void 0){}isValid(){return this._myValid}isLinearVelocityEmulated(){return this._myLinearVelocityEmulated}isAngularVelocityEmulated(){return this._myAngularVelocityEmulated}registerPoseUpdatedEventListener(e,t){this._myPoseUpdatedEmitter.add(t,{id:e})}unregisterPoseUpdatedEventListener(e){this._myPoseUpdatedEmitter.remove(e)}start(){B.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!0,this._myEngine)}update(e){this._update(e,!0)}_isReadyToGetPose(){return!0}_getPose(e){return null}_updateHook(e,t,n){}_onXRSessionStartHook(e,t){}_onXRSessionEndHook(){}_onViewResetHook(){}_destroyHook(){}_update(e,t){this._myPrevPosition.vec3_copy(this._myPosition),this._myPrevRotationQuat.quat_copy(this._myRotationQuat);let n=B.getFrame(this._myEngine);if(n&&this._isReadyToGetPose()){let o=null;try{o=this._getPose(n)}catch{}o?(this._myPosition[0]=o.transform.position.x,this._myPosition[1]=o.transform.position.y,this._myPosition[2]=o.transform.position.z,this._myRotationQuat[0]=o.transform.orientation.x,this._myRotationQuat[1]=o.transform.orientation.y,this._myRotationQuat[2]=o.transform.orientation.z,this._myRotationQuat[3]=o.transform.orientation.w,this._myRotationQuat.quat_normalize(this._myRotationQuat),t&&(o.linearVelocity&&!this._myForceEmulatedVelocities?(this._myLinearVelocity[0]=o.linearVelocity.x,this._myLinearVelocity[1]=o.linearVelocity.y,this._myLinearVelocity[2]=o.linearVelocity.z,this._myLinearVelocityEmulated=!1):(this._computeEmulatedLinearVelocity(e),this._myLinearVelocityEmulated=!0),o.angularVelocity&&!this._myForceEmulatedVelocities?(this._myAngularVelocityRadians[0]=o.angularVelocity.x,this._myAngularVelocityRadians[1]=o.angularVelocity.y,this._myAngularVelocityRadians[2]=o.angularVelocity.z,this._myAngularVelocityEmulated=!1):(this._computeEmulatedAngularVelocity(e),this._myAngularVelocityEmulated=!0)),this._myValid=!0):(t&&(this._myLinearVelocity[0]=0,this._myLinearVelocity[1]=0,this._myLinearVelocity[2]=0,this._myAngularVelocityRadians[0]=0,this._myAngularVelocityRadians[1]=0,this._myAngularVelocityRadians[2]=0),this._myValid=!1,this._myLinearVelocityEmulated=!0,this._myAngularVelocityEmulated=!0),this._updateHook(e,t,o)}else t&&(this._myLinearVelocity[0]=0,this._myLinearVelocity[1]=0,this._myLinearVelocity[2]=0,this._myAngularVelocityRadians[0]=0,this._myAngularVelocityRadians[1]=0,this._myAngularVelocityRadians[2]=0),this._myValid=!1,this._myLinearVelocityEmulated=!0,this._myAngularVelocityEmulated=!0,this._updateHook(e,t,null);this._myPoseUpdatedEmitter.notify(this)}_computeEmulatedLinearVelocity(e){e>0?(this._myPosition.vec3_sub(this._myPrevPosition,this._myLinearVelocity),this._myLinearVelocity.vec3_scale(1/e,this._myLinearVelocity)):(this._myLinearVelocity[0]=0,this._myLinearVelocity[1]=0,this._myLinearVelocity[2]=0)}_onXRSessionStart(e,t){let n=B.getReferenceSpace(this._myEngine);n.addEventListener!=null&&(this._myViewResetEventListener=this._onViewReset.bind(this),n.addEventListener("reset",this._myViewResetEventListener)),this._onXRSessionStartHook(e,t)}_onXRSessionEnd(){this._onXRSessionEndHook(),this._myViewResetEventListener=null}_onViewReset(){this._myUpdateOnViewReset&&this._update(0,!1),this._onViewResetHook()}_computeEmulatedAngularVelocity(){}destroy(){this._myDestroyed=!0,this._destroyHook(),B.getReferenceSpace(this._myEngine)?.removeEventListener?.("reset",this._myViewResetEventListener),B.unregisterSessionStartEndEventListeners(this,this._myEngine)}isDestroyed(){return this._myDestroyed}};je.prototype.getPosition=function(){let i=be();return function(t=m(),n=void 0){let o=n===void 0?this._myReferenceObject:n;return t.vec3_copy(this._myPosition),o==null?t:t.vec3_convertPositionToWorld(o.pp_getTransform(i),t)}}();je.prototype.getRotationDegrees=function(){let i=z();return function(t=m(),n=void 0){return this.getRotationQuat(i,n).quat_toDegrees(t)}}();je.prototype.getRotationRadians=function(){let i=z();return function(t=m(),n=void 0){return this.getRotationQuat(i,n).quat_toRadians(t)}}();je.prototype.getRotationQuat=function(){let i=z(),e=m();return function(n=z(),o=void 0){let s=o===void 0?this._myReferenceObject:o;return n.quat_copy(this._myRotationQuat),this._myForwardFixed&&n.quat_rotateAxisRadians(Math.PI,n.quat_getUp(e),n),s==null?n:n.quat_toWorld(s.pp_getRotationQuat(i),n)}}();je.prototype.getTransformMatrix=function(){let i=j();return function(t=be(),n=void 0){return this.getTransformQuat(i,n).quat2_toMatrix(t)}}();je.prototype.getTransformQuat=function(){let i=z(),e=j();return function(n=j(),o=void 0){let s=o===void 0?this._myReferenceObject:o;return n.quat2_identity(),n.quat2_setPositionRotationQuat(this._myPosition,this.getRotationQuat(i,o)),s==null?n:n.quat_toWorld(s.pp_getTransformQuat(e),n)}}();je.prototype.getLinearVelocity=function(){let i=be();return function(t=m(),n=void 0){let o=n===void 0?this._myReferenceObject:n;return t.vec3_copy(this._myLinearVelocity),o==null?t:t.vec3_convertDirectionToWorld(o.pp_getTransform(i),t)}}();je.prototype.getAngularVelocityDegrees=function(){let i=m();return function(t=m(),n=void 0){return this.getAngularVelocityRadians(i,n).vec3_toDegrees(t)}}();je.prototype.getAngularVelocityRadians=function(){let i=be();return function(t=m(),n=void 0){let o=n===void 0?this._myReferenceObject:n;return t.vec3_copy(this._myAngularVelocityRadians),o==null?t:t.vec3_convertDirectionToWorld(o.pp_getTransform(i),t)}}();je.prototype._computeEmulatedAngularVelocity=function(){let i=m(),e=m();return function(n){n>0?(i=this._myRotationQuat.quat_toRadians(i),e=this._myPrevRotationQuat.quat_toRadians(e),i.vec3_sub(e,this._myAngularVelocityRadians),this._myAngularVelocityRadians.vec3_scale(1/n,this._myAngularVelocityRadians)):(this._myAngularVelocityRadians[0]=0,this._myAngularVelocityRadians[1]=0,this._myAngularVelocityRadians[2]=0)}}();var so=class extends xt{constructor(e){super(e),this.myFixTrackedHandRotation=!0}},ao=class extends je{constructor(e,t=new so){super(t),this._myInputSource=null,this._myHandedness=e,this._myFixTrackedHandRotation=t.myFixTrackedHandRotation,this._myTrackedHand=!1,this._myInputSourcesChangeEventListener=null}getHandedness(){return this._myHandedness}getInputSource(){return this._myInputSource}getInputSourceType(){return this._myInputSource==null?null:ee.getInputSourceType(this._myInputSource)}isFixTrackedHandRotation(){return this._myFixTrackedHandRotation}setFixTrackedHandRotation(e){this.myFixTrackedHandRotation=e}getRotationQuat(e=void 0){}_isReadyToGetPose(){return this._myInputSource!=null}_getPose(e){return e.getPose(this._myInputSource.gripSpace,this.getReferenceSpace())}_onXRSessionStartHook(e,t){if(this._myInputSourcesChangeEventListener=function(n){if(n.removed)for(let o of n.removed)o==this._myInputSource&&(this._myInputSource=null);if(n.added)for(let o of n.added)o.handedness==this._myHandedness&&(this._myInputSource=o,this._myTrackedHand=ee.getInputSourceType(this._myInputSource)==$e.TRACKED_HAND)}.bind(this),t.addEventListener("inputsourceschange",this._myInputSourcesChangeEventListener),e&&this._myInputSource==null&&t.inputSources)for(let n of t.inputSources)n.handedness==this._myHandedness&&(this._myInputSource=n,this._myTrackedHand=ee.getInputSourceType(this._myInputSource)==$e.TRACKED_HAND)}_onXRSessionEndHook(){this._myInputSource=null,this._myInputSourcesChangeEventListener=null}_destroyHook(){B.getSession(this.getEngine())?.removeEventListener("inputsourceschange",this._myInputSourcesChangeEventListener)}};ao.prototype.getRotationQuat=function(){let i=z(),e=m(),t=m(),n=m();return function(s=z(),a=void 0){let l=a===void 0?this._myReferenceObject:a;if(s.quat_copy(this._myRotationQuat),this._myForwardFixed&&s.quat_rotateAxisRadians(Math.PI,s.quat_getUp(e),s),this._myFixTrackedHandRotation&&this._myTrackedHand){s.quat_rotateAxis(-60,s.quat_getRight(t),s);let h=20;h=this._myHandedness==A.LEFT?h:-h,s.quat_rotateAxis(h,s.quat_getForward(n),s)}return l==null?s:s.quat_toWorld(l.pp_getRotationQuat(i),s)}}();var Is=class extends je{_getPose(e){return e.getViewerPose(this.getReferenceSpace())}};var Qo=class extends je{constructor(e,t,n=new xt){super(n),this._myInputSource=null,this._myHandedness=e,this._myTrackedHandJointID=t,this._myJointRadius=0,this._myInputSourcesChangeEventListener=null}getHandedness(){return this._myHandedness}getTrackedHandJointID(){return this._myTrackedHandJointID}setTrackedHandJointID(e){this._myTrackedHandJointID=e}getJointRadius(){return this._myJointRadius}_isReadyToGetPose(){return this._myInputSource!=null}_getPose(e){return e.getJointPose(this._myInputSource.hand.get(this._myTrackedHandJointID),this.getReferenceSpace())}_updateHook(e,t,n){n!=null&&(this._myJointRadius=n.radius)}_onXRSessionStartHook(e,t){if(this._myInputSourcesChangeEventListener=function(n){if(n.removed)for(let o of n.removed)o==this._myInputSource&&(this._myInputSource=null);if(n.added)for(let o of n.added)o.handedness==this._myHandedness&&ee.getInputSourceType(o)==$e.TRACKED_HAND&&(this._myInputSource=o)}.bind(this),t.addEventListener("inputsourceschange",this._myInputSourcesChangeEventListener),e&&this._myInputSource==null&&t.inputSources)for(let n of t.inputSources)n.handedness==this._myHandedness&&ee.getInputSourceType(n)==$e.TRACKED_HAND&&(this._myInputSource=n)}_onXRSessionEndHook(){this._myInputSource=null,this._myInputSourcesChangeEventListener=null}_destroyHook(){B.getSession(this.getEngine())?.removeEventListener("inputsourceschange",this._myInputSourcesChangeEventListener)}};var ro=class extends xt{constructor(e=!0,t=r.getMainEngine()){if(super(t),this.myTrackedHandJointIDList=[],e)for(let n in at)this.myTrackedHandJointIDList.push([at[n]])}},qo=class{constructor(e,t=new ro){this._myHandedness=e,this._myForwardFixed=t.myForwardFixed,this._myForceEmulatedVelocities=t.myForceEmulatedVelocities,this._myReferenceObject=t.myReferenceObject,this._myEngine=t.myEngine,this._myTrackedHandJointPoseParams=new xt(this._myEngine),this._myTrackedHandJointPoseParams.myForwardFixed=this._myForwardFixed,this._myTrackedHandJointPoseParams.myForceEmulatedVelocities=this._myForceEmulatedVelocities,this._myTrackedHandJointPoseParams.myReferenceObject=this._myReferenceObject,this._myTrackedHandJointPoses=[];for(let n of t.myTrackedHandJointIDList){let o=new Qo(this._myHandedness,n,this._myTrackedHandJointPoseParams);this._myTrackedHandJointPoses[n]=o}}start(){for(let e in this._myTrackedHandJointPoses)this._myTrackedHandJointPoses[e].start()}update(e){for(let t in this._myTrackedHandJointPoses)this._myTrackedHandJointPoses[t].update(e)}getEngine(){this._myEngine}getHandedness(){return this._myHandedness}getJointPose(e){return this._myTrackedHandJointPoses[e]}getJointPoseByIndex(e){return this._myTrackedHandJointPoses[ee.getJointIDByIndex(e)]}getJointPoses(){return this._myTrackedHandJointPoses}addTrackedHandJointID(e){if(!this._myTrackedHandJointPoses.pp_has(t=>t.getTrackedHandJointID()==e)){let t=new Qo(this._myHandedness,e,this._myTrackedHandJointPoseParams);this._myTrackedHandJointPoses.push(t)}}removeTrackedHandJointID(e){this._myTrackedHandJointPoses.pp_remove(t=>t.getTrackedHandJointID()==e)}setReferenceObject(e){this._myReferenceObject=e,this._myTrackedHandJointPoseParams.myReferenceObject=this._myReferenceObject;for(let t in this._myTrackedHandJointPoses)this._myTrackedHandJointPoses[t].setReferenceObject(e)}getReferenceObject(){return this._myReferenceObject}setForwardFixed(e){this._myForwardFixed=e,this._myTrackedHandJointPoseParams.myForwardFixed=this._myForwardFixed;for(let t in this._myTrackedHandJointPoses)this._myTrackedHandJointPoses[t].setForwardFixed(e)}isForwardFixed(){return this._myForwardFixed}setForceEmulatedVelocities(e){this._myForceEmulatedVelocities=e,this._myTrackedHandJointPoseParams.myForceEmulatedVelocities=this._myForceEmulatedVelocities;for(let t in this._myTrackedHandJointPoses)this._myTrackedHandJointPoses[t].setForceEmulatedVelocities(e)}isForceEmulatedVelocities(){return this._myForceEmulatedVelocities}destroy(){this._myDestroyed=!0;for(let e of this._myTrackedHandJointPoses)e.destroy()}isDestroyed(){return this._myDestroyed}};import{ViewComponent as OC}from"@wonderlandengine/api";var Zi={LEFT:0,MIDDLE:1,RIGHT:2},Hs=class{constructor(e=r.getMainEngine()){this._myEngine=e,this._myButtonInfos=new Map;for(let t in Zi)this._myButtonInfos.set(Zi[t],this._createButtonInfo());this._myPreventContextMenuEventListener=this._preventContextMenu.bind(this),this._myPreventMiddleButtonScrollEventListener=this._preventMiddleButtonScroll.bind(this),this._myInternalMousePosition=De(),this._myScreenSize=De(),this._updateScreenSize(),this._myResetMovingDelay=.15,this._myResetMovingTimer=new ie(this._myResetMovingDelay,!1),this._myMoving=!1,this._myInsideView=!1,this._myValid=!1,this._myPointerUpOnPointerLeave=!0,this._myContextMenuActive=!0,this._myMiddleButtonScrollActive=!0,this._myPointerID=null,this._myLastValidPointerEvent=null,this._myPointerEventValidCallbacks=new Map,this._myPointerMoveEventListener=null,this._myPointerDownEventListener=null,this._myPointerUpEventListener=null,this._myPointerLeaveEventListener=null,this._myPointerEnterEventListener=null,this._myMouseDownEventListener=null,this._myMouseUpEventListener=null,this._myDestroyed=!1,this._myProjectionMatrixInverse=be(),this._myRotationQuat=z(),this._myOriginWorld=m(),this._myDirectionWorld=m()}start(){this._myPointerMoveEventListener=this._onPointerAction.bind(this,this._onPointerMove.bind(this)),r.getBody(this._myEngine).addEventListener("pointermove",this._myPointerMoveEventListener),this._myPointerDownEventListener=this._onPointerAction.bind(this,this._onPointerDown.bind(this)),r.getBody(this._myEngine).addEventListener("pointerdown",this._myPointerDownEventListener),this._myPointerUpEventListener=this._onPointerAction.bind(this,this._onPointerUp.bind(this)),r.getBody(this._myEngine).addEventListener("pointerup",this._myPointerUpEventListener),this._myPointerLeaveEventListener=this._onPointerLeave.bind(this),r.getBody(this._myEngine).addEventListener("pointerleave",this._myPointerLeaveEventListener),this._myPointerEnterEventListener=this._onPointerEnter.bind(this),r.getBody(this._myEngine).addEventListener("pointerenter",this._myPointerEnterEventListener),this._myMouseDownEventListener=this._onMouseAction.bind(this,this._onPointerDown.bind(this)),r.getBody(this._myEngine).addEventListener("mousedown",this._myMouseDownEventListener),this._myMouseUpEventListener=this._onMouseAction.bind(this,this._onPointerUp.bind(this)),r.getBody(this._myEngine).addEventListener("mouseup",this._myMouseUpEventListener)}update(e){this._myResetMovingTimer.isRunning()&&(this._myResetMovingTimer.update(e),this._myResetMovingTimer.isDone()&&(this._myResetMovingTimer.reset(),this._myMoving=!1));for(let t of this._myButtonInfos.values())t.myPressStart=t.myPressStartToProcess,t.myPressEnd=t.myPressEndToProcess,t.myPressStartToProcess=!1,t.myPressEndToProcess=!1;this._updateScreenSize(),!this.isAnyButtonPressed()&&!this._myMoving&&(this._myPointerID=null),this._myLastValidPointerEvent!=null&&(this._isPointerEventValid(this._myLastValidPointerEvent)||(this._myInsideView&&this._onPointerLeave(this._myLastValidPointerEvent),this._myLastValidPointerEvent=null))}isValid(){return this._myValid}isButtonPressed(e){let t=!1;return this._myButtonInfos.has(e)&&(t=this._myButtonInfos.get(e).myPressed),t}isAnyButtonPressed(){let e=!1;for(let t of this._myButtonInfos.values())if(t.myPressed){e=!0;break}return e}isButtonPressStart(e){let t=!1;return this._myButtonInfos.has(e)&&(t=this._myButtonInfos.get(e).myPressStart),t}isButtonPressEnd(e=null){let t=!1;return this._myButtonInfos.has(e)&&(t=this._myButtonInfos.get(e).myPressEnd),t}isMoving(){return this._myMoving}isInsideView(){return this._myInsideView}isTargetingRenderCanvas(){return this.isInsideView()&&this._myLastValidPointerEvent!=null&&this._myLastValidPointerEvent.target==r.getCanvas(this._myEngine)}raycastWorld(e,t=new Le){return this.getOriginWorld(e.myOrigin),this.getDirectionWorld(e.myDirection),t=Me.raycast(e,t,r.getPhysics(this._myEngine)),t}getPositionScreen(e=De()){let t=e;return t[0]=this._myInternalMousePosition[0],t[1]=this._myScreenSize[1]-1-this._myInternalMousePosition[1],t}getPositionScreenNormalized(e=De()){let t=e;return t[0]=this._myScreenSize[0]==0?0:this._myInternalMousePosition[0]/this._myScreenSize[0]*2-1,t[1]=this._myScreenSize[1]==0?0:(this._myScreenSize[1]-1-this._myInternalMousePosition[1])/this._myScreenSize[1]*2-1,t}getScreenSize(){return this._myScreenSize}getPositionWorld(e,t=m()){let n=this.getOriginWorld(this._myOriginWorld),o=this.getDirectionWorld(this._myDirectionWorld);return t=n.vec3_add(o.vec3_scale(e,t),t),t}getOriginWorld(e=m()){return B.isSessionActive(this._myEngine)?r.getPlayerObjects(this._myEngine).myEyeLeft.pp_getPosition(e):r.getPlayerObjects(this._myEngine).myCameraNonXR.pp_getPosition(e),e}getDirectionWorld(e=m()){let t=this._myInternalMousePosition[0]/this._myScreenSize[0],n=this._myInternalMousePosition[1]/this._myScreenSize[1],o=e;o.vec3_set(t*2-1,-n*2+1,-1);let s=this._myProjectionMatrixInverse;B.isSessionActive(this._myEngine)?s=r.getPlayerObjects(this._myEngine).myEyeLeft.pp_getComponent(OC).projectionMatrix.mat4_invert(s):s=r.getPlayerObjects(this._myEngine).myCameraNonXR.pp_getComponent(OC).projectionMatrix.mat4_invert(s),o.vec3_transformMat4(s,o),o.vec3_normalize(o);let a=o;return B.isSessionActive(this._myEngine)?a=o.vec3_transformQuat(r.getPlayerObjects(this._myEngine).myEyeLeft.pp_getRotationQuat(this._myRotationQuat),o):a=o.vec3_transformQuat(r.getPlayerObjects(this._myEngine).myCameraNonXR.pp_getRotationQuat(this._myRotationQuat),o),a.vec3_normalize(a),e}setTouchValid(e){let t="pp_internal_touch_valid_callback";e?this.removePointerEventValidCallback(t):this.addPointerEventValidCallback(t,function(n){return n.pointerType=="mouse"})}setTargetOnlyRenderCanvas(e){let t="pp_internal_target_only_render_canvas_callback";e?this.addPointerEventValidCallback(t,function(n){return n.target==r.getCanvas(this._myEngine)}):this.removePointerEventValidCallback(t)}getLastValidPointerEvent(){return this._myLastValidPointerEvent}addPointerEventValidCallback(e,t){this._myPointerEventValidCallbacks.set(e,t)}removePointerEventValidCallback(e){this._myPointerEventValidCallbacks.delete(e)}isPointerUpOnPointerLeave(){return this._myPointerUpOnPointerLeave}setPointerUpOnPointerLeave(e){this._myPointerUpOnPointerLeave=e}isContextMenuActive(){return this._myContextMenuActive}setContextMenuActive(e){this._myContextMenuActive!=e&&(e?r.getBody(this._myEngine).removeEventListener("contextmenu",this._myPreventContextMenuEventListener):r.getBody(this._myEngine).addEventListener("contextmenu",this._myPreventContextMenuEventListener,!1),this._myContextMenuActive=e)}isMiddleButtonScrollActive(){return this._myMiddleButtonScrollActive}setMiddleButtonScrollActive(e){this._myMiddleButtonScrollActive!=e&&(e?r.getBody(this._myEngine).removeEventListener("mousedown",this._myPreventMiddleButtonScrollEventListener):r.getBody(this._myEngine).addEventListener("mousedown",this._myPreventMiddleButtonScrollEventListener,!1),this._myMiddleButtonScrollActive=e)}setResetMovingDelay(e){this._myResetMovingDelay=e}getResetMovingDelay(){return this._myResetMovingDelay}_onPointerAction(e,t){if(!!this._isPointerEventIDValid(t)){if(!this._isPointerEventValid(t)){this._myInsideView&&this._onPointerLeave(t);return}this._myInsideView||this._onPointerEnter(t),e(t),this._updatePositionAndScreen(t),this._updatePointerData(t)}}_onMouseAction(e,t){!this._myInsideView||!this._isMouseAllowed()||!this._isPointerEventIDValid(this._myLastValidPointerEvent)||!this._isPointerEventValid(this._myLastValidPointerEvent)||e(t)}_onPointerMove(e){this._myResetMovingTimer.start(this._myResetMovingDelay),this._myMoving=!0}_onPointerDown(e){let t=this._myButtonInfos.get(e.button);t.myPressed||(t.myPressed=!0,t.myPressStartToProcess=!0)}_onPointerUp(e){let t=this._myButtonInfos.get(e.button);t.myPressed&&(t.myPressed=!1,t.myPressEndToProcess=!0)}_onPointerLeave(e){if(!(!this._myInsideView||this._myLastValidPointerEvent==null||e.pointerId!=this._myLastValidPointerEvent.pointerId)){if(this._myInsideView=!1,this._myMoving=!1,this._myPointerUpOnPointerLeave)for(let t of this._myButtonInfos.values())t.myPressed&&(t.myPressed=!1,t.myPressEndToProcess=!0);this._myPointerID=null}}_onPointerEnter(e){this._myInsideView&&this._myPointerID!=null||!this._isPointerEventIDValid(e)||!this._isPointerEventValid(e)||(this._myInsideView=!0,this._updatePositionAndScreen(e),this._updatePointerData(e))}_preventContextMenu(e){!this._isPointerEventIDValid(e)||!this._isPointerEventValid(e)||e.preventDefault()}_preventMiddleButtonScroll(e){if(!(!this._isPointerEventIDValid(e)||!this._isPointerEventValid(e))&&e.button==1)return e.preventDefault(),!1}_updatePositionAndScreen(e){this._updateScreenSize(),this._myInternalMousePosition[0]=e.clientX,this._myInternalMousePosition[1]=e.clientY,this._myValid=!0}_updateScreenSize(){let e=r.getBody(this._myEngine).getBoundingClientRect();this._myScreenSize[0]=e.width,this._myScreenSize[1]=e.height}_updatePointerData(e){this._myPointerID=e.pointerId,this._myLastValidPointerEvent=e}_isPointerEventIDValid(e){return e==null?!1:this._myPointerID==null||this._myPointerID==e.pointerId}_isPointerEventValid(e){if(e==null)return!1;let t=!0;for(let n of this._myPointerEventValidCallbacks.values())if(!n(e)){t=!1;break}return t}_isMouseAllowed(){return this._myLastValidPointerEvent!=null&&this._myLastValidPointerEvent.pointerId==1}_createButtonInfo(){return{myPressed:!1,myPressStart:!1,myPressStartToProcess:!1,myPressEnd:!1,myPressEndToProcess:!1}}destroy(){this._myDestroyed=!0,r.getBody(this._myEngine).removeEventListener("pointermove",this._myPointerMoveEventListener),r.getBody(this._myEngine).removeEventListener("pointerdown",this._myPointerDownEventListener),r.getBody(this._myEngine).removeEventListener("pointerup",this._myPointerUpEventListener),r.getBody(this._myEngine).removeEventListener("pointerleave",this._myPointerLeaveEventListener),r.getBody(this._myEngine).removeEventListener("pointerenter",this._myPointerEnterEventListener),r.getBody(this._myEngine).removeEventListener("mousedown",this._myMouseDownEventListener),r.getBody(this._myEngine).removeEventListener("mouseup",this._myMouseUpEventListener),r.getBody(this._myEngine).removeEventListener("contextmenu",this._myPreventContextMenuEventListener),r.getBody(this._myEngine).removeEventListener("mousedown",this._myPreventMiddleButtonScrollEventListener)}isDestroyed(){return this._myDestroyed}};var Ls=class{constructor(e=r.getMainEngine()){this._myEngine=e,this._myMouse=new Hs(this._myEngine),this._myKeyboard=new Vs(this._myEngine),this._myHeadPose=new Is(new xt(this._myEngine)),this._myHeadPose.setReferenceObject(r.getPlayerObjects(this._myEngine).myPlayerPivot),this._myHeadPose.setForwardFixed(r.isPoseForwardFixed(this._myEngine)),this._myHandPoses=[],this._myHandPoses[A.LEFT]=new ao(A.LEFT,new so(this._myEngine)),this._myHandPoses[A.RIGHT]=new ao(A.RIGHT,new so(this._myEngine)),this._myHandPoses[A.LEFT].setReferenceObject(r.getPlayerObjects(this._myEngine).myPlayerPivot),this._myHandPoses[A.RIGHT].setReferenceObject(r.getPlayerObjects(this._myEngine).myPlayerPivot),this._myHandPoses[A.LEFT].setForwardFixed(r.isPoseForwardFixed(this._myEngine)),this._myHandPoses[A.RIGHT].setForwardFixed(r.isPoseForwardFixed(this._myEngine)),this._myTrackedHandPoses=[],this._myTrackedHandPoses[A.LEFT]=new qo(A.LEFT,new ro(!0,this._myEngine)),this._myTrackedHandPoses[A.RIGHT]=new qo(A.RIGHT,new ro(!0,this._myEngine)),this._myTrackedHandPoses[A.LEFT].setReferenceObject(r.getPlayerObjects(this._myEngine).myPlayerPivot),this._myTrackedHandPoses[A.RIGHT].setReferenceObject(r.getPlayerObjects(this._myEngine).myPlayerPivot),this._myTrackedHandPoses[A.LEFT].setForwardFixed(r.isPoseForwardFixed(this._myEngine)),this._myTrackedHandPoses[A.RIGHT].setForwardFixed(r.isPoseForwardFixed(this._myEngine)),this._myGamepadsManager=new Bs(this._myEngine),this._myDestroyed=!1}start(){this._myMouse.start(),this._myKeyboard.start(),this._myHeadPose.setReferenceObject(r.getPlayerObjects(this._myEngine).myPlayerPivot),this._myHeadPose.setForwardFixed(r.isPoseForwardFixed(this._myEngine)),this._myHeadPose.start();for(let e in this._myHandPoses)this._myHandPoses[e].setReferenceObject(r.getPlayerObjects(this._myEngine).myPlayerPivot),this._myHandPoses[e].setForwardFixed(r.isPoseForwardFixed(this._myEngine)),this._myHandPoses[e].start();for(let e in this._myTrackedHandPoses)this._myTrackedHandPoses[e].setReferenceObject(r.getPlayerObjects(this._myEngine).myPlayerPivot),this._myTrackedHandPoses[e].setForwardFixed(r.isPoseForwardFixed(this._myEngine)),this._myTrackedHandPoses[e].start();this._myGamepadsManager.start()}update(e){this._myMouse.update(e),this._myKeyboard.update(e),this._myHeadPose.setReferenceObject(r.getPlayerObjects(this._myEngine).myPlayerPivot),this._myHeadPose.setForwardFixed(r.isPoseForwardFixed(this._myEngine)),this._myHeadPose.update(e);for(let t in this._myHandPoses)this._myHandPoses[t].setReferenceObject(r.getPlayerObjects(this._myEngine).myPlayerPivot),this._myHandPoses[t].setForwardFixed(r.isPoseForwardFixed(this._myEngine)),this._myHandPoses[t].update(e);for(let t in this._myTrackedHandPoses)this._myTrackedHandPoses[t].setReferenceObject(r.getPlayerObjects(this._myEngine).myPlayerPivot),this._myTrackedHandPoses[t].setForwardFixed(r.isPoseForwardFixed(this._myEngine)),this._myTrackedHandPoses[t].update(e);this._myGamepadsManager.update(e)}getMouse(){return this._myMouse}getKeyboard(){return this._myKeyboard}getGamepadsManager(){return this._myGamepadsManager}getHeadPose(){return this._myHeadPose}getLeftHandPose(){return this._myHandPoses[A.LEFT]}getRightHandPose(){return this._myHandPoses[A.RIGHT]}getHandPose(e){return this._myHandPoses[e]}getHandPoses(){return this._myHandPoses}getLeftTrackedHandPose(){return this._myTrackedHandPoses[A.LEFT]}getRightTrackedHandPose(){return this._myTrackedHandPoses[A.RIGHT]}getTrackedHandPose(e){return this._myTrackedHandPoses[e]}getTrackedHandPoses(){return this._myTrackedHandPoses}destroy(){this._myDestroyed=!0,this._myMouse.destroy(),this._myKeyboard.destroy(),this._myHeadPose.destroy();for(let e in this._myHandPoses)this._myHandPoses[e].destroy();for(let e in this._myTrackedHandPoses)this._myTrackedHandPoses[e].destroy();this._myGamepadsManager.destroy()}isDestroyed(){return this._myDestroyed}};var Ht=class extends XD{init(){this._myInputManager=null,this._myPoseForwardFixedGlobal=null,r.hasInputManager(this.engine)||(this._myInputManager=new Ls(this.engine),r.setInputManager(this._myInputManager,this.engine)),r.hasPoseForwardFixed(this.engine)||(this._myPoseForwardFixedGlobal=this._myPoseForwardFixed,r.setPoseForwardFixed(this._myPoseForwardFixedGlobal,this.engine))}start(){this._myInputManager!=null&&(this._myInputManager.start(),this._setupMousePrevent(),this._addGamepadCores())}update(e){this._myInputManager!=null&&this._myInputManager.update(e)}_setupMousePrevent(){this._myMousePreventContextMenu&&this._myInputManager.getMouse().setContextMenuActive(!1),this._myMousePreventMiddleButtonScroll&&this._myInputManager.getMouse().setMiddleButtonScrollActive(!1)}_addGamepadCores(){let e=this._myInputManager.getLeftHandPose(),t=this._myInputManager.getRightHandPose(),n=new Uo(e),o=new Uo(t);this._myInputManager.getGamepadsManager().getLeftGamepad().addGamepadCore("pp_left_xr_gamepad",n),this._myInputManager.getGamepadsManager().getRightGamepad().addGamepadCore("pp_right_xr_gamepad",o);let s=new Go(e),a=new Go(t);this._myInputManager.getGamepadsManager().getLeftGamepad().addGamepadCore("pp_left_keyboard_gamepad",s),this._myInputManager.getGamepadsManager().getRightGamepad().addGamepadCore("pp_right_keyboard_gamepad",a);let l=new No(null,e),h=new No(null,t);this._myInputManager.getGamepadsManager().getLeftGamepad().addGamepadCore("pp_left_classic_gamepad",l),this._myInputManager.getGamepadsManager().getRightGamepad().addGamepadCore("pp_right_classic_gamepad",h)}onDestroy(){this._myInputManager!=null&&r.getInputManager(this.engine)==this._myInputManager&&(r.removeInputManager(this.engine),this._myInputManager.destroy()),this._myPoseForwardFixedGlobal!=null&&r.isPoseForwardFixed(this.engine)==this._myPoseForwardFixedGlobal&&r.removePoseForwardFixed(this.engine)}};R(Ht,"TypeName","pp-input-manager"),R(Ht,"Properties",{_myPoseForwardFixed:tm.bool(!0),_myMousePreventContextMenu:tm.bool(!0),_myMousePreventMiddleButtonScroll:tm.bool(!0)});import{Component as KD,Property as JD}from"@wonderlandengine/api";var Pi=class extends KD{init(){this._myToolEnabled=null,r.hasToolEnabled(this.engine)||(this._myToolEnabled=this._myEnable,r.setToolEnabled(this._myToolEnabled,this.engine))}onDestroy(){this._myToolEnabled!=null&&r.isToolEnabled(this.engine)==this._myToolEnabled&&r.removeToolEnabled(this.engine)}};R(Pi,"TypeName","pp-enable-tools"),R(Pi,"Properties",{_myEnable:JD.bool(!0)});import{Component as ZD,Property as YD}from"@wonderlandengine/api";var ks=class{constructor(){this._myVariables=new Map}add(e){this._myVariables.set(e.getName(),e)}remove(e){this._myVariables.delete(e)}get(e){let t=this._myVariables.get(e);return t?t.getValue():null}set(e,t,n=!1){let o=this._myVariables.get(e);o&&o.setValue(t,n)}has(e){return this._myVariables.has(e)}length(){return this._myVariables.size}isActive(e){let t=this._myVariables.get(e);return t?t.isActive():!1}getEasyTuneVariable(e){return this._myVariables.get(e)}getEasyTuneVariablesList(){return Array.from(this._myVariables.values())}getEasyTuneVariablesNames(){return Array.from(this._myVariables.keys())}fromJSON(e,t=!1){let n=JSON.parse(e);for(let o of this._myVariables.values()){let s=n[o.getName()];s!==void 0&&o.fromJSON(s,t)}}toJSON(){let e={};for(let t of this._myVariables.values())e[t.getName()]=t.toJSON();return JSON.stringify(e)}registerValueChangedEventListener(e,t,n){this._myVariables.get(e).registerValueChangedEventListener(t,n)}unregisterValueChangedEventListener(e,t,n){this._myVariables.get(e).unregisterValueChangedEventListener(t)}};var Lt=class extends ZD{init(){this._myEasyTuneVariables=null,this._myInit&&(r.hasEasyTuneVariables(this.engine)||(this._myEasyTuneVariables=new ks,r.setEasyTuneVariables(this._myEasyTuneVariables,this.engine)))}onDestroy(){this._myEasyTuneVariables!=null&&r.getEasyTuneVariables(this.engine)==this._myEasyTuneVariables&&r.removeEasyTuneVariables(this.engine)}};R(Lt,"TypeName","pp-init-easy-tune-variables"),R(Lt,"Properties",{_myInit:YD.bool(!0)});import{Component as $D,Property as eR}from"@wonderlandengine/api";var Ci=class extends $D{init(){this._myAdd&&(r.getWindow(this.engine).PP={},this._addProperties(im))}_addProperties(e){let t=Object.getOwnPropertyNames(e);for(let n of t)e[n]!=null&&(r.getWindow(this.engine).PP[n]=e[n])}onDestroy(){r.getWindow(this.engine).PP=void 0}};R(Ci,"TypeName","pp-add-pp-to-window"),R(Ci,"Properties",{_myAdd:eR.bool(!0)});import{Component as tR,Property as ri}from"@wonderlandengine/api";var kt=class extends tR{init(){this._myDefaultResources=null,r.hasDefaultResources(this.engine)||(this._myDefaultResources=new xs,this._myDefaultResources.myMeshes.myPlane=Xe.clone(this._myPlane),this._myDefaultResources.myMeshes.myCube=Xe.clone(this._myCube),this._myDefaultResources.myMeshes.mySphere=Xe.clone(this._mySphere),this._myDefaultResources.myMeshes.myCone=Xe.clone(this._myCone),this._myDefaultResources.myMeshes.myCylinder=Xe.clone(this._myCylinder),this._myDefaultResources.myMeshes.myCircle=Xe.clone(this._myCircle),this._myDefaultResources.myMeshes.myInvertedCube=Xe.invert(this._myCube),this._myDefaultResources.myMeshes.myInvertedSphere=Xe.invert(this._mySphere),this._myDefaultResources.myMeshes.myInvertedCone=Xe.invert(this._myCone),this._myDefaultResources.myMeshes.myInvertedCylinder=Xe.invert(this._myCylinder),this._myFlatOpaque!=null&&(this._myDefaultResources.myMaterials.myFlatOpaque=this._myFlatOpaque.clone()),this._myFlatTransparentNoDepth!=null&&(this._myDefaultResources.myMaterials.myFlatTransparentNoDepth=this._myFlatTransparentNoDepth.clone()),this._myPhongOpaque!=null&&(this._myDefaultResources.myMaterials.myPhongOpaque=this._myPhongOpaque.clone()),this._myText!=null&&(this._myDefaultResources.myMaterials.myText=this._myText.clone()),r.setDefaultResources(this._myDefaultResources,this.engine))}onDestroy(){this._myDefaultResources!=null&&r.getDefaultResources(this.engine)==this._myDefaultResources&&r.removeDefaultResources(this.engine)}};R(kt,"TypeName","pp-get-default-resources"),R(kt,"Properties",{_myPlane:ri.mesh(),_myCube:ri.mesh(),_mySphere:ri.mesh(),_myCone:ri.mesh(),_myCylinder:ri.mesh(),_myCircle:ri.mesh(),_myFlatOpaque:ri.material(),_myFlatTransparentNoDepth:ri.material(),_myPhongOpaque:ri.material(),_myText:ri.material()});import{Component as iR,Property as Ri}from"@wonderlandengine/api";var Ft=class extends iR{init(){this._mySceneObjects=null,r.hasSceneObjects(this.engine)||(this._mySceneObjects=new vs,this._mySceneObjects.myScene=this._myScene,this._mySceneObjects.myPlayerObjects.myPlayer=this._myPlayer,this._mySceneObjects.myPlayerObjects.myPlayerPivot=this._myPlayerPivot,this._mySceneObjects.myPlayerObjects.myCameraNonXR=this._myCameraNonXR,this._mySceneObjects.myPlayerObjects.myEyeLeft=this._myEyeLeft,this._mySceneObjects.myPlayerObjects.myEyeRight=this._myEyeRight,this._mySceneObjects.myPlayerObjects.myHandLeft=this._myHandLeft,this._mySceneObjects.myPlayerObjects.myHandRight=this._myHandRight,this._mySceneObjects.myPlayerObjects.myEyes=[],this._mySceneObjects.myPlayerObjects.myEyes[A.LEFT]=this._myEyeLeft,this._mySceneObjects.myPlayerObjects.myEyes[A.RIGHT]=this._myEyeRight,this._mySceneObjects.myPlayerObjects.myHands=[],this._mySceneObjects.myPlayerObjects.myHands[A.LEFT]=this._myHandLeft,this._mySceneObjects.myPlayerObjects.myHands[A.RIGHT]=this._myHandRight,this._mySceneObjects.myPlayerObjects.myHead=this._myHead,this._mySceneObjects.myPlayerObjects.myPlayerPivot==null&&(this._mySceneObjects.myPlayerObjects.myPlayerPivot=this._mySceneObjects.myPlayerObjects.myPlayer),this._mySceneObjects.myCauldron=this._mySceneObjects.myScene.pp_addObject(),this._mySceneObjects.myCauldron.pp_setName("Cauldron"),this._mySceneObjects.myDynamics=this._mySceneObjects.myScene.pp_addObject(),this._mySceneObjects.myDynamics.pp_setName("Dynamics"),this._mySceneObjects.myParticles=this._mySceneObjects.myScene.pp_addObject(),this._mySceneObjects.myParticles.pp_setName("Particles"),this._mySceneObjects.myVisualElements=this._mySceneObjects.myScene.pp_addObject(),this._mySceneObjects.myVisualElements.pp_setName("Visual Elements"),this._mySceneObjects.myTools=this._mySceneObjects.myScene.pp_addObject(),this._mySceneObjects.myTools.pp_setName("Tools"),this._mySceneObjects.myPlayerObjects.myPlayerCauldron=this._mySceneObjects.myPlayerObjects.myPlayer.pp_addObject(),this._mySceneObjects.myPlayerObjects.myPlayerCauldron.pp_setName("Player Cauldron"),r.setSceneObjects(this._mySceneObjects,this.engine))}onDestroy(){this._mySceneObjects!=null&&r.getSceneObjects(this.engine)==this._mySceneObjects&&r.removeSceneObjects(this.engine)}};R(Ft,"TypeName","pp-get-scene-objects"),R(Ft,"Properties",{_myScene:Ri.object(),_myPlayer:Ri.object(),_myPlayerPivot:Ri.object(),_myCameraNonXR:Ri.object(),_myEyeLeft:Ri.object(),_myEyeRight:Ri.object(),_myHandLeft:Ri.object(),_myHandRight:Ri.object(),_myHead:Ri.object()});var BC=[],ln=class extends nR{static onRegister(e){BC.includes(e)||(BC.push(e),$l(e))}init(){this._myGetDefaultResourcesComponent=this.object.pp_addComponent(kt,this._getProperties(kt.Properties)),this._myGetSceneObjectsComponent=this.object.pp_addComponent(Ft,this._getProperties(Ft.Properties)),this._myEnableDebugsComponent=null,this._myEnableDebugs&&(this._myEnableDebugsComponent=this.object.pp_addComponent(fi,!1)),this._myEnableToolsComponent=null,this._myEnableTools&&(this._myEnableToolsComponent=this.object.pp_addComponent(Pi,!1)),this._myAddPPToWindowComponent=null,this._myAddPPToWindow&&(this._myAddPPToWindowComponent=this.object.pp_addComponent(Ci,!1)),this._myAddWLToWindowComponent=null,this._myAddWLToWindow&&(this._myAddWLToWindowComponent=this.object.pp_addComponent(gi,!1)),this._myInitEasyTuneVariablesComponent=null,this._myInitEasyTuneVariables&&(this._myInitEasyTuneVariablesComponent=this.object.pp_addComponent(Lt,!1)),this._myInputManagerComponent=this.object.pp_addComponent(Ht,this._getProperties(Ht.Properties)),this._myAudioManagerComponent=this.object.pp_addComponent($t,!1),this._myVisualManagerComponent=this.object.pp_addComponent(ei,!1),this._myDebugManagerComponent=this.object.pp_addComponent(ti,!1)}start(){this._myGetDefaultResourcesComponent.active=!0,this._myGetSceneObjectsComponent.active=!0,this._myEnableDebugsComponent!=null&&(this._myEnableDebugsComponent.active=!0),this._myEnableToolsComponent!=null&&(this._myEnableToolsComponent.active=!0),this._myAddPPToWindowComponent!=null&&(this._myAddPPToWindowComponent.active=!0),this._myAddWLToWindowComponent!=null&&(this._myAddWLToWindowComponent.active=!0),this._myInitEasyTuneVariablesComponent!=null&&(this._myInitEasyTuneVariablesComponent.active=!0),this._myInputManagerComponent.active=!0,this._myAudioManagerComponent.active=!0,this._myVisualManagerComponent.active=!0,this._myDebugManagerComponent.active=!0}_getProperties(e,t=!1){let n={};n.active=t;let o=Object.getOwnPropertyNames(e);for(let s of o)this[s]!=null&&(n[s]=this[s]);return n}};R(ln,"TypeName","pp-gateway"),R(ln,"Properties",{_myEnableDebugs:Fs.bool(!0),_myEnableTools:Fs.bool(!0),_myAddPPToWindow:Fs.bool(!0),_myAddWLToWindow:Fs.bool(!0),_myInitEasyTuneVariables:Fs.bool(!0),...Ht.Properties,...$t.Properties,...ei.Properties,...ti.Properties,...Ft.Properties,...kt.Properties});import{Howler as IC}from"howler";function HC(){let i=!1;return IC!=null&&IC.state!="running"&&(i=!0),i}var oR={isPlaybackBlocked:HC};var nm=class extends Zn{constructor(e,t=null){super(t,!1),this._myAudio=e,t==null?(this._myAudioSetup.myAudioFilePath=this._myAudio._src,this._myAudioSetup.myLoop=this._myAudio._loop,this._myAudioSetup.myAutoplay=this._myAudio._autoplay,this._myAudioSetup.myVolume=this._myAudio._volume,this._myAudioSetup.myRate=this._myAudio._rate,this._myAudioSetup.myPool=this._myAudio._pool,this._myAudioSetup.myPreload=this._myAudio._preload,this._myAudioSetup.myPosition=this._myAudio._pos!=null?this._myAudio._pos.vec3_clone():null,this._myAudioSetup.mySpatial=this._myAudio._pos!=null,this._myAudioSetup.myReferenceDistance=this._myAudio._pannerAttr.refDistance):(this._myAudioSetup.myAudioFilePath=this._myAudio._src,this._myAudio.loop(this._myAudioSetup.myLoop),this._myAudio._autoplay=this._myAudioSetup.myAutoplay,this._myAudio.volume(this._myAudioSetup.myVolume),this._myAudio.rate(this._myAudioSetup.myRate),this._myAudio._pool=this._myAudioSetup.myPool,this._myAudio._preload=this._myAudioSetup.myPreload,this.updatePosition(this._myAudioSetup.myPosition),this._myAudio._pannerAttr.refDistance=this._myAudioSetup.myReferenceDistance,this._myAudioSetup.myAutoplay&&this._myAudio.play()),this._addListeners()}};import{Component as sR}from"@wonderlandengine/api";import{Howler as aR}from"howler";var mn=class extends sR{start(){aR.mute(!0)}};R(mn,"TypeName","pp-mute-everything"),R(mn,"Properties",{});import{Component as rR}from"@wonderlandengine/api";import{Howler as LC}from"howler";var yn=class extends rR{init(){this._myOrigin=m(),this._myForward=m(),this._myUp=m()}start(){this._updateAudioListener()}update(e){this._updateAudioListener()}_updateAudioListener(){this.object.pp_getPosition(this._myOrigin),this.object.pp_getForward(this._myForward),this.object.pp_getUp(this._myUp),LC.pos(this._myOrigin[0],this._myOrigin[1],this._myOrigin[2]),LC.orientation(this._myForward[0],this._myForward[1],this._myForward[2],this._myUp[0],this._myUp[1],this._myUp[2])}};R(yn,"TypeName","pp-spatial-audio-listener"),R(yn,"Properties",{});import{Component as lR,PhysXComponent as mR,Property as ft,Shape as sm}from"@wonderlandengine/api";import{CollisionEventType as ws,Emitter as om,PhysXComponent as kC}from"@wonderlandengine/api";var Ai=class{constructor(e,t=!1){this._myPhysX=e,this._myTrigger=t,this._myCollisions=[],this._myCollisionsStart=[],this._myCollisionsEnd=[],this._myUpdateActive=!1,this._myCollisionsStartToProcess=[],this._myCollisionsEndToProcess=[],this._myCollisionCallbackID=null,this._myActive=!1,this.setActive(!0),this._myLogEnabled=!1,this._myTriggerDesyncFixDelay=new ie(.1),this._myCollisionEmitter=new om,this._myCollisionStartEmitter=new om,this._myCollisionEndEmitter=new om,this._myDestroyed=!1}getPhysX(){return this._myPhysX}getCollisions(){return this._myCollisions}getCollisionsStart(){return this._myCollisionsStart}getCollisionsEnd(){return this._myCollisionsEnd}isActive(){return this._myActive}setActive(e){this._myActive!=e&&(this._myActive=e,this._myCollisions=[],this._myCollisionsStart=[],this._myCollisionsEnd=[],this._myUpdateActive=!1,this._myCollisionsStartToProcess=[],this._myCollisionsEndToProcess=[],this._myActive?this._myCollisionCallbackID=this._myPhysX.onCollision(this._onCollision.bind(this)):this._myCollisionCallbackID!=null&&(this._myPhysX.removeCollisionCallback(this._myCollisionCallbackID),this._myCollisionCallbackID=null))}setUpdateActive(e){this._myUpdateActive=e}update(e){!this._myActive||(this._myUpdateActive=!0,this._myCollisionsStart=this._myCollisionsStartToProcess,this._myCollisionsStartToProcess=[],this._myCollisionsEnd=this._myCollisionsEndToProcess,this._myCollisionsEndToProcess=[],this._myTrigger&&this._triggerDesyncFix(e))}isLogEnabled(){return this._myLogEnabled}setLogEnabled(e){this._myLogEnabled=e}registerCollisionEventListener(e,t){this._myCollisionEmitter.add(t,{id:e})}unregisterCollisionEventListener(e){this._myCollisionEmitter.remove(e)}registerCollisionStartEventListener(e,t){this._myCollisionStartEmitter.add(t,{id:e})}unregisterCollisionStartEventListener(e){this._myCollisionStartEmitter.remove(e)}registerCollisionEndEventListener(e,t){this._myCollisionEndEmitter.add(t,{id:e})}unregisterCollisionEndEventListener(e){this._myCollisionEndEmitter.remove(e)}_onCollision(e,t){e==ws.Touch||e==ws.TriggerTouch?this._onCollisionStart(e,t):(e==ws.TouchLost||e==ws.TriggerTouchLost)&&this._onCollisionEnd(e,t),this._myCollisionEmitter.notify(this._myPhysX,t,e)}_onCollisionStart(e,t){if(this._myLogEnabled){let n=!1;for(let o of this._myCollisions)if(o.pp_equals(t.object)){n=!0;break}n&&console.error("Collision Start on object already collected")}this._myCollisions.push(t.object),this._myUpdateActive&&(this._myCollisionsStartToProcess.push(t.object),this._myCollisionsEndToProcess.pp_removeAll(function(n){return n.pp_equals(t.object)})),this._myLogEnabled&&console.log("Collision Start -",this._myCollisions.length),this._myCollisionStartEmitter.notify(this._myPhysX,t,e)}_onCollisionEnd(e,t){if(this._myLogEnabled){let n=!1;for(let o of this._myCollisions)if(o.pp_equals(t.object)){n=!0;break}n||console.error("Collision End on object not collected")}this._myCollisions.pp_removeAll(function(n){return n.pp_equals(t.object)}),this._myUpdateActive&&(this._myCollisionsEndToProcess.push(t.object),this._myCollisionsStartToProcess.pp_removeAll(function(n){return n.pp_equals(t.object)})),this._myLogEnabled&&console.log("Collision End -",this._myCollisions.length),this._myCollisionEndEmitter.notify(this._myPhysX,t,e)}_triggerDesyncFix(e){if(this._myTriggerDesyncFixDelay.update(e),this._myTriggerDesyncFixDelay.isDone()){this._myTriggerDesyncFixDelay.start();let t=this._myCollisions.pp_findAll(function(n){let o=n.pp_getComponentSelf(kC);return o==null||!o.active});if(t.length>0)for(let n of t){let o=n.pp_getComponentSelf(kC);o?this._onCollisionEnd(ws.TriggerTouchLost,o):console.error("NO PHYSX, HOW?")}}}destroy(){this._myDestroyed=!0,this._myCollisionCallbackID!=null&&(this._myPhysX.removeCollisionCallback(this._myCollisionCallbackID),this._myCollisionCallbackID=null)}isDestroyed(){return this._myDestroyed}};var un=class extends lR{start(){this._myValid=!1,r.isDebugEnabled(this.engine)&&(this._myValid=!0,this._myStarted=!1,this._myPreStartTimer=new ie(1))}_start(){this._myParentObject=this.object.pp_addObject(),this._myRaycastParams=new ct(r.getPhysics(this.engine)),this._myRaycastResults=new Le,this._myStaticPhysXObjects=[],this._myStaticPhysXComponents=[],this._myStaticPhysXCollectors=[],this._myDynamicPhysXObjects=[],this._myDynamicPhysXComponents=[],this._myDynamicPhysXCollectors=[],this._myKinematicPhysXObjects=[],this._myKinematicPhysXComponents=[],this._myKinematicPhysXCollectors=[],this._spawnDome(!0,!1),this._spawnDome(!1,!1),this._spawnDome(!1,!0),this._myStartTimer=new ie(1),this._myTimer=new ie(0),this._myDebugTimer=new ie(this._myVisualizeRaycastDelay),this._myLogEnabledTimer=new ie(1),this._myFPSHistory=[];for(let e=0;e<7;e++)this._myFPSHistory.push(0);this._myAddVelocityDelay=10,this._myTranslateVec3=m(),this._myRotateVec3=m(),this._myStarted=!0}update(e){if(!!this._myValid)if(!this._myStarted)this._myPreStartTimer.update(e),this._myPreStartTimer.isDone()&&this._start();else{if(this._myStartTimer.update(e),this._myStartTimer.isDone()){if(this._myTimer.update(e),this._myDebugTimer.update(e),this._myLogEnabledTimer.update(e),this._myTimer.isDone()){this._myTimer.start();let t=!1;this._myDebugTimer.isDone()&&(this._myDebugTimer.start(),t=!0),t=t&&this._myVisualizeRaycast,this._raycastTest(t)}if(this._myFPSHistory.pop(),this._myFPSHistory.unshift(Math.round(1/e)),this._myLogEnabled&&this._myLogEnabledTimer.isDone()){this._myLogEnabledTimer.start(),this._myClearConsoleBeforeLog&&console.clear(),console.log("Static PhysX Dome Size:",this._myStaticPhysXObjects.length),console.log("Dynamic PhysX Dome Size:",this._myDynamicPhysXObjects.length),console.log("Kinematic PhysX Dome Size:",this._myKinematicPhysXObjects.length);let t=0;for(let l of this._myStaticPhysXCollectors)t+=l.getCollisions().length;let n=0;for(let l of this._myDynamicPhysXCollectors)n+=l.getCollisions().length;let o=0;for(let l of this._myKinematicPhysXCollectors)o+=l.getCollisions().length;let s=(t+n+o)/2;console.log("Current Collisions Count:",s),console.log("Raycast Count:",this._myRaycastCount),console.log("FPS History:");let a="";for(let l of this._myFPSHistory)a=a.concat(l,`
`);console.log(a)}}if(this._myAddVelocityDelay>0&&(this._myAddVelocityDelay--,this._myAddVelocityDelay==0))for(let t of this._myDynamicPhysXComponents){t.kinematic=!1;let n=50;t.linearVelocity=[Math.pp_random(-n,n),Math.pp_random(-n,n),Math.pp_random(-n,n)],t.angularVelocity=[Math.pp_random(-n,n),Math.pp_random(-n,n),Math.pp_random(-n,n)]}for(let t of this._myKinematicPhysXObjects){let n=5*e;this._myTranslateVec3.vec3_set(Math.pp_random(-n,n),Math.pp_random(-n,n),Math.pp_random(-n,n)),t.pp_translate(this._myTranslateVec3);let o=50*e;this._myRotateVec3.vec3_set(Math.pp_random(-o,o),Math.pp_random(-o,o),Math.pp_random(-o,o)),t.pp_rotate(this._myRotateVec3)}}}_raycastTest(e){let t=this._myRaycastCount,n=1e4;for(let o=0;o<t;o++){let s=[Math.pp_random(1,2)*Math.pp_randomSign(),Math.pp_random(1,2)*Math.pp_randomSign(),Math.pp_random(1,2)*Math.pp_randomSign()],a=[Math.pp_random(-1,1),Math.pp_random(-1,1),Math.pp_random(-1,1)];a.vec3_normalize(a),this._myRaycastParams.myOrigin.vec3_copy(s),this._myRaycastParams.myDirection.vec3_copy(a),this._myRaycastParams.myDistance=n,this._myRaycastParams.myBlockLayerFlags.setAllFlagsActive();let l=Me.raycast(this._myRaycastParams,this._myRaycastResults);e&&r.isDebugEnabled(this.engine)&&r.getDebugVisualManager(this.engine).drawRaycast(this._myDebugTimer.getDuration(),l,!0,5,.015)}}_spawnDome(e,t){let n=this._myStaticPhysXCount,o=this._myStaticPhysXObjects,s=Math.ceil(Math.sqrt(this._myStaticPhysXCount));e||(t?(s=Math.ceil(Math.sqrt(this._myDynamicPhysXCount)),n=this._myDynamicPhysXCount,o=this._myDynamicPhysXObjects):(s=Math.ceil(Math.sqrt(this._myKinematicPhysXCount)),n=this._myKinematicPhysXCount,o=this._myKinematicPhysXObjects));let a=Math.PI*2/s,l=Math.max(0,this._myStaticDomeSize-20),h=this._myStaticDomeSize+20;e||(t?(l=Math.max(0,this._myDynamicDomeSize-20),h=this._myDynamicDomeSize+20):(l=Math.max(0,this._myKinematicDomeSize-20),h=this._myKinematicDomeSize+20));let _=0,y=Math.pp_toRadians(10),c=m(0,1,0),d=m(0,0,-1);for(let g=0;g<s/2;g++){let P=m(0,1,0),T=m();d.vec3_cross(P,T),T.vec3_normalize(T);for(let C=0;C<s;C++){if(o.length<n){let x=Math.random()*(h-l)+l,D=(Math.random()*2-1)*(y-_)+_,E=(Math.random()*2-1)*(y-_)+_,S=P.pp_clone();S.vec3_rotateAxisRadians(D,T,S),S.vec3_rotateAxisRadians(E,c,S),S.vec3_scale(x,S),this._addPhysX(S,e,t)}if(P.vec3_rotateAxisRadians(a/2,T,P),o.length<n){let x=Math.random()*(h-l)+l,D=(Math.random()*2-1)*(y-_)+_,E=(Math.random()*2-1)*(y-_)+_,S=P.pp_clone();S.vec3_rotateAxisRadians(D,T,S),S.vec3_rotateAxisRadians(E,c,S),S.vec3_scale(x,S),this._addPhysX(S,e,t)}P.vec3_rotateAxisRadians(a/2,T,P)}d.vec3_rotateAxisRadians(a,c,d)}}_addPhysX(e,t,n){let o=e,s=Math.pp_random(1,10),a=Math.pp_randomPick(sm.Sphere,sm.Box);this._myUseConvexMesh&&(a=sm.ConvexMesh,s*=this._myShapeScaleMultiplier);let l=this._myParentObject.pp_addObject();l.pp_setPosition(o);let h=l.pp_addComponent(mR,{shape:a,shapeData:{index:this._myShapeIndex},extents:m(s,s,s),static:t,kinematic:!n,mass:1});t?(this._myStaticPhysXObjects.push(l),this._myStaticPhysXComponents.push(h),this._myStaticPhysXCollectors.push(new Ai(h))):n?(this._myDynamicPhysXObjects.push(l),this._myDynamicPhysXComponents.push(h),this._myDynamicPhysXCollectors.push(new Ai(h))):(this._myKinematicPhysXObjects.push(l),this._myKinematicPhysXComponents.push(h),this._myKinematicPhysXCollectors.push(new Ai(h)))}onDestroy(){for(let e of this._myStaticPhysXCollectors)e.destroy();for(let e of this._myDynamicPhysXCollectors)e.destroy();for(let e of this._myKinematicPhysXCollectors)e.destroy()}};R(un,"TypeName","pp-benchmark-max-physx"),R(un,"Properties",{_myStaticDomeSize:ft.float(40),_myStaticPhysXCount:ft.int(1e3),_myDynamicDomeSize:ft.float(80),_myDynamicPhysXCount:ft.int(250),_myKinematicDomeSize:ft.float(120),_myKinematicPhysXCount:ft.int(250),_myRaycastCount:ft.int(100),_myVisualizeRaycast:ft.bool(!1),_myVisualizeRaycastDelay:ft.float(.5),_myUseConvexMesh:ft.bool(!1),_myShapeIndex:ft.int(0),_myShapeScaleMultiplier:ft.float(1),_myLogEnabled:ft.bool(!0),_myClearConsoleBeforeLog:ft.bool(!0)});import{Alignment as Fr,Component as yR,Justification as wr,MeshComponent as jr,Property as pt,TextComponent as zr}from"@wonderlandengine/api";var hn=class extends yR{_start(){this._myBackgroundSize=4,this._myBackgroundObject.pp_setActive(!0),this._myBackgroundObject.pp_setScale(this._myBackgroundSize+.1),this._myBackgroundObject.pp_translateLocal(m(0,0,-.001)),this._myDoubleTimer=new ie(this._mySecondsBeforeDoubling),this._myDone=!1,this._myCurrentPlanes=this._myStartPlaneCount,this._myDTHistory=[],this._myUpperLimit=-1,this._myLowerLimit=0,this._myPlanes=[],this._mySkipNextFrames=0,this._myMaxWaitFrames=0,this._myMaxPlanesReached=!1,this._myFirstTime=!0}_update(e){{if(e<1e-5)return;if(e>.5&&this._myMaxWaitFrames>0){this._myMaxWaitFrames--;return}if(this._myMaxWaitFrames=10,this._mySkipNextFrames>0){this._mySkipNextFrames--;return}}if(!this._myDone&&(this._myDoubleTimer.update(e),this._myDTHistory.push(e),this._myDoubleTimer.isDone())){this._myDoubleTimer.start();let t=this._computeAverageFrameRate(!1);if(this._myFirstTime)this._myFirstTime=!1;else{let n=!1;t<this._myStableFrameRate-this._myTargetFrameRateThreshold?(this._myUpperLimit=this._myCurrentPlanes,n=!0,this._myUpperLimit==1&&(this._myLowerLimit=1)):(this._myLowerLimit=this._myCurrentPlanes,this._myUpperLimit>0&&(this._myUpperLimit=Math.max(this._myUpperLimit,this._myLowerLimit))),this._myTriangleTextComponent.text="Triangles: "+this._myCurrentPlanes*this._myRealTrianglesAmount,this._myPlaneTextComponent.text="Planes: "+this._myCurrentPlanes,this._myFPSTextComponent.text="FPS: "+t+" / "+this._myStableFrameRate,n?(this._myTriangleTextComponent.material.color=this._myLagColor,this._myPlaneTextComponent.material.color=this._myLagColor,this._myFPSTextComponent.material.color=this._myLagColor):(this._myTriangleTextComponent.material.color=this._myNormalColor,this._myPlaneTextComponent.material.color=this._myNormalColor,this._myFPSTextComponent.material.color=this._myNormalColor);let o=!1;(this._myUpperLimit>0&&!n&&this._myUpperLimit-this._myLowerLimit<=Math.max(2,1e3/this._myRealTrianglesAmount)||n&&this._myUpperLimit-this._myLowerLimit<=1||!n&&this._myMaxPlanesReached)&&(t<this._myStableFrameRate-this._myTargetFrameRateThreshold?(this._myLowerLimit=Math.max(1,Math.floor(this._myUpperLimit/2.5)),this._myUpperLimit=0,o=!0,this._myLogEnabled&&console.log("Rst - Triangles:",this._myCurrentPlanes*this._myRealTrianglesAmount,"- Planes:",this._myCurrentPlanes,"- Frame Rate:",t)):(this._myMaxPlanesReached?this._myLogEnabled&&(console.log("Aborted - Max Planes Reached"),this._myDoneTextComponent.text="Aborted - Max Planes Reached"):(this._displayPlanes(this._myLowerLimit),this._myLogEnabled&&(console.log(`
End - Triangles:`,this._myLowerLimit*this._myRealTrianglesAmount,"- Planes:",this._myLowerLimit,"- Frame Rate:",t),console.log("Plane Triangles (Adjusted):",this._myRealTrianglesAmount),console.log("Target Frame Rate:",this._myStableFrameRate,"- Threshold: ",this._myStableFrameRate-this._myTargetFrameRateThreshold)),this._myTriangleTextComponent.text="Triangles: "+this._myLowerLimit*this._myRealTrianglesAmount,this._myPlaneTextComponent.text="Planes: "+this._myLowerLimit,this._myFPSTextComponent.text="FPS: "+t+" / "+this._myStableFrameRate,this._myDoneTextComponent.text="End"),this._myDone=!0)),n&&!o&&this._myLogEnabled&&console.log("Lag - Triangles:",this._myCurrentPlanes*this._myRealTrianglesAmount,"- Planes:",this._myCurrentPlanes,"- Frame Rate:",t),this._myDone||(this._myUpperLimit>0?(this._myCurrentPlanes=Math.floor((this._myUpperLimit+this._myLowerLimit)/2),this._myCurrentPlanes=Math.max(this._myCurrentPlanes,1)):o?this._myCurrentPlanes=this._myLowerLimit:this._myCurrentPlanes=this._myLowerLimit*2,this._myCurrentPlanes>5e4?(this._myCurrentPlanes=5e4,this._myMaxPlanesReached=!0):this._myMaxPlanesReached=!1)}this._myDone||(this._displayPlanes(this._myCurrentPlanes),this._myElapsedTime=0,this._myFrameCount=0,this._mySkipNextFrames=30)}}_displayPlanes(e){for(;this._myPlanes.length>e;){let l=this._myPlanes.pop();this._myPlanePool.release(l)}for(;this._myPlanes.length<e;){let l=this._myPlanePool.get();this._myPlanes.push(l)}let t=1;for(;t*t<e;)t++;let n=.01,o=n*(t-1),s=(this._myBackgroundSize*2-o)/(t*2),a=e;for(let l=0;l<t&&a>0;l++)for(let h=0;h<t&&a>0;h++){let _=this._myPlanes[a-1];_.pp_setScale(s);let y=[-this._myBackgroundSize+s+h*s*2+h*n,this._myBackgroundSize-s-l*s*2-l*n,0];_.pp_setPositionLocal(y),_.pp_setActive(!0),a--}}start(){if(this._myValid=!1,!r.isDebugEnabled(this.engine))return;this._myValid=!0,this._myPlaneMaterial==null&&(this._myPlaneMaterial=r.getDefaultMaterials(this.engine).myPhongOpaque.clone(),this._myPlaneMaterial.diffuseColor=w(.95,.95,.95,1),this._myPlaneMaterial.ambientColor=w(0,0,0,1),this._myPlaneMaterial.ambientFactor=.5),this._myBackgroundMaterial==null&&(this._myBackgroundMaterial=r.getDefaultMaterials(this.engine).myPhongOpaque.clone(),this._myBackgroundMaterial.diffuseColor=w(.25,.25,.25,1),this._myBackgroundMaterial.ambientColor=w(0,0,0,1),this._myBackgroundMaterial.ambientFactor=.5),this._myTextMaterial==null&&(this._myTextMaterial=r.getDefaultMaterials(this.engine).myText.clone()),this._myLagColor=w(.6,0,0,1),this._myNormalColor=w(.25,.25,.25,1),this._myRealTrianglesAmount=0;let e=this.object;this._myDisplayInFrontOfPlayer&&(e=r.getPlayerObjects().myHead.pp_addObject(),e.pp_rotateAxis(180,m(0,1,0)),e.pp_translateLocal(m(0,0,this._myDisplayInFrontOfPlayerDistance))),this._myTrianglesObject=e.pp_addObject(),this._myBackgroundObject=this._myTrianglesObject.pp_addObject();{let n=this._myBackgroundObject.pp_addComponent(jr);n.mesh=Xe.createPlane(this.engine),n.material=this._myBackgroundMaterial.clone()}this._myPlaneObject=this._myTrianglesObject.pp_addObject();{let n=this._myPlaneObject.pp_addComponent(jr);n.mesh=this._createPlaneMesh(this._myPlaneTriangles),this._myRealTrianglesAmount=n.mesh.indexData.length/3,n.material=this._myPlaneMaterial.clone()}let t=new Mi;this._myCloneMesh?this._myRealTrianglesAmount<=4?t.myInitialPoolSize=15e3:this._myRealTrianglesAmount<=8?t.myInitialPoolSize=1e4:this._myRealTrianglesAmount<=64?t.myInitialPoolSize=7500:t.myInitialPoolSize=5e3:t.myInitialPoolSize=3e4,t.myPercentageToAddWhenEmpty=0,t.myAmountToAddWhenEmpty=1e4,t.myCloneParams=new Zt,t.myCloneParams.myComponentDeepCloneParams.setDeepCloneComponentVariable(jr.TypeName,"material",this._myCloneMaterial),t.myCloneParams.myComponentDeepCloneParams.setDeepCloneComponentVariable(jr.TypeName,"mesh",this._myCloneMesh),this._myPlanePool=new Yn(this._myPlaneObject,t),this._myBackgroundObject.pp_setActive(!1),this._myPlaneObject.pp_setActive(!1),this._myStartTimer=new ie(2),this._mySessionStarted=!1,this._myTextsObject=this._myTrianglesObject.pp_addObject(),this._myTriangleTextObject=this._myTextsObject.pp_addObject(),this._myTriangleTextComponent=this._myTriangleTextObject.pp_addComponent(zr),this._myTriangleTextComponent.alignment=Fr.Left,this._myTriangleTextComponent.justification=wr.Line,this._myTriangleTextComponent.material=this._myTextMaterial.clone(),this._myTriangleTextComponent.material.color=this._myNormalColor,this._myTriangleTextComponent.text=" ",this._myPlaneTextObject=this._myTextsObject.pp_addObject(),this._myPlaneTextComponent=this._myPlaneTextObject.pp_addComponent(zr),this._myPlaneTextComponent.alignment=Fr.Left,this._myPlaneTextComponent.justification=wr.Line,this._myPlaneTextComponent.material=this._myTextMaterial.clone(),this._myPlaneTextComponent.material.color=this._myNormalColor,this._myPlaneTextComponent.text=" ",this._myFPSTextObject=this._myTextsObject.pp_addObject(),this._myFPSTextComponent=this._myFPSTextObject.pp_addComponent(zr),this._myFPSTextComponent.alignment=Fr.Left,this._myFPSTextComponent.justification=wr.Line,this._myFPSTextComponent.material=this._myTextMaterial.clone(),this._myFPSTextComponent.material.color=this._myNormalColor,this._myFPSTextComponent.text=" ",this._myDoneTextObject=this._myTrianglesObject.pp_addObject(),this._myDoneTextComponent=this._myDoneTextObject.pp_addComponent(zr),this._myDoneTextComponent.alignment=Fr.Center,this._myDoneTextComponent.justification=wr.Line,this._myDoneTextComponent.material=this._myTextMaterial.clone(),this._myDoneTextComponent.material.color=this._myNormalColor,this._myDoneTextComponent.text=" ",this._myTextsObject.pp_setPositionLocal(m(0,4.3,0)),this._myTextsObject.pp_setScale(2.75),this._myTriangleTextObject.pp_setPositionLocal(m(-1.4,0,0)),this._myPlaneTextObject.pp_setPositionLocal(m(.55,0,0)),this._myFPSTextObject.pp_setPositionLocal(m(-.315,0,0)),this._myDoneTextObject.pp_setPositionLocal(m(0,-4.6,0)),this._myDoneTextObject.pp_setScale(4),this._myDTHistory=[]}update(e){!this._myValid||(this._mySessionStarted||!this._myStartOnXRStart?this._myStartTimer.isRunning()?(this._myStartTimer.update(e),this._myDTHistory.push(e),this._myStartTimer.isDone()&&(this._myStableFrameRate=this._computeAverageFrameRate(!0),this._myTargetFrameRate>0&&(this._myStableFrameRate=this._myTargetFrameRate),this._myLogEnabled&&(console.log(`
Plane Triangles (Adjusted):`,this._myRealTrianglesAmount),console.log("Target Frame Rate:",this._myStableFrameRate,"- Threshold: ",this._myStableFrameRate-this._myTargetFrameRateThreshold),console.log("")),this._start())):this._update(e):this._mySessionStarted=B.getSession(this.engine)!=null)}_computeAverageFrameRate(e){let t=0;this._myDTHistory.sort();let n=Math.floor(this._myDTHistory.length)*Math.min(.9,this._myDTHistoryToIgnorePercentage*(e?2:1));for(let s=0;s<n;s++)this._myDTHistory.pop();let o=0;for(let s of this._myDTHistory)o+=s;return o/=this._myDTHistory.length,t=Math.round(1/o),this._myDTHistory=[],t}_createPlaneMesh(e){let t=Math.ceil(e/2),n=1,o=1,s=1;for(;s*s<t;)s++;for(n=s,o=s;n>1&&o>1&&n*o>t&&(n-1)*o>=t;)n--;let a=new Fo(this.engine);for(let h=0;h<n+1;h++)for(let _=0;_<o+1;_++){let y=2/o*_,c=2/n*h,d=new ko;d.myPosition=m(),d.myPosition[0]=y-1,d.myPosition[1]=c-1,d.myPosition[2]=0,d.myTextureCoordinates=De(),d.myTextureCoordinates[0]=y/2,d.myTextureCoordinates[1]=c/2,d.myNormal=m(),d.myNormal[0]=0,d.myNormal[1]=0,d.myNormal[2]=1,a.myVertexes.push(d)}for(let h=0;h<n;h++)for(let _=0;_<o;_++){let y=new Ni;y.myIndexes[0]=h*(o+1)+_,y.myIndexes[1]=h*(o+1)+_+1,y.myIndexes[2]=(h+1)*(o+1)+_;let c=new Ni;c.myIndexes[0]=(h+1)*(o+1)+_,c.myIndexes[1]=h*(o+1)+_+1,c.myIndexes[2]=(h+1)*(o+1)+_+1,a.myTriangles.push(y),a.myTriangles.push(c)}return Xe.create(a)}};R(hn,"TypeName","pp-benchmark-max-visible-triangles"),R(hn,"Properties",{_myTargetFrameRate:pt.int(-1),_myTargetFrameRateThreshold:pt.int(3),_myStartPlaneCount:pt.int(1),_myPlaneTriangles:pt.int(100),_mySecondsBeforeDoubling:pt.float(.5),_myDTHistoryToIgnorePercentage:pt.float(.25),_myCloneMaterial:pt.bool(!1),_myCloneMesh:pt.bool(!1),_myLogEnabled:pt.bool(!0),_myStartOnXRStart:pt.bool(!1),_myDisplayInFrontOfPlayer:pt.bool(!0),_myDisplayInFrontOfPlayerDistance:pt.float(10),_myPlaneMaterial:pt.material(),_myBackgroundMaterial:pt.material(),_myTextMaterial:pt.material(null)});import{Emitter as lo}from"@wonderlandengine/api";function FC(i,e){e!=null&&localStorage.setItem(i,e)}function uR(i){return Gt.loadString(i,null)!=null}function hR(i){return localStorage.removeItem(i)}function cR(){return localStorage.clear()}function wC(i,e=null){return Gt.loadString(i,e)}function jC(i,e=null){let t=localStorage.getItem(i);return t==null&&(t=e),t}function zC(i,e=null){let t=Gt.loadString(i);return t!=null?Number(t):e}function NC(i,e=null){let t=Gt.loadString(i);return t=="true"?!0:t=="false"?!1:e}var Gt={save:FC,has:uR,remove:hR,clear:cR,load:wC,loadString:jC,loadNumber:zC,loadBool:NC};var am=class{constructor(e=r.getMainEngine()){this._myEngine=e,this._mySaveCache=new Map,this._myCacheEnabled=!0,this._myCommitSavesDelayTimer=new ie(0,!1),this._myDelaySavesCommit=!0,this._myIDsToCommit=[],this._myCacheDefaultValueOnFail=!0,B.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this._myEngine),this._myClearEmitter=new lo,this._myDeleteEmitter=new lo,this._myDeleteIDEmitters=new Map,this._mySaveEmitter=new lo,this._mySaveValueChangedEmitter=new lo,this._mySaveIDEmitters=new Map,this._mySaveValueChangedIDEmitters=new Map,this._myCommitSaveEmitter=new lo,this._myCommitSaveIDEmitters=new Map,this._myCommitSavesEmitter=new lo,this._myLoadEmitter=new lo,this._myLoadIDEmitters=new Map,this._myVisibilityChangeEventListener=null,this._myDestroyed=!1}setCommitSavesDelay(e){this._myCommitSavesDelayTimer.start(e)}setDelaySavesCommit(e){this._myDelaySavesCommit=e}setCacheDefaultValueOnFail(e){this._myCacheDefaultValueOnFail=e}setCacheEnabled(e){this._myCacheEnabled=e}update(e){this._myCommitSavesDelayTimer.isRunning()&&(this._myCommitSavesDelayTimer.update(e),this._myCommitSavesDelayTimer.isDone()&&this.commitSaves())}save(e,t,n=null,o=null){let s=!1;if(this._mySaveCache.has(e)&&this._isCacheEnabled(o)&&(s=this._mySaveCache.get(e)===t),!s)if(this._mySaveCache.set(e,t),this._myDelaySavesCommit&&n==null||n!=null&&n)this._myIDsToCommit.pp_pushUnique(e),this._myCommitSavesDelayTimer.isRunning()||this._myCommitSavesDelayTimer.start();else{let a=this._commitSave(e,!1),l=!1;this._myCommitSavesEmitter.notify(l,a)}if(this._mySaveEmitter.notify(e,t),this._mySaveIDEmitters.size>0){let a=this._mySaveIDEmitters.get(e);a?.notify(e,t)}if(!s&&(this._mySaveValueChangedEmitter.notify(e,t),this._mySaveValueChangedIDEmitters.size>0)){let a=this._mySaveValueChangedIDEmitters.get(e);a?.notify(e,t)}}commitSaves(){if(this._myIDsToCommit.length>0){let e=!1;for(let n of this._myIDsToCommit)if(this._mySaveCache.has(n)){let o=this._commitSave(n,!0);e=e||o}this._myIDsToCommit=[];let t=!0;this._myCommitSavesEmitter.notify(t,e)}}has(e,t=null){return this._mySaveCache.has(e)&&this._isCacheEnabled(t)||Gt.has(e)}remove(e){if(this._mySaveCache.delete(e),Gt.remove(e),this._myDeleteEmitter.notify(e),this._myDeleteIDEmitters.size>0){let t=this._myDeleteIDEmitters.get(e);t?.notify(e)}}clear(){this._mySaveCache.clear(),Gt.clear(),this._myClearEmitter.notify()}load(e,t=null,n=null){return this._load(e,t,"load",n)}loadString(e,t=null,n=null){return this._load(e,t,"loadString",n)}loadNumber(e,t=null,n=null){return this._load(e,t,"loadNumber",n)}loadBool(e,t=null,n=null){return this._load(e,t,"loadBool",n)}getCommitSavesDelay(){return this._myCommitSavesDelayTimer.getDuration()}isDelaySavesCommit(){return this._myDelaySavesCommit}isCacheDefaultValueOnFail(){return this._myCacheDefaultValueOnFail}isCacheEnabled(){return this._myCacheEnabled}_commitSave(e,t){let n=this._mySaveCache.get(e),o=!1;try{Gt.save(e,n)}catch{o=!0}if(this._myCommitSaveEmitter.notify(e,n,t,o),this._myCommitSaveIDEmitters.size>0){let s=this._myCommitSaveIDEmitters.get(e);s?.notify(e,n,t,o)}return o}_load(e,t,n,o=null){let s=null,a=!1,l=!1;if(this._mySaveCache.has(e)&&this._isCacheEnabled(o))s=this._mySaveCache.get(e),s==null&&t!=null&&(s=t,this._myCacheDefaultValueOnFail&&this._mySaveCache.set(e,s)),l=!0;else{let h=null;try{h=Gt[n](e,null)}catch{h=null,a=!0}h==null?s=t:s=h,h!=null||this._myCacheDefaultValueOnFail?this._mySaveCache.set(e,s):this._mySaveCache.set(e,null)}if(this._myLoadEmitter.notify(e,s,l,a),this._myLoadIDEmitters.size>0){let h=this._myLoadIDEmitters.get(e);h?.notify(e,s,l,a)}return s}_onXRSessionStart(e){this._myVisibilityChangeEventListener=function(t){t.session.visibilityState!="visible"&&this._onXRSessionInterrupt()}.bind(this),e.addEventListener("visibilitychange",this._myVisibilityChangeEventListener)}_onXRSessionEnd(){this._myVisibilityChangeEventListener=null,this._onXRSessionInterrupt()}_onXRSessionInterrupt(){this.commitSaves()}registerClearEventListener(e,t){this._myClearEmitter.add(t,{id:e})}unregisterClearEventListener(e){this._myClearEmitter.remove(e)}registerDeleteEventListener(e,t){this._myDeleteEmitter.add(t,{id:e})}unregisterDeleteEventListener(e){this._myDeleteEmitter.remove(e)}registerDeleteIDEventListener(e,t,n){let o=this._myDeleteIDEmitters.get(e);o==null&&(this._myDeleteIDEmitters.set(e,new Map),o=this._myDeleteIDEmitters.get(e)),o.add(n,{id:t})}unregisterDeleteIDEventListener(e,t){let n=this._myDeleteIDEmitters.get(e);n!=null&&(n.remove(t),n.size<=0&&this._myDeleteIDEmitters.delete(e))}registerSaveEventListener(e,t){this._mySaveEmitter.add(t,{id:e})}unregisterSaveEventListener(e){this._mySaveEmitter.remove(e)}registerSaveIDEventListener(e,t,n){let o=this._mySaveIDEmitters.get(e);o==null&&(this._mySaveIDEmitters.set(e,new Map),o=this._mySaveIDEmitters.get(e)),o.add(n,{id:t})}unregisterSaveIDEventListener(e,t){let n=this._mySaveIDEmitters.get(e);n!=null&&(n.remove(t),n.size<=0&&this._mySaveIDEmitters.delete(e))}registerSaveValueChangedEventListener(e,t){this._mySaveValueChangedEmitter.add(t,{id:e})}unregisterSaveValueChangedEventListener(e){this._mySaveValueChangedEmitter.remove(e)}registerSaveValueChangedIDEventListener(e,t,n){let o=this._mySaveValueChangedIDEmitters.get(e);o==null&&(this._mySaveValueChangedIDEmitters.set(e,new Map),o=this._mySaveValueChangedIDEmitters.get(e)),o.add(n,{id:t})}unregisterSaveValueChangedIDEventListener(e,t){let n=this._mySaveValueChangedIDEmitters.get(e);n!=null&&(n.remove(t),n.size<=0&&this._mySaveValueChangedIDEmitters.delete(e))}registerCommitSavesEventListener(e,t){this._myCommitSavesEmitter.add(t,{id:e})}unregisterCommitSavesEventListener(e){this._myCommitSavesEmitter.remove(e)}registerCommitSaveEventListener(e,t){this._myCommitSaveEmitter.add(t,{id:e})}unregisterCommitSaveEventListener(e){this._myCommitSaveEmitter.remove(e)}registerCommitSaveIDEventListener(e,t,n){let o=this._myCommitSaveIDEmitters.get(e);o==null&&(this._myCommitSaveIDEmitters.set(e,new Map),o=this._myCommitSaveIDEmitters.get(e)),o.add(n,{id:t})}unregisterCommitSaveIDEventListener(e,t){let n=this._myCommitSaveIDEmitters.get(e);n!=null&&(n.remove(t),n.size<=0&&this._myCommitSaveIDEmitters.delete(e))}registerLoadEventListener(e,t){this._myLoadEmitter.add(t,{id:e})}unregisterLoadEventListener(e){this._myLoadEmitter.remove(e)}registerLoadIDEventListener(e,t,n){let o=this._myLoadIDEmitters.get(e);o==null&&(this._myLoadIDEmitters.set(e,new Map),o=this._myLoadIDEmitters.get(e)),o.add(n,{id:t})}unregisterLoadIDEventListener(e,t){let n=this._myLoadIDEmitters.get(e);n!=null&&(n.remove(t),n.size<=0&&this._myLoadIDEmitters.delete(e))}_isCacheEnabled(e=null){return this._myCacheEnabled&&e==null||e!=null&&e}destroy(){this._myDestroyed=!0,B.getSession(this._myEngine)?.removeEventListener("visibilitychange",this._myVisibilityChangeEventListener),B.unregisterSessionStartEndEventListeners(this,this._myEngine)}isDestroyed(){return this._myDestroyed}};import{Component as pR,Property as dR}from"@wonderlandengine/api";var cn=class extends pR{start(){this._myFirstTime=!0,B.registerSessionStartEventListener(this,this._onXRSessionStart.bind(this),this.engine)}_onXRSessionStart(){(!this._myFirstTimeOnly||this._myFirstTime)&&(this._myFirstTime=!1,console.clear())}onDestroy(){B.unregisterSessionStartEventListener(this,this.engine)}};R(cn,"TypeName","pp-clear-console-on-xr-session-start"),R(cn,"Properties",{_myFirstTimeOnly:dR.bool(!0)});import{Component as _R,Property as rm}from"@wonderlandengine/api";var pn=class extends _R{init(){this.active&&this._mySetActiveWhen==0&&this._setActive()}start(){this._mySetActiveWhen==1&&this._setActive(),this._myFirstUpdate=!0,this._myFirstXRStart=!0,this._myFirstXREnd=!0,(this._mySetActiveWhen==3||this._mySetActiveWhen==5)&&B.registerSessionStartEventListener(this,this._onXRSessionStart.bind(this),!0,!0,this.engine),(this._mySetActiveWhen==4||this._mySetActiveWhen==6)&&B.registerSessionEndEventListener(this,this._onXRSessionEnd.bind(this),this.engine)}update(e){this._mySetActiveWhen==2&&this._myFirstUpdate&&this._setActive(),this._myFirstUpdate=!1}_onXRSessionStart(){(this._mySetActiveWhen==3||this._mySetActiveWhen==5&&this._myFirstXRStart)&&this._setActive(),this._myFirstXRStart=!1}_onXRSessionEnd(){(this._mySetActiveWhen==4||this._mySetActiveWhen==6&&this._myFirstXREnd)&&this._setActive(),this._myFirstXREnd=!1}_setActive(){this._mySetActiveOn==0?this.object.pp_setActiveSelf(this._myActive):this._mySetActiveOn==1?this.object.pp_setActiveChildren(this._myActive):this._mySetActiveOn==2?this.object.pp_setActiveDescendants(this._myActive):this.object.pp_setActive(this._myActive)}onDestroy(){B.unregisterSessionStartEndEventListeners(this,this.engine)}};R(pn,"TypeName","pp-set-active"),R(pn,"Properties",{_myActive:rm.bool(!0),_mySetActiveOn:rm.enum(["Self","Children","Descendants","Hierarchy"],"Hierarchy"),_mySetActiveWhen:rm.enum(["Init","Start","First Update","Enter XR","Exit XR","First Enter XR","First Exit XR"],"Init")});import{Component as gR,PhysXComponent as fR,Property as PR}from"@wonderlandengine/api";var dn=class extends gR{init(){this.active&&this._myWhen==0&&this._adjustScale()}start(){this._myWhen==1&&this._adjustScale(),this._myFirst=!0}update(e){this._myWhen==2&&this._myFirst&&(this._myFirst=!1,this._adjustScale())}_adjustScale(){let e=this.object.pp_getScale(),t=this.object.pp_getComponents(fR);for(let n of t)n.extents[0]=n.extents[0]*e[0],n.extents[1]=n.extents[1]*e[1],n.extents[2]=n.extents[2]*e[2],n.active&&(n.active=!1,n.active=!0)}};R(dn,"TypeName","pp-adjust-hierarchy-physx-scale"),R(dn,"Properties",{_myWhen:PR.enum(["Init","Start","First Update"],"Start")});import{Component as CR,Property as GC}from"@wonderlandengine/api";var Ui=class extends CR{start(){this._myTimer=new ie(this._myRefreshSeconds),this._myTotalDT=0,this._myFrames=0,this._myVisualFPSParent=this.object.pp_addObject();let e=new Vt(this.engine);e.myText="00",e.myTransform.mat4_setPositionRotationScale(m(-.115,-.115,.35),m(0,180,0),m(.3,.3,.3)),this._myTextMaterial!=null?e.myMaterial=this._myTextMaterial.clone():(e.myMaterial=r.getDefaultMaterials(this.engine).myText.clone(),e.myMaterial.color=w(1,1,1,1)),e.myParent=this._myVisualFPSParent,e.myLocal=!0,this._myVisualFPS=new Di(e)}update(e){}onDestroy(){this._myVisualFPS.destroy()}};R(Ui,"TypeName","pp-show-fps"),R(Ui,"Properties",{_myRefreshSeconds:GC.float(.25),_myTextMaterial:GC.material()});Ui.prototype.update=function(){let i=j();return function(t){if(this._myTotalDT+=t,this._myFrames++,this._myTimer.update(t),this._myTimer.isDone()){this._myTimer.start();let n=Math.round(this._myFrames/this._myTotalDT),o=this._myVisualFPS.getParams();B.isSessionActive(this.engine)?o.myTransform.mat4_setPositionRotationScale(m(-.115,-.115,.35),m(0,180,0),m(.3,.3,.3)):o.myTransform.mat4_setPositionRotationScale(m(-.25,-.13,.35),m(0,180,0),m(.3,.3,.3)),o.myText=n.toFixed(0),this._myVisualFPS.paramsUpdated(),this._myTotalDT=0,this._myFrames=0}this._myVisualFPSParent.pp_setTransformQuat(r.getPlayerObjects(this.engine).myHead.pp_getTransformQuat(i))}}();import{Emitter as Nr}from"@wonderlandengine/api";var Ko=class{constructor(e,t){this.myID=e,this.myObject=t}},Jo=class{constructor(e,t,n,o,s){this.myID=e,this.myFromState=t,this.myToState=n,this.myObject=o,this.mySkipStateFunction=s}},Vi={IMMEDIATE:0,DELAYED:1},js={QUEUE:0,KEEP_FIRST:1,KEEP_LAST:2},Xo={NONE:0,END:1,START:2,BOTH:3},ze=class{constructor(e=Vi.IMMEDIATE,t=js.QUEUE){this._myCurrentStateData=null,this._myStates=new Map,this._myTransitions=new Map,this._myLogEnabled=!1,this._myLogShowDelayedInfo=!1,this._myLogFSMName="FSM",this._myPerformMode=e,this._myPerformDelayedMode=t,this._myPendingPerforms=[],this._myCurrentlyPerformedTransition=null,this._myInitEmitter=new Nr,this._myInitIDEmitters=new Map,this._myTransitionEmitter=new Nr,this._myTransitionIDEmitters=[]}addState(e,t=null){let n=null;!t||typeof t=="function"?(n={},typeof t=="function"?n.update=function(){return t(...arguments)}:n.update=null,n.clone=function(){let a={};return a.update=this.update,a.clone=this.clone,a}):n=t;let o=new Ko(e,n);this._myStates.set(e,o),this._myTransitions.set(e,new Map)}addTransition(e,t,n,o=null,s=Xo.NONE){let a=null;if(!o||typeof o=="function"?(a={},typeof o=="function"?a.perform=function(){return o(...arguments)}:a.perform=null,a.clone=function(){let h={};return h.perform=this.perform,h.clone=this.clone,h}):a=o,this.hasState(e)&&this.hasState(t)){let l=this._getTransitionsFromState(e),h=new Jo(n,this.getState(e),this.getState(t),a,s);l.set(n,h)}else!this.hasState(e)&&!this.hasState(t)?console.error("Can't add transition:",n,"- from state not found:",e,"- to state not found:",t):this.hasState(e)?this.hasState(t)||console.error("Can't add transition:",n,"- to state not found:",t):console.error("Can't add transition:",n,"- from state not found:",e)}init(e,t=null,...n){let o=t;if(t&&typeof t=="function"&&(o={},o.performInit=t),this.hasState(e)){let s=this._myStates.get(e);if(this._myLogEnabled&&console.log(this._myLogFSMName,"- Init:",e),o&&o.performInit?o.performInit(this,s,...n):s.myObject&&s.myObject.init&&s.myObject.init(this,s,...n),this._myCurrentStateData=s,this._myInitEmitter.notify(this,s,o,...n),this._myInitIDEmitters.size>0){let a=this._myInitIDEmitters.get(e);a?.notify(this,s,o,...n)}}else this._myLogEnabled&&console.warn(this._myLogFSMName,"- Init state not found:",e)}update(e,...t){if(this._myPendingPerforms.length>0){for(let n=0;n<this._myPendingPerforms.length;n++)this._perform(this._myPendingPerforms[n].myID,Vi.DELAYED,...this._myPendingPerforms[n].myArgs);this._myPendingPerforms=[]}this._myCurrentStateData&&this._myCurrentStateData.myObject&&this._myCurrentStateData.myObject.update&&this._myCurrentStateData.myObject.update(e,this,...t)}perform(e,...t){this._myPerformMode==Vi.DELAYED?this.performDelayed(e,...t):this.performImmediate(e,...t)}performDelayed(e,...t){let n=!1;switch(this._myPerformDelayedMode){case js.QUEUE:this._myPendingPerforms.push(new zs(e,...t)),n=!0;break;case js.KEEP_FIRST:this.hasPendingPerforms()||(this._myPendingPerforms.push(new zs(e,...t)),n=!0);break;case js.KEEP_LAST:this.resetPendingPerforms(),this._myPendingPerforms.push(new zs(e,...t)),n=!0;break}return n}performImmediate(e,...t){return this._perform(e,Vi.IMMEDIATE,...t)}canPerform(e){return this.hasTransitionFromState(this._myCurrentStateData.myID,e)}canGoTo(e,t=null){return this.hasTransitionFromStateToState(this._myCurrentStateData.myID,e,t)}isInState(e){return this._myCurrentStateData!=null&&this._myCurrentStateData.myID==e}isPerformingTransition(){return this._myCurrentlyPerformedTransition!=null}getCurrentlyPerformedTransition(){return this._myCurrentlyPerformedTransition}hasBeenInit(){return this._myCurrentStateData!=null}reset(){this.resetState(),this.resetPendingPerforms()}resetState(){this._myCurrentStateData=null}resetPendingPerforms(){this._myPendingPerforms=[]}getCurrentState(){return this._myCurrentStateData}getCurrentTransitions(){return this.getTransitionsFromState(this._myCurrentStateData.myID)}getCurrentTransitionsToState(e){return this.getTransitionsFromStateToState(this._myCurrentStateData.myID,e)}getState(e){return this._myStates.get(e)}getStates(){return this._myStates.values()}getTransitions(){let e=[];for(let t of this._myTransitions.values())for(let n of t.values())e.push(n);return e}getTransitionsFromState(e){let t=this._getTransitionsFromState(e);return Array.from(t.values())}getTransitionsFromStateToState(e,t){let n=this._getTransitionsFromState(e),o=[];for(let s of n.values())s.myToState.myID==t&&o.push(s);return o}removeState(e){if(this.hasState(e)){this._myStates.delete(e),this._myTransitions.delete(e);for(let t of this._myTransitions.values()){let n=[];for(let[o,s]of t.entries())s.myToState.myID==e&&n.push(o);for(let o of n)t.delete(o)}return!0}return!1}removeTransitionFromState(e,t){let n=this._getTransitionsFromState(e);return n?n.delete(t):!1}hasState(e){return this._myStates.has(e)}hasTransitionFromState(e,t){return this.getTransitionsFromState(e).findIndex(function(s){return s.myID==t})>=0}hasTransitionFromStateToState(e,t,n=null){let o=this.getTransitionsFromStateToState(e,t),s=!1;return n?s=o.findIndex(function(l){return l.myID==n})>=0:s=o.length>0,s}setPerformMode(e){this._myPerformMode=e}getPerformMode(){return this._myPerformMode}setPerformDelayedMode(e){this._myPerformDelayedMode=e}getPerformDelayedMode(){return this._myPerformDelayedMode}hasPendingPerforms(){return this._myPendingPerforms.length>0}getPendingPerforms(){return this._myPendingPerforms.pp_clone()}clone(e=!1){if(!this.isCloneable(e))return null;let t=new ze;t._myLogEnabled=this._myLogEnabled,t._myLogShowDelayedInfo=this._myLogShowDelayedInfo,t._myLogFSMName=this._myLogFSMName.slice(0),t._myPerformMode=this._myPerformMode,t._myPerformDelayedMode=this._myPerformDelayedMode,t._myPendingPerforms=this._myPendingPerforms.pp_clone();for(let n of this._myStates.entries()){let o=null;e?o=new Ko(n[1].myID,n[1].myObject.clone()):o=new Ko(n[1].myID,n[1].myObject),t._myStates.set(o.myID,o)}for(let n of this._myTransitions.entries()){let o=new Map;t._myTransitions.set(n[0],o);for(let s of n[1].entries()){let a=null,l=t.getState(s[1].myFromState.myID),h=t.getState(s[1].myToState.myID);e?a=new Jo(s[1].myID,l,h,s[1].myObject.clone(),s[1].mySkipStateFunction):a=new Jo(s[1].myID,l,h,s[1].myObject,s[1].mySkipStateFunction),o.set(a.myID,a)}}return this._myCurrentStateData&&(t._myCurrentStateData=t.getState(this._myCurrentStateData.myID)),t}isCloneable(e=!1){if(!e)return!0;let t=!0;for(let n of this._myStates.entries())t=t&&n[1].myObject.clone!=null;for(let n of this._myTransitions.entries())for(let o of n[1].entries())t=t&&o[1].myObject.clone!=null;return t}setLogEnabled(e,t=null,n=!1){this._myLogEnabled=e,this._myLogShowDelayedInfo=n,t&&(this._myLogFSMName="FSM: ".concat(t))}registerInitEventListener(e,t){this._myInitEmitter.add(t,{id:e})}unregisterInitEventListener(e){this._myInitEmitter.remove(e)}registerInitIDEventListener(e,t,n){let o=this._myInitIDEmitters.get(e);o==null&&(this._myInitIDEmitters.set(e,new Nr),o=this._myInitIDEmitters.get(e)),o.add(n,{id:t})}unregisterInitIDEventListener(e,t){let n=this._myInitIDEmitters.get(e);n!=null&&(n.remove(t),n.pp_isEmpty()&&this._myInitIDEmitters.delete(e))}registerTransitionEventListener(e,t){this._myTransitionEmitter.add(t,{id:e})}unregisterTransitionEventListener(e){this._myTransitionEmitter.remove(e)}registerTransitionIDEventListener(e,t,n,o,s){let a=null;for(let l of this._myTransitionIDEmitters)if(l[0]==e&&l[1]==t&&l[2]==n){a=l[3];break}if(a==null){let l=[];l[0]=e,l[1]=t,l[2]=n,l[3]=new Nr,a=l[3],this._myTransitionIDEmitters.push(l)}a.add(s,{id:o})}unregisterTransitionIDEventListener(e,t,n,o){let s=null;for(let a of this._myTransitionIDEmitters)if(a[0]==e&&a[1]==t&&a[2]==n){s=a[3];break}s!=null&&(s.remove(o),s.pp_isEmpty()&&this._myTransitionIDEmitters.pp_remove(a=>a[0]==e&&a[1]==t&&a[2]==n))}_perform(e,t,...n){if(this.isPerformingTransition()){let o=this.getCurrentlyPerformedTransition(),s=[this._myLogFSMName,"- Trying to perform:",e];return this._myLogShowDelayedInfo&&s.push(t==Vi.DELAYED?"- Delayed":"- Immediate"),s.push("- But another transition is currently being performed -",o.myID),console.warn(...s),!1}if(this._myCurrentStateData){if(this.canPerform(e)){let s=this._myTransitions.get(this._myCurrentStateData.myID).get(e);this._myCurrentlyPerformedTransition=s;let a=this._myCurrentStateData,l=this._myStates.get(s.myToState.myID);if(this._myLogEnabled){let h=[this._myLogFSMName,"- From:",a.myID,"- To:",l.myID,"- With:",e];this._myLogShowDelayedInfo&&h.push(t==Vi.DELAYED?"- Delayed":"- Immediate"),console.log(...h)}if(s.mySkipStateFunction!=Xo.END&&s.mySkipStateFunction!=Xo.BOTH&&a.myObject&&a.myObject.end&&a.myObject.end(this,s,...n),s.myObject&&s.myObject.perform&&s.myObject.perform(this,s,...n),s.mySkipStateFunction!=Xo.START&&s.mySkipStateFunction!=Xo.BOTH&&l.myObject&&l.myObject.start&&l.myObject.start(this,s,...n),this._myCurrentStateData=s.myToState,this._myTransitionEmitter.notify(this,a,l,s,t,...n),this._myTransitionIDEmitters.length>0){let h=[];for(let _ of this._myTransitionIDEmitters)(_[0]==null||_[0]==a.myID)&&(_[1]==null||_[1]==l.myID)&&(_[2]==null||_[2]==s.myID)&&h.push(_[3]);for(let _ of h)_.notify(this,a,l,s,t,...n)}return this._myCurrentlyPerformedTransition=null,!0}else if(this._myLogEnabled){let o=[this._myLogFSMName,"- No Transition:",e,"- From:",this._myCurrentStateData.myID];this._myLogShowDelayedInfo&&o.push(t==Vi.DELAYED?"- Delayed":"- Immediate"),console.warn(...o)}}else if(this._myLogEnabled){let o=[this._myLogFSMName,"- FSM not initialized yet"];this._myLogShowDelayedInfo&&o.push(t==Vi.DELAYED?"- Delayed":"- Immediate"),console.warn(...o)}return!1}_getTransitionsFromState(e){return this._myTransitions.get(e)}},zs=class{constructor(e,...t){this.myID=e,this.myArgs=t}};var mo=class{update(e,t,...n){}init(e,t,...n){}start(e,t,...n){}end(e,t,...n){}};var lm=class{performInit(e,t,...n){}perform(e,t,...n){}};var Ns=class extends mo{constructor(e=0,t=null,...n){super(),this._myTransitionToPerformOnEnd=t,this._myTransitionArgs=n,this._myTimer=new ie(e,!1)}setDuration(e){this._myTimer.setDuration(e)}setTransitionToPerformOnEnd(e,...t){this._myTransitionToPerformOnEnd=e,this._myTransitionArgs=t}onEnd(e,t=null){this._myTimer.onEnd(e,t)}unregisterOnEnd(e=null){this._myTimer.unregisterOnEnd(e)}update(e,t){this._myTimer.update(e),this._myTimer.isDone()&&this._myTransitionToPerformOnEnd!=null&&t.perform(this._myTransitionToPerformOnEnd,...this._myTransitionArgs)}start(e,t,n=null,o=null,...s){this._myTimer.start(n),o!=null&&(this._myTransitionToPerformOnEnd=o,this._myTransitionArgs=s)}init(e,t,n=null,o=null,...s){this._myTimer.start(n),o!=null&&(this._myTransitionToPerformOnEnd=o,this._myTransitionArgs=s)}};function UC(i){let e=i.pp_clone(),t=i[0],n=i[1],o=i[2],s=Math.max(t,n,o),a=Math.min(t,n,o),l=s-a,h,_=s===0?0:l/s,y=s;switch(s){case a:h=0;break;case t:h=n-o+l*(n<o?6:0),h/=6*l;break;case n:h=o-t+l*2,h/=6*l;break;case o:h=t-n+l*4,h/=6*l;break}return e[0]=h,e[1]=_,e[2]=y,e}function WC(i){let e=i.pp_clone(),t=i[0],n=i[1],o=i[2],s,a,l,h,_,y,c,d;switch(h=Math.floor(t*6),_=t*6-h,y=o*(1-n),c=o*(1-_*n),d=o*(1-(1-_)*n),h%6){case 0:s=o,a=d,l=y;break;case 1:s=c,a=o,l=y;break;case 2:s=y,a=o,l=d;break;case 3:s=y,a=c,l=o;break;case 4:s=d,a=y,l=o;break;case 5:s=o,a=y,l=c;break}return e[0]=s,e[1]=a,e[2]=l,e}function QC(i){return he.color1To255(i)}function qC(i){return he.color255To1(i)}function XC(i){return he.color1To255(i)}function KC(i){return he.color255To1(i)}function JC(i){let e=i.pp_clone();for(let t=0;t<e.length;t++)e[t]/=255,e[t]=Math.pp_clamp(e[t],0,1);return e}function ZC(i){let e=i.pp_clone();for(let t=0;t<e.length;t++)e[t]=Math.round(e[t]*255),e[t]=Math.pp_clamp(e[t],0,255);return e}var he={rgbToHSV:UC,hsvToRGB:WC,rgbCodeToHuman:QC,rgbHumanToCode:qC,hsvCodeToHuman:XC,hsvHumanToCode:KC,color255To1:JC,color1To255:ZC};import{MeshComponent as Gs}from"@wonderlandengine/api";var YC=function(){let i=w();return function(t,n){t.color!=null&&(i.vec4_copy(t.color),i[3]=n,t.color=i),t.diffuseColor!=null&&(i.vec4_copy(t.diffuseColor),i[3]=n,t.diffuseColor=i),t.ambientColor!=null&&(i.vec4_copy(t.ambientColor),i[3]=n,t.ambientColor=i)}}();function $C(i,e){let t=i.pp_getComponents(Gs);for(let n of t)n.material!=null&&Us.setAlpha(n.material,e)}function eT(i,e,t=!1){let n=i.pp_getComponents(Gs);for(let o of n)t?o.material=e.clone():o.material=e}function tT(i){let e=i.pp_getComponents(Gs);for(let t of e)t.material=t.material.clone()}function iT(i,e){let t=i.pp_getComponents(Gs);for(let n of t)n.material.specularColor!=null&&(n.material.specularColor=e)}function nT(i,e){let t=i.pp_getComponents(Gs);for(let n of t)n.material.fogColor!=null&&(n.material.fogColor=e)}var Us={setAlpha:YC,setObjectAlpha:$C,setObjectMaterial:eT,setObjectClonedMaterials:tT,setObjectSpecularColor:iT,setObjectFogColor:nT};import{TextComponent as TR}from"@wonderlandengine/api";function oT(i){let e=i.pp_getComponents(TR);for(let t of e)t.material=t.material.clone()}var bR={setClonedMaterials:oT};function sT(i=r.getMainEngine()){return/Mobi/i.test(r.getNavigator(i).userAgent)}function aT(i=r.getMainEngine()){return!Zo.isMobile(i)}var Zo={isMobile:sT,isDesktop:aT};import{Component as SR,Property as rT}from"@wonderlandengine/api";var _n=class extends SR{start(){this._myDebugVisualTransform=null,this._myDebugTransformParams=new Ot(this.engine),this._myDebugTransformParams.myLength=this._myLength,this._myDebugTransformParams.myThickness=this._myThickness,this._myDebugVisualTransform=new si(this._myDebugTransformParams),this._myDebugVisualTransform.setVisible(r.isDebugEnabled(this.engine))}update(e){this._myDebugVisualTransform!=null&&(r.isDebugEnabled(this.engine)?(this.object.pp_getTransform(this._myDebugTransformParams.myTransform),this._myDebugVisualTransform.paramsUpdated(),this._myDebugVisualTransform.setVisible(!0)):this._myDebugVisualTransform.setVisible(!1))}onDestroy(){this._myDebugVisualTransform.destroy()}};R(_n,"TypeName","pp-debug-transform"),R(_n,"Properties",{_myLength:rT.float(.1),_myThickness:rT.float(.005)});var Yo=class{constructor(e=r.getMainEngine()){this.myObjectsByReference=[],this.myObjectsByPath=[],this.myClassesByReference=[],this.myClassesByPath=[],this.myFunctionsByPath=[],this.myExcludeConstructors=!1,this.myExcludeJSObjectFunctions=!1,this.myFunctionNamesToInclude=[],this.myFunctionNamesToExclude=[],this.myFunctionPathsToInclude=[],this.myFunctionPathsToExclude=[],this.myObjectAddObjectDescendantsDepthLevel=0,this.myObjectAddClassDescendantsDepthLevel=0,this.myObjectNamesToInclude=[],this.myObjectNamesToExclude=[],this.myClassNamesToInclude=[],this.myClassNamesToExclude=[],this.myObjectPathsToInclude=[],this.myObjectPathsToExclude=[],this.myClassPathsToInclude=[],this.myClassPathsToExclude=[],this.myLogEnabled=!1,this.myEngine=e}},$o=class{constructor(e=new Yo){this._myParams=e,this._myPropertiesAlreadyOverwritten=new Map}overwriteFunctions(){let e=this._getReferencesAndParents(this._myParams.myClassesByReference,this._myParams.myClassesByPath,!0),t=this._getReferencesAndParents(this._myParams.myObjectsByReference,this._myParams.myObjectsByPath,!1),n=this._getReferencesAndParents([],this._myParams.myFunctionsByPath,!1);this._objectAddDescendants(t,e);for(let o of e){let s=o[0],a=o[1],l=o[2],h=o[3],_=o[4];this._overwriteReferenceFunctions(s,a,l,h,_,!0)}for(let o of t){let s=o[0],a=o[1],l=o[2],h=o[3],_=o[4];this._overwriteReferenceFunctions(s,a,l,h,_,!1)}for(let o of n){let s=o[1],a=o[2],l=o[3];this._overwriteFunction(s,a,null,null,l,!1,!0)}}_getOverwrittenFunction(e,t,n,o,s){return $.getObjectProperty(e,t)}_getOverwrittenConstructor(e,t,n,o,s){return $.getObjectProperty(e,t)}_onOverwriteSuccess(e,t,n,o,s,a,l,h){}_onOverwriteFailure(e,t,n,o,s,a,l,h){}_overwriteReferenceFunctions(e,t,n,o,s,a){let l=this._myParams.myObjectPathsToInclude,h=this._myParams.myObjectPathsToExclude,_=this._myParams.myObjectNamesToInclude,y=this._myParams.myObjectNamesToExclude;a&&(l=this._myParams.myClassPathsToInclude,h=this._myParams.myClassPathsToExclude,_=this._myParams.myClassNamesToInclude,y=this._myParams.myClassNamesToExclude);let c=this._filterName(o,l,h),d=this._filterName(s,_,y);if(c&&d){let g=$.getObjectPropertyNames(e);g.pp_hasEqual("constructor")&&g.unshift("constructor");for(let P of g){let T=null,C=null,x=null;if(a){let D=e;if(t!=null){let E=Object.getOwnPropertyDescriptor(t,n);E!=null&&E.value!=null&&(D=E.value)}if(T=D.prototype,T==null)T=D;else try{$.getObjectProperty(T,P)==null&&(T=D)}catch{T=D}C=t,x=n}else T=e;this._overwriteFunction(T,P,C,x,o,a,!1)}}}_overwriteFunction(e,t,n,o,s,a,l){try{if(!(this._myPropertiesAlreadyOverwritten.get(t)!=null&&this._myPropertiesAlreadyOverwritten.get(t).pp_hasEqual(e))&&$.isFunctionByName(e,t)&&(!this._myParams.myExcludeJSObjectFunctions||!this._isJSObjectFunction(t))){let _=this._filterName(t,this._myParams.myFunctionNamesToInclude,this._myParams.myFunctionNamesToExclude),y=this._filterName((s!=null?s+".":"")+t,this._myParams.myFunctionPathsToInclude,this._myParams.myFunctionPathsToExclude);if(_&&y){this._myPropertiesAlreadyOverwritten.has(t)||this._myPropertiesAlreadyOverwritten.set(t,[]);let c=!1,d=!1;if(t!="constructor")try{let g=this._getOverwrittenFunction(e,t,s,a,l);g!=$.getObjectProperty(e,t)?c=$.overwriteObjectProperty(g,e,t,!1,!0,this._myParams.myLogEnabled):c=!0}catch(g){c=!1,this._myParams.myLogEnabled&&console.error(g)}else if(!this._myParams.myExcludeConstructors&&a&&n!=null){let g=$.getObjectProperty(n,o);if(g!=null&&g.prototype!=null){d=!0;try{let P=this._getOverwrittenConstructor(n,o,s,a,l);P!=g?(c=$.overwriteObjectProperty(P,n,o,!1,!0,this._myParams.myLogEnabled),c&&(c=$.overwriteObjectProperty(P,g.prototype,t,!1,!0,this._myParams.myLogEnabled))):c=!0}catch(P){c=!1,this._myParams.myLogEnabled&&console.error(P)}}}c?(this._myPropertiesAlreadyOverwritten.get(t).push(e),this._onOverwriteSuccess(e,t,n,o,s,a,l,d)):this._onOverwriteFailure(e,t,n,o,s,a,l,d)}}}catch(h){this._myParams.myLogEnabled&&console.error(h)}}_getReferencesAndParents(e,t,n){let o=[],s=(a,l)=>a[0]==l[0];for(let a of t){let l=a,h="",_=a,y="";a!=null&&Array.isArray(a)&&a.length!=null&&a.length==2&&typeof a[1]=="string"&&(l=a[0],_=a[1]),h=$.getObjectNameFromPath(l),y=$.getObjectNameFromPath(_);let c=$.getObjectFromPath(l,r.getWindow(this._myParams.myEngine)),d=$.getObjectParentFromPath(l,r.getWindow(this._myParams.myEngine));c!=null&&o.pp_pushUnique([c,d,h,_,y],s)}for(let a of e){let l=a,h="",_="",y="";a!=null&&a.length!=null&&a.length==2&&typeof a[1]=="string"?(l=a[0],_=a[1],y=$.getObjectNameFromPath(_)):(_=n?l.name:null,y=n?l.name:null),n?h=l.name:h=$.getObjectNameFromPath(_),l!=null&&o.pp_pushUnique([l,null,h,_,y],s)}return o}_objectAddDescendants(e,t){let n=(s,a)=>s[0]==a[0],o=[];for(let s of e)o.pp_pushUnique([s[0],0,s[3]],n);for(;o.length>0;){let s=o.shift(),a=s[0],l=s[1],h=s[2];if(l+1<=this._myParams.myObjectAddObjectDescendantsDepthLevel||this._myParams.myObjectAddObjectDescendantsDepthLevel==-1||l+1<=this._myParams.myObjectAddClassDescendantsDepthLevel||this._myParams.myObjectAddClassDescendantsDepthLevel==-1){let _=null;try{_=$.getObjectPropertyNames(a)}catch{continue}for(let y of _){let c=null;try{if(c=$.getObjectProperty(a,y),c==null)continue}catch{continue}let d="",g="";h!=null?(g=y,d=h+"."+g):(g=y,d=g);let P=$.isClassByName(a,y),T=$.isObjectByName(a,y),C=this._myParams.myObjectPathsToInclude,x=this._myParams.myObjectPathsToExclude,D=this._myParams.myObjectNamesToInclude,E=this._myParams.myObjectNamesToExclude;P&&(C=this._myParams.myClassPathsToInclude,x=this._myParams.myClassPathsToExclude,D=this._myParams.myClassNamesToInclude,E=this._myParams.myClassNamesToExclude);let S=this._filterName(d,C,x),b=this._filterName(y,D,E);S&&b&&(T&&(l+1<=this._myParams.myObjectAddObjectDescendantsDepthLevel||this._myParams.myObjectAddObjectDescendantsDepthLevel==-1)&&e.pp_pushUnique([c,a,y,d,g],n),P&&(l+1<=this._myParams.myObjectAddClassDescendantsDepthLevel||this._myParams.myObjectAddClassDescendantsDepthLevel==-1)&&t.pp_pushUnique([c,a,y,d,g],n),T&&o.pp_pushUnique([c,l+1,d],n))}}}}_filterName(e,t,n){let o=t.length==0;for(let s of t)if(e.match(new RegExp(s))!=null){o=!0;break}if(o){for(let s of n)if(e.match(new RegExp(s))!=null){o=!1;break}}return o}_isJSObjectFunction(e){}};$o.prototype._isJSObjectFunction=function(){let i=["__defineGetter__","__defineSetter__","hasOwnProperty","__lookupGetter__","__lookupSetter__","isPrototypeOf","propertyIsEnumerable","toString","valueOf","__proto__","toLocaleString","arguments","caller","apply","bind","call","callee"];return function(t){return i.pp_hasEqual(t)}}();var ts=class extends Yo{constructor(){super(),this.myExecutionTimeAnalysisEnabled=!0,this.myAddPathPrefixToFunctionID=!0,this.myFilterDebugFunctionsPerformanceAnalyzerClasses=!0}},es=class{constructor(){this.myReference=null,this.myName="",this.myPath="",this.myID="",this.myCallsCount=0,this.myTotalExecutionTime=0,this.myTotalExecutionTimePercentage=0,this.myAverageExecutionTime=0,this.myTimeElapsedSinceLastReset=0,this._myTotalExecutionTimeInternal=0}reset(){this.myCallsCount=0,this.myTotalExecutionTime=0,this.myTotalExecutionTimePercentage=0,this.myAverageExecutionTime=0,this.myTimeElapsedSinceLastReset=0,this._myTotalExecutionTimeInternal=0}max(e){this.myCallsCount=Math.max(this.myCallsCount,e.myCallsCount),this.myTotalExecutionTime=Math.max(this.myTotalExecutionTime,e.myTotalExecutionTime),this.myTotalExecutionTimePercentage=Math.max(this.myTotalExecutionTimePercentage,e.myTotalExecutionTimePercentage),this.myAverageExecutionTime=Math.max(this.myAverageExecutionTime,e.myAverageExecutionTime)}copy(e){this.myReference=e.myReference,this.myName=e.myName,this.myPath=e.myPath,this.myID=e.myID,this.myCallsCount=e.myCallsCount,this.myTotalExecutionTime=e.myTotalExecutionTime,this.myTotalExecutionTimePercentage=e.myTotalExecutionTimePercentage,this.myAverageExecutionTime=e.myAverageExecutionTime,this.myTimeElapsedSinceLastReset=e.myTimeElapsedSinceLastReset,this._myTotalExecutionTimeInternal=e._myTotalExecutionTimeInternal}},Ut={NONE:0,CALLS_COUNT:1,TOTAL_EXECUTION_TIME:2,AVERAGE_EXECUTION_TIME:3},yo=class extends $o{constructor(e=new ts){super(e),this._myFunctionPerformanceAnalysisResults=new Map,this._myFunctionPerformanceAnalysisMaxResults=new Map,this._myResultsAlreadyAdded=!1,this._myExecutionTimes={myOverheadExecutionTimeSinceLastReset:0,myLastFunctionExecutionTime:0,myOriginalFunctionOverheadExecutionTimes:[]},this._myTimeOfLastReset=r.getWindow(this._myParams.myEngine).performance.now(),this._myMaxTimeElapsedSinceLastReset=0;let t=Array.prototype.push,n=Array.prototype.pop;this._myExecutionTimes.myOriginalFunctionOverheadExecutionTimes.push=function(){return t.bind(this)(...arguments)},this._myExecutionTimes.myOriginalFunctionOverheadExecutionTimes.pop=function(){return n.bind(this)(...arguments)}}overwriteFunctions(){super.overwriteFunctions(),this.resetResults(),this.resetMaxResults()}getTimeElapsedSinceLastReset(){return r.getWindow(this._myParams.myEngine).performance.now()-this._myTimeOfLastReset-this._myExecutionTimes.myOverheadExecutionTimeSinceLastReset}getMaxTimeElapsedSinceLastReset(){return this._myMaxTimeElapsedSinceLastReset=Math.max(this._myMaxTimeElapsedSinceLastReset,this.getTimeElapsedSinceLastReset()),this._myMaxTimeElapsedSinceLastReset}resetResults(){this._updateDerivatesResults(),this._updateMaxResults();for(let e of this._myFunctionPerformanceAnalysisResults.keys())this._myFunctionPerformanceAnalysisResults.get(e).reset();this._myExecutionTimes.myOverheadExecutionTimeSinceLastReset=0,this._myTimeOfLastReset=r.getWindow(this._myParams.myEngine).performance.now()}resetMaxResults(){this._myMaxTimeElapsedSinceLastReset=0;for(let e of this._myFunctionPerformanceAnalysisMaxResults.keys())this._myFunctionPerformanceAnalysisMaxResults.get(e).reset()}getResults(e=Ut.NONE){this._updateDerivatesResults(),this._updateMaxResults();let t=this._myFunctionPerformanceAnalysisResults;return t=this._sortResults(t,e),t}getMaxResults(e=Ut.NONE){this._updateDerivatesResults(),this._updateMaxResults();let t=this._myFunctionPerformanceAnalysisMaxResults;return t=this._sortResults(t,e),t}_getOverwrittenFunction(e,t,n,o,s){return this._getOverwrittenFunctionInternal(e,t,n,o,s,!1)}_getOverwrittenConstructor(e,t,n,o,s){return this._getOverwrittenFunctionInternal(e,t,n,o,s,!0)}_onOverwriteSuccess(e,t,n,o,s,a,l,h){this._myResultsAlreadyAdded=!1}_onOverwriteFailure(e,t,n,o,s,a,l,h){if(this._myResultsAlreadyAdded){let _=this._getPropertyID(t,s,l,h);this._myFunctionPerformanceAnalysisResults.delete(_)}}_sortResults(e,t){let n=e;return t!=Ut.NONE&&(n=new Map([...e.entries()].sort(function(o,s){let a=0;return t==Ut.CALLS_COUNT?(a=-(o[1].myCallsCount-s[1].myCallsCount),a==0&&(a=-(o[1].myTotalExecutionTime-s[1].myTotalExecutionTime),a==0&&(a=-(o[1].myAverageExecutionTime-s[1].myAverageExecutionTime)))):t==Ut.TOTAL_EXECUTION_TIME?(a=-(o[1].myTotalExecutionTime-s[1].myTotalExecutionTime),a==0&&(a=-(o[1].myAverageExecutionTime-s[1].myAverageExecutionTime),a==0&&(a=-(o[1].myCallsCount-s[1].myCallsCount)))):(a=-(o[1].myAverageExecutionTime-s[1].myAverageExecutionTime),a==0&&(a=-(o[1].myTotalExecutionTime-s[1].myTotalExecutionTime),a==0&&(a=-(o[1].myCallsCount-s[1].myCallsCount)))),a}))),n}_getPropertyID(e,t,n,o){let s=o?"constructor":e;return t!=null&&this._myParams.myAddPathPrefixToFunctionID&&(n?s=t:s=t+"."+s),s}_updateDerivatesResults(){let e=this.getTimeElapsedSinceLastReset(),t=r.getWindow(this._myParams.myEngine).performance.now();for(let n of this._myFunctionPerformanceAnalysisResults.keys()){let o=this._myFunctionPerformanceAnalysisResults.get(n);e!=0?o.myTotalExecutionTimePercentage=o.myTotalExecutionTime/e:o.myCallsCount!=0?o.myTotalExecutionTimePercentage=1:o.myTotalExecutionTimePercentage=0,o.myCallsCount!=0?o.myAverageExecutionTime=o.myTotalExecutionTime/o.myCallsCount:o.myAverageExecutionTime=0,o.myTimeElapsedSinceLastReset=e}this._myExecutionTimes.myOverheadExecutionTimeSinceLastReset+=r.getWindow(this._myParams.myEngine).performance.now()-t}_updateMaxResults(){let e=r.getWindow(this._myParams.myEngine).performance.now();this._myMaxTimeElapsedSinceLastReset=Math.max(this._myMaxTimeElapsedSinceLastReset,this.getTimeElapsedSinceLastReset());for(let t of this._myFunctionPerformanceAnalysisResults.keys())if(this._myFunctionPerformanceAnalysisMaxResults.has(t))this._myFunctionPerformanceAnalysisMaxResults.get(t).max(this._myFunctionPerformanceAnalysisResults.get(t));else{let n=new es;n.copy(this._myFunctionPerformanceAnalysisResults.get(t)),this._myFunctionPerformanceAnalysisMaxResults.set(t,n)}this._myExecutionTimes.myOverheadExecutionTimeSinceLastReset+=r.getWindow(this._myParams.myEngine).performance.now()-e}_getOverwrittenFunctionInternal(e,t,n,o,s,a){let l=$.getObjectProperty(e,t);if((!this._myParams.myFilterDebugFunctionsPerformanceAnalyzerClasses||!this._isPerformanceAnalyzer(e,t,o))&&t!="_myPerformanceAnalyzerOriginalFunction"){let h=this._getPropertyID(t,n,s,a);this._myResultsAlreadyAdded=this._myFunctionPerformanceAnalysisResults.has(h);let _=new es;_.myReference=e,_.myName=t,_.myPath=n,_.myID=n,this._myFunctionPerformanceAnalysisResults.set(h,_);try{let y=r.getWindow(this._myParams.myEngine),c=this._myFunctionPerformanceAnalysisResults.get(h),d=this._myExecutionTimes,g=e[t],P=175e-6,T=35e-5,C=this._myParams.myExecutionTimeAnalysisEnabled;a?l=function(){let x=y.performance.now(),D=null,E,S=null,b=0,v=0,I=0,L=0,F=0,Q=0,Z=0;if(C){d.myOriginalFunctionOverheadExecutionTimes.push(0),b=y.performance.now(),v=y.performance.now();try{b=y.performance.now(),E=new g(...arguments),v=y.performance.now()}catch(ne){v=y.performance.now(),D=ne}}else try{E=new g(...arguments)}catch(ne){D=ne}if(c.myCallsCount+=1,C&&(I=d.myOriginalFunctionOverheadExecutionTimes.pop(),L=v-b-I,F=L-P,g._myPerformanceAnalyzerHasBeenOverwritten&&(F=d.myLastFunctionExecutionTime),c._myTotalExecutionTimeInternal+=F,c.myTotalExecutionTime=Math.max(0,c._myTotalExecutionTimeInternal),d.myLastFunctionExecutionTime=F,Q=b-x,Z=Q-v-T,d.myOriginalFunctionOverheadExecutionTimes.length>0&&(d.myOriginalFunctionOverheadExecutionTimes[d.myOriginalFunctionOverheadExecutionTimes.length-1]+=Z+I+T*2.75,d.myOriginalFunctionOverheadExecutionTimes[d.myOriginalFunctionOverheadExecutionTimes.length-1]+=y.performance.now()),d.myOverheadExecutionTimeSinceLastReset+=Z,d.myOverheadExecutionTimeSinceLastReset+=y.performance.now()),D!=null)throw D;return E}:l=function(){let x=y.performance.now(),D=null,E,S=null,b=0,v=0,I=0,L=0,F=0,Q=0,Z=0;if(C){d.myOriginalFunctionOverheadExecutionTimes.push(0),b=y.performance.now(),v=y.performance.now();try{S=g.bind(this),b=y.performance.now(),E=S(...arguments),v=y.performance.now()}catch(ne){v=y.performance.now(),D=ne}}else try{S=g.bind(this),E=S(...arguments)}catch(ne){D=ne}if(c.myCallsCount+=1,C&&(I=d.myOriginalFunctionOverheadExecutionTimes.pop(),L=v-b-I,F=L-P,g._myPerformanceAnalyzerHasBeenOverwritten&&(F=d.myLastFunctionExecutionTime),c._myTotalExecutionTimeInternal+=F,c.myTotalExecutionTime=Math.max(0,c._myTotalExecutionTimeInternal),d.myLastFunctionExecutionTime=F,Q=b-x,Z=Q-v-T,d.myOriginalFunctionOverheadExecutionTimes.length>0&&(d.myOriginalFunctionOverheadExecutionTimes[d.myOriginalFunctionOverheadExecutionTimes.length-1]+=Z+I+T*2.75,d.myOriginalFunctionOverheadExecutionTimes[d.myOriginalFunctionOverheadExecutionTimes.length-1]+=y.performance.now()),d.myOverheadExecutionTimeSinceLastReset+=Z,d.myOverheadExecutionTimeSinceLastReset+=y.performance.now()),D!=null)throw D;return E},l!=null&&(Object.defineProperty(l,"_myPerformanceAnalyzerHasBeenOverwritten",{value:!0,enumerable:!1,configurable:!1,writable:!1}),Object.defineProperty(l,"_myPerformanceAnalyzerOriginalFunction",{value:g,enumerable:!1,configurable:!1,writable:!1}))}catch(y){this._myParams.myLogEnabled&&console.error("Function:",t,"of:",e,`can't be overwritten.
Error:`,y)}}return l}_isPerformanceAnalyzer(e,t,n){let o=!1;return n&&(e==yo.prototype||e==es.prototype)&&(o=!0),o}};var Ws=class{constructor(){this.myPerformanceAnalyzer=null,this.myLogTitle="Functions Performance Analysis Results",this.mySecondsBetweenLogs=1,this.myLogFunction="log",this.myFormatLog=!0,this.myFormatLogIndentationCharacter="-",this.myLogMaxResults=!1,this.myLogSortOrder=Ut.NONE,this.myLogMaxAmountOfFunctions=null,this.myLogFunctionsWithCallsCountAbove=null,this.myLogFunctionsWithTotalExecutionTimePercentageAbove=null,this.myLogCallsCountResults=!1,this.myLogTotalExecutionTimeResults=!1,this.myLogTotalExecutionTimePercentageResults=!1,this.myLogAverageExecutionTimeResults=!1,this.myClearConsoleBeforeLog=!1}},Qs=class{constructor(e){this._myParams=e,this._myLogTimer=new ie(this._myParams.mySecondsBetweenLogs),this._myMaxNameLength=0,this._myMaxCallsCountLength=0,this._myMaxTotalExecutionTimeLength=0,this._myMaxTotalExecutionTimePercentageLength=0,this._myMaxAverageExecutionTimeLength=0}update(e){if(this._myParams.myPerformanceAnalyzer!=null&&(this._myLogTimer.update(e),this._myLogTimer.isDone())){this._myLogTimer.start();let t=this._myParams.myPerformanceAnalyzer.getTimeElapsedSinceLastReset();this._myParams.myLogMaxResults&&(t=this._myParams.myPerformanceAnalyzer.getMaxTimeElapsedSinceLastReset());let n=null;if(this._myParams.myLogMaxResults?n=this._myParams.myPerformanceAnalyzer.getMaxResults(this._myParams.myLogSortOrder):n=this._myParams.myPerformanceAnalyzer.getResults(this._myParams.myLogSortOrder),this._myParams.myLogFunctionsWithCallsCountAbove!=null){let a=new Map(n);n=new Map;let l=[...a.keys()];for(let h=0;h<l.length;h++){let _=a.get(l[h]);_.myCallsCount>this._myParams.myLogFunctionsWithCallsCountAbove&&n.set(l[h],_)}}if(this._myParams.myLogFunctionsWithTotalExecutionTimePercentageAbove!=null){let a=new Map(n);n=new Map;let l=[...a.keys()];for(let h=0;h<l.length;h++){let _=a.get(l[h]);_.myTotalExecutionTimePercentage*100>this._myParams.myLogFunctionsWithTotalExecutionTimePercentageAbove&&n.set(l[h],_)}}if(this._myParams.myLogMaxAmountOfFunctions!=null){let a=new Map(n);n=new Map;let l=[...a.keys()];for(let h=0;h<this._myParams.myLogMaxAmountOfFunctions&&h<l.length;h++){let _=a.get(l[h]);n.set(l[h],_)}}this._myParams.myClearConsoleBeforeLog&&console.clear();let o=new Map;for(let a of n.keys()){let l=n.get(a),h={};this._myParams.myLogCallsCountResults&&(h.myCallsCount=l.myCallsCount),this._myParams.myLogTotalExecutionTimeResults&&(h.myTotalExecutionTime=l.myTotalExecutionTime),this._myParams.myLogTotalExecutionTimePercentageResults&&(h.myTotalExecutionTimePercentage=l.myTotalExecutionTimePercentage),this._myParams.myLogAverageExecutionTimeResults&&(h.myAverageExecutionTime=l.myAverageExecutionTime),o.set(a,h)}let s="";for(let a of n.entries()){let l=a[0],h=a[1];this._myMaxNameLength=Math.max(this._myMaxNameLength,l.length),this._myMaxCallsCountLength=Math.max(this._myMaxCallsCountLength,h.myCallsCount.toFixed(0).length),this._myMaxTotalExecutionTimeLength=Math.max(this._myMaxTotalExecutionTimeLength,h.myTotalExecutionTime.toFixed(5).length),this._myMaxTotalExecutionTimePercentageLength=Math.max(this._myMaxTotalExecutionTimePercentageLength,(h.myTotalExecutionTimePercentage*100).toFixed(2).length),this._myMaxAverageExecutionTimeLength=Math.max(this._myMaxAverageExecutionTimeLength,h.myAverageExecutionTime.toFixed(5).length)}for(let a of n.entries()){let l=a[0],h=a[1],_=0;this._myParams.myLogCallsCountResults&&_++,this._myParams.myLogTotalExecutionTimeResults&&_++,this._myParams.myLogTotalExecutionTimePercentageResults&&_++,this._myParams.myLogAverageExecutionTimeResults&&_++;let y=[],c=_>1?"Calls Count: ":"";if(this._myParams.myFormatLog)for(let C=0;C<this._myMaxCallsCountLength-h.myCallsCount.toFixed(0).length;C++)c+=" ";c+=h.myCallsCount.toFixed(0);let d=_>1?"Total Time: ":"";if(this._myParams.myFormatLog)for(let C=0;C<this._myMaxTotalExecutionTimeLength-h.myTotalExecutionTime.toFixed(5).length;C++)d+=" ";d+=h.myTotalExecutionTime.toFixed(5)+"ms";let g=_>1?"Total Time: ":"";if(this._myParams.myFormatLog)for(let C=0;C<this._myMaxTotalExecutionTimePercentageLength-(h.myTotalExecutionTimePercentage*100).toFixed(2).length;C++)g+=" ";g+=(h.myTotalExecutionTimePercentage*100).toFixed(2)+"%";let P=_>1?"Average Time: ":"";if(this._myParams.myFormatLog)for(let C=0;C<this._myMaxAverageExecutionTimeLength-h.myAverageExecutionTime.toFixed(5).length;C++)P+=" ";switch(P+=h.myAverageExecutionTime.toFixed(5)+"ms",this._myParams.myLogCallsCountResults||(c=null),this._myParams.myLogTotalExecutionTimeResults||(d=null),this._myParams.myLogTotalExecutionTimePercentageResults||(g=null),this._myParams.myLogAverageExecutionTimeResults||(P=null),this._myParams.myLogSortOrder){case Ut.CALLS_COUNT:y.push(c),y.push(d),y.push(g),y.push(P);break;case Ut.TOTAL_EXECUTION_TIME:y.push(d),y.push(g),y.push(P),y.push(c);break;case Ut.AVERAGE_EXECUTION_TIME:y.push(P),y.push(d),y.push(g),y.push(c);break;default:y.push(c),y.push(d),y.push(g),y.push(P)}if(s+=`
`,this._myParams.myFormatLog){let C=l+" ";for(;C.length<this._myMaxNameLength+1;)C+=this._myParams.myFormatLogIndentationCharacter;C+=this._myParams.myFormatLogIndentationCharacter+" ",s+=C}else s+=l+" - ";let T=!0;for(let C of y)C!=null&&(T?T=!1:s+=" - ",s+=C)}this._myParams.myLogTotalExecutionTimeResults||this._myParams.myLogTotalExecutionTimePercentageResults||this._myParams.myLogAverageExecutionTimeResults?console[this._myParams.myLogFunction](`
`+this._myParams.myLogTitle,`

Total Time:`,t.toFixed(5),`ms
`,s):console[this._myParams.myLogFunction](`
`+this._myParams.myLogTitle,`
`,s)}}};import{Component as vR,Property as Se}from"@wonderlandengine/api";var et=class extends vR{init(){this._myActive=!1,r.isDebugEnabled(this.engine)&&(this._myActive=!0,this._myFunctionsPerformanceAnalyzer=null,this._myFunctionsPerformanceAnalysisResultsLogger=null,this._mySkipFirstUpdate=!0,this._myStartTimer=new ie(this._myDelayStart),this._myDelayStart==0&&(this._myStartTimer.end(),this._mySkipFirstUpdate=!1,this._start()))}update(e){if(this._myActive){if(this._mySkipFirstUpdate){this._mySkipFirstUpdate=!1;return}this._myStartTimer.isRunning()?(this._myStartTimer.update(e),this._myStartTimer.isDone()&&this._start()):(this._myFunctionsPerformanceAnalysisResultsLogger.update(e),this._myFunctionsPerformanceAnalyzer.resetResults()),this._myResetMaxResultsShortcutEnabled&&r.getLeftGamepad(this.engine).getButtonInfo(M.SELECT).isPressEnd(3)&&this._myFunctionsPerformanceAnalyzer.resetMaxResults()}}_start(){let e=new ts(this.engine);if(this._myObjectsByPath.length>0){let n=[...this._myObjectsByPath.split(",")];for(let o=0;o<n.length;o++)n[o]=n[o].trim();e.myObjectsByPath.push(...n)}if(this._myClassesByPath.length>0){let n=[...this._myClassesByPath.split(",")];for(let o=0;o<n.length;o++)n[o]=n[o].trim();e.myClassesByPath.push(...n)}if(this._myFunctionsByPath.length>0){let n=[...this._myFunctionsByPath.split(",")];for(let o=0;o<n.length;o++)n[o]=n[o].trim();e.myFunctionsByPath.push(...n)}if(e.myExcludeConstructors=this._myExcludeConstructors,e.myExcludeJSObjectFunctions=this._myExcludeJSObjectFunctions,e.myAddPathPrefixToFunctionID=this._myAddPathPrefixToFunctionID,this._myFunctionPathsToInclude.length>0){let n=[...this._myFunctionPathsToInclude.split(",")];for(let o=0;o<n.length;o++)n[o]=n[o].trim();e.myFunctionPathsToInclude.push(...n)}if(this._myFunctionPathsToExclude.length>0){let n=[...this._myFunctionPathsToExclude.split(",")];for(let o=0;o<n.length;o++)n[o]=n[o].trim();e.myFunctionPathsToExclude.push(...n)}e.myObjectAddObjectDescendantsDepthLevel=this._myObjectAddObjectDescendantsDepthLevel,e.myObjectAddClassDescendantsDepthLevel=this._myObjectAddClassDescendantsDepthLevel,e.myExecutionTimeAnalysisEnabled=this._myLogTotalExecutionTimeResults||this._myLogTotalExecutionTimePercentageResults||this._myLogAverageExecutionTimeResults,e.myClassesByReference=this._myClassesByReference!=0?this._myClassesByReference:[],e.myObjectsByReference=this._myObjectsByReference!=0?this._myObjectsByReference:[],this._myFunctionsPerformanceAnalyzer=new yo(e),this._myFunctionsPerformanceAnalyzer.overwriteFunctions();let t=new Ws;t.myPerformanceAnalyzer=this._myFunctionsPerformanceAnalyzer,t.myLogTitle=this._myLogTitle,t.mySecondsBetweenLogs=this._mySecondsBetweenLogs,t.myLogFunction=["log","error","warn","debug"][this._myLogFunction],t.myLogMaxAmountOfFunctions=this._myLogMaxAmountOfFunctions>=0?this._myLogMaxAmountOfFunctions:null,t.myLogFunctionsWithCallsCountAbove=this._myLogFunctionsWithCallsCountAbove>=0?this._myLogFunctionsWithCallsCountAbove:null,t.myLogFunctionsWithTotalExecutionTimePercentageAbove=this._myLogFunctionsWithTotalExecutionTimePercentageAbove>=0?this._myLogFunctionsWithTotalExecutionTimePercentageAbove:null,t.myLogMaxResults=this._myLogMaxResults,t.myClearConsoleBeforeLog=this._myClearConsoleBeforeLog,t.myLogSortOrder=this._myLogSortOrder,t.myLogCallsCountResults=this._myLogCallsCountResults,t.myLogTotalExecutionTimeResults=this._myLogTotalExecutionTimeResults,t.myLogTotalExecutionTimePercentageResults=this._myLogTotalExecutionTimePercentageResults,t.myLogAverageExecutionTimeResults=this._myLogAverageExecutionTimeResults,this._myFunctionsPerformanceAnalysisResultsLogger=new Qs(t)}};R(et,"TypeName","pp-debug-functions-performance-analyzer"),R(et,"Properties",{_myObjectsByPath:Se.string(""),_myClassesByPath:Se.string(""),_myFunctionsByPath:Se.string(""),_myDelayStart:Se.float(0),_myLogTitle:Se.string("Functions Performance Analysis Results"),_myLogFunction:Se.enum(["Log","Error","Warn","Debug"],"Log"),_mySecondsBetweenLogs:Se.float(1),_myLogMaxResults:Se.bool(!1),_myLogSortOrder:Se.enum(["None","Calls Count","Total Execution Time","Average Execution Time"],"None"),_myLogCallsCountResults:Se.bool(!0),_myLogTotalExecutionTimeResults:Se.bool(!0),_myLogTotalExecutionTimePercentageResults:Se.bool(!0),_myLogAverageExecutionTimeResults:Se.bool(!0),_myLogMaxAmountOfFunctions:Se.int(-1),_myLogFunctionsWithCallsCountAbove:Se.int(-1),_myLogFunctionsWithTotalExecutionTimePercentageAbove:Se.float(-1),_myFunctionPathsToInclude:Se.string(""),_myFunctionPathsToExclude:Se.string(""),_myExcludeConstructors:Se.bool(!1),_myExcludeJSObjectFunctions:Se.bool(!0),_myAddPathPrefixToFunctionID:Se.bool(!0),_myObjectAddObjectDescendantsDepthLevel:Se.int(0),_myObjectAddClassDescendantsDepthLevel:Se.int(0),_myClearConsoleBeforeLog:Se.bool(!1),_myResetMaxResultsShortcutEnabled:Se.bool(!1),_myClassesByReference:Se.enum(["Code Driven"],"Code Driven"),_myObjectsByReference:Se.enum(["Code Driven"],"Code Driven")});import{Component as xR,Property as it}from"@wonderlandengine/api";var gn=class extends xR{init(){this.object.pp_addComponent(et,{_myObjectsByPath:"PP",_myDelayStart:this._myDelayStart,_myLogTitle:"PP Functions Performance Analysis Results",_myLogFunction:this._myLogFunction,_mySecondsBetweenLogs:this._mySecondsBetweenLogs,_myLogMaxResults:this._myLogMaxResults,_myLogSortOrder:this._myLogSortOrder,_myLogMaxAmountOfFunctions:this._myLogMaxAmountOfFunctions,_myLogFunctionsWithCallsCountAbove:this._myLogFunctionsWithCallsCountAbove,_myLogFunctionsWithTotalExecutionTimePercentageAbove:this._myLogFunctionsWithTotalExecutionTimePercentageAbove,_myLogCallsCountResults:this._myLogCallsCountResults,_myLogTotalExecutionTimeResults:this._myLogTotalExecutionTimeResults,_myLogTotalExecutionTimePercentageResults:this._myLogTotalExecutionTimePercentageResults,_myLogAverageExecutionTimeResults:this._myLogAverageExecutionTimeResults,_myFunctionPathsToInclude:this._myFunctionPathsToInclude,_myFunctionPathsToExclude:this._myFunctionPathsToExclude,_myExcludeConstructors:this._myExcludeConstructors,_myExcludeJSObjectFunctions:!0,_myAddPathPrefixToFunctionID:!0,_myObjectAddObjectDescendantsDepthLevel:1,_myObjectAddClassDescendantsDepthLevel:1,_myClearConsoleBeforeLog:this._myClearConsoleBeforeLog,_myResetMaxResultsShortcutEnabled:this._myResetMaxResultsShortcutEnabled})}};R(gn,"TypeName","pp-debug-pp-functions-performance-analyzer"),R(gn,"Properties",{_myDelayStart:it.float(0),_myLogFunction:it.enum(["Log","Error","Warn","Debug"],"Log"),_mySecondsBetweenLogs:it.float(1),_myLogMaxResults:it.bool(!1),_myLogSortOrder:it.enum(["None","Calls Count","Total Execution Time","Average Execution Time"],"None"),_myLogCallsCountResults:it.bool(!0),_myLogTotalExecutionTimeResults:it.bool(!0),_myLogTotalExecutionTimePercentageResults:it.bool(!0),_myLogAverageExecutionTimeResults:it.bool(!0),_myLogMaxAmountOfFunctions:it.int(-1),_myLogFunctionsWithCallsCountAbove:it.int(-1),_myLogFunctionsWithTotalExecutionTimePercentageAbove:it.float(-1),_myFunctionPathsToInclude:it.string(""),_myFunctionPathsToExclude:it.string(""),_myExcludeConstructors:it.bool(!1),_myClearConsoleBeforeLog:it.bool(!1),_myResetMaxResultsShortcutEnabled:it.bool(!1)});import{Component as MR,Property as Ne}from"@wonderlandengine/api";var fn=class extends MR{init(){let e="Array, Uint8ClampedArray, Uint8Array, Uint16Array, Uint32Array, Int8Array, Int16Array, Int32Array, Float32Array, Float64Array";this._myIncludeOnlyMainArrayTypes&&(e="Array, Uint8Array, Uint16Array, Float32Array"),this.object.pp_addComponent(et,{_myClassesByPath:e,_myDelayStart:this._myDelayStart,_myLogTitle:"Array Functions Performance Analysis Results",_myLogFunction:this._myLogFunction,_mySecondsBetweenLogs:this._mySecondsBetweenLogs,_myLogMaxResults:this._myLogMaxResults,_myLogSortOrder:this._myLogSortOrder,_myLogMaxAmountOfFunctions:this._myLogMaxAmountOfFunctions,_myLogFunctionsWithCallsCountAbove:this._myLogFunctionsWithCallsCountAbove,_myLogFunctionsWithTotalExecutionTimePercentageAbove:this._myLogFunctionsWithTotalExecutionTimePercentageAbove,_myLogCallsCountResults:this._myLogCallsCountResults,_myLogTotalExecutionTimeResults:this._myLogTotalExecutionTimeResults,_myLogTotalExecutionTimePercentageResults:this._myLogTotalExecutionTimePercentageResults,_myLogAverageExecutionTimeResults:this._myLogAverageExecutionTimeResults,_myFunctionPathsToInclude:this._myFunctionPathsToInclude+(this._myFunctionPathsToInclude.length>0&&this._myIncludeOnlyArrayExtensionFunctions?", ":"")+(this._myIncludeOnlyArrayExtensionFunctions?"pp_, vec_, vec2_, vec3_, vec4_, quat_, quat2_, mat3_, mat4_, _pp_, _vec_, _quat_":""),_myFunctionPathsToExclude:this._myFunctionPathsToExclude,_myExcludeConstructors:this._myExcludeConstructors,_myExcludeJSObjectFunctions:!0,_myAddPathPrefixToFunctionID:!0,_myClearConsoleBeforeLog:this._myClearConsoleBeforeLog,_myResetMaxResultsShortcutEnabled:this._myResetMaxResultsShortcutEnabled})}};R(fn,"TypeName","pp-debug-array-functions-performance-analyzer"),R(fn,"Properties",{_myIncludeOnlyMainArrayTypes:Ne.bool(!0),_myIncludeOnlyArrayExtensionFunctions:Ne.bool(!1),_myDelayStart:Ne.float(0),_myLogFunction:Ne.enum(["Log","Error","Warn","Debug"],"Log"),_mySecondsBetweenLogs:Ne.float(1),_myLogMaxResults:Ne.bool(!1),_myLogSortOrder:Ne.enum(["None","Calls Count","Total Execution Time","Average Execution Time"],"None"),_myLogCallsCountResults:Ne.bool(!0),_myLogTotalExecutionTimeResults:Ne.bool(!0),_myLogTotalExecutionTimePercentageResults:Ne.bool(!0),_myLogAverageExecutionTimeResults:Ne.bool(!0),_myLogMaxAmountOfFunctions:Ne.int(-1),_myLogFunctionsWithCallsCountAbove:Ne.int(-1),_myLogFunctionsWithTotalExecutionTimePercentageAbove:Ne.float(-1),_myFunctionPathsToInclude:Ne.string(""),_myFunctionPathsToExclude:Ne.string(""),_myExcludeConstructors:Ne.bool(!1),_myClearConsoleBeforeLog:Ne.bool(!1),_myResetMaxResultsShortcutEnabled:Ne.bool(!1)});import{Component as ER,Property as Pt}from"@wonderlandengine/api";var Gr=class extends ER{init(){this.object.pp_addComponent(et,{_myObjectsByPath:"PP",_myDelayStart:this._myDelayStart,_myLogTitle:"PP Array Creation Performance Analysis Results",_myLogFunction:this._myLogFunction,_mySecondsBetweenLogs:this._mySecondsBetweenLogs,_myLogMaxResults:this._myLogMaxResults,_myLogSortOrder:this._myLogSortOrder,_myLogMaxAmountOfFunctions:this._myLogMaxAmountOfFunctions,_myLogFunctionsWithCallsCountAbove:this._myLogFunctionsWithCallsCountAbove,_myLogFunctionsWithTotalExecutionTimePercentageAbove:this._myLogFunctionsWithTotalExecutionTimePercentageAbove,_myLogCallsCountResults:this._myLogCallsCountResults,_myLogTotalExecutionTimeResults:this._myLogTotalExecutionTimeResults,_myLogTotalExecutionTimePercentageResults:this._myLogTotalExecutionTimePercentageResults,_myLogAverageExecutionTimeResults:this._myLogAverageExecutionTimeResults,_myFunctionPathsToInclude:"vec2_create, vec3_create, vec4_create, quat_create, quat2_create, mat3_create, mat4_create",_myExcludeConstructors:!0,_myExcludeJSObjectFunctions:!0,_myAddPathPrefixToFunctionID:!0,_myClearConsoleBeforeLog:this._myClearConsoleBeforeLog,_myResetMaxResultsShortcutEnabled:this._myResetMaxResultsShortcutEnabled})}};R(Gr,"TypeName","pp-debug-pp-array-creation-performance-analyzer"),R(Gr,"Properties",{_myDelayStart:Pt.float(0),_myLogFunction:Pt.enum(["Log","Error","Warn","Debug"],"Log"),_mySecondsBetweenLogs:Pt.float(1),_myLogMaxResults:Pt.bool(!1),_myLogSortOrder:Pt.enum(["None","Calls Count","Total Execution Time","Average Execution Time"],"None"),_myLogCallsCountResults:Pt.bool(!0),_myLogTotalExecutionTimeResults:Pt.bool(!0),_myLogTotalExecutionTimePercentageResults:Pt.bool(!0),_myLogAverageExecutionTimeResults:Pt.bool(!0),_myLogMaxAmountOfFunctions:Pt.int(-1),_myLogFunctionsWithCallsCountAbove:Pt.int(-1),_myLogFunctionsWithTotalExecutionTimePercentageAbove:Pt.float(-1),_myClearConsoleBeforeLog:Pt.bool(!1),_myResetMaxResultsShortcutEnabled:Pt.bool(!1)});import{Component as DR,Property as nt}from"@wonderlandengine/api";var Pn=class extends DR{init(){this.object.pp_addComponent(et,{_myObjectsByPath:"WL",_myDelayStart:this._myDelayStart,_myLogTitle:"WL Functions Performance Analysis Results",_myLogFunction:this._myLogFunction,_mySecondsBetweenLogs:this._mySecondsBetweenLogs,_myLogMaxResults:this._myLogMaxResults,_myLogSortOrder:this._myLogSortOrder,_myLogMaxAmountOfFunctions:this._myLogMaxAmountOfFunctions,_myLogFunctionsWithCallsCountAbove:this._myLogFunctionsWithCallsCountAbove,_myLogFunctionsWithTotalExecutionTimePercentageAbove:this._myLogFunctionsWithTotalExecutionTimePercentageAbove,_myLogCallsCountResults:this._myLogCallsCountResults,_myLogTotalExecutionTimeResults:this._myLogTotalExecutionTimeResults,_myLogTotalExecutionTimePercentageResults:this._myLogTotalExecutionTimePercentageResults,_myLogAverageExecutionTimeResults:this._myLogAverageExecutionTimeResults,_myFunctionPathsToInclude:this._myFunctionPathsToInclude,_myFunctionPathsToExclude:this._myFunctionPathsToExclude,_myExcludeConstructors:this._myExcludeConstructors,_myExcludeJSObjectFunctions:!0,_myAddPathPrefixToFunctionID:!0,_myObjectAddObjectDescendantsDepthLevel:1,_myObjectAddClassDescendantsDepthLevel:1,_myClearConsoleBeforeLog:this._myClearConsoleBeforeLog,_myResetMaxResultsShortcutEnabled:this._myResetMaxResultsShortcutEnabled})}};R(Pn,"TypeName","pp-debug-wl-functions-performance-analyzer"),R(Pn,"Properties",{_myDelayStart:nt.float(0),_myLogFunction:nt.enum(["Log","Error","Warn","Debug"],"Log"),_mySecondsBetweenLogs:nt.float(1),_myLogMaxResults:nt.bool(!1),_myLogSortOrder:nt.enum(["None","Calls Count","Total Execution Time","Average Execution Time"],"None"),_myLogCallsCountResults:nt.bool(!0),_myLogTotalExecutionTimeResults:nt.bool(!0),_myLogTotalExecutionTimePercentageResults:nt.bool(!0),_myLogAverageExecutionTimeResults:nt.bool(!0),_myLogMaxAmountOfFunctions:nt.int(-1),_myLogFunctionsWithCallsCountAbove:nt.int(-1),_myLogFunctionsWithTotalExecutionTimePercentageAbove:nt.float(-1),_myFunctionPathsToInclude:nt.string(""),_myFunctionPathsToExclude:nt.string(""),_myExcludeConstructors:nt.bool(!1),_myClearConsoleBeforeLog:nt.bool(!1),_myResetMaxResultsShortcutEnabled:nt.bool(!1)});import{AnimationComponent as RR,CollisionComponent as AR,Component as VR,InputComponent as OR,LightComponent as BR,MeshComponent as IR,PhysXComponent as HR,Property as Fe,TextComponent as LR,ViewComponent as kR}from"@wonderlandengine/api";var Cn=class extends VR{init(){this._myStartTimer=new ie(this._myDelayStart),this._myDelayStart==0&&(this._myStartTimer.end(),this._start())}update(e){this._myStartTimer.isRunning()&&(this._myStartTimer.update(e),this._myStartTimer.isDone()&&this._start())}_start(){let e=[],t=[];this._myAnalyzeComponentInstances&&this._addComponentInstanceReferences(e),this._myAnalyzeComponentTypes&&this._addComponentTypeReferences(t),this._myAnalyzerComponent=this.object.pp_addComponent(et,{_myObjectsByReference:e,_myClassesByReference:t,_myDelayStart:0,_myLogTitle:"WL Components Performance Analysis Results",_myLogFunction:this._myLogFunction,_mySecondsBetweenLogs:this._mySecondsBetweenLogs,_myLogMaxResults:this._myLogMaxResults,_myLogSortOrder:this._myLogSortOrder,_myLogMaxAmountOfFunctions:this._myLogMaxAmountOfFunctions,_myLogFunctionsWithCallsCountAbove:this._myLogFunctionsWithCallsCountAbove,_myLogFunctionsWithTotalExecutionTimePercentageAbove:this._myLogFunctionsWithTotalExecutionTimePercentageAbove,_myLogCallsCountResults:this._myLogCallsCountResults,_myLogTotalExecutionTimeResults:this._myLogTotalExecutionTimeResults,_myLogTotalExecutionTimePercentageResults:this._myLogTotalExecutionTimePercentageResults,_myLogAverageExecutionTimeResults:this._myLogAverageExecutionTimeResults,_myFunctionPathsToInclude:this._myFunctionPathsToInclude,_myFunctionPathsToExclude:this._myFunctionPathsToExclude,_myExcludeConstructors:this._myExcludeConstructors,_myExcludeJSObjectFunctions:!0,_myAddPathPrefixToFunctionID:!0,_myObjectAddClassDescendantsDepthLevel:0,_myClearConsoleBeforeLog:this._myClearConsoleBeforeLog,_myResetMaxResultsShortcutEnabled:this._myResetMaxResultsShortcutEnabled})}_addComponentTypeReferences(e){let t=[RR,AR,OR,BR,IR,HR,LR,kR];for(let n of t)e.push([n.prototype,'{"'+n.TypeName+'"}']);for(let n of N.getJavascriptComponentClassesByIndex(this.engine))e.push([n.prototype,'{"'+n.TypeName+'"}'])}_addComponentInstanceReferences(e){for(let t of N.getJavascriptComponentInstances(this.engine)){let n="";switch(this._myComponentInstanceID){case 0:n=t.object.pp_getID();break;case 1:n=t.object.pp_getName();break;case 2:n=t.object.pp_getID(),t.object.pp_getName().length>0&&(n=n+" - "+t.object.pp_getName());break}e.push([t,'{"'+t.type+'"}['+n+"]"])}}};R(Cn,"TypeName","pp-debug-wl-components-functions-performance-analyzer"),R(Cn,"Properties",{_myAnalyzeComponentTypes:Fe.bool(!0),_myAnalyzeComponentInstances:Fe.bool(!1),_myComponentInstanceID:Fe.enum(["Object ID","Object Name","Object ID - Object Name"],"Object ID - Object Name"),_myDelayStart:Fe.float(0),_myLogFunction:Fe.enum(["Log","Error","Warn","Debug"],"Log"),_mySecondsBetweenLogs:Fe.float(1),_myLogMaxResults:Fe.bool(!1),_myLogSortOrder:Fe.enum(["None","Calls Count","Total Execution Time","Average Execution Time"],"None"),_myLogCallsCountResults:Fe.bool(!0),_myLogTotalExecutionTimeResults:Fe.bool(!0),_myLogTotalExecutionTimePercentageResults:Fe.bool(!0),_myLogAverageExecutionTimeResults:Fe.bool(!0),_myLogMaxAmountOfFunctions:Fe.int(-1),_myLogFunctionsWithCallsCountAbove:Fe.int(-1),_myLogFunctionsWithTotalExecutionTimePercentageAbove:Fe.float(-1),_myFunctionPathsToInclude:Fe.string(""),_myFunctionPathsToExclude:Fe.string(""),_myExcludeConstructors:Fe.bool(!1),_myClearConsoleBeforeLog:Fe.bool(!1),_myResetMaxResultsShortcutEnabled:Fe.bool(!1)});var li=class{constructor(){this.myStartFlyingForward=!1,this.myStartFlyingRight=!1,this.myAutoUpdateFlyForward=!1,this.myAutoUpdateFlyRight=!1,this.myResetFlyForwardWhenZero=!1,this.myResetFlyRightWhenZero=!1,this.myMinAngleToFlyForwardUp=90,this.myMinAngleToFlyForwardDown=90,this.myMinAngleToFlyRightUp=90,this.myMinAngleToFlyRightDown=90}},Mt=class{constructor(e=new li){this._myParams=e,this._myFlyingForward=this._myParams.myStartFlyingForward,this._myFlyingRight=this._myParams.myStartFlyingRight,this._myLastValidFlatForward=m(),this._myLastValidFlatRight=m(),this._myMinAngleToBeValid=5}convert(e,t,n=null,o=m()){return this.convertTransform(e,t,n,o)}isFlying(){return this._myFlyingForward||this._myFlyingRight}isFlyingForward(){return this._myFlyingForward}isFlyingRight(){return this._myFlyingRight}startFlying(){this._myFlyingForward=!0,this._myFlyingRight=!0}startFlyingForward(){this._myFlyingForward=!0}startFlyingRight(){this._myFlyingRight=!0}stopFlying(){this._myFlyingForward=!1,this._myFlyingRight=!1}stopFlyingForward(){this._myFlyingForward=!1}stopFlyingRight(){this._myFlyingRight=!1}resetFly(){this.resetFlyForward(),this.resetFlyRight()}resetFlyForward(){this._myParams.myStartFlyingForward?this.startFlyingForward():this.stopFlyingForward(),this._myLastValidFlatForward.vec3_zero()}resetFlyRight(){this._myParams.myStartFlyingRight?this.startFlyingRight():this.stopFlyingRight(),this._myLastValidFlatRight.vec3_zero()}convertForward(e,t,n=null,o=m()){}convertTransform(e,t,n=null,o=m()){return this.convertTransformMatrix(e,t,n,o)}convertTransformMatrix(e,t,n=null,o=m()){}convertTransformQuat(e,t,n=null,o=m()){}convertRotationQuat(e,t,n=null,o=m()){}};Mt.prototype.convertForward=function(){let i=z();return function(t,n,o=null,s=m()){return i.quat_identity(),i.quat_setForward(n,o),this.convertRotationQuat(t,i,o,s)}}();Mt.prototype.convertTransformMatrix=function(){let i=z();return function(t,n,o=null,s=m()){return i=n.mat4_getRotationQuat(i),this.convertRotationQuat(t,i,o,s)}}();Mt.prototype.convertTransformQuat=function(){let i=z();return function(t,n,o=null,s=m()){return i=n.quat2_getRotationQuat(i),this.convertRotationQuat(t,i,o,s)}}();Mt.prototype.convertRotationQuat=function(){let i=m(),e=m(),t=m(),n=m(),o=m();return function(a,l,h=null,_=m()){if(a.vec2_isZero())return this._myParams.myAutoUpdateFlyForward&&this._myParams.myResetFlyForwardWhenZero&&this.resetFlyForward(),this._myParams.myAutoUpdateFlyRight&&this._myParams.myResetFlyRightWhenZero&&this.resetFlyRight(),_.vec3_zero(),_;if(a[0]==0&&this._myLastValidFlatRight.vec3_zero(),a[1]==0&&this._myLastValidFlatForward.vec3_zero(),i=l.quat_getForward(i),e=l.quat_getRight(e),h!=null){if(t=h.vec3_negate(t),this._myParams.myAutoUpdateFlyForward){let y=i.vec3_angle(h);this._myFlyingForward=this._myFlyingForward||y<90-this._myParams.myMinAngleToFlyForwardUp||y>90+this._myParams.myMinAngleToFlyForwardDown}if(this._myParams.myAutoUpdateFlyRight){let y=e.vec3_angle(h);this._myFlyingRight=this._myFlyingRight||y<90-this._myParams.myMinAngleToFlyRightUp||y>90+this._myParams.myMinAngleToFlyRightDown}this._myFlyingForward||(!this._myLastValidFlatForward.vec3_isZero(Math.PP_EPSILON)&&(i.vec3_angle(h)<this._myMinAngleToBeValid||i.vec3_angle(t)<this._myMinAngleToBeValid)&&(i.vec3_isConcordant(this._myLastValidFlatForward)?i.pp_copy(this._myLastValidFlatForward):i=this._myLastValidFlatForward.vec3_negate(i)),i=i.vec3_removeComponentAlongAxis(h,i),i.vec3_normalize(i)),this._myFlyingRight||(!this._myLastValidFlatRight.vec3_isZero(Math.PP_EPSILON)&&(e.vec3_angle(h)<this._myMinAngleToBeValid||e.vec3_angle(t)<this._myMinAngleToBeValid)&&(e.vec3_isConcordant(this._myLastValidFlatRight)?e.pp_copy(this._myLastValidFlatRight):e=this._myLastValidFlatRight.vec3_negate(e)),e=e.vec3_removeComponentAlongAxis(h,e),e.vec3_normalize(e)),(i.vec3_angle(h)>this._myMinAngleToBeValid&&i.vec3_angle(t)>this._myMinAngleToBeValid||a[1]!=0&&this._myLastValidFlatForward.vec3_isZero(Math.PP_EPSILON))&&(this._myLastValidFlatForward=i.vec3_removeComponentAlongAxis(h,this._myLastValidFlatForward),this._myLastValidFlatForward.vec3_normalize(this._myLastValidFlatForward)),(e.vec3_angle(h)>this._myMinAngleToBeValid&&e.vec3_angle(t)>this._myMinAngleToBeValid||a[0]!=0&&this._myLastValidFlatRight.vec3_isZero(Math.PP_EPSILON))&&(this._myLastValidFlatRight=e.vec3_removeComponentAlongAxis(h,this._myLastValidFlatRight),this._myLastValidFlatRight.vec3_normalize(this._myLastValidFlatRight))}return _=e.vec3_scale(a[0],o).vec3_add(i.vec3_scale(a[1],n),_),h!=null&&!this._myFlyingForward&&!this._myFlyingRight&&(_=_.vec3_removeComponentAlongAxis(h,_)),_.vec3_normalize(_),_}}();var Oi=class{constructor(e,t=null,n=0,o=0,s=ue.linear,a=null){t==null&&(t=e),this._myStartNumber=e,this._myEndNumber=t,this._myStartInterpolationValue=n,this._myEndInterpolationValue=o,this._myEasingFunction=s,this._myRoundingFunction=a}get(e){let t=this._myEasingFunction(Math.pp_mapToRange(e,this._myStartInterpolationValue,this._myEndInterpolationValue,0,1)),n=Math.pp_lerp(this._myStartNumber,this._myEndNumber,t);return this._myRoundingFunction&&(n=this._myRoundingFunction(n,this._myStartNumber,this._myEndNumber)),n}getAverage(e){return this.get(e)}getRange(e){let t=this.get(e);return[t,t]}getMax(e){return this.get(e)}getMin(e){return this.get(e)}isInside(e,t){return this.get(t)==e}isInsideAngleRange(e,t){return this.isInsideAngleRangeDegrees(e,t)}isInsideAngleRangeDegrees(e,t){let n=this.get(t),o=Math.pp_angleClampDegrees(e),s=Math.pp_angleClampDegrees(n);return o==s}isInsideAngleRangeRadians(e,t){let n=this.get(t),o=Math.pp_angleClampRadians(e),s=Math.pp_angleClampRadians(n);return o==s}},mm=class extends Oi{constructor(e,t,n,o,s=ue.linear,a=null){a==null&&(a=function(l,h,_){let y=null;return h<=_?y=Math.floor(l):y=Math.ceil(l),y}),super(e,t,n,o,s,a)}},Ur=class{constructor(e,t=null,n=0,o=0,s=ue.linear,a=null){t==null&&(t=e),this._myStartNumberOverValue=new Oi(e[0],t[0],n,o,s,a),this._myEndNumberOverValue=new Oi(e[1],t[1],n,o,s,a),this._myRoundingFunction=a}get(e){let t=this._myStartNumberOverValue.get(e),n=this._myEndNumberOverValue.get(e),o=null;return this._myRoundingFunction?o=Math.pp_randomInt(t,n):o=Math.pp_random(t,n),o}getAverage(e){let t=this._myStartNumberOverValue.get(e),n=this._myEndNumberOverValue.get(e),o=(t+n)/2;return this._myRoundingFunction&&(o=this._myRoundingFunction(o,t,n)),o}getRange(e){let t=this._myStartNumberOverValue.get(e),n=this._myEndNumberOverValue.get(e);return[t,n]}getMax(e){let t=this._myStartNumberOverValue.get(e),n=this._myEndNumberOverValue.get(e);return Math.max(t,n)}getMin(e){let t=this._myStartNumberOverValue.get(e),n=this._myEndNumberOverValue.get(e);return Math.min(t,n)}isInside(e,t){let n=this._myStartNumberOverValue.get(t),o=this._myEndNumberOverValue.get(t),s=Math.min(n,o),a=Math.max(n,o);return e>=s&&e<=a}isInsideAngleRange(e,t){return this.isInsideAngleRangeDegrees(e,t)}isInsideAngleRangeDegrees(e,t){let n=this._myStartNumberOverValue.get(t),o=this._myEndNumberOverValue.get(t);return Math.pp_isInsideAngleRangeDegrees(e,n,o)}isInsideAngleRangeRadians(e,t){let n=this._myStartNumberOverValue.get(t),o=this._myEndNumberOverValue.get(t);return Math.pp_isInsideAngleRangeRadians(e,n,o)}},ym=class extends Ur{constructor(e,t,n,o,s=ue.linear,a=null){a==null&&(a=function(l,h,_){let y=null;return h<=_?y=Math.floor(l):y=Math.ceil(l),y}),super(e,t,n,o,s,a)}};import{Component as FR,Emitter as um,PhysXComponent as wR,Property as Wr}from"@wonderlandengine/api";var Ti=class extends FR{init(){this._myGrabbed=!1,this._myGrabber=null,this._myOldParent=null,this._myPhysX=null,this._myOldKinematicValue=null,this._myGrabEmitter=new um,this._myThrowEmitter=new um,this._myReleaseEmitter=new um}start(){this._myOldParent=this.object.pp_getParent(),this._myPhysX=this.object.pp_getComponent(wR)}onDeactivate(){this.release()}grab(e){this.isGrabbed()||(this._myOldKinematicValue=this._myPhysX.kinematic),this.release(),this._myPhysX.kinematic=!0,this._myOldParent=this.object.pp_getParent(),this.object.pp_setParent(e),this._myGrabbed=!0,this._myGrabEmitter.notify(e,this)}throw(e,t){if(this._myGrabbed){let n=this._myGrabber;this._release(),this._myPhysX.linearVelocity=e.vec3_scale(this._myThrowLinearVelocityMultiplier),this._myPhysX.angularVelocity=t.vec3_scale(this._myThrowAngularVelocityMultiplier),this._myThrowEmitter.notify(n,this),this._myReleaseEmitter.notify(n,this,!0)}}release(){if(this._myGrabbed){let e=this._myGrabber;this._release(),this._myReleaseEmitter.notify(e,this,!1)}}getLinearVelocity(){let e=m();return this._myPhysX.linearVelocity.vec3_clone(e),e}getAngularVelocity(){return this.getAngularVelocityDegrees()}getAngularVelocityDegrees(){let e=m();return this._myPhysX.angularVelocity.vec3_toDegrees(e),e}getAngularVelocityRadians(){let e=m();return this._myPhysX.angularVelocity.vec3_clone(e),e}isGrabbed(){return this._myGrabbed}getGrabber(){return this._myGrabber}registerGrabEventListener(e,t){this._myGrabEmitter.add(t,{id:e})}unregisterGrabEventListener(e){this._myGrabEmitter.remove(e)}registerThrowEventListener(e,t){this._myThrowEmitter.add(t,{id:e})}unregisterThrowEventListener(e){this._myThrowEmitter.remove(e)}registerReleaseEventListener(e,t){this._myReleaseEmitter.add(t,{id:e})}unregisterReleaseEventListener(e){this._myReleaseEmitter.remove(e)}_release(){this._myParentOnRelease==0?this.object.pp_setParent(r.getSceneObjects(this.engine).myDynamics):this.object.pp_setParent(this._myOldParent),this._myGrabbed=!1,this._myGrabber=null,this._myKinematicValueOnRelease==0?this._myPhysX.kinematic=!0:this._myKinematicValueOnRelease==1?this._myPhysX.kinematic=!1:this._myOldKinematicValue!=null&&(this._myPhysX.kinematic=this._myOldKinematicValue),this._myPhysX.kinematic&&(this._myPhysX.linearVelocity=m(),this._myPhysX.angularVelocity=m())}pp_clone(e){return N.cloneDefault(this,e)}pp_clonePostProcess(e){e.start()}};R(Ti,"TypeName","pp-grabbable"),R(Ti,"Properties",{_myThrowLinearVelocityMultiplier:Wr.float(1),_myThrowAngularVelocityMultiplier:Wr.float(1),_myKinematicValueOnRelease:Wr.enum(["True","False","Own"],"False"),_myParentOnRelease:Wr.enum(["Scene","Own"],"Own")});import{Component as jR,Emitter as lT,PhysXComponent as zR,Property as Bt}from"@wonderlandengine/api";var bi=class extends jR{init(){this._myGrabbables=[],this._myGamepad=null,this._myActiveGrabButton=null,this._myLinearVelocityHistorySize=5,this._myLinearVelocityHistorySpeedAverageSamplesFromStart=1,this._myLinearVelocityHistoryDirectionAverageSamplesFromStart=3,this._myLinearVelocityHistoryDirectionAverageSkipFromStart=0,this._myHandLinearVelocityHistory=new Array(this._myLinearVelocityHistorySize),this._myHandLinearVelocityHistory.fill(m()),this._myAngularVelocityHistorySize=1,this._myHandAngularVelocityHistory=new Array(this._myAngularVelocityHistorySize),this._myHandAngularVelocityHistory.fill(m()),this._myThrowMaxAngularSpeedRadians=Math.pp_toRadians(this._myThrowMaxAngularSpeed),this._myGrabEmitter=new lT,this._myThrowEmitter=new lT,this._myDebugEnabled=!1}start(){this._myHandedness==Gi.LEFT?this._myGamepad=r.getLeftGamepad(this.engine):this._myGamepad=r.getRightGamepad(this.engine),this._myPhysX=this.object.pp_getComponent(zR),this._myCollisionsCollector=new Ai(this._myPhysX,!0)}update(e){this._myCollisionsCollector.update(e),this._myGrabbables.length>0&&(this._updateLinearVelocityHistory(),this._updateAngularVelocityHistory())}grab(e=null){this._grab(e)}throw(e=null){this._throw(e)}getGamepad(){return this._myGamepad}getHandedness(){return ee.getHandednessByIndex(this._myHandedness)}registerGrabEventListener(e,t){this._myGrabEmitter.add(t,{id:e})}unregisterGrabEventListener(e){this._myGrabEmitter.remove(e)}registerThrowEventListener(e,t){this._myThrowEmitter.add(t,{id:e})}unregisterThrowEventListener(e){this._myThrowEmitter.remove(e)}onActivate(){this._myGamepad!=null&&(this._myGrabButton==0?(this._myGamepad.registerButtonEventListener(M.SELECT,ae.PRESS_START,this,this._grab.bind(this,M.SELECT)),this._myGamepad.registerButtonEventListener(M.SELECT,ae.PRESS_END,this,this._throw.bind(this,M.SELECT))):this._myGrabButton==1?(this._myGamepad.registerButtonEventListener(M.SQUEEZE,ae.PRESS_START,this,this._grab.bind(this,M.SQUEEZE)),this._myGamepad.registerButtonEventListener(M.SQUEEZE,ae.PRESS_END,this,this._throw.bind(this,M.SQUEEZE))):(this._myGamepad.registerButtonEventListener(M.SQUEEZE,ae.PRESS_START,this,this._grab.bind(this,M.SQUEEZE)),this._myGamepad.registerButtonEventListener(M.SQUEEZE,ae.PRESS_END,this,this._throw.bind(this,M.SQUEEZE)),this._myGamepad.registerButtonEventListener(M.SELECT,ae.PRESS_START,this,this._grab.bind(this,M.SELECT)),this._myGamepad.registerButtonEventListener(M.SELECT,ae.PRESS_END,this,this._throw.bind(this,M.SELECT))))}onDeactivate(){this.throw(),this._myGamepad!=null&&(this._myGrabButton==0?(this._myGamepad.unregisterButtonEventListener(M.SELECT,ae.PRESS_START,this),this._myGamepad.unregisterButtonEventListener(M.SELECT,ae.PRESS_END,this)):this._myGrabButton==1?(this._myGamepad.unregisterButtonEventListener(M.SQUEEZE,ae.PRESS_START,this),this._myGamepad.unregisterButtonEventListener(M.SQUEEZE,ae.PRESS_END,this)):(this._myGamepad.unregisterButtonEventListener(M.SQUEEZE,ae.PRESS_START,this),this._myGamepad.unregisterButtonEventListener(M.SQUEEZE,ae.PRESS_END,this),this._myGamepad.unregisterButtonEventListener(M.SELECT,ae.PRESS_START,this),this._myGamepad.unregisterButtonEventListener(M.SELECT,ae.PRESS_END,this)))}_grab(e){if(!(this._myGrabbables.length>=this._myMaxNumberOfObjects)&&(this._myGrabButton==2||this._myActiveGrabButton==null||this._myActiveGrabButton==e||e==null)){let t=[],n=this._myCollisionsCollector.getCollisions();for(let s=0;s<n.length;s++){let a=n[s].pp_getComponent(Ti);a&&a.active&&t.push(a)}let o=this.object.pp_getPosition();t.sort(function(s,a){let l=s.object.pp_getPosition(),h=a.object.pp_getPosition(),_=l.vec3_distance(o),y=h.vec3_distance(o);return Math.pp_sign(_-y,0)});for(let s of t){if(!this._isAlreadyGrabbed(s)){let a=new hm(s,this._myThrowVelocitySource==1,this._myLinearVelocityHistorySize,this._myAngularVelocityHistorySize);this._myGrabbables.push(a),s.grab(this.object),s.registerReleaseEventListener(this,this._onRelease.bind(this)),this._mySnapOnPivot&&s.object.pp_resetPositionLocal(),this._myGrabEmitter.notify(this,s)}if(this._myGrabbables.length>=this._myMaxNumberOfObjects)break}this._myGrabbables.length>0&&this._myActiveGrabButton==null&&(this._myActiveGrabButton=e)}}_throw(e){if(this._myGrabButton==2||this._myActiveGrabButton==null||this._myActiveGrabButton==e||e==null){if(this._myGrabbables.length>0){let t=null,n=null;this._myThrowVelocitySource==0&&(t=this._computeReleaseLinearVelocity(this._myHandLinearVelocityHistory),n=this._computeReleaseAngularVelocity(this._myHandAngularVelocityHistory));for(let o of this._myGrabbables){let s=o.getGrabbable();s.unregisterReleaseEventListener(this),this._myThrowVelocitySource==1&&(t=this._computeReleaseLinearVelocity(o.getLinearVelocityHistory()),n=this._computeReleaseAngularVelocity(o.getAngularVelocityHistory())),s.throw(t,n),this._myThrowEmitter.notify(this,s)}this._myGrabbables=[]}this._myActiveGrabButton=null}}_onRelease(e,t){t.unregisterReleaseEventListener(this),this._myGrabbables.pp_remove(n=>n.getGrabbable()==t),this._myGrabbables.length<=0&&(this._myActiveGrabButton=null)}_updateLinearVelocityHistory(){let e=this._myGamepad.getHandPose();this._myHandLinearVelocityHistory.unshift(e.getLinearVelocity()),this._myHandLinearVelocityHistory.pop();for(let t of this._myGrabbables)t.updateLinearVelocityHistory()}_updateAngularVelocityHistory(){let e=this._myGamepad.getHandPose();this._myHandAngularVelocityHistory.unshift(e.getAngularVelocityRadians()),this._myHandAngularVelocityHistory.pop();for(let t of this._myGrabbables)t.updateAngularVelocityHistory()}_computeReleaseLinearVelocity(e){let t=e[0].vec3_length();for(let h=1;h<this._myLinearVelocityHistorySpeedAverageSamplesFromStart;h++)t+=e[h].vec3_length();t/=this._myLinearVelocityHistorySpeedAverageSamplesFromStart;let n=Math.pp_mapToRange(t,this._myThrowLinearVelocityBoostMinSpeedThreshold,this._myThrowLinearVelocityBoostMaxSpeedThreshold,0,1);n=ue.easeIn(n),t+=t*(n*this._myThrowLinearVelocityBoost),t*=this._myThrowLinearVelocityMultiplier,t=Math.pp_clamp(t,0,this._myThrowMaxLinearSpeed),this._myDebugEnabled&&r.isDebugEnabled(this.engine)&&this._debugDirectionLines(e);let s=this._myLinearVelocityHistoryDirectionAverageSamplesFromStart,a=this._myLinearVelocityHistoryDirectionAverageSkipFromStart+this._myLinearVelocityHistoryDirectionAverageSamplesFromStart,l=m();for(let h=this._myLinearVelocityHistoryDirectionAverageSkipFromStart;h<a;h++){let _=e[h];_.vec3_scale(s,_),l.vec3_add(_,l),s--}return l.vec3_normalize(l),l.vec3_scale(t,l),l}_computeReleaseAngularVelocity(e){let t=e[0],n=t.vec3_length();n=Math.pp_clamp(n*this._myThrowAngularVelocityMultiplier,0,this._myThrowMaxAngularSpeedRadians);let o=t;return o.vec3_normalize(o),o.vec3_scale(n,o),o}_debugDirectionLines(e){for(let t=this._myLinearVelocityHistoryDirectionAverageSkipFromStart+this._myLinearVelocityHistoryDirectionAverageSamplesFromStart;t>this._myLinearVelocityHistoryDirectionAverageSkipFromStart;t--){let n=t-this._myLinearVelocityHistoryDirectionAverageSkipFromStart,o=t-this._myLinearVelocityHistoryDirectionAverageSkipFromStart,s=m();for(let l=this._myLinearVelocityHistoryDirectionAverageSkipFromStart;l<o;l++){let h=e[l].pp_clone();h.vec3_scale(n,h),s.vec3_add(h,s),n--}s.vec3_normalize(s);let a=1/t;r.getDebugVisualManager(this.engine).drawLine(5,this.object.pp_getPosition(),s,.2,w(olor,a,a,1))}}_isAlreadyGrabbed(e){return this._myGrabbables.pp_find(n=>n.getGrabbable()==e)!=null}};R(bi,"TypeName","pp-grabber-hand"),R(bi,"Properties",{_myHandedness:Bt.enum(["Left","Right"],"Left"),_myGrabButton:Bt.enum(["Select","Squeeze","Both","Both Exclusive"],"Squeeze"),_mySnapOnPivot:Bt.bool(!1),_myMaxNumberOfObjects:Bt.int(1),_myThrowVelocitySource:Bt.enum(["Hand","Grabbable"],"Hand"),_myThrowLinearVelocityMultiplier:Bt.float(1),_myThrowMaxLinearSpeed:Bt.float(15),_myThrowAngularVelocityMultiplier:Bt.float(.5),_myThrowMaxAngularSpeed:Bt.float(1080),_myThrowLinearVelocityBoost:Bt.float(1.75),_myThrowLinearVelocityBoostMinSpeedThreshold:Bt.float(.6),_myThrowLinearVelocityBoostMaxSpeedThreshold:Bt.float(2.5)});var hm=class{constructor(e,t,n,o){this._myGrabbable=e,this._myUseGrabbableAsVelocitySource=t,this._myUseGrabbableAsVelocitySource&&(this._myLinearVelocityHistory=new Array(n),this._myLinearVelocityHistory.fill(m()),this._myAngularVelocityHistory=new Array(o),this._myAngularVelocityHistory.fill(m()))}getGrabbable(){return this._myGrabbable}getLinearVelocityHistory(){return this._myLinearVelocityHistory}getAngularVelocityHistory(){return this._myAngularVelocityHistory}updateLinearVelocityHistory(){this._myUseGrabbableAsVelocitySource&&(this._myLinearVelocityHistory.unshift(this._myGrabbable.getLinearVelocity()),this._myLinearVelocityHistory.pop())}updateAngularVelocityHistory(){this._myUseGrabbableAsVelocitySource&&(this._myAngularVelocityHistory.unshift(this._myGrabbable.getAngularVelocityRadians()),this._myAngularVelocityHistory.pop())}onDestroy(){this._myCollisionsCollector.destroy()}};var ce=null,qs=!1,It=!1,ot={DUMMY_NOT_INITIALIZED:0,CA_SDK_MISSING:1,SUBMIT_SCORE_FAILED:2,GET_LEADERBOARD_FAILED:3,GET_USER_FAILED:4,USER_HAS_NO_SCORE:5};function mT(i){qs=i}function yT(i){It=i}function uT(i){ce=i}function hT(){return qs}function cT(){return It}function pT(){return ce}function dT(i=r.getMainEngine()){return"casdk"in r.getWindow(i)}function _T(i=r.getMainEngine()){return r.getWindow(i).casdk}function gT(i,e,t,n,o,s,a=null,l=r.getMainEngine()){if(Te.isSDKAvailable(l)){let h=Te.getSDK(l);t?Te.getUser(function(_){let y=_.displayName;h.getLeaderboard(i,e,t,n).then(function(c){if(c.leaderboard){let d=!1;for(let g of c.leaderboard)if(g.displayName==y&&g.score!=0){d=!0;break}if(d)o&&o(c.leaderboard);else if(ce!=null&&ce.getLeaderboard!=null&&It&&a==null||a!=null&&a)Te.getLeaderboardDummy(i,e,t,n,o,s);else if(s){let g={};g.reason="Searching for around player but the user has not submitted a score yet",g.type=ot.USER_HAS_NO_SCORE,s(g,c)}}else if(ce!=null&&ce.getLeaderboard!=null&&It&&a==null||a!=null&&a)Te.getLeaderboardDummy(i,e,t,n,o,s);else if(s){let d={};d.reason="Get leaderboard failed",d.type=ot.GET_LEADERBOARD_FAILED,s(d,c)}}).catch(function(c){if(ce!=null&&ce.getLeaderboard!=null&&It&&a==null||a!=null&&a)Te.getLeaderboardDummy(i,e,t,n,o,s);else if(s){let d={};d.reason="Get leaderboard failed",d.type=ot.GET_LEADERBOARD_FAILED,s(d,c)}})},function(){if(ce!=null&&ce.getLeaderboard!=null&&It&&a==null||a!=null&&a)Te.getLeaderboardDummy(i,e,t,n,o,s);else if(s){let _={};_.reason="Searching for around player but the user can't be retrieved",_.type=ot.GET_USER_FAILED,s(_,result)}},!1,l):h.getLeaderboard(i,e,t,n).then(function(_){if(_.leaderboard)o&&o(_.leaderboard);else if(ce!=null&&ce.getLeaderboard!=null&&It&&a==null||a!=null&&a)Te.getLeaderboardDummy(i,e,t,n,o,s);else if(s){let y={};y.reason="Get leaderboard failed",y.type=ot.GET_LEADERBOARD_FAILED,s(y,_)}}).catch(function(_){if(ce!=null&&ce.getLeaderboard!=null&&It&&a==null||a!=null&&a)Te.getLeaderboardDummy(i,e,t,n,o,s);else if(s){let y={};y.reason="Get leaderboard failed",y.type=ot.GET_LEADERBOARD_FAILED,s(y,_)}})}else if(ce!=null&&ce.getLeaderboard!=null&&qs&&a==null||a!=null&&a)Te.getLeaderboardDummy(i,e,t,n,o,s);else if(s){let h={};h.reason="Construct Arcade SDK missing",h.type=ot.CA_SDK_MISSING,s(h,null)}}function fT(i,e,t,n,o,s){if(ce)ce.getLeaderboard(i,e,t,n,o,s);else if(s){let a={};a.reason="Dummy server not initialized",a.type=ot.DUMMY_NOT_INITIALIZED,s(a)}}function PT(i,e,t,n,o=null,s=r.getMainEngine()){if(Te.isSDKAvailable(s))Te.getSDK(s).submitScore(i,e).then(function(l){if(l.error){if(ce!=null&&ce.submitScore!=null&&It&&o==null||o!=null&&o)Te.submitScoreDummy(i,e,t,n);else if(n){let h={};h.reason="Submit score failed",h.type=ot.SUBMIT_SCORE_FAILED,n(h,l)}}else t()}).catch(function(l){if(ce!=null&&ce.submitScore!=null&&It&&o==null||o!=null&&o)Te.submitScoreDummy(i,e,t,n);else if(n){let h={};h.reason="Submit score failed",h.type=ot.SUBMIT_SCORE_FAILED,n(h,l)}});else if(ce!=null&&ce.submitScore!=null&&qs&&o==null||o!=null&&o)Te.submitScoreDummy(i,e,t,n);else if(n){let a={};a.reason="Construct Arcade SDK missing",a.type=ot.CA_SDK_MISSING,n(a,null)}}function CT(i,e,t,n){if(ce)ce.submitScore(i,e,t,n);else if(n){let o={};o.reason="Dummy server not initialized",o.type=ot.DUMMY_NOT_INITIALIZED,n(o)}}function TT(i,e,t=null,n=r.getMainEngine()){if(Te.isSDKAvailable(n))Te.getSDK(n).getUser().then(function(s){if(s.user)i&&i(s.user);else if(ce!=null&&ce.getUser!=null&&It&&t==null||t!=null&&t)Te.getUserDummy(i,e);else if(e){let a={};a.reason="Get user failed",a.type=ot.GET_USER_FAILED,e(a,s)}}).catch(function(s){if(ce!=null&&ce.getUser!=null&&It&&t==null||t!=null&&t)Te.getUserDummy(i,e);else if(e){let a={};a.reason="Get user failed",a.type=ot.GET_USER_FAILED,e(a,s)}});else if(ce!=null&&ce.getUser!=null&&qs&&t==null||t!=null&&t)Te.getUserDummy(i,e);else if(e){let o={};o.reason="Construct Arcade SDK missing",o.type=ot.CA_SDK_MISSING,e(o,null)}}function bT(i,e){if(ce)ce.getUser(i,e);else if(e){let t={};t.reason="Dummy server not initialized",t.type=ot.DUMMY_NOT_INITIALIZED,e(t)}}var Te={setUseDummyServerOnSDKMissing:mT,setUseDummyServerOnError:yT,setDummyServer:uT,isUseDummyServerOnSDKMissing:hT,isUseDummyServerOnError:cT,getDummyServer:pT,isSDKAvailable:dT,getSDK:_T,getLeaderboard:gT,getLeaderboardDummy:fT,submitScore:PT,submitScoreDummy:CT,getUser:TT,getUserDummy:bT};var Xs=class{constructor(e=r.getMainEngine()){this._myEngine=e}getLeaderboard(e,t,n,o,s,a){let l=null;for(Te.isSDKAvailable(this._myEngine)?l=[{rank:0,displayName:"An",score:0},{rank:1,displayName:"Error",score:0},{rank:2,displayName:"Has",score:0},{rank:3,displayName:"Occurred",score:0},{rank:4,displayName:"While",score:0},{rank:5,displayName:"Trying",score:0},{rank:6,displayName:"To",score:0},{rank:7,displayName:"Retrieve",score:0},{rank:8,displayName:"The",score:0},{rank:9,displayName:"Leaderboard",score:0}]:n?l=[{rank:0,displayName:"Sign In",score:0},{rank:1,displayName:"And",score:0},{rank:2,displayName:"Play",score:0},{rank:3,displayName:"On",score:0},{rank:4,displayName:"HeyVR",score:0},{rank:5,displayName:"To",score:0},{rank:6,displayName:"Submit",score:0},{rank:7,displayName:"Your",score:0},{rank:8,displayName:"Own",score:0},{rank:9,displayName:"Score",score:0}]:l=[{rank:0,displayName:"The",score:0},{rank:1,displayName:"Top 10",score:0},{rank:2,displayName:"Leaderboard",score:0},{rank:3,displayName:"Is",score:0},{rank:4,displayName:"Available",score:0},{rank:5,displayName:"Only",score:0},{rank:5,displayName:"When",score:0},{rank:7,displayName:"Playing",score:0},{rank:8,displayName:"On",score:0},{rank:9,displayName:"HeyVR",score:0}];l.length>o;)l.pop();s&&s(l)}submitScore(e,t,n,o){n&&n()}getUser(e,t){let n={};n.displayName="J",e&&e(n)}};import{Component as NR,Property as Yi,TextComponent as ST}from"@wonderlandengine/api";var Tn=class extends NR{init(){this._myNamesTextComponent=null,this._myScoresTextComponent=null,this._myStarted=!1,this._myDestroyed=!1}start(){this._myAddDefaultCADummyServer&&(Te.setDummyServer(new Xs),Te.setUseDummyServerOnSDKMissing(!0),Te.setUseDummyServerOnError(!0))}update(e){if(!this._myStarted){this._myStarted=!0;let t=this.object.pp_getObjectByName("Names"),n=this.object.pp_getObjectByName("Scores");t!=null&&n!=null&&(this._myNamesTextComponent=t.pp_getComponent(ST),this._myScoresTextComponent=n.pp_getComponent(ST)),this.updateLeaderboard()}}updateLeaderboard(){Te.getLeaderboard(this._myLeaderboardID,this._myAscending,this._myLocal,this._myScoresAmount,this._onLeaderboardRetrieved.bind(this),void 0,void 0,this.engine)}_onLeaderboardRetrieved(e){if(this._myDestroyed)return;let t="",n="",o=0;for(let s of e){let a=s.rank+1;a.toFixed(0).length>o&&(o=a.toFixed(0).length)}for(let s of e){let l=(s.rank+1).toFixed(0);for(;l.length<o;)l="0".concat(l);let h=`
`;for(let y=0;y<this._myNumberOfLinesBetweenScores;y++)h=h+`
`;t=t.concat(l,this._myPositionAndUsernameSeparator,s.displayName,h);let _=this._formatScore(s.score);n=n.concat(_,h)}this._myNamesTextComponent!=null&&this._myScoresTextComponent!=null&&(this._myNamesTextComponent.text=t,this._myScoresTextComponent.text=n)}_formatScore(e){let t=e.toString();return this._myScoreFormat==1?t=this._formatTime(e,!0,!0,!0):this._myScoreFormat==2?t=this._formatTime(e,!1,!0,!0):this._myScoreFormat==3?t=this._formatTime(e,!1,!1,!0):this._myScoreFormat==4?t=this._formatTime(e,!0,!0,!1):this._myScoreFormat==5&&(t=this._formatTime(e,!1,!0,!1)),t}_formatTime(e,t,n,o){let s=Math.floor(e/1e3),a=0;t&&(a=Math.floor(s/3600),s-=a*3600);let l=0;n&&(l=Math.floor(s/60),s-=l*60);let h=0;o&&(h=Math.floor(s));let _="";return o&&(_=h.toFixed(0).length<2&&(n||t)?"0".concat(h.toFixed(0)):h.toFixed(0)),n&&(_=(l.toFixed(0).length<2&&(o||t)?"0".concat(l.toFixed(0)):l.toFixed(0))+(o?":"+_:"")),t&&(_=(a.toFixed(0).length<2&&(o||n)?"0".concat(a.toFixed(0)):a.toFixed(0))+(n?":"+_:"")),_}pp_clone(e){return N.cloneDefault(this,e)}onDestroy(){this._myDestroyed=!0}};R(Tn,"TypeName","pp-ca-display-leaderboard"),R(Tn,"Properties",{_myLeaderboardID:Yi.string(""),_myLocal:Yi.bool(!1),_myAscending:Yi.bool(!1),_myScoresAmount:Yi.int(10),_myScoreFormat:Yi.enum(["Value","Hours:Minutes:Seconds","Minutes:Seconds","Seconds","Hours:Minutes","Minutes"],"Value"),_myPositionAndUsernameSeparator:Yi.string(" - "),_myNumberOfLinesBetweenScores:Yi.int(1),_myAddDefaultCADummyServer:Yi.bool(!1)});var Ks=class{constructor(){}};var Js=class{constructor(){}};import{Component as GR}from"@wonderlandengine/api";var bn=class extends GR{init(){}start(){this._myPlayerHeadController=new Ks}update(e){this._myPlayerHeadController.update(e)}getPlayerHeadController(){return this._myPlayerHeadController}};R(bn,"TypeName","pp-player-head-controller"),R(bn,"Properties",{});import{Component as UR}from"@wonderlandengine/api";var Sn=class extends UR{init(){}start(){this._myPlayerViewOcclusion=new Js}update(e){this._myPlayerViewOcclusion.update(e)}getPlayerViewOcclusion(){return this._myPlayerViewOcclusion}};R(Sn,"TypeName","pp-player-occlusion"),R(Sn,"Properties",{});var Ae=class{constructor(){this.mySplitMovementEnabled=!1,this.mySplitMovementMaxLength=0,this.mySplitMovementMaxStepsEnabled=!1,this.mySplitMovementMaxSteps=0,this.mySplitMovementStepEqualLength=!1,this.mySplitMovementStepEqualLengthMinLength=0,this.mySplitMovementStopWhenHorizontalMovementCanceled=!1,this.mySplitMovementStopWhenVerticalMovementCanceled=!1,this.mySplitMovementStopCallback=null,this.mySplitMovementStopReturnPrevious=!1,this.myRadius=0,this.myDistanceFromFeetToIgnore=0,this.myDistanceFromHeadToIgnore=0,this.myPositionOffsetLocal=m(),this.myRotationOffsetLocalQuat=z(),this.myHorizontalMovementCheckEnabled=!1,this.myHorizontalMovementStepEnabled=!1,this.myHorizontalMovementStepMaxLength=0,this.myHorizontalMovementRadialStepAmount=0,this.myHorizontalMovementCheckDiagonalOutward=!1,this.myHorizontalMovementCheckDiagonalInward=!1,this.myHorizontalMovementCheckStraight=!1,this.myHorizontalMovementCheckHorizontalBorder=!1,this.myHorizontalMovementCheckVerticalStraight=!1,this.myHorizontalMovementCheckVerticalDiagonalUpwardOutward=!1,this.myHorizontalMovementCheckVerticalDiagonalUpwardInward=!1,this.myHorizontalMovementCheckVerticalDiagonalDownwardOutward=!1,this.myHorizontalMovementCheckVerticalDiagonalDownwardInward=!1,this.myHorizontalMovementCheckVerticalStraightDiagonalUpward=!1,this.myHorizontalMovementCheckVerticalStraightDiagonalDownward=!1,this.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward=!1,this.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward=!1,this.myHorizontalMovementHorizontalStraightCentralCheckEnabled=!1,this.myHorizontalMovementVerticalStraightCentralCheckEnabled=!1,this.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=!1,this.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled=!1,this.myHorizontalPositionCheckEnabled=!1,this.myHalfConeAngle=0,this.myHalfConeSliceAmount=0,this.myCheckConeBorder=!1,this.myCheckConeRay=!1,this.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision=!0,this.myHorizontalPositionCheckVerticalDirectionType=0,this.myCheckHorizontalFixedForwardEnabled=!1,this.myCheckHorizontalFixedForward=m(),this.myVerticalMovementCheckEnabled=!1,this.myVerticalPositionCheckEnabled=!1,this.myFeetRadius=0,this.myAdjustVerticalMovementWithGroundAngleDownhill=!1,this.myAdjustVerticalMovementWithGroundAngleUphill=!1,this.myAdjustVerticalMovementWithGroundAngleDownhillMaxAngle=null,this.myAdjustVerticalMovementWithGroundAngleUphillMaxAngle=null,this.myAdjustVerticalMovementWithGroundAngleDownhillMaxPerceivedAngle=null,this.myAdjustVerticalMovementWithGroundAngleUphillMaxPerceivedAngle=null,this.myAdjustHorizontalMovementWithGroundAngleDownhill=!1,this.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle=null,this.myAdjustVerticalMovementWithCeilingAngleDownhill=!1,this.myAdjustVerticalMovementWithCeilingAngleUphill=!1,this.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle=null,this.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle=null,this.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle=null,this.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle=null,this.myAdjustHorizontalMovementWithCeilingAngleDownhill=!1,this.myAdjustHorizontalMovementWithCeilingAngleDownhillMinAngle=null,this.myCheckVerticalFixedForwardEnabled=!1,this.myCheckVerticalFixedForward=m(),this.myCheckVerticalBothDirection=!1,this.mySnapOnGroundEnabled=!1,this.mySnapOnGroundExtraDistance=0,this.mySnapOnCeilingEnabled=!1,this.mySnapOnCeilingExtraDistance=0,this.myGroundPopOutEnabled=!1,this.myGroundPopOutExtraDistance=0,this.myCeilingPopOutEnabled=!1,this.myCeilingPopOutExtraDistance=0,this.myVerticalMovementReduceEnabled=!1,this.myGroundCircumferenceAddCenter=!1,this.myGroundCircumferenceSliceAmount=0,this.myGroundCircumferenceStepAmount=0,this.myGroundCircumferenceRotationPerStep=0,this.myVerticalAllowHitInsideCollisionIfOneOk=!1,this.myCheckHeight=!1,this.myCheckHeightVerticalMovement=!1,this.myCheckHeightVerticalPosition=!1,this.myCheckHeightTopMovement=!1,this.myCheckHeightTopPosition=!1,this.myCheckHeightConeOnCollision=!1,this.myCheckHeightConeOnCollisionKeepHit=!1,this.myHeightCheckStepAmountMovement=0,this.myHeightCheckStepAmountPosition=0,this.myCheckVerticalStraight=!1,this.myCheckVerticalDiagonalRayOutward=!1,this.myCheckVerticalDiagonalRayInward=!1,this.myCheckVerticalDiagonalBorderOutward=!1,this.myCheckVerticalDiagonalBorderInward=!1,this.myCheckVerticalDiagonalBorderRayOutward=!1,this.myCheckVerticalDiagonalBorderRayInward=!1,this.myCheckVerticalSearchFartherVerticalHit=!1,this.myGroundAngleToIgnore=0,this.myGroundAngleToIgnoreWithPerceivedAngle=null,this.myCeilingAngleToIgnore=0,this.myCeilingAngleToIgnoreWithPerceivedAngle=null,this.myHorizontalMovementGroundAngleIgnoreHeight=null,this.myHorizontalMovementCeilingAngleIgnoreHeight=null,this.myHorizontalPositionGroundAngleIgnoreHeight=null,this.myHorizontalPositionCeilingAngleIgnoreHeight=null,this.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft=null,this.myHorizontalMovementCeilingAngleIgnoreMaxMovementLeft=null,this.myHeight=0,this.myComputeGroundInfoEnabled=!1,this.myComputeCeilingInfoEnabled=!1,this.myDistanceToBeOnGround=0,this.myDistanceToComputeGroundInfo=0,this.myDistanceToBeOnCeiling=0,this.myDistanceToComputeCeilingInfo=0,this.myVerticalFixToBeOnGround=0,this.myVerticalFixToComputeGroundInfo=0,this.myVerticalFixToBeOnCeiling=0,this.myVerticalFixToComputeCeilingInfo=0,this.myGroundIsBaseInsideCollisionCheckEnabled=!1,this.myCeilingIsBaseInsideCollisionCheckEnabled=!1,this.myIsOnGroundIfInsideHit=!1,this.myIsOnCeilingIfInsideHit=!1,this.myIsOnGroundMaxSurfaceAngle=null,this.myIsOnCeilingMaxSurfaceAngle=null,this.myFindGroundDistanceMaxOutsideDistance=0,this.myFindGroundDistanceMaxInsideDistance=0,this.myFindCeilingDistanceMaxOutsideDistance=0,this.myFindCeilingDistanceMaxInsideDistance=0,this.myAllowGroundSteepFix=!1,this.myAllowCeilingSteepFix=!1,this.myMustStayOnGround=!1,this.myMustStayOnCeiling=!1,this.myMustStayOnValidGroundAngleDownhill=!1,this.myMustStayOnValidCeilingAngleDownhill=!1,this.myRegatherGroundInfoOnSurfaceCheckFail=!1,this.myRegatherCeilingInfoOnSurfaceCheckFail=!1,this.myMustStayBelowIgnorableGroundAngleDownhill=!1,this.myMustStayBelowIgnorableCeilingAngleDownhill=!1,this.myMustStayBelowGroundAngleDownhill=null,this.myMustStayBelowCeilingAngleDownhill=null,this.myMovementMustStayOnGroundHitAngle=null,this.myMovementMustStayOnCeilingHitAngle=null,this.myTeleportMustBeOnIgnorableGroundAngle=!1,this.myCheckTransformMustBeOnIgnorableGroundAngle=!1,this.myTeleportMustBeOnIgnorableCeilingAngle=!1,this.myCheckTransformMustBeOnIgnorableCeilingAngle=!1,this.myTeleportMustBeOnGroundAngle=null,this.myCheckTransformMustBeOnGroundAngle=null,this.myTeleportMustBeOnCeilingAngle=null,this.myCheckTransformMustBeOnCeilingAngle=null,this.myTeleportMustBeOnGround=!1,this.myCheckTransformMustBeOnGround=!1,this.myTeleportMustBeOnCeiling=!1,this.myCheckTransformMustBeOnCeiling=!1,this.mySlidingEnabled=!1,this.mySlidingHorizontalMovementCheckBetterNormal=!1,this.mySlidingMaxAttempts=0,this.mySlidingCheckBothDirections=!1,this.mySlidingFlickeringPreventionType=0,this.mySlidingFlickeringPreventionCheckOnlyIfAlreadySliding=!1,this.mySlidingFlickerPreventionCheckAnywayCounter=0,this.mySlidingAdjustSign90Degrees=!1,this.myHorizontalBlockLayerFlags=new Re,this.myHorizontalObjectsToIgnore=[],this.myVerticalBlockLayerFlags=new Re,this.myVerticalObjectsToIgnore=[],this.myExtraMovementCheckCallback=null,this.myExtraTeleportCheckCallback=null,this.myExtraCheckTransformCheckCallback=null,this.myDebugEnabled=!1,this.myDebugHorizontalMovementEnabled=!1,this.myDebugHorizontalPositionEnabled=!1,this.myDebugVerticalMovementEnabled=!1,this.myDebugVerticalPositionEnabled=!1,this.myDebugSlidingEnabled=!1,this.myDebugGroundInfoEnabled=!1,this.myDebugCeilingInfoEnabled=!1,this.myDebugRuntimeParamsEnabled=!1,this.myDebugMovementEnabled=!1}copy(e){this.mySplitMovementEnabled=e.mySplitMovementEnabled,this.mySplitMovementMaxLength=e.mySplitMovementMaxLength,this.mySplitMovementMaxStepsEnabled=e.mySplitMovementMaxStepsEnabled,this.mySplitMovementMaxSteps=e.mySplitMovementMaxSteps,this.mySplitMovementStepEqualLength=e.mySplitMovementStepEqualLength,this.mySplitMovementStepEqualLengthMinLength=e.mySplitMovementStepEqualLengthMinLength,this.mySplitMovementStopWhenHorizontalMovementCanceled=e.mySplitMovementStopWhenHorizontalMovementCanceled,this.mySplitMovementStopWhenVerticalMovementCanceled=e.mySplitMovementStopWhenVerticalMovementCanceled,this.mySplitMovementStopCallback=e.mySplitMovementStopCallback,this.mySplitMovementStopReturnPrevious=e.mySplitMovementStopReturnPrevious,this.myRadius=e.myRadius,this.myDistanceFromFeetToIgnore=e.myDistanceFromFeetToIgnore,this.myDistanceFromHeadToIgnore=e.myDistanceFromHeadToIgnore,this.myPositionOffsetLocal.vec3_copy(e.myPositionOffsetLocal),this.myRotationOffsetLocalQuat.quat_copy(e.myRotationOffsetLocalQuat),this.myHorizontalMovementCheckEnabled=e.myHorizontalMovementCheckEnabled,this.myHorizontalMovementStepEnabled=e.myHorizontalMovementStepEnabled,this.myHorizontalMovementStepMaxLength=e.myHorizontalMovementStepMaxLength,this.myHorizontalMovementRadialStepAmount=e.myHorizontalMovementRadialStepAmount,this.myHorizontalMovementCheckDiagonalOutward=e.myHorizontalMovementCheckDiagonalOutward,this.myHorizontalMovementCheckDiagonalInward=e.myHorizontalMovementCheckDiagonalInward,this.myHorizontalMovementCheckStraight=e.myHorizontalMovementCheckStraight,this.myHorizontalMovementCheckHorizontalBorder=e.myHorizontalMovementCheckHorizontalBorder,this.myHorizontalMovementCheckVerticalStraight=e.myHorizontalMovementCheckVerticalStraight,this.myHorizontalMovementCheckVerticalDiagonalUpwardOutward=e.myHorizontalMovementCheckVerticalDiagonalUpwardOutward,this.myHorizontalMovementCheckVerticalDiagonalUpwardInward=e.myHorizontalMovementCheckVerticalDiagonalUpwardInward,this.myHorizontalMovementCheckVerticalDiagonalDownwardOutward=e.myHorizontalMovementCheckVerticalDiagonalDownwardOutward,this.myHorizontalMovementCheckVerticalDiagonalDownwardInward=e.myHorizontalMovementCheckVerticalDiagonalDownwardInward,this.myHorizontalMovementCheckVerticalStraightDiagonalUpward=e.myHorizontalMovementCheckVerticalStraightDiagonalUpward,this.myHorizontalMovementCheckVerticalStraightDiagonalDownward=e.myHorizontalMovementCheckVerticalStraightDiagonalDownward,this.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward=e.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward,this.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward=e.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward,this.myHorizontalMovementHorizontalStraightCentralCheckEnabled=e.myHorizontalMovementHorizontalStraightCentralCheckEnabled,this.myHorizontalMovementVerticalStraightCentralCheckEnabled=e.myHorizontalMovementVerticalStraightCentralCheckEnabled,this.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=e.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled,this.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled=e.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled,this.myHorizontalPositionCheckEnabled=e.myHorizontalPositionCheckEnabled,this.myHalfConeAngle=e.myHalfConeAngle,this.myHalfConeSliceAmount=e.myHalfConeSliceAmount,this.myCheckConeBorder=e.myCheckConeBorder,this.myCheckConeRay=e.myCheckConeRay,this.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision=e.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision,this.myHorizontalPositionCheckVerticalDirectionType=e.myHorizontalPositionCheckVerticalDirectionType,this.myVerticalMovementCheckEnabled=e.myVerticalMovementCheckEnabled,this.myVerticalPositionCheckEnabled=e.myVerticalPositionCheckEnabled,this.myFeetRadius=e.myFeetRadius,this.myAdjustVerticalMovementWithGroundAngleDownhill=e.myAdjustVerticalMovementWithGroundAngleDownhill,this.myAdjustVerticalMovementWithGroundAngleUphill=e.myAdjustVerticalMovementWithGroundAngleUphill,this.myAdjustVerticalMovementWithGroundAngleDownhillMaxAngle=e.myAdjustVerticalMovementWithGroundAngleDownhillMaxAngle,this.myAdjustVerticalMovementWithGroundAngleUphillMaxAngle=e.myAdjustVerticalMovementWithGroundAngleUphillMaxAngle,this.myAdjustVerticalMovementWithGroundAngleDownhillMaxPerceivedAngle=e.myAdjustVerticalMovementWithGroundAngleDownhillMaxPerceivedAngle,this.myAdjustVerticalMovementWithGroundAngleUphillMaxPerceivedAngle=e.myAdjustVerticalMovementWithGroundAngleUphillMaxPerceivedAngle,this.myAdjustHorizontalMovementWithGroundAngleDownhill=e.myAdjustHorizontalMovementWithGroundAngleDownhill,this.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle=e.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle,this.myAdjustVerticalMovementWithCeilingAngleDownhill=e.myAdjustVerticalMovementWithCeilingAngleDownhill,this.myAdjustVerticalMovementWithCeilingAngleUphill=e.myAdjustVerticalMovementWithCeilingAngleUphill,this.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle=e.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle,this.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle=e.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle,this.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle=e.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle,this.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle=e.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle,this.myAdjustHorizontalMovementWithCeilingAngleDownhill=e.myAdjustHorizontalMovementWithCeilingAngleDownhill,this.myAdjustHorizontalMovementWithCeilingAngleDownhillMinAngle=e.myAdjustHorizontalMovementWithCeilingAngleDownhillMinAngle,this.myCheckVerticalFixedForwardEnabled=e.myCheckVerticalFixedForwardEnabled,this.myCheckVerticalFixedForward.vec3_copy(e.myCheckVerticalFixedForward),this.myCheckVerticalBothDirection=e.myCheckVerticalBothDirection,this.mySnapOnGroundEnabled=e.mySnapOnGroundEnabled,this.mySnapOnGroundExtraDistance=e.mySnapOnGroundExtraDistance,this.mySnapOnCeilingEnabled=e.mySnapOnCeilingEnabled,this.mySnapOnCeilingExtraDistance=e.mySnapOnCeilingExtraDistance,this.myGroundPopOutEnabled=e.myGroundPopOutEnabled,this.myGroundPopOutExtraDistance=e.myGroundPopOutExtraDistance,this.myCeilingPopOutEnabled=e.myCeilingPopOutEnabled,this.myCeilingPopOutExtraDistance=e.myCeilingPopOutExtraDistance,this.myVerticalMovementReduceEnabled=e.myVerticalMovementReduceEnabled,this.myGroundCircumferenceAddCenter=e.myGroundCircumferenceAddCenter,this.myGroundCircumferenceSliceAmount=e.myGroundCircumferenceSliceAmount,this.myGroundCircumferenceStepAmount=e.myGroundCircumferenceStepAmount,this.myGroundCircumferenceRotationPerStep=e.myGroundCircumferenceRotationPerStep,this.myVerticalAllowHitInsideCollisionIfOneOk=e.myVerticalAllowHitInsideCollisionIfOneOk,this.myCheckHeight=e.myCheckHeight,this.myCheckHeightVerticalMovement=e.myCheckHeightVerticalMovement,this.myCheckHeightVerticalPosition=e.myCheckHeightVerticalPosition,this.myCheckHeightTopMovement=e.myCheckHeightTopMovement,this.myCheckHeightTopPosition=e.myCheckHeightTopPosition,this.myCheckHeightConeOnCollision=e.myCheckHeightConeOnCollision,this.myCheckHeightConeOnCollisionKeepHit=e.myCheckHeightConeOnCollisionKeepHit,this.myHeightCheckStepAmountMovement=e.myHeightCheckStepAmountMovement,this.myHeightCheckStepAmountPosition=e.myHeightCheckStepAmountPosition,this.myCheckVerticalStraight=e.myCheckVerticalStraight,this.myCheckVerticalDiagonalRayOutward=e.myCheckVerticalDiagonalRayOutward,this.myCheckVerticalDiagonalRayInward=e.myCheckVerticalDiagonalRayInward,this.myCheckVerticalDiagonalBorderOutward=e.myCheckVerticalDiagonalBorderOutward,this.myCheckVerticalDiagonalBorderInward=e.myCheckVerticalDiagonalBorderInward,this.myCheckVerticalDiagonalBorderRayOutward=e.myCheckVerticalDiagonalBorderRayOutward,this.myCheckVerticalDiagonalBorderRayInward=e.myCheckVerticalDiagonalBorderRayInward,this.myCheckVerticalSearchFartherVerticalHit=e.myCheckVerticalSearchFartherVerticalHit,this.myGroundAngleToIgnore=e.myGroundAngleToIgnore,this.myGroundAngleToIgnoreWithPerceivedAngle=e.myGroundAngleToIgnoreWithPerceivedAngle,this.myCeilingAngleToIgnore=e.myCeilingAngleToIgnore,this.myCeilingAngleToIgnoreWithPerceivedAngle=e.myCeilingAngleToIgnoreWithPerceivedAngle,this.myHorizontalMovementGroundAngleIgnoreHeight=e.myHorizontalMovementGroundAngleIgnoreHeight,this.myHorizontalMovementCeilingAngleIgnoreHeight=e.myHorizontalMovementCeilingAngleIgnoreHeight,this.myHorizontalPositionGroundAngleIgnoreHeight=e.myHorizontalPositionGroundAngleIgnoreHeight,this.myHorizontalPositionCeilingAngleIgnoreHeight=e.myHorizontalPositionCeilingAngleIgnoreHeight,this.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft=e.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft,this.myHorizontalMovementCeilingAngleIgnoreMaxMovementLeft=e.myHorizontalMovementCeilingAngleIgnoreMaxMovementLeft,this.myHeight=e.myHeight,this.myComputeGroundInfoEnabled=e.myComputeGroundInfoEnabled,this.myComputeCeilingInfoEnabled=e.myComputeCeilingInfoEnabled,this.myDistanceToBeOnGround=e.myDistanceToBeOnGround,this.myDistanceToComputeGroundInfo=e.myDistanceToComputeGroundInfo,this.myDistanceToBeOnCeiling=e.myDistanceToBeOnCeiling,this.myDistanceToComputeCeilingInfo=e.myDistanceToComputeCeilingInfo,this.myVerticalFixToBeOnGround=e.myVerticalFixToBeOnGround,this.myVerticalFixToComputeGroundInfo=e.myVerticalFixToComputeGroundInfo,this.myVerticalFixToBeOnCeiling=e.myVerticalFixToBeOnCeiling,this.myVerticalFixToComputeCeilingInfo=e.myVerticalFixToComputeCeilingInfo,this.myGroundIsBaseInsideCollisionCheckEnabled=e.myGroundIsBaseInsideCollisionCheckEnabled,this.myCeilingIsBaseInsideCollisionCheckEnabled=e.myCeilingIsBaseInsideCollisionCheckEnabled,this.myIsOnGroundIfInsideHit=e.myIsOnGroundIfInsideHit,this.myIsOnCeilingIfInsideHit=e.myIsOnCeilingIfInsideHit,this.myIsOnGroundMaxSurfaceAngle=e.myIsOnGroundMaxSurfaceAngle,this.myIsOnCeilingMaxSurfaceAngle=e.myIsOnCeilingMaxSurfaceAngle,this.myFindGroundDistanceMaxOutsideDistance=e.myFindGroundDistanceMaxOutsideDistance,this.myFindGroundDistanceMaxInsideDistance=e.myFindGroundDistanceMaxInsideDistance,this.myFindCeilingDistanceMaxOutsideDistance=e.myFindCeilingDistanceMaxOutsideDistance,this.myFindCeilingDistanceMaxInsideDistance=e.myFindCeilingDistanceMaxInsideDistance,this.myAllowGroundSteepFix=e.myAllowGroundSteepFix,this.myAllowCeilingSteepFix=e.myAllowCeilingSteepFix,this.myMustStayOnGround=e.myMustStayOnGround,this.myMustStayOnCeiling=e.myMustStayOnCeiling,this.myMustStayOnValidGroundAngleDownhill=e.myMustStayOnValidGroundAngleDownhill,this.myMustStayOnValidCeilingAngleDownhill=e.myMustStayOnValidCeilingAngleDownhill,this.myRegatherGroundInfoOnSurfaceCheckFail=e.myRegatherGroundInfoOnSurfaceCheckFail,this.myRegatherCeilingInfoOnSurfaceCheckFail=e.myRegatherCeilingInfoOnSurfaceCheckFail,this.myMustStayBelowGroundAngleDownhill=e.myMustStayBelowGroundAngleDownhill,this.myMustStayBelowCeilingAngleDownhill=e.myMustStayBelowCeilingAngleDownhill,this.myMustStayBelowIgnorableGroundAngleDownhill=e.myMustStayBelowIgnorableGroundAngleDownhill,this.myMustStayBelowIgnorableCeilingAngleDownhill=e.myMustStayBelowIgnorableCeilingAngleDownhill,this.myMovementMustStayOnGroundHitAngle=e.myMovementMustStayOnGroundHitAngle,this.myMovementMustStayOnCeilingHitAngle=e.myMovementMustStayOnCeilingHitAngle,this.myTeleportMustBeOnIgnorableGroundAngle=e.myTeleportMustBeOnIgnorableGroundAngle,this.myCheckTransformMustBeOnIgnorableGroundAngle=e.myCheckTransformMustBeOnIgnorableGroundAngle,this.myTeleportMustBeOnIgnorableCeilingAngle=e.myTeleportMustBeOnIgnorableCeilingAngle,this.myCheckTransformMustBeOnIgnorableCeilingAngle=e.myCheckTransformMustBeOnIgnorableCeilingAngle,this.myTeleportMustBeOnGroundAngle=e.myTeleportMustBeOnGroundAngle,this.myCheckTransformMustBeOnGroundAngle=e.myCheckTransformMustBeOnGroundAngle,this.myTeleportMustBeOnCeilingAngle=e.myTeleportMustBeOnCeilingAngle,this.myCheckTransformMustBeOnCeilingAngle=e.myCheckTransformMustBeOnCeilingAngle,this.myTeleportMustBeOnGround=e.myTeleportMustBeOnGround,this.myCheckTransformMustBeOnGround=e.myCheckTransformMustBeOnGround,this.myTeleportMustBeOnCeiling=e.myTeleportMustBeOnCeiling,this.myCheckTransformMustBeOnCeiling=e.myCheckTransformMustBeOnCeiling,this.mySlidingEnabled=e.mySlidingEnabled,this.mySlidingHorizontalMovementCheckBetterNormal=e.mySlidingHorizontalMovementCheckBetterNormal,this.mySlidingMaxAttempts=e.mySlidingMaxAttempts,this.mySlidingCheckBothDirections=e.mySlidingCheckBothDirections,this.mySlidingFlickeringPreventionType=e.mySlidingFlickeringPreventionType,this.mySlidingFlickeringPreventionCheckOnlyIfAlreadySliding=e.mySlidingFlickeringPreventionCheckOnlyIfAlreadySliding,this.mySlidingFlickerPreventionCheckAnywayCounter=e.mySlidingFlickerPreventionCheckAnywayCounter,this.mySlidingAdjustSign90Degrees=e.mySlidingAdjustSign90Degrees,this.myHorizontalBlockLayerFlags.copy(e.myHorizontalBlockLayerFlags),this.myHorizontalObjectsToIgnore.pp_copy(e.myHorizontalObjectsToIgnore),this.myVerticalBlockLayerFlags.copy(e.myVerticalBlockLayerFlags),this.myVerticalObjectsToIgnore.pp_copy(e.myVerticalObjectsToIgnore),this.myExtraMovementCheckCallback=e.myExtraMovementCheckCallback,this.myExtraTeleportCheckCallback=e.myExtraTeleportCheckCallback,this.myExtraCheckTransformCheckCallback=e.myExtraCheckTransformCheckCallback,this.myDebugEnabled=e.myDebugEnabled,this.myDebugHorizontalMovementEnabled=e.myDebugHorizontalMovementEnabled,this.myDebugHorizontalPositionEnabled=e.myDebugHorizontalPositionEnabled,this.myDebugVerticalMovementEnabled=e.myDebugVerticalMovementEnabled,this.myDebugVerticalPositionEnabled=e.myDebugVerticalPositionEnabled,this.myDebugSlidingEnabled=e.myDebugSlidingEnabled,this.myDebugGroundInfoEnabled=e.myDebugGroundInfoEnabled,this.myDebugCeilingInfoEnabled=e.myDebugCeilingInfoEnabled,this.myDebugRuntimeParamsEnabled=e.myDebugRuntimeParamsEnabled,this.myDebugMovementEnabled=e.myDebugMovementEnabled}},re=class{constructor(){this.myOriginalPosition=m(),this.myNewPosition=m(),this.myOriginalHeight=0,this.myOriginalForward=m(),this.myOriginalUp=m(),this.myOriginalMovement=m(),this.myFixedMovement=m(),this.myLastValidOriginalHorizontalMovement=m(),this.myLastValidOriginalVerticalMovement=m(),this.myLastValidSurfaceAdjustedHorizontalMovement=m(),this.myLastValidSurfaceAdjustedVerticalMovement=m(),this.myLastValidEndHorizontalMovement=m(),this.myLastValidEndVerticalMovement=m(),this.myIsOnGround=!1,this.myGroundAngle=0,this.myGroundPerceivedAngle=0,this.myGroundNormal=m(),this.myGroundHitMaxAngle=0,this.myGroundHitMaxNormal=m(),this.myGroundDistance=null,this.myGroundIsBaseInsideCollision=!1,this.myIsOnCeiling=!1,this.myCeilingAngle=0,this.myCeilingPerceivedAngle=0,this.myCeilingNormal=m(),this.myCeilingHitMaxAngle=0,this.myCeilingHitMaxNormal=m(),this.myCeilingDistance=null,this.myCeilingIsBaseInsideCollision=!1,this.myHorizontalMovementCanceled=!1,this.myIsCollidingHorizontally=!1,this.myHorizontalCollisionHit=new lt,this.myVerticalMovementCanceled=!1,this.myIsCollidingVertically=!1,this.myVerticalCollisionHit=new lt,this.myHasSnappedOnGround=!1,this.myHasSnappedOnCeiling=!1,this.myHasPoppedOutGround=!1,this.myHasPoppedOutCeiling=!1,this.myHasReducedVerticalMovement=!1,this.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleDownhill=!1,this.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleUphill=!1,this.myVerticalMovementHasAdjustedHorizontalMovementBasedOnGroundAngleDownhill=!1,this.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleDownhill=!1,this.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleUphill=!1,this.myVerticalMovementHasAdjustedHorizontalMovementBasedOnCeilingAngleDownhill=!1,this.myIsSliding=!1,this.myIsSlidingIntoOppositeDirection=!1,this.myIsSlidingFlickerPrevented=!1,this.mySlidingFlickerPreventionCheckAnywayCounter=0,this.mySlidingMovementAngle=0,this.mySlidingCollisionAngle=0,this.mySlidingCollisionHit=new lt,this.mySlidingWallNormal=new m,this.mySliding90DegreesSign=0,this.mySlidingRecompute90DegreesSign=!0,this.myLastValidIsSliding=!1,this.mySlidingPreviousHorizontalMovement=m(),this.myOriginalTeleportPosition=m(),this.myFixedTeleportPosition=m(),this.myOriginalPositionCheckPosition=m(),this.myFixedPositionCheckPosition=m(),this.myTeleportCanceled=!1,this.myIsPositionOk=!1,this.myIsTeleport=!1,this.myIsMove=!1,this.myIsPositionCheck=!1,this.myIsPositionCheckAllowAdjustments=!1,this.mySplitMovementSteps=0,this.mySplitMovementStepsPerformed=0,this.mySplitMovementStop=!1,this.mySplitMovementMovementChecked=m(),this.myRealIsOnGround=!1,this.myRealIsOnCeiling=!1}reset(){this.myOriginalPosition.vec3_zero(),this.myNewPosition.vec3_zero(),this.myOriginalHeight=0,this.myOriginalForward.vec3_zero(),this.myOriginalUp.vec3_zero(),this.myOriginalMovement.vec3_zero(),this.myFixedMovement.vec3_zero(),this.myLastValidOriginalHorizontalMovement.vec3_zero(),this.myLastValidOriginalVerticalMovement.vec3_zero(),this.myLastValidSurfaceAdjustedHorizontalMovement.vec3_zero(),this.myLastValidSurfaceAdjustedVerticalMovement.vec3_zero(),this.myLastValidEndHorizontalMovement.vec3_zero(),this.myLastValidEndVerticalMovement.vec3_zero(),this.myIsOnGround=!1,this.myGroundAngle=0,this.myGroundPerceivedAngle=0,this.myGroundNormal.vec3_zero(),this.myGroundHitMaxAngle=0,this.myGroundHitMaxNormal.vec3_zero(),this.myGroundDistance=null,this.myGroundIsBaseInsideCollision=!1,this.myIsOnCeiling=!1,this.myCeilingAngle=0,this.myCeilingPerceivedAngle=0,this.myCeilingNormal.vec3_zero(),this.myCeilingHitMaxAngle=0,this.myCeilingHitMaxNormal.vec3_zero(),this.myCeilingDistance=null,this.myCeilingIsBaseInsideCollision=!1,this.myHorizontalMovementCanceled=!1,this.myIsCollidingHorizontally=!1,this.myHorizontalCollisionHit.reset(),this.myVerticalMovementCanceled=!1,this.myIsCollidingVertically=!1,this.myVerticalCollisionHit.reset(),this.myHasSnappedOnGround=!1,this.myHasSnappedOnCeiling=!1,this.myHasPoppedOutGround=!1,this.myHasPoppedOutCeiling=!1,this.myHasReducedVerticalMovement=!1,this.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleDownhill=!1,this.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleUphill=!1,this.myVerticalMovementHasAdjustedHorizontalMovementBasedOnGroundAngleDownhill=!1,this.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleDownhill=!1,this.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleUphill=!1,this.myVerticalMovementHasAdjustedHorizontalMovementBasedOnCeilingAngleDownhill=!1,this.myIsSliding=!1,this.myIsSlidingIntoOppositeDirection=!1,this.myIsSlidingFlickerPrevented=!1,this.mySlidingFlickerPreventionCheckAnywayCounter=0,this.mySlidingMovementAngle=0,this.mySlidingCollisionAngle=0,this.mySlidingCollisionHit.reset(),this.mySliding90DegreesSign=0,this.mySlidingRecompute90DegreesSign=!0,this.myLastValidIsSliding=!1,this.mySlidingPreviousHorizontalMovement.vec3_zero(),this.mySlidingWallNormal.vec3_zero(),this.myOriginalTeleportPosition.vec3_zero(),this.myFixedTeleportPosition.vec3_zero(),this.myOriginalPositionCheckPosition.vec3_zero(),this.myFixedPositionCheckPosition.vec3_zero(),this.myTeleportCanceled=!1,this.myIsPositionOk=!1,this.myIsTeleport=!1,this.myIsMove=!1,this.myIsPositionCheck=!1,this.myIsPositionCheckAllowAdjustments=!1,this.mySplitMovementSteps=0,this.mySplitMovementStepsPerformed=0,this.mySplitMovementStop=!1,this.mySplitMovementMovementChecked.vec3_zero(),this.myRealIsOnGround=!1,this.myRealIsOnCeiling=!1}copy(e){this.myOriginalPosition.vec3_copy(e.myOriginalPosition),this.myNewPosition.vec3_copy(e.myNewPosition),this.myOriginalHeight=e.myOriginalHeight,this.myOriginalForward.vec3_copy(e.myOriginalForward),this.myOriginalUp.vec3_copy(e.myOriginalUp),this.myOriginalMovement.vec3_copy(e.myOriginalMovement),this.myFixedMovement.vec3_copy(e.myFixedMovement),this.myLastValidOriginalHorizontalMovement.vec3_copy(e.myLastValidOriginalHorizontalMovement),this.myLastValidOriginalVerticalMovement.vec3_copy(e.myLastValidOriginalVerticalMovement),this.myLastValidSurfaceAdjustedHorizontalMovement.vec3_copy(e.myLastValidSurfaceAdjustedHorizontalMovement),this.myLastValidSurfaceAdjustedVerticalMovement.vec3_copy(e.myLastValidSurfaceAdjustedVerticalMovement),this.myLastValidEndHorizontalMovement.vec3_copy(e.myLastValidEndHorizontalMovement),this.myLastValidEndVerticalMovement.vec3_copy(e.myLastValidEndVerticalMovement),this.myIsOnGround=e.myIsOnGround,this.myGroundAngle=e.myGroundAngle,this.myGroundPerceivedAngle=e.myGroundPerceivedAngle,this.myGroundNormal.vec3_copy(e.myGroundNormal),this.myGroundHitMaxAngle=e.myGroundHitMaxAngle,this.myGroundHitMaxNormal.vec3_copy(e.myGroundHitMaxNormal),this.myGroundDistance=e.myGroundDistance,this.myGroundIsBaseInsideCollision=e.myGroundIsBaseInsideCollision,this.myIsOnCeiling=e.myIsOnCeiling,this.myCeilingAngle=e.myCeilingAngle,this.myCeilingPerceivedAngle=e.myCeilingPerceivedAngle,this.myCeilingNormal.vec3_copy(e.myCeilingNormal),this.myCeilingHitMaxAngle=e.myCeilingHitMaxAngle,this.myCeilingHitMaxNormal.vec3_copy(e.myCeilingHitMaxNormal),this.myCeilingDistance=e.myCeilingDistance,this.myCeilingIsBaseInsideCollision=e.myCeilingIsBaseInsideCollision,this.myHorizontalMovementCanceled=e.myHorizontalMovementCanceled,this.myIsCollidingHorizontally=e.myIsCollidingHorizontally,this.myHorizontalCollisionHit.copy(e.myHorizontalCollisionHit),this.myVerticalMovementCanceled=e.myVerticalMovementCanceled,this.myIsCollidingVertically=e.myIsCollidingVertically,this.myVerticalCollisionHit.copy(e.myVerticalCollisionHit),this.myHasSnappedOnGround=e.myHasSnappedOnGround,this.myHasSnappedOnCeiling=e.myHasSnappedOnCeiling,this.myHasPoppedOutGround=e.myHasPoppedOutGround,this.myHasPoppedOutCeiling=e.myHasPoppedOutCeiling,this.myHasReducedVerticalMovement=e.myHasReducedVerticalMovement,this.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleDownhill=e.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleDownhill,this.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleUphill=e.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleUphill,this.myVerticalMovementHasAdjustedHorizontalMovementBasedOnGroundAngleDownhill=e.myVerticalMovementHasAdjustedHorizontalMovementBasedOnGroundAngleDownhill,this.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleDownhill=e.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleDownhill,this.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleUphill=e.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleUphill,this.myVerticalMovementHasAdjustedHorizontalMovementBasedOnCeilingAngleDownhill=e.myVerticalMovementHasAdjustedHorizontalMovementBasedOnCeilingAngleDownhill,this.myIsSliding=e.myIsSliding,this.myIsSlidingIntoOppositeDirection=e.myIsSlidingIntoOppositeDirection,this.myIsSlidingFlickerPrevented=e.myIsSlidingFlickerPrevented,this.mySlidingFlickerPreventionCheckAnywayCounter=e.mySlidingFlickerPreventionCheckAnywayCounter,this.mySlidingMovementAngle=e.mySlidingMovementAngle,this.mySlidingCollisionAngle=e.mySlidingCollisionAngle,this.mySlidingCollisionHit.copy(e.mySlidingCollisionHit),this.mySliding90DegreesSign=e.mySliding90DegreesSign,this.mySlidingRecompute90DegreesSign=e.mySlidingRecompute90DegreesSign,this.myLastValidIsSliding=e.myLastValidIsSliding,this.mySlidingPreviousHorizontalMovement.vec3_copy(e.mySlidingPreviousHorizontalMovement),this.mySlidingWallNormal.vec3_copy(e.mySlidingWallNormal),this.myOriginalTeleportPosition.vec3_copy(e.myOriginalTeleportPosition),this.myFixedTeleportPosition.vec3_copy(e.myFixedTeleportPosition),this.myTeleportCanceled=e.myTeleportCanceled,this.myIsPositionOk=e.myIsPositionOk,this.myOriginalPositionCheckPosition.vec3_copy(e.myOriginalPositionCheckPosition),this.myFixedPositionCheckPosition.vec3_copy(e.myFixedPositionCheckPosition),this.myIsTeleport=e.myIsTeleport,this.myIsMove=e.myIsMove,this.myIsPositionCheck=e.myIsPositionCheck,this.myIsPositionCheckAllowAdjustments=e.myIsPositionCheckAllowAdjustments,this.mySplitMovementSteps=e.mySplitMovementSteps,this.mySplitMovementStepsPerformed=e.mySplitMovementStepsPerformed,this.mySplitMovementStop=e.mySplitMovementStop,this.mySplitMovementMovementChecked.vec3_copy(e.mySplitMovementMovementChecked),this.myRealIsOnGround=e.myRealIsOnGround,this.myRealIsOnCeiling=e.myRealIsOnCeiling}};function vT(i,e=new Ae){return e.copy(i),e.myHalfConeAngle=180,e.myHalfConeSliceAmount=Math.round(e.myHalfConeAngle/i.myHalfConeAngle*i.myHalfConeSliceAmount),e.myCheckHorizontalFixedForwardEnabled=!0,e.myCheckHorizontalFixedForward=m(0,0,1),e}var Bi={generate360TeleportParamsFromMovementParams:vT},G=class{constructor(e=r.getMainEngine()){this._myEngine=e,this._myRaycastParams=new ct(r.getPhysics(this._myEngine)),this._myRaycastResult=new Le,this._myFixRaycastResult=new Le,this._myBackupRaycastHit=new lt,this._myPrevCollisionRuntimeParams=new re,this._mySlidingCollisionRuntimeParams=new re,this._myCheckBetterSlidingNormalCollisionRuntimeParams=new re,this._myInternalSlidingCollisionRuntimeParams=new re,this._mySlidingFlickeringFixCollisionRuntimeParams=new re,this._mySlidingFlickeringFixSlidingCollisionRuntimeParams=new re,this._mySlidingOppositeDirectionCollisionRuntimeParams=new re,this._mySlidingOnVerticalCheckCollisionRuntimeParams=new re,this._myDebugEnabled=!1,this._myTotalRaycasts=0,this._myTotalRaycastsMax=0}move(e,t,n,o){this._move(e,t,n,o)}teleport(e,t,n,o){this._teleport(e,t,n,o)}positionCheck(e,t,n,o){this._positionCheck(e,t,n,o)}updateSurfaceInfo(e,t,n){this._updateSurfaceInfo(e,t,n)}_debugMovement(e,t,n,o,s){let a=e.vec3_removeComponentAlongAxis(o),l=t.vec3_removeComponentAlongAxis(o),h=t.vec3_componentAlongAxis(o),_=n.vec3_add(o.vec3_scale(s.myDistanceFromFeetToIgnore+.001));a.vec3_isZero()||(a.vec3_normalize(a),r.getDebugVisualManager(this._myEngine).drawArrow(0,_,a,.2,w(.5,.5,1,1))),l.vec3_isZero()||(l.vec3_normalize(l),r.getDebugVisualManager(this._myEngine).drawArrow(0,_,l,.2,w(0,0,1,1))),h.vec3_isZero()||(h.vec3_normalize(h),r.getDebugVisualManager(this._myEngine).drawArrow(0,n,h,.2,w(0,0,1,1)))}_debugRuntimeParams(e){e.myHorizontalCollisionHit.isValid()&&r.getDebugVisualManager(this._myEngine).drawArrow(0,e.myHorizontalCollisionHit.myPosition,e.myHorizontalCollisionHit.myNormal,.2,w(1,0,0,1)),e.mySlidingCollisionHit.isValid()&&r.getDebugVisualManager(this._myEngine).drawArrow(0,e.mySlidingCollisionHit.myPosition,e.mySlidingCollisionHit.myNormal,.2,w(1,0,0,1)),e.myVerticalCollisionHit.isValid()&&r.getDebugVisualManager(this._myEngine).drawArrow(0,e.myVerticalCollisionHit.myPosition,e.myVerticalCollisionHit.myNormal,.2,w(1,0,0,1))}_raycastAndDebug(e,t,n,o,s,a,l){}};G.prototype._raycastAndDebug=function(){let i=new Le;return function(t,n,o,s,a,l,h){this._myRaycastParams.myOrigin.vec3_copy(t),this._myRaycastParams.myDirection.vec3_copy(n),this._myRaycastParams.myDistance=o,a?(this._myRaycastParams.myBlockLayerFlags.copy(l.myHorizontalBlockLayerFlags),this._myRaycastParams.myObjectsToIgnore=l.myHorizontalObjectsToIgnore):(this._myRaycastParams.myBlockLayerFlags.copy(l.myVerticalBlockLayerFlags),this._myRaycastParams.myObjectsToIgnore=l.myVerticalObjectsToIgnore),this._myRaycastParams.myIgnoreHitsInsideCollision=s;let _=null;return _=Me.raycast(this._myRaycastParams,this._myRaycastResult),this._myTotalRaycasts++,this._myDebugEnabled&&r.isDebugEnabled(this._myEngine)&&r.getDebugVisualManager(this._myEngine).drawRaycast(0,_),_}}();G.prototype._move=function(){let i=m(),e=m(),t=m(),n=j(),o=j(),s=m(),a=m(),l=m(),h=m(),_=m(),y=m(),c=m(),d=m(),g=new re,P=m(),T=m();return function(x,D,E,S){n.quat2_setPositionRotationQuat(E.myPositionOffsetLocal,E.myRotationOffsetLocalQuat),o=n.quat2_toWorld(D,o),D.vec_equals(o,1e-5)&&o.quat2_copy(D),i=o.quat2_getUp(i),e=o.quat2_getForward(e),t=o.quat2_getPosition(t);let b=E.myHeight;b=b-1e-5,b<1e-5&&(b=0),s=x.vec3_removeComponentAlongAxis(i,s),a=x.vec3_componentAlongAxis(i,a);let v=1;if(l.vec3_copy(x),!x.vec3_isZero(1e-5)&&E.mySplitMovementEnabled){let F=x.vec3_length()/E.mySplitMovementMaxSteps;if(!E.mySplitMovementStepEqualLength||F<E.mySplitMovementStepEqualLengthMinLength){let Q=E.mySplitMovementStepEqualLength?E.mySplitMovementStepEqualLengthMinLength:E.mySplitMovementMaxLength;v=Math.ceil(x.vec3_length()/Q),v>1&&(l=l.vec3_normalize(l).vec3_scale(Q,l),v=E.mySplitMovementMaxStepsEnabled?Math.min(v,E.mySplitMovementMaxSteps):v),v=Math.max(1,v),v==1&&l.vec3_copy(x)}else v=E.mySplitMovementMaxSteps,v>1&&(l=l.vec3_normalize(l).vec3_scale(F,l))}y.vec3_zero(),_.vec3_zero(),g.copy(S),P.vec3_copy(y),T.vec3_copy(_);let I=0,L=!1;for(let F=0;F<v;F++){if(v==1||F!=v-1?h.vec3_copy(l):h=x.vec3_sub(_,h),c=t.vec3_add(y,c),d.vec3_zero(),d=this._moveStep(h,c,i,e,b,!0,E,S,d),y.vec3_add(d,y),_=_.vec3_add(l,_),I=F+1,S.myHorizontalMovementCanceled&&S.myVerticalMovementCanceled||S.myHorizontalMovementCanceled&&E.mySplitMovementStopWhenHorizontalMovementCanceled||S.myVerticalMovementCanceled&&E.mySplitMovementStopWhenVerticalMovementCanceled||E.mySplitMovementStopCallback!=null&&E.mySplitMovementStopCallback(S)){E.mySplitMovementStopReturnPrevious&&(S.copy(g),y.vec3_copy(P),_.vec3_copy(T),I-=1),L=!0;break}g.copy(S),P.vec3_copy(y),T.vec3_copy(_)}S.mySplitMovementSteps=v,S.mySplitMovementStepsPerformed=I,S.mySplitMovementStop=L,S.mySplitMovementMovementChecked.vec3_copy(_),S.myOriginalUp=D.quat2_getUp(S.myOriginalUp),S.myOriginalForward=D.quat2_getForward(S.myOriginalForward),S.myOriginalPosition=D.quat2_getPosition(S.myOriginalPosition),S.myOriginalHeight=E.myHeight,S.myOriginalMovement.vec3_copy(x),S.myFixedMovement.vec3_copy(y),S.myNewPosition=S.myOriginalPosition.vec3_add(S.myFixedMovement,S.myNewPosition),S.myIsMove=!0}}();G.prototype._moveStep=function(){let i=m(),e=m(),t=m(),n=m(),o=m(),s=m(),a=m(),l=m(),h=m(),_=m(),y=m(),c=m(),d=m(0,0,1),g=m(1,0,0);return function(T,C,x,D,E,S,b,v,I){i=T.vec3_removeComponentAlongAxis(x,i),i.vec3_isZero(1e-6)&&i.vec3_zero(),e=T.vec3_componentAlongAxis(x,e),e.vec3_isZero(1e-6)&&e.vec3_zero(),i.vec3_isZero(),this._myPrevCollisionRuntimeParams.copy(v),v.reset(),y=this._adjustHorizontalMovementWithSurface(i,e,x,b,v,this._myPrevCollisionRuntimeParams,y),y.vec3_isZero(1e-5)&&y.vec3_zero(),this._syncCollisionRuntimeParamsWithPrevious(y,e,x,b,v,this._myPrevCollisionRuntimeParams),s.vec3_copy(b.myCheckHorizontalFixedForward),b.myCheckHorizontalFixedForwardEnabled?(b.myCheckHorizontalFixedForward.vec3_isOnAxis(x)&&(d.vec3_isOnAxis(x)?s.vec3_copy(g):s.vec3_copy(d)),s=s.vec3_removeComponentAlongAxis(x,s),s=s.vec3_normalize(s),s.vec_equals(b.myCheckHorizontalFixedForward,1e-5)&&s.vec3_copy(b.myCheckHorizontalFixedForward)):y.vec3_isZero()?i.vec3_isZero()?s.vec3_copy(D):s=i.vec3_normalize(s):s=y.vec3_normalize(s),t.vec3_zero(),y.vec3_isZero()||(t=this._horizontalCheck(y,C,E,x,s,S,b,v,this._myPrevCollisionRuntimeParams,!1,t),b.mySlidingEnabled&&v.myIsCollidingHorizontally&&this._isSlidingNormalValid(y,x,v)&&(t=this._horizontalSlide(y,C,E,x,s,S,b,v,this._myPrevCollisionRuntimeParams,t))),t.vec3_isZero(1e-6)&&t.vec3_zero(),!y.vec3_isZero()&&t.vec3_isZero()&&(v.myHorizontalMovementCanceled=!0);{a.vec3_copy(b.myCheckVerticalFixedForward),b.myCheckVerticalFixedForwardEnabled?(b.myCheckVerticalFixedForward.vec3_isOnAxis(x)&&(d.vec3_isOnAxis(x)?a.vec3_copy(g):a.vec3_copy(d)),a=a.vec3_removeComponentAlongAxis(x,a),a=a.vec3_normalize(a),a.vec_equals(b.myCheckVerticalFixedForward,1e-5)&&a.vec3_copy(b.myCheckVerticalFixedForward)):t.vec3_isZero()?y.vec3_isZero()?i.vec3_isZero()?a.vec3_copy(D):a=i.vec3_normalize(a):a=y.vec3_normalize(a):a=t.vec3_normalize(a),_=this._adjustVerticalMovementWithSurface(t,e,x,b,v,this._myPrevCollisionRuntimeParams,_),h=C.vec3_add(t,h);let F=Math.pp_sign(e.vec3_lengthSigned(x),0);n.vec3_zero(),n=this._verticalCheck(_,F,h,E,x,a,b,v,n),n.vec3_isZero(1e-6)&&n.vec3_zero()}I.vec3_zero(),v.myIsCollidingVertically?(v.myHorizontalMovementCanceled=!0,v.myVerticalMovementCanceled=!0,t.vec3_zero(),n.vec3_zero(),b.myCheckVerticalFixedForwardEnabled||(y.vec3_isZero()?i.vec3_isZero()?a.vec3_copy(D):a=i.vec3_normalize(a):a=y.vec3_normalize(a))):I=t.vec3_add(n,I),h=C.vec3_add(I,h),l.vec3_copy(D),t.vec3_isZero()?y.vec3_isZero()?i.vec3_isZero()||(l=i.vec3_normalize(l)):l=y.vec3_normalize(l):l=t.vec3_normalize(l),b.myComputeGroundInfoEnabled&&this._gatherSurfaceInfo(h,E,x,l,a,!0,b,v),b.myComputeCeilingInfoEnabled&&this._gatherSurfaceInfo(h,E,x,l,a,!1,b,v),!y.vec3_isZero()&&!v.myHorizontalMovementCanceled&&(this._postSurfaceCheck(t,n,x,b,v,this._myPrevCollisionRuntimeParams)||(v.myHorizontalMovementCanceled=!0,v.myVerticalMovementCanceled=!0,t.vec3_zero(),n.vec3_zero(),I.vec3_zero(),h=C.vec3_add(I,h),y.vec3_isZero()?i.vec3_isZero()?l.vec3_copy(D):l=i.vec3_normalize(l):l=y.vec3_normalize(l),b.myComputeGroundInfoEnabled&&b.myRegatherGroundInfoOnSurfaceCheckFail?this._gatherSurfaceInfo(h,E,x,l,a,!0,b,v):(v.myIsOnGround=this._myPrevCollisionRuntimeParams.myIsOnGround,v.myGroundAngle=this._myPrevCollisionRuntimeParams.myGroundAngle,v.myGroundPerceivedAngle=this._myPrevCollisionRuntimeParams.myGroundPerceivedAngle,v.myGroundNormal.vec3_copy(this._myPrevCollisionRuntimeParams.myGroundNormal)),b.myComputeCeilingInfoEnabled&&b.myRegatherCeilingInfoOnSurfaceCheckFail?this._gatherSurfaceInfo(h,E,x,l,a,!1,b,v):(v.myIsOnCeiling=this._myPrevCollisionRuntimeParams.myIsOnCeiling,v.myCeilingAngle=this._myPrevCollisionRuntimeParams.myCeilingAngle,v.myCeilingPerceivedAngle=this._myPrevCollisionRuntimeParams.myCeilingPerceivedAngle,v.myCeilingNormal.vec3_copy(this._myPrevCollisionRuntimeParams.myCeilingNormal)))),b.myExtraMovementCheckCallback!=null&&(c.vec3_copy(I),I=b.myExtraMovementCheckCallback(T,c,C,x,D,E,b,this._myPrevCollisionRuntimeParams,v,I),t=I.vec3_removeComponentAlongAxis(x,t),n=I.vec3_componentAlongAxis(x,n)),b.mySlidingAdjustSign90Degrees&&!v.myHorizontalMovementCanceled&&!v.myIsSliding&&!t.vec3_isZero()&&(v.mySlidingRecompute90DegreesSign=!0),i.vec3_isZero()||v.myLastValidOriginalHorizontalMovement.vec3_copy(i),y.vec3_isZero()||v.myLastValidSurfaceAdjustedHorizontalMovement.vec3_copy(y),e.vec3_isZero()||v.myLastValidOriginalVerticalMovement.vec3_copy(e),_.vec3_isZero()||v.myLastValidSurfaceAdjustedVerticalMovement.vec3_copy(_),t.vec3_isZero(1e-6)||(v.myLastValidIsSliding=v.myIsSliding,v.myIsSlidingFlickerPrevented=!1,v.myLastValidEndHorizontalMovement.vec3_copy(t),v.myIsSliding),n.vec3_isZero(1e-6)||v.myLastValidEndVerticalMovement.vec3_copy(n);let L=!1;if(!v.myHorizontalMovementCanceled&&!t.vec3_isZero(1e-6)){o=t.vec3_normalize(o);let F=this._surfaceTooSteep(x,o,b,this._myPrevCollisionRuntimeParams);if(F[0]||F[1]){o=t.vec3_normalize(o);let Q=this._surfaceTooSteep(x,o,b,v);(F[0]&&Q[0]||F[1]&&Q[1]||!S||F[0]&&!b.myAllowGroundSteepFix||F[1]&&!b.myAllowCeilingSteepFix)&&(I.vec3_zero(),v.copy(this._myPrevCollisionRuntimeParams),this._moveStep(T,C,x,D,E,!1,b,v,I),L=!0)}}return L||(b.myDebugEnabled&&b.myDebugMovementEnabled&&r.isDebugEnabled(this._myEngine)&&this._debugMovement(T,I,h,x,b),b.myDebugEnabled&&b.myDebugRuntimeParamsEnabled&&r.isDebugEnabled(this._myEngine)&&this._debugRuntimeParams(v)),I}}();G.prototype._syncCollisionRuntimeParamsWithPrevious=function(){let i=m();return function(t,n,o,s,a,l){if(a.myIsSlidingFlickerPrevented=l.myIsSlidingFlickerPrevented,a.myLastValidOriginalHorizontalMovement.vec3_copy(l.myLastValidOriginalHorizontalMovement),a.myLastValidOriginalVerticalMovement.vec3_copy(l.myLastValidOriginalVerticalMovement),a.myLastValidSurfaceAdjustedHorizontalMovement.vec3_copy(l.myLastValidSurfaceAdjustedHorizontalMovement),a.myLastValidSurfaceAdjustedVerticalMovement.vec3_copy(l.myLastValidSurfaceAdjustedVerticalMovement),a.myLastValidIsSliding=l.myLastValidIsSliding,a.mySliding90DegreesSign=l.mySliding90DegreesSign,a.mySlidingRecompute90DegreesSign=l.mySlidingRecompute90DegreesSign,s.mySlidingAdjustSign90Degrees){let h=.5;if(!l.myLastValidSurfaceAdjustedHorizontalMovement.vec3_isZero()&&!t.vec3_isZero()&&t.vec3_angle(l.myLastValidSurfaceAdjustedHorizontalMovement)>h){if(!l.myLastValidIsSliding){let _=t.vec3_angleSigned(l.myLastValidSurfaceAdjustedHorizontalMovement,o),y=10;Math.abs(_)<180-y&&(a.mySliding90DegreesSign=Math.pp_sign(_))}a.mySlidingRecompute90DegreesSign=!0}}i=l.myFixedMovement.vec3_removeComponentAlongAxis(o,i),i.vec3_isZero(1e-6)?a.mySlidingPreviousHorizontalMovement.vec3_copy(l.mySlidingPreviousHorizontalMovement):a.mySlidingPreviousHorizontalMovement.vec3_copy(i)}}();Object.defineProperty(G.prototype,"_move",{enumerable:!1});Object.defineProperty(G.prototype,"_moveStep",{enumerable:!1});Object.defineProperty(G.prototype,"_syncCollisionRuntimeParamsWithPrevious",{enumerable:!1});G.prototype._teleport=function(){let i=m(),e=m(),t=m(),n=m(),o=j(),s=j(),a=m(),l=m(),h=m(),_=m(),y=m(),c=m(),d=m(),g=m(),P=m(),T=m(),C=m(0,0,1),x=m(1,0,0);return function(E,S,b,v,I=!1){o.quat2_setPositionRotationQuat(b.myPositionOffsetLocal,b.myRotationOffsetLocalQuat),s=o.quat2_toWorld(S,s),S.vec_equals(s,1e-5)&&s.quat2_copy(S),i=s.quat2_getUp(i),e=s.quat2_getForward(e),t=s.quat2_getPosition(t),l.vec3_copy(E),n=S.quat2_getPosition(n),a=n.vec3_sub(t,a),a.vec3_isZero(1e-5)?a.vec3_zero():l=l.vec3_sub(a,l);let L=b.myHeight;if(L=L-1e-5,L<1e-5&&(L=0),this._myPrevCollisionRuntimeParams.copy(v),v.reset(),_.vec3_copy(b.myCheckHorizontalFixedForward),b.myCheckHorizontalFixedForwardEnabled?(b.myCheckHorizontalFixedForward.vec3_isOnAxis(i)&&(C.vec3_isOnAxis(i)?_.vec3_copy(x):_.vec3_copy(C)),_=_.vec3_removeComponentAlongAxis(i,_),_=_.vec3_normalize(_),_.vec_equals(b.myCheckHorizontalFixedForward,1e-5)&&_.vec3_copy(b.myCheckHorizontalFixedForward)):_.vec3_copy(e),d=this._horizontalCheck(h,l,L,i,_,!1,b,v,this._myPrevCollisionRuntimeParams,!1,d),v.myIsCollidingHorizontally)v.myTeleportCanceled=!0;else{P=l.vec3_add(d,P),y.vec3_copy(b.myCheckVerticalFixedForward),b.myCheckVerticalFixedForwardEnabled?(b.myCheckVerticalFixedForward.vec3_isOnAxis(i)&&(C.vec3_isOnAxis(i)?y.vec3_copy(x):y.vec3_copy(C)),y=y.vec3_removeComponentAlongAxis(i,y),y=y.vec3_normalize(y),y.vec_equals(b.myCheckVerticalFixedForward,1e-5)&&y.vec3_copy(b.myCheckVerticalFixedForward)):y.vec3_copy(e);let F=-1;if(g=this._verticalCheck(h,F,P,L,i,y,b,v,g),v.myIsCollidingVertically)v.myTeleportCanceled=!0;else{if(P=P.vec3_add(g,P),c.vec3_copy(e),b.myComputeGroundInfoEnabled&&this._gatherSurfaceInfo(P,L,i,c,y,!0,b,v),b.myComputeCeilingInfoEnabled&&this._gatherSurfaceInfo(P,L,i,c,y,!1,b,v),v.myIsOnGround||(b.myTeleportMustBeOnGround&&!I||b.myCheckTransformMustBeOnGround&&I)&&(v.myTeleportCanceled=!0),v.myIsOnCeiling||(b.myTeleportMustBeOnCeiling&&!I||b.myCheckTransformMustBeOnCeiling&&I)&&(v.myTeleportCanceled=!0),v.myIsOnGround){let Q=null;I?(b.myCheckTransformMustBeOnIgnorableGroundAngle&&(Q=b.myGroundAngleToIgnore),b.myCheckTransformMustBeOnGroundAngle!=null&&(Q=Math.min(Q,b.myCheckTransformMustBeOnGroundAngle))):(b.myTeleportMustBeOnIgnorableGroundAngle&&(Q=b.myGroundAngleToIgnore),b.myTeleportMustBeOnGroundAngle!=null&&(Q=Math.min(Q,b.myTeleportMustBeOnGroundAngle))),Q!=null&&v.myGroundAngle>Q+1e-4&&(v.myTeleportCanceled=!0)}if(v.myIsOnCeiling){let Q=null;I?(b.myCheckTransformMustBeOnIgnorableCeilingAngle&&(Q=b.myCeilingAngleToIgnore),b.myCheckTransformMustBeOnCeilingAngle!=null&&(Q=Math.min(Q,b.myCheckTransformMustBeOnCeilingAngle))):(b.myTeleportMustBeOnIgnorableCeilingAngle&&(Q=b.myCeilingAngleToIgnore),b.myTeleportMustBeOnCeilingAngle!=null&&(Q=Math.min(Q,b.myTeleportMustBeOnCeilingAngle))),Q!=null&&v.myCeilingAngle>Q+1e-4&&(v.myTeleportCanceled=!0)}v.myTeleportCanceled&&(b.myComputeGroundInfoEnabled&&b.myRegatherGroundInfoOnSurfaceCheckFail?this._gatherSurfaceInfo(P,L,i,c,y,!0,b,v):(v.myIsOnGround=this._myPrevCollisionRuntimeParams.myIsOnGround,v.myGroundAngle=this._myPrevCollisionRuntimeParams.myGroundAngle,v.myGroundPerceivedAngle=this._myPrevCollisionRuntimeParams.myGroundPerceivedAngle,v.myGroundNormal.vec3_copy(this._myPrevCollisionRuntimeParams.myGroundNormal)),b.myComputeCeilingInfoEnabled&&b.myRegatherCeilingInfoOnSurfaceCheckFail?this._gatherSurfaceInfo(P,L,i,c,y,!1,b,v):(v.myIsOnCeiling=this._myPrevCollisionRuntimeParams.myIsOnCeiling,v.myCeilingAngle=this._myPrevCollisionRuntimeParams.myCeilingAngle,v.myCeilingPerceivedAngle=this._myPrevCollisionRuntimeParams.myCeilingPerceivedAngle,v.myCeilingNormal.vec3_copy(this._myPrevCollisionRuntimeParams.myCeilingNormal)))}}I?b.myExtraCheckTransformCheckCallback!=null&&(T.vec3_copy(P),P=b.myExtraCheckTransformCheckCallback(T,t,i,e,L,b,this._myPrevCollisionRuntimeParams,v,P)):b.myExtraTeleportCheckCallback!=null&&(T.vec3_copy(P),P=b.myExtraTeleportCheckCallback(l,T,t,i,e,L,b,this._myPrevCollisionRuntimeParams,v,P)),v.myOriginalUp=S.quat2_getUp(v.myOriginalUp),v.myOriginalForward=S.quat2_getForward(v.myOriginalForward),v.myOriginalPosition=S.quat2_getPosition(v.myOriginalPosition),v.myOriginalHeight=b.myHeight,v.myOriginalTeleportPosition.vec3_copy(E),v.myTeleportCanceled?v.myNewPosition.vec3_copy(v.myOriginalPosition):(v.myFixedTeleportPosition.vec3_copy(P),a.vec3_isZero(1e-5)||(v.myFixedTeleportPosition=v.myFixedTeleportPosition.vec3_add(a,v.myFixedTeleportPosition)),v.myNewPosition.vec3_copy(v.myFixedTeleportPosition)),v.myIsTeleport=!0,b.myDebugEnabled&&b.myDebugRuntimeParamsEnabled&&r.isDebugEnabled(this._myEngine)&&this._debugRuntimeParams(v)}}();Object.defineProperty(G.prototype,"_teleport",{enumerable:!1});G.prototype._positionCheck=function(){let i=m();return function(t,n,o,s){i=n.quat2_getPosition(i),this._teleport(i,n,o,s,!0),s.myIsPositionOk=!s.myTeleportCanceled,s.myIsPositionCheck=!0,s.myOriginalPositionCheckPosition.vec3_copy(s.myOriginalTeleportPosition),s.myFixedPositionCheckPosition.vec3_copy(s.myFixedTeleportPosition),s.myIsPositionCheckAllowAdjustments=t,t||(s.myIsPositionOk=s.myIsPositionOk&&s.myOriginalPositionCheckPosition.vec_equals(s.myFixedPositionCheckPosition,1e-5)),s.myOriginalTeleportPosition.vec3_zero(),s.myFixedTeleportPosition.vec3_zero(),s.myTeleportCanceled=!1,s.myIsTeleport=!1}}();Object.defineProperty(G.prototype,"_positionCheck",{enumerable:!1});G.prototype._horizontalCheck=function(){let i=m(),e=m(),t=m(),n=m();return function(s,a,l,h,_,y,c,d,g,P,T){d.myIsCollidingHorizontally=!1,d.myHorizontalCollisionHit.reset(),T.vec3_zero(),n=s.vec3_normalize(n);let C=this._surfaceTooSteep(h,n,c,g);if(s.vec3_isZero(1e-6)||(!C[0]||y&&c.myAllowGroundSteepFix)&&(!C[1]||y&&c.myAllowCeilingSteepFix)){i=a.vec3_add(h.vec3_scale(c.myDistanceFromFeetToIgnore+1e-4,i),i);let x=Math.max(0,l-c.myDistanceFromFeetToIgnore-c.myDistanceFromHeadToIgnore-1e-4*2),D=!0;c.myHorizontalMovementCheckEnabled&&!s.vec3_isZero(1e-6)&&(D=this._horizontalMovementCheck(s,a,l,i,x,h,c,d)),D?c.myHorizontalPositionCheckEnabled?(e=i.vec3_add(s,e),t=a.vec3_add(s,t),this._horizontalPositionCheck(t,l,e,x,h,_,c,d)&&T.vec3_copy(s),T.vec3_isZero(1e-6)&&T.vec3_zero()):T.vec3_copy(s):!P&&c.mySlidingEnabled&&c.mySlidingHorizontalMovementCheckBetterNormal&&this._horizontalCheckBetterSlideNormal(s,a,l,i,x,h,_,c,d)}return T}}();G.prototype._horizontalCheckRaycast=function(){let i=m(),e=m(),t=m();return function(o,s,a,l,h,_,y,c,d,g,P,T=!1,C=!1){let x=o;i=s.vec3_sub(x,i),a!=null&&!i.vec3_isConcordant(a)&&(i.vec3_negate(i),x=s);let D=i.vec3_length();i.vec3_normalize(i);let E=this._raycastAndDebug(x,i,D,h,!0,g,P),S=!0;if(E.isColliding()){let b=T?E.myHits.length:1,v=0;for(let I=0;I<b;I++){let L=E.myHits[I];if((_==null||!_(L,C))&&(y==null||!y(L,C))){S=!1,v=I;break}}if(!S&&v>0)for(let I=0;I<v;I++)E.removeHit(0)}if(!S&&d){let b=E.myHits[0].myPosition;e=c.vec3_copyComponentAlongAxis(b,l,e),t.vec3_copy(b);let v=1e-4;i=i.vec3_componentAlongAxis(l,i),i.vec3_isZero(1e-6)||(i.vec3_normalize(i),i.vec3_scale(v,i),e.vec3_add(i,e),t.vec3_add(i,t)),i=t.vec3_sub(e,i),i.vec3_normalize(i),i.vec3_scale(v,i),t=t.vec3_add(i,t);let I=this._myRaycastResult;this._myRaycastResult=this._myFixRaycastResult,S=this._horizontalCheckRaycast(e,t,null,l,!1,_,y,c,!1,g,P),this._myRaycastResult.isColliding()?this._myFixRaycastResult=I:(S=!1,this._myRaycastResult=I)}return S}}();G.prototype._ignoreSurfaceAngle=function(){let i=(s,a)=>s.pp_equals(a),e=m(),t=m(),n=m(),o=m();return function(a,l,h,_,y,c,d,g,P,T,C){let x=!1,D=null,E=d?P.myHorizontalMovementGroundAngleIgnoreHeight:P.myHorizontalPositionGroundAngleIgnoreHeight,S=d?P.myHorizontalMovementCeilingAngleIgnoreHeight:P.myHorizontalPositionCeilingAngleIgnoreHeight;c&&E!=null?D=Math.pp_clamp(E+2e-4,0,l):!c&&S!=null&&(D=Math.pp_clamp(l-S-2e-4,0,l));let b=null;if(d&&(c&&P.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft!=null?b=P.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft:!c&&P.myHorizontalMovementCeilingAngleIgnoreMaxMovementLeft!=null&&(b=P.myHorizontalMovementCeilingAngleIgnoreMaxMovementLeft)),T.myInsideCollision)C&&(_==null||_.pp_hasEqual(T.myObject,i))&&(x=!0);else{e=h.vec3_normalize(e);let v=T.myNormal.vec3_angle(g);if(c||(v=180-v),c&&P.myGroundAngleToIgnore>0&&v>P.myGroundAngleToIgnore+1e-4){if(P.myGroundAngleToIgnoreWithPerceivedAngle!=null&&v<=P.myGroundAngleToIgnoreWithPerceivedAngle+1e-4){let I=this.computeSurfacePerceivedAngle(T.myNormal,e,g,!0);v=Math.abs(I)}}else if(!c&&P.myCeilingAngleToIgnore>0&&v>P.myCeilingAngleToIgnore+1e-4&&P.myCeilingAngleToIgnoreWithPerceivedAngle!=null&&v<=P.myCeilingAngleToIgnoreWithPerceivedAngle+1e-4){let I=this.computeSurfacePerceivedAngle(T.myNormal,e,g,!1);v=Math.abs(I)}if((c&&P.myGroundAngleToIgnore>0&&v<=P.myGroundAngleToIgnore+1e-4||!c&&P.myCeilingAngleToIgnore>0&&v<=P.myCeilingAngleToIgnore+1e-4)&&(_==null||_.pp_hasEqual(T.myObject,i))){let I=!0,L=!0;if(D!=null){I=!1;let F=a.vec3_valueAlongAxis(g),Z=T.myPosition.vec3_valueAlongAxis(g)-F;(c&&Z<=D||!c&&Z>=D)&&(I=!0)}if(I&&d&&b!=null){let F=h.vec3_length();if(F>b){L=!1;let Q=T.myPosition,Z=Math.min(P.myHalfConeAngle,90);t=Q.vec3_sub(a,t),t.vec3_isToTheRight(e,g)?o=e.vec3_rotateAxis(-Z,g,o):o=e.vec3_rotateAxis(Z,g,o),n=t.vec3_projectOnAxisAlongAxis(e,o,n);let ne=n.vec3_length();F-ne<=b&&(L=!0)}}I&&L&&(x=!0)}}return x&&y?.pp_pushUnique(T.myObject,i),x}}();Object.defineProperty(G.prototype,"_horizontalCheck",{enumerable:!1});Object.defineProperty(G.prototype,"_horizontalCheckRaycast",{enumerable:!1});Object.defineProperty(G.prototype,"_ignoreSurfaceAngle",{enumerable:!1});G.prototype._horizontalSlide=function(){let i=m();return function(t,n,o,s,a,l,h,_,y,c){if(t.vec3_isZero(1e-5))return c.vec3_zero();if(this._mySlidingCollisionRuntimeParams.copy(_),i.vec3_copy(_.mySlidingPreviousHorizontalMovement),c=this._internalHorizontalSlide(t,n,o,s,a,i,l,h,this._mySlidingCollisionRuntimeParams,y,!1,c),h.mySlidingCheckBothDirections&&this._horizontalSlideCheckOpposite(t,n,o,s,a,i,this._myPrevCollisionRuntimeParams.myIsSliding,l,h,_,this._mySlidingCollisionRuntimeParams,y,c),this._mySlidingCollisionRuntimeParams.myIsSliding&&h.mySlidingFlickeringPreventionType>0){let d=this._horizontalSlideFlickerCheck(t,c,n,o,s,a,l,h,this._mySlidingCollisionRuntimeParams,y);this._mySlidingCollisionRuntimeParams.myIsSliding=!d}if(this._mySlidingCollisionRuntimeParams.myIsSliding){let d=_.myIsSlidingFlickerPrevented;_.copy(this._mySlidingCollisionRuntimeParams),_.myIsSlidingFlickerPrevented=d||this._mySlidingCollisionRuntimeParams.myIsSlidingFlickerPrevented}else _.myIsSlidingFlickerPrevented=_.myIsSlidingFlickerPrevented||this._mySlidingCollisionRuntimeParams.myIsSlidingFlickerPrevented,c.vec3_zero();return c}}();G.prototype._horizontalSlideCheckOpposite=function(){let i=m(),e=m(),t=m();return function(o,s,a,l,h,_,y,c,d,g,P,T,C){i=g.myHorizontalCollisionHit.myNormal.vec3_removeComponentAlongAxis(l,i),i.vec3_normalize(i);let x=20;if(!(i.vec3_angle(o)>180-x)&&!(y&&P.myIsSliding&&C.vec3_isConcordant(_))&&(this._mySlidingOppositeDirectionCollisionRuntimeParams.copy(g),e=this._internalHorizontalSlide(o,s,a,l,h,_,c,d,this._mySlidingOppositeDirectionCollisionRuntimeParams,T,!0,e),this._mySlidingOppositeDirectionCollisionRuntimeParams.myIsSliding)){let D=!1;if(P.myIsSliding){if(o.vec3_angle(e)<o.vec3_angle(C)-1e-4)D=!0;else if(Math.abs(o.vec3_angle(e)-o.vec3_angle(C))<=1e-4&&_.vec3_angle(e)<_.vec3_angle(C)-1e-4){let E=5;i.vec3_angle(o)<90+E&&(D=!0)}}else{let E=.001;o.vec3_isConcordant(e)&&o.vec3_angle(e)<90-E&&(D=!0)}D&&(C.vec3_copy(e),P.copy(this._mySlidingOppositeDirectionCollisionRuntimeParams))}}}();G.prototype._horizontalSlideFlickerCheck=function(){let i=m(),e=m(),t=m(),n=m();return function(s,a,l,h,_,y,c,d,g,P){let T=!1;i.vec3_copy(g.mySlidingPreviousHorizontalMovement);let C=this._myPrevCollisionRuntimeParams.myIsSlidingFlickerPrevented||i.vec3_isZero(1e-5);if(!C&&(this._myPrevCollisionRuntimeParams.myIsSliding||!d.mySlidingFlickeringPreventionCheckOnlyIfAlreadySliding)){let x=90,D=85;switch(d.mySlidingFlickeringPreventionType){case 1:C=i.vec3_signTo(s,_,0)!=a.vec3_signTo(s,_,0);break;case 2:C=d.mySlidingCheckBothDirections&&g.myIsSlidingIntoOppositeDirection,C=C||Math.abs(g.mySlidingCollisionAngle)>x+1e-5;break;case 3:C=d.mySlidingCheckBothDirections&&g.myIsSlidingIntoOppositeDirection,C=C||Math.abs(g.mySlidingCollisionAngle)>x+1e-5,C=C||Math.abs(Math.abs(g.mySlidingCollisionAngle)-x)<1e-5&&Math.abs(g.mySlidingMovementAngle)>D+1e-5;break;case 4:C=!0;break}}if(C||this._myPrevCollisionRuntimeParams.mySlidingFlickerPreventionCheckAnywayCounter>0)if(C?g.mySlidingFlickerPreventionCheckAnywayCounter=d.mySlidingFlickerPreventionCheckAnywayCounter:g.mySlidingFlickerPreventionCheckAnywayCounter=Math.max(0,this._myPrevCollisionRuntimeParams.mySlidingFlickerPreventionCheckAnywayCounter-1),(d.mySlidingFlickeringPreventionType!=1||g.myIsSlidingFlickerPrevented||this._myPrevCollisionRuntimeParams.mySlidingFlickerPreventionCheckAnywayCounter>0)&&this._myPrevCollisionRuntimeParams.myIsSliding&&i.vec3_signTo(s,_,0)!=a.vec3_signTo(s,_,0))T=!0,g.myIsSlidingFlickerPrevented=!0;else{this._mySlidingFlickeringFixCollisionRuntimeParams.reset(),this._mySlidingFlickeringFixCollisionRuntimeParams.mySliding90DegreesSign=g.mySliding90DegreesSign,this._mySlidingFlickeringFixCollisionRuntimeParams.mySlidingRecompute90DegreesSign=!1,e=l.vec3_add(a,e);let x=d.myDebugEnabled;d.myDebugEnabled=d.myDebugEnabled&&d.myDebugSlidingEnabled,t.vec3_zero(),t=this._horizontalCheck(s,e,h,_,y,c,d,this._mySlidingFlickeringFixCollisionRuntimeParams,P,!1,t),d.myDebugEnabled=x,t.vec3_isZero(1e-5)&&(this._mySlidingFlickeringFixSlidingCollisionRuntimeParams.copy(this._mySlidingFlickeringFixCollisionRuntimeParams),n=this._internalHorizontalSlide(s,e,h,_,y,a,c,d,this._mySlidingFlickeringFixSlidingCollisionRuntimeParams,P,!1,n),d.mySlidingCheckBothDirections&&this._horizontalSlideCheckOpposite(s,e,h,_,y,a,!0,c,d,this._mySlidingFlickeringFixCollisionRuntimeParams,this._mySlidingFlickeringFixSlidingCollisionRuntimeParams,P,n),this._mySlidingFlickeringFixSlidingCollisionRuntimeParams.myIsSliding&&a.vec3_signTo(s,_,0)!=n.vec3_signTo(s,_,0)&&(T=!0,g.myIsSlidingFlickerPrevented=!0))}return T}}();G.prototype._internalHorizontalSlide=function(){let i=m(),e=m(),t=m(),n=m(),o=m(),s=m();return function(l,h,_,y,c,d,g,P,T,C,x,D){if(l.vec3_isZero(1e-5))return D.vec3_zero();if(i=T.myHorizontalCollisionHit.myNormal.vec3_negate(i),i.vec3_removeComponentAlongAxis(y,i),i[0]=Math.abs(i[0])<.01?0:i[0],i[2]=Math.abs(i[2])<.01?0:i[2],i.vec3_normalize(i),T.mySlidingCollisionHit.copy(T.myHorizontalCollisionHit),T.mySlidingWallNormal.vec3_copy(T.myHorizontalCollisionHit.myNormal),D.vec3_zero(),e.vec3_copy(i),x&&(e.vec3_copy(l),e.vec3_normalize(e)),!e.vec3_isZero(1e-5)){e.vec3_scale(l.vec3_length(),e);let E=i.vec3_signTo(l,y);if(P.mySlidingAdjustSign90Degrees){let F=.1;i.vec3_angle(l)<F&&T.mySliding90DegreesSign!=0?E=T.mySliding90DegreesSign:(T.mySliding90DegreesSign==0||T.mySlidingRecompute90DegreesSign)&&(T.mySliding90DegreesSign=E),T.mySlidingRecompute90DegreesSign=!1}x&&(E*=-1);let S=90*E,b=Math.pp_angleClamp(e.vec3_angleSigned(l.vec3_rotateAxis(90*E,y,t),y)*E,!0)*E,v=Math.pp_angleClamp(e.vec3_angleSigned(l,y)*E,!0)*E;if(x?(b=S,v=0):(Math.abs(b)<Math.abs(v)&&(v=0),Math.abs(Math.abs(b)-Math.abs(v))<1e-4&&(v=b),(Math.abs(b)<Math.abs(S)||Math.abs(Math.abs(b)-Math.abs(S))<1e-4)&&(S=b),(Math.abs(S)<Math.abs(v)||Math.abs(Math.abs(v)-Math.abs(S))<1e-4)&&(S=v)),x&&!d.vec3_isZero(1e-6)){let F=l.vec3_angleSigned(d,y);Math.pp_sign(F)==Math.pp_sign(b)&&Math.abs(b)>Math.abs(F)&&(S=F)}n.vec3_zero();let I=P.myDebugEnabled;P.myDebugEnabled=P.myDebugEnabled&&P.myDebugSlidingEnabled;let L=S;for(let F=0;F<P.mySlidingMaxAttempts&&(this._myInternalSlidingCollisionRuntimeParams.copy(T),n=e.vec3_rotateAxis(S,y,n),o.vec3_copy(c),P.myCheckHorizontalFixedForwardEnabled||n.vec3_isZero()||(o=n.vec3_normalize(o)),s.vec3_zero(),s=this._horizontalCheck(n,h,_,y,o,g,P,this._myInternalSlidingCollisionRuntimeParams,C,!0,s),s.vec3_isZero(1e-5)?(S!=b&&(v=S),F==0&&S!=b?S=b:S=(v+b)/2):(D.vec3_copy(n),T.copy(this._myInternalSlidingCollisionRuntimeParams),T.myIsSliding=!0,T.myIsSlidingIntoOppositeDirection=x,T.mySlidingMovementAngle=l.vec3_angleSigned(n,y),T.mySlidingCollisionAngle=i.vec3_angleSigned(n,y),b=S,S=(b+v)/2),!(Math.abs(Math.abs(b)-Math.abs(v))<1e-4));F++);P.myDebugEnabled=I}return T.myIsSliding||T.mySlidingCollisionHit.reset(),D}}();G.prototype._horizontalCheckBetterSlideNormal=function(){let i=m(),e=m(),t=m(),n=m(),o=m(),s=m();return function(l,h,_,y,c,d,g,P,T){i=l.vec3_normalize(i);let C=T.myHorizontalCollisionHit.myPosition,x=Math.min(P.myHalfConeAngle,90);e=C.vec3_sub(y,e),e.vec3_isToTheRight(i,d)?t=i.vec3_rotateAxis(-x,d,t):t=i.vec3_rotateAxis(x,d,t),n=e.vec3_projectOnAxisAlongAxis(i,t,n),n.vec3_isConcordant(i)?n=i.vec3_scale(Math.min(n.vec3_length(),l.vec3_length()),n):n.vec3_zero(),P.myDebugEnabled&&P.myDebugHorizontalMovementEnabled&&r.isDebugEnabled(this._myEngine)&&r.getDebugVisualManager(this._myEngine).drawArrow(0,y,i,n.vec3_length(),w(1,0,1,1)),this._myCheckBetterSlidingNormalCollisionRuntimeParams.copy(T),this._myCheckBetterSlidingNormalCollisionRuntimeParams.myIsCollidingHorizontally=!1,this._myCheckBetterSlidingNormalCollisionRuntimeParams.myHorizontalCollisionHit.reset(),o=y.vec3_add(n,o),s=y.vec3_add(n,s);let D=P.myDebugEnabled;P.myDebugEnabled=P.myDebugEnabled&&P.myDebugSlidingEnabled,P.myHorizontalPositionCheckEnabled&&this._horizontalPositionCheck(h,_,o,c,d,g,P,this._myCheckBetterSlidingNormalCollisionRuntimeParams),P.myDebugEnabled=D,this._myCheckBetterSlidingNormalCollisionRuntimeParams.myIsCollidingHorizontally&&!this._myCheckBetterSlidingNormalCollisionRuntimeParams.myHorizontalCollisionHit.myInsideCollision&&T.copy(this._myCheckBetterSlidingNormalCollisionRuntimeParams)}}();G.prototype._isSlidingNormalValid=function(){let i=m();return function(t,n,o){let s=!1;return i=o.myHorizontalCollisionHit.myNormal.vec3_removeComponentAlongAxis(n,i),i.vec3_normalize(i),i.vec3_isZero(1e-6)||(s=!0),s}}();Object.defineProperty(G.prototype,"_horizontalSlide",{enumerable:!1});Object.defineProperty(G.prototype,"_horizontalSlideCheckOpposite",{enumerable:!1});Object.defineProperty(G.prototype,"_horizontalSlideFlickerCheck",{enumerable:!1});Object.defineProperty(G.prototype,"_internalHorizontalSlide",{enumerable:!1});Object.defineProperty(G.prototype,"_horizontalCheckBetterSlideNormal",{enumerable:!1});Object.defineProperty(G.prototype,"_isSlidingNormalValid",{enumerable:!1});G.prototype._horizontalMovementCheck=function(){let i=[],e=[],t=0,n=function(){let P=null;for(;e.length<=t;)e.push(m());return P=e[t],t++,P},o=[],s=[],a=[],l=(P,T)=>P.pp_equals(T),h=m(),_=m(),y=m(),c=m(),d=m(),g=m();return function(T,C,x,D,E,S,b,v){this._myDebugEnabled=b.myDebugEnabled&&b.myDebugHorizontalMovementEnabled;let I=Math.min(b.myHalfConeAngle,90);h=T.vec3_normalize(h),i.length=0,t=0;let L=b.myRadius/b.myHorizontalMovementRadialStepAmount;{let ne=n();ne.vec3_copy(D),i.push(ne)}{d=h.vec3_rotateAxis(I,S,d),g=h.vec3_rotateAxis(-I,S,g);for(let ne=1;ne<=b.myHorizontalMovementRadialStepAmount;ne++){{let Pe=ne*L,Be=n(),ve=d.vec3_scale(Pe,Be),ye=ve.vec3_add(D,ve);i.push(ye)}{let Pe=ne*L,Be=n(),ve=g.vec3_scale(Pe,Be),ye=ve.vec3_add(D,ve);i.push(ye)}}}let F=null,Q=null,Z=null;if(b.myGroundAngleToIgnore>0){F=o,F.length=0,Z=a,Z.length=0;let ne=this._ignoreSurfaceAngle.bind(this,C,x,T,null,F,!0,!0,S,b),Pe=null;b.myCeilingAngleToIgnore>0&&(Pe=this._ignoreSurfaceAngle.bind(this,C,x,T,null,Z,!1,!0,S,b)),_.vec3_zero(),this._horizontalMovementHorizontalCheck(T,D,i,_,S,ne,Pe,b,v)}if(b.myCeilingAngleToIgnore>0&&!v.myIsCollidingHorizontally&&b.myCheckHeight){Q=s,Q.length=0;let ne=null;b.myGroundAngleToIgnore>0&&(ne=this._ignoreSurfaceAngle.bind(this,C,x,T,F,null,!0,!0,S,b));let Pe=this._ignoreSurfaceAngle.bind(this,C,x,T,null,Q,!1,!0,S,b);_=S.vec3_scale(E,_),this._horizontalMovementHorizontalCheck(T,D,i,_,S,ne,Pe,b,v)}if(!v.myIsCollidingHorizontally){let ne=!0;if(Z!=null){for(let ye of Z)if(!Q.pp_hasEqual(ye,l)){ne=!1;break}}let Pe=null,Be=null;b.myGroundAngleToIgnore>0&&(Pe=this._ignoreSurfaceAngle.bind(this,C,x,T,F,null,!0,!0,S,b)),b.myCeilingAngleToIgnore>0&&(Be=this._ignoreSurfaceAngle.bind(this,C,x,T,Q,null,!1,!0,S,b));let ve=0;b.myCheckHeight&&b.myHeightCheckStepAmountMovement>0&&E>1e-6&&(ve=b.myHeightCheckStepAmountMovement,y=S.vec3_scale(E/ve,y));for(let ye=0;ye<=ve&&(c=y.vec3_scale(ye,c),!((b.myCheckHeightTopMovement||ye==0)&&(ye!=0&&ye!=ve||ye==0&&!ne||ye==0&&b.myGroundAngleToIgnore==0||ye==ve&&b.myCeilingAngleToIgnore==0)&&(this._horizontalMovementHorizontalCheck(T,D,i,c,S,Pe,Be,b,v),v.myIsCollidingHorizontally)||ye>0&&(b.myCheckHeightVerticalMovement&&this._horizontalMovementVerticalCheck(T,D,i,c,y,S,Pe,Be,b,v),v.myIsCollidingHorizontally)));ye++);}return!v.myIsCollidingHorizontally}}();G.prototype._horizontalMovementVerticalCheck=function(){let i=m(),e=m(),t=m(),n=m(),o=m(),s=m(),a=m(),l=m(),h=m(),_=m();return function(c,d,g,P,T,C,x,D,E,S){let b=!0,v=1;i.vec3_copy(c),E.myHorizontalMovementStepEnabled&&(v=Math.max(1,Math.ceil(c.vec3_length()/E.myHorizontalMovementStepMaxLength)),c.vec3_scale(1/v,i)),e=c.vec3_normalize(e);for(let I=0;I<v;I++)for(let L=0;L<g.length;L++){if(t=g[L].vec3_add(i.vec3_scale(I,t),t).vec3_add(P,t),L>0){let F=Math.max(0,L-2);if(n=g[F].vec3_add(i.vec3_scale(I,n),n).vec3_add(P,n),E.myHorizontalMovementCheckVerticalDiagonalUpwardOutward&&(o=t.vec3_add(i,o),l=n.vec3_sub(T,l),b=this._horizontalCheckRaycast(l,o,e,C,!0,x,D,d,!0,E,S),!b)||E.myHorizontalMovementCheckVerticalDiagonalUpwardInward&&(s=n.vec3_add(i,s),a=t.vec3_sub(T,a),b=this._horizontalCheckRaycast(a,s,e,C,!0,x,D,d,!0,E,S),!b)||E.myHorizontalMovementCheckVerticalDiagonalDownwardOutward&&(h=t.vec3_add(i,h),h=h.vec3_sub(T,h),b=this._horizontalCheckRaycast(n,h,e,C,!0,x,D,d,!0,E,S),!b)||E.myHorizontalMovementCheckVerticalDiagonalDownwardInward&&(_=n.vec3_add(i,_),_=_.vec3_sub(T,_),b=this._horizontalCheckRaycast(t,_,e,C,!0,x,D,d,!0,E,S),!b))break;if(I==0){if(E.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward&&(l=n.vec3_sub(T,l),b=this._horizontalCheckRaycast(l,t,e,C,!0,x,D,d,!0,E,S),!b))break;if(E.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward){let Q=t.vec3_sub(T);if(b=this._horizontalCheckRaycast(Q,n,e,C,!0,x,D,d,!0,E,S),!b)break}}if(E.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward&&(o=t.vec3_add(i,o),_=n.vec3_sub(T,_).vec3_add(i,_),b=this._horizontalCheckRaycast(_,o,e,C,!0,x,D,d,!0,E,S),!b)||E.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward&&(s=n.vec3_add(i,s),h=t.vec3_sub(T,h).vec3_add(i,h),b=this._horizontalCheckRaycast(h,s,e,C,!0,x,D,d,!0,E,S),!b))break}if((E.myHorizontalMovementCheckVerticalStraight||E.myHorizontalMovementHorizontalStraightCentralCheckEnabled&&L==0)&&(I==0&&(a=t.vec3_sub(T,a),b=this._horizontalCheckRaycast(a,t,e,C,!0,x,D,d,!0,E,S),!b)||(o=t.vec3_add(i,o),h=o.vec3_sub(T,h),b=this._horizontalCheckRaycast(h,o,e,C,!0,x,D,d,!0,E,S),!b))||(E.myHorizontalMovementCheckVerticalStraightDiagonalUpward||E.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled&&L==0)&&(o=t.vec3_add(i,o),a=t.vec3_sub(T,a),b=this._horizontalCheckRaycast(a,o,e,C,!0,x,D,d,!0,E,S),!b)||(E.myHorizontalMovementCheckVerticalStraightDiagonalDownward||E.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled&&L==0)&&(h=t.vec3_sub(T,h).vec3_add(i,h),b=this._horizontalCheckRaycast(t,h,e,C,!0,x,D,d,!0,E,S),!b))break;if(!b){S.myIsCollidingHorizontally=!0,S.myHorizontalCollisionHit.copy(raycastResult.myHits[0]);break}}return b}}();G.prototype._horizontalMovementHorizontalCheck=function(){let i=m(),e=m(),t=m(),n=m(),o=m(),s=m();return function(l,h,_,y,c,d,g,P,T){let C=!0,x=1;i.vec3_copy(l),P.myHorizontalMovementStepEnabled&&(x=Math.max(1,Math.ceil(l.vec3_length()/P.myHorizontalMovementStepMaxLength)),l.vec3_scale(1/x,i)),e=l.vec3_normalize(e);for(let D=0;D<x;D++){for(let E=0;E<_.length;E++){if(t=_[E].vec3_add(i.vec3_scale(D,t),t).vec3_add(y,t),E>0){let S=Math.max(0,E-2);if(n=_[S].vec3_add(i.vec3_scale(D,n),n).vec3_add(y,n),P.myHorizontalMovementCheckDiagonalOutward&&(o=t.vec3_add(i,o),C=this._horizontalCheckRaycast(n,o,e,c,!0,d,g,h,!0,P,T),!C)||P.myHorizontalMovementCheckDiagonalInward&&(s=n.vec3_add(i,s),C=this._horizontalCheckRaycast(t,s,e,c,!0,d,g,h,!0,P,T),!C)||P.myHorizontalMovementCheckHorizontalBorder&&(D==0&&(C=this._horizontalCheckRaycast(n,t,e,c,!0,d,g,h,!0,P,T),!C)||(o=t.vec3_add(i,o),s=n.vec3_add(i,s),C=this._horizontalCheckRaycast(s,o,e,c,!0,d,g,h,!0,P,T),!C)))break}if((P.myHorizontalMovementCheckStraight||P.myHorizontalMovementVerticalStraightCentralCheckEnabled&&E==0)&&(o=t.vec3_add(i,o),C=this._horizontalCheckRaycast(t,o,null,c,!0,d,g,h,!0,P,T),!C))break}if(!C){T.myIsCollidingHorizontally=!0,T.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]);break}}return C}}();Object.defineProperty(G.prototype,"_horizontalMovementCheck",{enumerable:!1});Object.defineProperty(G.prototype,"_horizontalMovementVerticalCheck",{enumerable:!1});Object.defineProperty(G.prototype,"_horizontalMovementHorizontalCheck",{enumerable:!1});G.prototype._horizontalPositionCheck=function(){let i=[],e=[],t=0,n=function(){let x=null;for(;e.length<=t;)e.push(m());return x=e[t],t++,x},o=[],s=[],a=[],l=(x,D)=>x.pp_equals(D),h=m(),_=m(),y=m(),c=m(),d=m(),g=m(),P=m(),T=m(),C=new lt;return function(D,E,S,b,v,I,L,F){this._myDebugEnabled=L.myDebugEnabled&&L.myDebugHorizontalPositionEnabled,i.length=0,t=0;let Z=Math.min(L.myHalfConeAngle,180)/L.myHalfConeSliceAmount,ne=n();i.push(S.vec3_add(I.vec3_scale(L.myRadius,ne),ne));for(let ye=1;ye<=L.myHalfConeSliceAmount;ye++){let Qe=ye*Z;ne=n();let we=I.vec3_rotateAxis(-Qe,v,ne);i.push(S.vec3_add(we.vec3_scale(L.myRadius,we),we)),ne=n(),we=I.vec3_rotateAxis(Qe,v,ne),i.push(S.vec3_add(we.vec3_scale(L.myRadius,we),we))}let Pe=null,Be=null,ve=null;if(L.myGroundAngleToIgnore>0){Pe=o,Pe.length=0,ve=a,ve.length=0;let ye=this._ignoreSurfaceAngle.bind(this,D,E,I,null,Pe,!0,!1,v,L),Qe=null;L.myCeilingAngleToIgnore>0&&(Qe=this._ignoreSurfaceAngle.bind(this,D,E,I,null,ve,!1,!1,v,L)),h.vec3_zero(),this._horizontalPositionHorizontalCheck(S,i,h,v,I,ye,Qe,L,F)}if(L.myCeilingAngleToIgnore>0&&!F.myIsCollidingHorizontally&&L.myCheckHeight){Be=s,Be.length=0;let ye=null;L.myGroundAngleToIgnore>0&&(ye=this._ignoreSurfaceAngle.bind(this,D,E,I,Pe,null,!0,!1,v,L));let Qe=this._ignoreSurfaceAngle.bind(this,D,E,I,null,Be,!1,!1,v,L);h=v.vec3_scale(b,h),this._horizontalPositionHorizontalCheck(S,i,h,v,I,ye,Qe,L,F)}if(!F.myIsCollidingHorizontally){let ye=!0;if(ve!=null){for(let Ze of ve)if(!Be.pp_hasEqual(Ze,l)){ye=!1;break}}let Qe=null,we=null;L.myGroundAngleToIgnore>0&&(Qe=this._ignoreSurfaceAngle.bind(this,D,E,I,Pe,null,!0,!1,v,L)),L.myCeilingAngleToIgnore>0&&(we=this._ignoreSurfaceAngle.bind(this,D,E,I,Be,null,!1,!1,v,L));let Dt=0;L.myCheckHeight&&L.myHeightCheckStepAmountPosition>0&&b>0&&(Dt=L.myHeightCheckStepAmountPosition,v.vec3_scale(b/Dt,_));for(let Ze=0;Ze<=Dt&&(y=_.vec3_scale(Ze,y),!((L.myCheckHeightTopPosition||Ze==0)&&(Ze!=0&&Ze!=Dt||Ze==0&&!ye||Ze==0&&L.myGroundAngleToIgnore==0||Ze!=0&&Ze==Dt&&L.myCeilingAngleToIgnore==0)&&(this._horizontalPositionHorizontalCheck(S,i,y,v,I,Qe,we,L,F),F.myIsCollidingHorizontally)));Ze++)if(Ze>0&&L.myCheckHeightVerticalPosition){let Io=1e-4;if((L.myHorizontalPositionCheckVerticalDirectionType==0||L.myHorizontalPositionCheckVerticalDirectionType==2)&&(T.vec3_copy(v),this._horizontalPositionVerticalCheck(S,i,y,_,T,v,Qe,we,L,F),F.myIsCollidingHorizontally&&L.myCheckHeightConeOnCollision)){if(c=F.myHorizontalCollisionHit.myPosition.vec3_sub(S,c).vec3_componentAlongAxis(v,c),c.vec3_add(T.vec3_scale(Io,d),c),F.myIsCollidingHorizontally=!1,L.myCheckHeightConeOnCollisionKeepHit&&C.copy(F.myHorizontalCollisionHit),F.myHorizontalCollisionHit.reset(),this._horizontalPositionHorizontalCheck(S,i,c,v,I,Qe,we,L,F),F.myIsCollidingHorizontally)break;if(L.myCheckHeightConeOnCollisionKeepHit){F.myIsCollidingHorizontally=!0,F.myHorizontalCollisionHit.copy(C);break}}if(!F.myIsCollidingHorizontally&&((L.myHorizontalPositionCheckVerticalDirectionType==1||L.myHorizontalPositionCheckVerticalDirectionType==2)&&(T=v.vec3_negate(T),g=y.vec3_sub(_,g),P=_.vec3_negate(P),this._horizontalPositionVerticalCheck(S,i,g,P,T,v,Qe,we,L,F)),F.myIsCollidingHorizontally&&L.myCheckHeightConeOnCollision)){if(c=F.myHorizontalCollisionHit.myPosition.vec3_sub(S,c).vec3_componentAlongAxis(v,c),c.vec3_add(T.vec3_scale(Io,d),c),F.myIsCollidingHorizontally=!1,L.myCheckHeightConeOnCollisionKeepHit&&C.copy(F.myHorizontalCollisionHit),F.myHorizontalCollisionHit.reset(),this._horizontalPositionHorizontalCheck(S,i,c,v,I,Qe,we,L,F),F.myIsCollidingHorizontally)break;if(L.myCheckHeightConeOnCollisionKeepHit){F.myIsCollidingHorizontally=!0,F.myHorizontalCollisionHit.copy(C);break}}}}return!F.myIsCollidingHorizontally}}();G.prototype._horizontalPositionHorizontalCheck=function(){let i=m(),e=m(),t=m(),n=m();return function(s,a,l,h,_,y,c,d,g){let P=!0;i=s.vec3_add(l,i);let T=Math.floor(a.length/2)+1;for(let C=0;C<T;C++){if(C>0){let x=Math.max(0,C*2),D=Math.max(0,C*2-1),E=a[x].vec_equals(a[D],1e-6);if(d.myCheckConeBorder)for(let S=0;S<2;S++){let b=S==0?x:D;t=a[b].vec3_add(l,t);let v=Math.max(0,b-2);if(n=a[v].vec3_add(l,n),P=this._horizontalCheckRaycast(n,t,_.vec3_negate(e),h,!0,y,c,s,!0,d,g),!P)break}if(d.myCheckConeRay&&P)for(let S=0;S<2&&!(S==1&&E);S++){let b=S==0?x:D;if(t=a[b].vec3_add(l,t),P=this._horizontalCheckRaycast(i,t,null,h,!1,y,c,s,!1,d,g),!P)break}}else if(d.myCheckConeRay&&(t=a[C].vec3_add(l,t),P=this._horizontalCheckRaycast(i,t,null,h,!1,y,c,s,!1,d,g),!P))break;if(!P)break}return P||(g.myIsCollidingHorizontally=!0,g.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0])),P}}();G.prototype._horizontalPositionVerticalCheck=function(){let i=m(),e=m(),t=m(),n=m(),o=m(),s=m();return function(l,h,_,y,c,d,g,P,T,C){let x=!0;i=l.vec3_add(_,i),e=i.vec3_sub(y,e);for(let D=0;D<=h.length;D++){let E=!1;if(D==h.length?(t.vec3_copy(i),n.vec3_copy(e)):(t=h[D].vec3_add(_,t),n=t.vec3_sub(y,n),D>0&&(E=h[D].vec_equals(h[D-1],1e-6))),T.myCheckVerticalStraight&&!E&&(x=this._horizontalCheckRaycast(n,t,null,d,T.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision,g,P,l,!0,T,C,!0,!0),!x&&(C.myIsCollidingHorizontally?this._myRaycastResult.myHits[0].myPosition.vec3_isFartherAlongAxis(C.myHorizontalCollisionHit.myPosition,c)&&C.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]):(C.myIsCollidingHorizontally=!0,C.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0])),!T.myCheckVerticalSearchFartherVerticalHit)))break;if(D<h.length){if((T.myCheckVerticalDiagonalRayOutward||T.myCheckVerticalDiagonalBorderRayOutward&&(D==h.length-2||D==h.length-1))&&!E&&(x=this._horizontalCheckRaycast(e,t,null,d,T.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision,g,P,l,!0,T,C,!0,!0),!x&&(C.myIsCollidingHorizontally?this._myRaycastResult.myHits[0].myPosition.vec3_isFartherAlongAxis(C.myHorizontalCollisionHit.myPosition,c)&&C.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]):(C.myIsCollidingHorizontally=!0,C.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0])),!T.myCheckVerticalSearchFartherVerticalHit))||(T.myCheckVerticalDiagonalRayInward||T.myCheckVerticalDiagonalBorderRayInward&&(D==h.length-2||D==h.length-1))&&!E&&(x=this._horizontalCheckRaycast(n,i,null,d,T.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision,g,P,l,!0,T,C,!0,!0),!x&&(C.myIsCollidingHorizontally?this._myRaycastResult.myHits[0].myPosition.vec3_isFartherAlongAxis(C.myHorizontalCollisionHit.myPosition,c)&&C.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]):(C.myIsCollidingHorizontally=!0,C.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0])),!T.myCheckVerticalSearchFartherVerticalHit)))break;if(D>0&&(T.myCheckVerticalDiagonalBorderOutward||T.myCheckVerticalDiagonalBorderInward)){let S=Math.max(0,D-2);if(o=h[S].vec3_add(_,o),s=o.vec3_sub(y,s),T.myCheckVerticalDiagonalBorderOutward&&(x=this._horizontalCheckRaycast(s,t,null,d,T.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision,g,P,l,!0,T,C,!0,!0),!x&&(C.myIsCollidingHorizontally?this._myRaycastResult.myHits[0].myPosition.vec3_isFartherAlongAxis(C.myHorizontalCollisionHit.myPosition,c)&&C.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]):(C.myIsCollidingHorizontally=!0,C.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0])),!T.myCheckVerticalSearchFartherVerticalHit))||T.myCheckVerticalDiagonalBorderInward&&(x=this._horizontalCheckRaycast(n,o,null,d,T.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision,g,P,l,!0,T,C,!0,!0),!x&&(C.myIsCollidingHorizontally?this._myRaycastResult.myHits[0].myPosition.vec3_isFartherAlongAxis(C.myHorizontalCollisionHit.myPosition,c)&&C.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0]):(C.myIsCollidingHorizontally=!0,C.myHorizontalCollisionHit.copy(this._myRaycastResult.myHits[0])),!T.myCheckVerticalSearchFartherVerticalHit)))break}}}return!C.myIsCollidingHorizontally}}();Object.defineProperty(G.prototype,"_horizontalPositionCheck",{enumerable:!1});Object.defineProperty(G.prototype,"_horizontalPositionHorizontalCheck",{enumerable:!1});Object.defineProperty(G.prototype,"_horizontalPositionVerticalCheck",{enumerable:!1});G.prototype._verticalCheck=function(){let i=m(),e=m(),t=m(0,0,0);return function(o,s,a,l,h,_,y,c,d){c.myIsCollidingVertically=!1,c.myVerticalCollisionHit.reset();let g=Math.pp_sign(o.vec3_lengthSigned(h),-1),P=g<0;if(d.vec3_copy(o),y.myVerticalMovementCheckEnabled&&(d=this._verticalMovementAdjustment(o,P,s,a,l,h,_,y,c,d),y.myCheckVerticalBothDirection&&(d.vec_equals(o,1e-5)||s==0||g!=s))){i=a.vec3_add(d,i);let T=!P;e=this._verticalMovementAdjustment(t,T,s,i,l,h,_,y,c,e),d.vec3_add(e,d),P=!P}return y.myVerticalPositionCheckEnabled&&(i=a.vec3_add(d,i),this._verticalPositionCheck(i,P,l,h,_,y,c)||(d.vec3_zero(),c.myHasSnappedOnGround=!1,c.myHasSnappedOnCeiling=!1,c.myHasPoppedOutGround=!1,c.myHasPoppedOutCeiling=!1,c.myHasReducedVerticalMovement=!1)),d}}();G.prototype._verticalMovementAdjustment=function(){let i=m(),e=m(),t=m(),n=m(),o=m(),s=m(),a=m(),l=m();return function(_,y,c,d,g,P,T,C,x,D){this._myDebugEnabled=C.myDebugEnabled&&C.myDebugVerticalMovementEnabled,i.vec3_zero(),e.vec3_zero();let E=!1,S=!1;if(y?(i.vec3_zero(),e.vec3_copy(_),C.myGroundPopOutExtraDistance>0&&C.myGroundPopOutEnabled&&(i.vec3_add(P.vec3_scale(C.myGroundPopOutExtraDistance+1e-5,t),i),E=!0)):(i=P.vec3_scale(g,i),e=P.vec3_scale(g,e).vec3_add(_,e),C.myCeilingPopOutExtraDistance>0&&C.myCeilingPopOutEnabled&&(i.vec3_add(P.vec3_scale(-C.myCeilingPopOutExtraDistance-1e-5,t),i),E=!0)),y&&c<=0&&this._myPrevCollisionRuntimeParams.myIsOnGround&&C.mySnapOnGroundEnabled&&C.mySnapOnGroundExtraDistance>0?(e.vec3_add(P.vec3_scale(-C.mySnapOnGroundExtraDistance-1e-5,t),e),S=!0):!y&&this._myPrevCollisionRuntimeParams.myIsOnCeiling&&C.mySnapOnCeilingEnabled&&C.mySnapOnCeilingExtraDistance>0&&(c>0||c==0&&(!this._myPrevCollisionRuntimeParams.myIsOnGround||!C.mySnapOnGroundEnabled))&&(e.vec3_add(P.vec3_scale(C.mySnapOnCeilingExtraDistance+1e-5,t),e),S=!0),D.vec3_zero(),i.vec3_distance(e)>1e-5){let b=this._getVerticalCheckPositions(d,P,T,C,x);n.vec3_copy(P),y||n.vec3_negate(n);let v=!1;for(let I=0;I<b.length;I++){let L=b[I];a=L.vec3_add(i,a),l=L.vec3_add(e,l).vec3_sub(a,l);let F=l.vec3_length();l.vec3_normalize(l);let Q=this._raycastAndDebug(a,l,F,!0,!1,C,x);Q.myHits.length>0&&(v?Q.myHits[0].myPosition.vec3_isFartherAlongAxis(o,n)&&o.vec3_copy(Q.myHits[0].myPosition):(v=!0,o.vec3_copy(Q.myHits[0].myPosition)))}v?(s=P.vec3_negate(s),y?(D=o.vec3_sub(d,D).vec3_componentAlongAxis(P,D),S&&D.vec3_isFartherAlongAxis(_,s)?x.myHasSnappedOnGround=!0:E&&D.vec3_isFartherAlongAxis(_,P)&&!D.vec3_isZero(1e-5)&&(_.vec3_isZero(1e-5)||!D.vec3_isConcordant(_))?x.myHasPoppedOutGround=!0:x.myHasReducedVerticalMovement=!0):(D=o.vec3_sub(d.vec3_add(P.vec3_scale(g,D),D),D).vec3_componentAlongAxis(P,D),S&&D.vec3_isFartherAlongAxis(_,P)?x.myHasSnappedOnCeiling=!0:E&&D.vec3_isFartherAlongAxis(_,s)&&!D.vec3_isZero(1e-5)&&(_.vec3_isZero(1e-5)||!D.vec3_isConcordant(_))?x.myHasPoppedOutCeiling=!0:x.myHasReducedVerticalMovement=!0),!E&&!D.vec3_isConcordant(_)&&D.vec3_zero(),!C.myVerticalMovementReduceEnabled&&x.myHasReducedVerticalMovement&&(D.vec3_copy(_),x.myHasReducedVerticalMovement=!1)):D.vec3_copy(_)}else D.vec3_copy(_);return D.vec3_length()<1e-5&&D.vec3_zero(),D}}();G.prototype._verticalPositionCheck=function(){let i=m(),e=m(),t=m(),n=m(),o=m();return function(a,l,h,_,y,c,d){if(h<1e-5)return!0;this._myDebugEnabled=c.myDebugEnabled&&c.myDebugVerticalPositionEnabled;let g=this._getVerticalCheckPositions(a,_,y,c,d),P=!0,T=!1,C=1e-5;i=_.vec3_scale(C,i),e=_.vec3_scale(h-C,e),h-C<C*10&&(e=_.vec3_scale(C*10,e));let x=!1;for(let D=0;D<g.length;D++){let E=g[D];l?(t=E.vec3_add(i,t),n=E.vec3_add(e,n)):(t=E.vec3_add(e,t),n=E.vec3_add(i,n));let S=t;o=n.vec3_sub(S,o);let b=o.vec3_length();o.vec3_normalize(o);let v=this._raycastAndDebug(S,o,b,!1,!1,c,d);if(v.isColliding()){let I=v.getFirstHitOutsideCollision();if(I!=null){P=!1,d.myVerticalCollisionHit.copy(I);break}else if(!x&&(x=!0,d.myVerticalCollisionHit.copy(v.myHits[0]),!c.myVerticalAllowHitInsideCollisionIfOneOk)){P=!1;break}}else T=!0}return d.myIsCollidingVertically=!P||!T,!d.myIsCollidingVertically}}();G.prototype._getVerticalCheckPositions=function(){let i=[],e=[],t=0,n=function(){let s=null;for(;e.length<=t;)e.push(m());return s=e[t],t++,s},o=m();return function(a,l,h,_,y){if(i.length=0,t=0,_.myGroundCircumferenceAddCenter){let P=n();P.vec3_copy(a),i.push(P)}let c=_.myFeetRadius/_.myGroundCircumferenceStepAmount,d=360/_.myGroundCircumferenceSliceAmount,g=0;for(let P=0;P<_.myGroundCircumferenceStepAmount;P++){let T=c*(P+1);o=h.vec3_rotateAxis(g,l,o);for(let C=0;C<_.myGroundCircumferenceSliceAmount;C++){let x=n(),D=o.vec3_rotateAxis(d*C,l,x);i.push(a.vec3_add(D.vec3_scale(T,D),D))}g+=_.myGroundCircumferenceRotationPerStep}return i}}();Object.defineProperty(G.prototype,"_verticalCheck",{enumerable:!1});Object.defineProperty(G.prototype,"_verticalMovementAdjustment",{enumerable:!1});Object.defineProperty(G.prototype,"_verticalPositionCheck",{enumerable:!1});Object.defineProperty(G.prototype,"_getVerticalCheckPositions",{enumerable:!1});G.prototype._updateSurfaceInfo=function(){let i=m(),e=m(),t=m(),n=j(),o=j(),s=m(),a=m(),l=m(0,0,1),h=m(1,0,0);return function(y,c,d){n.quat2_setPositionRotationQuat(c.myPositionOffsetLocal,c.myRotationOffsetLocalQuat),o=n.quat2_toWorld(y,o),y.vec_equals(o,1e-5)&&o.quat2_copy(y),i=o.quat2_getUp(i),e=o.quat2_getForward(e),t=o.quat2_getPosition(t);let g=c.myHeight;g=g-1e-5,g<1e-5&&(g=0),s.vec3_copy(e),a.vec3_copy(c.myCheckVerticalFixedForward),c.myCheckVerticalFixedForwardEnabled?(c.myCheckVerticalFixedForward.vec3_isOnAxis(i)&&(l.vec3_isOnAxis(i)?a.vec3_copy(h):a.vec3_copy(l)),a=a.vec3_removeComponentAlongAxis(i,a),a=a.vec3_normalize(a),a.vec_equals(c.myCheckVerticalFixedForward,1e-5)&&a.vec3_copy(c.myCheckVerticalFixedForward)):a.vec3_copy(e),c.myComputeGroundInfoEnabled&&this._gatherSurfaceInfo(t,g,i,s,a,!0,c,d),c.myComputeCeilingInfoEnabled&&this._gatherSurfaceInfo(t,g,i,s,a,!1,c,d)}}();G.prototype._postSurfaceCheck=function(){let i=m();return function(t,n,o,s,a,l){let h=n.vec3_isZero(1e-5),_=Math.pp_sign(n.vec3_lengthSigned(o),-1)<0,y=t.vec3_isZero(1e-5);i=t.vec3_normalize(i);let c=this.computeSurfacePerceivedAngle(a.myGroundNormal,i,o,!0),d=this.computeSurfacePerceivedAngle(a.myCeilingNormal,i,o,!1),g=!0;s.myMustStayOnGround&&l.myIsOnGround&&!a.myIsOnGround&&(h||_)&&(g=!1);let P=!0;s.myMustStayOnCeiling&&l.myIsOnCeiling&&!a.myIsOnCeiling&&(h||_)&&(P=!1);let T=!0;if(s.myMustStayBelowGroundAngleDownhill!=null||s.myMustStayBelowIgnorableGroundAngleDownhill){let I=null;s.myMustStayBelowIgnorableGroundAngleDownhill?s.myMustStayBelowGroundAngleDownhill==null?I=s.myGroundAngleToIgnore:I=Math.min(s.myMustStayBelowGroundAngleDownhill,s.myGroundAngleToIgnore):I=s.myMustStayBelowGroundAngleDownhill,!y&&c<0&&l.myIsOnGround&&l.myGroundAngle<=I&&a.myIsOnGround&&a.myGroundAngle>I+1e-4&&(T=!1)}let C=!0;if(s.myMustStayBelowCeilingAngleDownhill!=null||s.myMustStayBelowIgnorableCeilingAngleDownhill){let I=null;s.myMustStayBelowIgnorableCeilingAngleDownhill?s.myMustStayBelowCeilingAngleDownhill==null?I=s.myCeilingAngleToIgnore:I=Math.min(s.myMustStayBelowCeilingAngleDownhill,s.myCeilingAngleToIgnore):I=s.myMustStayBelowCeilingAngleDownhill,!y&&c<0&&l.myIsOnCeiling&&l.myCeilingAngle<=I&&a.myIsOnCeiling&&a.myCeilingAngle>I+1e-4&&(C=!1)}let x=!0;s.myMovementMustStayOnGroundHitAngle!=null&&!y&&l.myIsOnGround&&l.myGroundHitMaxAngle<=s.myMovementMustStayOnGroundHitAngle&&a.myIsOnGround&&a.myGroundHitMaxAngle>s.myMovementMustStayOnGroundHitAngle+1e-4&&(x=!1);let D=!0;s.myMovementMustStayOnCeilingHitAngle!=null&&!y&&l.myIsOnCeiling&&l.myCeilingHitMaxAngle<=s.myMovementMustStayOnCeilingHitAngle&&a.myIsOnCeiling&&a.myCeilingHitMaxAngle>s.myMovementMustStayOnCeilingHitAngle+1e-4&&(D=!1);let E=!0,S=!0;a.myIsOnGround&&a.myGroundAngle>s.myGroundAngleToIgnore+1e-4&&l.myIsOnGround&&!y&&(c>0?(E=!1,s.myGroundAngleToIgnoreWithPerceivedAngle!=null&&a.myGroundAngle<=s.myGroundAngleToIgnoreWithPerceivedAngle+1e-4&&(E=Math.abs(c)<=s.myGroundAngleToIgnore+1e-4)):c<0&&l.myGroundAngle<=s.myGroundAngleToIgnore+1e-4&&s.myMustStayOnValidGroundAngleDownhill&&(S=!1));let b=!0,v=!0;return a.myIsOnCeiling&&a.myCeilingAngle>s.myCeilingAngleToIgnore+1e-4&&l.myIsOnCeiling&&!y&&(d>0?(b=!1,s.myCeilingAngleToIgnoreWithPerceivedAngle!=null&&a.myCeilingAngle<=s.myCeilingAngleToIgnoreWithPerceivedAngle+1e-4&&(b=Math.abs(d)<=s.myCeilingAngleToIgnore+1e-4)):d<0&&l.myCeilingAngle<=s.myCeilingAngleToIgnore+1e-4&&s.myMustStayOnValidCeilingAngleDownhill&&(v=!1)),g&&P&&T&&C&&x&&D&&E&&S&&b&&v}}();G.prototype._surfaceTooSteep=function(){let i=[!1,!1];return function(t,n,o,s){let a=!1,l=!1;if(s.myIsOnGround&&s.myGroundAngle>o.myGroundAngleToIgnore+1e-4){let h=this.computeSurfacePerceivedAngle(s.myGroundNormal,n,t,!0);a=h>0,a&&o.myGroundAngleToIgnoreWithPerceivedAngle!=null&&s.myGroundAngle<=o.myGroundAngleToIgnoreWithPerceivedAngle+1e-4&&(a=Math.abs(h)>o.myGroundAngleToIgnore+1e-4)}if(!a&&s.myIsOnCeiling&&s.myCeilingAngle>o.myCeilingAngleToIgnore+1e-4){let h=this.computeSurfacePerceivedAngle(s.myCeilingNormal,n,t,!1);l=h>0,l&&o.myCeilingAngleToIgnoreWithPerceivedAngle!=null&&s.myCeilingAngle<=o.myCeilingAngleToIgnoreWithPerceivedAngle+1e-4&&(l=Math.abs(h)>o.myCeilingAngleToIgnore+1e-4)}return i[0]=a,i[1]=l,i}}();G.prototype._adjustVerticalMovementWithSurface=function(){let i=m(),e=m();return function(n,o,s,a,l,h,_){if(_.vec3_copy(o),n.vec3_isZero(1e-5))return _;let y=0;if(i=n.vec3_normalize(i),h.myIsOnGround){let c=this.computeSurfacePerceivedAngle(h.myGroundNormal,i,s,!0),d=n.vec3_length()*Math.tan(Math.pp_toRadians(Math.abs(c)));d*=Math.pp_sign(c),Math.abs(d)>1e-5&&(c>0?a.myAdjustVerticalMovementWithGroundAngleUphill&&(a.myAdjustVerticalMovementWithGroundAngleUphillMaxPerceivedAngle==null||Math.abs(c)<=a.myAdjustVerticalMovementWithGroundAngleUphillMaxPerceivedAngle)&&(a.myAdjustVerticalMovementWithGroundAngleUphillMaxAngle==null||h.myGroundAngle<=a.myAdjustVerticalMovementWithGroundAngleUphillMaxAngle)&&(y=d,l.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleUphill=!0):c<0&&a.myAdjustVerticalMovementWithGroundAngleDownhill&&(a.myAdjustVerticalMovementWithGroundAngleDownhillMaxPerceivedAngle==null||Math.abs(c)<=a.myAdjustVerticalMovementWithGroundAngleDownhillMaxPerceivedAngle)&&(a.myAdjustVerticalMovementWithGroundAngleDownhillMaxAngle==null||h.myGroundAngle<=a.myAdjustVerticalMovementWithGroundAngleDownhillMaxAngle)&&(y=d,l.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleDownhill=!0))}if(h.myIsOnCeiling){let c=this.computeSurfacePerceivedAngle(h.myCeilingNormal,i,s,!1),d=n.vec3_length()*Math.tan(Math.pp_toRadians(Math.abs(c)));if(d*=Math.pp_sign(c),Math.abs(d)>1e-5){let g=Math.pp_sign(y)==Math.pp_sign(d);(y==0||g&&Math.abs(d)>Math.abs(y))&&(c>0?a.myAdjustVerticalMovementWithCeilingAngleUphill&&(a.myAdjustVerticalMovementWithCeilingAngleUphillMaxPerceivedAngle==null||Math.abs(c)<=a.myAdjustVerticalMovementWithCeilingAngleUphillMaxPerceivedAngle)&&(a.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle==null||h.myCeilingAngle<=a.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle)&&(y=d,l.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleUphill=!0,l.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleUphill=!1):c<0&&a.myAdjustVerticalMovementWithCeilingAngleDownhill&&(a.myAdjustVerticalMovementWithCeilingAngleDownhillMaxPerceivedAngle==null||Math.abs(c)<=a.myAdjustVerticalMovementWithCeilingAngleDownhillMaxPerceivedAngle)&&(a.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle==null||h.myCeilingAngle<=a.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle)&&(y=d,l.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleDownhill=!0,l.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleDownhill=!1))}}if(Math.abs(y)>1e-5){let c=o.vec3_lengthSigned(s),d=Math.pp_sign(y)==Math.pp_sign(c);e=s.vec3_scale(y,e),o.vec3_isZero(1e-5)?_.vec3_copy(e):d||!d&&(l.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleUphill||l.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleUphill)?_=o.vec3_add(e,_):(l.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleUphill=!1,l.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleUphill=!1,l.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleDownhill=!1,l.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleDownhill=!1)}return _.vec3_isZero(1e-6)&&_.vec3_zero(),_}}();G.prototype._adjustHorizontalMovementWithSurface=function(){let i=m(),e=m(),t=m(),n=m(),o=m(),s=m();return function(l,h,_,y,c,d,g){if(g.vec3_copy(l),h.vec3_isZero(1e-5))return g;let P=!h.vec3_isConcordant(_);if(i.vec3_zero(),e.vec3_zero(),d.myIsOnGround&&(e=d.myGroundNormal.vec3_removeComponentAlongAxis(_,e),!e.vec3_isZero(1e-5))){e.vec3_normalize(e);let T=h.vec3_length()/Math.tan(Math.pp_toRadians(d.myGroundAngle));T*=P?1:-1,Math.abs(T)>1e-5&&P&&y.myAdjustHorizontalMovementWithGroundAngleDownhill&&(y.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle==null||d.myGroundAngle>=y.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle)&&(i=e.vec3_scale(T,i),c.myVerticalMovementHasAdjustedHorizontalMovementBasedOnGroundAngleDownhill=!0)}if(d.myIsOnCeiling&&(t=d.myCeilingNormal.vec3_removeComponentAlongAxis(_,t),!t.vec3_isZero(1e-5))){t.vec3_normalize(t);let T=h.vec3_length()/Math.tan(Math.pp_toRadians(d.myCeilingAngle));if(T*=P?-1:1,Math.abs(T)>1e-5){let C=t.vec3_isConcordant(e);(i.vec3_isZero()||C)&&(P||y.myAdjustHorizontalMovementWithCeilingAngleDownhill&&(y.myAdjustHorizontalMovementWithCeilingAngleDownhillMinAngle==null||d.myCeilingAngle>=y.myAdjustHorizontalMovementWithCeilingAngleDownhillMinAngle)&&(n=t.vec3_scale(T,n),e.vec3_isZero()?(i.vec3_copy(n),c.myVerticalMovementHasAdjustedHorizontalMovementBasedOnCeilingAngleDownhill=!0):(s=n.vec3_removeComponentAlongAxis(s),o=n.vec3_componentAlongAxis(s),o.vec3_isFartherAlongAxis(i,e)?(c.myVerticalMovementHasAdjustedHorizontalMovementBasedOnGroundAngleDownhill=!1,i.vec3_copy(n),c.myVerticalMovementHasAdjustedHorizontalMovementBasedOnCeilingAngleDownhill=!0):s.vec3_isZero(1e-5)||(i=i.vec3_add(s,i),c.myVerticalMovementHasAdjustedHorizontalMovementBasedOnCeilingAngleDownhill=!0))))}}return i.vec3_isZero()||(l.vec3_isZero(1e-5)?g.vec3_copy(i):(i.vec3_isConcordant(l),g=l.vec3_add(i,g))),g.vec3_isZero(1e-6)&&g.vec3_zero(),g}}();G.prototype._computeExtraSurfaceVerticalMovement=function(){let i=m(),e=m();return function(n,o,s,a,l){if(l.vec3_zero(),!n.vec3_isZero()){if(a.myIsOnGround&&a.myGroundAngle!=0){i=n.vec3_normalize(i);let h=this.computeSurfacePerceivedAngle(a.myGroundNormal,i,o,!0),_=n.vec3_length()*Math.tan(Math.pp_toRadians(Math.abs(h)));_*=Math.pp_sign(h),Math.abs(_)>1e-5&&(s.mySnapOnGroundEnabled||_>0)&&l.vec3_add(o.vec3_scale(_,e),l)}else if(a.myIsOnCeiling&&a.myCeilingAngle!=0){i=n.vec3_normalize(i);let h=this.computeSurfacePerceivedAngle(a.myCeilingNormal,i,o,!1),_=n.vec3_length()*Math.tan(Math.pp_toRadians(Math.abs(h)));_*=Math.pp_sign(h),_*=-1,Math.abs(_)>1e-5&&(s.mySnapOnCeilingEnabled||_<0)&&l.vec3_add(o.vec3_scale(_,e),l)}}return l}}();G.prototype._gatherSurfaceInfo=function(){let i=m(),e=m(),t=m(),n=m(),o=m(),s=m(),a=m(),l=m(),h=m(),_=m(),y=m(),c=m(),d=m();return function(P,T,C,x,D,E,S,b){this._myDebugEnabled=S.myDebugEnabled&&(E&&S.myDebugGroundInfoEnabled||!E&&S.myDebugCeilingInfoEnabled);let v=this._getVerticalCheckPositions(P,C,D,S,b);i.vec3_copy(C);let I=S.myDistanceToBeOnGround,L=S.myDistanceToComputeGroundInfo,F=S.myFindGroundDistanceMaxOutsideDistance,Q=S.myVerticalFixToBeOnGround,Z=S.myVerticalFixToComputeGroundInfo,ne=S.myFindGroundDistanceMaxInsideDistance,Pe=S.myIsOnGroundIfInsideHit,Be=S.myGroundIsBaseInsideCollisionCheckEnabled;E||(i.vec3_negate(i),I=S.myDistanceToBeOnCeiling,L=S.myDistanceToComputeCeilingInfo,F=S.myFindCeilingDistanceMaxOutsideDistance,Q=S.myVerticalFixToBeOnCeiling,Z=S.myVerticalFixToComputeCeilingInfo,ne=S.myFindCeilingDistanceMaxInsideDistance,Pe=S.myIsOnCeilingIfInsideHit,Be=S.myCeilingIsBaseInsideCollisionCheckEnabled),e=i.vec3_scale(Math.max(Q,Z,ne,1e-5),e),t=i.vec3_negate(t).vec3_scale(Math.max(I,L,F,1e-5),t),n.vec3_zero(),E||(n=C.vec3_scale(T,n)),o=i.vec3_scale(1e-4,o);let ve=!1,ye=0,Qe=0;l.vec3_zero();let we=0;h.vec3_zero();let Dt=null,Ze=v.length>0;for(let Io=0;Io<v.length;Io++){let an=v[Io];an.vec3_add(n,an);let ol=!1;if(Be){s=an.vec3_add(o,s),a=an.vec3_sub(o,a);let Cs=s;d=a.vec3_sub(Cs,d);let sl=d.vec3_length();d.vec3_normalize(d);let Ho=this._raycastAndDebug(Cs,d,sl,!1,!1,S,b);Ho.isColliding()&&(ol=Ho.myHits[0].myInsideCollision)}if(Ze&&=ol,ol)Pe&&(ve=!0);else{y=an.vec3_add(e,y),c=an.vec3_add(t,c);let Cs=y;d=c.vec3_sub(Cs,d);let sl=d.vec3_length();d.vec3_normalize(d);let Ho=this._raycastAndDebug(Cs,d,sl,!0,!1,S,b);if(Ho.isColliding()){_=Ho.myHits[0].myPosition.vec3_sub(an,_);let ut=_.vec3_lengthSigned(i);if((ut>=0&&ut<=Q+1e-5||ut<0&&Math.abs(ut)<=I+1e-5)&&(ve=!0),ut>=0&&ut<=Z+1e-5||ut<0&&Math.abs(ut)<=L+1e-5){let al=Ho.myHits[0].myNormal;l.vec3_add(al,l);let Sm=al.vec3_angle(i);Sm>we&&(we=Sm,h.vec3_copy(al))}(ut>=0&&ut<=ne+1e-5||ut<0&&Math.abs(ut)<=F+1e-5)&&(Dt==null||Math.abs(ut)<Math.abs(Dt))&&(Dt=-ut)}}}l.vec3_isZero()||(l.vec3_normalize(l),ye=l.vec3_angle(i),ye<=1e-4?(ye=0,l.vec3_copy(i)):ye>=180-1e-4&&(ye=180,l=i.vec3_negate(l)),Qe=this.computeSurfacePerceivedAngle(l,x,C,E)),E?(b.myRealIsOnGround=ve,b.myGroundAngle=ye,b.myGroundPerceivedAngle=Qe,b.myGroundNormal.vec3_copy(l),b.myGroundHitMaxAngle=we,b.myGroundHitMaxNormal.vec3_copy(h),b.myGroundDistance=Dt,b.myGroundIsBaseInsideCollision=Ze,ve&&(S.myIsOnGroundMaxSurfaceAngle==null||b.myGroundAngle<=S.myIsOnGroundMaxSurfaceAngle)&&(b.myIsOnGround=ve)):(b.myRealIsOnCeiling=ve,b.myCeilingAngle=ye,b.myCeilingPerceivedAngle=Qe,b.myCeilingNormal.vec3_copy(l),b.myCeilingHitMaxAngle=we,b.myCeilingHitMaxNormal.vec3_copy(h),b.myCeilingDistance=Dt,b.myCeilingIsBaseInsideCollision=Ze,ve&&(S.myIsOnCeilingMaxSurfaceAngle==null||b.myCeilingAngle<=S.myIsOnCeilingMaxSurfaceAngle)&&(b.myIsOnCeiling=ve))}}();G.prototype.computeSurfacePerceivedAngle=function(){let i=m(),e=m();return function(n,o,s,a=!0){let l=0;e.vec3_copy(s),a||e.vec3_negate(e);let h=n.vec3_angle(e);h<=Math.PP_EPSILON_DEGREES?h=0:h>=180-Math.PP_EPSILON_DEGREES&&(h=180),i=o.vec3_projectOnPlaneAlongAxis(n,s,i),l=i.vec3_angle(o);let _=i.vec3_isFartherAlongAxis(o,s);return(!_&&a||_&&!a)&&(l*=-1),Math.abs(l)>=h&&(h!=0&&h!=180?l=h*Math.pp_sign(l):l=h),l}}();Object.defineProperty(G.prototype,"_surfaceTooSteep",{enumerable:!1});Object.defineProperty(G.prototype,"_computeExtraSurfaceVerticalMovement",{enumerable:!1});Object.defineProperty(G.prototype,"_gatherSurfaceInfo",{enumerable:!1});Object.defineProperty(G.prototype,"_updateSurfaceInfo",{enumerable:!1});var Ge=class{constructor(){this.myCheckType=null,this.myTransformResults=new ns,this.myMovementResults=new $i,this.myHorizontalMovementResults=new $i,this.myVerticalMovementResults=new $i,this.myTeleportResults=new os,this.myCheckTransformResults=new ss,this.myWallSlideResults=new is,this.myGroundInfo=new uo,this.myCeilingInfo=new uo,this.myGroundResults=new ho,this.myCeilingResults=new ho,this.mySplitMovementResults=new as,this.myDebugResults=new rs,this.myInternalResults=new ls}reset(){}copy(e){}},en={CHECK_MOVEMENT:0,CHECK_TELEPORT:1,CHECK_TRANSFORM:2,UPDATE_SURFACE_INFO:3,UPDATE_GROUND_INFO:4,UPDATE_CEILING_INFO:5},uo=class{constructor(){this.myOnSurface=!1,this.mySurfaceAngle=0,this.mySurfacePerceivedAngle=0,this.mySurfaceNormal=m(),this.mySurfaceHitMaxAngle=0,this.mySurfaceHitMaxNormal=m(),this.mySurfaceDistance=null,this.myBaseInsideCollision=!1}reset(){}copy(e){}},is=class{constructor(){this.myHasSlid=!1,this.mySlideMovementAngle=0,this.mySlideMovementWallAngle=0,this.myWallNormal=m()}reset(){}copy(e){}},ns=class{constructor(){this.myStartTransformQuat=j(),this.myEndTransformQuat=j()}reset(){}copy(e){}},$i=class{constructor(){this.myStartMovement=m(),this.myEndMovement=m(),this.myMovementFailed=!1,this.myMovementCollided=!1,this.myReferenceCollisionHit=new lt}reset(){}copy(e){}},os=class{constructor(){this.myStartTeleportTransformQuat=j(),this.myEndTeleportTransformQuat=j(),this.myTeleportFailed=!1}reset(){}copy(e){}},ss=class{constructor(){this.myStartCheckTransformQuat=j(),this.myEndCheckTransformQuat=j(),this.myCheckTransformFailed=!1}reset(){}copy(e){}},ho=class{constructor(){this.myHasSnappedOnSurface=!1,this.myHasPoppedOutSurface=!1,this.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleDownhill=!1,this.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleUphill=!1,this.myHasVerticalMovementAdjustedHorizontalMovementBasedOnSurfaceAngleDownhill=!1}reset(){}copy(e){}},as=class{constructor(){this.myStepsToPerform=0,this.myStepsPerformed=0,this.myMovementInterrupted=!1,this.myMovementChecked=m()}reset(){}copy(e){}},rs=class{constructor(){this._myRaycastsPerformed=0}reset(){}copy(e){}},ls=class{constructor(){this.myLastRelevantStartHorizontalMovement=m(),this.myLastRelevantAdjustedStartHorizontalMovement=m(),this.myLastRelevantEndHorizontalMovement=m(),this.myLastRelevantStartVerticalMovement=m(),this.myLastRelevantAdjustedStartVerticalMovement=m(),this.myLastRelevantEndVerticalMovement=m(),this.myLastRelevantHasWallSlid=!1,this.myHasWallSlidTowardOppositeDirection=!1,this.myLastRelevantWallSlideFlickerPrevented=!1,this.myWallSlideFlickerPreventionForceCheckCounter=0,this.myWallSlide90DegreesDirectionSign=0,this.myWallSlide90DegreesRecomputeDirectionSign=!0}reset(){}copy(e){}};Ge.prototype.reset=function(){this.myCheckType=null,this.myTransformResults.reset(),this.myMovementResults.reset(),this.myHorizontalMovementResults.reset(),this.myVerticalMovementResults.reset(),this.myTeleportResults.reset(),this.myCheckTransformResults.reset(),this.myWallSlideResults.reset(),this.myGroundInfo.reset(),this.myCeilingInfo.reset(),this.myGroundResults.reset(),this.myCeilingResults.reset(),this.mySplitMovementResults.reset(),this.myInternalResults.reset()};Ge.prototype.copy=function(e){this.myCheckType=e.myCheckType,this.myTransformResults.copy(e.myTransformResults),this.myMovementResults.copy(e.myMovementResults),this.myHorizontalMovementResults.copy(e.myHorizontalMovementResults),this.myVerticalMovementResults.copy(e.myVerticalMovementResults),this.myTeleportResults.copy(e.myTeleportResults),this.myCheckTransformResults.copy(e.myCheckTransformResults),this.myWallSlideResults.copy(e.myWallSlideResults),this.myGroundInfo.copy(e.myGroundInfo),this.myCeilingInfo.copy(e.myCeilingInfo),this.myGroundResults.copy(e.myGroundResults),this.myCeilingResults.copy(e.myCeilingResults),this.mySplitMovementResults.copy(e.mySplitMovementResults),this.myInternalResults.copy(e.myInternalResults)};uo.prototype.reset=function(){this.myOnSurface=!1,this.mySurfaceAngle=0,this.mySurfacePerceivedAngle=0,this.mySurfaceNormal.vec3_zero(),this.mySurfaceHitMaxAngle=0,this.mySurfaceHitMaxNormal.vec3_zero(),this.mySurfaceDistance=null,this.myBaseInsideCollision=!1};uo.prototype.copy=function(e){this.myOnSurface=e.myOnSurface,this.mySurfaceAngle=e.mySurfaceAngle,this.mySurfacePerceivedAngle=e.mySurfacePerceivedAngle,this.mySurfaceNormal.vec3_copy(e.mySurfaceNormal),this.mySurfaceHitMaxAngle=e.mySurfaceHitMaxAngle,this.mySurfaceHitMaxNormal.vec3_copy(e.mySurfaceHitMaxNormal),this.mySurfaceDistance=e.mySurfaceDistance,this.myBaseInsideCollision=e.myBaseInsideCollision};is.prototype.reset=function(){this.myHasSlid=!1,this.mySlideMovementAngle=0,this.mySlideMovementWallAngle=0,this.myWallNormal.vec3_zero()};is.prototype.copy=function(e){this.myHasSlid=e.myHasSlid,this.mySlideMovementAngle=e.mySlideMovementAngle,this.mySlideMovementWallAngle=e.mySlideMovementWallAngle,this.myWallNormal.vec3_copy(e.myWallNormal)};ns.prototype.reset=function(){this.myStartTransformQuat.quat2_identity(),this.myEndTransformQuat.quat2_identity()};ns.prototype.copy=function(e){this.myStartTransformQuat.quat2_copy(e.myStartTransformQuat),this.myEndTransformQuat.quat2_copy(e.myEndTransformQuat)};$i.prototype.reset=function(){this.myStartMovement.vec3_zero(),this.myEndMovement.vec3_zero(),this.myMovementFailed=!1,this.myMovementCollided=!1,this.myReferenceCollisionHit.reset()};$i.prototype.copy=function(e){this.myStartMovement.vec3_copy(e.myStartMovement),this.myEndMovement.vec3_copy(e.myEndMovement),this.myMovementFailed=e.myMovementFailed,this.myMovementCollided=e.myMovementCollided,this.myReferenceCollisionHit.copy(e.myReferenceCollisionHit)};os.prototype.reset=function(){this.myStartTeleportTransformQuat.quat2_identity(),this.myEndTeleportTransformQuat.quat2_identity(),this.myTeleportFailed=!1};os.prototype.copy=function(e){this.myStartTeleportTransformQuat.quat2_copy(e.myStartTeleportTransformQuat),this.myEndTeleportTransformQuat.quat2_copy(e.myEndTeleportTransformQuat),this.myTeleportFailed=e.myTeleportFailed};ss.prototype.reset=function(){this.myStartCheckTransformQuat.quat2_identity(),this.myEndCheckTransformQuat.quat2_identity(),this.myCheckTransformFailed=!1};ss.prototype.copy=function(e){this.myStartCheckTransformQuat.quat2_copy(e.myStartCheckTransformQuat),this.myEndCheckTransformQuat.quat2_copy(e.myEndCheckTransformQuat),this.myCheckTransformFailed=e.myCheckTransformFailed};ho.prototype.reset=function(){this.myHasSnappedOnSurface=!1,this.myHasPoppedOutSurface=!1,this.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleDownhill=!1,this.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleUphill=!1,this.myHasVerticalMovementAdjustedHorizontalMovementBasedOnSurfaceAngleDownhill=!1};ho.prototype.copy=function(e){this.myHasSnappedOnSurface=e.myHasSnappedOnSurface,this.myHasPoppedOutSurface=e.myHasPoppedOutSurface,this.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleDownhill=e.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleDownhill,this.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleUphill=e.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleUphill,this.myHasVerticalMovementAdjustedHorizontalMovementBasedOnSurfaceAngleDownhill=e.myHasVerticalMovementAdjustedHorizontalMovementBasedOnSurfaceAngleDownhill};as.prototype.reset=function(){this.myStepsToPerform=0,this.myStepsPerformed=0,this.myMovementInterrupted=!1,this.myMovementChecked.vec3_zero()};as.prototype.copy=function(e){this.myStepsToPerform=e.myStepsToPerform,this.myStepsPerformed=e.myStepsPerformed,this.myMovementInterrupted=e.myMovementInterrupted,this.myMovementChecked.vec3_copy(e.myMovementChecked)};rs.prototype.reset=function(){this._myRaycastsPerformed=0};rs.prototype.copy=function(e){this._myRaycastsPerformed=e._myRaycastsPerformed};ls.prototype.reset=function(){};ls.prototype.copy=function(e){this.myLastRelevantStartHorizontalMovement.vec3_copy(e.myLastRelevantStartHorizontalMovement),this.myLastRelevantAdjustedStartHorizontalMovement.vec3_copy(e.myLastRelevantAdjustedStartHorizontalMovement),this.myLastRelevantEndHorizontalMovement.vec3_copy(e.myLastRelevantEndHorizontalMovement),this.myLastRelevantStartVerticalMovement.vec3_copy(e.myLastRelevantStartVerticalMovement),this.myLastRelevantAdjustedStartVerticalMovement.vec3_copy(e.myLastRelevantAdjustedStartVerticalMovement),this.myLastRelevantEndVerticalMovement.vec3_copy(e.myLastRelevantEndVerticalMovement),this.myLastRelevantHasWallSlid=e.myLastRelevantHasWallSlid,this.myHasWallSlidTowardOppositeDirection=e.myHasWallSlidTowardOppositeDirection,this.myLastRelevantWallSlideFlickerPrevented=e.myLastRelevantWallSlideFlickerPrevented,this.myWallSlideFlickerPreventionForceCheckCounter=e.myWallSlideFlickerPreventionForceCheckCounter,this.myWallSlide90DegreesDirectionSign=e.myWallSlide90DegreesDirectionSign,this.myWallSlide90DegreesRecomputeDirectionSign=e.myWallSlide90DegreesRecomputeDirectionSign};var xT=new WeakMap;function Ue(i=r.getMainEngine()){return xT.get(i)}function WR(i,e=r.getMainEngine()){xT.set(e,i)}function MT(i=r.getMainEngine()){WR(new G(i),i)}var ET=function(){let i=new Ae,e=new re;return function(n,o,s,a,l=new Ge,h=r.getMainEngine()){this.convertCharacterColliderSetupToCollisionCheckParams(s,i),this.convertCharacterCollisionResultsToCollisionRuntimeParams(a,e),Ue(h).move(n,o,i,e),this.convertCollisionRuntimeParamsToCharacterCollisionResults(e,o,l)}}(),DT=function(){let i=m(),e=new Ae,t=new re;return function(o,s,a,l,h=new Ge,_=r.getMainEngine()){this.convertCharacterColliderSetupToCollisionCheckParams(a,e),this.convertCharacterCollisionResultsToCollisionRuntimeParams(l,t),i=o.quat2_getPosition(i),Ue(_).teleport(i,o,e,t),this.convertCollisionRuntimeParamsToCharacterCollisionResults(t,s,h)}}(),RT=function(){let i=new Ae,e=new re;return function(n,o,s,a=new Ge,l=r.getMainEngine()){this.convertCharacterColliderSetupToCollisionCheckParams(o,i),this.convertCharacterCollisionResultsToCollisionRuntimeParams(s,e),Ue(l).positionCheck(!0,n,i,e),this.convertCollisionRuntimeParamsToCharacterCollisionResults(e,n,a)}}(),AT=function(){let i=new Ae,e=new re;return function(n,o,s,a=new Ge,l=r.getMainEngine()){this.convertCharacterColliderSetupToCollisionCheckParams(o,i),this.convertCharacterCollisionResultsToCollisionRuntimeParams(s,e),i.myComputeCeilingInfoEnabled=!1,Ue(l).updateSurfaceInfo(n,i,e),this.convertCollisionRuntimeParamsToCharacterCollisionResults(e,n,a)}}(),VT=function(){let i=new Ae,e=new re;return function(n,o,s,a=new Ge,l=r.getMainEngine()){this.convertCharacterColliderSetupToCollisionCheckParams(o,i),this.convertCharacterCollisionResultsToCollisionRuntimeParams(s,e),i.myComputeGroundInfoEnabled=!1,Ue(l).updateSurfaceInfo(n,i,e),this.convertCollisionRuntimeParamsToCharacterCollisionResults(e,n,a)}}();function OT(i,e){return e.reset(),i.myTransformResults.myStartTransformQuat.quat2_getPosition(e.myOriginalPosition),i.myTransformResults.myEndTransformQuat.quat2_getPosition(e.myNewPosition),i.myTransformResults.myStartTransformQuat.quat2_getForward(e.myOriginalForward),i.myTransformResults.myStartTransformQuat.quat2_getUp(e.myOriginalUp),e.myOriginalMovement.vec3_copy(i.myMovementResults.myStartMovement),e.myFixedMovement.vec3_copy(i.myMovementResults.myEndMovement),e.myLastValidOriginalHorizontalMovement.vec3_copy(i.myInternalResults.myLastRelevantStartHorizontalMovement),e.myLastValidOriginalVerticalMovement.vec3_copy(i.myInternalResults.myLastRelevantStartVerticalMovement),e.myLastValidEndHorizontalMovement.vec3_copy(i.myInternalResults.myLastRelevantEndHorizontalMovement),e.myLastValidEndVerticalMovement.vec3_copy(i.myInternalResults.myLastRelevantEndVerticalMovement),e.myLastValidSurfaceAdjustedHorizontalMovement.vec3_copy(i.myInternalResults.myLastRelevantAdjustedStartHorizontalMovement),e.myLastValidSurfaceAdjustedVerticalMovement.vec3_copy(i.myInternalResults.myLastRelevantAdjustedStartVerticalMovement),e.myIsOnGround=i.myGroundInfo.myOnSurface,e.myGroundAngle=i.myGroundInfo.mySurfaceAngle,e.myGroundPerceivedAngle=i.myGroundInfo.mySurfacePerceivedAngle,e.myGroundNormal.vec3_copy(i.myGroundInfo.mySurfaceNormal),e.myGroundHitMaxAngle=i.myGroundInfo.mySurfaceHitMaxAngle,e.myGroundHitMaxNormal.vec3_copy(i.myGroundInfo.mySurfaceHitMaxNormal),e.myGroundDistance=i.myGroundInfo.mySurfaceDistance,e.myGroundIsBaseInsideCollision=i.myGroundInfo.myBaseInsideCollision,e.myIsOnCeiling=i.myCeilingInfo.myOnSurface,e.myCeilingAngle=i.myCeilingInfo.mySurfaceAngle,e.myCeilingPerceivedAngle=i.myCeilingInfo.mySurfacePerceivedAngle,e.myCeilingNormal.vec3_copy(i.myCeilingInfo.mySurfaceNormal),e.myCeilingHitMaxAngle=i.myCeilingInfo.mySurfaceHitMaxAngle,e.myCeilingHitMaxNormal.vec3_copy(i.myCeilingInfo.mySurfaceHitMaxNormal),e.myCeilingDistance=i.myCeilingInfo.mySurfaceDistance,e.myCeilingIsBaseInsideCollision=i.myCeilingInfo.myBaseInsideCollision,e.myHorizontalMovementCanceled=i.myHorizontalMovementResults.myMovementFailed,e.myIsCollidingHorizontally=i.myHorizontalMovementResults.myMovementCollided,e.myHorizontalCollisionHit.copy(i.myHorizontalMovementResults.myReferenceCollisionHit),e.myVerticalMovementCanceled=i.myVerticalMovementResults.myMovementFailed,e.myIsCollidingVertically=i.myVerticalMovementResults.myMovementCollided,e.myVerticalCollisionHit.copy(i.myVerticalMovementResults.myReferenceCollisionHit),e.myHasSnappedOnGround=i.myGroundResults.myHasSnappedOnSurface,e.myHasSnappedOnCeiling=i.myCeilingResults.myHasSnappedOnSurface,e.myHasPoppedOutGround=i.myGroundResults.myHasPoppedOutSurface,e.myHasPoppedOutCeiling=i.myCeilingResults.myHasPoppedOutSurface,e.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleDownhill=i.myGroundResults.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleDownhill,e.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleUphill=i.myGroundResults.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleUphill,e.myVerticalMovementHasAdjustedHorizontalMovementBasedOnGroundAngleDownhill=i.myGroundResults.myHasVerticalMovementAdjustedHorizontalMovementBasedOnSurfaceAngleDownhill,e.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleDownhill=i.myCeilingResults.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleDownhill,e.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleUphill=i.myCeilingResults.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleUphill,e.myVerticalMovementHasAdjustedHorizontalMovementBasedOnCeilingAngleDownhill=i.myCeilingResults.myHasVerticalMovementAdjustedHorizontalMovementBasedOnSurfaceAngleDownhill,e.myIsSliding=i.myWallSlideResults.myHasSlid,e.mySlidingMovementAngle=i.myWallSlideResults.mySlideMovementAngle,e.mySlidingCollisionAngle=i.myWallSlideResults.mySlideMovementWallAngle,e.mySlidingWallNormal.vec3_copy(i.myWallSlideResults.myWallNormal),e.myIsSlidingIntoOppositeDirection=i.myInternalResults.myHasWallSlidTowardOppositeDirection,e.myIsSlidingFlickerPrevented=i.myInternalResults.myLastRelevantWallSlideFlickerPrevented,e.mySlidingFlickerPreventionCheckAnywayCounter=i.myInternalResults.myWallSlideFlickerPreventionForceCheckCounter,e.mySliding90DegreesSign=i.myInternalResults.myWallSlide90DegreesDirectionSign,e.mySlidingRecompute90DegreesSign=i.myInternalResults.myWallSlide90DegreesRecomputeDirectionSign,e.myLastValidIsSliding=i.myInternalResults.myLastRelevantHasWallSlid,e.mySlidingPreviousHorizontalMovement.vec3_copy(i.myInternalResults.myLastRelevantEndHorizontalMovement),e.myOriginalTeleportPosition.vec3_copy(i.myTeleportResults.myStartTeleportTransformQuat),e.myFixedTeleportPosition.vec3_copy(i.myTeleportResults.myEndTeleportTransformQuat),e.myTeleportCanceled=i.myTeleportResults.myTeleportFailed,e.myIsPositionOk=i.myCheckTransformResults.myCheckTransformFailed,i.myCheckTransformResults.myStartCheckTransformQuat.quat2_getPosition(e.myOriginalPositionCheckPosition),i.myCheckTransformResults.myEndCheckTransformQuat.quat2_getPosition(e.myFixedPositionCheckPosition),e.myIsTeleport=i.myCheckType==en.CHECK_TELEPORT,e.myIsMove=i.myCheckType==en.CHECK_MOVEMENT,e.myIsPositionCheck=i.myCheckType==en.CHECK_TRANSFORM,e.mySplitMovementSteps=i.mySplitMovementResults.myStepsToPerform,e.mySplitMovementStepsPerformed=i.mySplitMovementResults.myStepsPerformed,e.mySplitMovementStop=i.mySplitMovementResults.myMovementInterrupted,e.mySplitMovementMovementChecked.vec3_copy(i.mySplitMovementResults.myMovementChecked),e}var BT=function(){let i=z();return function(t,n,o){return o.reset(),t.myIsMove?o.myCheckType=en.CHECK_MOVEMENT:t.myIsTeleport?o.myCheckType=en.CHECK_TELEPORT:t.myIsPositionCheck&&(o.myCheckType=en.CHECK_TRANSFORM),i.quat_setForward(t.myOriginalForward,t.myOriginalUp),o.myTransformResults.myStartTransformQuat.quat2_setPositionRotationQuat(t.myOriginalPosition,i),o.myTransformResults.myEndTransformQuat.quat2_setPositionRotationQuat(t.myNewPosition,i),o.myMovementResults.myStartMovement.vec3_copy(t.myOriginalMovement),o.myMovementResults.myEndMovement.vec3_copy(t.myFixedMovement),o.myMovementResults.myMovementFailed=t.myHorizontalMovementCanceled&&t.myVerticalMovementCanceled,o.myMovementResults.myMovementCollided=t.myIsCollidingHorizontally||t.myIsCollidingVertically,t.myIsCollidingHorizontally?o.myMovementResults.myReferenceCollisionHit.copy(t.myHorizontalCollisionHit):t.myIsCollidingVertically&&o.myMovementResults.myReferenceCollisionHit.copy(t.myVerticalCollisionHit),o.myHorizontalMovementResults.myMovementFailed=t.myHorizontalMovementCanceled,o.myHorizontalMovementResults.myMovementCollided=t.myIsCollidingHorizontally,o.myHorizontalMovementResults.myReferenceCollisionHit.copy(t.myHorizontalCollisionHit),o.myVerticalMovementResults.myMovementFailed=t.myVerticalMovementCanceled,o.myVerticalMovementResults.myMovementCollided=t.myIsCollidingVertically,o.myVerticalMovementResults.myReferenceCollisionHit.copy(t.myVerticalCollisionHit),o.myTeleportResults.myStartTeleportTransformQuat.quat2_copy(o.myTransformResults.myStartTransformQuat),o.myTeleportResults.myStartTeleportTransformQuat.quat2_setPosition(t.myOriginalTeleportPosition),o.myTeleportResults.myEndTeleportTransformQuat.quat2_copy(o.myTransformResults.myEndTransformQuat),o.myTeleportResults.myEndTeleportTransformQuat.quat2_setPosition(t.myFixedTeleportPosition),o.myTeleportResults.myTeleportFailed=t.myTeleportCanceled,o.myCheckTransformResults.myStartCheckTransformQuat.quat2_copy(o.myTransformResults.myStartTransformQuat),o.myCheckTransformResults.myStartCheckTransformQuat.quat2_setPosition(t.myOriginalPositionCheckPosition),o.myCheckTransformResults.myEndCheckTransformQuat.quat2_copy(o.myTransformResults.myEndTransformQuat),o.myCheckTransformResults.myEndCheckTransformQuat.quat2_setPosition(t.myFixedPositionCheckPosition),o.myCheckTransformResults.myCheckTransformFailed=!t.myIsPositionOk,o.myWallSlideResults.myHasSlid=t.myIsSliding,o.myWallSlideResults.mySlideMovementAngle=t.mySlidingMovementAngle,o.myWallSlideResults.mySlideMovementWallAngle=t.mySlidingCollisionAngle,o.myWallSlideResults.myWallNormal.vec3_copy(ollisionRuntimeParams.mySlidingWallNormal),o.myGroundInfo.myOnSurface=t.myIsOnGround,o.myGroundInfo.mySurfaceAngle=t.myGroundAngle,o.myGroundInfo.mySurfacePerceivedAngle=t.myGroundPerceivedAngle,o.myGroundInfo.mySurfaceNormal.vec3_copy(t.myGroundNormal),o.myGroundInfo.mySurfaceHitMaxAngle=t.myGroundHitMaxAngle,o.myGroundInfo.mySurfaceHitMaxNormal.vec3_copy(t.myGroundHitMaxNormal),o.myGroundInfo.mySurfaceDistance=t.myGroundDistance,o.myGroundInfo.myBaseInsideCollision=t.myGroundIsBaseInsideCollision,o.myCeilingInfo.myOnSurface=t.myIsOnCeiling,o.myCeilingInfo.mySurfaceAngle=t.myCeilingAngle,o.myCeilingInfo.mySurfacePerceivedAngle=t.myCeilingPerceivedAngle,o.myCeilingInfo.mySurfaceNormal.vec3_copy(t.myCeilingNormal),o.myCeilingInfo.mySurfaceHitMaxAngle=t.myCeilingHitMaxAngle,o.myCeilingInfo.mySurfaceHitMaxNormal.vec3_copy(t.myCeilingHitMaxNormal),o.myCeilingInfo.mySurfaceDistance=t.myCeilingDistance,o.myCeilingInfo.myBaseInsideCollision=t.myCeilingIsBaseInsideCollision,o.myGroundResults.myHasSnappedOnSurface=t.myHasSnappedOnGround,o.myGroundResults.myHasPoppedOutSurface=t.myHasPoppedOutGround,o.myCeilingResults.myHasSnappedOnSurface=t.myHasSnappedOnCeiling,o.myCeilingResults.myHasPoppedOutSurface=t.myHasPoppedOutCeiling,o.myGroundResults.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleDownhill=t.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleDownhill,o.myGroundResults.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleUphill=t.myHorizontalMovementHasAdjustedVerticalMovementBasedOnGroundPerceivedAngleUphill,o.myGroundResults.myHasVerticalMovementAdjustedHorizontalMovementBasedOnSurfaceAngleDownhill=t.myVerticalMovementHasAdjustedHorizontalMovementBasedOnGroundAngleDownhill,o.myCeilingResults.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleDownhill=t.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleDownhill,o.myCeilingResults.myHasHorizontalMovementAdjustedVerticalMovementBasedOnSurfacePerceivedAngleUphill=t.myHorizontalMovementHasAdjustedVerticalMovementBasedOnCeilingPerceivedAngleUphill,o.myCeilingResults.myHasVerticalMovementAdjustedHorizontalMovementBasedOnSurfaceAngleDownhill=t.myVerticalMovementHasAdjustedHorizontalMovementBasedOnCeilingAngleDownhill,o.mySplitMovementResults.myStepsToPerform=t.mySplitMovementSteps,o.mySplitMovementResults.myStepsPerformed=t.mySplitMovementStepsPerformed,o.mySplitMovementResults.myMovementInterrupted=t.mySplitMovementStop,o.mySplitMovementResults.myMovementChecked.vec3_copy(t.mySplitMovementMovementChecked),o.myInternalResults.myLastRelevantStartHorizontalMovement.vec3_copy(t.myLastValidOriginalHorizontalMovement),o.myInternalResults.myLastRelevantEndHorizontalMovement.vec3_copy(t.myLastValidEndHorizontalMovement),o.myInternalResults.myLastRelevantStartVerticalMovement.vec3_copy(t.myLastValidOriginalVerticalMovement),o.myInternalResults.myLastRelevantEndVerticalMovement.vec3_copy(t.myLastValidEndVerticalMovement),o.myInternalResults.myLastRelevantAdjustedStartHorizontalMovement.vec3_copy(t.myLastValidSurfaceAdjustedHorizontalMovement),o.myInternalResults.myLastRelevantAdjustedStartVerticalMovement.vec3_copy(t.myLastValidSurfaceAdjustedVerticalMovement),o.myInternalResults.myLastRelevantHasWallSlid=t.myLastValidIsSliding,o.myInternalResults.myHasWallSlidTowardOppositeDirection=t.myIsSlidingIntoOppositeDirection,o.myInternalResults.myLastRelevantWallSlideFlickerPrevented=t.myIsSlidingFlickerPrevented,o.myInternalResults.myWallSlideFlickerPreventionForceCheckCounter=t.mySlidingFlickerPreventionCheckAnywayCounter,o.myInternalResults.myWallSlide90DegreesDirectionSign=t.mySliding90DegreesSign,o.myInternalResults.myWallSlide90DegreesRecomputeDirectionSign=t.mySlidingRecompute90DegreesSign,o.myTransformResults.myStartTransformQuat.quat2_copy(n),o}}(),IT=function(){return function(e,t){return t.myHeight=e.myHeight,t.myRadius=e.myHorizontalCheckParams.myHorizontalCheckConeRadius,t.myDistanceFromFeetToIgnore=e.myHorizontalCheckParams.myHorizontalCheckFeetDistanceToIgnore,t.myDistanceFromHeadToIgnore=e.myHorizontalCheckParams.myHorizontalCheckHeadDistanceToIgnore,t.myHorizontalMovementCheckEnabled=e.myHorizontalCheckParams.myHorizontalMovementCheckEnabled,t.myHorizontalMovementStepEnabled=e.myHorizontalCheckParams.myHorizontalMovementCheckSplitMovementEnabled,t.myHorizontalMovementStepMaxLength=e.myHorizontalCheckParams.myHorizontalMovementCheckSplitMovementMaxStepLength,t.myHorizontalMovementRadialStepAmount=e.myHorizontalCheckParams.myHorizontalMovementCheckRadialSteps,t.myHorizontalMovementCheckDiagonalOutward=e.myHorizontalCheckParams.myHorizontalMovementHorizontalDiagonalOutwardCheckEnabled,t.myHorizontalMovementCheckDiagonalInward=e.myHorizontalCheckParams.myHorizontalMovementHorizontalDiagonalInwardCheckEnabled,t.myHorizontalMovementCheckStraight=e.myHorizontalCheckParams.myHorizontalMovementHorizontalStraightCheckEnabled,t.myHorizontalMovementCheckHorizontalBorder=e.myHorizontalCheckParams.myHorizontalMovementHorizontalRadialCheckEnabled,t.myHorizontalMovementCheckVerticalStraight=e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightCheckEnabled,t.myHorizontalMovementCheckVerticalDiagonalUpwardOutward=e.myHorizontalCheckParams.myHorizontalMovementVerticalDiagonalOutwardUpwardCheckEnabled,t.myHorizontalMovementCheckVerticalDiagonalUpwardInward=e.myHorizontalCheckParams.myHorizontalMovementVerticalDiagonalInwardUpwardCheckEnabled,t.myHorizontalMovementCheckVerticalDiagonalDownwardOutward=e.myHorizontalCheckParams.myHorizontalMovementVerticalDiagonalOutwardDownwardCheckEnabled,t.myHorizontalMovementCheckVerticalDiagonalDownwardInward=e.myHorizontalCheckParams.myHorizontalMovementVerticalDiagonalInwardDownwardCheckEnabled,t.myHorizontalMovementCheckVerticalStraightDiagonalUpward=e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalUpwardCheckEnabled,t.myHorizontalMovementCheckVerticalStraightDiagonalDownward=e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalDownwardCheckEnabled,t.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward=e.myHorizontalCheckParams.myHorizontalMovementVerticalRadialDiagonalOutwardCheckEnabled,t.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward=e.myHorizontalCheckParams.myHorizontalMovementVerticalRadialDiagonalInwardCheckEnabled,t.myHorizontalMovementHorizontalStraightCentralCheckEnabled=e.myHorizontalCheckParams.myHorizontalMovementHorizontalStraightCentralCheckEnabled,t.myHorizontalMovementVerticalStraightCentralCheckEnabled=e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightCentralCheckEnabled,t.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled,t.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled=e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled,t.myHorizontalPositionCheckEnabled=e.myHorizontalCheckParams.myHorizontalPositionCheckEnabled,t.myHalfConeAngle=e.myHorizontalCheckParams.myHorizontalCheckConeHalfAngle,t.myHalfConeSliceAmount=e.myHorizontalCheckParams.myHorizontalPositionCheckConeHalfSlices,t.myCheckConeBorder=e.myHorizontalCheckParams.myHorizontalPositionHorizontalBorderCheckEnabled,t.myCheckConeRay=e.myHorizontalCheckParams.myHorizontalPositionHorizontalRadialCheckEnabled,t.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision=e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckIgnoreHitsInsideCollision,t.myHorizontalPositionCheckVerticalDirectionType=e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckDirection,t.myCheckHeight=e.myHorizontalCheckParams.myHorizontalHeightCheckEnabled,t.myCheckHeightVerticalMovement=e.myHorizontalCheckParams.myHorizontalMovementHeightVerticalCheckEnabled,t.myCheckHeightVerticalPosition=e.myHorizontalCheckParams.myHorizontalPositionHeightVerticalCheckEnabled,t.myCheckHeightTopMovement=e.myHorizontalCheckParams.myHorizontalMovementHeightHorizontalCheckEnabled,t.myCheckHeightTopPosition=e.myHorizontalCheckParams.myHorizontalPositionHeightHorizontalCheckEnabled,t.myCheckHeightConeOnCollision=e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHit,t.myCheckHeightConeOnCollisionKeepHit=e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHitKeepVerticalHitIfNoHorizontalHit,t.myHeightCheckStepAmountMovement=e.myHorizontalCheckParams.myHorizontalMovementHeightCheckSteps,t.myHeightCheckStepAmountPosition=e.myHorizontalCheckParams.myHorizontalPositionHeightCheckSteps,t.myCheckVerticalStraight=e.myHorizontalCheckParams.myHorizontalPositionVerticalStraightCheckEnabled,t.myCheckVerticalDiagonalRayOutward=e.myHorizontalCheckParams.myHorizontalPositionVerticalRadialDiagonalOutwardCheckEnabled,t.myCheckVerticalDiagonalRayInward=e.myHorizontalCheckParams.myHorizontalPositionVerticalRadialDiagonalInwardCheckEnabled,t.myCheckVerticalDiagonalBorderOutward=e.myHorizontalCheckParams.myHorizontalPositionVerticalBorderDiagonalOutwardCheckEnabled,t.myCheckVerticalDiagonalBorderInward=e.myHorizontalCheckParams.myHorizontalPositionVerticalBorderDiagonalInwardCheckEnabled,t.myCheckVerticalDiagonalBorderRayOutward=e.myHorizontalCheckParams.myHorizontalPositionVerticalRadialBorderDiagonalOutwardCheckEnabled,t.myCheckVerticalDiagonalBorderRayInward=e.myHorizontalCheckParams.myHorizontalPositionVerticalRadialBorderDiagonalInwardCheckEnabled,t.myCheckVerticalSearchFartherVerticalHit=e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckGetFarthestHit,t.myCheckHorizontalFixedForwardEnabled=e.myHorizontalCheckParams.myHorizontalCheckFixedForwardEnabled,t.myCheckHorizontalFixedForward.vec3_copy(e.myHorizontalCheckParams.myHorizontalCheckFixedForward),t.myVerticalMovementCheckEnabled=e.myVerticalCheckParams.myVerticalMovementCheckEnabled,t.myVerticalPositionCheckEnabled=e.myVerticalCheckParams.myVerticalPositionCheckEnabled,t.myFeetRadius=e.myVerticalCheckParams.myVerticalCheckCircumferenceRadius,t.myAdjustVerticalMovementWithGroundAngleDownhill=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhill,t.myAdjustVerticalMovementWithGroundAngleUphill=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphill,t.myAdjustVerticalMovementWithGroundAngleDownhillMaxAngle=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhillMaxSurfaceAngle,t.myAdjustVerticalMovementWithGroundAngleUphillMaxAngle=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphillMaxSurfaceAngle,t.myAdjustVerticalMovementWithGroundAngleDownhillMaxPerceivedAngle=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhillMaxSurfacePerceivedAngle,t.myAdjustVerticalMovementWithGroundAngleUphillMaxPerceivedAngle=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphillMaxSurfacePerceivedAngle,t.myAdjustHorizontalMovementWithGroundAngleDownhill=e.myGroundParams.myVerticalMovementAdjustHorizontalMovementBasedOnSurfaceAngleDownhill,t.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle=e.myGroundParams.myVerticalMovementAdjustHorizontalMovementBasedOnSurfaceAngleDownhillMinSurfaceAngle,t.myAdjustVerticalMovementWithCeilingAngleDownhill=e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhill,t.myAdjustVerticalMovementWithCeilingAngleUphill=e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphill,t.myAdjustVerticalMovementWithCeilingAngleDownhillMaxAngle=e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhillMaxSurfaceAngle,t.myAdjustVerticalMovementWithCeilingAngleUphillMaxAngle=e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphillMaxSurfaceAngle,t.myAdjustVerticalMovementWithCeilingAngleDownhillMaxPerceivedAngle=e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhillMaxSurfacePerceivedAngle,t.myAdjustVerticalMovementWithCeilingAngleUphillMaxPerceivedAngle=e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphillMaxSurfacePerceivedAngle,t.myAdjustHorizontalMovementWithCeilingAngleDownhill=e.myCeilingParams.myVerticalMovementAdjustHorizontalMovementBasedOnSurfaceAngleDownhill,t.myAdjustHorizontalMovementWithCeilingAngleDownhillMinAngle=e.myCeilingParams.myVerticalMovementAdjustHorizontalMovementBasedOnSurfaceAngleDownhillMinSurfaceAngle,t.myCheckVerticalFixedForwardEnabled=e.myVerticalCheckParams.myVerticalCheckFixedForwardEnabled,t.myCheckVerticalFixedForward.vec3_copy(e.myVerticalCheckParams.myVerticalCheckFixedForward),t.myCheckVerticalBothDirection=e.myVerticalCheckParams.myVerticalMovementCheckPerformCheckOnBothSides,t.myVerticalMovementReduceEnabled=e.myVerticalCheckParams.myVerticalMovementCheckReductionEnabled,t.myGroundCircumferenceAddCenter=e.myVerticalCheckParams.myVerticalCheckCircumferenceCentralCheckEnabled,t.myGroundCircumferenceSliceAmount=e.myVerticalCheckParams.myVerticalCheckCircumferenceSlices,t.myGroundCircumferenceStepAmount=e.myVerticalCheckParams.myVerticalCheckCircumferenceRadialSteps,t.myGroundCircumferenceRotationPerStep=e.myVerticalCheckParams.myVerticalCheckCircumferenceRotationPerRadialStep,t.myVerticalAllowHitInsideCollisionIfOneOk=e.myVerticalCheckParams.myVerticalCheckAllowHitsInsideCollisionIfOneValid,t.myHorizontalBlockLayerFlags.copy(e.myHorizontalCheckParams.myHorizontalCheckBlockLayerFlags),t.myVerticalBlockLayerFlags.copy(e.myVerticalCheckParams.myVerticalCheckBlockLayerFlags),t.myHorizontalObjectsToIgnore.pp_copy(e.myHorizontalCheckParams.myHorizontalCheckObjectsToIgnore),t.myVerticalObjectsToIgnore.pp_copy(e.myVerticalCheckParams.myVerticalCheckObjectsToIgnore),t.mySnapOnGroundEnabled=e.myGroundParams.mySurfaceSnapEnabled,t.mySnapOnGroundExtraDistance=e.myGroundParams.mySurfaceSnapMaxDistance,t.mySnapOnCeilingEnabled=e.myCeilingParams.mySurfaceSnapEnabled,t.mySnapOnCeilingExtraDistance=e.myCeilingParams.mySurfaceSnapMaxDistance,t.myGroundPopOutEnabled=e.myGroundParams.mySurfacePopOutEnabled,t.myGroundPopOutExtraDistance=e.myGroundParams.mySurfacePopOutMaxDistance,t.myCeilingPopOutEnabled=e.myCeilingParams.mySurfacePopOutEnabled,t.myCeilingPopOutExtraDistance=e.myCeilingParams.mySurfacePopOutMaxDistance,t.myGroundAngleToIgnore=e.myGroundParams.mySurfaceAngleToIgnore,t.myGroundAngleToIgnoreWithPerceivedAngle=e.myGroundParams.mySurfaceAngleToIgnoreWithSurfacePerceivedAngle,t.myCeilingAngleToIgnore=e.myCeilingParams.mySurfaceAngleToIgnore,t.myCeilingAngleToIgnoreWithPerceivedAngle=e.myCeilingParams.mySurfaceAngleToIgnoreWithSurfacePerceivedAngle,t.myHorizontalMovementGroundAngleIgnoreHeight=e.myGroundParams.myHorizontalMovementSurfaceAngleToIgnoreMaxVerticalDistance,t.myHorizontalMovementCeilingAngleIgnoreHeight=e.myCeilingParams.myHorizontalMovementSurfaceAngleToIgnoreMaxVerticalDistance,t.myHorizontalPositionGroundAngleIgnoreHeight=e.myGroundParams.myHorizontalPositionSurfaceAngleToIgnoreMaxVerticalDistance,t.myHorizontalPositionCeilingAngleIgnoreHeight=e.myCeilingParams.myHorizontalPositionSurfaceAngleToIgnoreMaxVerticalDistance,t.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft=e.myGroundParams.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft,t.myHorizontalMovementCeilingAngleIgnoreMaxMovementLeft=e.myCeilingParams.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft,t.myComputeGroundInfoEnabled=e.myGroundParams.myCollectSurfaceInfo,t.myComputeCeilingInfoEnabled=e.myCeilingParams.myCollectSurfaceInfo,t.myDistanceToBeOnGround=e.myGroundParams.myOnSurfaceMaxOutsideDistance,t.myDistanceToComputeGroundInfo=e.myGroundParams.myCollectSurfaceNormalMaxOutsideDistance,t.myDistanceToBeOnCeiling=e.myCeilingParams.myOnSurfaceMaxOutsideDistance,t.myDistanceToComputeCeilingInfo=e.myCeilingParams.myCollectSurfaceNormalMaxOutsideDistance,t.myVerticalFixToBeOnGround=e.myGroundParams.myOnSurfaceMaxInsideDistance,t.myVerticalFixToComputeGroundInfo=e.myGroundParams.myCollectSurfaceNormalMaxInsideDistance,t.myVerticalFixToBeOnCeiling=e.myCeilingParams.myOnSurfaceMaxInsideDistance,t.myVerticalFixToComputeCeilingInfo=e.myCeilingParams.myCollectSurfaceNormalMaxInsideDistance,t.myGroundIsBaseInsideCollisionCheckEnabled=e.myGroundParams.myBaseInsideCollisionCheckEnabled,t.myCeilingIsBaseInsideCollisionCheckEnabled=e.myCeilingParams.myBaseInsideCollisionCheckEnabled,t.myIsOnGroundIfInsideHit=e.myGroundParams.myOnSurfaceIfBaseInsideCollision,t.myIsOnCeilingIfInsideHit=e.myCeilingParams.myOnSurfaceIfBaseInsideCollision,t.myFindGroundDistanceMaxOutsideDistance=e.myGroundParams.myFindSurfaceDistanceMaxOutsideDistance,t.myFindGroundDistanceMaxInsideDistance=e.myGroundParams.myFindSurfaceDistanceMaxInsideDistance,t.myFindCeilingDistanceMaxOutsideDistance=e.myCeilingParams.myFindSurfaceDistanceMaxOutsideDistance,t.myFindCeilingDistanceMaxInsideDistance=e.myCeilingParams.myFindSurfaceDistanceMaxInsideDistance,t.myAllowGroundSteepFix=e.myGroundParams.myHorizontalMovementAllowExitAttemptWhenOnNotIgnorableSurfacePerceivedAngle,t.myAllowCeilingSteepFix=e.myCeilingParams.myHorizontalMovementAllowExitAttemptWhenOnNotIgnorableSurfacePerceivedAngle,t.myMustStayOnGround=e.myGroundParams.myMovementMustStayOnSurface,t.myMustStayOnCeiling=e.myCeilingParams.myMovementMustStayOnSurface,t.myRegatherGroundInfoOnSurfaceCheckFail=e.myGroundParams.myRecollectSurfaceInfoOnSurfaceCheckFailed,t.myRegatherCeilingInfoOnSurfaceCheckFail=e.myCeilingParams.myRecollectSurfaceInfoOnSurfaceCheckFailed,t.myMustStayBelowIgnorableGroundAngleDownhill=e.myGroundParams.myMovementMustStayOnIgnorableSurfaceAngleDownhill,t.myMustStayBelowIgnorableCeilingAngleDownhill=e.myCeilingParams.myMovementMustStayOnIgnorableSurfaceAngleDownhill,t.myMustStayBelowGroundAngleDownhill=e.myGroundParams.myMovementMustStayOnSurfaceAngleDownhill,t.myMustStayBelowCeilingAngleDownhill=e.myCeilingParams.myMovementMustStayOnSurfaceAngleDownhill,t.myMovementMustStayOnGroundHitAngle=e.myGroundParams.myMovementMustStayOnSurfaceHitMaxAngle,t.myMovementMustStayOnCeilingHitAngle=e.myCeilingParams.myMovementMustStayOnSurfaceHitMaxAngle,t.myTeleportMustBeOnIgnorableGroundAngle=e.myGroundParams.myTeleportMustBeOnIgnorableSurfaceAngle,t.myCheckTransformMustBeOnIgnorableGroundAngle=e.myGroundParams.myCheckTransformMustBeOnIgnorableSurfaceAngle,t.myTeleportMustBeOnIgnorableCeilingAngle=e.myCeilingParams.myTeleportMustBeOnIgnorableSurfaceAngle,t.myCheckTransformMustBeOnIgnorableCeilingAngle=e.myCeilingParams.myCheckTransformMustBeOnIgnorableSurfaceAngle,t.myTeleportMustBeOnGroundAngle=e.myGroundParams.myTeleportMustBeOnSurfaceAngle,t.myCheckTransformMustBeOnGroundAngle=e.myGroundParams.myCheckTransformMustBeOnSurfaceAngle,t.myTeleportMustBeOnCeilingAngle=e.myCeilingParams.myTeleportMustBeOnSurfaceAngle,t.myCheckTransformMustBeOnCeilingAngle=e.myCeilingParams.myCheckTransformMustBeOnSurfaceAngle,t.myTeleportMustBeOnGround=e.myGroundParams.myTeleportMustBeOnSurface,t.myCheckTransformMustBeOnGround=e.myGroundParams.myCheckTransformMustBeOnSurface,t.myTeleportMustBeOnCeiling=e.myCeilingParams.myTeleportMustBeOnSurface,t.myCheckTransformMustBeOnCeiling=e.myCeilingParams.myCheckTransformMustBeOnSurface,t.mySlidingEnabled=e.myWallSlideParams.myWallSlideEnabled,t.mySlidingHorizontalMovementCheckBetterNormal=e.myHorizontalCheckParams.myHorizontalMovementCheckGetBetterReferenceHit,t.mySlidingMaxAttempts=e.myWallSlideParams.myWallSlideMaxAttempts,t.mySlidingCheckBothDirections=e.myWallSlideParams.myCheckBothWallSlideDirections,t.mySlidingFlickeringPreventionType=e.myWallSlideParams.myWallSlideFlickerPreventionMode,t.mySlidingFlickeringPreventionCheckOnlyIfAlreadySliding=e.myWallSlideParams.myWallSlideFlickerPreventionCheckOnlyIfAlreadySliding,t.mySlidingFlickerPreventionCheckAnywayCounter=e.myWallSlideParams.myWallSlideFlickerPreventionForceCheckCounter,t.mySlidingAdjustSign90Degrees=e.myWallSlideParams.my90DegreesWallSlideAdjustDirectionSign,t.mySplitMovementEnabled=e.mySplitMovementParams.mySplitMovementEnabled,t.mySplitMovementMaxLength=e.mySplitMovementParams.mySplitMovementMaxStepLength,t.mySplitMovementMaxStepsEnabled=e.mySplitMovementParams.mySplitMovementMaxSteps!=null,t.mySplitMovementMaxSteps=e.mySplitMovementParams.mySplitMovementMaxSteps,t.mySplitMovementStepEqualLength=e.mySplitMovementParams.mySplitMovementMaxStepLength==null,t.mySplitMovementStepEqualLengthMinLength=e.mySplitMovementParams.mySplitMovementMinStepLength,t.mySplitMovementStopWhenHorizontalMovementCanceled=e.mySplitMovementParams.mySplitMovementStopOnHorizontalMovementFailed,t.mySplitMovementStopWhenVerticalMovementCanceled=e.mySplitMovementParams.mySplitMovementStopOnVerticalMovementFailed,t.mySplitMovementStopCallback=e.mySplitMovementParams.mySplitMovementStopOnCallback,t.mySplitMovementStopReturnPrevious=e.mySplitMovementParams.mySplitMovementStopReturnPreviousResults,t.myPositionOffsetLocal.vec3_copy(e.myAdditionalParams.myPositionOffsetLocal),t.myRotationOffsetLocalQuat.quat_copy(e.myAdditionalParams.myRotationOffsetLocalQuat),t.myDebugEnabled=e.myDebugParams.myVisualDebugEnabled,t.myDebugHorizontalMovementEnabled=e.myDebugParams.myVisualDebugHorizontalMovementCheckEnabled,t.myDebugHorizontalPositionEnabled=e.myDebugParams.myVisualDebugHorizontalPositionCheckEnabled,t.myDebugVerticalMovementEnabled=e.myDebugParams.myVisualDebugVerticalMovementCheckEnabled,t.myDebugVerticalPositionEnabled=e.myDebugParams.myVisualDebugVerticalPositionCheckEnabled,t.myDebugSlidingEnabled=e.myDebugParams.myVisualDebugSlideEnabled,t.myDebugGroundInfoEnabled=e.myDebugParams.myVisualDebugGroundInfoEnabled,t.myDebugCeilingInfoEnabled=e.myDebugParams.myVisualDebugGroundInfoEnabled,t.myDebugRuntimeParamsEnabled=e.myDebugParams.myVisualDebugResultsEnabled,t.myDebugMovementEnabled=e.myDebugParams.myVisualDebugMovementEnabled,t}}(),mi={initBridge:MT,checkMovement:ET,checkTeleportToTransform:DT,checkTransform:RT,updateGroundInfo:AT,updateCeilingInfo:VT,convertCharacterCollisionResultsToCollisionRuntimeParams:OT,convertCollisionRuntimeParamsToCharacterCollisionResults:BT,convertCharacterColliderSetupToCollisionCheckParams:IT};var co=class{constructor(){this.myHeight=0,this.myHorizontalCheckParams=new Zs,this.myVerticalCheckParams=new Ys,this.myWallSlideParams=new $s,this.myGroundParams=new ms,this.myCeilingParams=new ms,this.mySplitMovementParams=new ea,this.myAdditionalParams=new ta,this.myDebugParams=new ia}copy(e){}},HT={UPWARD:0,DOWNWARD:1,BOTH:2},Zs=class{constructor(){this.myHorizontalCheckConeRadius=0,this.myHorizontalCheckConeHalfAngle=0,this.myHorizontalHeightCheckEnabled=!1,this.myHorizontalCheckFeetDistanceToIgnore=0,this.myHorizontalCheckHeadDistanceToIgnore=0,this.myHorizontalCheckFixedForwardEnabled=!1,this.myHorizontalCheckFixedForward=m(),this.myHorizontalMovementCheckEnabled=!1,this.myHorizontalMovementCheckRadialSteps=0,this.myHorizontalMovementCheckSplitMovementEnabled=!1,this.myHorizontalMovementCheckSplitMovementMaxSteps=null,this.myHorizontalMovementCheckSplitMovementMaxStepLength=null,this.myHorizontalMovementCheckSplitMovementMinStepLength=null,this.myHorizontalMovementCheckGetBetterReferenceHit=!1,this.myHorizontalMovementHorizontalRadialCheckEnabled=!1,this.myHorizontalMovementHorizontalDiagonalOutwardCheckEnabled=!1,this.myHorizontalMovementHorizontalDiagonalInwardCheckEnabled=!1,this.myHorizontalMovementHorizontalStraightCheckEnabled=!1,this.myHorizontalMovementHorizontalStraightCentralCheckEnabled=!1,this.myHorizontalMovementHeightCheckSteps=0,this.myHorizontalMovementHeightHorizontalCheckEnabled=!1,this.myHorizontalMovementHeightVerticalCheckEnabled=!1,this.myHorizontalMovementVerticalRadialDiagonalOutwardCheckEnabled=!1,this.myHorizontalMovementVerticalRadialDiagonalInwardCheckEnabled=!1,this.myHorizontalMovementVerticalDiagonalOutwardUpwardCheckEnabled=!1,this.myHorizontalMovementVerticalDiagonalOutwardDownwardCheckEnabled=!1,this.myHorizontalMovementVerticalDiagonalInwardUpwardCheckEnabled=!1,this.myHorizontalMovementVerticalDiagonalInwardDownwardCheckEnabled=!1,this.myHorizontalMovementVerticalStraightCheckEnabled=!1,this.myHorizontalMovementVerticalStraightCentralCheckEnabled=!1,this.myHorizontalMovementVerticalStraightDiagonalUpwardCheckEnabled=!1,this.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=!1,this.myHorizontalMovementVerticalStraightDiagonalDownwardCheckEnabled=!1,this.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled=!1,this.myHorizontalPositionCheckEnabled=!1,this.myHorizontalPositionCheckConeHalfSlices=0,this.myHorizontalPositionHorizontalBorderCheckEnabled=!1,this.myHorizontalPositionHorizontalRadialCheckEnabled=!1,this.myHorizontalPositionHeightCheckSteps=0,this.myHorizontalPositionHeightHorizontalCheckEnabled=!1,this.myHorizontalPositionHeightVerticalCheckEnabled=!1,this.myHorizontalPositionVerticalStraightCheckEnabled=!1,this.myHorizontalPositionVerticalStraightCentralCheckEnabled=!1,this.myHorizontalPositionVerticalRadialDiagonalOutwardCheckEnabled=!1,this.myHorizontalPositionVerticalRadialDiagonalInwardCheckEnabled=!1,this.myHorizontalPositionVerticalBorderDiagonalOutwardCheckEnabled=!1,this.myHorizontalPositionVerticalBorderDiagonalInwardCheckEnabled=!1,this.myHorizontalPositionVerticalRadialBorderDiagonalOutwardCheckEnabled=!1,this.myHorizontalPositionVerticalRadialBorderDiagonalInwardCheckEnabled=!1,this.myHorizontalPositionVerticalCheckGetFarthestHit=!1,this.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHit=!1,this.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHitKeepVerticalHitIfNoHorizontalHit=!1,this.myHorizontalPositionVerticalCheckIgnoreHitsInsideCollision=!1,this.myHorizontalPositionVerticalCheckDirection=HT.UPWARD,this.myHorizontalCheckBlockLayerFlags=new Re,this.myHorizontalCheckObjectsToIgnore=[]}copy(e){}},Ys=class{constructor(){this.myVerticalCheckCircumferenceRadius=0,this.myVerticalCheckCircumferenceSlices=0,this.myVerticalCheckCircumferenceCentralCheckEnabled=!1,this.myVerticalCheckCircumferenceRadialSteps=0,this.myVerticalCheckCircumferenceRotationPerRadialStep=0,this.myVerticalCheckFixedForwardEnabled=!1,this.myVerticalCheckFixedForward=m(),this.myVerticalMovementCheckEnabled=!1,this.myVerticalMovementCheckReductionEnabled=!1,this.myVerticalMovementCheckPerformCheckOnBothSides=!1,this.myVerticalPositionCheckEnabled=!1,this.myVerticalCheckAllowHitsInsideCollisionIfOneValid=!1,this.myVerticalCheckBlockLayerFlags=new Re,this.myVerticalCheckObjectsToIgnore=[]}copy(e){}},na={NONE:0,USE_PREVIOUS_RESULTS:1,COLLISION_ANGLE_ABOVE_90_DEGREES:2,COLLISION_ANGLE_ABOVE_90_DEGREES_OR_MOVEMENT_ANGLE_ABOVE_85_DEGREES:3,ALWAYS:4},$s=class{constructor(){this.myWallSlideEnabled=!1,this.myWallSlideMaxAttempts=0,this.myCheckBothWallSlideDirections=!1,this.myWallSlideFlickerPreventionMode=na.NONE,this.myWallSlideFlickerPreventionCheckOnlyIfAlreadySliding=!1,this.myWallSlideFlickerPreventionForceCheckCounter=0,this.my90DegreesWallSlideAdjustDirectionSign=!1}copy(e){}},ms=class{constructor(){this.mySurfaceSnapEnabled=!1,this.mySurfaceSnapMaxDistance=0,this.mySurfacePopOutEnabled=!1,this.mySurfacePopOutMaxDistance=0,this.mySurfaceAngleToIgnore=0,this.mySurfaceAngleToIgnoreWithSurfacePerceivedAngle=null,this.myHorizontalMovementSurfaceAngleToIgnoreMaxVerticalDistance=null,this.myHorizontalPositionSurfaceAngleToIgnoreMaxVerticalDistance=null,this.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft=null,this.myCollectSurfaceInfo=!1,this.myOnSurfaceMaxOutsideDistance=0,this.myOnSurfaceMaxInsideDistance=0,this.myBaseInsideCollisionCheckEnabled=!1,this.myOnSurfaceIfBaseInsideCollision=!1,this.myCollectSurfaceNormalMaxOutsideDistance=0,this.myCollectSurfaceNormalMaxInsideDistance=0,this.myFindSurfaceDistanceMaxOutsideDistance=0,this.myFindSurfaceDistanceMaxInsideDistance=0,this.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhill=!1,this.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphill=!1,this.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhillMaxSurfaceAngle=null,this.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphillMaxSurfaceAngle=null,this.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhillMaxSurfacePerceivedAngle=null,this.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphillMaxSurfacePerceivedAngle=null,this.myVerticalMovementAdjustHorizontalMovementBasedOnSurfaceAngleDownhill=!1,this.myVerticalMovementAdjustHorizontalMovementBasedOnSurfaceAngleDownhillMinSurfaceAngle=null,this.myMovementMustStayOnSurface=!1,this.myMovementMustStayOnSurfaceHitMaxAngle=null,this.myMovementMustStayOnIgnorableSurfaceAngleDownhill=!1,this.myMovementMustStayOnSurfaceAngleDownhill=null,this.myTeleportMustBeOnSurface=!1,this.myTeleportMustBeOnIgnorableSurfaceAngle=!1,this.myTeleportMustBeOnSurfaceAngle=null,this.myCheckTransformMustBeOnSurface=!1,this.myCheckTransformMustBeOnIgnorableSurfaceAngle=!1,this.myCheckTransformMustBeOnSurfaceAngle=null,this.myRecollectSurfaceInfoOnSurfaceCheckFailed=!1,this.myHorizontalMovementAllowExitAttemptWhenOnNotIgnorableSurfacePerceivedAngle=!1}copy(e){}},ea=class{constructor(){this.mySplitMovementEnabled=!1,this.mySplitMovementMaxSteps=null,this.mySplitMovementMaxStepLength=null,this.mySplitMovementMinStepLength=null,this.mySplitMovementStopOnHorizontalMovementFailed=!1,this.mySplitMovementStopOnVerticalMovementFailed=!1,this.mySplitMovementStopReturnPreviousResults=!1}copy(e){}},ta=class{constructor(){this.myPositionOffsetLocal=m(),this.myRotationOffsetLocalQuat=z()}copy(e){}},ia=class{constructor(){this.myVisualDebugEnabled=!1,this.myVisualDebugMovementEnabled=!1,this.myVisualDebugHorizontalMovementCheckEnabled=!1,this.myVisualDebugHorizontalPositionCheckEnabled=!1,this.myVisualDebugVerticalMovementCheckEnabled=!1,this.myVisualDebugVerticalPositionCheckEnabled=!1,this.myVisualDebugSlideEnabled=!1,this.myVisualDebugGroundInfoEnabled=!1,this.myVisualDebugCeilingInfoEnabled=!1,this.myVisualDebugResultsEnabled=!1}copy(e){}};co.prototype.copy=function(e){this.myHeight=e.myHeight,this.myHorizontalCheckParams.copy(e.myHorizontalCheckParams),this.myVerticalCheckParams.copy(e.myVerticalCheckParams),this.myWallSlideParams.copy(e.myWallSlideParams),this.myGroundParams.copy(e.myGroundParams),this.myCeilingParams.copy(e.myCeilingParams),this.mySplitMovementParams.copy(e.mySplitMovementParams),this.myAdditionalParams.copy(e.myAdditionalParams),this.myDebugParams.copy(e.myDebugParams)};Zs.prototype.copy=function(e){this.myHorizontalCheckConeRadius=e.myHorizontalCheckConeRadius,this.myHorizontalCheckConeHalfAngle=e.myHorizontalCheckConeHalfAngle,this.myHorizontalHeightCheckEnabled=e.myHorizontalHeightCheckEnabled,this.myHorizontalCheckFeetDistanceToIgnore=e.myHorizontalCheckFeetDistanceToIgnore,this.myHorizontalCheckHeadDistanceToIgnore=e.myHorizontalCheckHeadDistanceToIgnore,this.myHorizontalCheckFixedForwardEnabled=e.myHorizontalCheckFixedForwardEnabled,this.myHorizontalCheckFixedForward.vec3_copy(e.myHorizontalCheckFixedForward),this.myHorizontalMovementCheckEnabled=e.myHorizontalMovementCheckEnabled,this.myHorizontalMovementCheckRadialSteps=e.myHorizontalMovementCheckRadialSteps,this.myHorizontalMovementCheckSplitMovementEnabled=e.myHorizontalMovementCheckSplitMovementEnabled,this.myHorizontalMovementCheckSplitMovementMaxSteps=e.myHorizontalMovementCheckSplitMovementMaxSteps,this.myHorizontalMovementCheckSplitMovementMaxStepLength=e.myHorizontalMovementCheckSplitMovementMaxStepLength,this.myHorizontalMovementCheckSplitMovementMinStepLength=e.myHorizontalMovementCheckSplitMovementMinStepLength,this.myHorizontalMovementCheckGetBetterReferenceHit=e.myHorizontalMovementCheckGetBetterReferenceHit,this.myHorizontalMovementHorizontalRadialCheckEnabled=e.myHorizontalMovementHorizontalRadialCheckEnabled,this.myHorizontalMovementHorizontalDiagonalOutwardCheckEnabled=e.myHorizontalMovementHorizontalDiagonalOutwardCheckEnabled,this.myHorizontalMovementHorizontalDiagonalInwardCheckEnabled=e.myHorizontalMovementHorizontalDiagonalInwardCheckEnabled,this.myHorizontalMovementHorizontalStraightCheckEnabled=e.myHorizontalMovementHorizontalStraightCheckEnabled,this.myHorizontalMovementHorizontalStraightCentralCheckEnabled=e.myHorizontalMovementHorizontalStraightCentralCheckEnabled,this.myHorizontalMovementHeightCheckSteps=e.myHorizontalMovementHeightCheckSteps,this.myHorizontalMovementHeightVerticalCheckEnabled=e.myHorizontalMovementHeightVerticalCheckEnabled,this.myHorizontalMovementHeightHorizontalCheckEnabled=e.myHorizontalMovementHeightHorizontalCheckEnabled,this.myHorizontalMovementVerticalRadialDiagonalOutwardCheckEnabled=e.myHorizontalMovementVerticalRadialDiagonalOutwardCheckEnabled,this.myHorizontalMovementVerticalRadialDiagonalInwardCheckEnabled=e.myHorizontalMovementVerticalRadialDiagonalInwardCheckEnabled,this.myHorizontalMovementVerticalDiagonalOutwardUpwardCheckEnabled=e.myHorizontalMovementVerticalDiagonalOutwardUpwardCheckEnabled,this.myHorizontalMovementVerticalDiagonalOutwardDownwardCheckEnabled=e.myHorizontalMovementVerticalDiagonalOutwardDownwardCheckEnabled,this.myHorizontalMovementVerticalDiagonalInwardUpwardCheckEnabled=e.myHorizontalMovementVerticalDiagonalInwardUpwardCheckEnabled,this.myHorizontalMovementVerticalDiagonalInwardDownwardCheckEnabled=e.myHorizontalMovementVerticalDiagonalInwardDownwardCheckEnabled,this.myHorizontalMovementVerticalStraightCheckEnabled=e.myHorizontalMovementVerticalStraightCheckEnabled,this.myHorizontalMovementVerticalStraightCentralCheckEnabled=e.myHorizontalMovementVerticalStraightCentralCheckEnabled,this.myHorizontalMovementVerticalStraightDiagonalUpwardCheckEnabled=e.myHorizontalMovementVerticalStraightDiagonalUpwardCheckEnabled,this.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=e.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled,this.myHorizontalMovementVerticalStraightDiagonalDownwardCheckEnabled=e.myHorizontalMovementVerticalStraightDiagonalDownwardCheckEnabled,this.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled=e.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled,this.myHorizontalPositionCheckEnabled=e.myHorizontalPositionCheckEnabled,this.myHorizontalPositionCheckConeHalfSlices=e.myHorizontalPositionCheckConeHalfSlices,this.myHorizontalPositionHorizontalBorderCheckEnabled=e.myHorizontalPositionHorizontalBorderCheckEnabled,this.myHorizontalPositionHorizontalRadialCheckEnabled=e.myHorizontalPositionHorizontalRadialCheckEnabled,this.myHorizontalPositionHeightCheckSteps=e.myHorizontalPositionHeightCheckSteps,this.myHorizontalPositionHeightHorizontalCheckEnabled=e.myHorizontalPositionHeightHorizontalCheckEnabled,this.myHorizontalPositionHeightVerticalCheckEnabled=e.myHorizontalPositionHeightVerticalCheckEnabled,this.myHorizontalPositionVerticalStraightCheckEnabled=e.myHorizontalPositionVerticalStraightCheckEnabled,this.myHorizontalPositionVerticalStraightCentralCheckEnabled=e.myHorizontalPositionVerticalStraightCentralCheckEnabled,this.myHorizontalPositionVerticalRadialDiagonalOutwardCheckEnabled=e.myHorizontalPositionVerticalRadialDiagonalOutwardCheckEnabled,this.myHorizontalPositionVerticalRadialDiagonalInwardCheckEnabled=e.myHorizontalPositionVerticalRadialDiagonalInwardCheckEnabled,this.myHorizontalPositionVerticalBorderDiagonalOutwardCheckEnabled=e.myHorizontalPositionVerticalBorderDiagonalOutwardCheckEnabled,this.myHorizontalPositionVerticalBorderDiagonalInwardCheckEnabled=e.myHorizontalPositionVerticalBorderDiagonalInwardCheckEnabled,this.myHorizontalPositionVerticalRadialBorderDiagonalOutwardCheckEnabled=e.myHorizontalPositionVerticalRadialBorderDiagonalOutwardCheckEnabled,this.myHorizontalPositionVerticalRadialBorderDiagonalInwardCheckEnabled=e.myHorizontalPositionVerticalRadialBorderDiagonalInwardCheckEnabled,this.myHorizontalPositionVerticalCheckGetFarthestHit=e.myHorizontalPositionVerticalCheckGetFarthestHit,this.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHit=e.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHit,this.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHitKeepVerticalHitIfNoHorizontalHit=e.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHitKeepVerticalHitIfNoHorizontalHit,this.myHorizontalPositionVerticalCheckIgnoreHitsInsideCollision=e.myHorizontalPositionVerticalCheckIgnoreHitsInsideCollision,this.myHorizontalPositionVerticalCheckDirection=e.myHorizontalPositionVerticalCheckDirection,this.myHorizontalCheckBlockLayerFlags.setMask(e.myHorizontalCheckBlockLayerFlags.getMask()),this.myHorizontalCheckObjectsToIgnore.pp_copy(e.myHorizontalCheckObjectsToIgnore)};Ys.prototype.copy=function(e){this.myVerticalCheckCircumferenceRadius=e.myVerticalCheckCircumferenceRadius,this.myVerticalCheckCircumferenceSlices=e.myVerticalCheckCircumferenceSlices,this.myVerticalCheckCircumferenceCentralCheckEnabled=e.myVerticalCheckCircumferenceCentralCheckEnabled,this.myVerticalCheckCircumferenceRadialSteps=e.myVerticalCheckCircumferenceRadialSteps,this.myVerticalCheckCircumferenceRotationPerRadialStep=e.myVerticalCheckCircumferenceRotationPerRadialStep,this.myVerticalCheckFixedForwardEnabled=e.myVerticalCheckFixedForwardEnabled,this.myVerticalCheckFixedForward.vec3_copy(e.myVerticalCheckFixedForward),this.myVerticalMovementCheckEnabled=e.myVerticalMovementCheckEnabled,this.myVerticalMovementCheckReductionEnabled=e.myVerticalMovementCheckReductionEnabled,this.myVerticalMovementCheckPerformCheckOnBothSides=e.myVerticalMovementCheckPerformCheckOnBothSides,this.myVerticalPositionCheckEnabled=e.myVerticalPositionCheckEnabled,this.myVerticalCheckAllowHitsInsideCollisionIfOneValid=e.myVerticalCheckAllowHitsInsideCollisionIfOneValid,this.myVerticalCheckBlockLayerFlags.setMask(e.myVerticalCheckBlockLayerFlags.getMask()),this.myVerticalCheckObjectsToIgnore.pp_copy(e.myVerticalCheckObjectsToIgnore)};$s.prototype.copy=function(e){this.myWallSlideEnabled=e.myWallSlideEnabled,this.myWallSlideMaxAttempts=e.myWallSlideMaxAttempts,this.myCheckBothWallSlideDirections=e.myCheckBothWallSlideDirections,this.myWallSlideFlickerPreventionMode=e.myWallSlideFlickerPreventionMode,this.myWallSlideFlickerPreventionCheckOnlyIfAlreadySliding=e.myWallSlideFlickerPreventionCheckOnlyIfAlreadySliding,this.myWallSlideFlickerPreventionForceCheckCounter=e.myWallSlideFlickerPreventionForceCheckCounter,this.my90DegreesWallSlideAdjustDirectionSign=e.my90DegreesWallSlideAdjustDirectionSign};ms.prototype.copy=function(e){this.mySurfaceSnapEnabled=e.mySurfaceSnapEnabled,this.mySurfaceSnapMaxDistance=e.mySurfaceSnapMaxDistance,this.mySurfacePopOutEnabled=e.mySurfacePopOutEnabled,this.mySurfacePopOutMaxDistance=e.mySurfacePopOutMaxDistance,this.mySurfaceAngleToIgnore=e.mySurfaceAngleToIgnore,this.mySurfaceAngleToIgnoreWithSurfacePerceivedAngle=e.mySurfaceAngleToIgnoreWithSurfacePerceivedAngle,this.myHorizontalMovementSurfaceAngleToIgnoreMaxVerticalDistance=e.myHorizontalMovementSurfaceAngleToIgnoreMaxVerticalDistance,this.myHorizontalPositionSurfaceAngleToIgnoreMaxVerticalDistance=e.myHorizontalPositionSurfaceAngleToIgnoreMaxVerticalDistance,this.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft=e.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft,this.myCollectSurfaceInfo=e.myCollectSurfaceInfo,this.myOnSurfaceMaxOutsideDistance=e.myOnSurfaceMaxOutsideDistance,this.myOnSurfaceMaxInsideDistance=e.myOnSurfaceMaxInsideDistance,this.myBaseInsideCollisionCheckEnabled=e.myBaseInsideCollisionCheckEnabled,this.myOnSurfaceIfBaseInsideCollision=e.myOnSurfaceIfBaseInsideCollision,this.myCollectSurfaceNormalMaxOutsideDistance=e.myCollectSurfaceNormalMaxOutsideDistance,this.myCollectSurfaceNormalMaxInsideDistance=e.myCollectSurfaceNormalMaxInsideDistance,this.myFindSurfaceDistanceMaxOutsideDistance=e.myFindSurfaceDistanceMaxOutsideDistance,this.myFindSurfaceDistanceMaxInsideDistance=e.myFindSurfaceDistanceMaxInsideDistance,this.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhill=e.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhill,this.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphill=e.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphill,this.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhillMaxSurfaceAngle=e.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhillMaxSurfaceAngle,this.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphillMaxSurfaceAngle=e.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphillMaxSurfaceAngle,this.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhillMaxSurfacePerceivedAngle=e.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleDownhillMaxSurfacePerceivedAngle,this.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphillMaxSurfacePerceivedAngle=e.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngleUphillMaxSurfacePerceivedAngle,this.myVerticalMovementAdjustHorizontalMovementBasedOnSurfaceAngleDownhill=e.myVerticalMovementAdjustHorizontalMovementBasedOnSurfaceAngleDownhill,this.myVerticalMovementAdjustHorizontalMovementBasedOnSurfaceAngleDownhillMinSurfaceAngle=e.myVerticalMovementAdjustHorizontalMovementBasedOnSurfaceAngleDownhillMinSurfaceAngle,this.myMovementMustStayOnSurface=e.myMovementMustStayOnSurface,this.myMovementMustStayOnSurfaceHitMaxAngle=e.myMovementMustStayOnSurfaceHitMaxAngle,this.myMovementMustStayOnIgnorableSurfaceAngleDownhill=e.myMovementMustStayOnIgnorableSurfaceAngleDownhill,this.myMovementMustStayOnSurfaceAngleDownhill=e.myMovementMustStayOnSurfaceAngleDownhill,this.myTeleportMustBeOnSurface=e.myTeleportMustBeOnSurface,this.myTeleportMustBeOnIgnorableSurfaceAngle=e.myTeleportMustBeOnIgnorableSurfaceAngle,this.myTeleportMustBeOnSurfaceAngle=e.myTeleportMustBeOnSurfaceAngle,this.myCheckTransformMustBeOnSurface=e.myCheckTransformMustBeOnSurface,this.myCheckTransformMustBeOnIgnorableSurfaceAngle=e.myCheckTransformMustBeOnIgnorableSurfaceAngle,this.myCheckTransformMustBeOnSurfaceAngle=e.myCheckTransformMustBeOnSurfaceAngle,this.myRecollectSurfaceInfoOnSurfaceCheckFailed=e.myRecollectSurfaceInfoOnSurfaceCheckFailed,this.myHorizontalMovementAllowExitAttemptWhenOnNotIgnorableSurfacePerceivedAngle=e.myHorizontalMovementAllowExitAttemptWhenOnNotIgnorableSurfacePerceivedAngle};ea.prototype.copy=function(e){this.mySplitMovementEnabled=e.mySplitMovementEnabled,this.mySplitMovementMaxSteps=e.mySplitMovementMaxSteps,this.mySplitMovementMaxStepLength=e.mySplitMovementMaxStepLength,this.mySplitMovementMinStepLength=e.mySplitMovementMinStepLength,this.mySplitMovementStopOnHorizontalMovementFailed=e.mySplitMovementStopOnHorizontalMovementFailed,this.mySplitMovementStopOnVerticalMovementFailed=e.mySplitMovementStopOnVerticalMovementFailed,this.mySplitMovementStopReturnPreviousResults=e.mySplitMovementStopReturnPreviousResults};ta.prototype.copy=function(e){this.myPositionOffsetLocal.vec3_copy(e.myPositionOffsetLocal),this.myRotationOffsetLocalQuat.quat_copy(e.myRotationOffsetLocalQuat)};ia.prototype.copy=function(e){this.myVisualDebugEnabled=e.myVisualDebugEnabled,this.myVisualDebugMovementEnabled=e.myVisualDebugMovementEnabled,this.myVisualDebugHorizontalMovementCheckEnabled=e.myVisualDebugHorizontalMovementCheckEnabled,this.myVisualDebugHorizontalPositionCheckEnabled=e.myVisualDebugHorizontalPositionCheckEnabled,this.myVisualDebugVerticalMovementCheckEnabled=e.myVisualDebugVerticalMovementCheckEnabled,this.myVisualDebugVerticalPositionCheckEnabled=e.myVisualDebugVerticalPositionCheckEnabled,this.myVisualDebugSlideEnabled=e.myVisualDebugSlideEnabled,this.myVisualDebugGroundInfoEnabled=e.myVisualDebugGroundInfoEnabled,this.myVisualDebugCeilingInfoEnabled=e.myVisualDebugCeilingInfoEnabled,this.myVisualDebugResultsEnabled=e.myVisualDebugResultsEnabled};var po={VERY_LOW:0,LOW:1,MEDIUM:2,HIGH:3,VERY_HIGH:4},oa=class{constructor(){this.myHeight=0,this.myRadius=0,this.myAccuracyLevel=po.VERY_LOW,this.myIsPlayer=!1,this.myCheckOnlyFeet=!1,this.myAverageSpeed=0,this.myCanFly=!1,this.myShouldSlideAgainstWall=!1,this.myCollectGroundInfo=!1,this.myShouldSnapOnGround=!1,this.myMaxDistanceToSnapOnGround=0,this.myMaxWalkableGroundAngle=0,this.myMaxWalkableGroundStepHeight=0,this.myShouldNotFallFromEdges=!1,this.myHorizontalCheckBlockLayerFlags=new Re,this.myHorizontalCheckObjectsToIgnore=[],this.myVerticalCheckBlockLayerFlags=new Re,this.myVerticalCheckObjectsToIgnore=[],this.myHorizontalCheckDebugEnabled=!1,this.myVerticalCheckDebugEnabled=!1}};function LT(i,e=new co){if(e.myHeight=i.myHeight,e.myHorizontalCheckParams.myHorizontalCheckConeRadius=i.myRadius,e.myVerticalCheckParams.myVerticalCheckCircumferenceRadius=i.myRadius/2,e.myVerticalCheckParams.myVerticalCheckFixedForwardEnabled=!0,e.myVerticalCheckParams.myVerticalCheckFixedForward.vec3_set(0,0,1),(!i.myCheckOnlyFeet||i.myCanFly)&&(e.myHorizontalCheckParams.myHorizontalHeightCheckEnabled=!0,e.myVerticalCheckParams.myVerticalPositionCheckEnabled=!0),e.myWallSlideParams.myWallSlideEnabled=i.myShouldSlideAgainstWall,e.myHorizontalCheckParams.myHorizontalCheckFeetDistanceToIgnore=i.myMaxWalkableGroundStepHeight,e.myGroundParams.mySurfaceSnapMaxDistance=i.myMaxDistanceToSnapOnGround,e.myGroundParams.mySurfacePopOutMaxDistance=i.myMaxDistanceToSnapOnGround>0?i.myMaxDistanceToSnapOnGround:i.myRadius>.1?.1:.01,e.myGroundParams.mySurfacePopOutMaxDistance=Math.max(e.myGroundParams.mySurfacePopOutMaxDistance,e.myHorizontalCheckParams.myHorizontalCheckFeetDistanceToIgnore),e.myGroundParams.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft=i.myRadius,e.myGroundParams.myCollectSurfaceInfo=i.myCollectGroundInfo||i.myMaxWalkableGroundAngle>0,e.myGroundParams.mySurfaceSnapEnabled=i.myShouldSnapOnGround,e.myGroundParams.mySurfacePopOutEnabled=!0,e.myGroundParams.mySurfaceAngleToIgnore=i.myMaxWalkableGroundAngle,e.myGroundParams.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngle=!0,e.myGroundParams.myOnSurfaceMaxOutsideDistance=.001,e.myGroundParams.myOnSurfaceMaxInsideDistance=.001,e.myGroundParams.myCollectSurfaceNormalMaxOutsideDistance=i.myRadius>.1?.1:.01,e.myGroundParams.myCollectSurfaceNormalMaxInsideDistance=e.myGroundParams.myCollectSurfaceNormalMaxOutsideDistance,i.myCanFly&&(e.myHorizontalCheckParams.myHorizontalCheckHeadDistanceToIgnore=e.myHorizontalCheckParams.myHorizontalCheckFeetDistanceToIgnore,e.myCeilingParams.myCollectSurfaceInfo=e.myGroundParams.myCollectSurfaceInfo,e.myCeilingParams.mySurfacePopOutEnabled=e.myGroundParams.mySurfacePopOutEnabled,e.myCeilingParams.mySurfaceAngleToIgnore=e.myGroundParams.mySurfaceAngleToIgnore,e.myCeilingParams.mySurfaceSnapMaxDistance=e.myGroundParams.mySurfaceSnapMaxDistance,e.myCeilingParams.mySurfacePopOutMaxDistance=e.myGroundParams.mySurfacePopOutMaxDistance,e.myCeilingParams.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft=e.myGroundParams.myHorizontalMovementSurfaceAngleToIgnoreMaxHorizontalMovementLeft,e.myCeilingParams.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngle=e.myGroundParams.myHorizontalMovementAdjustVerticalMovementBasedOnSurfacePerceivedAngle,e.myCeilingParams.myOnSurfaceMaxOutsideDistance=e.myGroundParams.myOnSurfaceMaxOutsideDistance,e.myCeilingParams.myOnSurfaceMaxInsideDistance=e.myGroundParams.myOnSurfaceMaxInsideDistance,e.myCeilingParams.myCollectSurfaceNormalMaxOutsideDistance=e.myGroundParams.myCollectSurfaceNormalMaxOutsideDistance,e.myCeilingParams.myCollectSurfaceNormalMaxInsideDistance=e.myGroundParams.myCollectSurfaceNormalMaxInsideDistance),i.myShouldNotFallFromEdges&&(e.myGroundParams.myMovementMustStayOnSurface=!0,e.myGroundParams.myMovementMustStayOnSurfaceAngleDownhill=Math.max(60,e.myGroundParams.mySurfaceAngleToIgnore)),e.myHorizontalCheckParams.myHorizontalCheckBlockLayerFlags.copy(i.myHorizontalCheckBlockLayerFlags),e.myHorizontalCheckParams.myHorizontalCheckObjectsToIgnore.pp_copy(i.myHorizontalCheckObjectsToIgnore),e.myVerticalCheckParams.myVerticalCheckBlockLayerFlags.copy(i.myVerticalCheckBlockLayerFlags),e.myVerticalCheckParams.myVerticalCheckObjectsToIgnore.pp_copy(i.myVerticalCheckObjectsToIgnore),i.myHorizontalCheckDebugEnabled&&(e.myDebugParams.myVisualDebugEnabled=!0,e.myDebugParams.myVisualDebugHorizontalMovementCheckEnabled=!0,e.myDebugParams.myVisualDebugHorizontalPositionCheckEnabled=!0),i.myVerticalCheckDebugEnabled&&(e.myDebugParams.myVisualDebugEnabled=!0,e.myDebugParams.myVisualDebugVerticalMovementCheckEnabled=!0,e.myDebugParams.myVisualDebugVerticalPositionCheckEnabled=!0),i.myAccuracyLevel>=po.VERY_LOW&&(e.myHorizontalCheckParams.myHorizontalCheckConeHalfAngle=60,e.myHorizontalCheckParams.myHorizontalMovementHeightVerticalCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalPositionHeightVerticalCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementCheckEnabled=!1,e.myHorizontalCheckParams.myHorizontalPositionCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalPositionCheckConeHalfSlices=1,e.myHorizontalCheckParams.myHorizontalPositionHeightCheckSteps=1,e.myHorizontalCheckParams.myHorizontalPositionHorizontalRadialCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalPositionVerticalStraightCheckEnabled=!0,e.myVerticalCheckParams.myVerticalCheckCircumferenceSlices=4,e.myVerticalCheckParams.myVerticalCheckCircumferenceCentralCheckEnabled=!0,e.myVerticalCheckParams.myVerticalCheckCircumferenceRadialSteps=1,e.myVerticalCheckParams.myVerticalMovementCheckEnabled=!0,e.myVerticalCheckParams.myVerticalMovementCheckReductionEnabled=!0,e.myVerticalCheckParams.myVerticalCheckAllowHitsInsideCollisionIfOneValid=!0,i.myIsPlayer&&(e.myWallSlideParams.myWallSlideMaxAttempts=2,e.myWallSlideParams.my90DegreesWallSlideAdjustDirectionSign=!0)),i.myAccuracyLevel>=po.LOW&&(e.myHorizontalCheckParams.myHorizontalMovementCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementCheckRadialSteps=1,e.myHorizontalCheckParams.myHorizontalMovementHeightCheckSteps=1,e.myHorizontalCheckParams.myHorizontalMovementHorizontalStraightCentralCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=!0,e.myVerticalCheckParams.myVerticalCheckCircumferenceRadialSteps=2,e.myVerticalCheckParams.myVerticalCheckCircumferenceRotationPerRadialStep=180/e.myVerticalCheckParams.myVerticalCheckCircumferenceSlices,e.myWallSlideParams.myWallSlideMaxAttempts=2,e.myWallSlideParams.myCheckBothWallSlideDirections=!1,e.myWallSlideParams.myWallSlideFlickerPreventionMode=na.NONE,e.myWallSlideParams.myWallSlideFlickerPreventionCheckOnlyIfAlreadySliding=!1,e.myWallSlideParams.myWallSlideFlickerPreventionForceCheckCounter=0,e.myWallSlideParams.my90DegreesWallSlideAdjustDirectionSign=!1),i.myAccuracyLevel>=po.MEDIUM&&(e.myHorizontalCheckParams.myHorizontalMovementHeightHorizontalCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementHorizontalDiagonalOutwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalDiagonalOutwardUpwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalPositionCheckConeHalfSlices=2,e.myHorizontalCheckParams.myHorizontalPositionHeightHorizontalCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalPositionHorizontalBorderCheckEnabled=!0,e.myVerticalCheckParams.myVerticalMovementCheckPerformCheckOnBothSides=!0,e.myVerticalCheckParams.myVerticalCheckCircumferenceSlices=6,e.myVerticalCheckParams.myVerticalCheckCircumferenceRadialSteps=2,e.myVerticalCheckParams.myVerticalCheckCircumferenceRotationPerRadialStep=180/e.myVerticalCheckParams.myVerticalCheckCircumferenceSlices,e.myWallSlideParams.myWallSlideMaxAttempts=3,e.myWallSlideParams.my90DegreesWallSlideAdjustDirectionSign=!0,i.myIsPlayer&&(e.myWallSlideParams.myWallSlideFlickerPreventionMode=na.USE_PREVIOUS_RESULTS,e.myWallSlideParams.myWallSlideFlickerPreventionCheckOnlyIfAlreadySliding=!0,e.myWallSlideParams.myWallSlideFlickerPreventionForceCheckCounter=4)),i.myAccuracyLevel>=po.HIGH){e.myWallSlideParams.myWallSlideEnabled&&(e.myHorizontalCheckParams.myHorizontalMovementCheckGetBetterReferenceHit=!0,e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHit=!0,e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHitKeepVerticalHitIfNoHorizontalHit=!0),e.myHorizontalCheckParams.myHorizontalMovementHorizontalDiagonalInwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementHorizontalStraightCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementHorizontalStraightCentralCheckEnabled=!1,e.myHorizontalCheckParams.myHorizontalMovementVerticalDiagonalInwardUpwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalUpwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=!1,e.myVerticalCheckParams.myVerticalCheckCircumferenceSlices=8,e.myVerticalCheckParams.myVerticalCheckCircumferenceRadialSteps=2,e.myVerticalCheckParams.myVerticalCheckCircumferenceRotationPerRadialStep=180/e.myVerticalCheckParams.myVerticalCheckCircumferenceSlices,e.myWallSlideParams.myWallSlideMaxAttempts=4,i.myIsPlayer&&(e.myWallSlideParams.myCheckBothWallSlideDirections=!0),e.myGroundParams.myBaseInsideCollisionCheckEnabled=!0,e.myCeilingParams.myBaseInsideCollisionCheckEnabled=!0;let t=90;i.myAverageSpeed/t>i.myRadius&&(e.mySplitMovementParams.mySplitMovementEnabled=!0,e.mySplitMovementParams.mySplitMovementMaxSteps=Math.ceil(i.myAverageSpeed/t/i.myRadius),e.mySplitMovementParams.mySplitMovementMinStepLength=i.myRadius)}return i.myAccuracyLevel>=po.VERY_HIGH&&(e.myHorizontalCheckParams.myHorizontalMovementHeightCheckSteps=2,e.myHorizontalCheckParams.myHorizontalMovementHorizontalRadialCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalDiagonalOutwardDownwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalDiagonalInwardDownwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightCentralCheckEnabled=!1,e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalDownwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalMovementVerticalStraightDiagonalDownwardCentralCheckEnabled=!1,e.myHorizontalCheckParams.myHorizontalPositionHeightCheckSteps=2,e.myHorizontalCheckParams.myHorizontalPositionVerticalRadialDiagonalOutwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalPositionVerticalBorderDiagonalOutwardCheckEnabled=!0,e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHit=!0,e.myHorizontalCheckParams.myHorizontalPositionVerticalCheckPerformHorizontalCheckOnHitKeepVerticalHitIfNoHorizontalHit=!0,e.myGroundParams.myRecollectSurfaceInfoOnSurfaceCheckFailed=!0,e.myCeilingParams.myRecollectSurfaceInfoOnSurfaceCheckFailed=e.myGroundParams.myRecollectSurfaceInfoOnSurfaceCheckFailed),e}function kT(i,e=new co){return e.copy(i),e.myHorizontalCheckParams.myHorizontalCheckConeHalfAngle=180,e.myHorizontalCheckParams.myHorizontalPositionCheckConeHalfSlices=Math.round(e.myHorizontalCheckParams.myHorizontalCheckConeHalfAngle/i.myHorizontalCheckParams.myHorizontalCheckConeHalfAngle*i.myHorizontalCheckParams.myHorizontalPositionCheckConeHalfSlices),e.myHorizontalCheckParams.myHorizontalCheckFixedForwardEnabled=!0,e.myHorizontalCheckParams.myHorizontalCheckFixedForward.vec3_set(0,0,1),e}var cm={createSimplified:LT,createTeleportColliderSetupFromMovementColliderSetup:kT};var ys=class{constructor(e=r.getMainEngine()){this._myLastCheckRaycastsPerformed=0,this._myCurrentFrameRaycastsPerformed=0,this._myMaxFrameRaycastsPerformed=0,this.myEngine=e,mi.initBridge(this.myEngine)}update(e){this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),this._myCurrentFrameRaycastsPerformed=0,Ue(this.myEngine)._myTotalRaycasts=0}checkMovement(e,t,n,o,s=new Ge){mi.checkMovement(e,t,n,o,s,this.myEngine),this._myLastCheckRaycastsPerformed=Ue(this.myEngine)._myTotalRaycasts-this._myCurrentFrameRaycastsPerformed,this._myCurrentFrameRaycastsPerformed=Ue(this.myEngine)._myTotalRaycasts,this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),s.myDebugResults._myRaycastsPerformed=this._myLastCheckRaycastsPerformed}checkTeleportToPosition(e,t,n,o,s=new Ge){}checkTeleportToTransform(e,t,n,o,s=new Ge){mi.checkTeleportToTransform(e,t,n,o,s,this.myEngine),this._myLastCheckRaycastsPerformed=Ue(this.myEngine)._myTotalRaycasts-this._myCurrentFrameRaycastsPerformed,this._myCurrentFrameRaycastsPerformed=Ue(this.myEngine)._myTotalRaycasts,this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),s.myDebugResults._myRaycastsPerformed=this._myLastCheckRaycastsPerformed}checkTransform(e,t,n,o=new Ge){mi.checkTransform(e,t,n,o,this.myEngine),this._myLastCheckRaycastsPerformed=Ue(this.myEngine)._myTotalRaycasts-this._myCurrentFrameRaycastsPerformed,this._myCurrentFrameRaycastsPerformed=Ue(this.myEngine)._myTotalRaycasts,this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),o.myDebugResults._myRaycastsPerformed=this._myLastCheckRaycastsPerformed}updateSurfaceInfo(e,t,n,o=new Ge){let s=this._myCurrentFrameRaycastsPerformed;this.updateGroundInfo(e,t,n,o),this.updateCeilingInfo(e,t,n,o),this._myLastCheckRaycastsPerformed=Ue(this.myEngine)._myTotalRaycasts-s,this._myCurrentFrameRaycastsPerformed=Ue(this.myEngine)._myTotalRaycasts,this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),o.myDebugResults._myRaycastsPerformed=this._myLastCheckRaycastsPerformed}updateGroundInfo(e,t,n,o=new Ge){mi.updateGroundInfo(e,t,n,o,this.myEngine),this._myLastCheckRaycastsPerformed=Ue(this.myEngine)._myTotalRaycasts-this._myCurrentFrameRaycastsPerformed,this._myCurrentFrameRaycastsPerformed=Ue(this.myEngine)._myTotalRaycasts,this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),o.myDebugResults._myRaycastsPerformed=this._myLastCheckRaycastsPerformed}updateCeilingInfo(e,t,n,o=new Ge){mi.updateCeilingInfo(e,t,n,o,this.myEngine),this._myLastCheckRaycastsPerformed=Ue(this.myEngine)._myTotalRaycasts-this._myCurrentFrameRaycastsPerformed,this._myCurrentFrameRaycastsPerformed=Ue(this.myEngine)._myTotalRaycasts,this._myMaxFrameRaycastsPerformed=Math.max(this._myCurrentFrameRaycastsPerformed,this._myMaxFrameRaycastsPerformed),o.myDebugResults._myRaycastsPerformed=this._myLastCheckRaycastsPerformed}};ys.prototype.checkTeleportToPosition=function(){let i=j();return function(t,n,o,s,a){i.quat2_copy(n),i.quat2_setPosition(t),this.checkTeleportToTransform(i,n,o,s,a)}}();import{Component as QR}from"@wonderlandengine/api";var vn=class extends QR{init(){this._myCharacterCollisionSystem=null,r.hasCharacterCollisionSystem(this.engine)||(this._myCharacterCollisionSystem=new ys(this.engine),r.setCharacterCollisionSystem(this._myCharacterCollisionSystem,this.engine))}update(e){this._myCharacterCollisionSystem!=null&&this._myCharacterCollisionSystem.update(e)}onDestroy(){this._myCharacterCollisionSystem!=null&&r.getCharacterCollisionSystem(this.engine)==this._myCharacterCollisionSystem&&r.removeCharacterCollisionSystem(this.engine)}};R(vn,"TypeName","pp-character-collision-system"),R(vn,"Properties",{});var _o=class{constructor(){}};var Ii=class extends _o{constructor(){super()}};function FT(i,e,t){return this.computeSurfacePerceivedAngle(i,e,t,!0)}function wT(i,e,t){return this.computeSurfacePerceivedAngle(i,e,t,!1)}var jT=function(){let i=m(),e=m();return function(n,o,s,a){let l=0;e.vec3_copy(s),a||e.vec3_negate(e);let h=n.vec3_angle(e);h<=Math.PP_EPSILON_DEGREES?h=0:h>=180-Math.PP_EPSILON_DEGREES&&(h=180),i=o.vec3_projectOnPlaneAlongAxis(n,s,i),l=i.vec3_angle(o);let _=i.vec3_isFartherAlongAxis(o,s);return(!_&&a||_&&!a)&&(l*=-1),Math.abs(l)>=h&&(h!=0&&h!=180?l=h*Math.pp_sign(l):l=h),l}}(),qR={computeGroundPerceivedAngle:FT,computeCeilingPerceivedAngle:wT,computeSurfacePerceivedAngle:jT};import{Component as XR}from"@wonderlandengine/api";var xn=class extends XR{init(){}start(){this._myCharacterController=new _o}update(e){this._myCharacterController.update(e)}getCharacterController(){return this._myCharacterController}};R(xn,"TypeName","pp-character-controller"),R(xn,"Properties",{});var sa=class extends Ii{constructor(){super()}};var aa=class extends Ii{constructor(){super()}};var ra=class extends Ii{constructor(){super()}};import{Component as KR}from"@wonderlandengine/api";var Mn=class extends KR{init(){}start(){this._myPlayerCharacterController=new sa}update(e){this._myPlayerCharacterController.update(e)}getPlayerCharacterController(){return this._myPlayerCharacterController}};R(Mn,"TypeName","pp-player-character-controller"),R(Mn,"Properties",{});import{Component as JR}from"@wonderlandengine/api";var En=class extends JR{init(){}start(){this._myPlayerHeadCharacterController=new aa}update(e){this._myPlayerHeadCharacterController.update(e)}getPlayerHeadCharacterController(){return this._myPlayerHeadCharacterController}};R(En,"TypeName","pp-player-head-character-controller"),R(En,"Properties",{});import{Component as ZR}from"@wonderlandengine/api";var Dn=class extends ZR{init(){}start(){this._myPlayerHandCharacterController=new ra}update(e){this._myPlayerHandCharacterController.update(e)}getPlayerHandCharacterController(){return this._myPlayerHandCharacterController}};R(Dn,"TypeName","pp-player-hand-character-controller"),R(Dn,"Properties",{});import{Component as Uz}from"@wonderlandengine/api";import{Component as Qz}from"@wonderlandengine/api";import{Component as Xz}from"@wonderlandengine/api";import{Component as Jz}from"@wonderlandengine/api";import{Component as Yz}from"@wonderlandengine/api";var tn=class{constructor(e=r.getMainEngine()){this.mySessionChangeResyncEnabled=!1,this.myBlurEndResyncEnabled=!1,this.myBlurEndResyncRotation=!1,this.myResetTransformOnViewResetEnabled=!0,this.myNextEnterSessionResyncHeight=!1,this.myEnterSessionResyncHeight=!1,this.myExitSessionResyncHeight=!1,this.myExitSessionResyncVerticalAngle=!1,this.myExitSessionRemoveRightTilt=!1,this.myExitSessionAdjustMaxVerticalAngle=!1,this.myExitSessionMaxVerticalAngle=0,this.myHeightOffsetVRWithFloor=null,this.myHeightOffsetVRWithoutFloor=null,this.myHeightOffsetNonVR=null,this.myNextEnterSessionFloorHeight=null,this.myEnterSessionFloorHeight=null,this.myRotateFeetKeepUp=!1,this.myForeheadExtraHeight=0,this.myEngine=e,this.myDebugEnabled=!1}},se=class{constructor(e=new tn){this._myParams=e,this._myCurrentHead=r.getPlayerObjects(this._myParams.myEngine).myHead,this._mySessionChangeResyncHeadTransform=null,this._myBlurRecoverHeadTransform=null,this._myCurrentHeadTransformLocalQuat=j(),this._myDelaySessionChangeResyncCounter=0,this._myDelayBlurEndResyncCounter=0,this._myDelayBlurEndResyncTimer=new ie(5,!1),this._myVisibilityHidden=!1,this._mySessionActive=!1,this._mySessionBlurred=!1,this._myIsSyncedDelayCounter=0,this._myViewResetEventListener=null,this._myActive=!0,this._myDestroyed=!1,this._myResyncCounterFrames=3,this._myIsSyncedDelayCounterFrames=1}start(){this._updateHeightOffset(),B.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!0,this._myParams.myEngine)}setActive(e){this._myActive=e}getParams(){return this._myParams}paramsUpdated(){this._updateHeightOffset()}getPlayer(){return r.getPlayerObjects(this._myParams.myEngine).myPlayer}getHead(){return this._myCurrentHead}getHeightHead(){return this.getHeightEyes()+this._myParams.myForeheadExtraHeight}getHeightEyes(){}getTransformFeetQuat(e=j()){}getTransformHeadQuat(e=j()){return this.getHead().pp_getTransformQuat(e)}getPositionFeet(e=m()){}getPositionHead(e=m()){return this._myCurrentHead.pp_getPosition(e)}getRotationFeetQuat(e=z()){}getRotationHeadQuat(e=z()){return this.getHead().pp_getRotationQuat(e)}isSynced(){return this._myIsSyncedDelayCounter==0&&this._myDelaySessionChangeResyncCounter==0&&this._myDelayBlurEndResyncCounter==0&&!this._myDelayBlurEndResyncTimer.isRunning()&&!this._mySessionBlurred}setHeight(e,t=!1){if((!t||!this._mySessionActive)&&(this._myParams.myHeightOffsetNonVR=e),!t||this._mySessionActive){this._myParams.myHeightOffsetVRWithoutFloor=e,this._myParams.myHeightOffsetVRWithFloor==null&&(this._myParams.myHeightOffsetVRWithFloor=0);let n=B.isReferenceSpaceFloorBased(this._myParams.myEngine)||B.isDeviceEmulated(this._myParams.myEngine);this._mySessionActive&&n?this._myParams.myHeightOffsetVRWithFloor=this._myParams.myHeightOffsetVRWithFloor+(e-this.getHeight()):this._mySessionActive||(this._myParams.myNextEnterSessionFloorHeight=e)}this._updateHeightOffset()}moveFeet(e){}moveHead(e){this.moveFeet(e)}teleportPositionHead(e){}teleportPositionFeet(e){}teleportPlayerToHeadTransformQuat(e){}rotateFeetQuat(e,t=null){}rotateHeadQuat(e){}canRotateFeet(){return!0}canRotateHead(){return!this._mySessionActive}setRotationFeetQuat(e,t=null){}setRotationHeadQuat(){}lookAtFeet(e,t=null,n=null){}lookToFeet(e,t=null,n=null){}lookAtHead(e,t=null){}lookToHead(e,t=null){}update(e){this._myIsSyncedDelayCounter!=0&&(this._myIsSyncedDelayCounter--,this._myIsSyncedDelayCounter=Math.max(0,this._myIsSyncedDelayCounter)),this._myDelaySessionChangeResyncCounter>0&&(this._myDelaySessionChangeResyncCounter--,this._myDelaySessionChangeResyncCounter==0&&(this._sessionChangeResync(),this._myIsSyncedDelayCounter=this._myIsSyncedDelayCounterFrames)),this._myDelayBlurEndResyncCounter>0&&!this._myDelayBlurEndResyncTimer.isRunning()&&(this._myDelayBlurEndResyncCounter--,this._myDelayBlurEndResyncCounter==0&&(this._blurEndResync(),this._myIsSyncedDelayCounter=this._myIsSyncedDelayCounterFrames)),this._myDelayBlurEndResyncTimer.isRunning()&&(this._myDelayBlurEndResyncCounter>0?this._myDelayBlurEndResyncCounter--:(this._myDelayBlurEndResyncTimer.update(e),this._myDelayBlurEndResyncTimer.isDone()&&(this._blurEndResync(),this._myIsSyncedDelayCounter=this._myIsSyncedDelayCounterFrames))),this.isSynced()&&this._myCurrentHead.pp_getTransformLocalQuat(this._myCurrentHeadTransformLocalQuat),this._myParams.myDebugEnabled&&r.isDebugEnabled(this._myParams.myEngine)&&this._debugUpdate(e)}_debugUpdate(e){r.getDebugVisualManager(this._myParams.myEngine).drawLineEnd(0,this.getPositionFeet(),this.getPositionHead(),w(1,0,0,1),.01),console.error(this.getHeightEyes())}destroy(){this._myDestroyed=!0,B.getReferenceSpace(this._myParams.myEngine)?.removeEventListener?.("reset",this._myViewResetEventListener),B.getSession(this._myParams.myEngine)?.removeEventListener("visibilitychange",this._myVisibilityChangeEventListener),B.unregisterSessionStartEndEventListeners(this,this._myParams.myEngine)}isDestroyed(){return this._myDestroyed}};se.prototype.getHeightEyes=function(){let i=m();return function(){return i=this._myCurrentHead.pp_getPosition(i),this._getPositionHeight(i)}}();se.prototype.getTransformFeetQuat=function(){let i=m(),e=z();return function(n=j()){return n.quat2_setPositionRotationQuat(this.getPositionFeet(i),this.getRotationFeetQuat(e)),n}}();se.prototype.getRotationFeetQuat=function(){let i=m(),e=m();return function(n=z()){i=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(i),e=this._myCurrentHead.pp_getForward(e);let o=e.vec3_angle(i),s=10;return o<s?e=this._myCurrentHead.pp_getDown(e):o>180-s&&(e=this._myCurrentHead.pp_getUp(e)),e=e.vec3_removeComponentAlongAxis(i,e),e.vec3_normalize(e),n.quat_setUp(i,e),n}}();se.prototype.getPositionFeet=function(){let i=m(),e=m();return function(n=m()){i=this._myCurrentHead.pp_getPosition(i);let o=this._getPositionHeight(i);return e=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(e),n=i.vec3_sub(e.vec3_scale(o,n),n),n}}();se.prototype.moveFeet=function(e){r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_translate(e)};se.prototype.rotateFeetQuat=function(){let i=m(),e=m(),t=m(),n=z(),o=z(),s=z(),a=m(),l=z(),h=m(),_=m();return function(c,d=null){c.quat_getAngleRadians()<=1e-5||(t=this._myCurrentHead.pp_getPosition(t),i=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(i),e=c.quat_getAxis(e),!e.vec3_isOnAxis(i)&&(d==null&&this._myParams.myFeetRotationKeepUp||d)?(n=this.getRotationFeetQuat(n),o=n.quat_rotateQuat(c,o),a=o.quat_getForward(a),s.quat_copy(o),s.quat_setUp(i,a),l=n.quat_rotationToQuat(s,l)):l.quat_copy(c),r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_rotateAroundQuat(l,t),h=this._myCurrentHead.pp_getPosition(h),_=t.vec3_sub(h,_),_.vec3_length()>1e-5&&this.moveFeet(_))}}();se.prototype.rotateHeadQuat=function(){let i=z(),e=m();return function(n){this.canRotateHead()&&(this._myCurrentHead.pp_rotateQuat(n),i=this._myCurrentHead.pp_getRotationQuat(i),r.getPlayerObjects(this._myParams.myEngine).myHead.pp_setRotationQuat(i),i=i.quat_rotateAxisRadians(Math.PI,i.quat_getUp(e),i),r.getPlayerObjects(this._myParams.myEngine).myCameraNonXR.pp_setRotationQuat(i))}}();se.prototype.setRotationFeetQuat=function(){let i=z(),e=z();return function(n,o=null){i=this.getRotationFeetQuat(i),e=i.quat_rotationToQuat(n,e),this.rotateFeetQuat(e,o)}}();se.prototype.setRotationHeadQuat=function(){let i=z(),e=z();return function(n){i=this.getRotationHeadQuat(i),e=i.quat_rotationToQuat(n,e),this.rotateHeadQuat(e)}}();se.prototype.teleportPositionHead=function(){let i=m(),e=m();return function(n){i=this._myCurrentHead.pp_getPosition(i),e=n.vec3_sub(i,e),this.moveFeet(e)}}();se.prototype.teleportPositionFeet=function(){let i=m(),e=m();return function(n){i=this.getPositionFeet(i),e=n.vec3_sub(i,e),this.moveFeet(e)}}();se.prototype.teleportPlayerToHeadTransformQuat=function(){let i=m(),e=m(),t=m(),n=m(),o=m(),s=m(),a=m(),l=m(),h=z();return function(y){i=y.quat2_getPosition(i),e=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(e),t=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getPosition(t).vec3_removeComponentAlongAxis(e,t),n=i.vec3_removeComponentAlongAxis(e,n),o=n.vec3_sub(t,o),r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_translate(o),s=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getForward(s),a=y.quat2_getForward(a),l=a.vec3_negate(l),h=s.vec3_rotationToPivotedQuat(l,e,h),r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_rotateQuat(h)}}();se.prototype.lookAtFeet=function(){let i=m(),e=m();return function(n,o=null,s=null){e=this.getPositionFeet(e),i=n.vec3_sub(e,i).vec3_normalize(i),this.lookToFeet(i,o,s)}}();se.prototype.lookToFeet=function(){let i=z();return function(t,n=null,o=null){i=this.getRotationFeetQuat(i),i.quat_setForward(t,n),this.setRotationFeetQuat(i,o)}}();se.prototype.lookAtHead=function(){let i=m(),e=m();return function(n,o=null){e=this.getPositionHead(e),i=n.vec3_sub(e,i).vec3_normalize(i),this.lookToHead(i,o)}}();se.prototype.lookToHead=function(){let i=z();return function(t,n=null){i=this.getRotationHeadQuat(i),i.quat_setForward(t,n),this.setRotationHeadQuat(i)}}();se.prototype._getPositionHeight=function(){let i=m(),e=m(),t=m();return function(o){i=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getPosition(i),e=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(e),t=o.vec3_sub(i,t).vec3_componentAlongAxis(e,t);let s=t.vec3_length();return e.vec3_isConcordant(t)||(s=-s),s}}();se.prototype._onXRSessionStart=function(){return function(e,t){this._myBlurRecoverHeadTransform=null,this._myVisibilityHidden=!1,this._myDelaySessionChangeResyncCounter=0,this._myDelayBlurEndResyncCounter=0,this._myDelayBlurEndResyncTimer.reset();let n=B.getReferenceSpace(this._myParams.myEngine);n.addEventListener!=null&&(this._myViewResetEventListener=this._onViewReset.bind(this),n.addEventListener("reset",this._myViewResetEventListener)),this._myVisibilityChangeEventListener=function(o){o.session.visibilityState!="visible"?(this._mySessionBlurred||this._onXRSessionBlurStart(o.session),this._myVisibilityHidden=t.visibilityState=="hidden"):(this._mySessionBlurred&&this._onXRSessionBlurEnd(o.session),this._myVisibilityHidden=!1)}.bind(this),t.addEventListener("visibilitychange",this._myVisibilityChangeEventListener),this._myParams.mySessionChangeResyncEnabled&&!e&&this._myActive?(this._myDelaySessionChangeResyncCounter==0&&(this._mySessionChangeResyncHeadTransform=this._getHeadTransformFromLocal(this._myCurrentHeadTransformLocalQuat)),this._myDelaySessionChangeResyncCounter=this._myResyncCounterFrames):(this._myDelaySessionChangeResyncCounter=0,this._mySessionChangeResyncHeadTransform=null),this._mySessionActive=!0,this._mySessionBlurred=!1,this._myActive&&this._updateHeightOffset()}}();se.prototype._onXRSessionEnd=function(){return function(e){if(this._myParams.mySessionChangeResyncEnabled&&this._myActive){if(this._myDelaySessionChangeResyncCounter==0){let t=this._getHeadTransformFromLocal(this._myCurrentHeadTransformLocalQuat);this._myBlurRecoverHeadTransform!=null&&(t=this._myBlurRecoverHeadTransform),this._mySessionChangeResyncHeadTransform=t}this._myDelaySessionChangeResyncCounter=this._myResyncCounterFrames}else this._myDelaySessionChangeResyncCounter=0,this._mySessionChangeResyncHeadTransform=null;this._myVisibilityChangeEventListener=null,this._myViewResetEventListener=null,this._myBlurRecoverHeadTransform=null,this._myVisibilityHidden=!1,this._myDelayBlurEndResyncCounter=0,this._myDelayBlurEndResyncTimer.reset(),this._mySessionActive=!1,this._mySessionBlurred=!1,this._myActive&&this._updateHeightOffset()}}();se.prototype._onXRSessionBlurStart=function(){return function(e){this._myActive&&(this._myParams.myBlurEndResyncEnabled&&this._myBlurRecoverHeadTransform==null&&this._mySessionActive?this._myDelaySessionChangeResyncCounter>0?this._myBlurRecoverHeadTransform=this._mySessionChangeResyncHeadTransform:this._myBlurRecoverHeadTransform=this._getHeadTransformFromLocal(this._myCurrentHeadTransformLocalQuat):(!this._mySessionActive||!this._myParams.myBlurEndResyncEnabled)&&(this._myBlurRecoverHeadTransform=null)),this._myDelayBlurEndResyncCounter=0,this._mySessionBlurred=!0}}();se.prototype._onXRSessionBlurEnd=function(){return function(e){this._myActive&&(this._myDelaySessionChangeResyncCounter==0?this._myParams.myBlurEndResyncEnabled&&this._myBlurRecoverHeadTransform!=null&&this._mySessionActive?(this._myDelayBlurEndResyncCounter=this._myResyncCounterFrames,this._myVisibilityHidden):(this._myBlurRecoverHeadTransform=null,this._myDelayBlurEndResyncCounter=0):(this._myDelaySessionChangeResyncCounter=this._myResyncCounterFrames,this._myBlurRecoverHeadTransform=null)),this._mySessionBlurred=!1}}();se.prototype._onViewReset=function(){return function(){this._myActive&&this._myParams.myResetTransformOnViewResetEnabled&&this._mySessionActive&&this.isSynced()&&this.teleportPlayerToHeadTransformQuat(this._getHeadTransformFromLocal(this._myCurrentHeadTransformLocalQuat))}}();se.prototype._blurEndResync=function(){let i=m(),e=m(),t=m(),n=m(),o=m(),s=m(),a=m(),l=m(),h=z();return function(){this._myBlurRecoverHeadTransform!=null&&(this._mySessionChangeResyncHeadTransform!=null?(this._myBlurRecoverHeadTransform=null,this._sessionChangeResync()):(i=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(i),e=this._myCurrentHead.pp_getPosition(e),t=this._myBlurRecoverHeadTransform.quat2_getPosition(t),n=e.vec3_removeComponentAlongAxis(i,n),o=t.vec3_removeComponentAlongAxis(i,o),s=o.vec3_sub(n,s),this.moveFeet(s),a=this._myBlurRecoverHeadTransform.quat2_getForward(a),l=this._myCurrentHead.pp_getForward(l),h=l.vec3_rotationToPivotedQuat(a,i,h),this._myParams.myBlurEndResyncRotation&&this.rotateFeetQuat(h),this._myBlurRecoverHeadTransform=null))}}();se.prototype._sessionChangeResync=function(){let i=m(),e=m(),t=z(),n=m(),o=m(),s=m(),a=m(),l=m(),h=m(),_=m(),y=m(),c=m(),d=m(),g=m(),P=m(),T=m(),C=z();return function(){if(this._myBlurRecoverHeadTransform==null&&this._mySessionChangeResyncHeadTransform!=null){if(this._mySessionActive){i=this._myCurrentHead.pp_getPosition(i),e=this._mySessionChangeResyncHeadTransform.quat2_getPosition(e),t=this._mySessionChangeResyncHeadTransform.quat2_getRotationQuat(t),n=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(n),o=i.vec3_removeComponentAlongAxis(n,o),s=e.vec3_removeComponentAlongAxis(n,s),a=s.vec3_sub(o,a),this.moveFeet(a);let D=B.isReferenceSpaceFloorBased(this._myParams.myEngine)||B.isDeviceEmulated(this._myParams.myEngine);if(this._myParams.myEnterSessionResyncHeight||this._myParams.myNextEnterSessionResyncHeight){this._myParams.myNextEnterSessionResyncHeight=!1;let E=this._getPositionHeight(e),S=this._getPositionHeight(i);this._myParams.myHeightOffsetVRWithoutFloor=E+this._myParams.myForeheadExtraHeight,this._myParams.myHeightOffsetVRWithFloor==null&&(this._myParams.myHeightOffsetVRWithFloor=0),this._myParams.myHeightOffsetVRWithFloor=this._myParams.myHeightOffsetVRWithFloor+(E-S),this._updateHeightOffset()}else if(D&&(this._myParams.myNextEnterSessionFloorHeight!=null||this._myParams.myEnterSessionFloorHeight!=null)){let E=this._myParams.myNextEnterSessionFloorHeight!=null?this._myParams.myNextEnterSessionFloorHeight:this._myParams.myEnterSessionFloorHeight;E-=this._myParams.myForeheadExtraHeight;let S=this._getPositionHeight(i);this._myParams.myHeightOffsetVRWithFloor==null&&(this._myParams.myHeightOffsetVRWithFloor=0),this._myParams.myHeightOffsetVRWithFloor=this._myParams.myHeightOffsetVRWithFloor+(E-S),this._updateHeightOffset()}this._resyncHeadRotationForward(t)}else{if(n=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(n),e=this._mySessionChangeResyncHeadTransform.quat2_getPosition(e),s=e.vec3_removeComponentAlongAxis(n,s),y=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getPosition(y),c=s.vec3_add(y.vec3_componentAlongAxis(n,c),c),r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_setPosition(c),r.getPlayerObjects(this._myParams.myEngine).myCameraNonXR.pp_resetPositionLocal(),this._myParams.myExitSessionResyncHeight){let D=this._getPositionHeight(e);this._myParams.myHeightOffsetNonVR=D+this._myParams.myForeheadExtraHeight,this._updateHeightOffset()}if(t=this._mySessionChangeResyncHeadTransform.quat2_getRotationQuat(t),this._myParams.myExitSessionRemoveRightTilt||this._myParams.myExitSessionAdjustMaxVerticalAngle||!this._myParams.myExitSessionResyncVerticalAngle){if(l=t.quat_getForward(l),h=t.quat_getUp(h),d=l.vec3_cross(n,d),d.vec3_normalize(d),!h.vec3_isConcordant(n)){let D=l.vec3_angle(n),E=45;(D>180-E||D<E)&&d.vec3_negate(d)}d.vec3_isZero(1e-6)&&(d=t.quat_getRight(d)),P=d.vec3_cross(l,P),P.vec3_normalize(P),T=P.vec3_cross(d,T),T.vec3_normalize(T),C.quat_fromAxes(d.vec3_negate(g),P,T),t.quat_copy(C)}if(this._myParams.myExitSessionAdjustMaxVerticalAngle||!this._myParams.myExitSessionResyncVerticalAngle){h=t.quat_getUp(h),_=t.quat_getRight(_);let D=Math.max(0,this._myParams.myExitSessionMaxVerticalAngle-1e-4);this._myParams.myExitSessionResyncVerticalAngle||(D=0);let E=Math.pp_angleClamp(h.vec3_angleSigned(n,_));if(Math.abs(E)>D){let S=(Math.abs(E)-D)*Math.pp_sign(E);t=t.quat_rotateAxis(S,_,t)}}this.setRotationHeadQuat(t)}this._mySessionActive&&(this._myParams.myNextEnterSessionFloorHeight=null,this._myFirstEnterSessionResyncDone=!0),this._mySessionChangeResyncHeadTransform=null}}}();se.prototype._resyncHeadRotationForward=function(){let i=m(),e=m(),t=m(),n=z();return function(s){i=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp(i),e=s.quat_getForward(e),t=s.quat_getUp(t),n.quat_copy(s),n.quat_setUp(i,e),t.vec3_isConcordant(i)||n.quat_rotateAxis(180,i,n),this.setRotationFeetQuat(n)}}();se.prototype._updateHeightOffset=function(){return function(){this._mySessionActive?B.isDeviceEmulated(this._myParams.myEngine)?this._setPlayerPivotHeightOffset(0,0):B.isReferenceSpaceFloorBased(this._myParams.myEngine)?this._setPlayerPivotHeightOffset(this._myParams.myHeightOffsetVRWithFloor,0):this._setPlayerPivotHeightOffset(this._myParams.myHeightOffsetVRWithoutFloor,this._myParams.myForeheadExtraHeight):this._setPlayerPivotHeightOffset(this._myParams.myHeightOffsetNonVR,this._myParams.myForeheadExtraHeight)}}();se.prototype._setPlayerPivotHeightOffset=function(){let i=m();return function(t,n){t!=null&&(i=r.getPlayerObjects(this._myParams.myEngine).myPlayerPivot.pp_getPositionLocal(i),r.getPlayerObjects(this._myParams.myEngine).myPlayerPivot.pp_setPositionLocal([i[0],t-n,i[2]]))}}();se.prototype._getHeadTransformFromLocal=function(){return function(e){return this._myCurrentHead.pp_convertTransformLocalToWorldQuat(e)}}();Object.defineProperty(se.prototype,"_getPositionHeight",{enumerable:!1});Object.defineProperty(se.prototype,"_onXRSessionStart",{enumerable:!1});Object.defineProperty(se.prototype,"_onXRSessionEnd",{enumerable:!1});Object.defineProperty(se.prototype,"_onXRSessionBlurStart",{enumerable:!1});Object.defineProperty(se.prototype,"_onXRSessionBlurEnd",{enumerable:!1});Object.defineProperty(se.prototype,"_onViewReset",{enumerable:!1});Object.defineProperty(se.prototype,"_blurEndResync",{enumerable:!1});Object.defineProperty(se.prototype,"_sessionChangeResync",{enumerable:!1});Object.defineProperty(se.prototype,"_setPlayerPivotHeightOffset",{enumerable:!1});import{Component as tA,Property as me}from"@wonderlandengine/api";import{PhysXComponent as eA}from"@wonderlandengine/api";var go=class{constructor(){this.myIsFlying=!1,this.myCollisionRuntimeParams=null,this.myIsTeleportDetecting=!1,this.myIsTeleporting=!1,this.myTeleportJustPerformed=!1}},Hi=class{constructor(e){this._myLocomotionRuntimeParams=e}start(){}stop(){}canStop(){return!0}};var fo=class{constructor(e=r.getMainEngine()){this.myPlayerHeadManager=null,this.myMaxRotationSpeed=0,this.myIsSnapTurn=!1,this.mySnapTurnOnlyVR=!1,this.mySmoothSnapEnabled=!0,this.mySmoothSnapSpeedDegrees=240,this.myRotationMinStickIntensityThreshold=0,this.mySnapTurnActivateThreshold=0,this.mySnapTurnResetThreshold=0,this.myClampVerticalAngle=!0,this.myMaxVerticalAngle=0,this.myHandedness=A.RIGHT,this.myEngine=e}},Wt=class{constructor(e){this._myParams=e,this._mySnapCharge=!1,this._mySmoothSnapHorizontalRunning=!1,this._mySmoothSnapHorizontalAngleToPerform=0,this._mySmoothSnapVerticalRunning=!1,this._mySmoothSnapVerticalAngleToPerform=0}start(){}stop(){this._mySmoothSnapHorizontalRunning=!1,this._mySmoothSnapHorizontalAngleToPerform=0,this._mySmoothSnapVerticalRunning=!1,this._mySmoothSnapVerticalAngleToPerform=0}update(e){this._rotateHeadHorizontally(e),this._myParams.myPlayerHeadManager.canRotateHead()&&this._rotateHeadVertically(e)}};Wt.prototype._rotateHeadHorizontally=function(){let i=m(),e=z();return function(n){i=this._myParams.myPlayerHeadManager.getPlayer().pp_getUp(i),e.quat_identity();let o=r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getAxesInfo(oe.THUMBSTICK).getAxes();if(!this._myParams.myIsSnapTurn||this._myParams.mySnapTurnOnlyVR&&!B.isSessionActive(this._myParams.myEngine)){if(Math.abs(o[0])>this._myParams.myRotationMinStickIntensityThreshold){let s=-o[0],a=Math.pp_lerp(0,this._myParams.myMaxRotationSpeed,Math.abs(s))*Math.pp_sign(s);e.quat_fromAxis(a*n,i)}}else if(!this._mySnapCharge)Math.abs(o.vec2_length())<this._myParams.mySnapTurnResetThreshold&&(this._mySnapCharge=!0);else if(!this._mySmoothSnapHorizontalRunning&&Math.abs(o[0])>this._myParams.mySnapTurnActivateThreshold){let s=-Math.pp_sign(o[0])*this._myParams.mySnapTurnAngle;this._myParams.mySmoothSnapEnabled?(this._mySmoothSnapHorizontalRunning=!0,this._mySmoothSnapHorizontalAngleToPerform=s):e.quat_fromAxis(s,i),this._mySnapCharge=!1}if(this._mySmoothSnapHorizontalRunning){let s=Math.pp_sign(this._mySmoothSnapHorizontalAngleToPerform)*(this._myParams.mySmoothSnapSpeedDegrees*n);Math.abs(s)>Math.abs(this._mySmoothSnapHorizontalAngleToPerform)-Math.PP_EPSILON&&(s=this._mySmoothSnapHorizontalAngleToPerform),e.quat_fromAxis(s,i),this._mySmoothSnapHorizontalAngleToPerform-=s,Math.abs(this._mySmoothSnapHorizontalAngleToPerform)<Math.PP_EPSILON&&(this._mySmoothSnapHorizontalRunning=!1,this._mySmoothSnapHorizontalAngleToPerform=0)}e.quat_getAngle()>Math.PP_EPSILON_DEGREES&&this._myParams.myPlayerTransformManager.rotateQuat(e)}}();Wt.prototype._rotateHeadVertically=function(){let i=m(),e=m(),t=m(),n=m(),o=m(),s=m(),a=z();return function(h){let _=this._myParams.myPlayerHeadManager.getHead();i=_.pp_getForward(i),e=_.pp_getUp(e),t=this._myParams.myPlayerHeadManager.getPlayer().pp_getUp(t),n=t.vec3_negate(n),o=i.vec3_cross(t,o);let y=1;i.vec3_angle(t)<y?o=e.vec3_negate(o).vec3_cross(t,o):i.vec3_angle(n)<y?o=e.vec3_cross(t,o):e.vec3_isConcordant(t)||o.vec3_negate(o),o.vec3_normalize(o);let c=r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getAxesInfo(oe.THUMBSTICK).getAxes(),d=0;if(!this._myParams.myIsSnapTurn||this._myParams.mySnapTurnOnlyVR&&!B.isSessionActive(this._myParams.myEngine)){if(Math.abs(c[1])>this._myParams.myRotationMinStickIntensityThreshold){let g=c[1];d=Math.pp_lerp(0,this._myParams.myMaxRotationSpeed,Math.abs(g))*Math.pp_sign(g)*h}}else if(!this._mySnapCharge)Math.abs(c.vec2_length())<this._myParams.mySnapTurnResetThreshold&&(this._mySnapCharge=!0);else if(!this._mySmoothSnapVerticalRunning&&Math.abs(c[1])>this._myParams.mySnapTurnActivateThreshold){d=Math.pp_sign(c[1])*this._myParams.mySnapTurnAngle;let g=Math.pp_angleClamp(e.vec3_angleSigned(t,o)),P=Math.round(g/this._myParams.mySnapTurnAngle),T=Math.pp_angleClamp(P*this._myParams.mySnapTurnAngle),C=-Math.pp_angleDistanceSigned(g,T);Math.abs(C)>1?Math.pp_sign(d)==Math.pp_sign(C)?d=C:d=-Math.pp_sign(C)*this._myParams.mySnapTurnAngle+C:Math.abs(C)>Math.PP_EPSILON_DEGREES&&(d+=C),this._myParams.mySmoothSnapEnabled&&(this._mySmoothSnapVerticalRunning=!0,this._mySmoothSnapVerticalAngleToPerform=d),this._mySnapCharge=!1}if(this._mySmoothSnapVerticalRunning&&(d=Math.pp_sign(this._mySmoothSnapVerticalAngleToPerform)*(this._myParams.mySmoothSnapSpeedDegrees*h),Math.abs(d)>Math.abs(this._mySmoothSnapVerticalAngleToPerform)-Math.PP_EPSILON&&(d=this._mySmoothSnapVerticalAngleToPerform),this._mySmoothSnapVerticalAngleToPerform-=d,Math.abs(this._mySmoothSnapVerticalAngleToPerform)<Math.PP_EPSILON&&(this._mySmoothSnapVerticalRunning=!1,this._mySmoothSnapVerticalAngleToPerform=0)),d!=0&&(a.quat_fromAxis(d,o),this._myParams.myPlayerHeadManager.rotateHeadQuat(a),this._myParams.myClampVerticalAngle)){let g=this._myParams.myMaxVerticalAngle-1e-4;s=_.pp_getUp(s);let P=Math.pp_angleClamp(s.vec3_angleSigned(t,o));if(Math.abs(P)>g){let T=(Math.abs(P)-g)*Math.pp_sign(P);a.quat_fromAxis(T,o),this._myParams.myPlayerHeadManager.rotateHeadQuat(a)}}}}();Object.defineProperty(Wt.prototype,"_rotateHeadHorizontally",{enumerable:!1});Object.defineProperty(Wt.prototype,"_rotateHeadVertically",{enumerable:!1});import{PhysXComponent as $R}from"@wonderlandengine/api";var Po=class{constructor(e=r.getMainEngine()){this.myPlayerTransformManager=null,this.myObscureObject=null,this.myObscureMaterial=null,this.myObscureRadius=0,this.myObscureFadeOutSeconds=.1,this.myObscureFadeInSeconds=.1,this.myObscureFadeEasingFunction=ue.linear,this.myDistanceToStartObscureWhenHeadColliding=0,this.myDistanceToStartObscureWhenBodyColliding=0,this.myDistanceToStartObscureWhenFloating=0,this.myDistanceToStartObscureWhenFar=0,this.myRelativeDistanceToMaxObscureWhenHeadColliding=0,this.myRelativeDistanceToMaxObscureWhenBodyColliding=0,this.myRelativeDistanceToMaxObscureWhenFloating=0,this.myRelativeDistanceToMaxObscureWhenFar=0,this.myObscureLevelRelativeDistanceEasingFunction=ue.linear,this.myEngine=e}},Co=class{constructor(e){this._myParams=e,this._myObscureMaterial=null,this._myObscureParentObject=null,this._myCurrentObscureLevel=0,this._myTargetObscureLevel=0,this._myLastTargetObscureLevel=null,this._myLastIsFadingIn=null,this._myFadeTimer=new ie(0,!1),this._myFSM=new ze,this._myFSM.addState("init"),this._myFSM.addState("inactive"),this._myFSM.addState("idle",this._idleUpdate.bind(this)),this._myFSM.addState("fading",this._fadingUpdate.bind(this)),this._myFSM.addTransition("init","inactive","end",this._setObscureLevel.bind(this,0)),this._myFSM.addTransition("inactive","idle","start"),this._myFSM.addTransition("idle","fading","fade",this._startFading.bind(this)),this._myFSM.addTransition("fading","idle","done",this._fadingDone.bind(this)),this._myFSM.addTransition("inactive","inactive","stop",this._setObscureLevel.bind(this,0)),this._myFSM.addTransition("idle","inactive","stop",this._setObscureLevel.bind(this,0)),this._myFSM.addTransition("fading","inactive","stop",this._setObscureLevel.bind(this,0)),this._myFSM.init("init"),this._setupVisuals(),this._myFSM.perform("end"),this._myDestroyed=!1}start(){this._myFSM.perform("start")}stop(){this._myFSM.perform("stop")}update(e){this._myObscureParentObject.pp_resetTransformLocal(),this._updateObscured(),this._myFSM.update(e),this._setObscureVisible(this.isObscured())}isStarted(){return!this._myFSM.isInState("inactive")}isObscured(){return this._myCurrentObscureLevel>0}isFading(){return this._myFSM.isInState("fading")}isFadingIn(){return this.isFading()&&this._myCurrentObscureLevel>this._myTargetObscureLevel}isFadingOut(){return this.isFading()&&this._myCurrentObscureLevel<=this._myTargetObscureLevel}getObscureLevel(){return this._myCurrentObscureLevel}getTargetObscureLevel(){return this._myTargetObscureLevel}getCurrentObscureLevel(){this._myCurrentObscureLevel}overrideObscureLevel(e,t=!1){this._myObscureLevelOverride=e,t&&this.isStarted()&&this._setObscureLevel(e)}resetObscureLevelOverride(){this._myObscureLevelOverride=null}_idleUpdate(e){Math.abs(this._myTargetObscureLevel-this._myCurrentObscureLevel)>Math.PP_EPSILON&&this._myFSM.perform("fade")}_fadingUpdate(e){if(Math.abs(this._myTargetObscureLevel-this._myCurrentObscureLevel)<=Math.PP_EPSILON){this._myFSM.perform("done");return}this._myLastTargetObscureLevel!=this._myTargetObscureLevel&&(this._refreshFadeTimer(),this._myLastTargetObscureLevel=this._myTargetObscureLevel),this._myFadeTimer.update(e);let t=this._myParams.myObscureFadeEasingFunction(this._myFadeTimer.getPercentage());this._myCurrentObscureLevel>this._myTargetObscureLevel?(t=Math.pp_clamp(1-t,0,1),t=Math.max(t,this._myTargetObscureLevel)):t=Math.min(t,this._myTargetObscureLevel),this._setObscureAlpha(t),this._myCurrentObscureLevel=t,(Math.abs(this._myTargetObscureLevel-this._myCurrentObscureLevel)<=Math.PP_EPSILON||this._myFadeTimer.isDone())&&this._myFSM.perform("done")}_startFading(){this._myLastTargetObscureLevel=null,this._myLastIsFadingIn=null}_fadingDone(){this._setObscureLevel(this._myTargetObscureLevel)}_refreshFadeTimer(){let e=this._myCurrentObscureLevel>this._myTargetObscureLevel;this._myLastIsFadingIn!=e&&this._setFadeTimerToObscureLevel(e),this._myLastIsFadingIn=e}_setFadeTimerToObscureLevel(e){let t=0,n=0,s=1/1e3;for(;t<1;)Math.abs(this._myParams.myObscureFadeEasingFunction(t)-this._myCurrentObscureLevel)<Math.abs(this._myParams.myObscureFadeEasingFunction(n)-this._myCurrentObscureLevel)&&(n=t),t+=s;Math.abs(this._myParams.myObscureFadeEasingFunction(1)-this._myCurrentObscureLevel)<Math.abs(this._myParams.myObscureFadeEasingFunction(n)-this._myCurrentObscureLevel)&&(n=1),e?(this._myFadeTimer.start(this._myParams.myObscureFadeInSeconds),this._myFadeTimer.setPercentage(Math.pp_clamp(1-n,0,1))):(this._myFadeTimer.start(this._myParams.myObscureFadeOutSeconds),this._myFadeTimer.setPercentage(Math.pp_clamp(n,0,1)))}_setObscureLevel(e){this._myTargetObscureLevel=e,this._myCurrentObscureLevel=e,this._setObscureAlpha(e),this._setObscureVisible(this.isObscured())}_setObscureAlpha(e){this._myParams.myObscureObject==null?Us.setAlpha(this._myObscureMaterial,e):Us.setObjectAlpha(this._myParams.myObscureObject,e)}_updateObscured(){if(this._myTargetObscureLevel=0,this._myObscureLevelOverride!=null)this._myTargetObscureLevel=this._myObscureLevelOverride;else{if(this._myParams.myPlayerTransformManager.isHeadColliding()){let t=this._myParams.myPlayerTransformManager.getDistanceToRealHead()-this._myParams.myDistanceToStartObscureWhenHeadColliding;if(t>=0){let n=Math.pp_clamp(t/this._myParams.myRelativeDistanceToMaxObscureWhenHeadColliding,0,1),o=this._myParams.myObscureLevelRelativeDistanceEasingFunction(n);this._myTargetObscureLevel=Math.max(this._myTargetObscureLevel,o)}}if(this._myParams.myPlayerTransformManager.isBodyColliding()){let t=this._myParams.myPlayerTransformManager.getDistanceToReal()-this._myParams.myDistanceToStartObscureWhenBodyColliding;if(t>=0){let n=Math.pp_clamp(t/this._myParams.myRelativeDistanceToMaxObscureWhenBodyColliding,0,1),o=this._myParams.myObscureLevelRelativeDistanceEasingFunction(n);this._myTargetObscureLevel=Math.max(this._myTargetObscureLevel,o)}}if(this._myParams.myPlayerTransformManager.isFloating()){let t=this._myParams.myPlayerTransformManager.getDistanceToReal()-this._myParams.myDistanceToStartObscureWhenFloating;if(t>=0){let n=Math.pp_clamp(t/this._myParams.myRelativeDistanceToMaxObscureWhenFloating,0,1),o=this._myParams.myObscureLevelRelativeDistanceEasingFunction(n);this._myTargetObscureLevel=Math.max(this._myTargetObscureLevel,o)}}if(this._myParams.myPlayerTransformManager.isFar()){let t=this._myParams.myPlayerTransformManager.getDistanceToReal()-this._myParams.myDistanceToStartObscureWhenFar;if(t>=0){let n=Math.pp_clamp(t/this._myParams.myRelativeDistanceToMaxObscureWhenFar,0,1),o=this._myParams.myObscureLevelRelativeDistanceEasingFunction(n);this._myTargetObscureLevel=Math.max(this._myTargetObscureLevel,o)}}}}_setupVisuals(){this._myObscureMaterial=null,this._myParams.myObscureMaterial!=null?this._myObscureMaterial=this._myParams.myObscureMaterial:(this._myObscureMaterial=r.getDefaultMaterials(this._myParams.myEngine).myFlatTransparentNoDepth.clone(),this._myObscureMaterial.color=w(0,0,0,1)),this._myObscureParentObject=r.getPlayerObjects(this._myParams.myEngine).myPlayerCauldron.pp_addObject();let e=new ni(this._myParams.myEngine);e.myMesh=r.getDefaultMeshes(this._myParams.myEngine).myInvertedSphere,e.myMaterial=this._myParams.myObscureMaterial!=null?this._myParams.myObscureMaterial:this._myObscureMaterial,e.myParent=this._myObscureParentObject,e.myLocal=!0,e.myTransform.mat4_setScale(m(this._myParams.myObscureRadius,this._myParams.myObscureRadius,this._myParams.myObscureRadius)),this._myObscureVisual=new Ei(e),this._myParams.myObscureObject!=null&&(this._myParams.myObscureObject.pp_setParent(this._myObscureParentObject,!1),this._myParams.myObscureObject.pp_resetTransformLocal()),this._setObscureVisible(!1)}_setObscureVisible(e){this._myParams.myObscureObject==null?this._myObscureVisual.setVisible(e):(this._myObscureVisual.setVisible(!1),this._myParams.myObscureObject.pp_setActive(e)),e?this._myObscureParentObject.pp_setParent(this._myParams.myPlayerTransformManager.getHead(),!1):this._myObscureParentObject.pp_setParent(r.getPlayerObjects(this._myParams.myEngine)?.myPlayerCauldron,!1)}destroy(){this._myDestroyed=!0,this._myObscureVisual.destroy()}isDestroyed(){return this._myDestroyed}};var la=class{constructor(){this.myTeleportParableValidMaterial=null,this.myTeleportParableInvalidMaterial=null,this.myTeleportPositionObject=null,this.myTeleportParableLineEndOffset=.05,this.myTeleportParableMinVerticalDistanceToShowVerticalLine=.25,this.myTeleportParablePositionUpOffset=.05,this.myTeleportParablePositionVisualAlignOnSurface=!0,this.myVisualTeleportPositionLerpEnabled=!0,this.myVisualTeleportPositionLerpFactor=10,this.myVisualTeleportPositionMinDistanceToResetLerp=.005,this.myVisualTeleportPositionMinDistanceToLerp=.15,this.myVisualTeleportPositionMaxDistanceToLerp=5,this.myVisualTeleportPositionMinDistanceToCloseLerpFactor=.02,this.myVisualTeleportPositionCloseLerpFactor=30,this.myVisualTeleportPositionMinAngleDistanceToResetLerp=.1,this.myVisualTeleportPositionMinAngleDistanceToLerp=1,this.myVisualTeleportPositionMaxAngleDistanceToLerp=180}},nn=class{constructor(e,t,n){this._myDetectionRuntimeParams=n,this._myTeleportParams=e,this._myTeleportRuntimeParams=t,this._myVisualTeleportTransformQuatReset=!0,this._myVisualTeleportTransformQuat=j(),this._myVisualTeleportTransformPositionLerping=!1,this._myVisualTeleportTransformRotationLerping=!1,this._setupVisuals(),this._myDestroyed=!1}start(){}end(){this._myVisualTeleportTransformQuatReset=!0,this._myVisualTeleportTransformPositionLerping=!1,this._myVisualTeleportTransformRotationLerping=!1,this._hideTeleportPosition()}update(e){this._myDetectionRuntimeParams.myTeleportDetectionValid?this._showTeleportPosition(e):(this._myVisualTeleportTransformQuatReset=!0,this._myVisualTeleportTransformPositionLerping=!1,this._myVisualTeleportTransformRotationLerping=!1,this._hideTeleportPosition())}_showTeleportPosition(e){this._hideTeleportPosition(),this._showTeleportParable(e)}_hideTeleportPosition(){for(let e of this._myValidVisualLines)e.setVisible(!1);for(let e of this._myInvalidVisualLines)e.setVisible(!1);this._myValidVisualPoint.setVisible(!1),this._myInvalidVisualPoint.setVisible(!1),this._myValidVisualVerticalLine.setVisible(!1),this._myValidVisualTeleportPositionTorus.setVisible(!1),this._myValidVisualTeleportPositionTorusInner.setVisible(!1),this._myTeleportParams.myVisualizerParams.myTeleportPositionObject!=null&&this._myTeleportParams.myVisualizerParams.myTeleportPositionObject.pp_setActive(!1)}_addVisualLines(e){for(let t=0;t<e;t++){{let n=new Ke(this._myTeleportParams.myEngine);this._myTeleportParams.myVisualizerParams.myTeleportParableValidMaterial!=null?n.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportParableValidMaterial:n.myMaterial=this._myTeleportParableValidMaterial,this._myValidVisualLines.push(new rt(n))}{let n=new Ke(this._myTeleportParams.myEngine);this._myTeleportParams.myVisualizerParams.myTeleportParableValidMaterial!=null?n.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportParableInvalidMaterial:n.myMaterial=this._myTeleportParableInvalidMaterial,this._myInvalidVisualLines.push(new rt(n))}}}destroy(){this._myDestroyed=!0;for(let e of this._myValidVisualLines)e.destroy();for(let e of this._myInvalidVisualLines)e.destroy();this._myValidVisualPoint.destroy(),this._myInvalidVisualPoint.destroy(),this._myValidVisualVerticalLine.destroy(),this._myValidVisualTeleportPositionTorus.destroy(),this._myValidVisualTeleportPositionTorusInner.destroy()}isDestroyed(){return this._myDestroyed}};nn.prototype._setupVisuals=function(){let i=m();return function(){this._myTeleportParableValidMaterial=r.getDefaultMaterials(this._myTeleportParams.myEngine).myFlatOpaque.clone(),this._myTeleportParableValidMaterial.color=w(0,.5,1,1),this._myTeleportParableInvalidMaterial=r.getDefaultMaterials(this._myTeleportParams.myEngine).myFlatOpaque.clone(),this._myTeleportParableInvalidMaterial.color=w(.75,.05,0,1),this._myValidVisualLines=[],this._myInvalidVisualLines=[],this._addVisualLines(30);{let t=new vt(this._myTeleportParams.myEngine);this._myTeleportParams.myVisualizerParams.myTeleportParableValidMaterial!=null?t.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportParableValidMaterial:t.myMaterial=this._myTeleportParableValidMaterial,this._myValidVisualPoint=new wt(t)}{let t=new vt(this._myTeleportParams.myEngine);this._myTeleportParams.myVisualizerParams.myTeleportParableInvalidMaterial!=null?t.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportParableInvalidMaterial:t.myMaterial=this._myTeleportParableInvalidMaterial,this._myInvalidVisualPoint=new wt(t)}{let t=new Ke(this._myTeleportParams.myEngine);this._myTeleportParams.myVisualizerParams.myTeleportParableValidMaterial!=null?t.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportParableValidMaterial:t.myMaterial=this._myTeleportParableValidMaterial,this._myValidVisualVerticalLine=new rt(t)}this._myVisualTeleportPositionObject=r.getPlayerObjects(this._myTeleportParams.myEngine).myPlayerCauldron.pp_addObject();{let t=new jt(this._myTeleportParams.myEngine);t.myRadius=.175,t.mySegmentsAmount=24,t.mySegmentThickness=.02,this._myTeleportParams.myVisualizerParams.myTeleportParableValidMaterial!=null?t.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportParableValidMaterial:t.myMaterial=this._myTeleportParableValidMaterial,t.myParent=this._myVisualTeleportPositionObject,t.myLocal=!0,this._myValidVisualTeleportPositionTorus=new zt(t)}{let t=new jt(this._myTeleportParams.myEngine);t.myRadius=.04,t.mySegmentsAmount=24,t.mySegmentThickness=.02,this._myTeleportParams.myVisualizerParams.myTeleportParableValidMaterial!=null?t.myMaterial=this._myTeleportParams.myVisualizerParams.myTeleportParableValidMaterial:t.myMaterial=this._myTeleportParableValidMaterial,t.myParent=this._myVisualTeleportPositionObject,t.myLocal=!0;let n=this._myValidVisualTeleportPositionTorus.getParams(),o=(n.myRadius-n.mySegmentThickness/2)/2;i.vec3_set(0,0,o),t.myTransform.mat4_setPosition(i),this._myValidVisualTeleportPositionTorusInner=new zt(t)}this._myTeleportParams.myVisualizerParams.myTeleportPositionObject!=null&&(this._myTeleportParams.myVisualizerParams.myTeleportPositionObject.pp_setParent(this._myVisualTeleportPositionObject),this._myTeleportParams.myVisualizerParams.myTeleportPositionObject.pp_resetTransformLocal(),this._myTeleportParams.myVisualizerParams.myTeleportPositionObject.pp_setActive(!1)),this._hideTeleportPosition()}}();nn.prototype._showTeleportParable=function(){let i=m(),e=m(),t=m(),n=m();return function(s){let a=Math.max(this._myDetectionRuntimeParams.myParableDistance-this._myTeleportParams.myVisualizerParams.myTeleportParableLineEndOffset),l=this._myDetectionRuntimeParams.myParable.getPositionIndexByDistance(a),h=this._myDetectionRuntimeParams.myParable.getDistance(l);l+1>this._myValidVisualLines.length&&this._addVisualLines(l+1,this._myValidVisualLines.length);for(let c=0;c<=l;c++){i=this._myDetectionRuntimeParams.myParable.getPosition(c,i),e=this._myDetectionRuntimeParams.myParable.getPosition(c+1,e);let d=this._myDetectionRuntimeParams.myTeleportPositionValid?this._myValidVisualLines[c]:this._myInvalidVisualLines[c],g=d.getParams();if(c==l){let P=Math.max(0,a-h);e=e.vec3_sub(i,e).vec3_normalize(e),e=i.vec3_add(e.vec3_scale(P,e),e)}g.setStartEnd(i,e),g.myThickness=.005,d.paramsUpdated(),d.setVisible(!0),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugShowEnabled&&r.isDebugEnabled(this._myTeleportParams.myEngine)&&r.getDebugVisualManager(this._myTeleportParams.myEngine).drawPoint(0,i,w(1,0,0,1),.01)}let _=this._myDetectionRuntimeParams.myTeleportPositionValid?this._myValidVisualPoint:this._myInvalidVisualPoint,y=_.getParams();if(y.myPosition.vec3_copy(e),y.myRadius=.01,_.paramsUpdated(),_.setVisible(!0),this._myDetectionRuntimeParams.myTeleportPositionValid){t=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(t),n=e.vec3_sub(this._myTeleportRuntimeParams.myTeleportPosition,n).vec3_componentAlongAxis(t,n);let c=n.vec3_length();if(c>=this._myTeleportParams.myVisualizerParams.myTeleportParableMinVerticalDistanceToShowVerticalLine){let d=Math.min(c-this._myTeleportParams.myVisualizerParams.myTeleportParableMinVerticalDistanceToShowVerticalLine,this._myTeleportParams.myVisualizerParams.myTeleportParableMinVerticalDistanceToShowVerticalLine),g=this._myValidVisualVerticalLine.getParams();g.myStart.vec3_copy(e),g.myDirection=t.vec3_negate(g.myDirection),g.myLength=d,g.myThickness=.005,this._myValidVisualVerticalLine.paramsUpdated(),this._myValidVisualVerticalLine.setVisible(!0)}this._showTeleportParablePosition(s)}else this._myVisualTeleportTransformQuatReset=!0,this._myVisualTeleportTransformPositionLerping=!1,this._myVisualTeleportTransformRotationLerping=!1}}();nn.prototype._showTeleportParablePosition=function(){let i=m(),e=j(),t=z(),n=m(),o=m(),s=z(),a=j(),l=m(),h=z(),_=z();return function(c){if(i=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(i),e=this._myTeleportParams.myPlayerHeadManager.getTransformFeetQuat(e),t=e.quat2_getRotationQuat(t),t=t.quat_rotateAxis(this._myTeleportRuntimeParams.myTeleportRotationOnUp,i,t),o=t.quat_getForward(o),n=this._myTeleportRuntimeParams.myTeleportPosition.vec3_add(i.vec3_scale(this._myTeleportParams.myVisualizerParams.myTeleportParablePositionUpOffset,n),n),this._myTeleportParams.myVisualizerParams.myTeleportParablePositionVisualAlignOnSurface?s.quat_setUp(this._myDetectionRuntimeParams.myTeleportSurfaceNormal,o):s.quat_setUp(i,o),this._myVisualTeleportTransformQuat.quat2_setPositionRotationQuat(n,s),this._myVisualTeleportTransformQuatReset||!this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionLerpEnabled)this._myVisualTeleportPositionObject.pp_setTransformQuat(this._myVisualTeleportTransformQuat),this._myVisualTeleportTransformQuatReset=!1;else{a=this._myVisualTeleportPositionObject.pp_getTransformQuat(a),l=a.quat2_getPosition(l),h=a.quat2_getRotationQuat(h),h.quat_rotationToQuat(s,_);let d=l.vec3_distance(n),g=_.quat_getAngle();if((!this._myVisualTeleportTransformPositionLerping||d<this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMinDistanceToResetLerp)&&(d<this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMinDistanceToLerp||d>this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMaxDistanceToLerp))this._myVisualTeleportTransformPositionLerping=!1,l.vec3_copy(n);else{this._myVisualTeleportTransformPositionLerping=!0;let P=this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionLerpFactor*c;d<this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMinDistanceToCloseLerpFactor&&(P=this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionCloseLerpFactor*c),l.vec3_lerp(n,P,l)}if((!this._myVisualTeleportTransformRotationLerping||g<this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMinAngleDistanceToResetLerp)&&(g<this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMinAngleDistanceToLerp||d>this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionMaxAngleDistanceToLerp))this._myVisualTeleportTransformRotationLerping=!1,h.quat_copy(s);else{let P=this._myTeleportParams.myVisualizerParams.myVisualTeleportPositionLerpFactor*c;this._myVisualTeleportTransformRotationLerping=!0,h.quat_slerp(s,P,h)}a.quat2_setPositionRotationQuat(l,h),this._myVisualTeleportPositionObject.pp_setTransformQuat(a)}{let d=this._myValidVisualTeleportPositionTorus.getParams();d.myRadius=.175,d.mySegmentsAmount=24,d.mySegmentThickness=.02,this._myValidVisualTeleportPositionTorus.paramsUpdated()}{let d=this._myValidVisualTeleportPositionTorusInner.getParams();d.myRadius=.04,d.mySegmentsAmount=24,d.mySegmentThickness=.02,this._myValidVisualTeleportPositionTorusInner.paramsUpdated()}this._myTeleportParams.myVisualizerParams.myTeleportPositionObject==null?(this._myValidVisualTeleportPositionTorus.setVisible(!0),this._myValidVisualTeleportPositionTorusInner.setVisible(!0)):(this._myValidVisualTeleportPositionTorus.setVisible(!1),this._myValidVisualTeleportPositionTorusInner.setVisible(!1),this._myTeleportParams.myVisualizerParams.myTeleportPositionObject.pp_setActive(!0)),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugShowEnabled&&r.isDebugEnabled(this._myTeleportParams.myEngine)&&r.getDebugVisualManager(this._myTeleportParams.myEngine).drawPoint(0,this._myTeleportRuntimeParams.myTeleportPosition,w(0,0,1,1),.02)}}();var Qt=class{constructor(){this._myStartPosition=m(),this._myForward=m(),this._myUp=m(),this._mySpeed=0,this._myGravity=0,this._myStepLength=0}setStartPosition(e){this._myStartPosition.vec3_copy(e)}setForward(e){this._myForward.vec3_copy(e)}setUp(e){this._myUp.vec3_copy(e)}setSpeed(e){this._mySpeed=e}setGravity(e){this._myGravity=e}setStepLength(e){this._myStepLength=e}getPosition(e,t=m()){}getDistance(e){}getPositionIndexByDistance(e){}getPositionByDistance(e,t=m()){}getDistanceOverFlatDistance(e,t){}getFlatDistanceOverDistance(e){}};Qt.prototype.getPosition=function(){let i=m(),e=m();return function(n,o=m()){let a=this._myStepLength/this._mySpeed*n;return i=this._myForward.vec3_scale(this._mySpeed*a,i),i=i.vec3_add(this._myStartPosition,i),e=this._myUp.vec3_scale(this._myGravity*a*a/2,e),o=i.vec3_add(e,o),o}}();Qt.prototype.getDistance=function(){let i=m(),e=m();return function(n){let o=0;e.vec3_copy(this._myStartPosition);for(let s=1;s<=n;s++)i=this.getPosition(s,i),o+=i.vec3_distance(e),e.vec3_copy(i);return o}}();Qt.prototype.getPositionIndexByDistance=function(){let i=m(),e=m();return function(n){let o=0,s=0;for(e=this.getPosition(s,e);o<n;)i=this.getPosition(s+1,i),o+=i.vec3_distance(e),s++,e.vec3_copy(i);return Math.max(0,s-1)}}();Qt.prototype.getPositionByDistance=function(){let i=m(),e=m(),t=m();return function(o,s=m()){let a=0,l=0,h=!1;for(e=this.getPosition(l,e);!h;){if(i=this.getPosition(l+1,i),a+=i.vec3_distance(e),l++,a>o){let _=a-o;t=i.vec3_sub(e,t);let y=t.vec3_length()-_;t.vec3_normalize(t),s=e.vec3_add(t.vec3_scale(y,s),s),h=!0}e.vec3_copy(i)}return s}}();Qt.prototype.getDistanceOverFlatDistance=function(){let i=m(),e=m(),t=m(),n=m(),o=m(),s=m();return function(l,h){if(l<1e-5)return 0;let _=0,y=0;t=this._myStartPosition.vec3_removeComponentAlongAxis(this._myUp,t),n=this.getPosition(y,n);let c=0;for(;_<=h;){i=this.getPosition(y+1,i),_+=i.vec3_distance(n),y++,e=i.vec3_removeComponentAlongAxis(this._myUp,e),s=e.vec3_sub(t,s);let d=s.vec3_length();if(d>=l){let g=d-l;o=i.vec3_sub(n,o);let P=o.vec3_angleRadians(s),T=Math.cos(P),C=o.vec3_length();T!=0&&(C=g/Math.cos(P)),c=_-C;break}else c=_;n.vec3_copy(i)}return Math.min(h,c)}}();Qt.prototype.getFlatDistanceOverDistance=function(){let i=m(),e=m(),t=m();return function(o){return i=this.getPositionByDistance(o,i),e=i.vec3_removeComponentAlongAxis(this._myUp,e),t=this._myStartPosition.vec3_removeComponentAlongAxis(this._myUp,t),t.vec3_distance(e)}}();var Ct=class extends mo{constructor(e,t,n){super(),this._myLocomotionRuntimeParams=n,this._myTeleportParams=e,this._myTeleportRuntimeParams=t,this._myTeleportAsMovementFailed=!1}};Ct.prototype._checkTeleport=function(){return function(e,t,n,o=null){fe(this._myTeleportParams.myEngine).teleport(e,t,this._myTeleportParams.myCollisionCheckParams,n),o?.copy(n)}}();Ct.prototype._checkTeleportAsMovement=function(){let i=new re,e=z(),t=m(),n=m(),o=m(),s=z(),a=j(),l=m(),h=m(),_=m(),y=m(),c=m(),d=j();return function(P,T,C,x){if(t=T.quat2_getPosition(t),e=T.quat2_getRotationQuat(e),n=e.quat_getUp(n),o=P.vec3_sub(t,o).vec3_removeComponentAlongAxis(n,o),o.vec3_normalize(o),o.vec3_isZero(1e-5)&&(o=e.quat_getForward(o)),s.quat_setUp(n,o),a.quat2_setPositionRotationQuat(t,s),this._checkTeleport(P,a,C,x),!C.myTeleportCanceled){let D=!1;i.copy(C),h.vec3_copy(C.myNewPosition),l.vec3_copy(t);for(let E=0;E<this._myTeleportParams.myTeleportAsMovementMaxSteps;E++){if(_=h.vec3_sub(l,_),this._myTeleportParams.myTeleportAsMovementRemoveVerticalMovement&&(_=_.vec3_removeComponentAlongAxis(n,_)),this._myTeleportParams.myTeleportAsMovementExtraVerticalMovementPerMeter!=0){let b=_.vec3_length()*this._myTeleportParams.myTeleportAsMovementExtraVerticalMovementPerMeter;y=n.vec3_scale(b,y),_=_.vec3_add(y,_)}if(d.quat2_setPositionRotationQuat(l,e),fe(this._myTeleportParams.myEngine).move(_,d,this._myTeleportParams.myCollisionCheckParams,i),!i.myHorizontalMovementCanceled&&!i.myVerticalMovementCanceled)if(c=h.vec3_sub(i.myNewPosition,c),c.vec3_length()<this._myTeleportParams.myTeleportAsMovementMaxDistanceFromTeleportPosition+1e-5){D=!0;break}else _.vec3_copy(c),l.vec3_copy(i.myNewPosition);else break}D||(C.myTeleportCanceled=!0),this._myTeleportAsMovementFailed=!D}}}();Ct.prototype._teleportToPosition=function(){let i=m(),e=j(),t=j(),n=z(),o=z();return function(a,l,h,_=!1){this._myTeleportAsMovementFailed=!1,i=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(i),e=this._myTeleportParams.myPlayerHeadManager.getTransformFeetQuat(e),n=e.quat2_getRotationQuat(n),l!=0&&(n=n.quat_rotateAxis(l,i,n)),t.quat2_setPositionRotationQuat(a,n),r.getGamepads(this._myTeleportParams.myEngine)[ee.getOppositeHandedness(this._myTeleportParams.myHandedness)].getButtonInfo(M.BOTTOM_BUTTON).isPressed()?(fe(this._myTeleportParams.myEngine).positionCheck(!0,t,this._myTeleportParams.myCollisionCheckParams,h),this._myTeleportParams.myPlayerHeadManager.teleportPositionFeet(a),l!=0&&(o.quat_fromAxis(l,i),this._myTeleportParams.myPlayerHeadManager.rotateFeetQuat(o))):this._myTeleportParams.myPlayerTransformManager.teleportTransformQuat(t,h,_)}}();var ma=class{constructor(){this.myMaxDistance=0,this.myMaxHeightDifference=0,this.myGroundAngleToIgnoreUpward=0,this.myMustBeOnGround=!1,this.myTeleportBlockLayerFlags=new Re,this.myTeleportFloorLayerFlags=new Re,this.myParableForwardMinAngleToBeValidUp=30,this.myParableForwardMinAngleToBeValidDown=0,this.myTeleportParableStartReferenceObject=null,this.myTeleportParableStartPositionOffset=m(0,-.04,.08),this.myTeleportParableStartRotationOffset=m(30,0,0),this.myTeleportParableSpeed=15,this.myTeleportParableGravity=-30,this.myTeleportParableStepLength=.25,this.myRotationOnUpMinStickIntensity=.5,this.myRotationOnUpEnabled=!1,this.myTeleportFeetPositionMustBeVisible=!1,this.myTeleportHeadPositionMustBeVisible=!1,this.myTeleportHeadOrFeetPositionMustBeVisible=!1,this.myVisibilityCheckRadius=.05,this.myVisibilityCheckFeetPositionVerticalOffset=.1,this.myVisibilityCheckDistanceFromHitThreshold=.1,this.myVisibilityCheckCircumferenceSliceAmount=6,this.myVisibilityCheckCircumferenceStepAmount=1,this.myVisibilityCheckCircumferenceRotationPerStep=30,this.myVisibilityBlockLayerFlags=new Re}},Qr=class{constructor(){this.myTeleportDetectionValid=!1,this.myTeleportPositionValid=!1,this.myTeleportSurfaceNormal=m(),this.myParable=new Qt}},dt=class extends Ct{constructor(e,t,n){super(e,t,n),this._myDetectionRuntimeParams=new Qr,this._myVisualizer=new nn(this._myTeleportParams,this._myTeleportRuntimeParams,this._myDetectionRuntimeParams),this._myTeleportRotationOnUpNext=0,this._myDestroyed=!1}start(){this._myLocomotionRuntimeParams.myIsTeleportDetecting=!0,this._myTeleportRuntimeParams.myTeleportRotationOnUp=0,this._myTeleportRotationOnUpNext=0,this._myDetectionRuntimeParams.myParable.setSpeed(this._myTeleportParams.myDetectionParams.myTeleportParableSpeed),this._myDetectionRuntimeParams.myParable.setGravity(this._myTeleportParams.myDetectionParams.myTeleportParableGravity),this._myDetectionRuntimeParams.myParable.setStepLength(this._myTeleportParams.myDetectionParams.myTeleportParableStepLength),this._myTeleportParams.myPlayerTransformManager.resetReal(!0,!1,!1),this._myTeleportParams.myPlayerTransformManager.resetHeadToReal(),this._myVisualizer.start()}end(){this._myLocomotionRuntimeParams.myIsTeleportDetecting=!1,this._myVisualizer.end()}update(e,t){this._detectTeleportPosition(),this._myVisualizer.update(e),this._confirmTeleport()?this._myDetectionRuntimeParams.myTeleportPositionValid?t.perform("teleport"):t.perform("cancel"):this._cancelTeleport()&&t.perform("cancel")}_confirmTeleport(){let e=!1;return B.isSessionActive(this._myTeleportParams.myEngine)?r.getGamepads(this._myTeleportParams.myEngine)[this._myTeleportParams.myHandedness].getAxesInfo(oe.THUMBSTICK).getAxes().vec2_length()<=this._myTeleportParams.myStickIdleThreshold&&(e=!0):r.getMouse(this._myTeleportParams.myEngine).isInsideView()&&(e=r.getMouse(this._myTeleportParams.myEngine).isButtonPressEnd(Zi.MIDDLE)),e}_cancelTeleport(){let e=!1;return B.isSessionActive(this._myTeleportParams.myEngine)?e=r.getGamepads(this._myTeleportParams.myEngine)[this._myTeleportParams.myHandedness].getButtonInfo(M.THUMBSTICK).isPressed():e=r.getMouse(this._myTeleportParams.myEngine).isButtonPressEnd(Zi.RIGHT)||!r.getMouse(this._myTeleportParams.myEngine).isInsideView(),e}_detectTeleportPosition(){B.isSessionActive(this._myTeleportParams.myEngine)?(this._detectTeleportRotationVR(),this._detectTeleportPositionVR()):(this._myTeleportRuntimeParams.myTeleportRotationOnUp=0,this._myTeleportRotationOnUpNext=0,this._detectTeleportPositionNonVR())}destroy(){this._myDestroyed=!0,this._myVisualizer.destroy()}isDestroyed(){return this._myDestroyed}};dt.prototype._detectTeleportPositionNonVR=function(){let i=m(),e=m(),t=m();return function(o){this._myDetectionRuntimeParams.myTeleportPositionValid=!1,this._myDetectionRuntimeParams.myTeleportDetectionValid=!0,t=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(t),r.getMouse(this._myTeleportParams.myEngine).getOriginWorld(i),r.getMouse(this._myTeleportParams.myEngine).getDirectionWorld(e),this._detectTeleportPositionParable(i,e,t)}}();dt.prototype._detectTeleportPositionVR=function(){let i=j(),e=j(),t=m(),n=m(),o=m(),s=m();return function(l){if(this._myDetectionRuntimeParams.myTeleportPositionValid=!1,this._myDetectionRuntimeParams.myTeleportDetectionValid=!1,this._myTeleportParams.myDetectionParams.myTeleportParableStartReferenceObject==null){let h=r.getPlayerObjects(this._myTeleportParams.myEngine).myHands[this._myTeleportParams.myHandedness];i.quat2_setPositionRotationDegrees(this._myTeleportParams.myDetectionParams.myTeleportParableStartPositionOffset,this._myTeleportParams.myDetectionParams.myTeleportParableStartRotationOffset),e=h.pp_convertTransformObjectToWorldQuat(i,e)}else this._myTeleportParams.myDetectionParams.myTeleportParableStartReferenceObject.pp_getTransformQuat(e);t=e.quat2_getPosition(t),n=e.quat2_getForward(n),o=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(o),s=o.vec3_negate(s),n.vec3_angle(o)>=this._myTeleportParams.myDetectionParams.myParableForwardMinAngleToBeValidUp&&n.vec3_angle(s)>=this._myTeleportParams.myDetectionParams.myParableForwardMinAngleToBeValidDown&&(this._myDetectionRuntimeParams.myTeleportDetectionValid=!0),this._myDetectionRuntimeParams.myTeleportDetectionValid&&this._detectTeleportPositionParable(t,n,o)}}();dt.prototype._detectTeleportPositionParable=function(){let i=m(),e=m(),t=m(),n=new ct,o=new Le,s=m(),a=m(),l=m(),h=m(),_=m(),y=m(),c=m(),d=new re,g=(P,T)=>P.pp_equals(T);return function(T,C,x){this._myDetectionRuntimeParams.myParable.setStartPosition(T),this._myDetectionRuntimeParams.myParable.setForward(C),this._myDetectionRuntimeParams.myParable.setUp(x);let D=1,E=0,S=0;e=this._myDetectionRuntimeParams.myParable.getPosition(D-1,e),n.myIgnoreHitsInsideCollision=!0,n.myBlockLayerFlags.setMask(this._myTeleportParams.myDetectionParams.myTeleportBlockLayerFlags.getMask()),n.myPhysics=r.getPhysics(this._myTeleportParams.myEngine),n.myObjectsToIgnore.pp_copy(this._myTeleportParams.myCollisionCheckParams.myHorizontalObjectsToIgnore);for(let Q of this._myTeleportParams.myCollisionCheckParams.myVerticalObjectsToIgnore)n.myObjectsToIgnore.pp_pushUnique(Q,g);let b=this._myTeleportParams.myDetectionParams.myMaxDistance*2;do i=this._myDetectionRuntimeParams.myParable.getPosition(D,i),n.myOrigin.vec3_copy(e),n.myDirection=i.vec3_sub(e,n.myDirection),n.myDistance=n.myDirection.vec3_length(),n.myDirection.vec3_normalize(n.myDirection),o=Me.raycast(n,o),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugDetectEnabled&&r.isDebugEnabled(this._myTeleportParams.myEngine)&&r.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,o),e.vec3_copy(i),E=i.vec3_sub(T,i).vec3_removeComponentAlongAxis(x,i).vec3_length(),S=this._myDetectionRuntimeParams.myParable.getDistance(D),D++;while(E<=this._myTeleportParams.myDetectionParams.myMaxDistance&&S<=b&&!o.isColliding());let v=this._myDetectionRuntimeParams.myParable.getDistanceOverFlatDistance(this._myTeleportParams.myDetectionParams.myMaxDistance,b),I=S;(S>v||S>b)&&(I=Math.min(v,b)),this._myDetectionRuntimeParams.myParableDistance=I;let L=!1,F=100;if(o.isColliding()){let Q=o.myHits.pp_first(),Z=S-(n.myDistance-Q.myDistance);if(Z<=I&&(L=!0,this._myDetectionRuntimeParams.myParableDistance=Z,d.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(Q,this._myTeleportRuntimeParams.myTeleportRotationOnUp,d),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(d.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(d.myGroundNormal),s.vec3_copy(Q.myPosition),a.vec3_copy(Q.myNormal),!this._myDetectionRuntimeParams.myTeleportPositionValid&&!this._myTeleportAsMovementFailed&&(l=Q.myPosition.vec3_add(Q.myNormal.vec3_scale(.01,l),l),h=x.vec3_negate(h),n.myOrigin.vec3_copy(l),n.myDirection.vec3_copy(h),n.myDistance=F,o=Me.raycast(n,o),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugDetectEnabled&&r.isDebugEnabled(this._myTeleportParams.myEngine)&&r.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,o),o.isColliding()))){let ne=o.myHits.pp_first();if(d.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(ne,this._myTeleportRuntimeParams.myTeleportRotationOnUp,d),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(d.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(d.myGroundNormal),!this._myDetectionRuntimeParams.myTeleportPositionValid&&!this._myTeleportAsMovementFailed&&d.myTeleportCanceled&&d.myIsCollidingHorizontally&&(_=d.myHorizontalCollisionHit.myNormal.vec3_removeComponentAlongAxis(x,_),!_.vec3_isZero(1e-5))){_.vec3_normalize(_);let Pe=this._myTeleportParams.myCollisionCheckParams.myRadius*1.1;if(n.myOrigin=l.vec3_add(_.vec3_scale(Pe,n.myOrigin),n.myOrigin),n.myDirection.vec3_copy(h),n.myDistance=F,o=Me.raycast(n,o),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugDetectEnabled&&r.isDebugEnabled(this._myTeleportParams.myEngine)&&(r.getDebugVisualManager(this._myTeleportParams.myEngine).drawPoint(0,n.myOrigin,w(0,0,0,1),.03),r.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,o)),o.isColliding()){let Be=o.myHits.pp_first();d.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(Be,this._myTeleportRuntimeParams.myTeleportRotationOnUp,d),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(d.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(d.myGroundNormal)}}if(!this._myDetectionRuntimeParams.myTeleportPositionValid&&!this._myTeleportAsMovementFailed&&(y=a.vec3_removeComponentAlongAxis(x,y),!y.vec3_isZero(1e-5))){y.vec3_normalize(y);let Pe=this._myTeleportParams.myCollisionCheckParams.myRadius*1.1;if(n.myOrigin=l.vec3_add(y.vec3_scale(Pe,n.myOrigin),n.myOrigin),n.myDirection.vec3_copy(h),n.myDistance=F,o=Me.raycast(n,o),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugDetectEnabled&&r.isDebugEnabled(this._myTeleportParams.myEngine)&&(r.getDebugVisualManager(this._myTeleportParams.myEngine).drawPoint(0,n.myOrigin,w(0,0,0,1),.03),r.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,o)),o.isColliding()){let Be=o.myHits.pp_first();d.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(Be,this._myTeleportRuntimeParams.myTeleportRotationOnUp,d),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(d.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(d.myGroundNormal)}}if(!this._myDetectionRuntimeParams.myTeleportPositionValid&&!this._myTeleportAsMovementFailed&&(c=C.vec3_negate(c).vec3_removeComponentAlongAxis(x,c).vec3_normalize(c),!c.vec3_isZero(1e-5))){c.vec3_normalize(c);let Pe=this._myTeleportParams.myCollisionCheckParams.myRadius*1.1;if(n.myOrigin=l.vec3_add(c.vec3_scale(Pe,n.myOrigin),n.myOrigin),n.myDirection.vec3_copy(h),n.myDistance=F,o=Me.raycast(n,o),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugDetectEnabled&&r.isDebugEnabled(this._myTeleportParams.myEngine)&&(r.getDebugVisualManager(this._myTeleportParams.myEngine).drawPoint(0,n.myOrigin,w(0,0,0,1),.03),r.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,o)),o.isColliding()){let Be=o.myHits.pp_first();d.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(Be,this._myTeleportRuntimeParams.myTeleportRotationOnUp,d),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(d.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(d.myGroundNormal)}}}}if(!L&&(t=this._myDetectionRuntimeParams.myParable.getPositionByDistance(this._myDetectionRuntimeParams.myParableDistance,t),l.vec3_copy(t),h=x.vec3_negate(h),n.myOrigin.vec3_copy(l),n.myDirection.vec3_copy(h),n.myDistance=F,o=Me.raycast(n,o),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugDetectEnabled&&r.isDebugEnabled(this._myTeleportParams.myEngine)&&r.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,o),o.isColliding())){let Q=o.myHits.pp_first();if(d.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(Q,this._myTeleportRuntimeParams.myTeleportRotationOnUp,d),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(d.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(d.myGroundNormal),!this._myDetectionRuntimeParams.myTeleportPositionValid&&!this._myTeleportAsMovementFailed&&d.myTeleportCanceled&&d.myIsCollidingHorizontally&&(_=d.myHorizontalCollisionHit.myNormal.vec3_removeComponentAlongAxis(x,_),!_.vec3_isZero(1e-5))){_.vec3_normalize(_);let Z=this._myTeleportParams.myCollisionCheckParams.myRadius*1.1;if(n.myOrigin=l.vec3_add(_.vec3_scale(Z,n.myOrigin),n.myOrigin),n.myDirection.vec3_copy(h),n.myDistance=F,o=Me.raycast(n,o),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugDetectEnabled&&r.isDebugEnabled(this._myTeleportParams.myEngine)&&(r.getDebugVisualManager(this._myTeleportParams.myEngine).drawPoint(0,n.myOrigin,w(0,0,0,1),.03),r.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,o)),o.isColliding()){let ne=o.myHits.pp_first();d.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(ne,this._myTeleportRuntimeParams.myTeleportRotationOnUp,d),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(d.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(d.myGroundNormal)}}if(!this._myDetectionRuntimeParams.myTeleportPositionValid&&!this._myTeleportAsMovementFailed&&(c=C.vec3_negate(c).vec3_removeComponentAlongAxis(x,c).vec3_normalize(c),!c.vec3_isZero(1e-5))){c.vec3_normalize(c);let Z=this._myTeleportParams.myCollisionCheckParams.myRadius*1.1;if(n.myOrigin=l.vec3_add(c.vec3_scale(Z,n.myOrigin),n.myOrigin),n.myDirection.vec3_copy(h),n.myDistance=F,o=Me.raycast(n,o),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugDetectEnabled&&r.isDebugEnabled(this._myTeleportParams.myEngine)&&(r.getDebugVisualManager(this._myTeleportParams.myEngine).drawPoint(0,n.myOrigin,w(0,0,0,1),.03),r.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,o)),o.isColliding()){let ne=o.myHits.pp_first();d.reset(),this._myDetectionRuntimeParams.myTeleportPositionValid=this._isTeleportHitValid(ne,this._myTeleportRuntimeParams.myTeleportRotationOnUp,d),this._myTeleportRuntimeParams.myTeleportPosition.vec3_copy(d.myNewPosition),this._myDetectionRuntimeParams.myTeleportSurfaceNormal.vec3_copy(d.myGroundNormal)}}}}}();dt.prototype._detectTeleportRotationVR=function(){let i=m(),e=m(0,0,1),t=m(0,1,0);return function(o){let s=r.getGamepads(this._myTeleportParams.myEngine)[this._myTeleportParams.myHandedness].getAxesInfo(oe.THUMBSTICK).getAxes();s.vec2_length()>this._myTeleportParams.myDetectionParams.myRotationOnUpMinStickIntensity&&(this._myTeleportRuntimeParams.myTeleportRotationOnUp=this._myTeleportRotationOnUpNext,i.vec3_set(s[0],0,s[1]),this._myTeleportRotationOnUpNext=i.vec3_angleSigned(e,t)),this._myTeleportParams.myDetectionParams.myRotationOnUpEnabled||(this._myTeleportRuntimeParams.myTeleportRotationOnUp=0,this._myTeleportRotationOnUpNext=0)}}();dt.prototype._isTeleportHitValid=function(){let i=new ct,e=new Le,t=m(),n=(o,s)=>o.pp_equals(s);return function(s,a,l){let h=!1;if(this._myTeleportAsMovementFailed=!1,s.isValid()&&!s.myInsideCollision){t=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(t);{i.myIgnoreHitsInsideCollision=!0,i.myBlockLayerFlags.setMask(this._myTeleportParams.myDetectionParams.myTeleportFloorLayerFlags.getMask()),i.myPhysics=r.getPhysics(this._myTeleportParams.myEngine),i.myObjectsToIgnore.pp_copy(this._myTeleportParams.myCollisionCheckParams.myHorizontalObjectsToIgnore);for(let y of this._myTeleportParams.myCollisionCheckParams.myVerticalObjectsToIgnore)i.myObjectsToIgnore.pp_pushUnique(y,n);let _=.01;i.myOrigin=s.myPosition.vec3_add(s.myNormal.vec3_scale(_,i.myOrigin),i.myOrigin),i.myDirection=s.myNormal.vec3_negate(i.myDirection),i.myDistance=_*1.25,i.myDirection.vec3_normalize(i.myDirection),e=Me.raycast(i,e),e.isColliding()&&e.myHits.pp_first().myObject.pp_equals(s.myObject)&&(h=this._isTeleportPositionValid(s.myPosition,a,l))}}return h}}();dt.prototype._isTeleportPositionValid=function(){let i=m(),e=j(),t=z(),n=m(),o=m(),s=new re;return function(l,h,_){let y=!1;if(this._isTeleportPositionVisible(l)&&(i=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(i),e=this._myTeleportParams.myPlayerHeadManager.getTransformFeetQuat(e),n=e.quat2_getPosition(n),h!=0&&(t=e.quat2_getRotationQuat(t),t=t.quat_rotateAxis(h,i,t),e.quat2_setPositionRotationQuat(n,t)),l.vec3_sub(n,o).vec3_componentAlongAxis(i,o).vec3_length()<this._myTeleportParams.myDetectionParams.myMaxHeightDifference+1e-5)){let g=!1;if(s.copy(this._myLocomotionRuntimeParams.myCollisionRuntimeParams),this._myTeleportParams.myPerformTeleportAsMovement?this._checkTeleportAsMovement(l,e,s,_):this._checkTeleport(l,e,s,_),s.myTeleportCanceled||(g=!0),g&&(!this._myTeleportParams.myDetectionParams.myMustBeOnGround||s.myIsOnGround)){let P=!0;s.myNewPosition.vec3_isFartherAlongAxis(n,i)&&(P=s.myGroundAngle<this._myTeleportParams.myDetectionParams.myGroundAngleToIgnoreUpward+1e-4),P&&(y=!0)}}return y}}();import{MeshComponent as YR}from"@wonderlandengine/api";var ya=class extends Ct{constructor(e,t,n){super(e,t,n),this._myBlinkSphere=r.getPlayerObjects(this._myTeleportParams.myEngine).myPlayerCauldron.pp_addObject(),this._myBlinkSphereMeshComponent=this._myBlinkSphere.pp_addComponent(YR),this._myBlinkSphereMeshComponent.mesh=r.getDefaultMeshes(this._myTeleportParams.myEngine).myInvertedSphere,this._myBlinkSphereMeshComponent.material=r.getDefaultMaterials(this._myTeleportParams.myEngine).myFlatTransparentNoDepth.clone(),this._myBlinkSphereMaterialColor=w(this._myTeleportParams.myTeleportParams.myBlinkSphereColor[0]/255,this._myTeleportParams.myTeleportParams.myBlinkSphereColor[1]/255,this._myTeleportParams.myTeleportParams.myBlinkSphereColor[2]/255,0),this._myBlinkSphereMeshComponent.material.color=this._myBlinkSphereMaterialColor,this._myBlinkSphere.pp_resetTransformLocal(),this._myBlinkSphere.pp_setScaleLocal(this._myTeleportParams.myTeleportParams.myBlinkSphereScale),this._myBlinkSphere.pp_setActive(!1),this._myFSM=new ze,this._myFSM.addState("init"),this._myFSM.addState("idle"),this._myFSM.addState("fade_out",this._fadeOutUpdate.bind(this)),this._myFSM.addState("wait",new Ns(this._myTeleportParams.myTeleportParams.myBlinkWaitSeconds,"done")),this._myFSM.addState("fade_in",this._fadeInUpdate.bind(this)),this._myFSM.addTransition("init","idle","start"),this._myFSM.addTransition("idle","fade_out","teleport",this._startFadeOut.bind(this)),this._myFSM.addTransition("fade_out","wait","done",this._teleport.bind(this)),this._myFSM.addTransition("wait","fade_in","done",this._startFadeIn.bind(this)),this._myFSM.addTransition("fade_in","idle","done",this._teleportDone.bind(this)),this._myFSM.addTransition("idle","idle","stop"),this._myFSM.addTransition("fade_out","idle","stop",this._stop.bind(this,!0)),this._myFSM.addTransition("wait","idle","stop",this._stop.bind(this,!1)),this._myFSM.addTransition("fade_in","idle","stop",this._stop.bind(this,!1)),this._myFSM.init("init"),this._myFSM.perform("start"),this._myFadeInTimer=new ie(this._myTeleportParams.myTeleportParams.myBlinkFadeInSeconds),this._myFadeOutTimer=new ie(this._myTeleportParams.myTeleportParams.myBlinkFadeOutSeconds),this._myFadeOutAlphaOverTime=new Oi(0,1,0,1),this._myFadeInAlphaOverTime=new Oi(1,0,0,1)}start(e){this._myParentFSM=e,this._myFSM.perform("teleport")}end(){this._myBlinkSphere.pp_setActive(!1),this._myBlinkSphere.pp_setParent(r.getPlayerObjects(this._myTeleportParams.myEngine).myPlayerCauldron,!1),this._myFSM.perform("stop")}update(e,t){this._myBlinkSphere.pp_setParent(this._myTeleportParams.myPlayerHeadManager.getHead(),!1),this._myBlinkSphere.pp_resetTransformLocal(),this._myFSM.update(e)}_startFadeOut(){this._myFadeOutTimer.start(),this._myBlinkSphereMaterialColor[3]=0,this._myBlinkSphereMeshComponent.material.color=this._myBlinkSphereMaterialColor,this._myBlinkSphere.pp_setActive(!0)}_startFadeIn(){this._myFadeInTimer.start()}_fadeOutUpdate(e,t){this._myFadeOutTimer.update(e);let n=this._myFadeOutAlphaOverTime.get(this._myFadeOutTimer.getPercentage());this._myBlinkSphereMaterialColor[3]=n,this._myBlinkSphereMeshComponent.material.color=this._myBlinkSphereMaterialColor,this._myFadeOutTimer.isDone()&&t.perform("done")}_fadeInUpdate(e,t){this._myFadeInTimer.update(e);let n=this._myFadeInAlphaOverTime.get(this._myFadeInTimer.getPercentage());this._myBlinkSphereMaterialColor[3]=n,this._myBlinkSphereMeshComponent.material.color=this._myBlinkSphereMaterialColor,this._myFadeInTimer.isDone()&&t.perform("done")}_teleportDone(){this._myBlinkSphere.pp_setActive(!1),this._myParentFSM.performDelayed("done")}_stop(e){this._myBlinkSphere.pp_setActive(!1),e&&this._teleport()}_teleport(){this._myLocomotionRuntimeParams.myTeleportJustPerformed=!0,this._teleportToPosition(this._myTeleportRuntimeParams.myTeleportPosition,this._myTeleportRuntimeParams.myTeleportRotationOnUp,this._myLocomotionRuntimeParams.myCollisionRuntimeParams)}};var To=class extends Ct{constructor(e,t,n){super(e,t,n),this._myFSM=new ze,this._myFSM.addState("init"),this._myFSM.addState("idle"),this._myFSM.addState("shifting",this._shiftingUpdate.bind(this)),this._myFSM.addTransition("init","idle","start"),this._myFSM.addTransition("idle","shifting","teleport",this._startShifting.bind(this)),this._myFSM.addTransition("shifting","idle","done",this._teleportDone.bind(this)),this._myFSM.addTransition("idle","idle","stop"),this._myFSM.addTransition("shifting","idle","stop",this._stop.bind(this)),this._myFSM.init("init"),this._myFSM.perform("start"),this._myShiftMovementTimer=new ie(this._myTeleportParams.myTeleportParams.myShiftMovementSeconds),this._myShiftRotateTimer=new ie(this._myTeleportParams.myTeleportParams.myShiftRotateSeconds,!1),this._myFeetStartPosition=m(),this._myCurrentRotationOnUp=0,this._myStartRotationOnUp=0}start(e){this._myParentFSM=e,this._myFSM.perform("teleport")}end(){this._myFSM.perform("stop")}update(e,t){this._myFSM.update(e)}_startShifting(){if(this._myTeleportParams.myPlayerTransformManager.getParams().mySyncPositionDisabled=!0,this._myLocomotionRuntimeParams.myIsTeleporting=!0,this._myFeetStartPosition=this._myTeleportParams.myPlayerHeadManager.getPositionFeet(this._myFeetStartPosition),this._myShiftMovementTimer.start(this._myTeleportParams.myTeleportParams.myShiftMovementSeconds),this._myTeleportParams.myTeleportParams.myShiftMovementSecondsMultiplierOverDistanceFunction){let e=this._myTeleportRuntimeParams.myTeleportPosition.vec3_distance(this._myFeetStartPosition),t=this._myTeleportParams.myTeleportParams.myShiftMovementSecondsMultiplierOverDistanceFunction(e);this._myShiftMovementTimer.start(this._myTeleportParams.myTeleportParams.myShiftMovementSeconds*t)}if(this._myShiftRotateTimer.reset(this._myTeleportParams.myTeleportParams.myShiftRotateSeconds),this._myTeleportParams.myTeleportParams.myShiftRotateSecondsMultiplierOverAngleFunction){let e=this._myTeleportParams.myTeleportParams.myShiftRotateSecondsMultiplierOverAngleFunction(Math.abs(this._myTeleportRuntimeParams.myTeleportRotationOnUp));this._myShiftRotateTimer.reset(this._myTeleportParams.myTeleportParams.myShiftRotateSeconds*e)}this._myStartRotationOnUp=this._myTeleportRuntimeParams.myTeleportRotationOnUp,this._myCurrentRotationOnUp=0}_stop(){this._teleport()}_teleportDone(){this._teleport(),this._myParentFSM.performDelayed("done")}_teleport(){this._myTeleportParams.myPlayerTransformManager.getParams().mySyncPositionDisabled=!1,this._myLocomotionRuntimeParams.myTeleportJustPerformed=!0,this._teleportToPosition(this._myTeleportRuntimeParams.myTeleportPosition,this._myStartRotationOnUp-this._myCurrentRotationOnUp,this._myLocomotionRuntimeParams.myCollisionRuntimeParams)}};To.prototype._shiftingUpdate=function(){let i=m(),e=m();return function(n,o){if(this._myShiftMovementTimer.update(n),this._myShiftRotateTimer.update(n),this._myShiftRotateTimer.isDone()&&this._myShiftMovementTimer.isDone())o.perform("done");else{if(e.vec3_copy(this._myTeleportRuntimeParams.myTeleportPosition),this._myShiftMovementTimer.isStarted()||this._myShiftMovementTimer.isJustDone()){let a=this._myTeleportParams.myTeleportParams.myShiftMovementEasingFunction(this._myShiftMovementTimer.getPercentage());a>=this._myTeleportParams.myTeleportParams.myShiftRotateStartAfterMovementPercentage&&!this._myShiftRotateTimer.isStarted()&&(this._myShiftRotateTimer.start(),this._myShiftRotateTimer.update(n)),i=this._myTeleportRuntimeParams.myTeleportPosition.vec3_sub(this._myFeetStartPosition,i),i.vec3_scale(a,i),e=this._myFeetStartPosition.vec3_add(i,e)}let s=0;if(this._myShiftRotateTimer.isRunning()||this._myShiftRotateTimer.isJustDone()){let a=this._myTeleportParams.myTeleportParams.myShiftRotateEasingFunction(this._myShiftRotateTimer.getPercentage()),l=this._myStartRotationOnUp*a;s=l-this._myCurrentRotationOnUp,this._myCurrentRotationOnUp=l}this._teleportToPosition(e,s,this._myLocomotionRuntimeParams.myCollisionRuntimeParams,!0)}}}();Object.defineProperty(To.prototype,"_shiftingUpdate",{enumerable:!1});var ua={INSTANT:0,BLINK:1,SHIFT:2},ha=class{constructor(){this.myTeleportType=ua.SHIFT,this.myBlinkFadeOutSeconds=.1,this.myBlinkFadeInSeconds=.1,this.myBlinkWaitSeconds=.1,this.myBlinkSphereColor=m(),this.myBlinkSphereScale=.1,this.myShiftMovementSeconds=.15,this.myShiftMovementSecondsMultiplierOverDistanceFunction=null,this.myShiftMovementEasingFunction=ue.easeInOut,this.myShiftRotateSeconds=1,this.myShiftRotateSecondsMultiplierOverAngleFunction=null,this.myShiftRotateEasingFunction=ue.easeOut,this.myShiftRotateStartAfterMovementPercentage=.7,this.myShiftRotateSecondsMultiplierOverAngleFunction=function(e){return ue.easeOut(e/180)}}},ca=class extends Ct{constructor(e,t,n){super(e,t,n),this._myFSM=new ze,this._myFSM.addState("init"),this._myFSM.addState("idle"),this._myBlinkState=new ya(e,t,n),this._myShiftState=new To(e,t,n),this._myFSM.addState("instant_teleport",this._instantUpdate.bind(this)),this._myFSM.addState("blink_teleport",this._myBlinkState),this._myFSM.addState("shift_teleport",this._myShiftState),this._myFSM.addTransition("init","idle","start"),this._myFSM.addTransition("idle","instant_teleport","start_instant"),this._myFSM.addTransition("idle","blink_teleport","start_blink"),this._myFSM.addTransition("idle","shift_teleport","start_shift"),this._myFSM.addTransition("instant_teleport","idle","done",this._teleportDone.bind(this)),this._myFSM.addTransition("blink_teleport","idle","done",this._teleportDone.bind(this)),this._myFSM.addTransition("shift_teleport","idle","done",this._teleportDone.bind(this)),this._myFSM.addTransition("idle","idle","stop"),this._myFSM.addTransition("instant_teleport","idle","stop",this._instantStop.bind(this)),this._myFSM.addTransition("blink_teleport","idle","stop"),this._myFSM.addTransition("shift_teleport","idle","stop"),this._myFSM.init("init"),this._myFSM.perform("start")}start(e){switch(this._myParentFSM=e,this._myTeleportParams.myTeleportParams.myTeleportType){case ua.INSTANT:this._myFSM.perform("start_instant");break;case ua.BLINK:this._myFSM.perform("start_blink");break;case ua.SHIFT:this._myFSM.perform("start_shift");break;default:this._myFSM.perform("start_instant")}}end(){}update(e,t){this._myFSM.update(e)}completeTeleport(){this._myFSM.perform("stop"),this._teleportToPosition(this._myTeleportRuntimeParams.myTeleportPosition,this._myTeleportRuntimeParams.myTeleportRotationOnUp,this._myLocomotionRuntimeParams.myCollisionRuntimeParams)}_instantUpdate(e,t){this._teleportToPosition(this._myTeleportRuntimeParams.myTeleportPosition,this._myTeleportRuntimeParams.myTeleportRotationOnUp,this._myLocomotionRuntimeParams.myCollisionRuntimeParams),this._myLocomotionRuntimeParams.myTeleportJustPerformed=!0,t.perform("done")}_instantStop(e){this._instantUpdate(0,e)}_teleportDone(){this._myTeleportParams.myPlayerTransformManager.resetReal(!0,!1,!1),this._myTeleportParams.myPlayerTransformManager.resetHeadToReal(),this._myParentFSM.performDelayed("done")}};var bo=class{constructor(e=r.getMainEngine()){this.myPlayerHeadManager=null,this.myCollisionCheckParams=null,this.myDetectionParams=new ma,this.myVisualizerParams=new la,this.myTeleportParams=new ha,this.myHandedness=A.LEFT,this.myPerformTeleportAsMovement=!1,this.myTeleportAsMovementMaxDistanceFromTeleportPosition=.001,this.myTeleportAsMovementMaxSteps=2,this.myTeleportAsMovementRemoveVerticalMovement=!0,this.myTeleportAsMovementExtraVerticalMovementPerMeter=1,this.myStickIdleThreshold=.1,this.myAdjustPositionEveryFrame=!1,this.myGravityAcceleration=0,this.myEngine=e,this.myDebugEnabled=!1,this.myDebugDetectEnabled=!1,this.myDebugShowEnabled=!1,this.myDebugVisibilityEnabled=!1}},qr=class{constructor(){this.myTeleportPosition=m(),this.myTeleportRotationOnUp=0}},on=class extends Hi{constructor(e,t){super(t),this._myTeleportParams=e,this._myTeleportRuntimeParams=new qr,this._myStickIdleCharge=!0,this._myGravitySpeed=0,this._myDetectionState=new dt(this._myTeleportParams,this._myTeleportRuntimeParams,this._myLocomotionRuntimeParams),this._myTeleportState=new ca(this._myTeleportParams,this._myTeleportRuntimeParams,this._myLocomotionRuntimeParams),this._myFSM=new ze,this._myFSM.addState("init"),this._myFSM.addState("idle",this._idleUpdate.bind(this)),this._myFSM.addState("detect",this._myDetectionState),this._myFSM.addState("teleport",this._myTeleportState),this._myFSM.addTransition("init","idle","start"),this._myFSM.addTransition("idle","detect","detect"),this._myFSM.addTransition("detect","teleport","teleport"),this._myFSM.addTransition("detect","idle","cancel"),this._myFSM.addTransition("teleport","idle","done"),this._myFSM.addTransition("idle","idle","stop"),this._myFSM.addTransition("detect","idle","stop"),this._myFSM.addTransition("teleport","idle","stop",this._completeTeleport.bind(this)),this._myFSM.init("init"),this._myFSM.perform("start"),this._myDestroyed=!1}start(){this._myGravitySpeed=0}stop(){this._myFSM.perform("stop")}canStop(){return this._myFSM.isInState("idle")}update(e){this._myLocomotionRuntimeParams.myTeleportJustPerformed=!1,this._myFSM.update(e),(this._myTeleportParams.myAdjustPositionEveryFrame||this._myTeleportParams.myGravityAcceleration!=0)&&this._applyGravity(e),this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnGround&&(this._myLocomotionRuntimeParams.myIsFlying=!1)}_idleUpdate(e){this._startDetecting()&&this._myFSM.perform("detect")}_startDetecting(){let e=!1;if(!B.isSessionActive(this._myTeleportParams.myEngine))e=r.getMouse(this._myTeleportParams.myEngine).isButtonPressStart(Zi.MIDDLE)&&r.getMouse(this._myTeleportParams.myEngine).isTargetingRenderCanvas();else{let t=r.getGamepads(this._myTeleportParams.myEngine)[this._myTeleportParams.myHandedness].getAxesInfo(oe.THUMBSTICK).getAxes();t.vec2_length()<=this._myTeleportParams.myStickIdleThreshold&&(this._myStickIdleCharge=!0),this._myStickIdleCharge&&t[1]>=.75&&(this._myStickIdleCharge=!1,e=!0)}return e}_completeTeleport(){this._myTeleportState.completeTeleport()}destroy(){this._myDestroyed=!0,this._myDetectionState.destroy()}isDestroyed(){return this._myDestroyed}};on.prototype._applyGravity=function(){let i=m(),e=m(),t=j();return function(o){i=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(i),this._myGravitySpeed+=this._myTeleportParams.myGravityAcceleration*o,e=i.vec3_scale(this._myGravitySpeed*o,e),this._myLocomotionRuntimeParams.myIsFlying&&e.vec3_zero(),t=this._myTeleportParams.myPlayerHeadManager.getTransformFeetQuat(t),fe(this._myTeleportParams.myEngine).move(e,t,this._myTeleportParams.myCollisionCheckParams,this._myLocomotionRuntimeParams.myCollisionRuntimeParams),this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myVerticalMovementCanceled||this._myTeleportParams.myPlayerHeadManager.teleportPositionFeet(this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myNewPosition),(this._myGravitySpeed>0&&this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnCeiling||this._myGravitySpeed<0&&this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnGround)&&(this._myGravitySpeed=0)}}();var Xr={HEAD:0,HAND:1,CUSTOM_OBJECT:2},pa=class{constructor(e=r.getMainEngine()){this.myDefaultHeight=0,this.myMaxSpeed=0,this.myMaxRotationSpeed=0,this.myCharacterRadius=0,this.myIsSnapTurn=!1,this.mySnapTurnOnlyVR=!1,this.mySnapTurnAngle=0,this.mySnapTurnSpeedDegrees=0,this.myFlyEnabled=!1,this.myStartFlying=!1,this.myMinAngleToFlyUpNonVR=0,this.myMinAngleToFlyDownNonVR=0,this.myMinAngleToFlyUpVR=0,this.myMinAngleToFlyDownVR=0,this.myMinAngleToFlyRight=0,this.myMainHand=A.LEFT,this.myVRDirectionReferenceType=Xr.HEAD,this.myVRDirectionReferenceObject=null,this.myTeleportParableStartReferenceObject=null,this.myForeheadExtraHeight=0,this.myTeleportPositionObject=null,this.myTeleportMaxDistance=0,this.myTeleportMaxHeightDifference=0,this.myColliderAccuracy=null,this.myColliderCheckOnlyFeet=!1,this.myColliderSlideAgainstWall=!1,this.myColliderMaxWalkableGroundAngle=0,this.myColliderSnapOnGround=!1,this.myColliderMaxDistanceToSnapOnGround=0,this.myColliderMaxWalkableGroundStepHeight=0,this.myColliderPreventFallingFromEdges=!1,this.myDebugHorizontalEnabled=!1,this.myDebugVerticalEnabled=!1,this.myMoveThroughCollisionShortcutEnabled=!1,this.myMoveHeadShortcutEnabled=!1,this.myPhysicsBlockLayerFlags=new Re,this.myEngine=e}},da=class{constructor(e){this._myParams=e,this._myCollisionCheckParamsMovement=new Ae,this._setupCollisionCheckParamsMovement(),this._myCollisionCheckParamsTeleport=null,this._setupCollisionCheckParamsTeleport(),this._myCollisionRuntimeParams=new re,this._myMovementRuntimeParams=new go,this._myMovementRuntimeParams.myIsFlying=this._myParams.myStartFlying,this._myMovementRuntimeParams.myCollisionRuntimeParams=this._myCollisionRuntimeParams;{let t=new tn(this._myParams.myEngine);t.mySessionChangeResyncEnabled=!0,t.myBlurEndResyncEnabled=!0,t.myBlurEndResyncRotation=!0,t.myEnterSessionResyncHeight=!1,t.myExitSessionResyncHeight=!1,t.myExitSessionResyncVerticalAngle=!0,t.myExitSessionRemoveRightTilt=!0,t.myExitSessionAdjustMaxVerticalAngle=!0,t.myExitSessionMaxVerticalAngle=90,t.myHeightOffsetVRWithFloor=0,t.myHeightOffsetVRWithoutFloor=this._myParams.myDefaultHeight,t.myHeightOffsetNonVR=this._myParams.myDefaultHeight,t.myForeheadExtraHeight=this._myParams.myForeheadExtraHeight,t.myFeetRotationKeepUp=!0,t.myDebugEnabled=!1,this._myPlayerHeadManager=new se(t)}{let t=new vo(this._myParams.myEngine);t.myPlayerHeadManager=this._myPlayerHeadManager,t.myMovementCollisionCheckParams=this._myCollisionCheckParamsMovement,t.myTeleportCollisionCheckParams=null,t.myTeleportCollisionCheckParamsCopyFromMovement=!0,t.myTeleportCollisionCheckParamsCheck360=!0,t.myHeadCollisionBlockLayerFlags.copy(t.myMovementCollisionCheckParams.myHorizontalBlockLayerFlags),t.myHeadCollisionBlockLayerFlags.add(t.myMovementCollisionCheckParams.myVerticalBlockLayerFlags),t.myHeadCollisionObjectsToIgnore.pp_copy(t.myMovementCollisionCheckParams.myHorizontalObjectsToIgnore);let n=(o,s)=>o.pp_equals(s);for(let o of t.myMovementCollisionCheckParams.myVerticalObjectsToIgnore)t.myHeadCollisionObjectsToIgnore.pp_pushUnique(o,n);t.myCollisionRuntimeParams=this._myCollisionRuntimeParams,t.myHeadRadius=.15,t.myMaxDistanceFromRealToSyncEnabled=!0,t.myMaxDistanceFromRealToSync=100,t.myIsFloatingValidIfVerticalMovement=!1,t.myIsFloatingValidIfVerticalMovementAndRealOnGround=!1,t.myIsFloatingValidIfSteepGround=!1,t.myIsFloatingValidIfVerticalMovementAndSteepGround=!1,t.myIsFloatingValidIfRealOnGround=!1,t.myIsLeaningValidAboveDistance=!0,t.myLeaningValidDistance=2,t.myFloatingSplitCheckEnabled=!0,t.myFloatingSplitCheckMaxLength=.2,t.myFloatingSplitCheckMaxSteps=5,t.myRealMovementAllowVerticalAdjustments=!1,t.myUpdateRealPositionValid=!0,t.myUpdatePositionValid=!0,t.myIsBodyCollidingWhenHeightBelowValue=null,t.myIsBodyCollidingWhenHeightAboveValue=null,t.myResetToValidOnEnterSession=!0,t.myResetToValidOnExitSession=!0,t.myAlwaysResetRealPositionNonVR=!0,t.myAlwaysResetRealRotationNonVR=!0,t.myAlwaysResetRealHeightNonVR=!0,t.myAlwaysResetRealPositionVR=!1,t.myAlwaysResetRealRotationVR=!1,t.myAlwaysResetRealHeightVR=!1,t.myNeverResetRealPositionNonVR=!1,t.myNeverResetRealRotationNonVR=!0,t.myNeverResetRealHeightNonVR=!1,t.myNeverResetRealPositionVR=!1,t.myNeverResetRealRotationVR=!1,t.myNeverResetRealHeightVR=!0,t.myResetRealOnMove=!0,t.myDebugEnabled=!0,this._myPlayerTransformManager=new mt(t)}{let t=new Po(this._myParams.myEngine);t.myPlayerTransformManager=this._myPlayerTransformManager,t.myObscureObject=null,t.myObscureMaterial=null,t.myObscureRadius=.1,t.myObscureFadeOutSeconds=.25,t.myObscureFadeInSeconds=.25,t.myObscureFadeEasingFunction=ue.linear,t.myObscureLevelRelativeDistanceEasingFunction=ue.linear,t.myDistanceToStartObscureWhenBodyColliding=.2,t.myDistanceToStartObscureWhenHeadColliding=0,t.myDistanceToStartObscureWhenFloating=1,t.myDistanceToStartObscureWhenFar=1,t.myRelativeDistanceToMaxObscureWhenBodyColliding=.5,t.myRelativeDistanceToMaxObscureWhenHeadColliding=.1,t.myRelativeDistanceToMaxObscureWhenFloating=5,t.myRelativeDistanceToMaxObscureWhenFar=5,this._myPlayerObscureManager=new Co(t)}{let t=new fo(this._myParams.myEngine);t.myPlayerHeadManager=this._myPlayerHeadManager,t.myPlayerTransformManager=this._myPlayerTransformManager,t.myMaxRotationSpeed=this._myParams.myMaxRotationSpeed,t.myIsSnapTurn=this._myParams.myIsSnapTurn,t.mySnapTurnOnlyVR=this._myParams.mySnapTurnOnlyVR,t.mySnapTurnAngle=this._myParams.mySnapTurnAngle,this._myParams.mySnapTurnSpeedDegrees>Math.PP_EPSILON?(t.mySmoothSnapEnabled=!0,t.mySmoothSnapSpeedDegrees=this._myParams.mySnapTurnSpeedDegrees):t.mySmoothSnapEnabled=!1,t.myRotationMinStickIntensityThreshold=.1,t.mySnapTurnActivateThreshold=.5,t.mySnapTurnResetThreshold=.4,t.myClampVerticalAngle=!0,t.myMaxVerticalAngle=90,this._myPlayerLocomotionRotate=new Wt(t),t.myHandedness=ee.getOppositeHandedness(this._myParams.myMainHand)}{{let t=new So(this._myParams.myEngine);t.myPlayerHeadManager=this._myPlayerHeadManager,t.myPlayerTransformManager=this._myPlayerTransformManager,t.myCollisionCheckParams=this._myCollisionCheckParamsMovement,t.myHandedness=this._myParams.myMainHand,t.myMaxSpeed=this._myParams.myMaxSpeed,t.myMovementMinStickIntensityThreshold=.1,t.myFlyEnabled=this._myParams.myFlyEnabled,t.myMinAngleToFlyUpNonVR=this._myParams.myMinAngleToFlyUpNonVR,t.myMinAngleToFlyDownNonVR=this._myParams.myMinAngleToFlyDownNonVR,t.myMinAngleToFlyUpVR=this._myParams.myMinAngleToFlyUpVR,t.myMinAngleToFlyDownVR=this._myParams.myMinAngleToFlyDownVR,t.myMinAngleToFlyRight=this._myParams.myMinAngleToFlyRight,t.myGravityAcceleration=-20,t.myVRDirectionReferenceType=this._myParams.myVRDirectionReferenceType,t.myVRDirectionReferenceObject=this._myParams.myVRDirectionReferenceObject,t.myMoveThroughCollisionShortcutEnabled=this._myParams.myMoveThroughCollisionShortcutEnabled,t.myMoveHeadShortcutEnabled=this._myParams.myMoveHeadShortcutEnabled,this._myPlayerLocomotionSmooth=new yi(t,this._myMovementRuntimeParams)}{let t=new bo(this._myParams.myEngine);t.myPlayerHeadManager=this._myPlayerHeadManager,t.myPlayerTransformManager=this._myPlayerTransformManager,t.myCollisionCheckParams=this._myCollisionCheckParamsTeleport,t.myHandedness=this._myParams.myMainHand,t.myDetectionParams.myMaxDistance=this._myParams.myTeleportMaxDistance,t.myDetectionParams.myMaxHeightDifference=this._myParams.myTeleportMaxHeightDifference,t.myDetectionParams.myGroundAngleToIgnoreUpward=this._myCollisionCheckParamsMovement.myGroundAngleToIgnore,t.myDetectionParams.myMustBeOnGround=!0,t.myDetectionParams.myTeleportBlockLayerFlags.copy(this._myParams.myPhysicsBlockLayerFlags),t.myDetectionParams.myTeleportFloorLayerFlags.copy(this._myParams.myPhysicsBlockLayerFlags),t.myDetectionParams.myTeleportFeetPositionMustBeVisible=!1,t.myDetectionParams.myTeleportHeadPositionMustBeVisible=!1,t.myDetectionParams.myTeleportHeadOrFeetPositionMustBeVisible=!0,t.myDetectionParams.myTeleportParableStartReferenceObject=this._myParams.myTeleportParableStartReferenceObject,t.myDetectionParams.myVisibilityBlockLayerFlags.copy(this._myParams.myPhysicsBlockLayerFlags),t.myVisualizerParams.myTeleportPositionObject=this._myParams.myTeleportPositionObject,t.myPerformTeleportAsMovement=!1,t.myTeleportAsMovementRemoveVerticalMovement=!0,t.myTeleportAsMovementExtraVerticalMovementPerMeter=-2,t.myGravityAcceleration=0,t.myDebugEnabled=!1,t.myDebugDetectEnabled=!0,t.myDebugShowEnabled=!0,t.myDebugVisibilityEnabled=!1,this._myPlayerLocomotionTeleport=new on(t,this._myMovementRuntimeParams)}}this._setupLocomotionMovementFSM(),this._myIdle=!1,this._myDestroyed=!1}start(){this._fixAlmostUp(),this._myPlayerHeadManager.start(),this._myPlayerTransformManager.start(),this._myPlayerObscureManager.start(),this._myPlayerLocomotionRotate.start(),this._myLocomotionMovementFSM.perform("start")}update(e){this._myPlayerHeadManager.update(e),this._myPlayerTransformManager.update(e),r.getLeftGamepad(this._myParams.myEngine).getButtonInfo(M.THUMBSTICK).isPressEnd(2)&&(this._myLocomotionMovementFSM.isInState("smooth")&&this._myPlayerLocomotionSmooth.canStop()?this._myLocomotionMovementFSM.perform("next"):this._myLocomotionMovementFSM.isInState("teleport")&&this._myPlayerLocomotionTeleport.canStop()&&this._myLocomotionMovementFSM.perform("next")),this._myPlayerHeadManager.isSynced()&&(this._updateCollisionHeight(),this._myIdle||(this._myPlayerLocomotionRotate.update(e),this._myLocomotionMovementFSM.update(e))),r.getLeftGamepad(this._myParams.myEngine).getButtonInfo(M.SELECT).isPressEnd(2)&&(this._myPlayerObscureManager.isFading()?this._myPlayerObscureManager.overrideObscureLevel(this._myPlayerObscureManager.isFadingOut()?Math.pp_random(0,0):Math.pp_random(1,1)):this._myPlayerObscureManager.overrideObscureLevel(this._myPlayerObscureManager.isObscured()?Math.pp_random(0,0):Math.pp_random(1,1)))}setIdle(e){this._myIdle=e,e?this._myLocomotionMovementFSM.perform("idle"):this._myLocomotionMovementFSM.perform("start")}_updateCollisionHeight(){this._myCollisionCheckParamsMovement.myHeight=this._myPlayerHeadManager.getHeightHead(),this._myCollisionCheckParamsMovement.myHeight<=1e-6&&(this._myCollisionCheckParamsMovement.myHeight=0),this._myCollisionCheckParamsTeleport.myHeight=this._myCollisionCheckParamsMovement.myHeight}_setupCollisionCheckParamsMovement(){this._myCollisionCheckParamsMovement.mySplitMovementEnabled=!1,this._myCollisionCheckParamsMovement.mySplitMovementMaxLength=0,this._myCollisionCheckParamsMovement.myRadius=this._myParams.myCharacterRadius,this._myCollisionCheckParamsMovement.myDistanceFromFeetToIgnore=.1,this._myCollisionCheckParamsMovement.myDistanceFromHeadToIgnore=.1,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckEnabled=!0,this._myCollisionCheckParamsMovement.myHorizontalMovementStepEnabled=!1,this._myCollisionCheckParamsMovement.myHorizontalMovementStepMaxLength=0,this._myCollisionCheckParamsMovement.myHorizontalMovementRadialStepAmount=1,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckDiagonalOutward=!0,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckDiagonalInward=!0,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckStraight=!1,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckHorizontalBorder=!1,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckVerticalStraight=!1,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckVerticalDiagonalUpwardOutward=!0,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckVerticalDiagonalUpwardInward=!0,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckVerticalDiagonalDownwardOutward=!1,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckVerticalDiagonalDownwardInward=!1,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckVerticalStraightDiagonalUpward=!1,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckVerticalStraightDiagonalDownward=!1,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalOutward=!1,this._myCollisionCheckParamsMovement.myHorizontalMovementCheckVerticalHorizontalBorderDiagonalInward=!1,this._myCollisionCheckParamsMovement.myHorizontalMovementHorizontalStraightCentralCheckEnabled=!0,this._myCollisionCheckParamsMovement.myHorizontalMovementVerticalStraightDiagonalUpwardCentralCheckEnabled=!0,this._myCollisionCheckParamsMovement.myHorizontalPositionCheckEnabled=!0,this._myCollisionCheckParamsMovement.myHalfConeAngle=60,this._myCollisionCheckParamsMovement.myHalfConeSliceAmount=2,this._myCollisionCheckParamsMovement.myCheckConeBorder=!0,this._myCollisionCheckParamsMovement.myCheckConeRay=!0,this._myCollisionCheckParamsMovement.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision=!1,this._myCollisionCheckParamsMovement.myHorizontalPositionCheckVerticalDirectionType=2,this._myCollisionCheckParamsMovement.myVerticalMovementCheckEnabled=!0,this._myCollisionCheckParamsMovement.myVerticalPositionCheckEnabled=!0,this._myCollisionCheckParamsMovement.myVerticalMovementReduceEnabled=!0,this._myCollisionCheckParamsMovement.myFeetRadius=.1,this._myCollisionCheckParamsMovement.myAdjustVerticalMovementWithGroundAngleDownhill=!0,this._myCollisionCheckParamsMovement.myAdjustVerticalMovementWithGroundAngleUphill=!0,this._myCollisionCheckParamsMovement.myAdjustVerticalMovementWithCeilingAngleUphill=!0,this._myCollisionCheckParamsMovement.myAdjustHorizontalMovementWithGroundAngleDownhill=!1,this._myCollisionCheckParamsMovement.myAdjustHorizontalMovementWithCeilingAngleDownhill=!1,this._myCollisionCheckParamsMovement.myAdjustHorizontalMovementWithGroundAngleDownhillMinAngle=30,this._myCollisionCheckParamsMovement.mySnapOnGroundEnabled=!0,this._myCollisionCheckParamsMovement.mySnapOnGroundExtraDistance=.1,this._myCollisionCheckParamsMovement.mySnapOnCeilingEnabled=!1,this._myCollisionCheckParamsMovement.mySnapOnCeilingExtraDistance=.1,this._myCollisionCheckParamsMovement.myGroundPopOutEnabled=!0,this._myCollisionCheckParamsMovement.myGroundPopOutExtraDistance=.1,this._myCollisionCheckParamsMovement.myCeilingPopOutEnabled=!0,this._myCollisionCheckParamsMovement.myCeilingPopOutExtraDistance=.1,this._myCollisionCheckParamsMovement.myGroundCircumferenceAddCenter=!0,this._myCollisionCheckParamsMovement.myGroundCircumferenceSliceAmount=8,this._myCollisionCheckParamsMovement.myGroundCircumferenceStepAmount=2,this._myCollisionCheckParamsMovement.myGroundCircumferenceRotationPerStep=22.5,this._myCollisionCheckParamsMovement.myVerticalAllowHitInsideCollisionIfOneOk=!0,this._myCollisionCheckParamsMovement.myCheckHeight=!0,this._myCollisionCheckParamsMovement.myCheckHeightVerticalMovement=!0,this._myCollisionCheckParamsMovement.myCheckHeightVerticalPosition=!0,this._myCollisionCheckParamsMovement.myCheckHeightTopMovement=!0,this._myCollisionCheckParamsMovement.myCheckHeightTopPosition=!0,this._myCollisionCheckParamsMovement.myCheckHeightConeOnCollision=!0,this._myCollisionCheckParamsMovement.myCheckHeightConeOnCollisionKeepHit=!1,this._myCollisionCheckParamsMovement.myHeightCheckStepAmountMovement=2,this._myCollisionCheckParamsMovement.myHeightCheckStepAmountPosition=2,this._myCollisionCheckParamsMovement.myCheckVerticalFixedForwardEnabled=!0,this._myCollisionCheckParamsMovement.myCheckVerticalFixedForward=vec3_create(0,0,1),this._myCollisionCheckParamsMovement.myCheckVerticalBothDirection=!0,this._myCollisionCheckParamsMovement.myCheckVerticalStraight=!0,this._myCollisionCheckParamsMovement.myCheckVerticalDiagonalRayOutward=!1,this._myCollisionCheckParamsMovement.myCheckVerticalDiagonalRayInward=!1,this._myCollisionCheckParamsMovement.myCheckVerticalDiagonalBorderOutward=!1,this._myCollisionCheckParamsMovement.myCheckVerticalDiagonalBorderInward=!1,this._myCollisionCheckParamsMovement.myCheckVerticalDiagonalBorderRayOutward=!1,this._myCollisionCheckParamsMovement.myCheckVerticalDiagonalBorderRayInward=!1,this._myCollisionCheckParamsMovement.myCheckVerticalSearchFartherVerticalHit=!1,this._myCollisionCheckParamsMovement.myGroundAngleToIgnore=30,this._myCollisionCheckParamsMovement.myCeilingAngleToIgnore=30,this._myCollisionCheckParamsMovement.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft=.1,this._myCollisionCheckParamsMovement.myHorizontalMovementGroundAngleIgnoreMaxMovementLeft=.1,this._myCollisionCheckParamsMovement.myHeight=1,this._myCollisionCheckParamsMovement.myComputeGroundInfoEnabled=!0,this._myCollisionCheckParamsMovement.myComputeCeilingInfoEnabled=!0,this._myCollisionCheckParamsMovement.myDistanceToBeOnGround=.001,this._myCollisionCheckParamsMovement.myDistanceToComputeGroundInfo=.1,this._myCollisionCheckParamsMovement.myDistanceToBeOnCeiling=.001,this._myCollisionCheckParamsMovement.myDistanceToComputeCeilingInfo=.1,this._myCollisionCheckParamsMovement.myVerticalFixToBeOnGround=0,this._myCollisionCheckParamsMovement.myVerticalFixToComputeGroundInfo=0,this._myCollisionCheckParamsMovement.myVerticalFixToBeOnCeiling=0,this._myCollisionCheckParamsMovement.myVerticalFixToComputeCeilingInfo=0,this._myCollisionCheckParamsMovement.myMustStayOnGround=!1,this._myCollisionCheckParamsMovement.myMustStayOnCeiling=!1,this._myCollisionCheckParamsMovement.myRegatherGroundInfoOnSurfaceCheckFail=!0,this._myCollisionCheckParamsMovement.myRegatherCeilingInfoOnSurfaceCheckFail=!0,this._myCollisionCheckParamsMovement.mySlidingEnabled=!0,this._myCollisionCheckParamsMovement.mySlidingHorizontalMovementCheckBetterNormal=!0,this._myCollisionCheckParamsMovement.mySlidingMaxAttempts=4,this._myCollisionCheckParamsMovement.mySlidingCheckBothDirections=!0,this._myCollisionCheckParamsMovement.mySlidingFlickeringPreventionType=1,this._myCollisionCheckParamsMovement.mySlidingFlickeringPreventionCheckOnlyIfAlreadySliding=!0,this._myCollisionCheckParamsMovement.mySlidingFlickerPreventionCheckAnywayCounter=4,this._myCollisionCheckParamsMovement.mySlidingAdjustSign90Degrees=!0,this._myCollisionCheckParamsMovement.myHorizontalBlockLayerFlags.copy(this._myParams.myPhysicsBlockLayerFlags);let e=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getComponents($R);for(let t of e)this._myCollisionCheckParamsMovement.myHorizontalObjectsToIgnore.pp_pushUnique(t.object,(n,o)=>n.pp_equals(o));this._myCollisionCheckParamsMovement.myVerticalBlockLayerFlags.copy(this._myCollisionCheckParamsMovement.myHorizontalBlockLayerFlags),this._myCollisionCheckParamsMovement.myVerticalObjectsToIgnore.pp_copy(this._myCollisionCheckParamsMovement.myHorizontalObjectsToIgnore),this._myCollisionCheckParamsMovement.myDebugEnabled=!1,this._myCollisionCheckParamsMovement.myDebugHorizontalMovementEnabled=!1,this._myCollisionCheckParamsMovement.myDebugHorizontalPositionEnabled=!0,this._myCollisionCheckParamsMovement.myDebugVerticalMovementEnabled=!1,this._myCollisionCheckParamsMovement.myDebugVerticalPositionEnabled=!1,this._myCollisionCheckParamsMovement.myDebugSlidingEnabled=!1,this._myCollisionCheckParamsMovement.myDebugGroundInfoEnabled=!1,this._myCollisionCheckParamsMovement.myDebugCeilingInfoEnabled=!1,this._myCollisionCheckParamsMovement.myDebugRuntimeParamsEnabled=!1,this._myCollisionCheckParamsMovement.myDebugMovementEnabled=!1}_setupCollisionCheckParamsTeleport(){this._myCollisionCheckParamsTeleport=Bi.generate360TeleportParamsFromMovementParams(this._myCollisionCheckParamsMovement),this._myCollisionCheckParamsTeleport.myGroundAngleToIgnore=60,this._myCollisionCheckParamsTeleport.myTeleportMustBeOnIgnorableGroundAngle=!0,this._myCollisionCheckParamsTeleport.myTeleportMustBeOnGround=!0}_fixAlmostUp(){let e=vec3_create(0,1,0);if(r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp().vec3_angle(e)<1){let o=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getForward().vec3_clone();o[1]=0;let a=vec3_create(0,0,1).vec3_angleSigned(o,e);r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_resetRotation(),r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_rotateAxis(a,e)}}_setupLocomotionMovementFSM(){this._myLocomotionMovementFSM=new ze,this._myLocomotionMovementFSM.addState("init"),this._myLocomotionMovementFSM.addState("smooth",e=>this._myPlayerLocomotionSmooth.update(e)),this._myLocomotionMovementFSM.addState("teleport",e=>this._myPlayerLocomotionTeleport.update(e)),this._myLocomotionMovementFSM.addState("idleSmooth"),this._myLocomotionMovementFSM.addState("idleTeleport"),this._myLocomotionMovementFSM.addTransition("init","smooth","start",function(){this._myPlayerLocomotionSmooth.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("smooth","teleport","next",function(){this._myPlayerLocomotionSmooth.stop(),this._myPlayerLocomotionTeleport.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("teleport","smooth","next",function(){this._myPlayerLocomotionTeleport.stop(),this._myPlayerLocomotionSmooth.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("smooth","idleSmooth","idle",function(){this._myPlayerLocomotionSmooth.stop()}.bind(this)),this._myLocomotionMovementFSM.addTransition("teleport","idleTeleport","idle",function(){this._myPlayerLocomotionTeleport.stop()}.bind(this)),this._myLocomotionMovementFSM.addTransition("idleSmooth","smooth","start",function(){this._myPlayerLocomotionSmooth.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("idleTeleport","teleport","start",function(){this._myPlayerLocomotionTeleport.start()}.bind(this)),this._myLocomotionMovementFSM.init("init")}destroy(){this._myDestroyed=!0,this._myPlayerHeadManager.destroy(),this._myPlayerLocomotionSmooth.destroy(),this._myPlayerTransformManager.destroy(),this._myPlayerObscureManager.destroy(),this._myPlayerLocomotionTeleport.destroy()}isDestroyed(){return this._myDestroyed}};var So=class{constructor(e=r.getMainEngine()){this.myPlayerHeadManager=null,this.myPlayerTransformManager=null,this.myCollisionCheckParams=null,this.myMaxSpeed=0,this.myMovementMinStickIntensityThreshold=0,this.myFlyEnabled=!1,this.myMinAngleToFlyUpNonVR=0,this.myMinAngleToFlyDownNonVR=0,this.myMinAngleToFlyUpVR=0,this.myMinAngleToFlyDownVR=0,this.myMinAngleToFlyRight=0,this.myGravityAcceleration=0,this.myVRDirectionReferenceType=Xr.HEAD,this.myVRDirectionReferenceObject=null,this.myHandedness=A.LEFT,this.myMoveThroughCollisionShortcutEnabled=!1,this.myMoveHeadShortcutEnabled=!1,this.myTripleSpeedShortcutEnabled=!1,this.myEngine=e}},yi=class extends Hi{constructor(e,t){super(t),this._myParams=e,this._myDirectionReference=r.getPlayerObjects(this._myParams.myEngine).myHead,this._myStickIdleTimer=new ie(.25,!1);let n=new li;n.myAutoUpdateFlyForward=this._myParams.myFlyEnabled,n.myAutoUpdateFlyRight=this._myParams.myFlyEnabled,n.myMinAngleToFlyForwardUp=this._myParams.myMinAngleToFlyUpNonVR,n.myMinAngleToFlyForwardDown=this._myParams.myMinAngleToFlyDownNonVR,n.myMinAngleToFlyRightUp=this._myParams.myMinAngleToFlyRight,n.myMinAngleToFlyRightDown=this._myParams.myMinAngleToFlyRight;let o=new li;o.myAutoUpdateFlyForward=this._myParams.myFlyEnabled,o.myAutoUpdateFlyRight=this._myParams.myFlyEnabled,o.myMinAngleToFlyForwardUp=this._myParams.myMinAngleToFlyUpVR,o.myMinAngleToFlyForwardDown=this._myParams.myMinAngleToFlyDownVR,o.myMinAngleToFlyRightUp=this._myParams.myMinAngleToFlyRight,o.myMinAngleToFlyRightDown=this._myParams.myMinAngleToFlyRight,this._myDirectionConverterNonVR=new Mt(n),this._myDirectionConverterVR=new Mt(o),this._myCurrentDirectionConverter=this._myDirectionConverterNonVR,this._myDestroyed=!1,B.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this._myParams.myEngine)}update(e){}destroy(){this._myDestroyed=!0,B.unregisterSessionStartEndEventListeners(this,this._myParams.myEngine)}isDestroyed(){return this._myDestroyed}};yi.prototype.update=function(){let i=m(),e=m(),t=m(),n=m(),o=m(),s=j(),a=j();return function(h){i=this._myParams.myPlayerHeadManager.getPlayer().pp_getUp(i),e.vec3_zero();let _=r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getAxesInfo(oe.THUMBSTICK).getAxes();if(_[0]=Math.abs(_[0])>this._myParams.myMovementMinStickIntensityThreshold?_[0]:0,_[1]=Math.abs(_[1])>this._myParams.myMovementMinStickIntensityThreshold?_[1]:0,_.vec2_isZero())this._myStickIdleTimer.isRunning()&&(this._myStickIdleTimer.update(h),this._myStickIdleTimer.isDone()&&this._myCurrentDirectionConverter.resetFly());else if(this._myStickIdleTimer.start(),t=this._myCurrentDirectionConverter.convertTransformQuat(_,this._myDirectionReference.pp_getTransformQuat(a),i,t),!t.vec3_isZero()){this._myLocomotionRuntimeParams.myIsFlying=this._myLocomotionRuntimeParams.myIsFlying||t.vec3_componentAlongAxis(i,n).vec3_length()>1e-6,this._myLocomotionRuntimeParams.myIsFlying||(t=t.vec3_removeComponentAlongAxis(i,t));let y=_.vec2_length();r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(M.SELECT).isPressed()&&(y=.1);let c=Math.pp_lerp(0,this._myParams.myMaxSpeed,y);this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsSliding&&(c=c/2),e=t.vec3_scale(c*h,e)}if(r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(M.SQUEEZE).isPressed()||(r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(M.TOP_BUTTON).isPressed()?(o=i.vec3_scale(this._myParams.myMaxSpeed*h,o),e=e.vec3_add(o,e),this._myLocomotionRuntimeParams.myIsFlying=!0):r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(M.BOTTOM_BUTTON).isPressed()&&(o=i.vec3_scale(-this._myParams.myMaxSpeed*h,o),e=e.vec3_add(o,e),this._myLocomotionRuntimeParams.myIsFlying=!0)),r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(M.BOTTOM_BUTTON).isPressEnd(2)&&(this._myLocomotionRuntimeParams.myIsFlying=!1),r.getGamepads(this._myParams.myEngine)[ee.getOppositeHandedness(this._myParams.myHandedness)].getButtonInfo(M.BOTTOM_BUTTON).isPressed())r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(M.THUMBSTICK).isPressed()||(this._myLocomotionRuntimeParams.myIsFlying,r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(M.SQUEEZE).isPressed()&&e.vec3_zero(),s=this._myParams.myPlayerHeadManager.getTransformFeetQuat(s),fe(this._myParams.myEngine).move(e,s,this._myParams.myCollisionCheckParams,this._myLocomotionRuntimeParams.myCollisionRuntimeParams),e.vec3_copy(this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myFixedMovement)),e.vec3_isZero(1e-6)||this._myParams.myPlayerHeadManager.moveFeet(e);else if(r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(M.THUMBSTICK).isPressed())this._myParams.myPlayerTransformManager.move(e,this._myLocomotionRuntimeParams.myCollisionRuntimeParams,!0);else{if(!this._myLocomotionRuntimeParams.myIsFlying){let y=-2;o=i.vec3_scale(y*h,o),e=e.vec3_add(o,e)}r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(M.SQUEEZE).isPressed()&&e.vec3_zero(),s=this._myParams.myPlayerTransformManager.getTransformQuat(s),this._myParams.myPlayerTransformManager.move(e,this._myLocomotionRuntimeParams.myCollisionRuntimeParams)}this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnGround&&(this._myLocomotionRuntimeParams.myIsFlying=!1,this._myCurrentDirectionConverter.resetFly())}}();yi.prototype._onXRSessionStart=function(){return function(e){switch(this._myParams.myVRDirectionReferenceType){case 0:this._myDirectionReference=r.getPlayerObjects(this._myParams.myEngine).myHead;break;case 1:this._myDirectionReference=r.getPlayerObjects(this._myParams.myEngine).myHands[this._myParams.myHandedness];break;case 2:this._myDirectionReference=this._myParams.myVRDirectionReferenceObject;break}this._myCurrentDirectionConverter=this._myDirectionConverterVR,this._myCurrentDirectionConverter.resetFly()}}();yi.prototype._onXRSessionEnd=function(){let i=m();return function(t){this._myDirectionReference=r.getPlayerObjects(this._myParams.myEngine).myHead,this._myCurrentDirectionConverter=this._myDirectionConverterNonVR,this._myCurrentDirectionConverter.resetFly()}}();Object.defineProperty(yi.prototype,"_onXRSessionStart",{enumerable:!1});Object.defineProperty(yi.prototype,"_onXRSessionEnd",{enumerable:!1});var ui=class extends Hi{constructor(e,t){super(t),this._myParams=e,this._myDirectionReference=r.getPlayerObjects(this._myParams.myEngine).myHead,this._myStickIdleTimer=new ie(.25,!1);let n=new li(this._myParams.myEngine);n.myAutoUpdateFlyForward=this._myParams.myFlyEnabled,n.myAutoUpdateFlyRight=this._myParams.myFlyEnabled,n.myMinAngleToFlyForwardUp=this._myParams.myMinAngleToFlyUpNonVR,n.myMinAngleToFlyForwardDown=this._myParams.myMinAngleToFlyDownNonVR,n.myMinAngleToFlyRightUp=this._myParams.myMinAngleToFlyRight,n.myMinAngleToFlyRightDown=this._myParams.myMinAngleToFlyRight;let o=new li(this._myParams.myEngine);o.myAutoUpdateFlyForward=this._myParams.myFlyEnabled,o.myAutoUpdateFlyRight=this._myParams.myFlyEnabled,o.myMinAngleToFlyForwardUp=this._myParams.myMinAngleToFlyUpVR,o.myMinAngleToFlyForwardDown=this._myParams.myMinAngleToFlyDownVR,o.myMinAngleToFlyRightUp=this._myParams.myMinAngleToFlyRight,o.myMinAngleToFlyRightDown=this._myParams.myMinAngleToFlyRight,this._myDirectionConverterNonVR=new Mt(n),this._myDirectionConverterVR=new Mt(o),this._myCurrentDirectionConverter=this._myDirectionConverterNonVR,this._myGravitySpeed=0,this._myDestroyed=!1,B.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this._myParams.myEngine)}update(e){}destroy(){this._myDestroyed=!0,B.unregisterSessionStartEndEventListeners(this,this._myParams.myEngine)}isDestroyed(){return this._myDestroyed}};ui.prototype.update=function(){let i=m(),e=m(),t=m(),n=m(),o=m(),s=j(),a=j();return function(h){i=this._myParams.myPlayerHeadManager.getPlayer().pp_getUp(i),e.vec3_zero();let _=r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getAxesInfo(oe.THUMBSTICK).getAxes();_[0]=Math.abs(_[0])>this._myParams.myMovementMinStickIntensityThreshold?_[0]:0,_[1]=Math.abs(_[1])>this._myParams.myMovementMinStickIntensityThreshold?_[1]:0;let y=!1,c=this._myParams.myMaxSpeed;if(this._myParams.myTripleSpeedShortcutEnabled&&r.isDebugEnabled(this._myParams.myEngine)&&r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(M.SQUEEZE).isPressed()&&(c*=3),_.vec2_isZero())this._myStickIdleTimer.isRunning()&&(this._myStickIdleTimer.update(h),this._myStickIdleTimer.isDone()&&this._myCurrentDirectionConverter.resetFly());else if(this._myStickIdleTimer.start(),t=this._myCurrentDirectionConverter.convertTransformQuat(_,this._myDirectionReference.pp_getTransformQuat(a),i,t),!t.vec3_isZero()){this._myLocomotionRuntimeParams.myIsFlying=this._myLocomotionRuntimeParams.myIsFlying||t.vec3_componentAlongAxis(i,n).vec3_length()>1e-6,this._myLocomotionRuntimeParams.myIsFlying||(t=t.vec3_removeComponentAlongAxis(i,t));let d=_.vec2_length(),g=Math.pp_lerp(0,c,d);e=t.vec3_scale(g*h,e),y=!0}this._myParams.myFlyEnabled&&(r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(M.TOP_BUTTON).isPressed()?(o=i.vec3_scale(c*h,o),e=e.vec3_add(o,e),this._myLocomotionRuntimeParams.myIsFlying=!0):r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(M.BOTTOM_BUTTON).isPressed()&&(o=i.vec3_scale(-c*h,o),e=e.vec3_add(o,e),this._myLocomotionRuntimeParams.myIsFlying=!0),r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(M.BOTTOM_BUTTON).isPressEnd(2)&&(this._myLocomotionRuntimeParams.myIsFlying=!1)),this._myParams.myMoveHeadShortcutEnabled&&r.isDebugEnabled(this._myParams.myEngine)&&r.getGamepads(this._myParams.myEngine)[ee.getOppositeHandedness(this._myParams.myHandedness)].getButtonInfo(M.THUMBSTICK).isPressed()?this._myParams.myPlayerTransformManager.getPlayerHeadManager().moveFeet(e):this._myParams.myMoveThroughCollisionShortcutEnabled&&r.isDebugEnabled(this._myParams.myEngine)&&r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(M.THUMBSTICK).isPressed()?(this._myParams.myPlayerTransformManager.move(e,this._myLocomotionRuntimeParams.myCollisionRuntimeParams,!0),y&&(this._myParams.myPlayerTransformManager.resetReal(!0,!1,!1),this._myParams.myPlayerTransformManager.resetHeadToReal())):(this._myLocomotionRuntimeParams.myIsFlying||(this._myGravitySpeed+=this._myParams.myGravityAcceleration*h,o=i.vec3_scale(this._myGravitySpeed*h,o),e=e.vec3_add(o,e)),r.getGamepads(this._myParams.myEngine)[this._myParams.myHandedness].getButtonInfo(M.SQUEEZE).isPressed(),s=this._myParams.myPlayerTransformManager.getTransformQuat(s),this._myParams.myPlayerTransformManager.move(e,this._myLocomotionRuntimeParams.myCollisionRuntimeParams),y&&(this._myParams.myPlayerTransformManager.resetReal(!0,!1,!1),this._myParams.myPlayerTransformManager.resetHeadToReal()),(this._myGravitySpeed>0&&this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnCeiling||this._myGravitySpeed<0&&this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnGround)&&(this._myGravitySpeed=0)),this._myLocomotionRuntimeParams.myCollisionRuntimeParams.myIsOnGround&&(this._myLocomotionRuntimeParams.myIsFlying=!1,this._myCurrentDirectionConverter.resetFly())}}();ui.prototype._onXRSessionStart=function(){return function(e){switch(this._myParams.myVRDirectionReferenceType){case 0:this._myDirectionReference=r.getPlayerObjects(this._myParams.myEngine).myHead;break;case 1:this._myDirectionReference=r.getPlayerObjects(this._myParams.myEngine).myHands[this._myParams.myHandedness];break;case 2:this._myDirectionReference=this._myParams.myVRDirectionReferenceObject;break}this._myCurrentDirectionConverter=this._myDirectionConverterVR,this._myCurrentDirectionConverter.resetFly()}}();ui.prototype._onXRSessionEnd=function(){let i=m();return function(t){this._myDirectionReference=r.getPlayerObjects(this._myParams.myEngine).myHead,this._myCurrentDirectionConverter=this._myDirectionConverterNonVR,this._myCurrentDirectionConverter.resetFly()}}();Object.defineProperty(ui.prototype,"_onXRSessionStart",{enumerable:!1});Object.defineProperty(ui.prototype,"_onXRSessionEnd",{enumerable:!1});var yt=class{constructor(e){this._myParams=e,this._myRealMovementCollisionCheckParams=null,this._generateRealMovementParamsFromMovementParams(),this._myCollisionRuntimeParams=new re,this._myRealCollisionRuntimeParams=new re,this._myParams.myTeleportCollisionCheckParamsCopyFromMovement&&this._generateTeleportParamsFromMovementParams(),this._myHeadCollisionCheckParams=null,this._setupHeadCollisionCheckParams(),this._myValidPosition=m(),this._myValidRotationQuat=z(),this._myValidHeight=0,this._myValidPositionHead=m(),this._myIsBodyColliding=!1,this._myIsHeadColliding=!1,this._myIsLeaning=!1,this._myIsHopping=!1,this._myIsFar=!1,this._myLastValidMovementDirection=m(),this._myIsRealPositionValid=!1,this._myIsPositionValid=!1,this._myResetRealOnSynced=!1,this._myActive=!0,this._myDestroyed=!1}start(){this.resetToReal(!0),B.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this._myParams.myEngine)}setActive(e){this._myActive=e}update(e){}move(e,t=null,n=!1){}teleportPosition(e,t=null,n=!1){}teleportTransformQuat(e,t=null,n=!1){}teleportAndReset(e,t){this.teleportPosition(e,null,!0),t!=null&&this.setRotationQuat(t),this.resetReal(!0,!1,!1,!0),this.resetHeadToReal()}rotateQuat(e){}setRotationQuat(e){}setHeight(e,t=!1){}getPlayer(){return this._myParams.myPlayerHeadManager.getPlayer()}getHead(){return this._myParams.myPlayerHeadManager.getHead()}getTransformQuat(e=j()){return e.quat2_setPositionRotationQuat(this.getPosition(this._myValidPosition),this.getRotationQuat(this._myValidRotationQuat))}getPosition(e=m()){return e.vec3_copy(this._myValidPosition)}getRotationQuat(e=z()){return e.quat_copy(this._myValidRotationQuat)}getPositionHead(e=m()){return e.vec3_copy(this._myValidPositionHead)}getTransformHeadQuat(e=j()){return e.quat2_setPositionRotationQuat(this.getPositionHead(this._myValidPositionHead),this.getRotationQuat(this._myValidRotationQuat))}getHeight(){return this._myValidHeight}getTransformRealQuat(e=j()){return this.getPlayerHeadManager().getTransformFeetQuat(e)}getTransformHeadRealQuat(e=j()){return this.getPlayerHeadManager().getTransformHeadQuat(e)}getPositionReal(e=m()){return this.getPlayerHeadManager().getPositionFeet(e)}getPositionHeadReal(e=m()){return this.getPlayerHeadManager().getPositionHead(e)}getRotationRealQuat(e=z()){return this.getPlayerHeadManager().getRotationFeetQuat(e)}getHeightReal(){return this._myParams.myPlayerHeadManager.getHeightHead()}isSynced(e=null){let t=this.isBodyColliding()&&(e==null||e.get(le.BODY_COLLIDING)),n=this.isHeadColliding()&&(e==null||e.get(le.HEAD_COLLIDING)),o=this.isFar()&&(e==null||e.get(le.FAR)),s=this.isFloating()&&(e==null||e.get(le.FLOATING));return!t&&!n&&!o&&!s}resetReal(e=!0,t=!0,n=!0,o=!1){}updateReal(){this._updateReal(0,!1)}resetToReal(e=!1){this._myValidPosition=this.getPositionReal(this._myValidPosition),this._myValidPositionHead=this.getPositionHeadReal(this._myValidPositionHead),this._myValidRotationQuat=this.getRotationRealQuat(this._myValidRotationQuat),this._myValidHeight=Math.pp_clamp(this.getHeightReal(),this._myParams.myMinHeight,this._myParams.myMaxHeight),e&&this._updateReal(0,!1)}resetHeadToReal(){this._myValidPositionHead=this.getPositionHeadReal(this._myValidPositionHead)}isBodyColliding(){return this._myIsBodyColliding}isHeadColliding(){return this._myIsHeadColliding}isFloating(){return this.isLeaning()||this.isHopping()}isHopping(){return this._myIsHopping}isLeaning(){return this._myIsLeaning}isHopping(){return this._myIsHopping}isFar(){return this._myIsFar}getDistanceToReal(){}getDistanceToRealHead(){}getPlayerHeadManager(){return this._myParams.myPlayerHeadManager}getParams(){return this._myParams}getMovementCollisionCheckParams(){return this._myParams.myMovementCollisionCheckParams}getTeleportCollisionCheckParams(){return this._myParams.myTeleportCollisionCheckParams}collisionCheckParamsUpdated(){this._myParams.myTeleportCollisionCheckParamsCopyFromMovement&&this._generateTeleportParamsFromMovementParams(),this._generateRealMovementParamsFromMovementParams()}isPositionValid(){return this._myIsPositionValid}isRealPositionValid(){return this._myIsRealPositionValid}getCollisionRuntimeParams(){return this._myCollisionRuntimeParams}getRealCollisionRuntimeParams(){return this._myRealCollisionRuntimeParams}_updateCollisionHeight(){let e=this.getHeight(),t=Math.pp_clamp(this.getHeightReal(),this._myParams.myMinHeight,this._myParams.myMaxHeight);this._myParams.myMovementCollisionCheckParams.myHeight=e,this._myParams.myTeleportCollisionCheckParams.myHeight=e,this._myRealMovementCollisionCheckParams.myHeight=t}_setupHeadCollisionCheckParams(){this._myHeadCollisionCheckParams=new Ae;let e=this._myHeadCollisionCheckParams;e.myRadius=this._myParams.myHeadRadius,e.myDistanceFromFeetToIgnore=0,e.myDistanceFromHeadToIgnore=0,e.mySplitMovementEnabled=!0,e.mySplitMovementMaxLength=.5,e.mySplitMovementMaxStepsEnabled=!0,e.mySplitMovementMaxSteps=2,e.mySplitMovementStopWhenHorizontalMovementCanceled=!0,e.mySplitMovementStopWhenVerticalMovementCanceled=!0,e.myHorizontalMovementCheckEnabled=!0,e.myHorizontalMovementRadialStepAmount=1,e.myHorizontalMovementCheckDiagonalOutward=!0,e.myHorizontalMovementCheckDiagonalInward=!0,e.myHorizontalMovementCheckVerticalDiagonalUpwardOutward=!0,e.myHorizontalMovementCheckVerticalDiagonalUpwardInward=!0,e.myHorizontalPositionCheckEnabled=!0,e.myHalfConeAngle=180,e.myHalfConeSliceAmount=3,e.myCheckConeBorder=!0,e.myCheckConeRay=!0,e.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision=!1,e.myHorizontalPositionCheckVerticalDirectionType=0,e.myHeight=e.myRadius,e.myPositionOffsetLocal.vec3_set(0,-e.myRadius/2,0),e.myCheckHeight=!0,e.myCheckHeightVerticalMovement=!0,e.myCheckHeightVerticalPosition=!0,e.myHeightCheckStepAmountMovement=2,e.myHeightCheckStepAmountPosition=2,e.myCheckHeightTopMovement=!0,e.myCheckHeightTopPosition=!0,e.myCheckVerticalStraight=!0,e.myCheckVerticalFixedForwardEnabled=!0,e.myCheckVerticalFixedForward=m(0,0,1),e.myCheckHorizontalFixedForwardEnabled=!0,e.myCheckHorizontalFixedForward=m(0,0,1),e.myVerticalMovementCheckEnabled=!0,e.myVerticalPositionCheckEnabled=!0,e.myGroundCircumferenceAddCenter=!0,e.myGroundCircumferenceSliceAmount=6,e.myGroundCircumferenceStepAmount=2,e.myGroundCircumferenceRotationPerStep=30,e.myFeetRadius=e.myRadius,e.myHorizontalBlockLayerFlags.copy(this._myParams.myHeadCollisionBlockLayerFlags),e.myHorizontalObjectsToIgnore.pp_copy(this._myParams.myHeadCollisionObjectsToIgnore),e.myVerticalBlockLayerFlags.copy(this._myParams.myHeadCollisionBlockLayerFlags),e.myVerticalObjectsToIgnore.pp_copy(this._myParams.myHeadCollisionObjectsToIgnore),e.myDebugEnabled=!1,e.myDebugHorizontalMovementEnabled=!0,e.myDebugHorizontalPositionEnabled=!1,e.myDebugVerticalMovementEnabled=!1,e.myDebugVerticalPositionEnabled=!1,e.myDebugSlidingEnabled=!1,e.myDebugGroundInfoEnabled=!1,e.myDebugCeilingInfoEnabled=!1,e.myDebugRuntimeParamsEnabled=!1,e.myDebugMovementEnabled=!1}_generateTeleportParamsFromMovementParams(){this._myParams.myTeleportCollisionCheckParams==null&&(this._myParams.myTeleportCollisionCheckParams=new Ae),this._myParams.myTeleportCollisionCheckParamsCheck360?this._myParams.myTeleportCollisionCheckParams=Bi.generate360TeleportParamsFromMovementParams(this._myParams.myMovementCollisionCheckParams,this._myParams.myTeleportCollisionCheckParams):this._myParams.myTeleportCollisionCheckParams.copy(this._myParams.myMovementCollisionCheckParams)}_generateRealMovementParamsFromMovementParams(){this._myRealMovementCollisionCheckParams==null&&(this._myRealMovementCollisionCheckParams=new Ae);let e=this._myRealMovementCollisionCheckParams;e.copy(this._myParams.myMovementCollisionCheckParams),e.mySplitMovementEnabled=!0,e.mySplitMovementMaxLength=.5,e.mySplitMovementMaxStepsEnabled=!0,e.mySplitMovementMaxSteps=2,e.mySplitMovementStopWhenHorizontalMovementCanceled=!0,e.mySplitMovementStopWhenVerticalMovementCanceled=!0,e.mySlidingEnabled=!1,this._myParams.myRealMovementAllowVerticalAdjustments||(e.mySnapOnGroundEnabled=!1,e.mySnapOnCeilingEnabled=!1,e.myGroundPopOutEnabled=!1,e.myCeilingPopOutEnabled=!1,e.myAdjustVerticalMovementWithGroundAngleDownhill=!1,e.myAdjustVerticalMovementWithGroundAngleUphill=!1,e.myAdjustVerticalMovementWithCeilingAngleDownhill=!1,e.myAdjustVerticalMovementWithCeilingAngleUphill=!1,e.myAdjustHorizontalMovementWithGroundAngleDownhill=!1,e.myAdjustHorizontalMovementWithCeilingAngleDownhill=!1,e.myVerticalMovementReduceEnabled=!1),e.myIsOnGroundIfInsideHit=!0,e.myDebugEnabled=!1,e.myDebugHorizontalMovementEnabled=!1,e.myDebugHorizontalPositionEnabled=!1,e.myDebugVerticalMovementEnabled=!1,e.myDebugVerticalPositionEnabled=!1,e.myDebugSlidingEnabled=!1,e.myDebugGroundInfoEnabled=!0,e.myDebugCeilingInfoEnabled=!0,e.myDebugRuntimeParamsEnabled=!1,e.myDebugMovementEnabled=!1}_onXRSessionStart(e,t){this._myActive&&this._myParams.myResetToValidOnEnterSession&&!e&&(this._myResetRealOnSynced=!0)}_onXRSessionEnd(){this._myActive&&this._myParams.myResetToValidOnExitSession&&(this._myResetRealOnSynced=!0)}_debugUpdate(e){r.getDebugVisualManager(this._myParams.myEngine).drawPoint(0,this._myValidPosition,w(1,0,0,1),.05),r.getDebugVisualManager(this._myParams.myEngine).drawLineEnd(0,this._myValidPosition,this.getPositionReal(),w(1,0,0,1),.05),r.getDebugVisualManager(this._myParams.myEngine).drawLine(0,this._myValidPosition,this._myValidRotationQuat.quat_getForward(),.15,w(0,1,0,1),.025),r.getDebugVisualManager(this._myParams.myEngine).drawPoint(0,this._myValidPositionHead,w(1,1,0,1),.05)}destroy(){this._myDestroyed=!0,B.unregisterSessionStartEndEventListeners(this,this._myParams.myEngine)}isDestroyed(){return this._myDestroyed}};yt.prototype.getDistanceToReal=function(){let i=m();return function(){return i=this.getPositionReal(i),i.vec3_distance(this.getPosition())}}();yt.prototype.getDistanceToRealHead=function(){let i=m();return function(){return i=this.getPositionHeadReal(i),i.vec3_distance(this.getPositionHead())}}();yt.prototype.resetReal=function(){let i=m(),e=m(),t=m(),n=z();return function(s=!0,a=!0,l=!0,h=!1){let _=this.getPlayerHeadManager();s&&_.teleportPositionFeet(this.getPosition(t)),i=this.getPlayerHeadManager().getRotationFeetQuat(n).quat_getUp(i),e=this.getRotationQuat(n).quat_getUp(e),(a||i.vec3_angle(e)>Math.PP_EPSILON_DEGREES&&this._myParams.myResetRealResetRotationIfUpChanged)&&_.setRotationFeetQuat(this.getRotationQuat(n),!1),l&&_.setHeight(this.getHeight(),!0),h&&this._updateReal(0,!1)}}();yt.prototype.update=function(){let i=j(),e=new re,t=m(),n=m(),o=z();return function(a){if(this._updateReal(a),this._myResetRealOnSynced&&this.getPlayerHeadManager().isSynced()&&(this._myResetRealOnSynced=!1,B.isSessionActive(this._myParams.myEngine)?this.resetReal(!this._myParams.myNeverResetRealPositionVR,!this._myParams.myNeverResetRealRotationVR,!this._myParams.myNeverResetRealHeightVR,!1):this.resetReal(!this._myParams.myNeverResetRealPositionNonVR,!this._myParams.myNeverResetRealRotationNonVR,!this._myParams.myNeverResetRealHeightNonVR,!1)),this._myParams.myUpdatePositionValid){i=this.getTransformQuat(i),t=i.quat2_getUp(t),o=i.quat2_getRotationQuat(o),n=this._myLastValidMovementDirection.vec3_removeComponentAlongAxis(t,n),n.vec3_isZero(1e-5)||(n.vec3_normalize(n),o.quat_setForward(n),i.quat2_setRotationQuat(o));let l=this._myParams.myMovementCollisionCheckParams.myDebugEnabled;this._myParams.myMovementCollisionCheckParams.myDebugEnabled=!1,fe(this._myParams.myEngine).positionCheck(!0,i,this._myParams.myMovementCollisionCheckParams,e),this._myParams.myMovementCollisionCheckParams.myDebugEnabled=l,this._myIsPositionValid=e.myIsPositionOk}this._myParams.myDebugEnabled&&r.isDebugEnabled(this._myParams.myEngine)&&this._debugUpdate(a)}}();yt.prototype._updateReal=function(){let i=m(),e=m(),t=m(),n=j(),o=new re,s=m(),a=m(),l=m(),h=m(),_=m(),y=m(),c=m(),d=m(),g=j(),P=m(),T=z();return function(x,D=!0){if(this.getPlayerHeadManager().isSynced()){if(this._updateCollisionHeight(),this._myIsBodyColliding=!1,this._myIsHeadColliding=!1,this._myIsLeaning=!1,this._myIsHopping=!1,this._myIsFar=!1,i=this.getPositionReal(t).vec3_sub(this.getPosition(e),i),i.vec3_length()>1e-4&&(this._myLastValidMovementDirection=i.vec3_normalize(this._myLastValidMovementDirection)),this._myParams.mySyncEnabledFlagMap.get(le.FAR)&&(this._myParams.myMaxDistanceFromRealToSyncEnabled&&i.vec3_length()>this._myParams.myMaxDistanceFromRealToSync?this._myIsFar=!0:this._myParams.myIsFarExtraCheckCallback!=null&&this._myParams.myIsFarExtraCheckCallback(this)&&(this._myIsFar=!0)),o.copy(this._myCollisionRuntimeParams),o.myIsOnGround=!0,n=this.getTransformQuat(n),s.vec3_copy(this._myValidPosition),this._myParams.mySyncEnabledFlagMap.get(le.BODY_COLLIDING)&&(fe(this._myParams.myEngine).move(i,n,this._myRealMovementCollisionCheckParams,o),!o.myHorizontalMovementCanceled&&!o.myVerticalMovementCanceled?Math.pp_clamp(this._myRealMovementCollisionCheckParams.myHeight,this._myParams.myIsBodyCollidingWhenHeightBelowValue,this._myParams.myIsBodyCollidingWhenHeightAboveValue)!=this._myRealMovementCollisionCheckParams.myHeight?this._myIsBodyColliding=!0:this._myParams.myIsBodyCollidingExtraCheckCallback!=null&&this._myParams.myIsBodyCollidingExtraCheckCallback(this)?this._myIsBodyColliding=!0:(this._myIsBodyColliding=!1,s.vec3_copy(o.myNewPosition)):this._myIsBodyColliding=!0),this._myParams.mySyncEnabledFlagMap.get(le.FLOATING)&&(this._myIsBodyColliding?i=t.vec3_sub(e,i):i=s.vec3_sub(e,i),o.copy(this._myCollisionRuntimeParams),g.quat2_setPositionRotationQuat(this._myValidPosition,this._myValidRotationQuat),fe(this._myParams.myEngine).updateSurfaceInfo(g,this._myRealMovementCollisionCheckParams,o),o.myIsOnGround)){_=n.quat2_getUp(_),y=i.vec3_componentAlongAxis(_,y);let E=!y.vec3_isZero(1e-5);if(!E||!this._myParams.myIsFloatingValidIfVerticalMovement){let S=1;if(l.vec3_copy(i),!i.vec3_isZero(1e-5)&&this._myParams.myFloatingSplitCheckEnabled){let Z=i.vec3_length()/this._myParams.myFloatingSplitCheckMaxSteps;if(!this._myParams.myFloatingSplitCheckStepEqualLength||Z<this._myParams.myFloatingSplitCheckStepEqualLengthMinLength){let ne=this._myParams.myFloatingSplitCheckStepEqualLength?this._myParams.myFloatingSplitCheckStepEqualLengthMinLength:this._myParams.myFloatingSplitCheckMaxLength;S=Math.ceil(i.vec3_length()/ne),S>1&&(l=l.vec3_normalize(l).vec3_scale(ne,l),S=this._myParams.myFloatingSplitCheckMaxSteps!=null?Math.min(S,this._myParams.myFloatingSplitCheckMaxSteps):S),S=Math.max(1,S),S==1&&l.vec3_copy(i)}else S=this._myParams.myFloatingSplitCheckMaxSteps,S>1&&(l=l.vec3_normalize(l).vec3_scale(Z,l))}let b=o.myGroundAngle<=this._myRealMovementCollisionCheckParams.myGroundAngleToIgnore+1e-4;c.vec3_zero(),d.vec3_copy(this._myValidPosition),o.copy(this._myCollisionRuntimeParams);let v=!1,I=!1,L=!1,F=!1;for(let Z=0;Z<S;Z++)S==1||Z!=S-1?h.vec3_copy(l):h=i.vec3_sub(c,h),d=d.vec3_add(h,d),g.quat2_setPositionRotationQuat(d,this._myValidRotationQuat),o.copy(this._myCollisionRuntimeParams),fe(this._myParams.myEngine).updateSurfaceInfo(g,this._myRealMovementCollisionCheckParams,o),c=c.vec3_add(h,c),o.myIsOnGround?(o.myGroundAngle>this._myRealMovementCollisionCheckParams.myGroundAngleToIgnore+1e-4&&(F=!0),v&&(I=!0),Z==S-1&&(L=!0)):v=!0;let Q=F&&b&&!this._myParams.myIsFloatingValidIfSteepGround&&(!E||!this._myParams.myIsFloatingValidIfVerticalMovementAndSteepGround);if(v||Q?I?this._myIsHopping=!0:this._myIsLeaning=!0:(this._myIsLeaning=!1,this._myIsHopping=!1,this._myParams.myIsLeaningExtraCheckCallback!=null&&this._myParams.myIsLeaningExtraCheckCallback(this)?this._myIsLeaning=!0:this._myParams.myIsHoppingExtraCheckCallback!=null&&this._myParams.myIsHoppingExtraCheckCallback(this)&&(this._myIsHopping=!0)),this._myIsLeaning){let Z=i.vec3_length();this._myParams.myIsLeaningValidAboveDistance&&Z>this._myParams.myLeaningValidDistance&&(this._myIsLeaning=!1)}(this._myIsLeaning||this._myIsHopping)&&(L&&this._myParams.myIsFloatingValidIfRealOnGround?(this._myIsLeaning=!1,this._myIsHopping=!1):L&&E&&this._myParams.myIsFloatingValidIfVerticalMovementAndRealOnGround&&(this._myIsLeaning=!1,this._myIsHopping=!1))}}if(i=this.getPositionHeadReal(t).vec3_sub(this.getPositionHead(e),i),o.reset(),n=this.getTransformHeadQuat(n),a.vec3_copy(this._myValidPositionHead),this._myParams.mySyncEnabledFlagMap.get(le.HEAD_COLLIDING)&&(fe(this._myParams.myEngine).move(i,n,this._myHeadCollisionCheckParams,o),!o.myHorizontalMovementCanceled&&!o.myVerticalMovementCanceled?(this._myIsHeadColliding=!1,a.vec3_copy(o.myNewPosition)):this._myIsHeadColliding=!0),this.isSynced(this._myParams.mySyncPositionFlagMap)&&!this._myParams.mySyncPositionDisabled&&this._myValidPosition.vec3_copy(s),this.isSynced(this._myParams.mySyncPositionHeadFlagMap)&&(this._myValidPositionHead=this.getPositionHeadReal(a)),this.isSynced(this._myParams.mySyncRotationFlagMap)&&(this._myValidRotationQuat=this.getRotationRealQuat(this._myValidRotationQuat)),this.isSynced(this._myParams.mySyncHeightFlagMap)&&(this._myValidHeight=this._myRealMovementCollisionCheckParams.myHeight,this._updateCollisionHeight()),this._myParams.myUpdateRealPositionValid){n=this.getTransformRealQuat(n),_=n.quat2_getUp(_),T=n.quat2_getRotationQuat(T),P=this._myLastValidMovementDirection.vec3_removeComponentAlongAxis(_,P),P.vec3_isZero(1e-5)||(P.vec3_normalize(P),T.quat_setForward(P),n.quat2_setRotationQuat(T));let E=this._myParams.myMovementCollisionCheckParams.myDebugEnabled;this._myParams.myMovementCollisionCheckParams.myDebugEnabled=!1,fe(this._myParams.myEngine).positionCheck(!0,n,this._myParams.myMovementCollisionCheckParams,this._myRealCollisionRuntimeParams),this._myIsRealPositionValid=this._myRealCollisionRuntimeParams.myIsPositionOk,this._myParams.myMovementCollisionCheckParams.myDebugEnabled=E}}}}();yt.prototype.move=function(){let i=j(),e=m();return function(n,o=null,s=!1){i=this.getTransformQuat(i),fe(this._myParams.myEngine).move(n,i,this._myParams.myMovementCollisionCheckParams,this._myCollisionRuntimeParams),o?.copy(this._myCollisionRuntimeParams),s?e.vec3_copy(n):e.vec3_copy(this._myCollisionRuntimeParams.myFixedMovement),e.vec3_isZero(1e-5)||(this._myValidPosition.vec3_add(e,this._myValidPosition),this.getPlayerHeadManager().moveFeet(e)),this._myParams.myResetRealOnMove&&(this.isSynced()||(B.isSessionActive(this._myParams.myEngine)?this.resetReal(!this._myParams.myNeverResetRealPositionVR,!this._myParams.myNeverResetRealRotationVR,!this._myParams.myNeverResetRealHeightVR,!1):this.resetReal(!this._myParams.myNeverResetRealPositionNonVR,!this._myParams.myNeverResetRealRotationNonVR,!this._myParams.myNeverResetRealHeightNonVR,!1)))}}();yt.prototype.teleportPosition=function(){let i=j();return function(e,t=null,n=!1){i=this.getTransformQuat(i),i.quat2_setPosition(e),this.teleportTransformQuat(i,t,n)}}();yt.prototype.teleportTransformQuat=function(){let i=m(),e=m(),t=z(),n=j(),o=m();return function(s,a=null,l=!1){i=this.getPosition(i),e=s.quat2_getPosition(e),t=s.quat2_getRotationQuat(t),n.quat2_setPositionRotationQuat(i,t),fe(this._myParams.myEngine).teleport(e,n,this._myParams.myTeleportCollisionCheckParams,this._myCollisionRuntimeParams),a?.copy(this._myCollisionRuntimeParams),o.vec3_zero(),l?(o=e.vec3_sub(i,o),this.getPlayerHeadManager().setRotationFeetQuat(t)):this._myCollisionRuntimeParams.myTeleportCanceled||(o=this._myCollisionRuntimeParams.myFixedTeleportPosition.vec3_sub(i,o),this.getPlayerHeadManager().setRotationFeetQuat(t)),o.vec3_isZero(1e-5)||(this._myValidPosition.vec3_add(o,this._myValidPosition),this.getPlayerHeadManager().moveFeet(o)),this._myParams.myResetRealOnTeleport&&(this.isSynced()||(B.isSessionActive(this._myParams.myEngine)?this.resetReal(!this._myParams.myNeverResetRealPositionVR,!this._myParams.myNeverResetRealRotationVR,!this._myParams.myNeverResetRealHeightVR,!1):this.resetReal(!this._myParams.myNeverResetRealPositionNonVR,!this._myParams.myNeverResetRealRotationNonVR,!this._myParams.myNeverResetRealHeightNonVR,!1)))}}();yt.prototype.rotateQuat=function(){return function(e){this._myValidRotationQuat.quat_rotateQuat(e,this._myValidRotationQuat),this.getPlayerHeadManager().rotateFeetQuat(e)}}();yt.prototype.setRotationQuat=function(){let i=z();return function(t){i=this._myValidRotationQuat.quat_rotationToQuat(t,i),this.rotateQuat(i)}}();yt.prototype.setHeight=function(){let i=j();return function(t,n=!1){let o=Math.pp_clamp(t,this._myParams.myMinHeight,this._myParams.myMaxHeight),s=this.getHeight();this._myValidHeight=o,this._updateCollisionHeight(),i=this.getTransformQuat(i),fe(this._myParams.myEngine).positionCheck(!0,i,this._myParams.myMovementCollisionCheckParams,this._myCollisionRuntimeParams),this._myCollisionRuntimeParams.myIsPositionOk||n?this.getPlayerHeadManager().setHeight(this.getHeight(),!0):this._myValidHeight=s,this._updateCollisionHeight()}}();var _a=class{constructor(e){this._myParams=e,this._myCollisionCheckParamsMovement=new Ae,this._setupCollisionCheckParamsMovement(),this._myCollisionCheckParamsTeleport=null,this._setupCollisionCheckParamsTeleport(),this._myCollisionRuntimeParams=new re,this._myMovementRuntimeParams=new go,this._myMovementRuntimeParams.myIsFlying=this._myParams.myStartFlying,this._myMovementRuntimeParams.myCollisionRuntimeParams=this._myCollisionRuntimeParams;{let t=new tn(this._myParams.myEngine);t.mySessionChangeResyncEnabled=!0,t.myBlurEndResyncEnabled=!0,t.myBlurEndResyncRotation=!0,t.myEnterSessionResyncHeight=!1,t.myExitSessionResyncHeight=!1,t.myExitSessionResyncVerticalAngle=!0,t.myExitSessionRemoveRightTilt=!0,t.myExitSessionAdjustMaxVerticalAngle=!0,t.myExitSessionMaxVerticalAngle=90,t.myHeightOffsetVRWithFloor=0,t.myHeightOffsetVRWithoutFloor=this._myParams.myDefaultHeight,t.myHeightOffsetNonVR=this._myParams.myDefaultHeight,t.myForeheadExtraHeight=this._myParams.myForeheadExtraHeight,t.myFeetRotationKeepUp=!0,t.myDebugEnabled=!1,this._myPlayerHeadManager=new se(t)}{let t=new vo(this._myParams.myEngine);t.myPlayerHeadManager=this._myPlayerHeadManager,t.myMovementCollisionCheckParams=this._myCollisionCheckParamsMovement,t.myTeleportCollisionCheckParams=null,t.myTeleportCollisionCheckParamsCopyFromMovement=!0,t.myTeleportCollisionCheckParamsCheck360=!0,t.myHeadCollisionBlockLayerFlags.copy(t.myMovementCollisionCheckParams.myHorizontalBlockLayerFlags),t.myHeadCollisionBlockLayerFlags.add(t.myMovementCollisionCheckParams.myVerticalBlockLayerFlags),t.myHeadCollisionObjectsToIgnore.pp_copy(t.myMovementCollisionCheckParams.myHorizontalObjectsToIgnore);let n=(o,s)=>o.pp_equals(s);for(let o of t.myMovementCollisionCheckParams.myVerticalObjectsToIgnore)t.myHeadCollisionObjectsToIgnore.pp_pushUnique(o,n);t.myCollisionRuntimeParams=this._myCollisionRuntimeParams,t.myHeadRadius=.15,t.myMaxDistanceFromRealToSyncEnabled=!0,t.myMaxDistanceFromRealToSync=100,t.myIsFloatingValidIfVerticalMovement=!1,t.myIsFloatingValidIfVerticalMovementAndRealOnGround=!1,t.myIsFloatingValidIfSteepGround=!1,t.myIsFloatingValidIfVerticalMovementAndSteepGround=!1,t.myIsFloatingValidIfRealOnGround=!1,t.myIsLeaningValidAboveDistance=!0,t.myLeaningValidDistance=2,t.myFloatingSplitCheckEnabled=!0,t.myFloatingSplitCheckMaxLength=.2,t.myFloatingSplitCheckMaxSteps=5,t.myRealMovementAllowVerticalAdjustments=!1,t.myUpdateRealPositionValid=!0,t.myUpdatePositionValid=!0,t.myIsBodyCollidingWhenHeightBelowValue=null,t.myIsBodyCollidingWhenHeightAboveValue=null,t.myResetToValidOnEnterSession=!0,t.myResetToValidOnExitSession=!0,t.myAlwaysResetRealPositionNonVR=!0,t.myAlwaysResetRealRotationNonVR=!0,t.myAlwaysResetRealHeightNonVR=!0,t.myAlwaysResetRealPositionVR=!1,t.myAlwaysResetRealRotationVR=!1,t.myAlwaysResetRealHeightVR=!1,t.myNeverResetRealPositionNonVR=!1,t.myNeverResetRealRotationNonVR=!0,t.myNeverResetRealHeightNonVR=!1,t.myNeverResetRealPositionVR=!1,t.myNeverResetRealRotationVR=!1,t.myNeverResetRealHeightVR=!0,t.myResetRealOnMove=!1,t.myDebugEnabled=!1,this._myPlayerTransformManager=new yt(t)}{let t=new Po(this._myParams.myEngine);t.myPlayerTransformManager=this._myPlayerTransformManager,t.myObscureObject=null,t.myObscureMaterial=null,t.myObscureRadius=.1,t.myObscureFadeOutSeconds=.25,t.myObscureFadeInSeconds=.25,t.myObscureFadeEasingFunction=ue.linear,t.myObscureLevelRelativeDistanceEasingFunction=ue.linear,t.myDistanceToStartObscureWhenBodyColliding=.75,t.myDistanceToStartObscureWhenHeadColliding=0,t.myDistanceToStartObscureWhenFloating=.75,t.myDistanceToStartObscureWhenFar=.75,t.myRelativeDistanceToMaxObscureWhenBodyColliding=.5,t.myRelativeDistanceToMaxObscureWhenHeadColliding=.1,t.myRelativeDistanceToMaxObscureWhenFloating=.5,t.myRelativeDistanceToMaxObscureWhenFar=.5,this._myPlayerObscureManager=new Co(t)}{let t=new fo(this._myParams.myEngine);t.myPlayerHeadManager=this._myPlayerHeadManager,t.myPlayerTransformManager=this._myPlayerTransformManager,t.myMaxRotationSpeed=this._myParams.myMaxRotationSpeed,t.myIsSnapTurn=this._myParams.myIsSnapTurn,t.mySnapTurnOnlyVR=this._myParams.mySnapTurnOnlyVR,t.mySnapTurnAngle=this._myParams.mySnapTurnAngle,this._myParams.mySnapTurnSpeedDegrees>Math.PP_EPSILON?(t.mySmoothSnapEnabled=!0,t.mySmoothSnapSpeedDegrees=this._myParams.mySnapTurnSpeedDegrees):t.mySmoothSnapEnabled=!1,t.myRotationMinStickIntensityThreshold=.1,t.mySnapTurnActivateThreshold=.5,t.mySnapTurnResetThreshold=.4,t.myClampVerticalAngle=!0,t.myMaxVerticalAngle=90,this._myPlayerLocomotionRotate=new Wt(t),t.myHandedness=ee.getOppositeHandedness(this._myParams.myMainHand)}{{let t=new So(this._myParams.myEngine);t.myPlayerHeadManager=this._myPlayerHeadManager,t.myPlayerTransformManager=this._myPlayerTransformManager,t.myCollisionCheckParams=this._myCollisionCheckParamsMovement,t.myHandedness=this._myParams.myMainHand,t.myMaxSpeed=this._myParams.myMaxSpeed,t.myMovementMinStickIntensityThreshold=.1,t.myFlyEnabled=this._myParams.myFlyEnabled,t.myMinAngleToFlyUpNonVR=this._myParams.myMinAngleToFlyUpNonVR,t.myMinAngleToFlyDownNonVR=this._myParams.myMinAngleToFlyDownNonVR,t.myMinAngleToFlyUpVR=this._myParams.myMinAngleToFlyUpVR,t.myMinAngleToFlyDownVR=this._myParams.myMinAngleToFlyDownVR,t.myMinAngleToFlyRight=this._myParams.myMinAngleToFlyRight,t.myGravityAcceleration=-20,t.myVRDirectionReferenceType=this._myParams.myVRDirectionReferenceType,t.myVRDirectionReferenceObject=this._myParams.myVRDirectionReferenceObject,t.myMoveThroughCollisionShortcutEnabled=this._myParams.myMoveThroughCollisionShortcutEnabled,t.myMoveHeadShortcutEnabled=this._myParams.myMoveHeadShortcutEnabled,t.myTripleSpeedShortcutEnabled=this._myParams.myTripleSpeedShortcutEnabled,this._myPlayerLocomotionSmooth=new ui(t,this._myMovementRuntimeParams)}{let t=new bo(this._myParams.myEngine);t.myPlayerHeadManager=this._myPlayerHeadManager,t.myPlayerTransformManager=this._myPlayerTransformManager,t.myCollisionCheckParams=this._myCollisionCheckParamsTeleport,t.myHandedness=this._myParams.myMainHand,t.myDetectionParams.myMaxDistance=this._myParams.myTeleportMaxDistance,t.myDetectionParams.myMaxHeightDifference=this._myParams.myTeleportMaxHeightDifference,t.myDetectionParams.myGroundAngleToIgnoreUpward=this._myCollisionCheckParamsMovement.myGroundAngleToIgnore,t.myDetectionParams.myMustBeOnGround=!0,t.myDetectionParams.myTeleportBlockLayerFlags.copy(this._myParams.myPhysicsBlockLayerFlags),t.myDetectionParams.myTeleportFloorLayerFlags.copy(this._myParams.myPhysicsBlockLayerFlags),t.myDetectionParams.myTeleportFeetPositionMustBeVisible=!1,t.myDetectionParams.myTeleportHeadPositionMustBeVisible=!1,t.myDetectionParams.myTeleportHeadOrFeetPositionMustBeVisible=!0,t.myDetectionParams.myTeleportParableStartReferenceObject=this._myParams.myTeleportParableStartReferenceObject,t.myDetectionParams.myVisibilityBlockLayerFlags.copy(t.myDetectionParams.myTeleportBlockLayerFlags),t.myVisualizerParams.myTeleportPositionObject=this._myParams.myTeleportPositionObject,t.myPerformTeleportAsMovement=!1,t.myTeleportAsMovementRemoveVerticalMovement=!0,t.myTeleportAsMovementExtraVerticalMovementPerMeter=-2,t.myGravityAcceleration=0,t.myDebugEnabled=!1,t.myDebugDetectEnabled=!0,t.myDebugShowEnabled=!0,t.myDebugVisibilityEnabled=!1,this._myPlayerLocomotionTeleport=new on(t,this._myMovementRuntimeParams)}}this._setupLocomotionMovementFSM(),this._myIdle=!1,this._myActive=!0,this._myStarted=!1,this._myDestroyed=!1}start(){this._fixAlmostUp(),this._myPlayerHeadManager.start(),this._myPlayerTransformManager.start(),this._myPlayerObscureManager.start(),this._myPlayerLocomotionRotate.start(),this._myLocomotionMovementFSM.perform("start"),this._myStarted=!0;let e=this._myActive;this._myActive=!this._myActive,this.setActive(e)}setActive(e){this._myActive!=e&&(this._myActive=e,this._myStarted&&(this._myActive?(this._myPlayerObscureManager.start(),this._myIdle||this._myLocomotionMovementFSM.perform("start")):(this._myLocomotionMovementFSM.perform("idle"),this._myPlayerObscureManager.stop())),this._myPlayerHeadManager.setActive(this._myActive),this._myPlayerTransformManager.setActive(this._myActive))}isStarted(){return this._myStarted}canStop(){let e=!1;return(this._myLocomotionMovementFSM.isInState("smooth")&&this._myPlayerLocomotionSmooth.canStop()||this._myLocomotionMovementFSM.isInState("teleport")&&this._myPlayerLocomotionTeleport.canStop())&&(e=!0),e}update(e){this._myPlayerHeadManager.update(e),this._myPlayerTransformManager.update(e),r.getLeftGamepad(this._myParams.myEngine).getButtonInfo(M.THUMBSTICK).isPressEnd(2)&&(this._myLocomotionMovementFSM.isInState("smooth")&&this._myPlayerLocomotionSmooth.canStop()?this._myLocomotionMovementFSM.perform("next"):this._myLocomotionMovementFSM.isInState("teleport")&&this._myPlayerLocomotionTeleport.canStop()&&this._myLocomotionMovementFSM.perform("next")),this._myPlayerHeadManager.isSynced()&&(this._updateCollisionHeight(),this._myIdle||(this._myPlayerLocomotionRotate.update(e),this._myLocomotionMovementFSM.update(e))),this._myPlayerObscureManager.update(e)}setIdle(e){this._myIdle=e,e?this._myLocomotionMovementFSM.perform("idle"):this._myLocomotionMovementFSM.perform("start")}_updateCollisionHeight(){this._myCollisionCheckParamsMovement.myHeight=this._myPlayerHeadManager.getHeightHead(),this._myCollisionCheckParamsMovement.myHeight<=1e-6&&(this._myCollisionCheckParamsMovement.myHeight=0),this._myCollisionCheckParamsTeleport.myHeight=this._myCollisionCheckParamsMovement.myHeight}_setupCollisionCheckParamsMovement(){let e=new oa;e.myHeight=this._myParams.myDefaultHeight,e.myRadius=this._myParams.myCharacterRadius,e.myAccuracyLevel=this._myParams.myColliderAccuracy,e.myIsPlayer=!0,e.myCheckOnlyFeet=this._myParams.myColliderCheckOnlyFeet,e.myAverageSpeed=this._myParams.myMaxSpeed,e.myCanFly=this._myParams.myFlyEnabled,e.myShouldSlideAgainstWall=this._myParams.myColliderSlideAgainstWall,e.myCollectGroundInfo=!0,e.myMaxWalkableGroundAngle=this._myParams.myColliderMaxWalkableGroundAngle,e.myShouldSnapOnGround=this._myParams.myColliderSnapOnGround,e.myMaxDistanceToSnapOnGround=this._myParams.myColliderMaxDistanceToSnapOnGround,e.myMaxWalkableGroundStepHeight=this._myParams.myColliderMaxWalkableGroundStepHeight,e.myShouldNotFallFromEdges=this._myParams.myColliderPreventFallingFromEdges,e.myHorizontalCheckBlockLayerFlags.copy(this._myParams.myPhysicsBlockLayerFlags);let t=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getComponents(eA);for(let o of t)e.myHorizontalCheckObjectsToIgnore.pp_pushUnique(o.object,(s,a)=>s.pp_equals(a));e.myVerticalCheckBlockLayerFlags.copy(e.myHorizontalCheckBlockLayerFlags),e.myVerticalCheckObjectsToIgnore.pp_copy(e.myHorizontalCheckObjectsToIgnore),e.myHorizontalCheckDebugEnabled=this._myParams.myDebugHorizontalEnabled&&r.isDebugEnabled(this._myParams.myEngine),e.myVerticalCheckDebugEnabled=this._myParams.myDebugVerticalEnabled&&r.isDebugEnabled(this._myParams.myEngine);let n=cm.createSimplified(e);this._myCollisionCheckParamsMovement=mi.convertCharacterColliderSetupToCollisionCheckParams(n,this._myCollisionCheckParamsMovement,this._myParams.myEngine)}_setupCollisionCheckParamsTeleport(){this._myCollisionCheckParamsTeleport=Bi.generate360TeleportParamsFromMovementParams(this._myCollisionCheckParamsMovement),this._myCollisionCheckParamsTeleport.myGroundAngleToIgnore=61,this._myCollisionCheckParamsTeleport.myTeleportMustBeOnIgnorableGroundAngle=!0,this._myCollisionCheckParamsTeleport.myTeleportMustBeOnGround=!0}_fixAlmostUp(){let e=m(0,1,0);if(r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getUp().vec3_angle(e)<1){let o=r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_getForward().vec3_clone();o[1]=0;let a=m(0,0,1).vec3_angleSigned(o,e);r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_resetRotation(),r.getPlayerObjects(this._myParams.myEngine).myPlayer.pp_rotateAxis(a,e)}}_setupLocomotionMovementFSM(){this._myLocomotionMovementFSM=new ze,this._myLocomotionMovementFSM.addState("init"),this._myLocomotionMovementFSM.addState("smooth",e=>this._myPlayerLocomotionSmooth.update(e)),this._myLocomotionMovementFSM.addState("teleport",e=>this._myPlayerLocomotionTeleport.update(e)),this._myLocomotionMovementFSM.addState("idleSmooth"),this._myLocomotionMovementFSM.addState("idleTeleport"),this._myLocomotionMovementFSM.addTransition("init","smooth","start",function(){this._myPlayerLocomotionSmooth.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("smooth","teleport","next",function(){this._myPlayerLocomotionSmooth.stop(),this._myPlayerLocomotionTeleport.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("teleport","smooth","next",function(){this._myPlayerLocomotionTeleport.stop(),this._myPlayerLocomotionSmooth.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("smooth","idleSmooth","idle",function(){this._myPlayerLocomotionSmooth.stop()}.bind(this)),this._myLocomotionMovementFSM.addTransition("teleport","idleTeleport","idle",function(){this._myPlayerLocomotionTeleport.stop()}.bind(this)),this._myLocomotionMovementFSM.addTransition("idleSmooth","smooth","start",function(){this._myPlayerLocomotionSmooth.start()}.bind(this)),this._myLocomotionMovementFSM.addTransition("idleTeleport","teleport","start",function(){this._myPlayerLocomotionTeleport.start()}.bind(this)),this._myLocomotionMovementFSM.init("init")}destroy(){this._myDestroyed=!0,this._myPlayerHeadManager.destroy(),this._myPlayerLocomotionSmooth.destroy(),this._myPlayerTransformManager.destroy(),this._myPlayerObscureManager.destroy(),this._myPlayerLocomotionTeleport.destroy()}isDestroyed(){return this._myDestroyed}};var zT=new WeakMap;function fe(i=r.getMainEngine()){return zT.get(i)}function iA(i,e=r.getMainEngine()){zT.set(e,i)}var Rn=class extends tA{start(){iA(new G(this.engine),this.engine);let e=new pa(this.engine);e.myDefaultHeight=this._myDefaultHeight,e.myMaxSpeed=this._myMaxSpeed,e.myMaxRotationSpeed=this._myMaxRotationSpeed,e.myCharacterRadius=this._myCharacterRadius,e.myIsSnapTurn=this._myIsSnapTurn,e.mySnapTurnOnlyVR=this._mySnapTurnOnlyVR,e.mySnapTurnAngle=this._mySnapTurnAngle,e.mySnapTurnSpeedDegrees=this._mySnapTurnSpeedDegrees,e.myFlyEnabled=this._myFlyEnabled,e.myStartFlying=this._myStartFlying,e.myMinAngleToFlyUpNonVR=this._myMinAngleToFlyUpNonVR,e.myMinAngleToFlyDownNonVR=this._myMinAngleToFlyDownNonVR,e.myMinAngleToFlyUpVR=this._myMinAngleToFlyUpVR,e.myMinAngleToFlyDownVR=this._myMinAngleToFlyDownVR,e.myMinAngleToFlyRight=this._myMinAngleToFlyRight,e.myMainHand=ee.getHandednessByIndex(this._myMainHand),e.myVRDirectionReferenceType=this._myVRDirectionReferenceType,e.myVRDirectionReferenceObject=this._myVRDirectionReferenceObject,e.myTeleportParableStartReferenceObject=this._myTeleportParableStartReferenceObject,e.myForeheadExtraHeight=.1,e.myTeleportPositionObject=this._myTeleportPositionObject,e.myTeleportMaxDistance=this._myTeleportMaxDistance,e.myTeleportMaxHeightDifference=this._myTeleportMaxHeightDifference,e.myColliderAccuracy=this._myColliderAccuracy,e.myColliderCheckOnlyFeet=this._myColliderCheckOnlyFeet,e.myColliderSlideAgainstWall=this._myColliderSlideAgainstWall,e.myColliderMaxWalkableGroundAngle=this._myColliderMaxWalkableGroundAngle,e.myColliderSnapOnGround=this._myColliderSnapOnGround,e.myColliderMaxDistanceToSnapOnGround=this._myColliderMaxDistanceToSnapOnGround,e.myColliderMaxWalkableGroundStepHeight=this._myColliderMaxWalkableGroundStepHeight,e.myColliderPreventFallingFromEdges=this._myColliderPreventFallingFromEdges,e.myMoveThroughCollisionShortcutEnabled=this._myMoveThroughCollisionShortcutEnabled,e.myMoveHeadShortcutEnabled=this._myMoveHeadShortcutEnabled,e.myTripleSpeedShortcutEnabled=this._myTripleSpeedShortcutEnabled,e.myDebugHorizontalEnabled=this._myDebugHorizontalEnabled,e.myDebugVerticalEnabled=this._myDebugVerticalEnabled,e.myPhysicsBlockLayerFlags.copy(this._getPhysicsBlockLayersFlags()),this._myUseCleanedVersion?this._myPlayerLocomotion=new _a(e):this._myPlayerLocomotion=new da(e),this._myStartCounter=1}update(e){this._myStartCounter>0?(this._myStartCounter--,this._myStartCounter==0&&(this._myPlayerLocomotion.start(),this._myPlayerLocomotion._myPlayerTransformManager.resetReal(!0,!1,!1,!0),this._myPlayerLocomotion._myPlayerTransformManager.resetHeadToReal()),this._myPlayerLocomotion._myPlayerHeadManager.update(e)):(fe(this.engine)._myTotalRaycasts=0,this._myPlayerLocomotion.update(e))}onActivate(){this._myStartCounter==0&&this._myPlayerLocomotion!=null&&this._myPlayerLocomotion.setActive(!0)}onDeactivate(){this._myStartCounter==0&&this._myPlayerLocomotion!=null&&this._myPlayerLocomotion.setActive(!1)}_getPhysicsBlockLayersFlags(){let e=new Re,t=[...this._myPhysicsBlockLayerFlags.split(",")];for(let n=0;n<t.length;n++)e.setFlagActive(n,t[n].trim()=="1");return e}onDestroy(){this._myPlayerLocomotion?.destroy()}};R(Rn,"TypeName","pp-player-locomotion"),R(Rn,"Properties",{_myPhysicsBlockLayerFlags:me.string("0, 0, 0, 0, 0, 0, 0, 0"),_myDefaultHeight:me.float(1.75),_myCharacterRadius:me.float(.3),_myMaxSpeed:me.float(2),_myMaxRotationSpeed:me.float(100),_myIsSnapTurn:me.bool(!0),_mySnapTurnOnlyVR:me.bool(!0),_mySnapTurnAngle:me.float(30),_mySnapTurnSpeedDegrees:me.float(0),_myFlyEnabled:me.bool(!1),_myStartFlying:me.bool(!1),_myMinAngleToFlyUpNonVR:me.float(30),_myMinAngleToFlyDownNonVR:me.float(50),_myMinAngleToFlyUpVR:me.float(60),_myMinAngleToFlyDownVR:me.float(1),_myMinAngleToFlyRight:me.float(60),_myMainHand:me.enum(["Left","Right"],"Left"),_myVRDirectionReferenceType:me.enum(["Head","Hand","Custom Object"],"Hand"),_myVRDirectionReferenceObject:me.object(),_myTeleportParableStartReferenceObject:me.object(),_myTeleportPositionObject:me.object(),_myTeleportMaxDistance:me.float(3),_myTeleportMaxHeightDifference:me.float(3),_myColliderAccuracy:me.enum(["Very Low","Low","Medium","High","Very High"],"High"),_myColliderCheckOnlyFeet:me.bool(!1),_myColliderSlideAgainstWall:me.bool(!0),_myColliderMaxWalkableGroundAngle:me.float(30),_myColliderSnapOnGround:me.bool(!0),_myColliderMaxDistanceToSnapOnGround:me.float(.1),_myColliderMaxWalkableGroundStepHeight:me.float(.1),_myColliderPreventFallingFromEdges:me.bool(!1),_myUseCleanedVersion:me.bool(!0),_myDebugHorizontalEnabled:me.bool(!1),_myDebugVerticalEnabled:me.bool(!1),_myMoveThroughCollisionShortcutEnabled:me.bool(!1),_myMoveHeadShortcutEnabled:me.bool(!1),_myTripleSpeedShortcutEnabled:me.bool(!1)});var le={BODY_COLLIDING:0,HEAD_COLLIDING:1,FAR:2,FLOATING:3},vo=class{constructor(e=r.getMainEngine()){this.myPlayerHeadManager=null,this.myMovementCollisionCheckParams=null,this.myTeleportCollisionCheckParams=null,this.myTeleportCollisionCheckParamsCopyFromMovement=!1,this.myTeleportCollisionCheckParamsCheck360=!1,this.mySyncEnabledFlagMap=new Map,this.mySyncEnabledFlagMap.set(le.BODY_COLLIDING,!0),this.mySyncEnabledFlagMap.set(le.HEAD_COLLIDING,!0),this.mySyncEnabledFlagMap.set(le.FAR,!0),this.mySyncEnabledFlagMap.set(le.FLOATING,!0),this.mySyncPositionFlagMap=new Map,this.mySyncPositionFlagMap.set(le.BODY_COLLIDING,!0),this.mySyncPositionFlagMap.set(le.HEAD_COLLIDING,!1),this.mySyncPositionFlagMap.set(le.FAR,!0),this.mySyncPositionFlagMap.set(le.FLOATING,!0),this.mySyncPositionHeadFlagMap=new Map,this.mySyncPositionHeadFlagMap.set(le.BODY_COLLIDING,!1),this.mySyncPositionHeadFlagMap.set(le.HEAD_COLLIDING,!0),this.mySyncPositionHeadFlagMap.set(le.FAR,!1),this.mySyncPositionHeadFlagMap.set(le.FLOATING,!1),this.mySyncRotationFlagMap=new Map,this.mySyncRotationFlagMap.set(le.BODY_COLLIDING,!1),this.mySyncRotationFlagMap.set(le.HEAD_COLLIDING,!1),this.mySyncRotationFlagMap.set(le.FAR,!1),this.mySyncRotationFlagMap.set(le.FLOATING,!1),this.mySyncHeightFlagMap=new Map,this.mySyncHeightFlagMap.set(le.BODY_COLLIDING,!1),this.mySyncHeightFlagMap.set(le.HEAD_COLLIDING,!1),this.mySyncHeightFlagMap.set(le.FAR,!1),this.mySyncHeightFlagMap.set(le.FLOATING,!1),this.myIsLeaningValidAboveDistance=!1,this.myLeaningValidDistance=0,this.myIsFloatingValidIfVerticalMovement=!1,this.myIsFloatingValidIfVerticalMovementAndRealOnGround=!1,this.myIsFloatingValidIfRealOnGround=!1,this.myIsFloatingValidIfSteepGround=!1,this.myIsFloatingValidIfVerticalMovementAndSteepGround=!1,this.myFloatingSplitCheckEnabled=!1,this.myFloatingSplitCheckMaxLength=0,this.myFloatingSplitCheckMaxSteps=null,this.myFloatingSplitCheckStepEqualLength=!1,this.myFloatingSplitCheckStepEqualLengthMinLength=0,this.myMaxDistanceFromRealToSyncEnabled=!1,this.myMaxDistanceFromRealToSync=0,this.myHeadRadius=0,this.myHeadCollisionBlockLayerFlags=new Re,this.myHeadCollisionObjectsToIgnore=[],this.myRotateOnlyIfSynced=!1,this.myResetRealResetRotationIfUpChanged=!0,this.myRealMovementAllowVerticalAdjustments=!1,this.myUpdateRealPositionValid=!1,this.myUpdatePositionValid=!1,this.myMinHeight=null,this.myMaxHeight=null,this.myIsBodyCollidingWhenHeightBelowValue=null,this.myIsBodyCollidingWhenHeightAboveValue=null,this.myIsBodyCollidingExtraCheckCallback=null,this.myIsLeaningExtraCheckCallback=null,this.myIsHoppingExtraCheckCallback=null,this.myIsFarExtraCheckCallback=null,this.myResetToValidOnEnterSession=!1,this.myResetToValidOnExitSession=!1,this.myAlwaysResetRealPositionNonVR=!1,this.myAlwaysResetRealRotationNonVR=!1,this.myAlwaysResetRealHeightNonVR=!1,this.myAlwaysResetRealPositionVR=!1,this.myAlwaysResetRealRotationVR=!1,this.myAlwaysResetRealHeightVR=!1,this.myNeverResetRealPositionNonVR=!1,this.myNeverResetRealRotationNonVR=!1,this.myNeverResetRealHeightNonVR=!1,this.myNeverResetRealPositionVR=!1,this.myNeverResetRealRotationVR=!1,this.myNeverResetRealHeightVR=!1,this.myResetRealOnMove=!1,this.myResetRealOnTeleport=!1,this.mySyncPositionDisabled=!1,this.myEngine=e,this.myDebugEnabled=!1}destroy(){this._myDestroyed=!0,B.unregisterSessionStartEndEventListeners(this,this._myParams.myEngine)}isDestroyed(){return this._myDestroyed}},mt=class{constructor(e){this._myParams=e,this._myRealMovementCollisionCheckParams=null,this._generateRealMovementParamsFromMovementParams(),this._myCollisionRuntimeParams=new re,this._myRealCollisionRuntimeParams=new re,this._myParams.myTeleportCollisionCheckParamsCopyFromMovement&&this._generateTeleportParamsFromMovementParams(),this._myHeadCollisionCheckParams=null,this._setupHeadCollisionCheckParams(),this._myValidPosition=m(),this._myValidRotationQuat=z(),this._myValidHeight=0,this._myValidPositionHead=m(),this._myIsBodyColliding=!1,this._myIsHeadColliding=!1,this._myIsLeaning=!1,this._myIsHopping=!1,this._myIsFar=!1,this._myLastValidMovementDirection=m(),this._myIsRealPositionValid=!1,this._myIsPositionValid=!1,this._myResetRealOnSynced=!1,this._myDestroyed=!1}start(){this.resetToReal(!0),B.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this._myParams.myEngine)}update(e){}move(e,t=null,n=!1){}teleportPosition(e,t=null,n=!1){}teleportTransformQuat(e,t=null,n=!1){}rotateQuat(e){}setRotationQuat(e){}setHeight(e,t=!1){}getPlayer(){return this._myParams.myPlayerHeadManager.getPlayer()}getHead(){return this._myParams.myPlayerHeadManager.getHead()}getTransformQuat(e=j()){return e.quat2_setPositionRotationQuat(this.getPosition(this._myValidPosition),this.getRotationQuat(this._myValidRotationQuat))}getPosition(e=m()){return e.vec3_copy(this._myValidPosition)}getRotationQuat(e=z()){return e.quat_copy(this._myValidRotationQuat)}getPositionHead(e=m()){return e.vec3_copy(this._myValidPositionHead)}getTransformHeadQuat(e=j()){return e.quat2_setPositionRotationQuat(this.getPositionHead(this._myValidPositionHead),this.getRotationQuat(this._myValidRotationQuat))}getHeight(){return this._myValidHeight}getTransformRealQuat(e=j()){return this.getPlayerHeadManager().getTransformFeetQuat(e)}getTransformHeadRealQuat(e=j()){return this.getPlayerHeadManager().getTransformHeadQuat(e)}getPositionReal(e=m()){return this.getPlayerHeadManager().getPositionFeet(e)}getPositionHeadReal(e=m()){return this.getPlayerHeadManager().getPositionHead(e)}getRotationRealQuat(e=z()){return this.getPlayerHeadManager().getRotationFeetQuat(e)}getHeightReal(){return this._myParams.myPlayerHeadManager.getHeightHead()}isSynced(e=null){let t=this.isBodyColliding()&&(e==null||e.get(le.BODY_COLLIDING)),n=this.isHeadColliding()&&(e==null||e.get(le.HEAD_COLLIDING)),o=this.isFar()&&(e==null||e.get(le.FAR)),s=this.isFloating()&&(e==null||e.get(le.FLOATING));return!t&&!n&&!o&&!s}resetReal(e=!0,t=!0,n=!0,o=!1){}resetHeadToReal(){this._myValidPositionHead=this.getPositionHeadReal(this._myValidPositionHead)}updateReal(){this._updateReal(0,!1)}resetToReal(e=!1){this._myValidPosition=this.getPositionReal(this._myValidPosition),this._myValidPositionHead=this.getPositionHeadReal(this._myValidPositionHead),this._myValidRotationQuat=this.getRotationRealQuat(this._myValidRotationQuat),this._myValidHeight=Math.pp_clamp(this.getHeightReal(),this._myParams.myMinHeight,this._myParams.myMaxHeight),e&&this._updateReal(0,!1)}isBodyColliding(){return this._myIsBodyColliding}isHeadColliding(){return this._myIsHeadColliding}isFloating(){return this.isLeaning()||this.isHopping()}isHopping(){return this._myIsHopping}isLeaning(){return this._myIsLeaning}isHopping(){return this._myIsHopping}isFar(){return this._myIsFar}getDistanceToReal(){}getDistanceToRealHead(){}getPlayerHeadManager(){return this._myParams.myPlayerHeadManager}getParams(){return this._myParams}getMovementCollisionCheckParams(){return this._myParams.myMovementCollisionCheckParams}getTeleportCollisionCheckParams(){return this._myParams.myTeleportCollisionCheckParams}collisionCheckParamsUpdated(){this._myParams.myTeleportCollisionCheckParamsCopyFromMovement&&this._generateTeleportParamsFromMovementParams(),this._generateRealMovementParamsFromMovementParams()}isPositionValid(){return this._myIsPositionValid}isRealPositionValid(){return this._myIsRealPositionValid}getCollisionRuntimeParams(){return this._myCollisionRuntimeParams}getRealCollisionRuntimeParams(){return this._myRealCollisionRuntimeParams}_updateCollisionHeight(){let e=this.getHeight(),t=Math.pp_clamp(this.getHeightReal(),this._myParams.myMinHeight,this._myParams.myMaxHeight);this._myParams.myMovementCollisionCheckParams.myHeight=e,this._myParams.myTeleportCollisionCheckParams.myHeight=e,this._myRealMovementCollisionCheckParams.myHeight=t}_setupHeadCollisionCheckParams(){this._myHeadCollisionCheckParams=new Ae;let e=this._myHeadCollisionCheckParams;e.myRadius=this._myParams.myHeadRadius,e.myDistanceFromFeetToIgnore=0,e.myDistanceFromHeadToIgnore=0,e.mySplitMovementEnabled=!0,e.mySplitMovementMaxLength=.5,e.mySplitMovementMaxStepsEnabled=!0,e.mySplitMovementMaxSteps=2,e.mySplitMovementStopWhenHorizontalMovementCanceled=!0,e.mySplitMovementStopWhenVerticalMovementCanceled=!0,e.myHorizontalMovementCheckEnabled=!0,e.myHorizontalMovementRadialStepAmount=1,e.myHorizontalMovementCheckDiagonalOutward=!0,e.myHorizontalMovementCheckDiagonalInward=!0,e.myHorizontalMovementCheckVerticalDiagonalUpwardOutward=!0,e.myHorizontalMovementCheckVerticalDiagonalUpwardInward=!0,e.myHorizontalPositionCheckEnabled=!0,e.myHalfConeAngle=180,e.myHalfConeSliceAmount=3,e.myCheckConeBorder=!0,e.myCheckConeRay=!0,e.myHorizontalPositionCheckVerticalIgnoreHitsInsideCollision=!1,e.myHorizontalPositionCheckVerticalDirectionType=0,e.myHeight=e.myRadius,e.myPositionOffsetLocal.vec3_set(0,-e.myRadius/2,0),e.myCheckHeight=!0,e.myCheckHeightVerticalMovement=!0,e.myCheckHeightVerticalPosition=!0,e.myHeightCheckStepAmountMovement=2,e.myHeightCheckStepAmountPosition=2,e.myCheckHeightTopMovement=!0,e.myCheckHeightTopPosition=!0,e.myCheckVerticalStraight=!0,e.myCheckVerticalFixedForwardEnabled=!0,e.myCheckVerticalFixedForward=m(0,0,1),e.myCheckHorizontalFixedForwardEnabled=!0,e.myCheckHorizontalFixedForward=m(0,0,1),e.myVerticalMovementCheckEnabled=!0,e.myVerticalPositionCheckEnabled=!0,e.myGroundCircumferenceAddCenter=!0,e.myGroundCircumferenceSliceAmount=6,e.myGroundCircumferenceStepAmount=2,e.myGroundCircumferenceRotationPerStep=30,e.myFeetRadius=e.myRadius,e.myHorizontalBlockLayerFlags.copy(this._myParams.myHeadCollisionBlockLayerFlags),e.myHorizontalObjectsToIgnore.pp_copy(this._myParams.myHeadCollisionObjectsToIgnore),e.myVerticalBlockLayerFlags.copy(this._myParams.myHeadCollisionBlockLayerFlags),e.myVerticalObjectsToIgnore.pp_copy(this._myParams.myHeadCollisionObjectsToIgnore),e.myDebugEnabled=!1,e.myDebugHorizontalMovementEnabled=!0,e.myDebugHorizontalPositionEnabled=!1,e.myDebugVerticalMovementEnabled=!1,e.myDebugVerticalPositionEnabled=!1,e.myDebugSlidingEnabled=!1,e.myDebugGroundInfoEnabled=!1,e.myDebugCeilingInfoEnabled=!1,e.myDebugRuntimeParamsEnabled=!1,e.myDebugMovementEnabled=!1}_generateTeleportParamsFromMovementParams(){this._myParams.myTeleportCollisionCheckParams==null&&(this._myParams.myTeleportCollisionCheckParams=new Ae),this._myParams.myTeleportCollisionCheckParamsCheck360?this._myParams.myTeleportCollisionCheckParams=Bi.generate360TeleportParamsFromMovementParams(this._myParams.myMovementCollisionCheckParams,this._myParams.myTeleportCollisionCheckParams):this._myParams.myTeleportCollisionCheckParams.copy(this._myParams.myMovementCollisionCheckParams)}_generateRealMovementParamsFromMovementParams(){this._myRealMovementCollisionCheckParams==null&&(this._myRealMovementCollisionCheckParams=new Ae);let e=this._myRealMovementCollisionCheckParams;e.copy(this._myParams.myMovementCollisionCheckParams),e.mySplitMovementEnabled=!0,e.mySplitMovementMaxLength=.5,e.mySplitMovementMaxStepsEnabled=!0,e.mySplitMovementMaxSteps=2,e.mySplitMovementStopWhenHorizontalMovementCanceled=!0,e.mySplitMovementStopWhenVerticalMovementCanceled=!0,e.mySlidingEnabled=!1,this._myParams.myRealMovementAllowVerticalAdjustments||(e.mySnapOnGroundEnabled=!1,e.mySnapOnCeilingEnabled=!1,e.myGroundPopOutEnabled=!1,e.myCeilingPopOutEnabled=!1,e.myAdjustVerticalMovementWithGroundAngleDownhill=!1,e.myAdjustVerticalMovementWithGroundAngleUphill=!1,e.myAdjustVerticalMovementWithCeilingAngleDownhill=!1,e.myAdjustVerticalMovementWithCeilingAngleUphill=!1,e.myAdjustHorizontalMovementWithGroundAngleDownhill=!1,e.myAdjustHorizontalMovementWithCeilingAngleDownhill=!1,e.myVerticalMovementReduceEnabled=!1),e.myIsOnGroundIfInsideHit=!0,e.myDebugEnabled=!1,e.myDebugHorizontalMovementEnabled=!1,e.myDebugHorizontalPositionEnabled=!1,e.myDebugVerticalMovementEnabled=!1,e.myDebugVerticalPositionEnabled=!1,e.myDebugSlidingEnabled=!1,e.myDebugGroundInfoEnabled=!0,e.myDebugCeilingInfoEnabled=!0,e.myDebugRuntimeParamsEnabled=!1,e.myDebugMovementEnabled=!1}_onXRSessionStart(e,t){this._myParams.myResetToValidOnEnterSession&&(this._myResetRealOnSynced=!0)}_onXRSessionEnd(){this._myParams.myResetToValidOnExitSession&&(this._myResetRealOnSynced=!0)}_debugUpdate(e){r.getDebugVisualManager(this._myParams.myEngine).drawPoint(0,this._myValidPosition,w(1,0,0,1),.05),r.getDebugVisualManager(this._myParams.myEngine).drawLineEnd(0,this._myValidPosition,this.getPositionReal(),w(1,0,0,1),.05),r.getDebugVisualManager(this._myParams.myEngine).drawLine(0,this._myValidPosition,this._myValidRotationQuat.quat_getForward(),.15,w(0,1,0,1),.025),r.getDebugVisualManager(this._myParams.myEngine).drawPoint(0,this._myValidPositionHead,w(1,1,0,1),.05)}};mt.prototype.getDistanceToReal=function(){let i=m();return function(){return i=this.getPositionReal(i),i.vec3_distance(this.getPosition())}}();mt.prototype.getDistanceToRealHead=function(){let i=m();return function(){return i=this.getPositionHeadReal(i),i.vec3_distance(this.getPositionHead())}}();mt.prototype.resetReal=function(){let i=m(),e=m(),t=m(),n=z();return function(s=!0,a=!0,l=!0,h=!1){let _=this.getPlayerHeadManager();s&&_.teleportPositionFeet(this.getPosition(t)),i=this.getPlayerHeadManager().getRotationFeetQuat(n).quat_getUp(i),e=this.getRotationQuat(n).quat_getUp(e),(a||i.vec3_angle(e)>Math.PP_EPSILON_DEGREES&&this._myParams.myResetRealResetRotationIfUpChanged)&&_.setRotationFeetQuat(this.getRotationQuat(n),!1),l&&_.setHeight(this.getHeight(),!0),h&&this._updateReal(0,!1)}}();mt.prototype.update=function(){let i=j(),e=new re,t=m(),n=m(),o=z();return function(a){if(this._myResetRealOnSynced&&this.getPlayerHeadManager().isSynced()&&(this._myResetRealOnSynced=!1,B.isSessionActive(this._myParams.myEngine)?this.resetReal(!this._myParams.myNeverResetRealPositionVR,!this._myParams.myNeverResetRealRotationVR,!this._myParams.myNeverResetRealHeightVR,!1):this.resetReal(!this._myParams.myNeverResetRealPositionNonVR,!this._myParams.myNeverResetRealRotationNonVR,!this._myParams.myNeverResetRealHeightNonVR,!1)),this._updateReal(a),this._myParams.myUpdatePositionValid){i=this.getTransformQuat(i),t=i.quat2_getUp(t),o=i.quat2_getRotationQuat(o),n=this._myLastValidMovementDirection.vec3_removeComponentAlongAxis(t,n),n.vec3_isZero(1e-5)||(n.vec3_normalize(n),o.quat_setForward(n),i.quat2_setRotationQuat(o));let l=this._myParams.myMovementCollisionCheckParams.myDebugEnabled;this._myParams.myMovementCollisionCheckParams.myDebugEnabled=!1,fe(this._myParams.myEngine).positionCheck(!0,i,this._myParams.myMovementCollisionCheckParams,e),this._myParams.myMovementCollisionCheckParams.myDebugEnabled=l,this._myIsPositionValid=e.myIsPositionOk}this._myParams.myDebugEnabled&&r.isDebugEnabled(this._myParams.myEngine)&&this._debugUpdate(a)}}();mt.prototype._updateReal=function(){let i=m(),e=m(),t=m(),n=j(),o=new re,s=m(),a=m(),l=m(),h=m(),_=m(),y=m(),c=m(),d=m(),g=j(),P=m(),T=z();return function(x,D=!0){if(this.getPlayerHeadManager().isSynced()){if(this._updateCollisionHeight(),this._myIsBodyColliding=!1,this._myIsHeadColliding=!1,this._myIsLeaning=!1,this._myIsHopping=!1,this._myIsFar=!1,i=this.getPositionReal(t).vec3_sub(this.getPosition(e),i),i.vec3_length()>1e-4&&(this._myLastValidMovementDirection=i.vec3_normalize(this._myLastValidMovementDirection)),this._myParams.mySyncEnabledFlagMap.get(le.FAR)&&(this._myParams.myMaxDistanceFromRealToSyncEnabled&&i.vec3_length()>this._myParams.myMaxDistanceFromRealToSync?this._myIsFar=!0:this._myParams.myIsFarExtraCheckCallback!=null&&this._myParams.myIsFarExtraCheckCallback(this)&&(this._myIsFar=!0)),o.copy(this._myCollisionRuntimeParams),o.myIsOnGround=!0,n=this.getTransformQuat(n),s.vec3_copy(this._myValidPosition),this._myParams.mySyncEnabledFlagMap.get(le.BODY_COLLIDING)&&(fe(this._myParams.myEngine).move(i,n,this._myRealMovementCollisionCheckParams,o),!o.myHorizontalMovementCanceled&&!o.myVerticalMovementCanceled?Math.pp_clamp(this._myRealMovementCollisionCheckParams.myHeight,this._myParams.myIsBodyCollidingWhenHeightBelowValue,this._myParams.myIsBodyCollidingWhenHeightAboveValue)!=this._myRealMovementCollisionCheckParams.myHeight?this._myIsBodyColliding=!0:this._myParams.myIsBodyCollidingExtraCheckCallback!=null&&this._myParams.myIsBodyCollidingExtraCheckCallback(this)?this._myIsBodyColliding=!0:(this._myIsBodyColliding=!1,s.vec3_copy(o.myNewPosition)):this._myIsBodyColliding=!0),this._myParams.mySyncEnabledFlagMap.get(le.FLOATING)&&(this._myIsBodyColliding?i=t.vec3_sub(e,i):i=s.vec3_sub(e,i),o.copy(this._myCollisionRuntimeParams),g.quat2_setPositionRotationQuat(this._myValidPosition,this._myValidRotationQuat),fe(this._myParams.myEngine).updateSurfaceInfo(g,this._myRealMovementCollisionCheckParams,o),o.myIsOnGround)){_=n.quat2_getUp(_),y=i.vec3_componentAlongAxis(_,y);let E=!y.vec3_isZero(1e-5);if(!E||!this._myParams.myIsFloatingValidIfVerticalMovement){let S=1;if(l.vec3_copy(i),!i.vec3_isZero(1e-5)&&this._myParams.myFloatingSplitCheckEnabled){let Z=i.vec3_length()/this._myParams.myFloatingSplitCheckMaxSteps;if(!this._myParams.myFloatingSplitCheckStepEqualLength||Z<this._myParams.myFloatingSplitCheckStepEqualLengthMinLength){let ne=this._myParams.myFloatingSplitCheckStepEqualLength?this._myParams.myFloatingSplitCheckStepEqualLengthMinLength:this._myParams.myFloatingSplitCheckMaxLength;S=Math.ceil(i.vec3_length()/ne),S>1&&(l=l.vec3_normalize(l).vec3_scale(ne,l),S=this._myParams.myFloatingSplitCheckMaxSteps!=null?Math.min(S,this._myParams.myFloatingSplitCheckMaxSteps):S),S=Math.max(1,S),S==1&&l.vec3_copy(i)}else S=this._myParams.myFloatingSplitCheckMaxSteps,S>1&&(l=l.vec3_normalize(l).vec3_scale(Z,l))}let b=o.myGroundAngle<=this._myRealMovementCollisionCheckParams.myGroundAngleToIgnore+1e-4;c.vec3_zero(),d.vec3_copy(this._myValidPosition),o.copy(this._myCollisionRuntimeParams);let v=!1,I=!1,L=!1,F=!1;for(let Z=0;Z<S;Z++)S==1||Z!=S-1?h.vec3_copy(l):h=i.vec3_sub(c,h),d=d.vec3_add(h,d),g.quat2_setPositionRotationQuat(d,this._myValidRotationQuat),o.copy(this._myCollisionRuntimeParams),fe(this._myParams.myEngine).updateSurfaceInfo(g,this._myRealMovementCollisionCheckParams,o),c=c.vec3_add(h,c),o.myIsOnGround?(o.myGroundAngle>this._myRealMovementCollisionCheckParams.myGroundAngleToIgnore+1e-4&&(F=!0),v&&(I=!0),Z==S-1&&(L=!0)):v=!0;let Q=F&&b&&!this._myParams.myIsFloatingValidIfSteepGround&&(!E||!this._myParams.myIsFloatingValidIfVerticalMovementAndSteepGround);if(v||Q?I?this._myIsHopping=!0:this._myIsLeaning=!0:(this._myIsLeaning=!1,this._myIsHopping=!1,this._myParams.myIsLeaningExtraCheckCallback!=null&&this._myParams.myIsLeaningExtraCheckCallback(this)?this._myIsLeaning=!0:this._myParams.myIsHoppingExtraCheckCallback!=null&&this._myParams.myIsHoppingExtraCheckCallback(this)&&(this._myIsHopping=!0)),this._myIsLeaning){let Z=i.vec3_length();this._myParams.myIsLeaningValidAboveDistance&&Z>this._myParams.myLeaningValidDistance&&(this._myIsLeaning=!1)}(this._myIsLeaning||this._myIsHopping)&&(L&&this._myParams.myIsFloatingValidIfRealOnGround?(this._myIsLeaning=!1,this._myIsHopping=!1):L&&E&&this._myParams.myIsFloatingValidIfVerticalMovementAndRealOnGround&&(this._myIsLeaning=!1,this._myIsHopping=!1))}}if(i=this.getPositionHeadReal(t).vec3_sub(this.getPositionHead(e),i),o.reset(),n=this.getTransformHeadQuat(n),a.vec3_copy(this._myValidPositionHead),this._myParams.mySyncEnabledFlagMap.get(le.HEAD_COLLIDING)&&(fe(this._myParams.myEngine).move(i,n,this._myHeadCollisionCheckParams,o),!o.myHorizontalMovementCanceled&&!o.myVerticalMovementCanceled?(this._myIsHeadColliding=!1,a.vec3_copy(o.myNewPosition)):this._myIsHeadColliding=!0),this.isSynced(this._myParams.mySyncPositionFlagMap)&&!this._myParams.mySyncPositionDisabled&&this._myValidPosition.vec3_copy(s),this.isSynced(this._myParams.mySyncPositionHeadFlagMap)&&(this._myValidPositionHead=this.getPositionHeadReal(a)),this.isSynced(this._myParams.mySyncRotationFlagMap)&&(this._myValidRotationQuat=this.getRotationRealQuat(this._myValidRotationQuat)),this.isSynced(this._myParams.mySyncHeightFlagMap)&&(this._myValidHeight=this._myRealMovementCollisionCheckParams.myHeight,this._updateCollisionHeight()),D)if(B.isSessionActive(this._myParams.myEngine)){let E=(this.isSynced(this._myParams.mySyncPositionFlagMap)||this._myParams.myAlwaysResetRealPositionVR)&&!this._myParams.myNeverResetRealPositionVR,S=(this.isSynced(this._myParams.mySyncRotationFlagMap)||this._myParams.myAlwaysResetRealRotationVR)&&!this._myParams.myNeverResetRealRotationVR,b=(this.isSynced(this._myParams.mySyncHeightFlagMap)||this._myParams.myAlwaysResetRealHeightVR)&&!this._myParams.myNeverResetRealHeightVR;this.resetReal(E,S,b,!1)}else{let E=(this.isSynced(this._myParams.mySyncPositionFlagMap)||this._myParams.myAlwaysResetRealPositionNonVR)&&!this._myParams.myNeverResetRealPositionNonVR,S=(this.isSynced(this._myParams.mySyncRotationFlagMap)||this._myParams.myAlwaysResetRealRotationNonVR)&&!this._myParams.myNeverResetRealRotationNonVR,b=(this.isSynced(this._myParams.mySyncHeightFlagMap)||this._myParams.myAlwaysResetRealHeightNonVR)&&!this._myParams.myNeverResetRealHeightNonVR;this.resetReal(E,S,b,!1)}if(this._myParams.myUpdateRealPositionValid){n=this.getTransformRealQuat(n),_=n.quat2_getUp(_),T=n.quat2_getRotationQuat(T),P=this._myLastValidMovementDirection.vec3_removeComponentAlongAxis(_,P),P.vec3_isZero(1e-5)||(P.vec3_normalize(P),T.quat_setForward(P),n.quat2_setRotationQuat(T));let E=this._myParams.myMovementCollisionCheckParams.myDebugEnabled;this._myParams.myMovementCollisionCheckParams.myDebugEnabled=!1,fe(this._myParams.myEngine).positionCheck(!0,n,this._myParams.myMovementCollisionCheckParams,this._myRealCollisionRuntimeParams),this._myIsRealPositionValid=this._myRealCollisionRuntimeParams.myIsPositionOk,this._myParams.myMovementCollisionCheckParams.myDebugEnabled=E}}}}();mt.prototype.move=function(){let i=j(),e=m();return function(n,o=null,s=!1){i=this.getTransformQuat(i),fe(this._myParams.myEngine).move(n,i,this._myParams.myMovementCollisionCheckParams,this._myCollisionRuntimeParams),o?.copy(this._myCollisionRuntimeParams),s?e.vec3_copy(n):e.vec3_copy(this._myCollisionRuntimeParams.myFixedMovement),e.vec3_isZero(1e-5)||(this._myValidPosition.vec3_add(e,this._myValidPosition),this.getPlayerHeadManager().moveFeet(e)),this._myParams.myResetRealOnMove&&(this.isSynced()||(B.isSessionActive(this._myParams.myEngine)?this.resetReal(!this._myParams.myNeverResetRealPositionVR,!this._myParams.myNeverResetRealRotationVR,!this._myParams.myNeverResetRealHeightVR,!1):this.resetReal(!this._myParams.myNeverResetRealPositionNonVR,!this._myParams.myNeverResetRealRotationNonVR,!this._myParams.myNeverResetRealHeightNonVR,!1)))}}();mt.prototype.teleportPosition=function(){let i=j();return function(e,t=null,n=!1){i=this.getTransformQuat(i),i.quat2_setPosition(e),this.teleportTransformQuat(i,t,n)}}();mt.prototype.teleportTransformQuat=function(){let i=m(),e=m(),t=z(),n=j(),o=m();return function(s,a=null,l=!1){i=this.getPosition(i),e=s.quat2_getPosition(e),t=s.quat2_getRotationQuat(t),n.quat2_setPositionRotationQuat(i,t),fe(this._myParams.myEngine).teleport(e,n,this._myParams.myTeleportCollisionCheckParams,this._myCollisionRuntimeParams),a?.copy(this._myCollisionRuntimeParams),o.vec3_zero(),l?(o=e.vec3_sub(i,o),this.getPlayerHeadManager().setRotationFeetQuat(t)):this._myCollisionRuntimeParams.myTeleportCanceled||(o=this._myCollisionRuntimeParams.myFixedTeleportPosition.vec3_sub(i,o),this.getPlayerHeadManager().setRotationFeetQuat(t)),o.vec3_isZero(1e-5)||(this._myValidPosition.vec3_add(o,this._myValidPosition),this.getPlayerHeadManager().moveFeet(o)),this._myParams.myResetRealOnTeleport&&(this.isSynced()||(B.isSessionActive(this._myParams.myEngine)?this.resetReal(!this._myParams.myNeverResetRealPositionVR,!this._myParams.myNeverResetRealRotationVR,!this._myParams.myNeverResetRealHeightVR,!1):this.resetReal(!this._myParams.myNeverResetRealPositionNonVR,!this._myParams.myNeverResetRealRotationNonVR,!this._myParams.myNeverResetRealHeightNonVR,!1)))}}();mt.prototype.rotateQuat=function(){return function(e){this._myValidRotationQuat.quat_rotateQuat(e,this._myValidRotationQuat),this.getPlayerHeadManager().rotateFeetQuat(e)}}();mt.prototype.setRotationQuat=function(){let i=z();return function(t){i=this._myValidRotationQuat.quat_rotationToQuat(t,i),this.rotateQuat(i)}}();mt.prototype.setHeight=function(){let i=j();return function(t,n=!1){let o=Math.pp_clamp(t,this._myParams.myMinHeight,this._myParams.myMaxHeight),s=this.getHeight();this._myValidHeight=o,this._updateCollisionHeight(),i=this.getTransformQuat(i),fe(this._myParams.myEngine).positionCheck(!0,i,this._myParams.myMovementCollisionCheckParams,this._myCollisionRuntimeParams),this._myCollisionRuntimeParams.myIsPositionOk||n?this.getPlayerHeadManager().setHeight(this.getHeight(),!0):this._myValidHeight=s,this._updateCollisionHeight()}}();dt.prototype._isTeleportPositionVisible=function(){let i=m(),e=m(),t=m();return function(o){let s=!0;if(this._myTeleportParams.myDetectionParams.myTeleportFeetPositionMustBeVisible||this._myTeleportParams.myDetectionParams.myTeleportHeadPositionMustBeVisible||this._myTeleportParams.myDetectionParams.myTeleportHeadOrFeetPositionMustBeVisible){i=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(i);let a=!1,l=!1;if(this._myTeleportParams.myDetectionParams.myTeleportHeadOrFeetPositionMustBeVisible||this._myTeleportParams.myDetectionParams.myTeleportHeadPositionMustBeVisible){let h=this._myTeleportParams.myPlayerHeadManager.getHeightHead();t=o.vec3_add(i.vec3_scale(h,t),t),a=this._isPositionVisible(t)}else a=!0;this._myTeleportParams.myDetectionParams.myTeleportHeadOrFeetPositionMustBeVisible&&a?l=!0:this._myTeleportParams.myDetectionParams.myTeleportHeadOrFeetPositionMustBeVisible||this._myTeleportParams.myDetectionParams.myTeleportFeetPositionMustBeVisible&&a?(e=o.vec3_add(i.vec3_scale(this._myTeleportParams.myDetectionParams.myVisibilityCheckFeetPositionVerticalOffset,e),e),l=this._isPositionVisible(e)):l=!0,s=a&&l}return s}}();dt.prototype._isPositionVisible=function(){let i=m(),e=m(0,1,0),t=m(0,0,1),n=m(),o=m(),s=m(),a=m(),l=m(),h=m(),_=m(),y=new ct,c=new Le,d=(g,P)=>g.pp_equals(P);return function(P){let T=!0;i=this._myTeleportParams.myPlayerHeadManager.getPlayer().pp_getUp(i),o=this._myTeleportParams.myPlayerHeadManager.getHead().pp_getPosition(o),s=P.vec3_sub(o,s).vec3_normalize(s),n.vec3_copy(e),s.vec3_angle(e)<1e-4&&n.vec3_copy(t),a=s.vec3_cross(n,a),h=a.vec3_cross(s,h),l.vec3_copy(s),h.vec3_normalize(h),l.vec3_normalize(l);let x=this._getVisibilityCheckPositions(o,h,l),D=o.vec3_distance(P);for(let E of x){y.myOrigin.vec3_copy(E),y.myDirection.vec3_copy(l),y.myDistance=D,y.myPhysics=r.getPhysics(this._myTeleportParams.myEngine),y.myBlockLayerFlags.setMask(this._myTeleportParams.myDetectionParams.myVisibilityBlockLayerFlags.getMask()),y.myObjectsToIgnore.pp_copy(this._myTeleportParams.myCollisionCheckParams.myHorizontalObjectsToIgnore);for(let S of this._myTeleportParams.myCollisionCheckParams.myVerticalObjectsToIgnore)y.myObjectsToIgnore.pp_pushUnique(S,d);if(y.myIgnoreHitsInsideCollision=!0,c=Me.raycast(y,c),this._myTeleportParams.myDebugEnabled&&this._myTeleportParams.myDebugVisibilityEnabled&&r.isDebugEnabled(this._myTeleportParams.myEngine)&&r.getDebugVisualManager(this._myTeleportParams.myEngine).drawRaycast(0,c),c.isColliding()){_=E.vec3_add(l.vec3_scale(D,_),_);let S=c.myHits.pp_first();if(this._myTeleportParams.myDetectionParams.myVisibilityCheckDistanceFromHitThreshold==0||S.myPosition.vec3_distance(_)>this._myTeleportParams.myDetectionParams.myVisibilityCheckDistanceFromHitThreshold+1e-5){T=!1;break}}}return T}}();dt.prototype._getVisibilityCheckPositions=function(){let i=[],e=[],t=0,n=function(){let s=null;for(;e.length<=t;)e.push(m());return s=e[t],t++,s},o=m();return function(a,l,h){i.length=0,t=0;{let d=n();d.vec3_copy(a),i.push(d)}let _=this._myTeleportParams.myDetectionParams.myVisibilityCheckRadius/this._myTeleportParams.myDetectionParams.myVisibilityCheckCircumferenceStepAmount,y=360/this._myTeleportParams.myDetectionParams.myVisibilityCheckCircumferenceSliceAmount,c=0;for(let d=0;d<this._myTeleportParams.myDetectionParams.myVisibilityCheckCircumferenceStepAmount;d++){let g=_*(d+1);o=l.vec3_rotateAxis(c,h,o);for(let P=0;P<this._myTeleportParams.myDetectionParams.myVisibilityCheckCircumferenceSliceAmount;P++){let T=n(),C=o.vec3_rotateAxis(y*P,h,T);i.push(a.vec3_add(C.vec3_scale(g,C),C))}c+=this._myTeleportParams.myDetectionParams.myVisibilityCheckCircumferenceRotationPerStep}return i}}();import{Collider as nA,CollisionComponent as oA,Component as sA,Property as ga}from"@wonderlandengine/api";import{CursorTarget as aA}from"@wonderlandengine/components";var Si=class extends sA{init(){this._myLastTarget=null,this._myHandInputSource=null,this._myHandednessType=ee.getHandednessByIndex(this._myHandedness),this._myDoubleClickTimer=0,this._myTripleClickTimer=0,this._myMultipleClickObject=null,this._myMultipleClickDelay=.3}start(){this._myCursorParentObject=this.object.pp_addObject(),this._myCursorObject==null?this._myCursorObject=this._myCursorParentObject.pp_addObject():this._myCursorObject.pp_setParent(this._myCursorParentObject),this._myCollisionComponent=this._myCursorObject.pp_addComponent(oA),this._myCollisionComponent.collider=nA.Sphere,this._myCollisionComponent.group=1<<this._myCollisionGroup,this._myCollisionComponent.extents=m(this._myCollisionSize,this._myCollisionSize,this._myCollisionSize)}update(e){if(this._myDoubleClickTimer>0&&(this._myDoubleClickTimer-=e),this._myTripleClickTimer>0&&(this._myTripleClickTimer-=e),this._myCursorParentObject.pp_setTransformQuat(r.getPlayerObjects(this.engine).myPlayerPivot.pp_getTransformQuat()),this._updateHand(),this._myHandInputSource){let t=this._myCollisionComponent.queryOverlaps(),n=null;for(let o=0;o<t.length;++o){let a=t[o].object.pp_getComponent(aA);if(a&&(n==null||!a.isSurface)&&(n=a,!a.isSurface))break}n?n.equals(this._myLastTarget)||(this._targetTouchEnd(),this._myLastTarget=n,this._targetTouchStart()):this._targetTouchEnd()}else this._targetTouchEnd()}_targetTouchStart(){this._myLastTarget.onHover.notify(this._myLastTarget.object,this),this._myLastTarget.onDown.notify(this._myLastTarget.object,this)}_targetTouchEnd(){this._myLastTarget&&(this._myMultipleClicksEnabled&&this._myTripleClickTimer>0&&this._myMultipleClickObject&&this._myMultipleClickObject.pp_equals(this._myLastTarget.object)?(this._myLastTarget.onTripleClick.notify(this._myLastTarget.object,this),this._myTripleClickTimer=0):this._myMultipleClicksEnabled&&this._myDoubleClickTimer>0&&this._myMultipleClickObject&&this._myMultipleClickObject.pp_equals(this._myLastTarget.object)?(this._myLastTarget.onDoubleClick.notify(this._myLastTarget.object,this),this._myTripleClickTimer=this._myMultipleClickDelay,this._myDoubleClickTimer=0):(this._myLastTarget.onClick.notify(this._myLastTarget.object,this),this._myTripleClickTimer=0,this._myDoubleClickTimer=this._myMultipleClickDelay,this._myMultipleClickObject=this._myLastTarget.object),this._myLastTarget.onUp.notify(this._myLastTarget.object,this),this._myLastTarget.onUnhover.notify(this._myLastTarget.object,this),this._myLastTarget=null)}onActivate(){this._myCursorParentObject.pp_setActive(!0)}onDeactivate(){this._myCursorParentObject.pp_setActive(!1)}_updateHand(){if(this._myHandInputSource=ee.getInputSource(this._myHandednessType,$e.TRACKED_HAND,this.engine),this._myHandInputSource){let e=B.getFrame(this.engine).getJointPose(this._myHandInputSource.hand.get(at.INDEX_FINGER_TIP),B.getReferenceSpace(this.engine));e&&(this._myCursorObject.pp_setRotationLocalQuat([e.transform.orientation.x,e.transform.orientation.y,e.transform.orientation.z,e.transform.orientation.w]),this._myCursorObject.pp_setPositionLocal([e.transform.position.x,e.transform.position.y,e.transform.position.z]))}}};R(Si,"TypeName","pp-finger-cursor"),R(Si,"Properties",{_myHandedness:ga.enum(["Left","Right"],"Left"),_myMultipleClicksEnabled:ga.bool(!0),_myCollisionGroup:ga.int(1),_myCollisionSize:ga.float(.0125),_myCursorObject:ga.object(null)});import{Component as rA,Property as pm}from"@wonderlandengine/api";var An=class extends rA{start(){this._myHandednessType=ee.getHandednessByIndex(this._myHandedness),this._myFirstUpdate=!0,this._myCurrentInputSourceType=null}onActivate(){this._myFirstUpdate=!0}update(e){this._myFirstUpdate&&(this._myFirstUpdate=!1,this._start());let t=ee.getInputSourceTypeByHandedness(this._myHandednessType,this.engine);t!=null&&this._myCurrentInputSourceType!=t&&(this._myCurrentInputSourceType=t,t==$e.TRACKED_HAND?(this._myGamepad!=null&&this._myGamepad.pp_setActive(!1),this._myTrackedHand!=null&&this._myTrackedHand.pp_setActive(!0)):t==$e.GAMEPAD&&(this._myTrackedHand!=null&&this._myTrackedHand.pp_setActive(!1),this._myGamepad!=null&&this._myGamepad.pp_setActive(!0)))}_start(){this._myGamepad!=null&&this._myGamepad.pp_setActive(!1),this._myTrackedHand!=null&&this._myTrackedHand.pp_setActive(!1),this._myCurrentInputSourceType=null}};R(An,"TypeName","pp-switch-hand-object"),R(An,"Properties",{_myHandedness:pm.enum(["Left","Right"],"Left"),_myGamepad:pm.object(),_myTrackedHand:pm.object()});import{Component as lA,MeshComponent as mA,Property as Kr}from"@wonderlandengine/api";var ii=class extends lA{start(){this._myHandednessType=ee.getHandednessByIndex(this._myHandedness),this._myJointIDType=ee.getJointIDByIndex(this._myJointID),this._buildTrackedHandHierarchy()}update(e){}_buildTrackedHandHierarchy(){this._myJointMeshObject=this.object.pp_addObject();let e=this._myJointMeshObject.pp_addComponent(mA);e.mesh=this._myJointMesh,e.material=this._myJointMaterial,this._myJointMeshObject.pp_setScaleLocal(0)}};R(ii,"TypeName","pp-tracked-hand-draw-joint"),R(ii,"Properties",{_myHandedness:Kr.enum(["Left","Right"],"Left"),_myJointID:Kr.enum(["Wrist","Thumb Metacarpal","Thumb Phalanx Proximal","Thumb Phalanx Distal","Thumb Tip","Index Metacarpal","Index Phalanx Proximal","Index Phalanx Intermediate","Index Phalanx Distal","Index Tip","Middle Metacarpal","Middle Phalanx Proximal","Middle Phalanx Intermediate","Middle Phalanx Distal","Middle Tip","Ring Metacarpal","Ring Phalanx Proximal","Ring Phalanx Intermediate","Ring Phalanx Distal","Ring Tip","Pinky Metacarpal","Pinky Phalanx Proximal","Pinky Phalanx Intermediate","Pinky Phalanx Distal","Pinky Tip"],"Wrist"),_myJointMesh:Kr.mesh(),_myJointMaterial:Kr.material()});ii.prototype.update=function(){let i=j();return function(t){let n=r.getTrackedHandPose(this._myHandednessType).getJointPose(this._myJointIDType);this._myJointMeshObject.pp_setTransformLocalQuat(n.getTransformQuat(i,null)),this._myJointMeshObject.pp_setScaleLocal(n.getJointRadius())}}();import{Component as yA,Property as Jr}from"@wonderlandengine/api";var Vn=class extends yA{start(){this._buildTrackedHandHierarchy()}_buildTrackedHandHierarchy(){this._myTrackedHandMeshObject=this.object.pp_addObject(),this._myJointMeshObjectList=[];for(let e in at){let t=at[e];if(!this._myHideMetacarpals||t!=at.THUMB_METACARPAL&&t!=at.INDEX_FINGER_METACARPAL&&t!=at.MIDDLE_FINGER_METACARPAL&&t!=at.RING_FINGER_METACARPAL&&t!=at.PINKY_FINGER_METACARPAL){let n=this._myTrackedHandMeshObject.pp_addObject();this._myJointMeshObjectList[t]=n,n.pp_addComponent(ii,{_myHandedness:this._myHandedness,_myJointID:jo[e],_myJointMesh:this._myJointMesh,_myJointMaterial:this._myJointMaterial})}}}};R(Vn,"TypeName","pp-tracked-hand-draw-all-joints"),R(Vn,"Properties",{_myHandedness:Jr.enum(["Left","Right"],"Left"),_myHideMetacarpals:Jr.bool(!0),_myJointMesh:Jr.mesh(),_myJointMaterial:Jr.material()});import{Component as uA,Property as NT}from"@wonderlandengine/api";var Wi=class extends uA{start(){this._myHandednessType=ee.getHandednessByIndex(this._myHandedness),this._prepareJoints()}update(e){}_prepareJoints(){this._myJoints=[];let e=this._myHandSkin.jointIds;for(let t=0;t<e.length;t++)this._myJoints[t]=u.wrapObject(e[t])}};R(Wi,"TypeName","pp-tracked-hand-draw-skin"),R(Wi,"Properties",{_myHandedness:NT.enum(["Left","Right"],"Left"),_myHandSkin:NT.skin(null)});Wi.prototype.update=function(){let i=j();return function(t){for(let n=0;n<this._myJoints.length;n++){let o=this._myJoints[n],s=o.pp_getName(),a=r.getTrackedHandPose(this._myHandednessType).getJointPose(s);o.pp_setTransformLocalQuat(a.getTransformQuat(i,null))}}}();import{Component as hA,Property as Tt}from"@wonderlandengine/api";var Qi=class extends hA{start(){let e=null;this._myHandedness==Gi.LEFT?e=r.getLeftGamepad(this.engine):e=r.getRightGamepad(this.engine),this._mySelect!=null&&(this._mySelectOriginalRotation=this._mySelect.pp_getRotationLocalQuat(),this._mySelectOriginalLeft=this._mySelect.pp_getLeftLocal()),this._mySqueeze!=null&&(this._mySqueezeOriginalPosition=this._mySqueeze.pp_getPositionLocal(),this._mySqueezeOriginalRotation=this._mySqueeze.pp_getRotationLocalQuat(),this._mySqueezeOriginalLeft=this._mySqueeze.pp_getLeftLocal(),this._mySqueezeOriginalForward=this._mySqueeze.pp_getForwardLocal()),this._myThumbstick!=null&&(this._myThumbstickOriginalPosition=this._myThumbstick.pp_getPositionLocal(),this._myThumbstickOriginalRotation=this._myThumbstick.pp_getRotationLocalQuat(),this._myThumbstickOriginalLeft=this._myThumbstick.pp_getLeftLocal(),this._myThumbstickOriginalUp=this._myThumbstick.pp_getUpLocal(),this._myThumbstickOriginalForward=this._myThumbstick.pp_getForwardLocal()),this._myTopButton!=null&&(this._myTopButtonOriginalPosition=this._myTopButton.pp_getPositionLocal(),this._myTopButtonOriginalUp=this._myTopButton.pp_getUpLocal()),this._myBottomButton!=null&&(this._myBottomButtonOriginalPosition=this._myBottomButton.pp_getPositionLocal(),this._myBottomButtonOriginalUp=this._myBottomButton.pp_getUpLocal()),this._myThumbstick!=null&&(e.registerButtonEventListener(M.THUMBSTICK,ae.PRESS_START,this,this._thumbstickPressedStart.bind(this)),e.registerButtonEventListener(M.THUMBSTICK,ae.PRESS_END,this,this._thumbstickPressedEnd.bind(this))),this._myTopButton!=null&&(e.registerButtonEventListener(M.TOP_BUTTON,ae.PRESS_START,this,this._topButtonPressedStart.bind(this)),e.registerButtonEventListener(M.TOP_BUTTON,ae.PRESS_END,this,this._topButtonPressedEnd.bind(this))),this._myBottomButton!=null&&(e.registerButtonEventListener(M.BOTTOM_BUTTON,ae.PRESS_START,this,this._bottomButtonPressedStart.bind(this)),e.registerButtonEventListener(M.BOTTOM_BUTTON,ae.PRESS_END,this,this._bottomButtonPressedEnd.bind(this))),this._mySelect!=null&&e.registerButtonEventListener(M.SELECT,ae.VALUE_CHANGED,this,this._selectValueChanged.bind(this)),this._mySqueeze!=null&&e.registerButtonEventListener(M.SQUEEZE,ae.VALUE_CHANGED,this,this._squeezeValueChanged.bind(this)),this._myThumbstick!=null&&e.registerAxesEventListener(oe.THUMBSTICK,ai.AXES_CHANGED,this,this._thumbstickValueChanged.bind(this))}_thumbstickPressedStart(){}_thumbstickPressedEnd(e,t){this._myThumbstick.pp_setPositionLocal(this._myThumbstickOriginalPosition)}_topButtonPressedStart(e,t){this._myTopButton.pp_translateAxisLocal(-this._myTopButtonPressOffset,this._myTopButtonOriginalUp)}_topButtonPressedEnd(e,t){this._myTopButton.pp_setPositionLocal(this._myTopButtonOriginalPosition)}_bottomButtonPressedStart(e,t){this._myBottomButton.pp_translateAxisLocal(-this._myBottomButtonPressOffset,this._myBottomButtonOriginalUp)}_bottomButtonPressedEnd(e,t){this._myBottomButton.pp_setPositionLocal(this._myBottomButtonOriginalPosition)}_selectValueChanged(e,t){this._mySelect.pp_setRotationLocalQuat(this._mySelectOriginalRotation),e.getValue()>1e-5&&this._mySelect.pp_rotateAxisLocal(this._mySelectRotateAngle*e.getValue(),this._mySelectOriginalLeft)}_squeezeValueChanged(e,t){if(this._mySqueeze.pp_setPositionLocal(this._mySqueezeOriginalPosition),this._mySqueeze.pp_setRotationLocalQuat(this._mySqueezeOriginalRotation),e.getValue()>1e-5)if(this._myUsePressForSqueeze){let n=this._mySqueezePressOffset;this._myHandedness==1&&(n*=-1),this._mySqueeze.pp_translateAxisLocal(n*e.getValue(),this._mySqueezeOriginalLeft)}else{let n=-this._mySqueezeRotateAngle;this._myHandedness==1&&(n*=-1),this._mySqueeze.pp_rotateAxisLocal(n*e.getValue(),this._mySqueezeOriginalForward)}}_thumbstickValueChanged(e,t){this._myThumbstick.pp_setRotationLocalQuat(this._myThumbstickOriginalRotation);let n=this._myThumbstickRotateAngle*e.myAxes[1],o=this._myThumbstickRotateAngle*e.myAxes[0];Math.abs(n)>1e-4&&this._myThumbstick.pp_rotateAxisLocal(n,this._myThumbstickOriginalLeft),Math.abs(o)>1e-4&&this._myThumbstick.pp_rotateAxisLocal(o,this._myThumbstickOriginalForward)}};R(Qi,"TypeName","pp-gamepad-mesh-animator"),R(Qi,"Properties",{_myHandedness:Tt.enum(["Left","Right"],"Left"),_mySelect:Tt.object(null),_mySqueeze:Tt.object(null),_myThumbstick:Tt.object(null),_myTopButton:Tt.object(null),_myBottomButton:Tt.object(null),_mySelectRotateAngle:Tt.float(15),_mySqueezeRotateAngle:Tt.float(11),_myThumbstickRotateAngle:Tt.float(15),_myThumbstickPressOffset:Tt.float(625e-6),_myTopButtonPressOffset:Tt.float(.0015),_myBottomButtonPressOffset:Tt.float(.0015),_myUsePressForSqueeze:Tt.bool(!1),_mySqueezePressOffset:Tt.float(.0015)});Qi.prototype._thumbstickPressedStart=function(){let i=m();return function(t,n){this._myThumbstickOriginalUp.vec3_scale(-this._myThumbstickPressOffset,i),this._myThumbstick.pp_translateLocal(i)}}();var Zr=.15,Yr=.15;function GT(i){Zr=i}function UT(i){Yr=i}function WT(){return Zr}function QT(){return Yr}function qT(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let o of t)if(o.length==1)for(let s in M)o.push(M[s]);let n=!1;for(let o of t){let s=o[0];for(let a=1;a<o.length;a++){let l=o[a];if(s.getButtonInfo(l).isPressStart(e)){n=!0;break}}if(n)break}return n}function XT(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let s of t)if(s.length==1)for(let a in M)s.push(M[a]);let n=!0,o=!1;for(let s of t){let a=s[0];for(let l=1;l<s.length;l++){let h=s[l],_=a.getButtonInfo(h);if(!(_.myPressed&&(e==null||_.myMultiplePressStartCount==e)&&_.myTimePressed<Zr)){n=!1;break}_.isPressStart(e)&&(o=!0)}if(!n)break}return n&&o}function cA(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let o of t)if(o.length==1)for(let s in M)o.push(M[s]);let n=!1;for(let o of t){let s=o[0];for(let a=1;a<o.length;a++){let l=o[a];if(s.getButtonInfo(l).isPressEnd(e)){n=!0;break}}if(n)break}return n}function KT(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let s of t)if(s.length==1)for(let a in M)s.push(M[a]);let n=!0,o=!1;for(let s of t){let a=s[0];for(let l=1;l<s.length;l++){let h=s[l],_=a.getButtonInfo(h);if(!(!_.myPressed&&(e==null||_.myMultiplePressEndCount==e)&&_.myTimeNotPressed<Zr)){n=!1;break}_.isPressEnd(e)&&(o=!0)}if(!n)break}return n&&o}function JT(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let o of t)if(o.length==1)for(let s in M)o.push(M[s]);let n=!1;for(let o of t){let s=o[0];for(let a=1;a<o.length;a++){let l=o[a];if(s.getButtonInfo(l).isTouchStart(e)){n=!0;break}}if(n)break}return n}function ZT(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let s of t)if(s.length==1)for(let a in M)s.push(M[a]);let n=!0,o=!1;for(let s of t){let a=s[0];for(let l=1;l<s.length;l++){let h=s[l],_=a.getButtonInfo(h);if(!(_.myTouched&&(e==null||_.myMultipleTouchStartCount==e)&&_.myTimeTouched<Yr)){n=!1;break}_.isTouchStart(e)&&(o=!0)}if(!n)break}return n&&o}function YT(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let o of t)if(o.length==1)for(let s in M)o.push(M[s]);let n=!1;for(let o of t){let s=o[0];for(let a=1;a<o.length;a++){let l=o[a];if(s.getButtonInfo(l).isTouchEnd(e)){n=!0;break}}if(n)break}return n}function $T(...i){let e=null,t=i;isNaN(i[0])||(e=i[0],t=i.slice(1));for(let s of t)if(s.length==1)for(let a in M)s.push(M[a]);let n=!0,o=!1;for(let s of t){let a=s[0];for(let l=1;l<s.length;l++){let h=s[l],_=a.getButtonInfo(h);if(!(!_.myTouched&&(e==null||_.myMultipleTouchEndCount==e)&&_.myTimeNotTouched<Yr)){n=!1;break}_.isTouchEnd(e)&&(o=!0)}if(!n)break}return n&&o}var pA={setSimultaneousPressMaxDelay:GT,setSimultaneousTouchMaxDelay:UT,getSimultaneousPressMaxDelay:WT,getSimultaneousTouchMaxDelay:QT,isAnyButtonPressStart:qT,areButtonsPressStart:XT,areButtonsPressEnd:KT,isAnyButtonTouchStart:JT,areButtonsTouchStart:ZT,isAnyButtonTouchEnd:YT,areButtonsTouchEnd:$T};import{Alignment as dA,Component as _A,Justification as gA,MeshComponent as fA,Property as We,TextComponent as PA}from"@wonderlandengine/api";var On=class extends _A{start(){this._myTextMaterialFinal=this._myTextMaterial!=null?this._myTextMaterial:r.getDefaultMaterials(this.engine).myText.clone(),this._myLineMaterialFinal=this._myLineMaterial!=null?this._myLineMaterial:r.getDefaultMaterials(this.engine).myFlatOpaque.clone(),this._myHandednessType=ee.getHandednessByIndex(this._myHandedness),this._myControlSchemeDirection=this._myHandednessType==A.LEFT?1:-1,this._myVisible=!1,this._mySetVisibleNextUpdate=!1,this._createControlScheme(),this.setVisible(this._myShowOnStart),this._myVisibleBackup=this._myVisible}update(e){this._mySetVisibleNextUpdate&&(this._mySetVisibleNextUpdate=!1,this.setVisible(!1),this.setVisible(this._myVisibleBackup))}onActivate(){this._mySetVisibleNextUpdate=!0}onDeactivate(){this._myVisibleBackup=this._myVisible,this.setVisible(!1)}isVisible(){return this._myVisible}setVisible(e){this._myVisible=e,this._myParentObject!=null&&(this._myParentObject.pp_setActive(this._myVisible),this._myVisible&&this._hideEmptySchemes())}setSelectText(e){this._mySelectText=e,this._mySelectTextComponent.text=this._mySelectText,this.setVisible(this._myVisible)}setSqueezeText(e){this._mySqueezeText=e,this._mySqueezeTextComponent.text=this._mySqueezeText,this.setVisible(this._myVisible)}setThumbstickText(e){this._myThumbstickText=e,this._myThumbstickTextComponent.text=this._myThumbstickText,this.setVisible(this._myVisible)}setBottomButtonText(e){this._myBottomButtonText=e,this._myBottomButtonTextComponent.text=this._myBottomButtonText,this.setVisible(this._myVisible)}setTopButtonText(e){this._myTopButtonText=e,this._myTopButtonTextComponent.text=this._myTopButtonText,this.setVisible(this._myVisible)}_createControlScheme(){this._myParentObject=this.object.pp_addObject();let e=.02*this._myDistanceFromButtonsMultiplier,t=.0935*this._myLineLengthMultiplier,n=this._myThumbstick;this._mySelectObject=this._myParentObject.pp_addObject(),this._mySelectTextComponent=this._addScheme(this._mySelect,n,m(0,0,e),m(t*this._myControlSchemeDirection,0,0),this._mySelectObject),this._mySelectTextComponent.text=this._mySelectText,this._mySqueezeObject=this._myParentObject.pp_addObject(),this._mySqueezeTextComponent=this._addScheme(this._mySqueeze,n,m(e*this._myControlSchemeDirection,0,0),m(t*this._myControlSchemeDirection,0,0),this._mySqueezeObject),this._mySqueezeTextComponent.text=this._mySqueezeText,this._myThumbstickObject=this._myParentObject.pp_addObject(),this._myThumbstickTextComponent=this._addScheme(this._myThumbstick,n,m(0,e,0),m(-t*this._myControlSchemeDirection,0,0),this._myThumbstickObject),this._myThumbstickTextComponent.text=this._myThumbstickText;let o=this._myThumbstick.pp_getPositionLocal(),s=this._myThumbstick.pp_getUpLocal();{let h=this._myBottomButton.pp_getPositionLocal().vec3_sub(o).vec3_valueAlongAxis(s);this._myBottomButtonObject=this._myParentObject.pp_addObject(),this._myBottomButtonTextComponent=this._addScheme(this._myBottomButton,n,m(0,e-h,0),m(0,0,-t),this._myBottomButtonObject),this._myBottomButtonTextComponent.text=this._myBottomButtonText}{let h=this._myTopButton.pp_getPositionLocal().vec3_sub(o).vec3_valueAlongAxis(s);this._myTopButtonObject=this._myParentObject.pp_addObject(),this._myTopButtonTextComponent=this._addScheme(this._myTopButton,n,m(0,e-h,0),m(-t*this._myControlSchemeDirection,0,0).vec3_rotateAxis(-45*this._myControlSchemeDirection,m(0,1,0)),this._myTopButtonObject),this._myTopButtonTextComponent.text=this._myTopButtonText}}_addScheme(e,t,n,o,s){let a=e.pp_getPositionLocal(),l=t.pp_getForwardLocal(),h=t.pp_getRightLocal(),_=t.pp_getUpLocal(),y=a.vec3_add(h.vec3_scale(n[0]));y.vec3_add(_.vec3_scale(n[1]),y),y.vec3_add(l.vec3_scale(n[2]),y);let c=y.vec3_add(h.vec3_scale(o[0]));c.vec3_add(_.vec3_scale(o[1]),c),c.vec3_add(l.vec3_scale(o[2]),c);let d=.01*this._myTextOffsetMultiplier,g=c.vec3_add(l.vec3_scale(-d));return this._addLine(y,c,s),this._addText(g,l,_,s)}_addLine(e,t,n){let o=t.vec3_sub(e),s=o.vec3_length();o.vec3_normalize(o);let a=n.pp_addObject(),l=a.pp_addObject(),h=l.pp_addComponent(fA);h.mesh=r.getDefaultMeshes(this.engine).myCylinder,h.material=this._myLineMaterialFinal,a.pp_setPositionLocal(e);let _=.001*this._myLineThicknessMultiplier;l.pp_scaleObject(m(_/2,s/2,_/2)),l.pp_setUpLocal(o),l.pp_translateObject(m(0,s/2,0))}_addText(e,t,n,o){let s=o.pp_addObject();s.pp_setPositionLocal(e),s.pp_lookToLocal(n,t),s.pp_scaleObject(.0935*this._myTextScaleMultiplier);let a=s.pp_addComponent(PA);return a.alignment=dA.Center,a.justification=gA.Top,a.material=this._myTextMaterialFinal,a}_hideEmptySchemes(){this._mySelectText.length==0&&this._mySelectObject.pp_setActive(!1),this._mySqueezeText.length==0&&this._mySqueezeObject.pp_setActive(!1),this._myThumbstickText.length==0&&this._myThumbstickObject.pp_setActive(!1),this._myBottomButtonText.length==0&&this._myBottomButtonObject.pp_setActive(!1),this._myTopButtonText.length==0&&this._myTopButtonObject.pp_setActive(!1)}};R(On,"TypeName","pp-gamepad-control-scheme"),R(On,"Properties",{_myShowOnStart:We.bool(!0),_myHandedness:We.enum(["Left","Right"],"Left"),_mySelectText:We.string(""),_mySqueezeText:We.string(""),_myThumbstickText:We.string(""),_myBottomButtonText:We.string(""),_myTopButtonText:We.string(""),_mySelect:We.object(null),_mySqueeze:We.object(null),_myThumbstick:We.object(null),_myBottomButton:We.object(null),_myTopButton:We.object(null),_myTextScaleMultiplier:We.float(1),_myTextOffsetMultiplier:We.float(1),_myLineLengthMultiplier:We.float(1),_myLineThicknessMultiplier:We.float(1),_myDistanceFromButtonsMultiplier:We.float(1),_myTextMaterial:We.material(),_myLineMaterial:We.material()});var us=class extends Nt{constructor(e,t){super(t),this._myVirtualGamepad=e,this._myButtonData=this._createButtonData(),this._myAxesData=this._createAxesData(),this._myHapticActuators=[]}isGamepadCoreActive(){return this._myVirtualGamepad.isVisible()}getButtonData(e){return this._myButtonData.myPressed=!1,this._myButtonData.myTouched=!1,this._myButtonData.myValue=0,this.isGamepadCoreActive()&&this._myVirtualGamepad.isButtonPressed(this.getHandedness(),e)&&(this._myButtonData.myPressed=!0,this._myButtonData.myTouched=!0,this._myButtonData.myValue=1),this._myButtonData}getAxesData(e){return this._myAxesData.vec2_zero(),this.isGamepadCoreActive()&&this._myVirtualGamepad.getAxes(this.getHandedness(),e,this._myAxesData),this._myAxesData}getHapticActuators(){return this._myHapticActuators}};var Ve={NONE:0,LABEL:1,IMAGE:2,DOT:3,CIRCLE:4,SQUARE:5,RING:6,FRAME:7},hs=class{constructor(){this.myBackgroundColor="",this.myBackgroundPressedColor="",this.myIconColor="",this.myIconPressedColor="",this.myIconType=Ve.NONE,this.myOverallHoveredBrightness=1,this.myLabel="",this.myLabelFontSize=0,this.myLabelFontFamily="",this.myLabelFontWeight="",this.myImageURL="",this.myImagePressedBrightness=1}},xo=class{constructor(e,t,n,o,s=r.getMainEngine()){this._myEngine=s,this._myParams=t,this._myIconContainerElement=null,this._myBackgroundElement=null,this._myIconElement=null,this._myPressed=!1,this._myMouseHover=!1,this._myMouseHoverEnabled=!0,this._myDestroyed=!1,this._build(e,n,o)}update(e){this._myPressed||!this._myMouseHover||!this._myMouseHoverEnabled?this._myIconContainerElement.style.filter="none":this._myIconContainerElement.style.filter="brightness("+this._myParams.myOverallHoveredBrightness+")"}reset(){this.setPressed(!1),this._myMouseHover=!1,this._myIconContainerElement.style.filter="none"}setPressed(e){this._myPressed!=e&&(this._myPressed=e,this._myPressed?(this._myBackgroundElement.style.fill=this._myParams.myBackgroundPressedColor,this._myIconElement!=null&&(this._myIconElement.style.strokeWidth.length>0?this._myIconElement.style.stroke=this._myParams.myIconPressedColor:this._myIconElement.style.fill=this._myParams.myIconPressedColor,this._myParams.myIconType==Ve.IMAGE&&(this._myIconElement.style.filter="brightness("+this._myParams.myImagePressedBrightness+")"))):(this._myBackgroundElement.style.fill=this._myParams.myBackgroundColor,this._myIconElement!=null&&(this._myIconElement.style.strokeWidth.length>0?this._myIconElement.style.stroke=this._myParams.myIconColor:this._myIconElement.style.fill=this._myParams.myIconColor,this._myParams.myIconType==Ve.IMAGE&&(this._myIconElement.style.filter="none"))))}onMouseEnter(){this._myMouseHover=!0}onMouseLeave(){this._myMouseHover=!1}setMouseHoverEnabled(e){this._myMouseHoverEnabled=e}_build(e,t,n){switch(this._myIconContainerElement=r.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","svg"),this._myIconContainerElement.style.position="absolute",this._myIconContainerElement.style.width="100%",this._myIconContainerElement.style.height="100%",e.appendChild(this._myIconContainerElement),this._myBackgroundElement=r.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","circle"),this._myBackgroundElement.setAttributeNS(null,"cx","50%"),this._myBackgroundElement.setAttributeNS(null,"cy","50%"),this._myBackgroundElement.setAttributeNS(null,"r","50%"),this._myBackgroundElement.style.fill=this._myParams.myBackgroundColor,this._myIconContainerElement.appendChild(this._myBackgroundElement),this._myParams.myIconType){case Ve.NONE:break;case Ve.LABEL:this._myIconElement=r.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","text"),this._myIconElement.setAttributeNS(null,"x","50%"),this._myIconElement.setAttributeNS(null,"y","50%"),this._myIconElement.style.textAlign="center",this._myIconElement.style.textAnchor="middle",this._myIconElement.style.dominantBaseline="central",this._myIconElement.style.alignmentBaseline="central",this._myIconElement.style.fontFamily=this._myParams.myLabelFontFamily,this._myIconElement.style.fontWeight=this._myParams.myLabelFontWeight,this._myIconElement.style.fontSize=this._createSizeValue(this._myParams.myLabelFontSize*n,t),this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconElement.textContent=this._myParams.myLabel,this._myIconContainerElement.appendChild(this._myIconElement);break;case Ve.IMAGE:this._myIconElement=r.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","image"),this._myIconElement.setAttributeNS(null,"x","0%"),this._myIconElement.setAttributeNS(null,"y","0%"),this._myIconElement.setAttribute("href",this._myParams.myImageURL),this._myIconElement.style.width="100%",this._myIconElement.style.height="100%",this._myIconElement.style.filter="none",this._myIconContainerElement.appendChild(this._myIconElement);break;case Ve.DOT:this._myIconElement=r.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","circle"),this._myIconElement.setAttributeNS(null,"cx","50%"),this._myIconElement.setAttributeNS(null,"cy","50%"),this._myIconElement.setAttributeNS(null,"r","17.5%"),this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconContainerElement.appendChild(this._myIconElement);break;case Ve.CIRCLE:this._myIconElement=r.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","circle"),this._myIconElement.setAttributeNS(null,"cx","50%"),this._myIconElement.setAttributeNS(null,"cy","50%"),this._myIconElement.setAttributeNS(null,"r","24%"),this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconContainerElement.appendChild(this._myIconElement);break;case Ve.SQUARE:this._myIconElement=r.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","rect"),this._myIconElement.setAttributeNS(null,"x","28%"),this._myIconElement.setAttributeNS(null,"y","28%"),this._myIconElement.setAttributeNS(null,"rx","10%"),this._myIconElement.setAttributeNS(null,"ry","10%"),this._myIconElement.setAttributeNS(null,"width","44%"),this._myIconElement.setAttributeNS(null,"height","44%"),this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconElement.style.transformOrigin="center",this._myIconContainerElement.appendChild(this._myIconElement);break;case Ve.RING:this._myIconElement=r.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","circle"),this._myIconElement.setAttributeNS(null,"cx","50%"),this._myIconElement.setAttributeNS(null,"cy","50%"),this._myIconElement.setAttributeNS(null,"r","20%"),this._myIconElement.style.fill="#00000000",this._myIconElement.style.stroke=this._myParams.myIconColor,this._myIconElement.style.strokeWidth="10%",this._myIconContainerElement.appendChild(this._myIconElement);break;case Ve.FRAME:this._myIconElement=r.getDocument(this._myEngine).createElementNS("http://www.w3.org/2000/svg","rect"),this._myIconElement.setAttributeNS(null,"x","31.5%"),this._myIconElement.setAttributeNS(null,"y","31.5%"),this._myIconElement.setAttributeNS(null,"rx","10%"),this._myIconElement.setAttributeNS(null,"ry","10%"),this._myIconElement.setAttributeNS(null,"width","37%"),this._myIconElement.setAttributeNS(null,"height","37%"),this._myIconElement.style.fill="#00000000",this._myIconElement.style.stroke=this._myParams.myIconColor,this._myIconElement.style.strokeWidth="10%",this._myIconElement.style.transformOrigin="center",this._myIconContainerElement.appendChild(this._myIconElement);break}}_createSizeValue(e,t){return"min("+e.toFixed(3)+"vmax,"+(e*t).toFixed(3)+"vw)"}_invertColors(){this._myIconElement.style.strokeWidth.length>0?(this._myBackgroundElement.style.fill=this._myParams.myIconColor,this._myIconElement.style.fill=this._myParams.myIconColor,this._myIconElement.style.stroke=this._myParams.myBackgroundColor):(this._myBackgroundElement.style.fill=this._myParams.myIconColor,this._myIconElement.style.fill=this._myParams.myBackgroundColor)}destroy(){this._myDestroyed=!0,this._myIconContainerElement.remove()}isDestroyed(){return this._myDestroyed}};var Et=class{constructor(){this.myIconParams=new hs}},fa=class{constructor(){this.myBackgroundColor="",this.myMaxDistanceFromCenterMultiplier=1,this.myReleaseTransitionSeconds=.2,this.myMoveTransitionSeconds=0,this.myIncludeBackgroundToDetection=!1,this.myIconParams=new hs}},Mo=class{constructor(e=r.getMainEngine()){this.myShowOnDesktop=!1,this.myShowOnMobile=!1,this.myShowOnHeadset=!1,this.myAutoUpdateVisibility=!1,this.myOpacity=1,this.myInterfaceScale=1,this.myMarginScale=1,this.myReleaseOnPointerLeave=!0,this.myStopPropagatingMouseDownEvents=!0,this.myButtonParams=[],this.myButtonParams[A.LEFT]=[],this.myButtonParams[A.RIGHT]=[],this.myButtonParams[A.LEFT][M.SELECT]=new Et,this.myButtonParams[A.LEFT][M.SQUEEZE]=new Et,this.myButtonParams[A.LEFT][M.THUMBSTICK]=new Et,this.myButtonParams[A.LEFT][M.TOP_BUTTON]=new Et,this.myButtonParams[A.LEFT][M.BOTTOM_BUTTON]=new Et,this.myButtonParams[A.RIGHT][M.SELECT]=new Et,this.myButtonParams[A.RIGHT][M.SQUEEZE]=new Et,this.myButtonParams[A.RIGHT][M.THUMBSTICK]=new Et,this.myButtonParams[A.RIGHT][M.TOP_BUTTON]=new Et,this.myButtonParams[A.RIGHT][M.BOTTOM_BUTTON]=new Et,this.myThumbstickParams=[],this.myThumbstickParams[A.LEFT]=[],this.myThumbstickParams[A.RIGHT]=[],this.myThumbstickParams[A.LEFT][oe.THUMBSTICK]=new fa,this.myThumbstickParams[A.RIGHT][oe.THUMBSTICK]=new fa,this.myButtonsOrder=[],this.myButtonsOrder[A.LEFT]=[null,null,null,null,null],this.myButtonsOrder[A.RIGHT]=[null,null,null,null,null],this.myThumbsticksOrder=[],this.myThumbsticksOrder[A.LEFT]=[null],this.myThumbsticksOrder[A.RIGHT]=[null],this.myValidPointerButtons=[],this.myMarginLeft=0,this.myMarginRight=0,this.myMarginBottom=0,this.myThumbstickSize=0,this.myButtonSize=0,this.myButtonsRingRadius=0,this.myButtonsRingStartAngle=0,this.myButtonsRingEndAngle=0,this.myFontSize=0,this.myMinSizeMultiplier=0,this.myDisableMouseHoverWhenPressed=!1,this.myEngine=e}defaultConfig(){this.myShowOnMobile=!0,this.myAutoUpdateVisibility=!0,this.myOpacity=.5;let e="#616161",t="#e0e0e0",n=.75,o=.75,s=!0;for(let a in this.myButtonParams)for(let l in this.myButtonParams[a]){let h=this.myButtonParams[a][l];h.myIconParams.myBackgroundColor=e,h.myIconParams.myBackgroundPressedColor=t,h.myIconParams.myIconColor=t,h.myIconParams.myIconPressedColor=e,h.myIconParams.myOverallHoveredBrightness=n}this.myButtonParams[A.LEFT][M.SQUEEZE].myIconParams.myIconType=Ve.SQUARE,this.myButtonParams[A.RIGHT][M.SQUEEZE].myIconParams.myIconType=Ve.SQUARE,this.myButtonParams[A.LEFT][M.SELECT].myIconParams.myIconType=Ve.FRAME,this.myButtonParams[A.RIGHT][M.SELECT].myIconParams.myIconType=Ve.FRAME,this.myButtonParams[A.LEFT][M.TOP_BUTTON].myIconParams.myIconType=Ve.CIRCLE,this.myButtonParams[A.RIGHT][M.TOP_BUTTON].myIconParams.myIconType=Ve.CIRCLE,this.myButtonParams[A.LEFT][M.BOTTOM_BUTTON].myIconParams.myIconType=Ve.RING,this.myButtonParams[A.RIGHT][M.BOTTOM_BUTTON].myIconParams.myIconType=Ve.RING,this.myButtonParams[A.LEFT][M.THUMBSTICK].myIconParams.myIconType=Ve.DOT,this.myButtonParams[A.RIGHT][M.THUMBSTICK].myIconParams.myIconType=Ve.DOT;for(let a in this.myThumbstickParams)for(let l in this.myThumbstickParams[a]){let h=this.myThumbstickParams[a][l];h.myBackgroundColor=e,h.myIconParams.myBackgroundColor=t,h.myIconParams.myBackgroundPressedColor=t,h.myIconParams.myIconColor=e,h.myIconParams.myIconPressedColor=e,h.myIconParams.myOverallHoveredBrightness=o,h.myIncludeBackgroundToDetection=s}this.myButtonsOrder[A.LEFT][0]=[A.LEFT,M.SQUEEZE],this.myButtonsOrder[A.LEFT][1]=[A.LEFT,M.SELECT],this.myButtonsOrder[A.LEFT][2]=[A.LEFT,M.TOP_BUTTON],this.myButtonsOrder[A.LEFT][3]=[A.LEFT,M.BOTTOM_BUTTON],this.myButtonsOrder[A.LEFT][4]=[A.LEFT,M.THUMBSTICK],this.myButtonsOrder[A.RIGHT][0]=[A.RIGHT,M.SQUEEZE],this.myButtonsOrder[A.RIGHT][1]=[A.RIGHT,M.SELECT],this.myButtonsOrder[A.RIGHT][2]=[A.RIGHT,M.TOP_BUTTON],this.myButtonsOrder[A.RIGHT][3]=[A.RIGHT,M.BOTTOM_BUTTON],this.myButtonsOrder[A.RIGHT][4]=[A.RIGHT,M.THUMBSTICK],this.myThumbsticksOrder[A.LEFT][0]=[A.LEFT,oe.THUMBSTICK],this.myThumbsticksOrder[A.RIGHT][0]=[A.RIGHT,oe.THUMBSTICK],this.myMarginLeft=3,this.myMarginRight=3,this.myMarginBottom=3,this.myThumbstickSize=15,this.myButtonSize=5,this.myButtonsRingRadius=12,this.myButtonsRingStartAngle=385,this.myButtonsRingEndAngle=245,this.myMinSizeMultiplier=5/3,this.myDisableMouseHoverWhenPressed=!0,this.myValidPointerButtons=[0]}};var Pa=class{constructor(e,t,n,o,s,a){this._myButtonElement=null,this._myButtonIcon=null,this._myButtonDetectionElement=null,this._myActive=!0,this._myPointerID=null,this._myPointerButton=null,this._myPressed=!1,this._myVirtualGamepadParams=t,this._myParams=this._myVirtualGamepadParams.myButtonParams[s][a],this._build(e,n,o),this._myPointerDownEventListener=this._onPointerDown.bind(this,this._myVirtualGamepadParams.myStopPropagatingPointerDownEvents),this._myPointerUpEventListener=this._onPointerUp.bind(this),this._myPointerLeaveEventListener=this._onPointerLeave.bind(this),this._myMouseEnterEventListener=this._onButtonEnter.bind(this),this._myMouseLeaveEventListener=this._onButtonLeave.bind(this),this._myButtonDetectionElement.addEventListener("pointerdown",this._myPointerDownEventListener),r.getBody(this._myVirtualGamepadParams.myEngine).addEventListener("pointerup",this._myPointerUpEventListener),this._myVirtualGamepadParams.myReleaseOnPointerLeave&&r.getBody(this._myVirtualGamepadParams.myEngine).addEventListener("pointerleave",this._myPointerLeaveEventListener),this._myButtonDetectionElement.addEventListener("mouseenter",this._myMouseEnterEventListener),this._myButtonDetectionElement.addEventListener("mouseleave",this._myPointerUpEventLis_myMouseLeaveEventListenertener),this._myDestroyed=!1}isPressed(){return this._myActive&&this._myPressed}setActive(e){this._myActive!=e&&(this.reset(),this._myButtonIcon.reset()),this._myActive=e}setMouseHoverEnabled(e){this._myButtonIcon.setMouseHoverEnabled(e)}reset(){this._myButtonIcon.setPressed(!1),this._myPressed=!1,this._myPointerID=null,this._myPointerButton=null}update(e){this._myButtonIcon.update(e)}_onPointerDown(e,t){!this._myActive||this._myPressed||!this._myVirtualGamepadParams.myValidPointerButtons.pp_hasEqual(t.button)||(e&&t.stopPropagation(),t.preventDefault(),this._myButtonIcon.setPressed(!0),this._myPointerID=t.pointerId,this._myPointerButton=t.button,this._myPressed=!0)}_onPointerUp(e){!this._myActive||!this._myPressed||this._myPointerID==e.pointerId&&(this._myPointerButton!=null&&this._myPointerButton!=e.button||this.reset())}_onPointerLeave(e){!this._myActive||this._myPointerID==e.pointerId&&this.reset()}_onButtonEnter(e){!this._myActive||this._myButtonIcon.onMouseEnter(e)}_onButtonLeave(e){!this._myActive||this._myButtonIcon.onMouseLeave(e)}_build(e,t,n){let o=this._myVirtualGamepadParams.myButtonSize*this._myVirtualGamepadParams.myInterfaceScale,s=this._myVirtualGamepadParams.myButtonsRingRadius*this._myVirtualGamepadParams.myInterfaceScale,a=this._myVirtualGamepadParams.myThumbstickSize*this._myVirtualGamepadParams.myInterfaceScale,l=this._myVirtualGamepadParams.myMarginBottom*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,h=this._myVirtualGamepadParams.myMarginLeft*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,_=this._myVirtualGamepadParams.myMarginRight*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,y=this._myVirtualGamepadParams.myButtonsRingStartAngle,c=this._myVirtualGamepadParams.myButtonsRingEndAngle,d=Math.max(1,this._myVirtualGamepadParams.myMinSizeMultiplier/this._myVirtualGamepadParams.myInterfaceScale),g=this._myVirtualGamepadParams.myButtonsOrder[A.LEFT].length,P=(c-y)/(g-1),T=Math.pp_angleClamp(y+P*n);t==A.RIGHT&&(T=270+(270-T),T=Math.pp_angleClamp(T,!0));let C=360-T;this._myButtonContainer=r.getDocument(this._myVirtualGamepadParams.myEngine).createElement("div"),this._myButtonContainer.style.position="absolute",this._myButtonContainer.style.width=this._createSizeValue(o,d),this._myButtonContainer.style.height=this._createSizeValue(o,d);let x=l+a/2-o/2;if(this._myButtonContainer.style.bottom=this._createSizeValue(x,d),t==A.LEFT){let b=h+a/2-o/2;this._myButtonContainer.style.left=this._createSizeValue(b,d)}else{let b=_+a/2-o/2;this._myButtonContainer.style.right=this._createSizeValue(b,d)}this._myButtonContainer.style.transform="rotate("+T+"deg) translateX("+this._createSizeValue(s,d)+")",e.appendChild(this._myButtonContainer),this._myButtonElement=r.getDocument(this._myVirtualGamepadParams.myEngine).createElement("div"),this._myButtonElement.style.position="absolute",this._myButtonElement.style.width="100%",this._myButtonElement.style.height="100%",this._myButtonElement.style.transform="rotate("+C+"deg)",this._myButtonContainer.appendChild(this._myButtonElement),this._myButtonIcon=new xo(this._myButtonElement,this._myParams.myIconParams,d,this._myVirtualGamepadParams.myInterfaceScale,this._myVirtualGamepadParams.myEngine);let D=r.getDocument(this._myVirtualGamepadParams.myEngine).createElement("div");D.style.position="absolute",D.style.width="100%",D.style.height="100%",D.style.transform="rotate("+C+"deg)",this._myButtonContainer.appendChild(D);let E=r.getDocument(this._myVirtualGamepadParams.myEngine).createElementNS("http://www.w3.org/2000/svg","svg");E.style.position="absolute",E.style.width="100%",E.style.height="100%",D.appendChild(E);let S=r.getDocument(this._myVirtualGamepadParams.myEngine).createElementNS("http://www.w3.org/2000/svg","circle");S.setAttributeNS(null,"cx","50%"),S.setAttributeNS(null,"cy","50%"),S.setAttributeNS(null,"r","50%"),S.style.fill="#00000000",E.appendChild(S),this._myButtonDetectionElement=S}_createSizeValue(e,t){return"min("+e.toFixed(3)+"vmax,"+(e*t).toFixed(3)+"vw)"}destroy(){this._myDestroyed=!0,this._myButtonDetectionElement.removeEventListener("pointerdown",this._myPointerDownEventListener),r.getBody(this._myVirtualGamepadParams.myEngine).removeEventListener("pointerup",this._myPointerUpEventListener),r.getBody(this._myVirtualGamepadParams.myEngine).removeEventListener("pointerleave",this._myPointerLeaveEventListener),this._myButtonDetectionElement.removeEventListener("mouseenter",this._myMouseEnterEventListener),this._myButtonDetectionElement.removeEventListener("mouseleave",this._myPointerUpEventLis_myMouseLeaveEventListenertener),this._myButtonIcon.destroy(),this._myButtonContainer.remove()}isDestroyed(){return this._myDestroyed}};var Ca=class{constructor(e,t,n,o,s){this._myThumbstickElement=null,this._myThumbstickIcon=null,this._myThumbstickBackground=null,this._myThumbstickDetectionElement=null,this._myActive=!0,this._myPointerID=null,this._myPointerButton=null,this._myThumbstickDragStartPosition=De(),this._myAxes=De(),this._myPressed=!1,this._myVirtualGamepadParams=t,this._myParams=this._myVirtualGamepadParams.myThumbstickParams[o][s],this._build(e,n),this._myPointerDownEventListener=this._onPointerDown.bind(this,this._myVirtualGamepadParams.myStopPropagatingPointerDownEvents),this._myPointerUpEventListener=this._onPointerUp.bind(this),this._myPointerMoveEventListener=this._onPointerMove.bind(this),this._myPointerLeaveEventListener=this._onPointerLeave.bind(this),this._myMouseEnterEventListener=this._onThumbstickEnter.bind(this),this._myMouseLeaveEventListener=this._onThumbstickLeave.bind(this),this._myThumbstickDetectionElement.addEventListener("pointerdown",this._myPointerDownEventListener),r.getBody(this._myVirtualGamepadParams.myEngine).addEventListener("pointerup",this._myPointerUpEventListener),r.getBody(this._myVirtualGamepadParams.myEngine).addEventListener("pointermove",this._myPointerMoveEventListener),this._myVirtualGamepadParams.myReleaseOnPointerLeave&&r.getBody(this._myVirtualGamepadParams.myEngine).addEventListener("pointerleave",this._myPointerLeaveEventListener),this._myThumbstickDetectionElement.addEventListener("mouseenter",this._myMouseEnterEventListener),this._myThumbstickDetectionElement.addEventListener("mouseleave",this._myPointerUpEventLis_myMouseLeaveEventListenertener),this._myDestroyed=!1}isPressed(){return this._myActive&&this._myPressed}getAxes(){return this._myAxes}setActive(e){this._myActive!=e&&(this.reset(),this._myThumbstickIcon.reset()),this._myActive=e}setMouseHoverEnabled(e){this._myThumbstickIcon.setMouseHoverEnabled(e)}reset(){this._myThumbstickIcon.setPressed(!1),this._myAxes[0]=0,this._myAxes[1]=0,this._myPressed=!1,this._myPointerID=null,this._myPointerButton=null,this._myThumbstickElement.style.transition="all "+this._myParams.myReleaseTransitionSeconds+"s ease 0s",this._myThumbstickElement.style.transform="translate(0px, 0px)"}update(e){this._myThumbstickIcon.update(e)}_onPointerDown(e,t){!this._myActive||this._myPressed||!this._myVirtualGamepadParams.myValidPointerButtons.pp_hasEqual(t.button)||(e&&t.stopPropagation(),t.preventDefault(),this._myThumbstickIcon.setPressed(!0),this._myPointerID=t.pointerId,this._myPointerButton=t.button,this._myThumbstickDragStartPosition[0]=t.clientX,this._myThumbstickDragStartPosition[1]=t.clientY,this._myPressed=!0)}_onPointerUp(e){!this._myActive||!this._myPressed||this._myPointerID==e.pointerId&&(this._myPointerButton!=null&&this._myPointerButton!=e.button||this.reset())}_onPointerLeave(e){!this._myActive||this._myPointerID==e.pointerId&&this.reset()}_onThumbstickEnter(e){this._myThumbstickIcon.onMouseEnter(e)}_onThumbstickLeave(e){this._myThumbstickIcon.onMouseLeave(e)}_onPointerMove(e){if(!this._myActive||!this._myPressed||e.pointerId!=this._myPointerID)return;let t=e.clientX,n=e.clientY,s=this._myThumbstickBackground.getBoundingClientRect().width/2*this._myParams.myMaxDistanceFromCenterMultiplier,a=t-this._myThumbstickDragStartPosition[0],l=n-this._myThumbstickDragStartPosition[1],h=Math.atan2(l,a),_=Math.min(s,Math.hypot(a,l)),y=_*Math.cos(h),c=_*Math.sin(h);this._myThumbstickElement.style.transition="all "+this._myParams.myMoveTransitionSeconds+"s ease-out 0s",this._myThumbstickElement.style.transform="translate("+y+"px, "+c+"px)",this._myAxes[0]=y/s,this._myAxes[1]=-(c/s)}_build(e,t){let n=this._myVirtualGamepadParams.myThumbstickSize*this._myVirtualGamepadParams.myInterfaceScale,o=this._myVirtualGamepadParams.myMarginBottom*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,s=this._myVirtualGamepadParams.myMarginLeft*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,a=this._myVirtualGamepadParams.myMarginRight*this._myVirtualGamepadParams.myInterfaceScale*this._myVirtualGamepadParams.myMarginScale,l=Math.max(1,this._myVirtualGamepadParams.myMinSizeMultiplier/this._myVirtualGamepadParams.myInterfaceScale);this._myThumbstickContainer=r.getDocument(this._myVirtualGamepadParams.myEngine).createElement("div"),this._myThumbstickContainer.style.position="absolute",this._myThumbstickContainer.style.width=this._createSizeValue(n,l),this._myThumbstickContainer.style.height=this._createSizeValue(n,l),this._myThumbstickContainer.style.bottom=this._createSizeValue(o,l),t==A.LEFT?this._myThumbstickContainer.style.left=this._createSizeValue(s,l):this._myThumbstickContainer.style.right=this._createSizeValue(a,l),e.appendChild(this._myThumbstickContainer);let h=r.getDocument(this._myVirtualGamepadParams.myEngine).createElementNS("http://www.w3.org/2000/svg","svg");if(h.style.position="absolute",h.style.width="100%",h.style.height="100%",this._myThumbstickContainer.appendChild(h),this._myThumbstickBackground=r.getDocument(this._myVirtualGamepadParams.myEngine).createElementNS("http://www.w3.org/2000/svg","circle"),this._myThumbstickBackground.setAttributeNS(null,"cx","50%"),this._myThumbstickBackground.setAttributeNS(null,"cy","50%"),this._myThumbstickBackground.setAttributeNS(null,"r","48%"),this._myThumbstickBackground.style.fill=this._myParams.myBackgroundColor,h.appendChild(this._myThumbstickBackground),this._myThumbstickElement=r.getDocument(this._myVirtualGamepadParams.myEngine).createElement("div"),this._myThumbstickElement.style.position="absolute",this._myThumbstickElement.style.width="34%",this._myThumbstickElement.style.height="34%",this._myThumbstickElement.style.top="33%",this._myThumbstickElement.style.left="33%",this._myThumbstickContainer.appendChild(this._myThumbstickElement),this._myThumbstickIcon=new xo(this._myThumbstickElement,this._myParams.myIconParams,l,this._myVirtualGamepadParams.myScale,this._myVirtualGamepadParams.myEngine),this._myParams.myIncludeBackgroundToDetection){let _=r.getDocument(this._myVirtualGamepadParams.myEngine).createElementNS("http://www.w3.org/2000/svg","svg");_.style.position="absolute",_.style.width="100%",_.style.height="100%",this._myThumbstickContainer.appendChild(_);let y=r.getDocument(this._myVirtualGamepadParams.myEngine).createElementNS("http://www.w3.org/2000/svg","circle");y.setAttributeNS(null,"cx","50%"),y.setAttributeNS(null,"cy","50%"),y.setAttributeNS(null,"r","48%"),y.style.fill="#00000000",_.appendChild(y),this._myThumbstickDetectionElement=y}else{let _=r.getDocument(this._myVirtualGamepadParams.myEngine).createElement("div");_.style.position="absolute",_.style.width="34%",_.style.height="34%",_.style.top="33%",_.style.left="33%",this._myThumbstickContainer.appendChild(_);let y=r.getDocument(this._myVirtualGamepadParams.myEngine).createElementNS("http://www.w3.org/2000/svg","svg");y.style.position="absolute",y.style.width="100%",y.style.height="100%",_.appendChild(y);let c=r.getDocument(this._myVirtualGamepadParams.myEngine).createElementNS("http://www.w3.org/2000/svg","circle");c.setAttributeNS(null,"cx","50%"),c.setAttributeNS(null,"cy","50%"),c.setAttributeNS(null,"r","50%"),c.style.fill="#00000000",y.appendChild(c),this._myThumbstickDetectionElement=c}}_createSizeValue(e,t){return"min("+e.toFixed(3)+"vmax,"+(e*t).toFixed(3)+"vw)"}destroy(){this._myDestroyed=!0,this._myThumbstickDetectionElement.removeEventListener("pointerdown",this._myPointerDownEventListener),r.getBody(this._myVirtualGamepadParams.myEngine).removeEventListener("pointerup",this._myPointerUpEventListener),r.getBody(this._myVirtualGamepadParams.myEngine).removeEventListener("pointermove",this._myPointerMoveEventListener),r.getBody(this._myVirtualGamepadParams.myEngine).removeEventListener("pointerleave",this._myPointerLeaveEventListener),this._myThumbstickDetectionElement.removeEventListener("mouseenter",this._myMouseEnterEventListener),this._myThumbstickDetectionElement.removeEventListener("mouseleave",this._myPointerUpEventLis_myMouseLeaveEventListenertener),this._myThumbstickIcon.destroy(),this._myThumbstickContainer.remove()}isDestroyed(){return this._myDestroyed}};var Ta=class{constructor(e=new Mo){this._myParams=e,this._myVisible=!0,this._myVirtualGamepadContainer=null,this._myVirtualGamepadVirtualButtons=[],this._myVirtualGamepadVirtualButtons[A.LEFT]=[],this._myVirtualGamepadVirtualButtons[A.RIGHT]=[],this._myVirtualGamepadVirtualButtons[A.LEFT][M.SELECT]=null,this._myVirtualGamepadVirtualButtons[A.LEFT][M.SQUEEZE]=null,this._myVirtualGamepadVirtualButtons[A.LEFT][M.THUMBSTICK]=null,this._myVirtualGamepadVirtualButtons[A.LEFT][M.TOP_BUTTON]=null,this._myVirtualGamepadVirtualButtons[A.LEFT][M.BOTTOM_BUTTON]=null,this._myVirtualGamepadVirtualButtons[A.RIGHT][M.SELECT]=null,this._myVirtualGamepadVirtualButtons[A.RIGHT][M.SQUEEZE]=null,this._myVirtualGamepadVirtualButtons[A.RIGHT][M.THUMBSTICK]=null,this._myVirtualGamepadVirtualButtons[A.RIGHT][M.TOP_BUTTON]=null,this._myVirtualGamepadVirtualButtons[A.RIGHT][M.BOTTOM_BUTTON]=null,this._myButtonsAmount=this._myVirtualGamepadVirtualButtons[A.LEFT].length,this._myVirtualGamepadVirtualThumbsticks=[],this._myVirtualGamepadVirtualThumbsticks[A.LEFT]=[],this._myVirtualGamepadVirtualThumbsticks[A.RIGHT]=[],this._myVirtualGamepadVirtualThumbsticks[A.LEFT][oe.THUMBSTICK]=null,this._myVirtualGamepadVirtualThumbsticks[A.RIGHT][oe.THUMBSTICK]=null,this._myGestureStartEventListener=null,this._myDestroyed=!1}isVisible(){return this._myVisible}setVisible(e){if(this._myVisible!=e&&(this._myVisible=e,this._myVirtualGamepadContainer!=null)){this._myVisible?this._myVirtualGamepadContainer.style.display="block":this._myVirtualGamepadContainer.style.display="none";for(let t in this._myVirtualGamepadVirtualButtons)for(let n in this._myVirtualGamepadVirtualButtons[t]){let o=this._myVirtualGamepadVirtualButtons[t][n];o?.setActive(this._myVisible)}for(let t in this._myVirtualGamepadVirtualThumbsticks)for(let n in this._myVirtualGamepadVirtualThumbsticks[t]){let o=this._myVirtualGamepadVirtualThumbsticks[t][n];o?.setActive(this._myVisible)}}}isButtonPressed(e,t){if(!this._myVisible)return!1;let n=this._myVirtualGamepadVirtualButtons[e][t];return n!=null?n.isPressed():!1}getAxes(e,t,n=De(0,0)){if(!this._myVisible)return n;let o=this._myVirtualGamepadVirtualThumbsticks[e][t];return o!=null&&n.vec2_copy(o.getAxes()),n}start(){this._buildVirtualGamepad();let e=this._myVisible;this._myVisible=!this._myVisible,this.setVisible(e)}update(e){if(this._myParams.myAutoUpdateVisibility&&(B.isSessionActive(this._myParams.myEngine)&&B.isVRSupported(this._myParams.myEngine)?this.setVisible(!1):this._myParams.myShowOnDesktop&&Zo.isDesktop(this._myParams.myEngine)&&!B.isVRSupported(this._myParams.myEngine)?this.setVisible(!0):this._myParams.myShowOnHeadset&&Zo.isDesktop(this._myParams.myEngine)&&B.isVRSupported(this._myParams.myEngine)?this.setVisible(!0):this._myParams.myShowOnMobile&&Zo.isMobile(this._myParams.myEngine)?this.setVisible(!0):this.setVisible(!1)),this._myVisible){for(let t in this._myVirtualGamepadVirtualButtons)for(let n in this._myVirtualGamepadVirtualButtons[t]){let o=this._myVirtualGamepadVirtualButtons[t][n];o?.update(e)}for(let t in this._myVirtualGamepadVirtualThumbsticks)for(let n in this._myVirtualGamepadVirtualThumbsticks[t]){let o=this._myVirtualGamepadVirtualThumbsticks[t][n];o?.update(e)}this._setMouseHoverEnabled(!(this._myParams.myDisableMouseHoverWhenPressed&&this._isAnyElementPressed()))}}_buildVirtualGamepad(){this._setupDocumentBody(),this._myVirtualGamepadContainer=r.getDocument(this._myParams.myEngine).createElement("div"),this._myVirtualGamepadContainer.style.display="block",this._myVirtualGamepadContainer.style.opacity=this._myParams.myOpacity.toString(),r.getBody(this._myParams.myEngine).appendChild(this._myVirtualGamepadContainer);let e=r.getDocument(this._myParams.myEngine).createElement("div");this._myVirtualGamepadContainer.appendChild(e);let t=r.getDocument(this._myParams.myEngine).createElement("div");this._myVirtualGamepadContainer.appendChild(t);let n=this._myParams.myButtonsOrder[A.LEFT].length;for(let s=0;s<n;s++){if(this._myParams.myButtonsOrder[A.LEFT][s]!=null){let a=this._myParams.myButtonsOrder[A.LEFT][s][0],l=this._myParams.myButtonsOrder[A.LEFT][s][1];this._buildButton(e,A.LEFT,s,a,l)}if(this._myParams.myButtonsOrder[A.RIGHT][s]!=null){let a=this._myParams.myButtonsOrder[A.RIGHT][s][0],l=this._myParams.myButtonsOrder[A.RIGHT][s][1];this._buildButton(t,A.RIGHT,s,a,l)}}let o=this._myParams.myThumbsticksOrder[A.LEFT].length;for(let s=0;s<o;s++){if(this._myParams.myThumbsticksOrder[A.LEFT][s]!=null){let a=this._myParams.myThumbsticksOrder[A.LEFT][s][0],l=this._myParams.myThumbsticksOrder[A.LEFT][s][1];this._buildThumbstick(e,A.LEFT,a,l)}if(this._myParams.myThumbsticksOrder[A.RIGHT][s]!=null){let a=this._myParams.myThumbsticksOrder[A.RIGHT][s][0],l=this._myParams.myThumbsticksOrder[A.RIGHT][s][1];this._buildThumbstick(t,A.RIGHT,a,l)}}}_setupDocumentBody(){r.getBody(this._myParams.myEngine).style.overflow="hidden",r.getBody(this._myParams.myEngine).style.userSelect="none",r.getBody(this._myParams.myEngine).style.webkitUserSelect="none",r.getBody(this._myParams.myEngine).style.webkitTapHighlightColor="transparent",r.getBody(this._myParams.myEngine).style.touchAction="none",this._myGestureStartEventListener=function(e){e.preventDefault()},r.getDocument(this._myParams.myEngine).addEventListener("gesturestart",this._myGestureStartEventListener)}_buildButton(e,t,n,o,s){let a=new Pa(e,this._myParams,t,n,o,s);this._myVirtualGamepadVirtualButtons[o][s]=a}_buildThumbstick(e,t,n,o){let s=new Ca(e,this._myParams,t,n,o);this._myVirtualGamepadVirtualThumbsticks[n][o]=s}_createSizeValue(e,t){return"min("+e.toFixed(3)+"vmax,"+(e*t).toFixed(3)+"vw)"}_isAnyElementPressed(){let e=!1;for(let t in this._myVirtualGamepadVirtualButtons)for(let n in this._myVirtualGamepadVirtualButtons[t]){let o=this._myVirtualGamepadVirtualButtons[t][n];if(o!=null&&o.isPressed()){e=!0;break}}if(!e)for(let t in this._myVirtualGamepadVirtualThumbsticks)for(let n in this._myVirtualGamepadVirtualThumbsticks[t]){let o=this._myVirtualGamepadVirtualThumbsticks[t][n];if(o!=null&&o.isPressed()){e=!0;break}}return e}_setMouseHoverEnabled(e){for(let t in this._myVirtualGamepadVirtualButtons)for(let n in this._myVirtualGamepadVirtualButtons[t]){let o=this._myVirtualGamepadVirtualButtons[t][n];o?.setMouseHoverEnabled(e)}for(let t in this._myVirtualGamepadVirtualThumbsticks)for(let n in this._myVirtualGamepadVirtualThumbsticks[t]){let o=this._myVirtualGamepadVirtualThumbsticks[t][n];o?.setMouseHoverEnabled(e)}}destroy(){this._myDestroyed=!0,r.getDocument(this._myParams.myEngine).removeEventListener("gesturestart",this._myGestureStartEventListener);for(let e in this._myVirtualGamepadVirtualButtons)for(let t in this._myVirtualGamepadVirtualButtons[e])this._myVirtualGamepadVirtualButtons[e][t].destroy();for(let e in this._myVirtualGamepadVirtualThumbsticks)for(let t in this._myVirtualGamepadVirtualThumbsticks[e])this._myVirtualGamepadVirtualThumbsticks[e][t].destroy();this._myVirtualGamepadContainer.remove()}isDestroyed(){return this._myDestroyed}};import{Component as CA,Property as K}from"@wonderlandengine/api";var Bn=class extends CA{start(){let e=new Mo(this.engine);e.defaultConfig();for(let t in e.myButtonParams)for(let n in e.myButtonParams[t]){let o=e.myButtonParams[t][n];o.myIconParams.myBackgroundColor=this._myBackgroundColor,o.myIconParams.myBackgroundPressedColor=this._myIconColor,o.myIconParams.myIconColor=this._myIconColor,o.myIconParams.myIconPressedColor=this._myBackgroundColor}for(let t in e.myThumbstickParams)for(let n in e.myThumbstickParams[t]){let o=e.myThumbstickParams[t][n];o.myBackgroundColor=this._myBackgroundColor,o.myIconParams.myBackgroundColor=this._myIconColor,o.myIconParams.myBackgroundPressedColor=this._myIconColor,o.myIconParams.myIconColor=this._myBackgroundColor,o.myIconParams.myIconPressedColor=this._myBackgroundColor}e.myOpacity=this._myOpacity,e.myInterfaceScale=this._myInterfaceScale,e.myMarginScale=this._myMarginScale,e.myShowOnDesktop=this._myShowOnDesktop,e.myShowOnMobile=this._myShowOnMobile,e.myShowOnHeadset=this._myShowOnHeadset,e.myShowOnDesktop||e.myShowOnMobile||e.myShowOnHeadset?e.myAutoUpdateVisibility=!0:e.myAutoUpdateVisibility=!1,this._advancedConfig(e),this._myVirtualGamepad=new Ta(e),this._myVirtualGamepad.setVisible(!1),this._myVirtualGamepad.start(),this._myFirstUpdate=!0,this._myLeftVirtualGamepadGamepadCore=null,this._myRightVirtualGamepadGamepadCore=null}update(e){this._myFirstUpdate&&(this._myFirstUpdate=!1,this._myAddToUniversalGamepad&&(this._myLeftVirtualGamepadGamepadCore=new us(this._myVirtualGamepad,r.getLeftGamepad(this.engine).getGamepadCore("pp_left_xr_gamepad").getHandPose()),this._myRightVirtualGamepadGamepadCore=new us(this._myVirtualGamepad,r.getRightGamepad(this.engine).getGamepadCore("pp_right_xr_gamepad").getHandPose()),r.getLeftGamepad(this.engine).addGamepadCore("pp_left_virtual_gamepad",this._myLeftVirtualGamepadGamepadCore),r.getRightGamepad(this.engine).addGamepadCore("pp_right_virtual_gamepad",this._myRightVirtualGamepadGamepadCore))),this._myVirtualGamepad.update(e)}_advancedConfig(e){e.myButtonsOrder[A.LEFT]=[null,null,null,null,null],e.myButtonsOrder[A.RIGHT]=[null,null,null,null,null];{let t=e.myButtonParams[A.LEFT][M.SELECT];t.myIconParams.myIconType=this._myLeftSelectButtonIconType,t.myIconParams.myLabel=this._myLeftSelectIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myLeftSelectIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftSelectButtonVisible&&(e.myButtonsOrder[A.LEFT][this._myLeftSelectButtonOrderIndex]=[A.LEFT,M.SELECT])}{let t=e.myButtonParams[A.LEFT][M.SQUEEZE];t.myIconParams.myIconType=this._myLeftSqueezeButtonIconType,t.myIconParams.myLabel=this._myLeftSqueezeIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myLeftSqueezeIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftSqueezeButtonVisible&&(e.myButtonsOrder[A.LEFT][this._myLeftSqueezeButtonOrderIndex]=[A.LEFT,M.SQUEEZE])}{let t=e.myButtonParams[A.LEFT][M.THUMBSTICK];t.myIconParams.myIconType=this._myLeftThumbstickButtonIconType,t.myIconParams.myLabel=this._myLeftThumbstickButtonIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myLeftThumbstickButtonIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftThumbstickButtonVisible&&(e.myButtonsOrder[A.LEFT][this._myLeftThumbstickButtonOrderIndex]=[A.LEFT,M.THUMBSTICK])}{let t=e.myButtonParams[A.LEFT][M.TOP_BUTTON];t.myIconParams.myIconType=this._myLeftTopButtonIconType,t.myIconParams.myLabel=this._myLeftTopButtonIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myLeftTopButtonIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftTopButtonVisible&&(e.myButtonsOrder[A.LEFT][this._myLeftTopButtonOrderIndex]=[A.LEFT,M.TOP_BUTTON])}{let t=e.myButtonParams[A.LEFT][M.BOTTOM_BUTTON];t.myIconParams.myIconType=this._myLeftBottomButtonIconType,t.myIconParams.myLabel=this._myLeftBottomButtonIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myLeftBottomButtonIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myLeftBottomButtonVisible&&(e.myButtonsOrder[A.LEFT][this._myLeftBottomButtonOrderIndex]=[A.LEFT,M.BOTTOM_BUTTON])}{let t=e.myButtonParams[A.RIGHT][M.SELECT];t.myIconParams.myIconType=this._myRightSelectButtonIconType,t.myIconParams.myLabel=this._myRightSelectIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myRightSelectIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightSelectButtonVisible&&(e.myButtonsOrder[A.RIGHT][this._myRightSelectButtonOrderIndex]=[A.RIGHT,M.SELECT])}{let t=e.myButtonParams[A.RIGHT][M.SQUEEZE];t.myIconParams.myIconType=this._myRightSqueezeButtonIconType,t.myIconParams.myLabel=this._myRightSqueezeIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myRightSqueezeIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightSqueezeButtonVisible&&(e.myButtonsOrder[A.RIGHT][this._myRightSqueezeButtonOrderIndex]=[A.RIGHT,M.SQUEEZE])}{let t=e.myButtonParams[A.RIGHT][M.THUMBSTICK];t.myIconParams.myIconType=this._myRightThumbstickButtonIconType,t.myIconParams.myLabel=this._myRightThumbstickButtonIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myRightThumbstickButtonIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightThumbstickButtonVisible&&(e.myButtonsOrder[A.RIGHT][this._myRightThumbstickButtonOrderIndex]=[A.RIGHT,M.THUMBSTICK])}{let t=e.myButtonParams[A.RIGHT][M.TOP_BUTTON];t.myIconParams.myIconType=this._myRightTopButtonIconType,t.myIconParams.myLabel=this._myRightTopButtonIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myRightTopButtonIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightTopButtonVisible&&(e.myButtonsOrder[A.RIGHT][this._myRightTopButtonOrderIndex]=[A.RIGHT,M.TOP_BUTTON])}{let t=e.myButtonParams[A.RIGHT][M.BOTTOM_BUTTON];t.myIconParams.myIconType=this._myRightBottomButtonIconType,t.myIconParams.myLabel=this._myRightBottomButtonIconLabelOrImageUrl,t.myIconParams.myImageURL=this._myRightBottomButtonIconLabelOrImageUrl,t.myIconParams.myLabelFontSize=this._myLabelFontSize,t.myIconParams.myLabelFontFamily=this._myLabelFontFamily,t.myIconParams.myLabelFontWeight=this._myLabelFontWeight,t.myIconParams.myImagePressedBrightness=this._myImagePressedBrightness,this._myRightBottomButtonVisible&&(e.myButtonsOrder[A.RIGHT][this._myRightBottomButtonOrderIndex]=[A.RIGHT,M.BOTTOM_BUTTON])}}onDestroy(){r.getLeftGamepad(this.engine)?.removeGamepadCore("pp_left_virtual_gamepad"),r.getRightGamepad(this.engine)?.removeGamepadCore("pp_right_virtual_gamepad"),this._myLeftVirtualGamepadGamepadCore.destroy(),this._myRightVirtualGamepadGamepadCore.destroy(),this._myVirtualGamepad.destroy()}};R(Bn,"TypeName","pp-virtual-gamepad"),R(Bn,"Properties",{_myShowOnDesktop:K.bool(!1),_myShowOnMobile:K.bool(!0),_myShowOnHeadset:K.bool(!1),_myAddToUniversalGamepad:K.bool(!0),_myOpacity:K.float(.5),_myIconColor:K.string("#e0e0e0"),_myBackgroundColor:K.string("#616161"),_myInterfaceScale:K.float(1),_myMarginScale:K.float(1),ADVANCED_PARAMS_BELOW:K.string(""),_myLabelFontSize:K.float(2),_myLabelFontFamily:K.string("sans-serif"),_myLabelFontWeight:K.string("bold"),_myImagePressedBrightness:K.float(.5),_myLeftSelectButtonVisible:K.bool(!0),_myLeftSelectButtonOrderIndex:K.int(1),_myLeftSelectButtonIconType:K.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Frame"),_myLeftSelectButtonIconLabelOrImageUrl:K.string(""),_myLeftSqueezeButtonVisible:K.bool(!0),_myLeftSqueezeButtonOrderIndex:K.int(0),_myLeftSqueezeButtonIconType:K.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Square"),_myLeftSqueezeButtonIconLabelOrImageUrl:K.string(""),_myLeftThumbstickButtonVisible:K.bool(!0),_myLeftThumbstickButtonOrderIndex:K.int(4),_myLeftThumbstickButtonIconType:K.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Dot"),_myLeftThumbstickButtonIconLabelOrImageUrl:K.string(""),_myLeftTopButtonVisible:K.bool(!0),_myLeftTopButtonOrderIndex:K.int(2),_myLeftTopButtonIconType:K.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Circle"),_myLeftTopButtonIconLabelOrImageUrl:K.string(""),_myLeftBottomButtonVisible:K.bool(!0),_myLeftBottomButtonOrderIndex:K.int(3),_myLeftBottomButtonIconType:K.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Ring"),_myLeftBottomButtonIconLabelOrImageUrl:K.string(""),_myRightSelectButtonVisible:K.bool(!0),_myRightSelectButtonOrderIndex:K.int(1),_myRightSelectButtonIconType:K.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Frame"),_myRightSelectButtonIconLabelOrImageUrl:K.string(""),_myRightSqueezeButtonVisible:K.bool(!0),_myRightSqueezeButtonOrderIndex:K.int(0),_myRightSqueezeButtonIconType:K.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Square"),_myRightSqueezeButtonIconLabelOrImageUrl:K.string(""),_myRightThumbstickButtonVisible:K.bool(!0),_myRightThumbstickButtonOrderIndex:K.int(4),_myRightThumbstickButtonIconType:K.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Dot"),_myRightThumbstickButtonIconLabelOrImageUrl:K.string(""),_myRightTopButtonVisible:K.bool(!0),_myRightTopButtonOrderIndex:K.int(2),_myRightTopButtonIconType:K.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Circle"),_myRightTopButtonIconLabelOrImageUrl:K.string(""),_myRightBottomButtonVisible:K.bool(!0),_myRightBottomButtonOrderIndex:K.int(3),_myRightBottomButtonIconType:K.enum(["None","Label","Image","Dot","Circle","Square","Ring","Frame"],"Ring"),_myRightBottomButtonIconLabelOrImageUrl:K.string("")});import{Component as TA,Property as eb}from"@wonderlandengine/api";var In=class extends TA{start(){let e=this.object.pp_getPositionLocal();this.object.pp_setPositionLocal(m(e[0],this._myEyesHeight,e[2])),this._myHeightSetOnce=!1,B.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this.engine)}_onXRSessionStart(){if(this.active&&(!this._mySetOnlyOnStart||!this._myHeightSetOnce)){let e=this.object.pp_getPositionLocal();B.isReferenceSpaceFloorBased(this.engine)?this.object.pp_setPositionLocal(m(e[0],0,e[2])):B.isDeviceEmulated(this.engine)?this.object.pp_setPositionLocal(m(e[0],0,e[2])):this.object.pp_setPositionLocal(m(e[0],this._myEyesHeight,e[2])),this._myHeightSetOnce=!0}}_onXRSessionEnd(){if(this.active&&!this._mySetOnlyOnStart){let e=this.object.pp_getPositionLocal();this.object.pp_setPositionLocal(m(e[0],this._myEyesHeight,e[2]))}}};R(In,"TypeName","pp-set-player-height"),R(In,"Properties",{_myEyesHeight:eb.float(1.65),_mySetOnlyOnStart:eb.bool(!1)});import{Component as bA,Property as SA}from"@wonderlandengine/api";var qi=class extends bA{start(){this._myHandednessType=ee.getHandednessByIndex(this._myHandedness),r.getHandPose(this._myHandednessType).registerPoseUpdatedEventListener(this,this.onPoseUpdated.bind(this))}onPoseUpdated(){}onDestroy(){r.getHandPose(this._myHandednessType)?.unregisterPoseUpdatedEventListener(this)}};R(qi,"TypeName","pp-set-hand-local-transform"),R(qi,"Properties",{_myHandedness:SA.enum(["Left","Right"],"Left")});qi.prototype.onPoseUpdated=function(){let i=j();return function(t){this.active&&this.object.pp_setTransformLocalQuat(t.getTransformQuat(i,null))}}();import{Component as vA}from"@wonderlandengine/api";var vi=class extends vA{start(){r.getHeadPose().registerPoseUpdatedEventListener(this,this.onPoseUpdated.bind(this))}update(e){}onPoseUpdated(){}onDestroy(){r.getHeadPose()?.unregisterPoseUpdatedEventListener(this)}};R(vi,"TypeName","pp-set-head-local-transform"),R(vi,"Properties",{});vi.prototype.update=function(){let i=z(),e=m(),t=m();return function(o){if(!B.isSessionActive(this.engine)){let s=r.getPlayerObjects(this.engine).myCameraNonXR;i=s.pp_getRotationLocalQuat(i),r.isPoseForwardFixed(this.engine)&&i.quat_rotateAxisRadians(Math.PI,i.quat_getUp(e),i),this.object.pp_setPositionLocal(s.pp_getPositionLocal(t)),this.object.pp_setRotationLocalQuat(i)}}}();vi.prototype.onPoseUpdated=function(){let i=j();return function(t){this.active&&B.isSessionActive(this.engine)&&this.object.pp_setTransformLocalQuat(t.getTransformQuat(i,null))}}();import{Component as xA,Property as dm}from"@wonderlandengine/api";var Xi=class extends xA{start(){this._myHandednessType=ee.getHandednessByIndex(this._myHandedness),this._myJointIDType=ee.getJointIDByIndex(this._myJointID),r.getTrackedHandPose(this._myHandednessType).getJointPose(this._myJointIDType).registerPoseUpdatedEventListener(this,this.onPoseUpdated.bind(this))}onPoseUpdated(){}onDestroy(){r.getTrackedHandPose(this._myHandednessType)?.getJointPose(this._myJointIDType)?.unregisterPoseUpdatedEventListener(this)}};R(Xi,"TypeName","pp-set-tracked-hand-joint-local-transform"),R(Xi,"Properties",{_myHandedness:dm.enum(["Left","Right"],"Left"),_mySetLocalScaleAsJointRadius:dm.bool(!1),_myJointID:dm.enum(["Wrist","Thumb Metacarpal","Thumb Phalanx Proximal","Thumb Phalanx Distal","Thumb Tip","Index Metacarpal","Index Phalanx Proximal","Index Phalanx Intermediate","Index Phalanx Distal","Index Tip","Middle Metacarpal","Middle Phalanx Proximal","Middle Phalanx Intermediate","Middle Phalanx Distal","Middle Tip","Ring Metacarpal","Ring Phalanx Proximal","Ring Phalanx Intermediate","Ring Phalanx Distal","Ring Tip","Pinky Metacarpal","Pinky Phalanx Proximal","Pinky Phalanx Intermediate","Pinky Phalanx Distal","Pinky Tip"],"Wrist")});Xi.prototype.onPoseUpdated=function(){let i=j();return function(t){this.active&&(this.object.pp_setTransformLocalQuat(t.getTransformQuat(i,null)),this._mySetLocalScaleAsJointRadius&&this.object.pp_setScaleLocal(t.getJointRadius()))}}();import{Component as MA,Property as EA}from"@wonderlandengine/api";var Hn=class extends MA{init(){this._myHandednessType=ee.getHandednessByIndex(this._myHandedness)}update(e){let t=r.getPlayerObjects(this.engine).myHands[this._myHandednessType];this.object.pp_setTransformQuat(t.pp_getTransformQuat()),this.object.pp_setScale(t.pp_getScale())}};R(Hn,"TypeName","pp-copy-hand-transform"),R(Hn,"Properties",{_myHandedness:EA.enum(["Left","Right"],"Left")});import{Component as DA}from"@wonderlandengine/api";var Ln=class extends DA{update(e){let t=r.getPlayerObjects(this.engine).myHead;this.object.pp_setTransformQuat(t.pp_getTransformQuat()),this.object.pp_setScale(t.pp_getScale())}};R(Ln,"TypeName","pp-copy-head-transform"),R(Ln,"Properties",{});import{Component as RA}from"@wonderlandengine/api";var kn=class extends RA{update(e){let t=r.getPlayerObjects(this.engine).myPlayer;this.object.pp_setTransformQuat(t.pp_getTransformQuat()),this.object.pp_setScale(t.pp_getScale())}};R(kn,"TypeName","pp-copy-player-transform"),R(kn,"Properties",{});import{Component as AA}from"@wonderlandengine/api";var Fn=class extends AA{update(e){let t=r.getPlayerObjects(this.engine).myPlayerPivot;this.object.pp_setTransformQuat(t.pp_getTransformQuat()),this.object.pp_setScale(t.pp_getScale())}};R(Fn,"TypeName","pp-copy-player-pivot-transform"),R(Fn,"Properties",{});var U={NONE:null,LEFT:"left",RIGHT:"right"},Ee={NONE:null,GAMEPAD:0,TRACKED_HAND:1};import{Component as VA,MeshComponent as tb,Property as $r,ViewComponent as OA}from"@wonderlandengine/api";import{Cursor as ib,CursorTarget as BA}from"@wonderlandengine/components";var Ki=class extends VA{init(){this._myHandednessType=ee.getHandednessByIndex(this._myHandedness),this._myCursorPositionDefaultOffset=m(0,-.035,.05),this._myCursorRotationDefaultOffset=m(30,0,0),this._myCursorMeshScale=m(.0025,.0025,.0025),this._myCursorColor=w(255/255,255/255,255/255,1),this._myCursorTargetCollisionGroup=7}start(){this._myToolCursorObject=this.object.pp_addObject(),this._myCursorObjectXR=this._myToolCursorObject.pp_addObject(),this._myApplyDefaultCursorOffset&&(this._myCursorObjectXR.pp_setPositionLocal(this._myCursorPositionDefaultOffset),this._myCursorObjectXR.pp_rotateObject(this._myCursorRotationDefaultOffset));{this._myCursorMeshobject=this._myCursorObjectXR.pp_addObject(),this._myCursorMeshobject.pp_setScale(this._myCursorMeshScale);let n=this._myCursorMeshobject.pp_addComponent(tb);n.mesh=r.getDefaultMeshes(this.engine).mySphere,n.material=r.getDefaultMaterials(this.engine).myFlatOpaque.clone(),n.material.color=this._myCursorColor,this._myCursorComponentXR=this._myCursorObjectXR.pp_addComponent(ib,{collisionGroup:this._myCursorTargetCollisionGroup,handedness:this._myHandedness+1,cursorObject:this._myCursorMeshobject}),this._myCursorComponentXR.rayCastMode=0,this._myPulseOnHover&&this._myCursorComponentXR.globalTarget.onHover.add(this._pulseOnHover.bind(this),{id:this})}this._myCursorObjectNonXR=this._myToolCursorObject.pp_addObject(),this._myCursorComponentNonXR=this._myCursorObjectNonXR.pp_addComponent(ib,{collisionGroup:this._myCursorTargetCollisionGroup,handedness:this._myHandedness+1}),this._myCursorComponentNonXR.rayCastMode=0,this._myPulseOnHover&&this._myCursorComponentNonXR.globalTarget.onHover.add(this._pulseOnHover.bind(this),{id:this}),this._myCursorComponentNonXR.pp_setViewComponent(r.getPlayerObjects(this.engine).myCameraNonXR.pp_getComponent(OA));let e=null,t=.0125;if(this._myShowFingerCursor){e=this._myToolCursorObject.pp_addObject();let n=e.pp_addComponent(tb);n.mesh=r.getDefaultMeshes(this.engine).mySphere,n.material=r.getDefaultMaterials(this.engine).myFlatOpaque.clone(),n.material.color=this._myCursorColor,e.pp_setScale(t)}this._myFingerCursorObject=this._myToolCursorObject.pp_addObject(),this._myFingerCursorComponent=this._myFingerCursorObject.pp_addComponent(Si,{_myHandedness:this._myHandedness,_myMultipleClicksEnabled:!0,_myCollisionGroup:this._myCursorTargetCollisionGroup,_myCollisionSize:t,_myCursorObject:e}),this._myCursorComponentXR.active=!1,this._myCursorComponentNonXR.active=!1,this._myFingerCursorComponent.active=!1}update(e){}_isUsingHand(){let e=!1;if(B.getSession(this.engine)&&B.getSession(this.engine).inputSources)for(let t=0;t<B.getSession(this.engine).inputSources.length;t++){let n=B.getSession(this.engine).inputSources[t];if(n.hand&&n.handedness==this._myHandednessType){e=!0;break}}return e}_pulseOnHover(e){let t=e.pp_getComponent(BA);t&&!t.isSurface&&(this._myHandedness==0?r.getLeftGamepad(this.engine)!=null&&r.getLeftGamepad(this.engine).pulse(.4,0):r.getRightGamepad(this.engine)!=null&&r.getRightGamepad(this.engine).pulse(.4,0))}onDestroy(){this._myCursorComponentXR.globalTarget.onHover.remove(this),this._myCursorComponentNonXR.globalTarget.onHover.remove(this)}};R(Ki,"TypeName","pp-tool-cursor"),R(Ki,"Properties",{_myHandedness:$r.enum(["Left","Right"],"Left"),_myApplyDefaultCursorOffset:$r.bool(!0),_myPulseOnHover:$r.bool(!1),_myShowFingerCursor:$r.bool(!1)});Ki.prototype.update=function(){let i=j();return function(t){let n=this._isUsingHand();this._myFingerCursorComponent.active=n,n?(this._myCursorComponentXR.active=!1,this._myCursorComponentNonXR.active=!1):B.isSessionActive(this.engine)?(this._myCursorComponentXR.active=!n,this._myCursorComponentNonXR.active=!1):(this._myCursorComponentNonXR.active=!n,this._myCursorComponentXR.active=!1,this._myCursorObjectNonXR.pp_setTransformQuat(r.getPlayerObjects(this.engine).myCameraNonXR.pp_getTransformQuat(i)))}}();import{Alignment as nb,Collider as IA,Justification as ob}from"@wonderlandengine/api";var pe={DEBUG:0,WARN:1,ERROR:2,LOG:3,INFO:4,ASSERT:5},Oe={BROWSER_CONSOLE:0,CONSOLE_VR:1,WINDOW:2},ba={NEVER:0,ALWAYS:1,WHEN_HIDDEN:2},k={DEBUG:0,WARN:1,ERROR:2,LOG:3};var Sa=class{constructor(){this._setupBuildConfig(),this._setupRuntimeConfig()}_setupBuildConfig(){this.myBackgroundColor=w(46/255,46/255,46/255,1),this.myCursorTargetCollisionCollider=IA.Box,this.myCursorTargetCollisionGroup=7,this.myCursorTargetCollisionThickness=.001,this.myDefaultTextColor=w(255/255,255/255,255/255,1),this.myTextAlignment=nb.Center,this.myTextJustification=ob.Middle,this.myTextColor=this.myDefaultTextColor,this.myMessageTypeColors=[],this.myMessageTypeColors[k.LOG]=this.myDefaultTextColor,this.myMessageTypeColors[k.ERROR]=w(255/255,40/255,40/255,1),this.myMessageTypeColors[k.WARN]=w(250/255,220/255,40/255,1),this.myMessageTypeColors[k.DEBUG]=w(60/255,200/255,255/255,1),this.myMessagesPanelPosition=m(0,.075,0),this.myMessagesBackgroundScale=m(.34,.15,1);{let e=.03,t=e*this.myMessagesBackgroundScale[0]/this.myMessagesBackgroundScale[1]*.8,n=-this.myMessagesBackgroundScale[0]+this.myMessagesBackgroundScale[0]*e,o=this.myMessagesBackgroundScale[1]-this.myMessagesBackgroundScale[1]*t;this.myMessagesTextsPanelPosition=m(n,o,.007)}this.myMessagesTextsPanelScale=m(.1,.1,.1),this.myMessagesTextStartString=`.
`,this.myMessagesTextAlignment=nb.Left,this.myMessagesTextJustification=ob.Top,this.myMessagesTextPositions=[],this.myMessagesTextPositions[k.LOG]=m(0,0,2e-4),this.myMessagesTextPositions[k.ERROR]=m(0,0,0),this.myMessagesTextPositions[k.WARN]=m(0,0,0),this.myMessagesTextPositions[k.DEBUG]=m(0,0,0),this.myMessagesTextColors=[],this.myMessagesTextColors[k.LOG]=this.myMessageTypeColors[k.LOG],this.myMessagesTextColors[k.ERROR]=this.myMessageTypeColors[k.ERROR],this.myMessagesTextColors[k.WARN]=this.myMessageTypeColors[k.WARN],this.myMessagesTextColors[k.DEBUG]=this.myMessageTypeColors[k.DEBUG],this.myButtonsPanelPosition=m(0,-.11,.015),this.myButtonBackgroundScale=m(.04,.02,1),this.myButtonTextPosition=m(0,0,.007),this.myButtonTextScale=m(.18,.18,.18),this.myButtonCursorTargetPosition=m(0,0,0),this.myButtonCursorTargetPosition[2]=this.myButtonTextPosition[2],this.myButtonsCollisionCollider=this.myCursorTargetCollisionCollider,this.myButtonsCollisionGroup=this.myCursorTargetCollisionGroup,this.myButtonsCollisionExtents=this.myButtonBackgroundScale.pp_clone(),this.myButtonsCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myClearButtonTextLabel="clear",this.myUpButtonTextLabel="up",this.myDownButtonTextLabel="down",this.myFilterButtonsTextColors=[],this.myFilterButtonsTextColors[k.LOG]=this.myMessageTypeColors[k.LOG],this.myFilterButtonsTextColors[k.ERROR]=this.myMessageTypeColors[k.ERROR],this.myFilterButtonsTextColors[k.WARN]=this.myMessageTypeColors[k.WARN],this.myFilterButtonsTextColors[k.DEBUG]=this.myMessageTypeColors[k.DEBUG],this.myFilterButtonsTextLabel=[],this.myFilterButtonsTextLabel[k.LOG]="log",this.myFilterButtonsTextLabel[k.ERROR]="error",this.myFilterButtonsTextLabel[k.WARN]="warn",this.myFilterButtonsTextLabel[k.DEBUG]="debug";{let e=7,t=Math.max(.68,this.myButtonBackgroundScale[0]*e),n=2+3+4+4+1+2,o=Math.max((t-e*this.myButtonBackgroundScale[0]*2)/n,0),s=this.myButtonBackgroundScale[0],a=-t/2;this.myFilterButtonsPositions=[],this.myFilterButtonsPositions[k.LOG]=[a+o*2+s,0,0],this.myFilterButtonsPositions[k.ERROR]=[this.myFilterButtonsPositions[k.LOG][0]+s+o+s,0,0],this.myFilterButtonsPositions[k.WARN]=[this.myFilterButtonsPositions[k.ERROR][0]+s+o+s,0,0],this.myFilterButtonsPositions[k.DEBUG]=[this.myFilterButtonsPositions[k.WARN][0]+s+o+s,0,0],this.myClearButtonPosition=[this.myFilterButtonsPositions[k.DEBUG][0]+s+o*4+s,0,0],this.myUpButtonPosition=[this.myClearButtonPosition[0]+s+o*4+s,0,0],this.myDownButtonPosition=[this.myUpButtonPosition[0]+s+o+s,0,0]}this.myNotifyIconBackgroundScale=m(.01,.01,1),this.myNotifyIconPanelPositions=[],this.myNotifyIconPanelPositions[U.NONE]=m(0,0,0),this.myNotifyIconPanelPositions[U.NONE][0]=-this.myMessagesBackgroundScale[0]+this.myNotifyIconBackgroundScale[0]+.01,this.myNotifyIconPanelPositions[U.NONE][1]=-this.myMessagesBackgroundScale[1]+this.myNotifyIconBackgroundScale[1]+.01,this.myNotifyIconPanelPositions[U.NONE][2]=this.myMessagesTextsPanelPosition[2]-1e-5,this.myNotifyIconPanelPositions[U.LEFT]=this.myNotifyIconPanelPositions[U.NONE],this.myNotifyIconPanelPositions[U.RIGHT]=this.myNotifyIconPanelPositions[U.NONE],this.myNotifyIconCursorTargetPosition=m(0,0,0),this.myNotifyIconCursorTargetPosition[2]=this.myButtonsPanelPosition[2]+this.myButtonTextPosition[2]-this.myMessagesTextsPanelPosition[2],this.myNotifyIconCollisionExtents=this.myNotifyIconBackgroundScale.pp_clone(),this.myNotifyIconCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myNotifyIconColor=w(210/255,210/255,210/255,1),this.myPointerCollisionCollider=this.myCursorTargetCollisionCollider,this.myPointerCollisionGroup=this.myCursorTargetCollisionGroup;{let e=Math.abs(this.myMessagesPanelPosition[1]-this.myMessagesBackgroundScale[1]-(this.myButtonsPanelPosition[1]+this.myButtonBackgroundScale[1])),t=this.myMessagesBackgroundScale[1]+this.myButtonBackgroundScale[1]+e/2;this.myPointerCollisionExtents=m(this.myMessagesBackgroundScale[0],t,this.myCursorTargetCollisionThickness)}this.myPointerCursorTargetPosition=m(0,0,0),this.myPointerCursorTargetPosition[1]=this.myMessagesPanelPosition[1]+this.myMessagesBackgroundScale[1]-this.myPointerCollisionExtents[1],this.myPointerCursorTargetPosition[2]=this.myButtonsPanelPosition[2]+this.myButtonTextPosition[2]-1e-4}_setupRuntimeConfig(){this.myTabString="     ",this.myAssertStartString="Assertion failed:",this.myMaxCharactersPerLine=100,this.myMaxLineSplits=500,this.myMaxLines=22,this.myMaxMessages=2e3,this.myMaxMessagesDeletePad=2e3,this.myLinesBetweenMessages=1,this.myButtonHoverColor=w(150/255,150/255,150/255,1),this.myButtonDisabledTextColor=this.myBackgroundColor,this.myButtonDisabledBackgroundColor=w(110/255,110/255,110/255,1),this.myFilterButtonDisabledTextColor=this.myButtonDisabledTextColor,this.myFilterButtonDisabledBackgroundColor=this.myButtonDisabledBackgroundColor,this.myScrollDelay=.1,this.myScrollAmount=1,this.myScrollThumbstickHandedness=U.RIGHT,this.myScrollThumbstickDelay=.1,this.myScrollThumbstickMinThreshold=.2,this.myScrollThumbstickAmount=3,this.myPulseDelay=5,this.myPulseIntensity=.3,this.myPulseDuration=.085,this.myClearBrowserConsoleWhenClearPressed=!0,this.myGamepadScrollOnlyOnHover=!0}};import{CollisionComponent as cs,MeshComponent as ps,TextComponent as va}from"@wonderlandengine/api";import{CursorTarget as ds}from"@wonderlandengine/components";var xa=class{constructor(e=r.getMainEngine()){this._myEngine=e,this._myDestroyed=!1}build(e,t,n){this._myParentObject=e,this._myConfig=t,this._myParams=n,this._myPlaneMesh=r.getDefaultMeshes(this._myEngine).myPlane,this._createSkeleton(),this._setTransforms(),this._addComponents(),this._setTransformForNonXR(),B.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this._myEngine)}setVisible(e){this.myPivotObject.pp_setActive(e)}_createSkeleton(){this.myPivotObject=this._myParentObject.pp_addObject(),this._createMessagesSkeleton(),this._createButtonsSkeleton(),this._createPointerSkeleton()}_createMessagesSkeleton(){this.myMessagesPanel=this.myPivotObject.pp_addObject(),this.myMessagesBackground=this.myMessagesPanel.pp_addObject(),this.myMessagesTextsPanel=this.myMessagesPanel.pp_addObject(),this.myMessagesTexts=[];for(let e in k)this.myMessagesTexts[k[e]]=this.myMessagesTextsPanel.pp_addObject();this.myNotifyIconPanel=this.myMessagesPanel.pp_addObject(),this.myNotifyIconBackground=this.myNotifyIconPanel.pp_addObject(),this.myNotifyIconCursorTarget=this.myNotifyIconPanel.pp_addObject()}_createButtonsSkeleton(){this.myButtonsPanel=this.myPivotObject.pp_addObject(),this.myFilterButtonsPanels=[],this.myFilterButtonsBackgrounds=[],this.myFilterButtonsTexts=[],this.myFilterButtonsCursorTargets=[];for(let e in k)this.myFilterButtonsPanels[k[e]]=this.myButtonsPanel.pp_addObject(),this.myFilterButtonsBackgrounds[k[e]]=this.myFilterButtonsPanels[k[e]].pp_addObject(),this.myFilterButtonsTexts[k[e]]=this.myFilterButtonsPanels[k[e]].pp_addObject(),this.myFilterButtonsCursorTargets[k[e]]=this.myFilterButtonsPanels[k[e]].pp_addObject();this.myClearButtonPanel=this.myButtonsPanel.pp_addObject(),this.myClearButtonBackground=this.myClearButtonPanel.pp_addObject(),this.myClearButtonText=this.myClearButtonPanel.pp_addObject(),this.myClearButtonCursorTarget=this.myClearButtonPanel.pp_addObject(),this.myUpButtonPanel=this.myButtonsPanel.pp_addObject(),this.myUpButtonBackground=this.myUpButtonPanel.pp_addObject(),this.myUpButtonText=this.myUpButtonPanel.pp_addObject(),this.myUpButtonCursorTarget=this.myUpButtonPanel.pp_addObject(),this.myDownButtonPanel=this.myButtonsPanel.pp_addObject(),this.myDownButtonBackground=this.myDownButtonPanel.pp_addObject(),this.myDownButtonText=this.myDownButtonPanel.pp_addObject(),this.myDownButtonCursorTarget=this.myDownButtonPanel.pp_addObject()}_createPointerSkeleton(){this.myPointerCursorTarget=this.myPivotObject.pp_addObject()}_setTransforms(){this.myPivotObject.pp_markDirty(),this._setMessagesTransforms(),this._setButtonsTransforms(),this._setPointerTransform()}_setMessagesTransforms(){this.myMessagesPanel.pp_setPositionLocal(this._myConfig.myMessagesPanelPosition),this.myMessagesBackground.pp_scaleObject(this._myConfig.myMessagesBackgroundScale),this.myMessagesTextsPanel.pp_setPositionLocal(this._myConfig.myMessagesTextsPanelPosition),this.myMessagesTextsPanel.pp_scaleObject(this._myConfig.myMessagesTextsPanelScale);for(let e in k)this.myMessagesTexts[k[e]].pp_setPositionLocal(this._myConfig.myMessagesTextPositions[k[e]]);this.myNotifyIconPanel.pp_setPositionLocal(this._myConfig.myNotifyIconPanelPositions[this._myParams.myHandedness]),this.myNotifyIconBackground.pp_scaleObject(this._myConfig.myNotifyIconBackgroundScale),this.myNotifyIconCursorTarget.pp_setPositionLocal(this._myConfig.myNotifyIconCursorTargetPosition)}_setButtonsTransforms(){this.myButtonsPanel.pp_setPositionLocal(this._myConfig.myButtonsPanelPosition);for(let e in k)this.myFilterButtonsPanels[k[e]].pp_setPositionLocal(this._myConfig.myFilterButtonsPositions[k[e]]),this.myFilterButtonsBackgrounds[k[e]].pp_scaleObject(this._myConfig.myButtonBackgroundScale),this.myFilterButtonsTexts[k[e]].pp_setPositionLocal(this._myConfig.myButtonTextPosition),this.myFilterButtonsTexts[k[e]].pp_scaleObject(this._myConfig.myButtonTextScale),this.myFilterButtonsCursorTargets[k[e]].pp_setPositionLocal(this._myConfig.myButtonCursorTargetPosition);this.myClearButtonPanel.pp_setPositionLocal(this._myConfig.myClearButtonPosition),this.myClearButtonBackground.pp_scaleObject(this._myConfig.myButtonBackgroundScale),this.myClearButtonText.pp_setPositionLocal(this._myConfig.myButtonTextPosition),this.myClearButtonText.pp_scaleObject(this._myConfig.myButtonTextScale),this.myClearButtonCursorTarget.pp_setPositionLocal(this._myConfig.myButtonCursorTargetPosition),this.myUpButtonPanel.pp_setPositionLocal(this._myConfig.myUpButtonPosition),this.myUpButtonBackground.pp_scaleObject(this._myConfig.myButtonBackgroundScale),this.myUpButtonText.pp_setPositionLocal(this._myConfig.myButtonTextPosition),this.myUpButtonText.pp_scaleObject(this._myConfig.myButtonTextScale),this.myUpButtonCursorTarget.pp_setPositionLocal(this._myConfig.myButtonCursorTargetPosition),this.myDownButtonPanel.pp_setPositionLocal(this._myConfig.myDownButtonPosition),this.myDownButtonBackground.pp_scaleObject(this._myConfig.myButtonBackgroundScale),this.myDownButtonText.pp_setPositionLocal(this._myConfig.myButtonTextPosition),this.myDownButtonText.pp_scaleObject(this._myConfig.myButtonTextScale),this.myDownButtonCursorTarget.pp_setPositionLocal(this._myConfig.myButtonCursorTargetPosition)}_setPointerTransform(){this.myPointerCursorTarget.pp_setPositionLocal(this._myConfig.myPointerCursorTargetPosition)}_addComponents(){this._addMessagesComponents(),this._addButtonsComponents(),this._addPointerComponents()}_addMessagesComponents(){let e=this.myMessagesBackground.pp_addComponent(ps);e.mesh=this._myPlaneMesh,e.material=this._myParams.myPlaneMaterial.clone(),e.material.color=this._myConfig.myBackgroundColor,this.myMessagesTextComponents=[];for(let t in k){let n=this.myMessagesTexts[k[t]].pp_addComponent(va);n.alignment=this._myConfig.myMessagesTextAlignment,n.justification=this._myConfig.myMessagesTextJustification,n.material=this._myParams.myTextMaterial.clone(),n.material.color=this._myConfig.myMessagesTextColors[k[t]],n.lineSpacing=1.2,n.text=this._myConfig.myMessagesTextStartString,this.myMessagesTextComponents[k[t]]=n}this.myNotifyIconBackgroundComponent=this.myNotifyIconBackground.pp_addComponent(ps),this.myNotifyIconBackgroundComponent.mesh=this._myPlaneMesh,this.myNotifyIconBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myNotifyIconBackgroundComponent.material.color=this._myConfig.myNotifyIconColor,this.myNotifyIconCursorTargetComponent=this.myNotifyIconCursorTarget.pp_addComponent(ds),this.myNotifyIconCollisionComponent=this.myNotifyIconCursorTarget.pp_addComponent(cs),this.myNotifyIconCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myNotifyIconCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myNotifyIconCollisionComponent.extents=this._myConfig.myNotifyIconCollisionExtents}_addButtonsComponents(){this.myFilterButtonsBackgroundComponents=[],this.myFilterButtonsTextComponents=[],this.myFilterButtonsCursorTargetComponents=[],this.myFilterButtonsCollisionComponents=[];for(let e in k){let t=this.myFilterButtonsBackgrounds[k[e]].pp_addComponent(ps);t.mesh=this._myPlaneMesh,t.material=this._myParams.myPlaneMaterial.clone(),t.material.color=this._myConfig.myBackgroundColor;let n=this.myFilterButtonsTexts[k[e]].pp_addComponent(va);this._setupButtonTextComponent(n),n.material.color=this._myConfig.myFilterButtonsTextColors[k[e]],n.text=this._myConfig.myFilterButtonsTextLabel[k[e]];let o=this.myFilterButtonsCursorTargets[k[e]].pp_addComponent(ds),s=this.myFilterButtonsCursorTargets[k[e]].pp_addComponent(cs);s.collider=this._myConfig.myButtonsCollisionCollider,s.group=1<<this._myConfig.myButtonsCollisionGroup,s.extents=this._myConfig.myButtonsCollisionExtents,this.myFilterButtonsBackgroundComponents[k[e]]=t,this.myFilterButtonsTextComponents[k[e]]=n,this.myFilterButtonsCursorTargetComponents[k[e]]=o,this.myFilterButtonsCollisionComponents[k[e]]=s}{let e=this.myClearButtonBackground.pp_addComponent(ps);e.mesh=this._myPlaneMesh,e.material=this._myParams.myPlaneMaterial.clone(),e.material.color=this._myConfig.myBackgroundColor;let t=this.myClearButtonText.pp_addComponent(va);this._setupButtonTextComponent(t),t.text=this._myConfig.myClearButtonTextLabel;let n=this.myClearButtonCursorTarget.pp_addComponent(ds),o=this.myClearButtonCursorTarget.pp_addComponent(cs);o.collider=this._myConfig.myButtonsCollisionCollider,o.group=1<<this._myConfig.myButtonsCollisionGroup,o.extents=this._myConfig.myButtonsCollisionExtents,this.myClearButtonBackgroundComponent=e,this.myClearButtonTextComponent=t,this.myClearButtonCursorTargetComponent=n,this.myClearButtonCollisionComponent=o}{let e=this.myUpButtonBackground.pp_addComponent(ps);e.mesh=this._myPlaneMesh,e.material=this._myParams.myPlaneMaterial.clone(),e.material.color=this._myConfig.myBackgroundColor;let t=this.myUpButtonText.pp_addComponent(va);this._setupButtonTextComponent(t),t.text=this._myConfig.myUpButtonTextLabel;let n=this.myUpButtonCursorTarget.pp_addComponent(ds),o=this.myUpButtonCursorTarget.pp_addComponent(cs);o.collider=this._myConfig.myButtonsCollisionCollider,o.group=1<<this._myConfig.myButtonsCollisionGroup,o.extents=this._myConfig.myButtonsCollisionExtents,this.myUpButtonBackgroundComponent=e,this.myUpButtonTextComponent=t,this.myUpButtonCursorTargetComponent=n,this.myUpButtonCollisionComponent=o}{let e=this.myDownButtonBackground.pp_addComponent(ps);e.mesh=this._myPlaneMesh,e.material=this._myParams.myPlaneMaterial.clone(),e.material.color=this._myConfig.myBackgroundColor;let t=this.myDownButtonText.pp_addComponent(va);this._setupButtonTextComponent(t),t.text=this._myConfig.myDownButtonTextLabel;let n=this.myDownButtonCursorTarget.pp_addComponent(ds),o=this.myDownButtonCursorTarget.pp_addComponent(cs);o.collider=this._myConfig.myButtonsCollisionCollider,o.group=1<<this._myConfig.myButtonsCollisionGroup,o.extents=this._myConfig.myButtonsCollisionExtents,this.myDownButtonBackgroundComponent=e,this.myDownButtonTextComponent=t,this.myDownButtonCursorTargetComponent=n,this.myDownButtonCollisionComponent=o}}_addPointerComponents(){this.myPointerCursorTargetComponent=this.myPointerCursorTarget.pp_addComponent(ds),this.myPointerCursorTargetComponent.isSurface=!0;let e=this.myPointerCursorTarget.pp_addComponent(cs);e.collider=this._myConfig.myPointerCollisionCollider,e.group=1<<this._myConfig.myPointerCollisionGroup,e.extents=this._myConfig.myPointerCollisionExtents,this.myPointerCollisionComponent=e}_setupButtonTextComponent(e){e.alignment=this._myConfig.myTextAlignment,e.justification=this._myConfig.myTextJustification,e.material=this._myParams.myTextMaterial.clone(),e.material.color=this._myConfig.myTextColor,e.text=""}_onXRSessionStart(){this._setTransformForXR()}_onXRSessionEnd(){this._setTransformForNonXR()}_setTransformForXR(){this.myNotifyIconPanel.pp_setPositionLocal(this._myConfig.myNotifyIconPanelPositions[this._myParams.myHandedness])}_setTransformForNonXR(){this.myNotifyIconPanel.pp_setPositionLocal(this._myConfig.myNotifyIconPanelPositions[U.NONE])}destroy(){this._myDestroyed=!0,B.unregisterSessionStartEndEventListeners(this,this._myEngine)}isDestroyed(){return this._myDestroyed}};import{Emitter as mb}from"@wonderlandengine/api";import{Alignment as HA,Collider as LA,Justification as kA}from"@wonderlandengine/api";var Ma=class{constructor(e,t){this._setupBuildConfig(e,t),this._setupRuntimeConfig()}_setupBuildConfig(e,t){this.myBackgroundColor=w(46/255,46/255,46/255,1),this.myCursorTargetCollisionCollider=LA.Box,this.myCursorTargetCollisionGroup=7,this.myCursorTargetCollisionThickness=.001,this.myDefaultTextColor=w(255/255,255/255,255/255,1),this.myTextAlignment=HA.Center,this.myTextJustification=kA.Middle,this.myTextColor=this.myDefaultTextColor,this.myButtonTextScale=m(.18,.18,.18),this.myVisibilityButtonBackgroundScale=m(.015,.015,1),this.myVisibilityButtonTextPosition=m(0,0,.007),this.myVisibilityButtonTextScale=this.myButtonTextScale;let n=.01,o=this.myVisibilityButtonBackgroundScale[0]*(2*t)+n*t;this.myVisibilityButtonPosition=[],this.myVisibilityButtonPosition[U.NONE]={},this.myVisibilityButtonPosition[U.NONE].myPosition=m(-.3+o,-.205,.035),this.myVisibilityButtonPosition[U.LEFT]={},this.myVisibilityButtonPosition[U.LEFT].myPosition=m(-.2+o,.025,.015),this.myVisibilityButtonPosition[U.RIGHT]={},this.myVisibilityButtonPosition[U.RIGHT].myPosition=m(.2-o,.025,.015),this.myVisibilityButtonText=e,this.myVisibilityButtonCursorTargetPosition=m(0,0,0),this.myVisibilityButtonCursorTargetPosition[2]=this.myVisibilityButtonTextPosition[2],this.myVisibilityButtonCollisionExtents=this.myVisibilityButtonBackgroundScale.pp_clone(),this.myVisibilityButtonCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myFlagButtonBackgroundScale=m(.0125,.0125,1),this.myFlagButtonTextPosition=m(0,0,.007),this.myFlagButtonTextScale=m(.15,.15,.15);let s=.0075,a=0,l=this.myVisibilityButtonBackgroundScale[1]+this.myFlagButtonBackgroundScale[1]+s+this.myFlagButtonBackgroundScale[1]*(2*a)+s*a;this.myPinButtonPosition=[],this.myPinButtonPosition[U.NONE]={},this.myPinButtonPosition[U.NONE].myPosition=this.myVisibilityButtonPosition[U.NONE].myPosition.pp_clone(),this.myPinButtonPosition[U.NONE].myPosition[1]+=l,this.myPinButtonPosition[U.LEFT]={},this.myPinButtonPosition[U.LEFT].myPosition=this.myVisibilityButtonPosition[U.LEFT].myPosition.pp_clone(),this.myPinButtonPosition[U.LEFT].myPosition[1]+=l,this.myPinButtonPosition[U.RIGHT]={},this.myPinButtonPosition[U.RIGHT].myPosition=this.myVisibilityButtonPosition[U.RIGHT].myPosition.pp_clone(),this.myPinButtonPosition[U.RIGHT].myPosition[1]+=l,this.myPinButtonText="P",this.myPinButtonCursorTargetPosition=m(0,0,0),this.myPinButtonCursorTargetPosition[2]=this.myFlagButtonTextPosition[2],this.myPinButtonCollisionExtents=this.myFlagButtonBackgroundScale.pp_clone(),this.myPinButtonCollisionExtents[2]=this.myCursorTargetCollisionThickness}_setupRuntimeConfig(){this._initializeObjectsTransforms(),this.myButtonHoverColor=w(150/255,150/255,150/255,1),this.myButtonDisabledTextColor=this.myBackgroundColor,this.myButtonDisabledBackgroundColor=w(110/255,110/255,110/255,1)}_initializeObjectsTransforms(){this.myPivotObjectTransforms=this._createDefaultObjectTransforms(),this.myPivotObjectTransforms[Ee.GAMEPAD][U.LEFT].myRotation=z(-.645,.425,.25,.584),this.myPivotObjectTransforms[Ee.GAMEPAD][U.LEFT].myRotation.quat_normalize(this.myPivotObjectTransforms[Ee.GAMEPAD][U.LEFT].myRotation),this.myPivotObjectTransforms[Ee.GAMEPAD][U.RIGHT].myRotation=z(-.645,-.425,-.25,.584),this.myPivotObjectTransforms[Ee.GAMEPAD][U.RIGHT].myRotation.quat_normalize(this.myPivotObjectTransforms[Ee.GAMEPAD][U.RIGHT].myRotation),this.myPivotObjectTransforms[Ee.TRACKED_HAND][U.LEFT].myRotation=z(-.645,.425,.25,.584),this.myPivotObjectTransforms[Ee.TRACKED_HAND][U.LEFT].myRotation.quat_normalize(this.myPivotObjectTransforms[Ee.GAMEPAD][U.LEFT].myRotation),this.myPivotObjectTransforms[Ee.TRACKED_HAND][U.RIGHT].myRotation=z(-.645,-.425,-.25,.584),this.myPivotObjectTransforms[Ee.TRACKED_HAND][U.RIGHT].myRotation.quat_normalize(this.myPivotObjectTransforms[Ee.GAMEPAD][U.RIGHT].myRotation),this.myWidgetObjectTransforms=this._createDefaultObjectTransforms(),this.myWidgetObjectTransforms[Ee.GAMEPAD][U.LEFT].myPosition=m(.1,.23,-.02),this.myWidgetObjectTransforms[Ee.GAMEPAD][U.RIGHT].myPosition=m(.07,.23,-.02),this.myWidgetObjectTransforms[Ee.TRACKED_HAND][U.LEFT].myPosition=m(.1,.23,-.02),this.myWidgetObjectTransforms[Ee.TRACKED_HAND][U.RIGHT].myPosition=m(.07,.23,-.02),this._myPivotObjectDistanceFromHeadNonXR=.6}_createDefaultObjectTransforms(){let e=[];for(let t in Ee){let n=Ee[t];e[n]=[];for(let o in U){let s=U[o];e[n][s]={},e[n][s].myPosition=m(0,0,0),e[n][s].myRotation=z(0,0,0,1)}}return e}};import{CollisionComponent as sb,MeshComponent as ab,TextComponent as rb}from"@wonderlandengine/api";import{CursorTarget as lb}from"@wonderlandengine/components";var Ea=class{constructor(e=r.getMainEngine()){this._myInputSourceType=null,this._myParentObject=null,this._myPinned=!1,this._myWidgetVisible=!0,this._myVisibilityButtonVisible=!0,this._myEngine=e,this._myDestroyed=!1}build(e,t,n){this._myParentObject=e,this._myConfig=t,this._myParams=n,this._myPlaneMesh=r.getDefaultMeshes(this._myEngine).myPlane,this._createSkeleton(),this._setTransforms(),this._addComponents(),this._setTransformForNonXR(),B.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this._myEngine)}setWidgetVisible(e){this._myWidgetVisible=e,this.myFlagsButtonPanel.pp_setActive(e),e&&this._updateObjectsTransforms(!0)}setVisibilityButtonVisible(e){this._myVisibilityButtonVisible=e,this.myVisibilityButtonPanel.pp_setActive(e)}setPinned(e){e!=this._myPinned&&(this._myPinned=e,this._myPinned?this.myPivotObject.pp_setParent(r.getSceneObjects(this._myEngine).myTools):(this.myPivotObject.pp_setParent(this.myFixForwardObject),B.isSessionActive(this._myEngine)||this._setTransformForNonXR(),this._updateObjectsTransforms(!0)))}update(e){this._updateObjectsTransforms(!1)}_updateObjectsTransforms(e){if(B.isSessionActive(this._myEngine)){let t=ee.getInputSourceTypeByHandedness(this._myParams.myHandedness,this._myEngine);(t!=this._myInputSourceType||e)&&(this._myInputSourceType=t,this._myPinned||(this.myPivotObject.pp_setPositionLocal(this._myConfig.myPivotObjectTransforms[this._myInputSourceType][this._myParams.myHandedness].myPosition),this.myPivotObject.pp_resetRotationLocal(),this.myPivotObject.pp_rotateObjectQuat(this._myConfig.myPivotObjectTransforms[this._myInputSourceType][this._myParams.myHandedness].myRotation),this.myWidgetObject.pp_setPositionLocal(this._myConfig.myWidgetObjectTransforms[this._myInputSourceType][this._myParams.myHandedness].myPosition),this.myWidgetObject.pp_resetRotationLocal(),this.myWidgetObject.pp_rotateObjectQuat(this._myConfig.myWidgetObjectTransforms[this._myInputSourceType][this._myParams.myHandedness].myRotation),this.myVisibilityButtonPanel.pp_setPositionLocal(this._myConfig.myVisibilityButtonPosition[this._myParams.myHandedness].myPosition),this.myPinButtonPanel.pp_setPositionLocal(this._myConfig.myPinButtonPosition[this._myParams.myHandedness].myPosition)))}else this.myVisibilityButtonPanel.pp_setActive(this._myWidgetVisible||this._myVisibilityButtonVisible)}_createSkeleton(){this.myFixForwardObject=this._myParentObject.pp_addObject(),r.isPoseForwardFixed(this._myEngine)&&this.myFixForwardObject.pp_rotateObject(m(0,180,0)),this.myPivotObject=this.myFixForwardObject.pp_addObject(),this.myWidgetObject=this.myPivotObject.pp_addObject(),this.myVisibilityButtonPanel=this.myPivotObject.pp_addObject(),this.myVisibilityButtonBackground=this.myVisibilityButtonPanel.pp_addObject(),this.myVisibilityButtonText=this.myVisibilityButtonPanel.pp_addObject(),this.myVisibilityButtonCursorTarget=this.myVisibilityButtonPanel.pp_addObject(),this.myFlagsButtonPanel=this.myPivotObject.pp_addObject(),this.myPinButtonPanel=this.myFlagsButtonPanel.pp_addObject(),this.myPinButtonBackground=this.myPinButtonPanel.pp_addObject(),this.myPinButtonText=this.myPinButtonPanel.pp_addObject(),this.myPinButtonCursorTarget=this.myPinButtonPanel.pp_addObject(),this.myNonXRParentObject=r.getPlayerObjects(this._myEngine).myCameraNonXR.pp_addObject(),this.myNonXRParentObject.pp_translateLocal(m(0,0,-this._myConfig._myPivotObjectDistanceFromHeadNonXR)),this.myNonXRParentObject.pp_lookToLocal(m(0,0,1),m(0,1,0))}_setTransforms(){this.myPivotObject.pp_markDirty(),this.myVisibilityButtonPanel.pp_setPositionLocal(this._myConfig.myVisibilityButtonPosition[this._myParams.myHandedness].myPosition),this.myVisibilityButtonBackground.pp_scaleObject(this._myConfig.myVisibilityButtonBackgroundScale),this.myVisibilityButtonText.pp_setPositionLocal(this._myConfig.myVisibilityButtonTextPosition),this.myVisibilityButtonText.pp_scaleObject(this._myConfig.myVisibilityButtonTextScale),this.myVisibilityButtonCursorTarget.pp_setPositionLocal(this._myConfig.myVisibilityButtonCursorTargetPosition),this.myPinButtonPanel.pp_setPositionLocal(this._myConfig.myPinButtonPosition[this._myParams.myHandedness].myPosition),this.myPinButtonBackground.pp_scaleObject(this._myConfig.myFlagButtonBackgroundScale),this.myPinButtonText.pp_setPositionLocal(this._myConfig.myFlagButtonTextPosition),this.myPinButtonText.pp_scaleObject(this._myConfig.myFlagButtonTextScale),this.myPinButtonCursorTarget.pp_setPositionLocal(this._myConfig.myPinButtonCursorTargetPosition)}_addComponents(){this.myVisibilityButtonBackgroundComponent=this.myVisibilityButtonBackground.pp_addComponent(ab),this.myVisibilityButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myVisibilityButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myVisibilityButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myVisibilityButtonTextComponent=this.myVisibilityButtonText.pp_addComponent(rb),this._setupButtonTextComponent(this.myVisibilityButtonTextComponent),this.myVisibilityButtonTextComponent.text=this._myConfig.myVisibilityButtonText,this.myVisibilityButtonCursorTargetComponent=this.myVisibilityButtonCursorTarget.pp_addComponent(lb),this.myVisibilityButtonCollisionComponent=this.myVisibilityButtonCursorTarget.pp_addComponent(sb),this.myVisibilityButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myVisibilityButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myVisibilityButtonCollisionComponent.extents=this._myConfig.myVisibilityButtonCollisionExtents,this.myPinButtonBackgroundComponent=this.myPinButtonBackground.pp_addComponent(ab),this.myPinButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPinButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myPinButtonBackgroundComponent.material.color=this._myConfig.myButtonDisabledBackgroundColor,this.myPinButtonTextComponent=this.myPinButtonText.pp_addComponent(rb),this._setupButtonTextComponent(this.myPinButtonTextComponent),this.myPinButtonTextComponent.material.color=this._myConfig.myButtonDisabledTextColor,this.myPinButtonTextComponent.text=this._myConfig.myPinButtonText,this.myPinButtonCursorTargetComponent=this.myPinButtonCursorTarget.pp_addComponent(lb),this.myPinButtonCollisionComponent=this.myPinButtonCursorTarget.pp_addComponent(sb),this.myPinButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPinButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPinButtonCollisionComponent.extents=this._myConfig.myPinButtonCollisionExtents}_setupButtonTextComponent(e){e.alignment=this._myConfig.myTextAlignment,e.justification=this._myConfig.myTextJustification,e.material=this._myParams.myTextMaterial.clone(),e.material.color=this._myConfig.myTextColor,e.text=""}_onXRSessionStart(){this.myVisibilityButtonPanel.pp_setActive(this._myVisibilityButtonVisible),this._setTransformForXR()}_onXRSessionEnd(){this._setTransformForNonXR()}_setTransformForXR(){this.myFixForwardObject.pp_setParent(this._myParentObject),this.myFixForwardObject.pp_resetTransformLocal(),r.isPoseForwardFixed(this._myEngine)&&this.myFixForwardObject.pp_rotateObject(m(0,180,0)),this._updateObjectsTransforms(!0)}_setTransformForNonXR(){this._myPinned||(this.myFixForwardObject.pp_setParent(this.myNonXRParentObject),this.myFixForwardObject.pp_resetTransformLocal(),this.myPivotObject.pp_setPositionLocal(this._myConfig.myPivotObjectTransforms[Ee.NONE][U.NONE].myPosition),this.myPivotObject.pp_resetRotationLocal(),this.myPivotObject.pp_rotateObjectQuat(this._myConfig.myPivotObjectTransforms[Ee.NONE][U.NONE].myRotation),this.myWidgetObject.pp_setPositionLocal(this._myConfig.myWidgetObjectTransforms[Ee.NONE][U.NONE].myPosition),this.myWidgetObject.pp_resetRotationLocal(),this.myWidgetObject.pp_rotateObjectQuat(this._myConfig.myWidgetObjectTransforms[Ee.NONE][U.NONE].myRotation),this.myVisibilityButtonPanel.pp_setPositionLocal(this._myConfig.myVisibilityButtonPosition[U.NONE].myPosition),this.myPinButtonPanel.pp_setPositionLocal(this._myConfig.myPinButtonPosition[U.NONE].myPosition))}destroy(){this._myDestroyed=!0,B.unregisterSessionStartEndEventListeners(this,this._myEngine)}isDestroyed(){return this._myDestroyed}};var Eo=class{constructor(){this.myHandedness=U.NONE,this.myPlaneMaterial=null,this.myTextMaterial=null}},Do=class{constructor(e,t,n=r.getMainEngine()){this._myWidgetVisible=!0,this._myPinned=!1,this._myConfig=new Ma(e,t),this._myParams=null,this._myUI=new Ea(n),this._myShowVisibilityButton=!1,this._myWidgetVisibleChangedEmitter=new mb,this._myPinChangedEmitter=new mb,this._myDestroyed=!0}getWidgetObject(){return this._myUI.myWidgetObject}setVisible(e){this._myWidgetVisible=!e,this._toggleVisibility(!1,!0)}isVisible(){return this._myWidgetVisible}toggleVisibility(){this._toggleVisibility(!1,!0)}togglePin(){this._togglePin(!1)}registerWidgetVisibleChangedEventListener(e,t){this._myWidgetVisibleChangedEmitter.add(t,{id:e})}unregisterWidgetVisibleChangedEventListener(e){this._myWidgetVisibleChangedEmitter.remove(e)}registerPinChangedEventListener(e,t){this._myPinChangedEmitter.add(t,{id:e})}unregisterPinChangedEventListener(e){this._myPinChangedEmitter.remove(e)}start(e,t){this._myParams=t,this._myUI.build(e,this._myConfig,t),this._myUI.setVisibilityButtonVisible(t.myShowVisibilityButton),this._myShowVisibilityButton=t.myShowVisibilityButton,t.myShowOnStart||this._toggleVisibility(!1,!1),this._addListeners()}update(e){this._myUI.update(e)}_addListeners(){let e=this._myUI;e.myPinButtonCursorTargetComponent.onClick.add(this._togglePin.bind(this,!0)),e.myPinButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myPinButtonBackgroundComponent.material)),e.myPinButtonCursorTargetComponent.onUnhover.add(this._pinUnHover.bind(this,e.myPinButtonBackgroundComponent.material)),e.myVisibilityButtonCursorTargetComponent.onClick.add(this._toggleVisibility.bind(this,!0,!0)),e.myVisibilityButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myVisibilityButtonBackgroundComponent.material)),e.myVisibilityButtonCursorTargetComponent.onUnhover.add(this._visibilityUnHover.bind(this,e.myVisibilityButtonBackgroundComponent.material))}_toggleVisibility(e,t){this._myWidgetVisible=!this._myWidgetVisible,this._myUI.setWidgetVisible(this._myWidgetVisible);let n=this._myUI.myVisibilityButtonTextComponent.material,o=this._myUI.myVisibilityButtonBackgroundComponent.material;this._myWidgetVisible?(n.color=this._myConfig.myDefaultTextColor,e||(o.color=this._myConfig.myBackgroundColor)):(n.color=this._myConfig.myButtonDisabledTextColor,e||(o.color=this._myConfig.myButtonDisabledBackgroundColor)),t&&this._myWidgetVisibleChangedEmitter.notify(this._myWidgetVisible),this._myUI.setVisibilityButtonVisible(this._myShowVisibilityButton)}_togglePin(e){if(this._myWidgetVisible){this._myPinned=!this._myPinned,this._myUI.setPinned(this._myPinned);let t=this._myUI.myPinButtonTextComponent.material,n=this._myUI.myPinButtonBackgroundComponent.material;this._myPinned?(t.color=this._myConfig.myDefaultTextColor,e||(n.color=this._myConfig.myBackgroundColor)):(t.color=this._myConfig.myButtonDisabledTextColor,e||(n.color=this._myConfig.myButtonDisabledBackgroundColor)),this._myPinChangedEmitter.notify(this._myPinned)}}_genericHover(e){e.color=this._myConfig.myButtonHoverColor}_visibilityUnHover(e){this._myWidgetVisible?e.color=this._myConfig.myBackgroundColor:e.color=this._myConfig.myButtonDisabledBackgroundColor}_pinUnHover(e){this._myPinned?e.color=this._myConfig.myBackgroundColor:e.color=this._myConfig.myButtonDisabledBackgroundColor}destroy(){this._myDestroyed=!0,this._myUI!=null&&this._myUI.destroy()}isDestroyed(){return this._myDestroyed}};var FA=console.log,wA=console.error,jA=console.warn,zA=console.info,NA=console.debug,GA=console.assert,UA=console.clear;function yb(){return FA}function ub(){return wA}function hb(){return jA}function cb(){return zA}function pb(){return NA}function db(){return GA}function _b(){return UA}var qt={getConsoleOriginalLog:yb,getConsoleOriginalError:ub,getConsoleOriginalWarn:hb,getConsoleOriginalInfo:cb,getConsoleOriginalDebug:pb,getConsoleOriginalAssert:db,getConsoleOriginalClear:_b};var Da=class extends Eo{constructor(){super(),this.myOverrideBrowserConsole=!1,this.myShowOnStart=!1,this.myShowVisibilityButton=!1,this.myPulseOnNewMessage=ba.NEVER}},el=class{constructor(e,t){this.myType=e,this.myLines=t,this._myOriginalText=t.join(`
`),this._myMessagesCount=1}hasSameInfo(e){return this._myOriginalText==e._myOriginalText&&this.myType==e.myType}increaseCount(){this._myMessagesCount+=1;let e="(x".concat(this._myMessagesCount).concat(") "),t=this._myOriginalText.slice(0);t=e.concat(t),this.myLines=t.split(`
`)}},Ra=class{constructor(e=r.getMainEngine()){this._myWidgetFrame=new Do("C",0,e),this._myWidgetFrame.registerWidgetVisibleChangedEventListener(this,this._widgetVisibleChanged.bind(this)),this._myConfig=new Sa,this._myParams=null,this._myUI=new xa(e),this._myMessages=[],this._myOldBrowserConsole=[],this._myOldConsoleVR=[],this._myTypeFilters=[];for(let t in k)this._myTypeFilters[k[t]]=!1;this._myScrollUp=!1,this._myScrollDown=!1,this._myScrollOffset=0,this._myScrollTimer=0,this._myScrollThumbstickTimer=0,this._myPulseTimer=0,this._myGamepadScrollEnabled=!0,this._myConfig.myGamepadScrollOnlyOnHover&&(this._myGamepadScrollEnabled=!1),this._myErrorEventListener=null,this._myUnhandledRejectionEventListener=null,this._myEngine=e,this._myDestroyed=!1}setVisible(e){this._myWidgetFrame.setVisible(e)}isVisible(){return this._myWidgetFrame.isVisible()}start(e,t){this._myLeftGamepad=r.getLeftGamepad(this._myEngine),this._myRightGamepad=r.getRightGamepad(this._myEngine),this._myParams=t,this._myWidgetFrame.start(e,t),this._myUI.build(this._myWidgetFrame.getWidgetObject(),this._myConfig,t),this._myUI.setVisible(this._myWidgetFrame.isVisible()),this._setNotifyIconActive(!1),this._addListeners(),this._overrideConsolesFunctions()}_overrideConsolesFunctions(){this._myOldBrowserConsole[pe.LOG]=console.log,this._myOldBrowserConsole[pe.ERROR]=console.error,this._myOldBrowserConsole[pe.WARN]=console.warn,this._myOldBrowserConsole[pe.INFO]=console.info,this._myOldBrowserConsole[pe.DEBUG]=console.debug,this._myOldBrowserConsole[pe.ASSERT]=console.assert,this._myOldBrowserConsoleClear=console.clear,this._myParams.myOverrideBrowserConsole&&(console.log=this._consolePrint.bind(this,pe.LOG,Oe.BROWSER_CONSOLE),console.error=this._consolePrint.bind(this,pe.ERROR,Oe.BROWSER_CONSOLE),console.warn=this._consolePrint.bind(this,pe.WARN,Oe.BROWSER_CONSOLE),console.info=this._consolePrint.bind(this,pe.INFO,Oe.BROWSER_CONSOLE),console.debug=this._consolePrint.bind(this,pe.DEBUG,Oe.BROWSER_CONSOLE),console.assert=this._consolePrint.bind(this,pe.ASSERT,Oe.BROWSER_CONSOLE),console.clear=this._clearConsole.bind(this,!0,Oe.BROWSER_CONSOLE),this._myErrorEventListener=function(e){e.error!=null?this._consolePrint(pe.ERROR,Oe.WINDOW,"Uncaught",e.error.stack):this._consolePrint(pe.ERROR,Oe.WINDOW,"Uncaught",e.message)}.bind(this),this._myUnhandledRejectionEventListener=function(e){this._consolePrint(pe.ERROR,Oe.WINDOW,"Uncaught (in promise)",e.reason)}.bind(this),r.getWindow(this._myEngine).addEventListener("error",this._myErrorEventListener),r.getWindow(this._myEngine).addEventListener("unhandledrejection",this._myUnhandledRejectionEventListener)),this._myOldConsoleVR[pe.LOG]=r.getConsoleVR(this._myEngine).log,this._myOldConsoleVR[pe.ERROR]=r.getConsoleVR(this._myEngine).error,this._myOldConsoleVR[pe.WARN]=r.getConsoleVR(this._myEngine).warn,this._myOldConsoleVR[pe.INFO]=r.getConsoleVR(this._myEngine).info,this._myOldConsoleVR[pe.DEBUG]=r.getConsoleVR(this._myEngine).debug,this._myOldConsoleVR[pe.ASSERT]=r.getConsoleVR(this._myEngine).assert,this._myOldConsoleVRClear=r.getConsoleVR(this._myEngine).clear,r.getConsoleVR(this._myEngine).log=this._consolePrint.bind(this,pe.LOG,Oe.CONSOLE_VR),r.getConsoleVR(this._myEngine).error=this._consolePrint.bind(this,pe.ERROR,Oe.CONSOLE_VR),r.getConsoleVR(this._myEngine).warn=this._consolePrint.bind(this,pe.WARN,Oe.CONSOLE_VR),r.getConsoleVR(this._myEngine).info=this._consolePrint.bind(this,pe.INFO,Oe.CONSOLE_VR),r.getConsoleVR(this._myEngine).debug=this._consolePrint.bind(this,pe.DEBUG,Oe.CONSOLE_VR),r.getConsoleVR(this._myEngine).assert=this._consolePrint.bind(this,pe.ASSERT,Oe.CONSOLE_VR),r.getConsoleVR(this._myEngine).clear=this._clearConsole.bind(this,!0,Oe.CONSOLE_VR)}update(e){this._myWidgetFrame.update(e),this._myWidgetFrame.isVisible()&&this._updateScroll(e),this._updateGamepadsExtraActions(e)}_updateText(e){let t="";if(!this._myTypeFilters[e]){let n=0,o=this._myMessages.length-1,s=Math.round(this._myScrollOffset);for(;o>=0&&n<this._myConfig.myMaxLines;){let a=this._myMessages[o];if(this._myTypeFilters[a.myType]){o-=1;continue}let l=a.myLines.length,h=0;if(s>0){let y=0;o!=this._myMessages.length-1&&(y=this._myConfig.myLinesBetweenMessages),s>=l+y?(s-=l+y,h=l+y):(h=s,s=0)}if(o!=this._myMessages.length-1){let y=this._myConfig.myLinesBetweenMessages-Math.max(this._myConfig.myLinesBetweenMessages-h,0),c=this._myConfig.myLinesBetweenMessages-y;n+c>this._myConfig.myMaxLines&&(c=this._myMaxLines-n);for(let d=0;d<c;d++)t=`
`.concat(t);n+=c,h-=y}let _=l-h;if(n+_>this._myConfig.myMaxLines&&(_=this._myConfig.myMaxLines-n),_>0)if(a.myType==e)t=a.myLines.slice(l-_-h,l-h).join(`
`).concat(`
`).concat(t),n+=_;else{for(let y=0;y<_;y++)t=`
`.concat(t);n+=_}o-=1}}t=this._myConfig.myMessagesTextStartString.concat(t),this._myUI.myMessagesTextComponents[e].text=t}_consolePrint(e,t,...n){if(e!=pe.ASSERT||n.length>0&&!n[0]){let o=this._argsToMessage(e,...n);this._addMessage(o),this._myMessages.length>=this._myConfig.myMaxMessages+this._myConfig.myMaxMessagesDeletePad&&(this._myMessages=this._myMessages.slice(this._myMessages.length-this._myConfig.myMaxMessages),this._clampScrollOffset()),this._updateAllTexts(),this._pulseGamepad()}switch(t){case Oe.BROWSER_CONSOLE:this._myOldBrowserConsole[e].apply(console,n);break;case Oe.CONSOLE_VR:this._myOldConsoleVR[e].apply(r.getConsoleVR(this._myEngine),n);break;default:this._myOldBrowserConsole[e].apply(console,n);break}}_argsToMessage(e,...t){e==pe.ASSERT&&(t=t.slice(1),t.splice(0,0,this._myConfig.myAssertStartString));let n=this._consoleFunctionToMessageType(e),o=this._formatArgs(...t),s=this._splitLongLines(o);return n==k.INFO?n=k.LOG:(n==k.EXCEPTION||n==k.ASSERT)&&(n=k.ERROR),new el(n,s)}_consoleFunctionToMessageType(e){let t=k.LOG;return e<pe.INFO?t=e:e==pe.INFO?t=k.LOG:t=k.ERROR,t}_formatArgs(...e){let t=[];for(let o=0;o<e.length;o++)e[o]===void 0?t.push("undefined"):t.push(this._stringifyItem(e[o]));return t.join(" ")}_stringifyItem(e){if(typeof e=="object"){let t=null,n=2;try{t=JSON.stringify(e,this._jsonReplacer.bind(this),n)}catch{let s=new WeakSet;t=JSON.stringify(e,function(a,l){if(typeof l=="object"&&l!==null){if(s.has(l))return"<stringify error: object already stringified>";s.add(l)}return this._jsonReplacer(a,l)}.bind(this),n)}return t=t.replaceAll('"[',"["),t=t.replaceAll("'[","["),t=t.replaceAll(']"',"]"),t=t.replaceAll("]'","]"),t}return e}_splitLongLines(e){let t=e.split(`
`),n=[];for(let o=0;o<t.length;o++){let s=t[o];if(s.length>this._myConfig.myMaxCharactersPerLine){let a=this._getSpacesAtStart(s),l=this._myConfig.myTabString.concat(a),h=0;for(;s.length>this._myConfig.myMaxCharactersPerLine&&h<this._myConfig.myMaxLineSplits;){let _=s.substr(0,this._myConfig.myMaxCharactersPerLine-1),y=s.substr(this._myConfig.myMaxCharactersPerLine-1);y=l.concat(y),n.push(_),s=y,h++}n.push(s)}else n.push(s)}return n}_getSpacesAtStart(e){let t="",n=0;for(;n<e.length&&e[n]==" ";)t=t.concat(" "),n++;return t}_addMessage(e){let t=!1;if(this._myMessages.length>0){let n=this._myMessages[this._myMessages.length-1];n.hasSameInfo(e)&&(n.increaseCount(),t=!0)}t||this._myMessages.push(e),this._adjustScrollOffsetAfterMessageAdded(e,t),this._updateNotifyIcon(e)}_adjustScrollOffsetAfterMessageAdded(e,t){!t&&!this._myTypeFilters[e.myType]&&this._myScrollOffset>0&&(this._myScrollOffset+=e.myLines.length+this._myConfig.myLinesBetweenMessages)}_updateAllTexts(){if(this._myWidgetFrame.isVisible())for(let e in k)this._updateText(k[e])}_updateNotifyIcon(e){!this._myTypeFilters[e.myType]&&this._myScrollOffset>0&&this._setNotifyIconActive(!0)}_updateScroll(e){if(this._myScrollUp)for(this._myScrollTimer+=e;this._myScrollTimer>this._myConfig.myScrollDelay;)this._myScrollTimer-=this._myConfig.myScrollDelay,this._myScrollOffset+=this._myConfig.myScrollAmount;else if(this._myScrollDown)for(this._myScrollTimer+=e;this._myScrollTimer>this._myConfig.myScrollDelay;)this._myScrollTimer-=this._myConfig.myScrollDelay,this._myScrollOffset-=this._myConfig.myScrollAmount;this._clampScrollOffset(),(this._myScrollUp||this._myScrollDown)&&this._updateAllTexts(),this._myScrollOffset==0&&this._setNotifyIconActive(!1)}_clampScrollOffset(){let e=this._getMaxScrollOffset();this._myScrollOffset=Math.pp_clamp(this._myScrollOffset,0,e)}_getMaxScrollOffset(){return Math.max(this._getLinesCount()-this._myConfig.myMaxLines,0)}_getLinesCount(){let e=0;for(let t of this._myMessages)this._myTypeFilters[t.myType]||(e+=t.myLines.length+this._myConfig.myLinesBetweenMessages);return e-=this._myConfig.myLinesBetweenMessages,e=Math.max(e,0),e}_addListeners(){let e=this._myUI;for(let t in k){let n=e.myFilterButtonsCursorTargetComponents[k[t]],o=e.myFilterButtonsBackgroundComponents[k[t]].material,s=e.myFilterButtonsTextComponents[k[t]].material;n.onSingleClick.add(this._toggleFilter.bind(this,k[t],s)),n.onDoubleClick.add(this._filterAllButOne.bind(this,k[t],s)),n.onTripleClick.add(this._resetFilters.bind(this,k[t])),n.onHover.add(this._filterHover.bind(this,k[t],o)),n.onUnhover.add(this._filterUnHover.bind(this,k[t],o))}{let t=e.myClearButtonCursorTargetComponent,n=e.myClearButtonBackgroundComponent.material;t.onClick.add(this._clearConsole.bind(this,!1,null)),t.onHover.add(this._genericHover.bind(this,n)),t.onUnhover.add(this._genericUnHover.bind(this,n))}{let t=e.myUpButtonCursorTargetComponent,n=e.myUpButtonBackgroundComponent.material;t.onDoubleClick.add(this._instantScrollUp.bind(this,!0)),t.onDown.add(this._setScrollUp.bind(this,!0)),t.onDownOnHover.add(this._setScrollUp.bind(this,!0)),t.onUp.add(this._setScrollUp.bind(this,!1)),t.onUnhover.add(this._setScrollUp.bind(this,!1)),t.onHover.add(this._genericHover.bind(this,n)),t.onUnhover.add(this._genericUnHover.bind(this,n))}{let t=e.myDownButtonCursorTargetComponent,n=e.myDownButtonBackgroundComponent.material;t.onDoubleClick.add(this._instantScrollDown.bind(this)),t.onDown.add(this._setScrollDown.bind(this,!0)),t.onDownOnHover.add(this._setScrollDown.bind(this,!0)),t.onUp.add(this._setScrollDown.bind(this,!1)),t.onUnhover.add(this._setScrollDown.bind(this,!1)),t.onHover.add(this._genericHover.bind(this,n)),t.onUnhover.add(this._genericUnHover.bind(this,n))}{let t=e.myNotifyIconCursorTargetComponent,n=e.myNotifyIconBackgroundComponent.material;t.onClick.add(this._instantScrollDown.bind(this)),t.onHover.add(this._genericHover.bind(this,n)),t.onUnhover.add(this._notifyIconUnHover.bind(this))}e.myPointerCursorTargetComponent.onHover.add(this._setGamepadScrollEnabled.bind(this,!0)),e.myPointerCursorTargetComponent.onUnhover.add(this._setGamepadScrollEnabled.bind(this,!1))}_resetFilters(e){if(this._myWidgetFrame.isVisible()){for(let t in k){let n=this._myUI.myFilterButtonsBackgroundComponents[k[t]].material,o=this._myUI.myFilterButtonsTextComponents[k[t]].material;this._myTypeFilters[k[t]]=!1,o.color=this._myConfig.myMessageTypeColors[k[t]],k[t]!=e&&(n.color=this._myConfig.myBackgroundColor)}this._clampScrollOffset(),this._updateAllTexts()}}_filterAllButOne(e){if(this._myWidgetFrame.isVisible()){for(let t in k){let n=this._myUI.myFilterButtonsBackgroundComponents[k[t]].material,o=this._myUI.myFilterButtonsTextComponents[k[t]].material;k[t]!=e?(this._myTypeFilters[k[t]]=!0,n.color=this._myConfig.myFilterButtonDisabledBackgroundColor,o.color=this._myConfig.myFilterButtonDisabledTextColor):(this._myTypeFilters[k[t]]=!1,o.color=this._myConfig.myMessageTypeColors[e])}this._clampScrollOffset(),this._updateAllTexts()}}_toggleFilter(e,t){this._myWidgetFrame.isVisible()&&(this._myTypeFilters[e]=!this._myTypeFilters[e],this._myTypeFilters[e]?t.color=this._myConfig.myFilterButtonDisabledTextColor:t.color=this._myConfig.myMessageTypeColors[e],this._clampScrollOffset(),this._updateAllTexts())}_clearConsole(e=!1,t=null){if(this._myWidgetFrame.isVisible()||e)if(this._myMessages=[],this._clampScrollOffset(),this._updateAllTexts(),e)switch(t){case Oe.BROWSER_CONSOLE:this._myOldBrowserConsoleClear.apply(console);break;case Oe.CONSOLE_VR:this._myOldConsoleVRClear.apply(r.getConsoleVR(this._myEngine));break;default:break}else this._myConfig.myClearBrowserConsoleWhenClearPressed&&qt.getConsoleOriginalClear()()}_setScrollUp(e){(this._myWidgetFrame.isVisible()||!e)&&(e&&(this._myScrollTimer=0),this._myScrollUp=e)}_setScrollDown(e){(this._myWidgetFrame.isVisible()||!e)&&(e&&(this._myScrollTimer=0),this._myScrollDown=e)}_instantScrollUp(){this._myWidgetFrame.isVisible()&&(this._myScrollOffset=this._getMaxScrollOffset(),this._updateAllTexts())}_instantScrollDown(){this._myWidgetFrame.isVisible()&&(this._myScrollOffset=0,this._setNotifyIconActive(!1),this._updateAllTexts())}_setNotifyIconActive(e){this._myUI.myNotifyIconPanel.pp_setActive(e&&this._myWidgetFrame.isVisible())}_notifyIconUnHover(){let e=this._myUI.myNotifyIconBackgroundComponent.material;e.color=this._myConfig.myNotifyIconColor}_filterHover(e,t){this._genericHover(t)}_filterUnHover(e,t){this._myTypeFilters[e]?t.color=this._myConfig.myFilterButtonDisabledBackgroundColor:t.color=this._myConfig.myBackgroundColor}_genericHover(e){e.color=this._myConfig.myButtonHoverColor}_genericUnHover(e){e.color=this._myConfig.myBackgroundColor}_updateGamepadsExtraActions(e){this._myLeftGamepad&&this._myRightGamepad&&((this._myLeftGamepad.getButtonInfo(M.THUMBSTICK).isPressStart()&&this._myRightGamepad.getButtonInfo(M.THUMBSTICK).isPressed()||this._myRightGamepad.getButtonInfo(M.THUMBSTICK).isPressStart()&&this._myLeftGamepad.getButtonInfo(M.THUMBSTICK).isPressed())&&this._toggleVisibility(),this._myPulseTimer=Math.max(this._myPulseTimer-e,0),this._updateScrollWithThumbstick(e))}_toggleVisibility(){this._myWidgetFrame.toggleVisibility()}_widgetVisibleChanged(e){this._myUI.setVisible(e),e&&this._updateAllTexts()}_updateScrollWithThumbstick(e){if(this._myWidgetFrame.isVisible()&&this._myGamepadScrollEnabled){let t=[0,0];if(this._myConfig.myScrollThumbstickHandedness==U.LEFT?t=this._myLeftGamepad.getAxesInfo(oe.THUMBSTICK).myAxes:this._myConfig.myScrollThumbstickHandedness==U.RIGHT&&(t=this._myRightGamepad.getAxesInfo(oe.THUMBSTICK).myAxes),Math.abs(t[1])>this._myConfig.myScrollThumbstickMinThreshold){for(this._myScrollThumbstickTimer+=e;this._myScrollThumbstickTimer>this._myConfig.myScrollThumbstickDelay;){this._myScrollThumbstickTimer-=this._myConfig.myScrollThumbstickDelay;let n=(Math.abs(t[1])-this._myConfig.myScrollThumbstickMinThreshold)/(1-this._myConfig.myScrollThumbstickMinThreshold);this._myScrollOffset+=Math.sign(t[1])*n*this._myConfig.myScrollThumbstickAmount}this._clampScrollOffset(),this._updateAllTexts()}else this._myScrollThumbstickTimer=0}}_pulseGamepad(){if(this._myLeftGamepad&&this._myRightGamepad){let e=this._myParams.myPulseOnNewMessage;(e==ba.ALWAYS||!this._myWidgetFrame.isVisible()&&e==ba.WHEN_HIDDEN)&&this._myPulseTimer==0&&(this._myParams.myHandedness==U.RIGHT?this._myRightGamepad.pulse(this._myConfig.myPulseIntensity,this._myConfig.myPulseDuration):this._myLeftGamepad.pulse(this._myConfig.myPulseIntensity,this._myConfig.myPulseDuration),this._myPulseTimer=this._myConfig.myPulseDelay)}}_isSimpleArray(e){if(this._isSpecialSimpleArray(e))return!0;if(Array.isArray(e)){let t=!0;for(let n of e)if(n instanceof Object){t=!1;break}return t}return!1}_isSpecialSimpleArray(e){let t=[Array.prototype,Uint8ClampedArray.prototype,Uint8Array.prototype,Uint16Array.prototype,Uint32Array.prototype,Int8Array.prototype,Int16Array.prototype,Int32Array.prototype,Float32Array.prototype,Float64Array.prototype];return e&&e.constructor&&(e.constructor.name=="Uint8ClampedArray"||e.constructor.name=="Uint8Array"||e.constructor.name=="Uint16Array"||e.constructor.name=="Uint32Array"||e.constructor.name=="Int8Array"||e.constructor.name=="Int16Array"||e.constructor.name=="Int32Array"||e.constructor.name=="Float32Array"||e.constructor.name=="Float64Array")}_setGamepadScrollEnabled(e){this._myGamepadScrollEnabled=e,this._myConfig.myGamepadScrollOnlyOnHover||(this._myGamepadScrollEnabled=!0)}_jsonReplacer(e,t){if(t instanceof Map)return Array.from(t.entries());if(this._isSimpleArray(t)){let n=t;if(this._isSpecialSimpleArray(n)){let s=[];for(let a=0;a<n.length;a++)s[a]=n[a];n=s}let o=JSON.stringify(n);return o=o.split(",").join(", "),o}else return t}destroy(){this._myDestroyed=!0,r.getWindow(this._myEngine).removeEventListener("error",this._myErrorEventListener),r.getWindow(this._myEngine).removeEventListener("unhandledrejection",this._myUnhandledRejectionEventListener),this._myUI.destroy(),this._myWidgetFrame.destroy()}isDestroyed(){return this._myDestroyed}};var Aa=class{constructor(){this._myForwardToBrowserConsole=!0}log(...e){this._myForwardToBrowserConsole&&qt.getConsoleOriginalLog().apply(console,e)}error(...e){this._myForwardToBrowserConsole&&qt.getConsoleOriginalError().apply(console,e)}warn(...e){this._myForwardToBrowserConsole&&qt.getConsoleOriginalWarn().apply(console,e)}info(...e){this._myForwardToBrowserConsole&&qt.getConsoleOriginalInfo().apply(console,e)}debug(...e){this._myForwardToBrowserConsole&&qt.getConsoleOriginalDebug().apply(console,e)}assert(...e){this._myForwardToBrowserConsole&&qt.getConsoleOriginalAssert().apply(console,e)}clear(){this._myForwardToBrowserConsole&&qt.getConsoleOriginalClear().apply(console)}setForwardToBrowserConsole(e){this._myForwardToBrowserConsole=e}isForwardToBrowserConsole(){return this._myForwardToBrowserConsole}};import{Component as qA,Property as Va}from"@wonderlandengine/api";import{Component as WA,Property as QA}from"@wonderlandengine/api";var xi=class extends WA{init(){this._myConsoleVR=null,this._myInit&&(r.hasConsoleVR(this.engine)||(this._myConsoleVR=new Aa,r.setConsoleVR(this._myConsoleVR,this.engine)))}onDestroy(){this._myConsoleVR!=null&&r.getConsoleVR(this.engine)==this._myConsoleVR&&r.removeConsoleVR(this.engine)}};R(xi,"TypeName","pp-init-console-vr"),R(xi,"Properties",{_myInit:QA.bool(!0)});var wn=class extends qA{init(){this.object.pp_addComponent(xi),this._myWidget=new Ra(this.engine),this._myStarted=!1}start(){if(r.isToolEnabled(this.engine)){let e=new Da(this.engine);e.myHandedness=[null,"left","right"][this._myHandedness],e.myOverrideBrowserConsole=this._myOverrideBrowserConsole,e.myShowOnStart=this._myShowOnStart,e.myShowVisibilityButton=this._myShowVisibilityButton,e.myPulseOnNewMessage=this._myPulseOnNewMessage,e.myPlaneMaterial=r.getDefaultMaterials(this.engine).myFlatOpaque.clone(),e.myTextMaterial=r.getDefaultMaterials(this.engine).myText.clone(),this._myWidget.start(this.object,e),this._myWidgetVisibleBackup=this._myWidget.isVisible(),this._mySetVisibleNextUpdate=!1,this._myStarted=!0}}update(e){r.isToolEnabled(this.engine)&&this._myStarted&&(this._mySetVisibleNextUpdate&&(this._mySetVisibleNextUpdate=!1,this._myWidget.setVisible(!1),this._myWidget.setVisible(this._myWidgetVisibleBackup)),this._myWidget.update(e))}onActivate(){r.isToolEnabled(this.engine)&&this._myStarted&&(this._mySetVisibleNextUpdate=!0)}onDeactivate(){r.isToolEnabled(this.engine)&&this._myStarted&&(this._myWidgetVisibleBackup=this._myWidget.isVisible(),this._myWidget.setVisible(!1))}onDestroy(){this._myWidget.destroy()}};R(wn,"TypeName","pp-console-vr-tool"),R(wn,"Properties",{_myHandedness:Va.enum(["None","Left","Right"],"None"),_myOverrideBrowserConsole:Va.bool(!0),_myShowOnStart:Va.bool(!1),_myShowVisibilityButton:Va.bool(!1),_myPulseOnNewMessage:Va.enum(["Never","Always","When Hidden"],"Never")});import{Emitter as XA}from"@wonderlandengine/api";var Ro=new WeakMap,Ao=new WeakMap;function gb(i,e=r.getMainEngine()){if(Ro.has(e))for(let t of Ro.get(e).values())t(i)}function fb(i=r.getMainEngine()){if(Ao.has(i))for(let e of Ao.get(i).values())e()}function Pb(i=null,e=!1,t=null,n=null,o=r.getMainEngine()){if(i==null||i.length==0)r.getNavigator(o).clipboard&&r.getNavigator(o).clipboard.readText().then(function(s){r.getEasyTuneVariables(o).fromJSON(s,e),He.refreshWidget(o),t?.(),console.log("Easy Tune Variables Imported from: clipboard"),console.log(s)},function(){n?.(),console.error("An error occurred while importing the easy tune variables from: clipboard")}).catch(function(s){n?.(),console.error("An error occurred while importing the easy tune variables from: clipboard"),console.error(s)});else{let s=xb(i,o);fetch(s).then(function(a){a.ok?a.text().then(function(l){r.getEasyTuneVariables(o).fromJSON(l,e),He.refreshWidget(o),t?.(),console.log("Easy Tune Variables Imported from:",s),console.log(l)},function(l){n?.(),console.error("An error occurred while importing the easy tune variables from:",s),console.error(l)}):(n?.(),console.error("An error occurred while importing the easy tune variables from:",s),console.error(a))},function(a){n?.(),console.error("An error occurred while importing the easy tune variables from:",s),console.error(a)}).catch(function(a){n?.(),console.error("An error occurred while importing the easy tune variables from:",s),console.error(a)})}He.refreshWidget(o)}function Cb(i=null,e=null,t=null,n=r.getMainEngine()){let o=r.getEasyTuneVariables(n).toJSON();if(i==null||i.length==0)r.getNavigator(n).clipboard&&r.getNavigator(n).clipboard.writeText(o).then(function(){e?.(),console.log("Easy Tune Variables Exported to: clipboard"),console.log(o)},function(){t?.(),console.error("An error occurred while exporting the easy tune variables to: clipboard")}).catch(function(s){t?.(),console.error("An error occurred while exporting the easy tune variables to: clipboard"),console.error(s)});else{let s=xb(i,n);fetch(s,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:o}).then(function(a){a.ok?(e?.(),console.log("Easy Tune Variables Exported to:",s),console.log(o)):(t?.(),console.error("An error occurred while exporting the easy tune variables to:",s),console.error(a))},function(a){t?.(),console.error("An error occurred while exporting the easy tune variables to:",s),console.error(a)}).catch(function(a){t?.(),console.error("An error occurred while exporting the easy tune variables to:",s),console.error(a)})}}function Tb(i,e,t=r.getMainEngine()){Ro.has(t)||Ro.set(t,new Map),Ro.get(t).set(i,e)}function bb(i,e=r.getMainEngine()){Ro.has(e)&&Ro.get(e).delete(i)}function Sb(i,e,t=r.getMainEngine()){Ao.has(t)||Ao.set(t,new Map),Ao.get(t).set(i,e)}function vb(i,e=r.getMainEngine()){Ao.has(e)&&Ao.get(e).delete(i)}var He={setWidgetActiveVariable:gb,refreshWidget:fb,importVariables:Pb,exportVariables:Cb,addSetWidgetActiveVariableCallback:Tb,removeSetWidgetActiveVariableCallback:bb,addRefreshWidgetCallback:Sb,removeRefreshWidgetCallback:vb};function xb(i,e=r.getMainEngine()){let t=i.match(/\{.+?\}/g);if(t==null||t.length==0)return i;for(let s=0;s<t.length;s++)t[s]=t[s].replace("{",""),t[s]=t[s].replace("}","");let n=new URL(r.getDocument(e).location).searchParams,o=i;for(let s of t){let a=n.get(s);a!=null&&(o=o.replace("{"+s+"}",a))}return o}var ci={NONE:0,NUMBER:1,BOOL:2,TRANSFORM:3},Vo=class{constructor(e,t,n=r.getMainEngine()){this._myName=e.slice(0),this._myType=t,this._myValue=null,this._myDefaultValue=null,this._myActive=!1,this._myValueChangedEmitter=new XA,this._myEngine=n}getName(){return this._myName}getType(){return this._myType}isActive(){return this._myActive}setActive(e){this._myActive=e}getValue(){return this._myValue}setValue(e,t=!1){let n=this._myValue!=e;this._myValue=e,t&&Vo.prototype.setDefaultValue.call(this,e),He.refreshWidget(this._myEngine),n&&this._myValueChangedEmitter.notify(this.getValue(),this)}getDefaultValue(){return this._myDefaultValue}setDefaultValue(e){this._myDefaultValue=e}fromJSON(e,t=!1){this.setValue(JSON.parse(e),t)}toJSON(){return JSON.stringify(this.getValue())}registerValueChangedEventListener(e,t){this._myValueChangedEmitter.add(t,{id:e})}unregisterValueChangedEventListener(e){this._myValueChangedEmitter.remove(e)}},hi=class extends Vo{constructor(e,t,n,o){super(e,t,o),hi.prototype.setValue.call(this,n,!0)}setValue(e,t=!1){let n=this._myValue!=null&&!this._myValue.pp_equals(e);this._myValue==null?this._myValue=e.pp_clone():this._myValue.pp_copy(e),t&&hi.prototype.setDefaultValue.call(this,e),He.refreshWidget(this._myEngine),n&&this._myValueChangedEmitter.notify(this.getValue(),this)}setDefaultValue(e){this._myDefaultValue==null?this._myDefaultValue=e.pp_clone():this._myDefaultValue.pp_copy(e)}},Li=class extends hi{constructor(e,t,n,o,s=null,a=null,l=!1,h){super(e,ci.NUMBER,t,h),this._myDecimalPlaces=o,this._myStepPerSecond=n,this._myDefaultStepPerSecond=this._myStepPerSecond,this._myMin=s,this._myMax=a,this._myEditAllValuesTogether=l,this._clampValue(!0)}setMax(e){this._myMax=e,this._clampValue(!1)}setMin(e){this._myMin=e,this._clampValue(!1)}_clampValue(e){let t=this._myValue.vec_clamp(this._myMin,this._myMax);if(!e){let n=this.getDefaultValue().vec_clamp(this._myMin,this._myMax);!n.vec_equals(this.getDefaultValue(),1e-5)&&hi.prototype.setDefaultValue.call(this,n)}hi.prototype.setValue.call(this,t,e)}},sn=class extends Li{constructor(e,t,n,o,s,a,l){super(e,[t],n,o,s,a,l),this._myTempValue=[0],this._myTempDefaultValue=[0]}getValue(){return super.getValue()[0]}setValue(e,t=!1){this._myTempValue[0]=e,super.setValue(this._myTempValue,t)}getDefaultValue(){return super.getDefaultValue()[0]}setDefaultValue(e){this._myTempDefaultValue[0]=e,super.setDefaultValue(this._myTempValue)}},_m=class extends sn{constructor(e,t,n,o,s,a){super(e,t,n,0,o,s,a)}},ki=class extends Li{constructor(e,t,n,o,s,a,l){let h=t.pp_clone();for(let _=0;_<t.length;_++)h[_]=Math.round(h[_]);super(e,h,n,0,o!=null?Math.round(o):null,s!=null?Math.round(s):s,a,l)}},tl=class extends hi{constructor(e,t,n){super(e,ci.BOOL,t,n)}},gm=class extends tl{constructor(e,t,n){super(e,[t],n),this._myTempValue=[0],this._myTempDefaultValue=[0]}getValue(){return super.getValue()[0]}setValue(e,t=!1){this._myTempValue[0]=e,super.setValue(this._myTempValue,t)}getDefaultValue(){return super.getDefaultValue()[0]}setDefaultValue(e){this._myTempDefaultValue[0]=e,super.setDefaultValue(this._myTempValue)}},Oo=class extends Vo{constructor(e,t,n=!0,o=1,s=50,a=1,l){super(e,ci.TRANSFORM,l),this._myDecimalPlaces=3,this._myPosition=t.mat4_getPosition(),this._myRotation=t.mat4_getRotationDegrees(),this._myScale=t.mat4_getScale();let h=Math.pow(10,this._myDecimalPlaces);for(let _=0;_<3;_++)this._myScale[_]=Math.max(this._myScale[_],1/h);this._myScaleAsOne=n,this._myPositionStepPerSecond=o,this._myRotationStepPerSecond=s,this._myScaleStepPerSecond=a,this._myDefaultPosition=this._myPosition.vec3_clone(),this._myDefaultRotation=this._myRotation.vec3_clone(),this._myDefaultScale=this._myScale.vec3_clone(),this._myDefaultPositionStepPerSecond=this._myPositionStepPerSecond,this._myDefaultRotationStepPerSecond=this._myRotationStepPerSecond,this._myDefaultScaleStepPerSecond=this._myScaleStepPerSecond,this._myTransform=be(),this._myTransform.mat4_setPositionRotationDegreesScale(this._myPosition,this._myRotation,this._myScale),this._myTempTransform=be()}getValue(){return this._myTransform.mat4_setPositionRotationDegreesScale(this._myPosition,this._myRotation,this._myScale),this._myTransform}setValue(e,t=!1){this._myTempTransform.mat4_setPositionRotationDegreesScale(this._myPosition,this._myRotation,this._myScale),e.mat4_getPosition(this._myPosition),e.mat4_getRotationDegrees(this._myRotation),e.mat4_getScale(this._myScale),this._myTransform.mat4_setPositionRotationDegreesScale(this._myPosition,this._myRotation,this._myScale);let n=!this._myTempTransform.pp_equals(this._myTransform);t&&Oo.prototype.setDefaultValue.call(this,e),He.refreshWidget(this._myEngine),n&&this._myValueChangedEmitter.notify(this.getValue(),this)}setDefaultValue(e){this._myDefaultPosition=e.mat4_getPosition(),this._myDefaultRotation=e.mat4_getRotationDegrees(),this._myDefaultScale=e.mat4_getScale()}fromJSON(e,t=!1){this.setValue(JSON.parse(e),t)}toJSON(){return this.getValue().vec_toString()}};import{Component as tV,Property as Fi}from"@wonderlandengine/api";import{Emitter as KA}from"@wonderlandengine/api";var Oa=class{constructor(){this.myVariablesImportCallback=null,this.myVariablesExportCallback=null}},Xt=class{constructor(e){this._myConfig=null,this._myUI=null,this._myParams=e,this._myVariable=null,this._myVisible=!0,this._myScrollVariableRequestEmitter=new KA,this._myAppendToVariableName="",this._myScrollVariableActive=!1,this._myScrollDirection=0,this._myScrollVariableTimer=0,this._myHasScrolled=!1,this._myResetImportLabelTimer=new ie(0,!1),this._myResetExportLabelTimer=new ie(0,!1),this._myDestroyed=!1}setVisible(e){e&&this._refreshUI(),this._myUI.setVisible(e),this._myVisible=e}setEasyTuneVariable(e,t){this._myVariable=e,typeof t!==void 0?this._myAppendToVariableName=t:this._myAppendToVariableName="",this._setEasyTuneVariableHook(),this._refreshUI()}isScrollVariableActive(){return this._myScrollVariableActive}getScrollVariableDirection(){return this._myScrollDirection}setScrollVariableActive(e,t){this._myScrollVariableActive=e,this._myScrollDirection=t,this._myScrollVariableTimer=this._myConfig.myScrollVariableDelay,this._myHasScrolled=!1}getWidget(){return this}syncWidget(e){e!=null?(e._myResetImportLabelTimer.isRunning()?this._myResetImportLabelTimer.start(e._myResetImportLabelTimer.getTimeLeft()):this._myResetImportLabelTimer.reset(),e._myResetExportLabelTimer.isRunning()?this._myResetExportLabelTimer.start(e._myResetExportLabelTimer.getTimeLeft()):this._myResetExportLabelTimer.reset(),this._myUI.myImportButtonTextComponent.text=e._myUI.myImportButtonTextComponent.text,this._myUI.myExportButtonTextComponent.text=e._myUI.myExportButtonTextComponent.text,this.setScrollVariableActive(e.isScrollVariableActive(),e.getScrollVariableDirection())):(this._myResetImportLabelTimer.reset(),this._myUI.myImportButtonTextComponent.text=this._myConfig.myImportButtonText,this._myResetExportLabelTimer.reset(),this._myUI.myExportButtonTextComponent.text=this._myConfig.myExportButtonText)}onImportSuccess(){this._myUI.myImportButtonTextComponent.text=this._myConfig.myImportSuccessButtonText,this._myResetImportLabelTimer.start(this._myConfig.myImportExportResetLabelSeconds)}onImportFailure(){this._myUI.myImportButtonTextComponent.text=this._myConfig.myImportFailureButtonText,this._myResetImportLabelTimer.start(this._myConfig.myImportExportResetLabelSeconds)}onExportSuccess(){this._myUI.myExportButtonTextComponent.text=this._myConfig.myExportSuccessButtonText,this._myResetExportLabelTimer.start(this._myConfig.myImportExportResetLabelSeconds)}onExportFailure(){this._myUI.myExportButtonTextComponent.text=this._myConfig.myExportFailureButtonText,this._myResetExportLabelTimer.start(this._myConfig.myImportExportResetLabelSeconds)}registerScrollVariableRequestEventListener(e,t){this._myScrollVariableRequestEmitter.add(t,{id:e})}unregisterScrollVariableRequestEventListener(e){this._myScrollVariableRequestEmitter.remove(e)}start(e,t){this._myConfig.build(),this._myResetImportLabelTimer.setDuration(this._myConfig.myImportExportResetLabelSeconds),this._myResetExportLabelTimer.setDuration(this._myConfig.myImportExportResetLabelSeconds),this._myUI.build(e,this._myConfig,t),this._myUI.setImportExportButtonsVisible(t.myVariablesImportExportButtonsVisible),this._startHook(e,t),this._addListeners()}update(e){this._isActive()&&(this._updateHook(e),this._updateScrollVariable(e),this._updateImportExportLabel(e))}_setEasyTuneVariableHook(){}_refreshUIHook(){}_startHook(e,t){}_addListenersHook(){}_updateHook(e){}_refreshUI(){if(this._myVariable){if(this._myVariable.getName()!=null)this._myUI.myVariableLabelTextComponent.text=this._myVariable.getName().concat(this._myAppendToVariableName);else{let e="Unknown";this._myUI.myVariableLabelTextComponent.text=e.concat(this._myAppendToVariableName)}this._refreshUIHook()}}_updateScrollVariable(e){this._myScrollVariableActive&&(this._myScrollVariableTimer<=0?(this._scrollVariableRequest(this._myScrollDirection),this._myScrollVariableTimer=this._myConfig.myScrollVariableDelay,this._myHasScrolled=!0):this._myScrollVariableTimer-=e)}_updateImportExportLabel(e){this._myResetImportLabelTimer.isRunning(e)&&(this._myResetImportLabelTimer.update(e),this._myResetImportLabelTimer.isDone()&&(this._myResetImportLabelTimer.reset(),this._myUI.myImportButtonTextComponent.text=this._myConfig.myImportButtonText)),this._myResetExportLabelTimer.isRunning(e)&&(this._myResetExportLabelTimer.update(e),this._myResetExportLabelTimer.isDone()&&(this._myResetExportLabelTimer.reset(),this._myUI.myExportButtonTextComponent.text=this._myConfig.myExportButtonText))}_isActive(){return this._myVisible&&this._myVariable}_addListeners(){let e=this._myUI;e.myNextButtonCursorTargetComponent.onDown.add(this._setScrollVariableActive.bind(this,!0,1,!1)),e.myNextButtonCursorTargetComponent.onDownOnHover.add(this._setScrollVariableActive.bind(this,!0,1,!1)),e.myNextButtonCursorTargetComponent.onUpWithDown.add(this._setScrollVariableActive.bind(this,!1,0,!1)),e.myNextButtonCursorTargetComponent.onUpWithNoDown.add(this._setScrollVariableActive.bind(this,!1,0,!0)),e.myNextButtonCursorTargetComponent.onUnhover.add(this._setScrollVariableActive.bind(this,!1,0,!0)),e.myNextButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myNextButtonBackgroundComponent.material)),e.myNextButtonCursorTargetComponent.onUnhover.add(this._genericUnHover.bind(this,e.myNextButtonBackgroundComponent.material)),e.myPreviousButtonCursorTargetComponent.onDown.add(this._setScrollVariableActive.bind(this,!0,-1,!1)),e.myPreviousButtonCursorTargetComponent.onDownOnHover.add(this._setScrollVariableActive.bind(this,!0,-1,!1)),e.myPreviousButtonCursorTargetComponent.onUpWithDown.add(this._setScrollVariableActive.bind(this,!1,0,!1)),e.myPreviousButtonCursorTargetComponent.onUpWithNoDown.add(this._setScrollVariableActive.bind(this,!1,0,!0)),e.myPreviousButtonCursorTargetComponent.onUnhover.add(this._setScrollVariableActive.bind(this,!1,0,!0)),e.myPreviousButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myPreviousButtonBackgroundComponent.material)),e.myPreviousButtonCursorTargetComponent.onUnhover.add(this._genericUnHover.bind(this,e.myPreviousButtonBackgroundComponent.material)),e.myImportButtonCursorTargetComponent.onUpWithDown.add(this._importVariables.bind(this)),e.myImportButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myImportButtonBackgroundComponent.material)),e.myImportButtonCursorTargetComponent.onUnhover.add(this._genericUnHover.bind(this,e.myImportButtonBackgroundComponent.material)),e.myExportButtonCursorTargetComponent.onUpWithDown.add(this._exportVariables.bind(this)),e.myExportButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myExportButtonBackgroundComponent.material)),e.myExportButtonCursorTargetComponent.onUnhover.add(this._genericUnHover.bind(this,e.myExportButtonBackgroundComponent.material)),this._addListenersHook()}_setScrollVariableActive(e,t,n){if(this._isActive()||!e){let o=!e&&!this._myHasScrolled&&!n,s=this._myScrollDirection;this.setScrollVariableActive(e,t),o&&this._scrollVariableRequest(s)}}_scrollVariableRequest(e){this._isActive()&&e!=0&&this._myScrollVariableRequestEmitter.notify(e)}_genericHover(e){e.color=this._myConfig.myButtonHoverColor}_genericUnHover(e){e.color=this._myConfig.myBackgroundColor}_importVariables(){this._myUI.myImportButtonTextComponent.text==this._myConfig.myImportButtonText&&(this._myUI.myImportButtonTextComponent.text=this._myConfig.myImportingButtonText,this._myResetImportLabelTimer.reset(),this._myParams.myVariablesImportCallback())}_exportVariables(){this._myUI.myExportButtonTextComponent.text==this._myConfig.myExportButtonText&&(this._myUI.myExportButtonTextComponent.text=this._myConfig.myExportingButtonText,this._myResetExportLabelTimer.reset(),this._myParams.myVariablesExportCallback())}destroy(){this._myDestroyed=!0,this._myUI!=null&&this._myUI.destroy()}isDestroyed(){return this._myDestroyed}};import{Emitter as JA}from"@wonderlandengine/api";var Bo=class{constructor(e,t,n=r.getMainEngine()){this._myGamepad=t,this._myParentObject=null,this._myParams=e,this._myEasyTuneParams=null,this._myWidgets=new Map,this._myVariable=null,this._myVisible=!0,this._myAppendToVariableName=null,this._myScrollVariableRequestEmitter=new JA,this._myCurrentArraySize=null,this._myEngine=n,this._myDestroyed=!1}setEasyTuneVariable(e,t){this._myVariable=e,this._myCurrentArraySize=this._myVariable.getValue().length,this._myAppendToVariableName=t,this._myWidgets.has(this._myCurrentArraySize)||this._createWidget(this._myCurrentArraySize);let n=this._myWidgets.get(this._myCurrentArraySize);n&&n.setEasyTuneVariable(e,t),this.setVisible(this._myVisible)}setVisible(e){for(let t of this._myWidgets.values())t.setVisible(!1);if(this._myVariable){this._sizeChangedCheck();let t=this._myWidgets.get(this._myCurrentArraySize);t&&t.setVisible(e)}this._myVisible=e}isScrollVariableActive(){let e=this._myWidgets.get(this._myCurrentArraySize);return e?e.isScrollVariableActive():!1}getScrollVariableDirection(){let e=this._myWidgets.get(this._myCurrentArraySize);return e?e.getScrollVariableDirection():0}setScrollVariableActive(e,t){let n=this._myWidgets.get(this._myCurrentArraySize);n&&n.setScrollVariableActive(e,t)}getWidget(){return this._myWidgets.get(this._myCurrentArraySize)}registerScrollVariableRequestEventListener(e,t){this._myScrollVariableRequestEmitter.add(t,{id:e})}unregisterScrollVariableRequestEventListener(e){this._myScrollVariableRequestEmitter.remove(e)}start(e,t){this._myParentObject=e,this._myEasyTuneParams=t,this._createWidget(1),this._myVariable&&this.setEasyTuneVariable(this._myVariable,this._myAppendToVariableName)}update(e){if(this._isActive()){this._sizeChangedCheck();let t=this._myWidgets.get(this._myCurrentArraySize);t&&t.update(e)}}onImportSuccess(){let e=this._myWidgets.get(this._myCurrentArraySize);e&&e.onImportSuccess()}onImportFailure(){let e=this._myWidgets.get(this._myCurrentArraySize);e&&e.onImportFailure()}onExportSuccess(){let e=this._myWidgets.get(this._myCurrentArraySize);e&&e.onExportSuccess()}onExportFailure(){let e=this._myWidgets.get(this._myCurrentArraySize);e&&e.onExportFailure()}_isActive(){return this._myVisible&&this._myVariable}_scrollVariableRequest(e){this._myScrollVariableRequestEmitter.notify(e)}_createWidget(e){this._myWidgets.set(e,this._getEasyTuneArrayWidget(e)),this._myWidgets.get(e).start(this._myParentObject,this._myEasyTuneParams),this._myWidgets.get(e).setVisible(!1),this._myWidgets.get(e).registerScrollVariableRequestEventListener(this,this._scrollVariableRequest.bind(this))}_sizeChangedCheck(){this._myVariable.getValue().length!=this._myCurrentArraySize&&this.setEasyTuneVariable(this._myVariable,this._myAppendToVariableName)}_getEasyTuneArrayWidget(e){return null}destroy(){this._myDestroyed=!0;for(let e of this._myWidgets.values())e.destroy()}isDestroyed(){return this._myDestroyed}};import{Alignment as ZA,Collider as YA,Justification as $A}from"@wonderlandengine/api";var Kt=class{constructor(){}build(){this._setupBuildConfig(),this._setupRuntimeConfig()}_getBackPanelMaxY(){return this.myDisplayPanelPosition[1]+this.myVariableLabelPanelPosition[1]+this.mySideButtonBackgroundScale[1]+this._mySideButtonDistanceFromBorder*1.25}_getBackPanelMinY(){return this.myDisplayPanelPosition[1]-this._mySideButtonDistanceFromBorder*1.25-this.mySideButtonBackgroundScale[1]}_getBackPanelMaxX(){return this._mySideButtonPanelHalfWidth}_getBackPanelMinX(){return-this._mySideButtonPanelHalfWidth}_getPivotZOffset(){return 0}_setupBuildConfigHook(){}_setupRuntimeConfigHook(){}_setupBuildConfig(){this.myBackgroundColor=w(46/255,46/255,46/255,1),this.myCursorTargetCollisionCollider=YA.Box,this.myCursorTargetCollisionGroup=7,this.myCursorTargetCollisionThickness=.001,this.myDefaultTextColor=w(255/255,255/255,255/255,1),this.myTextAlignment=ZA.Center,this.myTextJustification=$A.Middle,this.myTextColor=this.myDefaultTextColor,this.myLabelTextScale=m(.18,.18,.18),this.myButtonTextScale=m(.18,.18,.18),this._myPanelZOffset=.01,this._myColliderZOffset=.017,this._mySideButtonDistanceFromBorder=.0125,this._mySideButtonPanelHalfWidth=.2,this.myPivotObjectPositions=[],this.myPivotObjectPositions[U.NONE]=m(0,0,this._getPivotZOffset()),this.myPivotObjectPositions[U.LEFT]=m(-.04,.02,this._getPivotZOffset()),this.myPivotObjectPositions[U.RIGHT]=m(-.08,.02,this._getPivotZOffset()),this.mySideButtonBackgroundScale=m(.015,.015,1),this.mySideButtonTextScale=this.myButtonTextScale,this.mySideButtonTextPosition=m(0,0,.007),this.mySideButtonCursorTargetPosition=m(0,0,0),this.mySideButtonCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.mySideButtonCollisionExtents=this.mySideButtonBackgroundScale.pp_clone(),this.mySideButtonCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myLeftSideButtonPosition=m(0,0,-1e-5),this.myLeftSideButtonPosition[0]=-this._mySideButtonPanelHalfWidth+this.mySideButtonBackgroundScale[0]+this._mySideButtonDistanceFromBorder,this.myRightSideButtonPosition=m(0,0,-1e-5),this.myRightSideButtonPosition[0]=-this.myLeftSideButtonPosition[0],this.myDisplayPanelPosition=m(0,.1,0),this.myVariableLabelPanelPosition=m(0,.025,this._myPanelZOffset),this.myVariableLabelTextScale=this.myLabelTextScale,this.myVariableLabelCursorTargetPosition=m(0,0,0),this.myVariableLabelCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myVariableLabelCollisionExtents=m(.065,.0175,1),this.myVariableLabelCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myNextButtonText=">",this.myPreviousButtonText="<",this._setupBuildConfigHook();{let e=this._getBackPanelMaxX(),t=this._getBackPanelMinX(),n=this._getBackPanelMaxY(),o=this._getBackPanelMinY();this.myBackPanelPosition=[(e+t)/2,(n+o)/2,0],this.myBackBackgroundScale=[(e-t)/2,(n-o)/2,1],this.myBackBackgroundColor=w(70/255,70/255,70/255,1)}this.myImportExportButtonBackgroundScale=m(.04,.02,1),this.myImportExportButtonTextScale=this.myButtonTextScale,this.myImportExportButtonTextPosition=m(0,0,.007),this.myImportExportPanelPosition=[0,this._getBackPanelMaxY()+this._mySideButtonDistanceFromBorder+this.myImportExportButtonBackgroundScale[1],this._myPanelZOffset],this.myImportExportButtonCursorTargetPosition=m(0,0,0),this.myImportExportButtonCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myImportExportButtonCollisionExtents=this.myImportExportButtonBackgroundScale.pp_clone(),this.myImportExportButtonCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myImportButtonText="Import",this.myExportButtonText="Export",this.myImportExportResetLabelSeconds=2,this.myImportingButtonText="...",this.myImportSuccessButtonText="Done",this.myImportFailureButtonText="Error",this.myExportingButtonText="...",this.myExportSuccessButtonText="Done",this.myExportFailureButtonText="Error",this.myImportButtonPosition=m(0,0,-1e-5),this.myImportButtonPosition[0]=-this.myImportExportButtonBackgroundScale[0]-this._mySideButtonDistanceFromBorder/2,this.myExportButtonPosition=m(0,0,-1e-5),this.myExportButtonPosition[0]=-this.myImportButtonPosition[0],this.myPointerCollisionExtents=this.myBackBackgroundScale.pp_clone(),this.myPointerCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myPointerCursorTargetPosition=this.myBackPanelPosition.pp_clone(),this.myPointerCursorTargetPosition[2]=this._myColliderZOffset-1e-4}_setupRuntimeConfig(){this.myButtonHoverColor=w(150/255,150/255,150/255,1),this.myScrollVariableDelay=.5,this._setupRuntimeConfigHook()}};var Ba=class extends Kt{constructor(e){super(),this.myArraySize=e}_getBackPanelMinY(){let e=this.myValuePanelsPositions[this.myArraySize-1]?this.myValuePanelsPositions[this.myArraySize-1][1]:0;return super._getBackPanelMinY()+this.myValuesPanelPosition[1]+e}_getPivotZOffset(){return .00802713}_setupBuildConfigHook(){this.myIncreaseButtonText="+",this.myDecreaseButtonText="-",this._myValuePanelDistanceFromVariableLabelPanel=.055,this._myDistanceBetweenValues=this.mySideButtonBackgroundScale[1]*2+.015,this.myValuesPanelPosition=[0,this.myVariableLabelPanelPosition[1]-this._myValuePanelDistanceFromVariableLabelPanel,this._myPanelZOffset],this.myValueTextScale=m(.4,.4,.4),this.myValueCursorTargetPosition=m(0,0,0),this.myValueCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myValueCollisionExtents=m(.065,.02,1),this.myValueCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myValuePanelsPositions=[],this.myValuePanelsPositions[0]=m(0,0,0);for(let e=1;e<this.myArraySize;e++)this.myValuePanelsPositions[e]=this.myValuePanelsPositions[e-1].pp_clone(),this.myValuePanelsPositions[e][1]-=this._myDistanceBetweenValues}_setupRuntimeConfigHook(){this.myTextHoverScaleMultiplier=m(1.1,1.1,1.1),this.myThumbstickToggleThreshold=.6,this.myButtonEditDelay=0}};import{CollisionComponent as fm,MeshComponent as Mb,TextComponent as Pm}from"@wonderlandengine/api";import{CursorTarget as Cm}from"@wonderlandengine/components";import{CollisionComponent as _s,MeshComponent as Ia,TextComponent as Ha}from"@wonderlandengine/api";import{CursorTarget as La}from"@wonderlandengine/components";var Jt=class{constructor(e=r.getMainEngine()){this._myEngine=e,this._myDestroyed=!1}build(e,t,n){this._myParentObject=e,this._myConfig=t,this._myParams=n,this._myImportExportButtonsVisible=!0,this._myPlaneMesh=r.getDefaultMeshes(this._myEngine).myPlane,this._buildHook(),this._createSkeleton(),this._setTransforms(),this._addComponents(),this._setTransformForNonXR(),B.registerSessionStartEndEventListeners(this,this._onXRSessionStart.bind(this),this._onXRSessionEnd.bind(this),!0,!1,this._myEngine)}setVisible(e){this.myPivotObject.pp_setActive(e),e&&this.setImportExportButtonsVisible(this._myImportExportButtonsVisible),this._setVisibleHook(e)}setImportExportButtonsVisible(e){this._myImportExportButtonsVisible=e,this.myImportExportPanel.pp_setActive(this._myImportExportButtonsVisible)}_buildHook(){}_setVisibleHook(e){}_createSkeletonHook(){}_setTransformHook(){}_addComponentsHook(){}_createSkeleton(){this.myPivotObject=this._myParentObject.pp_addObject(),this.myBackPanel=this.myPivotObject.pp_addObject(),this.myBackBackground=this.myBackPanel.pp_addObject(),this.myDisplayPanel=this.myPivotObject.pp_addObject(),this.myVariableLabelPanel=this.myDisplayPanel.pp_addObject(),this.myVariableLabelText=this.myVariableLabelPanel.pp_addObject(),this.myVariableLabelCursorTarget=this.myVariableLabelPanel.pp_addObject(),this.myNextButtonPanel=this.myVariableLabelPanel.pp_addObject(),this.myNextButtonBackground=this.myNextButtonPanel.pp_addObject(),this.myNextButtonText=this.myNextButtonPanel.pp_addObject(),this.myNextButtonCursorTarget=this.myNextButtonPanel.pp_addObject(),this.myPreviousButtonPanel=this.myVariableLabelPanel.pp_addObject(),this.myPreviousButtonBackground=this.myPreviousButtonPanel.pp_addObject(),this.myPreviousButtonText=this.myPreviousButtonPanel.pp_addObject(),this.myPreviousButtonCursorTarget=this.myPreviousButtonPanel.pp_addObject(),this.myImportExportPanel=this.myPivotObject.pp_addObject(),this.myImportButtonPanel=this.myImportExportPanel.pp_addObject(),this.myImportButtonBackground=this.myImportButtonPanel.pp_addObject(),this.myImportButtonText=this.myImportButtonPanel.pp_addObject(),this.myImportButtonCursorTarget=this.myImportButtonPanel.pp_addObject(),this.myExportButtonPanel=this.myImportExportPanel.pp_addObject(),this.myExportButtonBackground=this.myExportButtonPanel.pp_addObject(),this.myExportButtonText=this.myExportButtonPanel.pp_addObject(),this.myExportButtonCursorTarget=this.myExportButtonPanel.pp_addObject(),this.myPointerCursorTarget=this.myPivotObject.pp_addObject(),this._createSkeletonHook()}_setTransforms(){this.myPivotObject.pp_setPositionLocal(this._myConfig.myPivotObjectPositions[this._myParams.myHandedness]),this.myBackPanel.pp_setPositionLocal(this._myConfig.myBackPanelPosition),this.myBackBackground.pp_scaleObject(this._myConfig.myBackBackgroundScale),this.myDisplayPanel.pp_setPositionLocal(this._myConfig.myDisplayPanelPosition),this.myVariableLabelPanel.pp_setPositionLocal(this._myConfig.myVariableLabelPanelPosition),this.myVariableLabelText.pp_scaleObject(this._myConfig.myVariableLabelTextScale),this.myVariableLabelCursorTarget.pp_setPositionLocal(this._myConfig.myVariableLabelCursorTargetPosition),this.myNextButtonPanel.pp_setPositionLocal(this._myConfig.myRightSideButtonPosition),this.myNextButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myNextButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myNextButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myNextButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myPreviousButtonPanel.pp_setPositionLocal(this._myConfig.myLeftSideButtonPosition),this.myPreviousButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myPreviousButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myPreviousButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myPreviousButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myImportExportPanel.pp_setPositionLocal(this._myConfig.myImportExportPanelPosition),this.myImportButtonPanel.pp_setPositionLocal(this._myConfig.myImportButtonPosition),this.myImportButtonBackground.pp_scaleObject(this._myConfig.myImportExportButtonBackgroundScale),this.myImportButtonText.pp_setPositionLocal(this._myConfig.myImportExportButtonTextPosition),this.myImportButtonText.pp_scaleObject(this._myConfig.myImportExportButtonTextScale),this.myImportButtonCursorTarget.pp_setPositionLocal(this._myConfig.myImportExportButtonCursorTargetPosition),this.myExportButtonPanel.pp_setPositionLocal(this._myConfig.myExportButtonPosition),this.myExportButtonBackground.pp_scaleObject(this._myConfig.myImportExportButtonBackgroundScale),this.myExportButtonText.pp_setPositionLocal(this._myConfig.myImportExportButtonTextPosition),this.myExportButtonText.pp_scaleObject(this._myConfig.myImportExportButtonTextScale),this.myExportButtonCursorTarget.pp_setPositionLocal(this._myConfig.myImportExportButtonCursorTargetPosition),this.myPointerCursorTarget.pp_setPositionLocal(this._myConfig.myPointerCursorTargetPosition),this._setTransformHook()}_addComponents(){this.myBackBackgroundComponent=this.myBackBackground.pp_addComponent(Ia),this.myBackBackgroundComponent.mesh=this._myPlaneMesh,this.myBackBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myBackBackgroundComponent.material.color=this._myConfig.myBackBackgroundColor,this.myVariableLabelTextComponent=this.myVariableLabelText.pp_addComponent(Ha),this._setupTextComponent(this.myVariableLabelTextComponent),this.myVariableLabelTextComponent.text=" ",this.myVariableLabelCursorTargetComponent=this.myVariableLabelCursorTarget.pp_addComponent(La),this.myVariableLabelCollisionComponent=this.myVariableLabelCursorTarget.pp_addComponent(_s),this.myVariableLabelCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myVariableLabelCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myVariableLabelCollisionComponent.extents=this._myConfig.myVariableLabelCollisionExtents,this.myNextButtonBackgroundComponent=this.myNextButtonBackground.pp_addComponent(Ia),this.myNextButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myNextButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myNextButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myNextButtonTextComponent=this.myNextButtonText.pp_addComponent(Ha),this._setupTextComponent(this.myNextButtonTextComponent),this.myNextButtonTextComponent.text=this._myConfig.myNextButtonText,this.myNextButtonCursorTargetComponent=this.myNextButtonCursorTarget.pp_addComponent(La),this.myNextButtonCollisionComponent=this.myNextButtonCursorTarget.pp_addComponent(_s),this.myNextButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myNextButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myNextButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myPreviousButtonBackgroundComponent=this.myPreviousButtonBackground.pp_addComponent(Ia),this.myPreviousButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPreviousButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myPreviousButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myPreviousButtonTextComponent=this.myPreviousButtonText.pp_addComponent(Ha),this._setupTextComponent(this.myPreviousButtonTextComponent),this.myPreviousButtonTextComponent.text=this._myConfig.myPreviousButtonText,this.myPreviousButtonCursorTargetComponent=this.myPreviousButtonCursorTarget.pp_addComponent(La),this.myPreviousButtonCollisionComponent=this.myPreviousButtonCursorTarget.pp_addComponent(_s),this.myPreviousButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPreviousButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPreviousButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myImportButtonBackgroundComponent=this.myImportButtonBackground.pp_addComponent(Ia),this.myImportButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myImportButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myImportButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myImportButtonTextComponent=this.myImportButtonText.pp_addComponent(Ha),this._setupTextComponent(this.myImportButtonTextComponent),this.myImportButtonTextComponent.text=this._myConfig.myImportButtonText,this.myImportButtonCursorTargetComponent=this.myImportButtonCursorTarget.pp_addComponent(La),this.myImportButtonCollisionComponent=this.myImportButtonCursorTarget.pp_addComponent(_s),this.myImportButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myImportButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myImportButtonCollisionComponent.extents=this._myConfig.myImportExportButtonCollisionExtents,this.myExportButtonBackgroundComponent=this.myExportButtonBackground.pp_addComponent(Ia),this.myExportButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myExportButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myExportButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myExportButtonTextComponent=this.myExportButtonText.pp_addComponent(Ha),this._setupTextComponent(this.myExportButtonTextComponent),this.myExportButtonTextComponent.text=this._myConfig.myExportButtonText,this.myExportButtonCursorTargetComponent=this.myExportButtonCursorTarget.pp_addComponent(La),this.myExportButtonCollisionComponent=this.myExportButtonCursorTarget.pp_addComponent(_s),this.myExportButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myExportButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myExportButtonCollisionComponent.extents=this._myConfig.myImportExportButtonCollisionExtents,this.myPointerCollisionComponent=this.myPointerCursorTarget.pp_addComponent(_s),this.myPointerCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPointerCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPointerCollisionComponent.extents=this._myConfig.myPointerCollisionExtents,this._addComponentsHook()}_setupTextComponent(e){e.alignment=this._myConfig.myTextAlignment,e.justification=this._myConfig.myTextJustification,e.material=this._myParams.myTextMaterial.clone(),e.material.color=this._myConfig.myTextColor,e.text=""}_onXRSessionStart(){this._setTransformForXR()}_onXRSessionEnd(){this._setTransformForNonXR()}_setTransformForXR(){this.myPivotObject.pp_setPositionLocal(this._myConfig.myPivotObjectPositions[this._myParams.myHandedness])}_setTransformForNonXR(){this.myPivotObject.pp_setPositionLocal(this._myConfig.myPivotObjectPositions[U.NONE])}destroy(){this._myDestroyed=!0,B.unregisterSessionStartEndEventListeners(this,this._myEngine)}isDestroyed(){return this._myDestroyed}};var ka=class extends Jt{constructor(e){super(e)}setAdditionalButtonsVisible(e){this._myAdditionalButtonsVisible=e;for(let t=0;t<this._myConfig.myArraySize;t++)this.myValueIncreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible),this.myValueDecreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible)}_buildHook(){this._myAdditionalButtonsVisible=!0}_createSkeletonHook(){this.myValuesPanel=this.myDisplayPanel.pp_addObject(),this.myValuePanels=[],this.myValueTexts=[],this.myValueCursorTargets=[],this.myValueIncreaseButtonPanels=[],this.myValueIncreaseButtonBackgrounds=[],this.myValueIncreaseButtonTexts=[],this.myValueIncreaseButtonCursorTargets=[],this.myValueDecreaseButtonPanels=[],this.myValueDecreaseButtonBackgrounds=[],this.myValueDecreaseButtonTexts=[],this.myValueDecreaseButtonCursorTargets=[];for(let e=0;e<this._myConfig.myArraySize;e++)this.myValuePanels[e]=this.myValuesPanel.pp_addObject(),this.myValueTexts[e]=this.myValuePanels[e].pp_addObject(),this.myValueCursorTargets[e]=this.myValuePanels[e].pp_addObject(),this.myValueIncreaseButtonPanels[e]=this.myValuePanels[e].pp_addObject(),this.myValueIncreaseButtonBackgrounds[e]=this.myValueIncreaseButtonPanels[e].pp_addObject(),this.myValueIncreaseButtonTexts[e]=this.myValueIncreaseButtonPanels[e].pp_addObject(),this.myValueIncreaseButtonCursorTargets[e]=this.myValueIncreaseButtonPanels[e].pp_addObject(),this.myValueDecreaseButtonPanels[e]=this.myValuePanels[e].pp_addObject(),this.myValueDecreaseButtonBackgrounds[e]=this.myValueDecreaseButtonPanels[e].pp_addObject(),this.myValueDecreaseButtonTexts[e]=this.myValueDecreaseButtonPanels[e].pp_addObject(),this.myValueDecreaseButtonCursorTargets[e]=this.myValueDecreaseButtonPanels[e].pp_addObject()}_setTransformHook(){this.myValuesPanel.pp_setPositionLocal(this._myConfig.myValuesPanelPosition);for(let e=0;e<this._myConfig.myArraySize;e++)this.myValuePanels[e].pp_setPositionLocal(this._myConfig.myValuePanelsPositions[e]),this.myValueTexts[e].pp_scaleObject(this._myConfig.myValueTextScale),this.myValueCursorTargets[e].pp_setPositionLocal(this._myConfig.myValueCursorTargetPosition),this.myValueIncreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myRightSideButtonPosition),this.myValueIncreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myValueIncreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myValueIncreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myValueIncreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myValueDecreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myLeftSideButtonPosition),this.myValueDecreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myValueDecreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myValueDecreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myValueDecreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition)}_addComponentsHook(){this.myValueTextComponents=[],this.myValueCursorTargetComponents=[],this.myValueCollisionComponents=[],this.myValueIncreaseButtonBackgroundComponents=[],this.myValueIncreaseButtonTextComponents=[],this.myValueIncreaseButtonCursorTargetComponents=[],this.myValueIncreaseButtonCollisionComponents=[],this.myValueDecreaseButtonBackgroundComponents=[],this.myValueDecreaseButtonTextComponents=[],this.myValueDecreaseButtonCursorTargetComponents=[],this.myValueDecreaseButtonCollisionComponents=[];for(let e=0;e<this._myConfig.myArraySize;e++)this.myValueTextComponents[e]=this.myValueTexts[e].pp_addComponent(Pm),this._setupTextComponent(this.myValueTextComponents[e]),this.myValueTextComponents[e].text=" ",this.myValueCursorTargetComponents[e]=this.myValueCursorTargets[e].pp_addComponent(Cm),this.myValueCollisionComponents[e]=this.myValueCursorTargets[e].pp_addComponent(fm),this.myValueCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myValueCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myValueCollisionComponents[e].extents=this._myConfig.myValueCollisionExtents,this.myValueIncreaseButtonBackgroundComponents[e]=this.myValueIncreaseButtonBackgrounds[e].pp_addComponent(Mb),this.myValueIncreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myValueIncreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myValueIncreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myValueIncreaseButtonTextComponents[e]=this.myValueIncreaseButtonTexts[e].pp_addComponent(Pm),this._setupTextComponent(this.myValueIncreaseButtonTextComponents[e]),this.myValueIncreaseButtonTextComponents[e].text=this._myConfig.myIncreaseButtonText,this.myValueIncreaseButtonCursorTargetComponents[e]=this.myValueIncreaseButtonCursorTargets[e].pp_addComponent(Cm),this.myValueIncreaseButtonCollisionComponents[e]=this.myValueIncreaseButtonCursorTargets[e].pp_addComponent(fm),this.myValueIncreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myValueIncreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myValueIncreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents,this.myValueDecreaseButtonBackgroundComponents[e]=this.myValueDecreaseButtonBackgrounds[e].pp_addComponent(Mb),this.myValueDecreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myValueDecreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myValueDecreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myValueDecreaseButtonTextComponents[e]=this.myValueDecreaseButtonTexts[e].pp_addComponent(Pm),this._setupTextComponent(this.myValueDecreaseButtonTextComponents[e]),this.myValueDecreaseButtonTextComponents[e].text=this._myConfig.myDecreaseButtonText,this.myValueDecreaseButtonCursorTargetComponents[e]=this.myValueDecreaseButtonCursorTargets[e].pp_addComponent(Cm),this.myValueDecreaseButtonCollisionComponents[e]=this.myValueDecreaseButtonCursorTargets[e].pp_addComponent(fm),this.myValueDecreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myValueDecreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myValueDecreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents}_setVisibleHook(e){e&&this.setAdditionalButtonsVisible(this._myAdditionalButtonsVisible)}};var Fa=class extends Xt{constructor(e,t,n,o=r.getMainEngine()){super(e),this._myNonArray=t==null,this._myArraySize=this._myNonArray?1:t,this._myConfig=new Ba(this._myArraySize),this._myUI=new ka(o),this._myGamepad=n,this._myValueEditIndex=0,this._myValueButtonEditIntensity=0,this._myValueButtonEditIntensityTimer=0,this._myValueEditEnabled=!1,this._myTempValue=[],this._myTempNonArrayValue=[0],this._myTempNonArrayDefaultValue=[0]}_refreshUIHook(){for(let e=0;e<this._myArraySize;e++)this._myUI.myValueTextComponents[e].text=this._getVariableValue()[e]?"true":"false"}_startHook(e,t){this._myUI.setAdditionalButtonsVisible(t.myAdditionalButtonsVisible)}_setEasyTuneVariableHook(){this._myVariable!=null&&this._myTempValue.pp_copy(this._getVariableValue())}_updateHook(e){this._updateValue(e)}_updateValue(e){let t=0;this._myGamepad&&(t=this._myGamepad.getAxesInfo(oe.THUMBSTICK).myAxes[1]);let n=0;this._myValueEditEnabled?n=t:this._myValueButtonEditIntensity!=0&&(this._myValueButtonEditIntensityTimer<=0?n=this._myValueButtonEditIntensity:this._myValueButtonEditIntensityTimer-=e),Math.abs(n)>this._myConfig.myThumbstickToggleThreshold&&(this._myTempValue.pp_copy(this._getVariableValue()),this._myTempValue[this._myValueEditIndex]=n>0,this._setVariableValue(this._myTempValue),this._refreshUI())}_addListenersHook(){let e=this._myUI;e.myVariableLabelCursorTargetComponent.onClick.add(this._resetAllValues.bind(this)),e.myVariableLabelCursorTargetComponent.onHover.add(this._genericTextHover.bind(this,e.myVariableLabelText)),e.myVariableLabelCursorTargetComponent.onUnhover.add(this._genericTextUnHover.bind(this,e.myVariableLabelText,this._myConfig.myVariableLabelTextScale));for(let t=0;t<this._myArraySize;t++)e.myValueIncreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,t,1)),e.myValueIncreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,t,1)),e.myValueIncreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,t,0)),e.myValueIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,t,0)),e.myValueDecreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,t,-1)),e.myValueDecreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,t,-1)),e.myValueDecreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,t,0)),e.myValueDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,t,0)),e.myValueIncreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myValueIncreaseButtonBackgroundComponents[t].material)),e.myValueIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnHover.bind(this,e.myValueIncreaseButtonBackgroundComponents[t].material)),e.myValueDecreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myValueDecreaseButtonBackgroundComponents[t].material)),e.myValueDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnHover.bind(this,e.myValueDecreaseButtonBackgroundComponents[t].material)),e.myValueCursorTargetComponents[t].onClick.add(this._resetValue.bind(this,t)),e.myValueCursorTargetComponents[t].onHover.add(this._setValueEditEnabled.bind(this,t,e.myValueTexts[t],!0)),e.myValueCursorTargetComponents[t].onUnhover.add(this._setValueEditEnabled.bind(this,t,e.myValueTexts[t],!1))}_setValueEditIntensity(e,t){(this._isActive()||t==0)&&(t!=0&&(this._myValueButtonEditIntensityTimer=this._myConfig.myButtonEditDelay,this._myValueEditIndex=e),this._myValueButtonEditIntensity=t)}_setValueEditEnabled(e,t,n){(this._isActive()||!n)&&(n?(this._myValueEditIndex=e,t.pp_scaleObject(this._myConfig.myTextHoverScaleMultiplier)):t.pp_setScaleLocal(this._myConfig.myValueTextScale),this._myValueEditEnabled=n)}_resetValue(e){this._isActive()&&(this._myTempValue.pp_copy(this._getVariableValue()),this._myTempValue[e]=this._getVariableDefaultValue()[e],this._setVariableValue(this._myTempValue),this._myUI.myValueTextComponents[e].text=this._getVariableValue()[e]?"true":"false")}_resetAllValues(){for(let e=0;e<this._myArraySize;e++)this._resetValue(e)}_genericTextHover(e){e.pp_scaleObject(this._myConfig.myTextHoverScaleMultiplier)}_genericTextUnHover(e,t){e.pp_setScaleLocal(t)}_getVariableValue(){return this._myNonArray?(this._myTempNonArrayValue[0]=this._myVariable.getValue(),this._myTempNonArrayValue):this._myVariable.getValue()}_getVariableDefaultValue(){return this._myNonArray?(this._myTempNonArrayDefaultValue[0]=this._myVariable.getDefaultValue(),this._myTempNonArrayDefaultValue):this._myVariable.getDefaultValue()}_setVariableValue(e){this._myNonArray?this._myVariable.setValue(e[0]):this._myVariable.setValue(this._myTempValue)}};var wa=class extends Bo{_getEasyTuneArrayWidget(e){return new Fa(this._myParams,e,this._myGamepad,this._myEngine)}};var ja=class{constructor(){this._setupRuntimeConfig()}_setupRuntimeConfig(){this.myGamepadHandedness=U.RIGHT,this.myScrollVariableDelay=.5,this.myScrollVariableMinXThreshold=.6,this.myScrollVariableMaxYThreshold=.25,this.myScrollVariableButtonID=null,this.myRefreshVariablesDelay=null}};var za=class extends Kt{_getBackPanelMinY(){return super._getBackPanelMinY()+this.myTypeNotSupportedPanelPosition[1]}_getPivotZOffset(){return .00804713}_setupBuildConfigHook(){this.myTypeNotSupportedPanelPosition=m(0,-.03,this._myPanelZOffset),this.myTypeNotSupportedTextScale=m(.275,.275,.275),this.myTypeNotSupportedText="Type Not Supported"}};import{TextComponent as eV}from"@wonderlandengine/api";var Na=class extends Jt{constructor(e){super(e)}_createSkeletonHook(){this.myTypeNotSupportedPanel=this.myDisplayPanel.pp_addObject(),this.myTypeNotSupportedText=this.myTypeNotSupportedPanel.pp_addObject(),this.myTypeNotSupportedCursorTarget=this.myTypeNotSupportedPanel.pp_addObject()}_setTransformHook(){this.myTypeNotSupportedPanel.pp_setPositionLocal(this._myConfig.myTypeNotSupportedPanelPosition),this.myTypeNotSupportedText.pp_scaleObject(this._myConfig.myTypeNotSupportedTextScale)}_addComponentsHook(){this.myTypeNotSupportedTextComponent=this.myTypeNotSupportedText.pp_addComponent(eV),this._setupTextComponent(this.myTypeNotSupportedTextComponent),this.myTypeNotSupportedTextComponent.text=this._myConfig.myTypeNotSupportedText}};var Ga=class extends Xt{constructor(e,t=r.getMainEngine()){super(e),this._myConfig=new za,this._myUI=new Na(t)}};var Ua=class extends Kt{constructor(e){super(),this.myArraySize=e}_getBackPanelMinY(){return this.myStepPanelPosition[1]-this._mySideButtonDistanceFromBorder*1.25-this.mySideButtonBackgroundScale[1]}_getPivotZOffset(){return .00803713}_setupBuildConfigHook(){this.myIncreaseButtonText="+",this.myDecreaseButtonText="-",this._myValuePanelDistanceFromVariableLabelPanel=.055,this._myDistanceBetweenValues=this.mySideButtonBackgroundScale[1]*2+.015,this.myValuesPanelPosition=[0,this.myVariableLabelPanelPosition[1]-this._myValuePanelDistanceFromVariableLabelPanel,this._myPanelZOffset],this.myValueTextScale=m(.4,.4,.4),this.myValueCursorTargetPosition=m(0,0,0),this.myValueCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myValueCollisionExtents=m(.065,.02,1),this.myValueCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myValuePanelsPositions=[],this.myValuePanelsPositions[0]=m(0,0,0);for(let t=1;t<this.myArraySize;t++)this.myValuePanelsPositions[t]=this.myValuePanelsPositions[t-1].pp_clone(),this.myValuePanelsPositions[t][1]-=this._myDistanceBetweenValues;let e=this.myValuePanelsPositions[this.myArraySize-1]?this.myValuePanelsPositions[this.myArraySize-1][1]:0;this.myStepPanelPosition=[0,this.myDisplayPanelPosition[1]+this.myValuesPanelPosition[1]+e-this._myValuePanelDistanceFromVariableLabelPanel,this._myPanelZOffset],this.myStepTextScale=this.myLabelTextScale,this.myStepStartString="Step: ",this.myStepCursorTargetPosition=m(0,0,0),this.myStepCursorTargetPosition[2]=this._myColliderZOffset-this.myStepPanelPosition[2],this.myStepCollisionExtents=m(.065,.0175,1),this.myStepCollisionExtents[2]=this.myCursorTargetCollisionThickness}_setupRuntimeConfigHook(){this.myTextHoverScaleMultiplier=m(1.1,1.1,1.1),this.myEditThumbstickMinThreshold=.35,this.myStepMultiplierStepPerSecond=2.25,this.myButtonEditDelay=0}};import{CollisionComponent as gs,MeshComponent as il,TextComponent as fs}from"@wonderlandengine/api";import{CursorTarget as Ps}from"@wonderlandengine/components";var Wa=class extends Jt{constructor(e){super(e)}setAdditionalButtonsVisible(e){this._myAdditionalButtonsVisible=e;for(let t=0;t<this._myConfig.myArraySize;t++)this.myValueIncreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible),this.myValueDecreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible);this.myStepIncreaseButtonPanel.pp_setActive(this._myAdditionalButtonsVisible),this.myStepDecreaseButtonPanel.pp_setActive(this._myAdditionalButtonsVisible)}_buildHook(){this._myAdditionalButtonsVisible=!0}_createSkeletonHook(){this.myValuesPanel=this.myDisplayPanel.pp_addObject(),this.myValuePanels=[],this.myValueTexts=[],this.myValueCursorTargets=[],this.myValueIncreaseButtonPanels=[],this.myValueIncreaseButtonBackgrounds=[],this.myValueIncreaseButtonTexts=[],this.myValueIncreaseButtonCursorTargets=[],this.myValueDecreaseButtonPanels=[],this.myValueDecreaseButtonBackgrounds=[],this.myValueDecreaseButtonTexts=[],this.myValueDecreaseButtonCursorTargets=[];for(let e=0;e<this._myConfig.myArraySize;e++)this.myValuePanels[e]=this.myValuesPanel.pp_addObject(),this.myValueTexts[e]=this.myValuePanels[e].pp_addObject(),this.myValueCursorTargets[e]=this.myValuePanels[e].pp_addObject(),this.myValueIncreaseButtonPanels[e]=this.myValuePanels[e].pp_addObject(),this.myValueIncreaseButtonBackgrounds[e]=this.myValueIncreaseButtonPanels[e].pp_addObject(),this.myValueIncreaseButtonTexts[e]=this.myValueIncreaseButtonPanels[e].pp_addObject(),this.myValueIncreaseButtonCursorTargets[e]=this.myValueIncreaseButtonPanels[e].pp_addObject(),this.myValueDecreaseButtonPanels[e]=this.myValuePanels[e].pp_addObject(),this.myValueDecreaseButtonBackgrounds[e]=this.myValueDecreaseButtonPanels[e].pp_addObject(),this.myValueDecreaseButtonTexts[e]=this.myValueDecreaseButtonPanels[e].pp_addObject(),this.myValueDecreaseButtonCursorTargets[e]=this.myValueDecreaseButtonPanels[e].pp_addObject();this.myStepPanel=this.myPivotObject.pp_addObject(),this.myStepText=this.myStepPanel.pp_addObject(),this.myStepCursorTarget=this.myStepPanel.pp_addObject(),this.myStepIncreaseButtonPanel=this.myStepPanel.pp_addObject(),this.myStepIncreaseButtonBackground=this.myStepIncreaseButtonPanel.pp_addObject(),this.myStepIncreaseButtonText=this.myStepIncreaseButtonPanel.pp_addObject(),this.myStepIncreaseButtonCursorTarget=this.myStepIncreaseButtonPanel.pp_addObject(),this.myStepDecreaseButtonPanel=this.myStepPanel.pp_addObject(),this.myStepDecreaseButtonBackground=this.myStepDecreaseButtonPanel.pp_addObject(),this.myStepDecreaseButtonText=this.myStepDecreaseButtonPanel.pp_addObject(),this.myStepDecreaseButtonCursorTarget=this.myStepDecreaseButtonPanel.pp_addObject()}_setTransformHook(){this.myValuesPanel.pp_setPositionLocal(this._myConfig.myValuesPanelPosition);for(let e=0;e<this._myConfig.myArraySize;e++)this.myValuePanels[e].pp_setPositionLocal(this._myConfig.myValuePanelsPositions[e]),this.myValueTexts[e].pp_scaleObject(this._myConfig.myValueTextScale),this.myValueCursorTargets[e].pp_setPositionLocal(this._myConfig.myValueCursorTargetPosition),this.myValueIncreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myRightSideButtonPosition),this.myValueIncreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myValueIncreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myValueIncreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myValueIncreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myValueDecreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myLeftSideButtonPosition),this.myValueDecreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myValueDecreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myValueDecreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myValueDecreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition);this.myStepPanel.pp_setPositionLocal(this._myConfig.myStepPanelPosition),this.myStepText.pp_scaleObject(this._myConfig.myStepTextScale),this.myStepCursorTarget.pp_setPositionLocal(this._myConfig.myStepCursorTargetPosition),this.myStepIncreaseButtonPanel.pp_setPositionLocal(this._myConfig.myRightSideButtonPosition),this.myStepIncreaseButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myStepIncreaseButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myStepIncreaseButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myStepIncreaseButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myStepDecreaseButtonPanel.pp_setPositionLocal(this._myConfig.myLeftSideButtonPosition),this.myStepDecreaseButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myStepDecreaseButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myStepDecreaseButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myStepDecreaseButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition)}_addComponentsHook(){this.myValueTextComponents=[],this.myValueCursorTargetComponents=[],this.myValueCollisionComponents=[],this.myValueIncreaseButtonBackgroundComponents=[],this.myValueIncreaseButtonTextComponents=[],this.myValueIncreaseButtonCursorTargetComponents=[],this.myValueIncreaseButtonCollisionComponents=[],this.myValueDecreaseButtonBackgroundComponents=[],this.myValueDecreaseButtonTextComponents=[],this.myValueDecreaseButtonCursorTargetComponents=[],this.myValueDecreaseButtonCollisionComponents=[];for(let e=0;e<this._myConfig.myArraySize;e++)this.myValueTextComponents[e]=this.myValueTexts[e].pp_addComponent(fs),this._setupTextComponent(this.myValueTextComponents[e]),this.myValueTextComponents[e].text=" ",this.myValueCursorTargetComponents[e]=this.myValueCursorTargets[e].pp_addComponent(Ps),this.myValueCollisionComponents[e]=this.myValueCursorTargets[e].pp_addComponent(gs),this.myValueCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myValueCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myValueCollisionComponents[e].extents=this._myConfig.myValueCollisionExtents,this.myValueIncreaseButtonBackgroundComponents[e]=this.myValueIncreaseButtonBackgrounds[e].pp_addComponent(il),this.myValueIncreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myValueIncreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myValueIncreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myValueIncreaseButtonTextComponents[e]=this.myValueIncreaseButtonTexts[e].pp_addComponent(fs),this._setupTextComponent(this.myValueIncreaseButtonTextComponents[e]),this.myValueIncreaseButtonTextComponents[e].text=this._myConfig.myIncreaseButtonText,this.myValueIncreaseButtonCursorTargetComponents[e]=this.myValueIncreaseButtonCursorTargets[e].pp_addComponent(Ps),this.myValueIncreaseButtonCollisionComponents[e]=this.myValueIncreaseButtonCursorTargets[e].pp_addComponent(gs),this.myValueIncreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myValueIncreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myValueIncreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents,this.myValueDecreaseButtonBackgroundComponents[e]=this.myValueDecreaseButtonBackgrounds[e].pp_addComponent(il),this.myValueDecreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myValueDecreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myValueDecreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myValueDecreaseButtonTextComponents[e]=this.myValueDecreaseButtonTexts[e].pp_addComponent(fs),this._setupTextComponent(this.myValueDecreaseButtonTextComponents[e]),this.myValueDecreaseButtonTextComponents[e].text=this._myConfig.myDecreaseButtonText,this.myValueDecreaseButtonCursorTargetComponents[e]=this.myValueDecreaseButtonCursorTargets[e].pp_addComponent(Ps),this.myValueDecreaseButtonCollisionComponents[e]=this.myValueDecreaseButtonCursorTargets[e].pp_addComponent(gs),this.myValueDecreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myValueDecreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myValueDecreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents;this.myStepTextComponent=this.myStepText.pp_addComponent(fs),this._setupTextComponent(this.myStepTextComponent),this.myStepTextComponent.text=" ",this.myStepCursorTargetComponent=this.myStepCursorTarget.pp_addComponent(Ps),this.myStepCollisionComponent=this.myStepCursorTarget.pp_addComponent(gs),this.myStepCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myStepCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myStepCollisionComponent.extents=this._myConfig.myStepCollisionExtents,this.myStepIncreaseButtonBackgroundComponent=this.myStepIncreaseButtonBackground.pp_addComponent(il),this.myStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myStepIncreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myStepIncreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myStepIncreaseButtonTextComponent=this.myStepIncreaseButtonText.pp_addComponent(fs),this._setupTextComponent(this.myStepIncreaseButtonTextComponent),this.myStepIncreaseButtonTextComponent.text=this._myConfig.myIncreaseButtonText,this.myStepIncreaseButtonCursorTargetComponent=this.myStepIncreaseButtonCursorTarget.pp_addComponent(Ps),this.myStepIncreaseButtonCollisionComponent=this.myStepIncreaseButtonCursorTarget.pp_addComponent(gs),this.myStepIncreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myStepIncreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myStepIncreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myStepDecreaseButtonBackgroundComponent=this.myStepDecreaseButtonBackground.pp_addComponent(il),this.myStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myStepDecreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myStepDecreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myStepDecreaseButtonTextComponent=this.myStepDecreaseButtonText.pp_addComponent(fs),this._setupTextComponent(this.myStepDecreaseButtonTextComponent),this.myStepDecreaseButtonTextComponent.text=this._myConfig.myDecreaseButtonText,this.myStepDecreaseButtonCursorTargetComponent=this.myStepDecreaseButtonCursorTarget.pp_addComponent(Ps),this.myStepDecreaseButtonCollisionComponent=this.myStepDecreaseButtonCursorTarget.pp_addComponent(gs),this.myStepDecreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myStepDecreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myStepDecreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents}_setVisibleHook(e){e&&this.setAdditionalButtonsVisible(this._myAdditionalButtonsVisible)}};var Qa=class extends Xt{constructor(e,t,n,o=r.getMainEngine()){super(e),this._myGamepad=n,this._myNonArray=t==null,this._myArraySize=this._myNonArray?1:t,this._myConfig=new Ua(this._myArraySize),this._myUI=new Wa(o),this._myValueEditIndex=-1,this._myValueButtonEditIntensity=0,this._myValueButtonEditIntensityTimer=0,this._myStepButtonEditIntensity=0,this._myStepButtonEditIntensityTimer=0,this._myValueEditEnabled=!1,this._myStepEditEnabled=!1,this._myValueRealValue=0,this._myStepMultiplierValue=0,this._myStepFastEdit=!1,this._myTempValue=[],this._myTempNonArrayValue=[0],this._myTempNonArrayDefaultValue=[0]}_setEasyTuneVariableHook(){this._myValueEditIndex>=0&&(this._myValueRealValue=this._getVariableValue()[this._myValueEditIndex])}_refreshUIHook(){for(let e=0;e<this._myArraySize;e++)this._myUI.myValueTextComponents[e].text=this._getVariableValue()[e].toFixed(this._myVariable._myDecimalPlaces);this._myUI.myStepTextComponent.text=this._myConfig.myStepStartString.concat(this._myVariable._myStepPerSecond)}_startHook(e,t){this._myUI.setAdditionalButtonsVisible(t.myAdditionalButtonsVisible)}_setEasyTuneVariableHook(){this._myVariable!=null&&this._myTempValue.pp_copy(this._getVariableValue())}_updateHook(e){this._updateValue(e)}_updateValue(e){let t=0;if(this._myGamepad){let s=this._myGamepad.getAxesInfo(oe.THUMBSTICK).myAxes[1];if(Math.abs(s)>this._myConfig.myEditThumbstickMinThreshold){let a=(Math.abs(s)-this._myConfig.myEditThumbstickMinThreshold)/(1-this._myConfig.myEditThumbstickMinThreshold);t=Math.sign(s)*a}}let n=0;if(this._myValueEditEnabled?n=t:this._myValueButtonEditIntensity!=0&&(this._myValueButtonEditIntensityTimer<=0?n=this._myValueButtonEditIntensity:this._myValueButtonEditIntensityTimer-=e),n!=0){let s=n*this._myVariable._myStepPerSecond*e;this._myValueRealValue+=s,this._myVariable._myMin!=null&&this._myVariable._myMax!=null?this._myValueRealValue=Math.pp_clamp(this._myValueRealValue,this._myVariable._myMin,this._myVariable._myMax):this._myVariable._myMin!=null?this._myValueRealValue=Math.max(this._myValueRealValue,this._myVariable._myMin):this._myVariable._myMax!=null&&(this._myValueRealValue=Math.min(this._myValueRealValue,this._myVariable._myMax));let a=Math.pow(10,this._myVariable._myDecimalPlaces);if(this._myTempValue.pp_copy(this._getVariableValue()),this._myVariable._myEditAllValuesTogether){let h=Math.round(this._myValueRealValue*a+Number.EPSILON)/a-this._myTempValue[this._myValueEditIndex];for(let _=0;_<this._myArraySize;_++)this._myTempValue[_]=Math.round((this._myTempValue[_]+h)*a+Number.EPSILON)/a,this._myVariable._myMin!=null&&this._myVariable._myMax!=null?this._myTempValue[_]=Math.pp_clamp(this._myTempValue[_],this._myVariable._myMin,this._myVariable._myMax):this._myVariable._myMin!=null?this._myTempValue[_]=Math.max(this._myTempValue[_],this._myVariable._myMin):this._myVariable._myMax!=null&&(this._myTempValue[_]=Math.min(this._myTempValue[_],this._myVariable._myMax)),this._myUI.myValueTextComponents[_].text=this._myTempValue[_].toFixed(this._myVariable._myDecimalPlaces)}else this._myTempValue[this._myValueEditIndex]=Math.round(this._myValueRealValue*a+Number.EPSILON)/a,this._myVariable._myMin!=null&&this._myVariable._myMax!=null?this._myTempValue[this._myValueEditIndex]=Math.pp_clamp(this._myTempValue[this._myValueEditIndex],this._myVariable._myMin,this._myVariable._myMax):this._myVariable._myMin!=null?this._myTempValue[this._myValueEditIndex]=Math.max(this._myTempValue[this._myValueEditIndex],this._myVariable._myMin):this._myVariable._myMax!=null&&(this._myTempValue[this._myValueEditIndex]=Math.min(this._myTempValue[this._myValueEditIndex],this._myVariable._myMax)),this._myUI.myValueTextComponents[this._myValueEditIndex].text=this._myTempValue[this._myValueEditIndex].toFixed(this._myVariable._myDecimalPlaces);this._setVariableValue(this._myTempValue)}else this._myValueRealValue=this._getVariableValue()[this._myValueEditIndex];let o=0;if(this._myStepEditEnabled?o=t:this._myStepButtonEditIntensity!=0&&(this._myStepButtonEditIntensityTimer<=0?o=this._myStepButtonEditIntensity:this._myStepButtonEditIntensityTimer-=e),o!=0){let s=0;this._myStepFastEdit?(s=Math.sign(o)*1,this._myStepFastEdit=!1):s=o*this._myConfig.myStepMultiplierStepPerSecond*e,this._myStepMultiplierValue+=s,Math.abs(this._myStepMultiplierValue)>=1&&(Math.sign(this._myStepMultiplierValue)>0?(this._myStepMultiplierValue-=1,this._changeStep(this._myVariable._myStepPerSecond*10)):(this._myStepMultiplierValue+=1,this._changeStep(this._myVariable._myStepPerSecond*.1)))}else this._myStepMultiplierValue=0,this._myStepFastEdit=!0}_addListenersHook(){let e=this._myUI;e.myVariableLabelCursorTargetComponent.onClick.add(this._resetAllValues.bind(this)),e.myVariableLabelCursorTargetComponent.onHover.add(this._genericTextHover.bind(this,e.myVariableLabelText)),e.myVariableLabelCursorTargetComponent.onUnhover.add(this._genericTextUnHover.bind(this,e.myVariableLabelText,this._myConfig.myVariableLabelTextScale));for(let t=0;t<this._myArraySize;t++)e.myValueIncreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,t,1)),e.myValueIncreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,t,1)),e.myValueIncreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,t,0)),e.myValueIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,t,0)),e.myValueDecreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,t,-1)),e.myValueDecreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,t,-1)),e.myValueDecreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,t,0)),e.myValueDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,t,0)),e.myValueIncreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myValueIncreaseButtonBackgroundComponents[t].material)),e.myValueIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnHover.bind(this,e.myValueIncreaseButtonBackgroundComponents[t].material)),e.myValueDecreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myValueDecreaseButtonBackgroundComponents[t].material)),e.myValueDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnHover.bind(this,e.myValueDecreaseButtonBackgroundComponents[t].material)),e.myValueCursorTargetComponents[t].onClick.add(this._resetValue.bind(this,t)),e.myValueCursorTargetComponents[t].onHover.add(this._setValueEditEnabled.bind(this,t,e.myValueTexts[t],!0)),e.myValueCursorTargetComponents[t].onUnhover.add(this._setValueEditEnabled.bind(this,t,e.myValueTexts[t],!1));e.myStepCursorTargetComponent.onClick.add(this._resetStep.bind(this)),e.myStepCursorTargetComponent.onHover.add(this._setStepEditEnabled.bind(this,e.myStepText,!0)),e.myStepCursorTargetComponent.onUnhover.add(this._setStepEditEnabled.bind(this,e.myStepText,!1)),e.myStepIncreaseButtonCursorTargetComponent.onDown.add(this._setStepEditIntensity.bind(this,1)),e.myStepIncreaseButtonCursorTargetComponent.onDownOnHover.add(this._setStepEditIntensity.bind(this,1)),e.myStepIncreaseButtonCursorTargetComponent.onUp.add(this._setStepEditIntensity.bind(this,0)),e.myStepIncreaseButtonCursorTargetComponent.onUnhover.add(this._setStepEditIntensity.bind(this,0)),e.myStepDecreaseButtonCursorTargetComponent.onDown.add(this._setStepEditIntensity.bind(this,-1)),e.myStepDecreaseButtonCursorTargetComponent.onDownOnHover.add(this._setStepEditIntensity.bind(this,-1)),e.myStepDecreaseButtonCursorTargetComponent.onUp.add(this._setStepEditIntensity.bind(this,0)),e.myStepDecreaseButtonCursorTargetComponent.onUnhover.add(this._setStepEditIntensity.bind(this,0)),e.myStepIncreaseButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myStepIncreaseButtonBackgroundComponent.material)),e.myStepIncreaseButtonCursorTargetComponent.onUnhover.add(this._genericUnHover.bind(this,e.myStepIncreaseButtonBackgroundComponent.material)),e.myStepDecreaseButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myStepDecreaseButtonBackgroundComponent.material)),e.myStepDecreaseButtonCursorTargetComponent.onUnhover.add(this._genericUnHover.bind(this,e.myStepDecreaseButtonBackgroundComponent.material))}_setValueEditIntensity(e,t){(this._isActive()||t==0)&&(t!=0&&(this._myValueButtonEditIntensityTimer=this._myConfig.myButtonEditDelay,this._myValueRealValue=this._getVariableValue()[e],this._myValueEditIndex=e),this._myValueButtonEditIntensity=t)}_setStepEditIntensity(e){(this._isActive()||e==0)&&(e!=0&&(this._myStepButtonEditIntensityTimer=this._myConfig.myButtonEditDelay),this._myStepButtonEditIntensity=e)}_setValueEditEnabled(e,t,n){(this._isActive()||!n)&&(n?(this._myValueRealValue=this._getVariableValue()[e],this._myValueEditIndex=e,t.pp_scaleObject(this._myConfig.myTextHoverScaleMultiplier)):t.pp_setScaleLocal(this._myConfig.myValueTextScale),this._myValueEditEnabled=n)}_setStepEditEnabled(e,t){(this._isActive()||!t)&&(t?e.pp_scaleObject(this._myConfig.myTextHoverScaleMultiplier):e.pp_setScaleLocal(this._myConfig.myStepTextScale),this._myStepEditEnabled=t)}_resetValue(e){this._isActive()&&(this._myTempValue.pp_copy(this._getVariableValue()),this._myTempValue[e]=this._getVariableDefaultValue()[e],this._setVariableValue(this._myTempValue),this._myUI.myValueTextComponents[e].text=this._getVariableValue()[e].toFixed(this._myVariable._myDecimalPlaces))}_resetAllValues(){for(let e=0;e<this._myArraySize;e++)this._resetValue(e)}_resetStep(){this._isActive()&&this._changeStep(this._myVariable._myDefaultStepPerSecond)}_changeStep(e){e=Math.pp_roundDecimal(e,10),this._myVariable._myStepPerSecond=e,this._myUI.myStepTextComponent.text=this._myConfig.myStepStartString.concat(this._myVariable._myStepPerSecond)}_genericTextHover(e){e.pp_scaleObject(this._myConfig.myTextHoverScaleMultiplier)}_genericTextUnHover(e,t){e.pp_setScaleLocal(t)}_getVariableValue(){return this._myNonArray?(this._myTempNonArrayValue[0]=this._myVariable.getValue(),this._myTempNonArrayValue):this._myVariable.getValue()}_getVariableDefaultValue(){return this._myNonArray?(this._myTempNonArrayDefaultValue[0]=this._myVariable.getDefaultValue(),this._myTempNonArrayDefaultValue):this._myVariable.getDefaultValue()}_setVariableValue(e){this._myNonArray?this._myVariable.setValue(e[0]):this._myVariable.setValue(this._myTempValue)}};var qa=class extends Bo{_getEasyTuneArrayWidget(e){return new Qa(this._myParams,e,this._myGamepad,this._myEngine)}};var Xa=class extends Kt{_getBackPanelMinY(){return super._getBackPanelMinY()+this.myPositionPanelPosition[1]+this.myStepPanelPosition[1]}_getBackPanelMaxX(){return this.myDisplayPanelPosition[0]+this.myRotationPanelPosition[0]+this.myIncreaseButtonPosition[0]+this.mySideButtonBackgroundScale[0]+this._mySideButtonDistanceFromBorder}_getBackPanelMinX(){return this.myDisplayPanelPosition[0]+this.myScalePanelPosition[0]+this.myDecreaseButtonPosition[0]-this.mySideButtonBackgroundScale[0]-this._mySideButtonDistanceFromBorder}_getPivotZOffset(){return .00805713}_setupBuildConfigHook(){this.myIncreaseButtonText="+",this.myDecreaseButtonText="-",this.myDecreaseButtonPosition=m(-.13,0,-1e-5),this.myIncreaseButtonPosition=m(-this.myDecreaseButtonPosition[0],0,-1e-5);let e=Math.abs(this.myIncreaseButtonPosition[0])+Math.abs(this.myRightSideButtonPosition[0]),t=.045;this.myPositionPanelPosition=[0,this.myVariableLabelPanelPosition[1]-t,this._myPanelZOffset],this.myRotationPanelPosition=[this.myPositionPanelPosition[0]+e,this.myVariableLabelPanelPosition[1]-t,this._myPanelZOffset],this.myScalePanelPosition=[this.myPositionPanelPosition[0]-e,this.myVariableLabelPanelPosition[1]-t,this._myPanelZOffset],this.myPositionText="Position",this.myRotationText="Rotation",this.myScaleText="Scale",this.myComponentLabelTextScale=this.myLabelTextScale,this.myComponentLabelCursorTargetPosition=m(0,0,0),this.myComponentLabelCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myComponentLabelCollisionExtents=m(.065,.0175,1),this.myComponentLabelCollisionExtents[2]=this.myCursorTargetCollisionThickness,this._myValuePanelDistanceFromVariableLabelPanel=.055,this._myDistanceBetweenValues=this.mySideButtonBackgroundScale[1]*2+.015,this.myValueTextScale=m(.4,.4,.4),this.myValueCursorTargetPosition=m(0,0,0),this.myValueCursorTargetPosition[2]=this._myColliderZOffset-this._myPanelZOffset,this.myValueCollisionExtents=m(.065,.02,1),this.myValueCollisionExtents[2]=this.myCursorTargetCollisionThickness,this.myValuePanelsPositions=[],this.myValuePanelsPositions[0]=m(0,-this._myValuePanelDistanceFromVariableLabelPanel,0);for(let o=1;o<3;o++)this.myValuePanelsPositions[o]=this.myValuePanelsPositions[o-1].pp_clone(),this.myValuePanelsPositions[o][1]-=this._myDistanceBetweenValues;let n=this.myValuePanelsPositions[2][1];this.myStepPanelPosition=[0,n-this._myValuePanelDistanceFromVariableLabelPanel,0],this.myStepTextScale=this.myLabelTextScale,this.myStepStartString="Step: ",this.myStepCursorTargetPosition=m(0,0,0),this.myStepCursorTargetPosition[2]=this._myColliderZOffset-this.myStepPanelPosition[2],this.myStepCollisionExtents=m(.065,.0175,1),this.myStepCollisionExtents[2]=this.myCursorTargetCollisionThickness}_setupRuntimeConfigHook(){this.myTextHoverScaleMultiplier=m(1.1,1.1,1.1),this.myEditThumbstickMinThreshold=.35,this.myStepMultiplierStepPerSecond=2.25,this.myButtonEditDelay=0}};import{CollisionComponent as de,MeshComponent as Je,TextComponent as _e}from"@wonderlandengine/api";import{CursorTarget as ge}from"@wonderlandengine/components";var Ka=class extends Jt{constructor(e){super(e)}setAdditionalButtonsVisible(e){this._myAdditionalButtonsVisible=e;for(let t=0;t<3;t++)this.myPositionIncreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible),this.myPositionDecreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible);this.myPositionStepIncreaseButtonPanel.pp_setActive(this._myAdditionalButtonsVisible),this.myPositionStepDecreaseButtonPanel.pp_setActive(this._myAdditionalButtonsVisible);for(let t=0;t<3;t++)this.myRotationIncreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible),this.myRotationDecreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible);this.myRotationStepIncreaseButtonPanel.pp_setActive(this._myAdditionalButtonsVisible),this.myRotationStepDecreaseButtonPanel.pp_setActive(this._myAdditionalButtonsVisible);for(let t=0;t<3;t++)this.myScaleIncreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible),this.myScaleDecreaseButtonPanels[t].pp_setActive(this._myAdditionalButtonsVisible);this.myScaleStepIncreaseButtonPanel.pp_setActive(this._myAdditionalButtonsVisible),this.myScaleStepDecreaseButtonPanel.pp_setActive(this._myAdditionalButtonsVisible)}_buildHook(){this._myAdditionalButtonsVisible=!0}_createSkeletonHook(){this.myPositionPanel=this.myDisplayPanel.pp_addObject(),this.myPositionLabelText=this.myPositionPanel.pp_addObject(),this.myPositionLabelCursorTarget=this.myPositionPanel.pp_addObject(),this.myPositionPanels=[],this.myPositionTexts=[],this.myPositionCursorTargets=[],this.myPositionIncreaseButtonPanels=[],this.myPositionIncreaseButtonBackgrounds=[],this.myPositionIncreaseButtonTexts=[],this.myPositionIncreaseButtonCursorTargets=[],this.myPositionDecreaseButtonPanels=[],this.myPositionDecreaseButtonBackgrounds=[],this.myPositionDecreaseButtonTexts=[],this.myPositionDecreaseButtonCursorTargets=[];for(let e=0;e<3;e++)this.myPositionPanels[e]=this.myPositionPanel.pp_addObject(),this.myPositionTexts[e]=this.myPositionPanels[e].pp_addObject(),this.myPositionCursorTargets[e]=this.myPositionPanels[e].pp_addObject(),this.myPositionIncreaseButtonPanels[e]=this.myPositionPanels[e].pp_addObject(),this.myPositionIncreaseButtonBackgrounds[e]=this.myPositionIncreaseButtonPanels[e].pp_addObject(),this.myPositionIncreaseButtonTexts[e]=this.myPositionIncreaseButtonPanels[e].pp_addObject(),this.myPositionIncreaseButtonCursorTargets[e]=this.myPositionIncreaseButtonPanels[e].pp_addObject(),this.myPositionDecreaseButtonPanels[e]=this.myPositionPanels[e].pp_addObject(),this.myPositionDecreaseButtonBackgrounds[e]=this.myPositionDecreaseButtonPanels[e].pp_addObject(),this.myPositionDecreaseButtonTexts[e]=this.myPositionDecreaseButtonPanels[e].pp_addObject(),this.myPositionDecreaseButtonCursorTargets[e]=this.myPositionDecreaseButtonPanels[e].pp_addObject();this.myRotationPanel=this.myDisplayPanel.pp_addObject(),this.myRotationLabelText=this.myRotationPanel.pp_addObject(),this.myRotationLabelCursorTarget=this.myRotationPanel.pp_addObject(),this.myRotationPanels=[],this.myRotationTexts=[],this.myRotationCursorTargets=[],this.myRotationIncreaseButtonPanels=[],this.myRotationIncreaseButtonBackgrounds=[],this.myRotationIncreaseButtonTexts=[],this.myRotationIncreaseButtonCursorTargets=[],this.myRotationDecreaseButtonPanels=[],this.myRotationDecreaseButtonBackgrounds=[],this.myRotationDecreaseButtonTexts=[],this.myRotationDecreaseButtonCursorTargets=[];for(let e=0;e<3;e++)this.myRotationPanels[e]=this.myRotationPanel.pp_addObject(),this.myRotationTexts[e]=this.myRotationPanels[e].pp_addObject(),this.myRotationCursorTargets[e]=this.myRotationPanels[e].pp_addObject(),this.myRotationIncreaseButtonPanels[e]=this.myRotationPanels[e].pp_addObject(),this.myRotationIncreaseButtonBackgrounds[e]=this.myRotationIncreaseButtonPanels[e].pp_addObject(),this.myRotationIncreaseButtonTexts[e]=this.myRotationIncreaseButtonPanels[e].pp_addObject(),this.myRotationIncreaseButtonCursorTargets[e]=this.myRotationIncreaseButtonPanels[e].pp_addObject(),this.myRotationDecreaseButtonPanels[e]=this.myRotationPanels[e].pp_addObject(),this.myRotationDecreaseButtonBackgrounds[e]=this.myRotationDecreaseButtonPanels[e].pp_addObject(),this.myRotationDecreaseButtonTexts[e]=this.myRotationDecreaseButtonPanels[e].pp_addObject(),this.myRotationDecreaseButtonCursorTargets[e]=this.myRotationDecreaseButtonPanels[e].pp_addObject();this.myScalePanel=this.myDisplayPanel.pp_addObject(),this.myScaleLabelText=this.myScalePanel.pp_addObject(),this.myScaleLabelCursorTarget=this.myScalePanel.pp_addObject(),this.myScalePanels=[],this.myScaleTexts=[],this.myScaleCursorTargets=[],this.myScaleIncreaseButtonPanels=[],this.myScaleIncreaseButtonBackgrounds=[],this.myScaleIncreaseButtonTexts=[],this.myScaleIncreaseButtonCursorTargets=[],this.myScaleDecreaseButtonPanels=[],this.myScaleDecreaseButtonBackgrounds=[],this.myScaleDecreaseButtonTexts=[],this.myScaleDecreaseButtonCursorTargets=[];for(let e=0;e<3;e++)this.myScalePanels[e]=this.myScalePanel.pp_addObject(),this.myScaleTexts[e]=this.myScalePanels[e].pp_addObject(),this.myScaleCursorTargets[e]=this.myScalePanels[e].pp_addObject(),this.myScaleIncreaseButtonPanels[e]=this.myScalePanels[e].pp_addObject(),this.myScaleIncreaseButtonBackgrounds[e]=this.myScaleIncreaseButtonPanels[e].pp_addObject(),this.myScaleIncreaseButtonTexts[e]=this.myScaleIncreaseButtonPanels[e].pp_addObject(),this.myScaleIncreaseButtonCursorTargets[e]=this.myScaleIncreaseButtonPanels[e].pp_addObject(),this.myScaleDecreaseButtonPanels[e]=this.myScalePanels[e].pp_addObject(),this.myScaleDecreaseButtonBackgrounds[e]=this.myScaleDecreaseButtonPanels[e].pp_addObject(),this.myScaleDecreaseButtonTexts[e]=this.myScaleDecreaseButtonPanels[e].pp_addObject(),this.myScaleDecreaseButtonCursorTargets[e]=this.myScaleDecreaseButtonPanels[e].pp_addObject();this.myPositionStepPanel=this.myPositionPanel.pp_addObject(),this.myPositionStepText=this.myPositionStepPanel.pp_addObject(),this.myPositionStepCursorTarget=this.myPositionStepPanel.pp_addObject(),this.myPositionStepIncreaseButtonPanel=this.myPositionStepPanel.pp_addObject(),this.myPositionStepIncreaseButtonBackground=this.myPositionStepIncreaseButtonPanel.pp_addObject(),this.myPositionStepIncreaseButtonText=this.myPositionStepIncreaseButtonPanel.pp_addObject(),this.myPositionStepIncreaseButtonCursorTarget=this.myPositionStepIncreaseButtonPanel.pp_addObject(),this.myPositionStepDecreaseButtonPanel=this.myPositionStepPanel.pp_addObject(),this.myPositionStepDecreaseButtonBackground=this.myPositionStepDecreaseButtonPanel.pp_addObject(),this.myPositionStepDecreaseButtonText=this.myPositionStepDecreaseButtonPanel.pp_addObject(),this.myPositionStepDecreaseButtonCursorTarget=this.myPositionStepDecreaseButtonPanel.pp_addObject(),this.myRotationStepPanel=this.myRotationPanel.pp_addObject(),this.myRotationStepText=this.myRotationStepPanel.pp_addObject(),this.myRotationStepCursorTarget=this.myRotationStepPanel.pp_addObject(),this.myRotationStepIncreaseButtonPanel=this.myRotationStepPanel.pp_addObject(),this.myRotationStepIncreaseButtonBackground=this.myRotationStepIncreaseButtonPanel.pp_addObject(),this.myRotationStepIncreaseButtonText=this.myRotationStepIncreaseButtonPanel.pp_addObject(),this.myRotationStepIncreaseButtonCursorTarget=this.myRotationStepIncreaseButtonPanel.pp_addObject(),this.myRotationStepDecreaseButtonPanel=this.myRotationStepPanel.pp_addObject(),this.myRotationStepDecreaseButtonBackground=this.myRotationStepDecreaseButtonPanel.pp_addObject(),this.myRotationStepDecreaseButtonText=this.myRotationStepDecreaseButtonPanel.pp_addObject(),this.myRotationStepDecreaseButtonCursorTarget=this.myRotationStepDecreaseButtonPanel.pp_addObject(),this.myScaleStepPanel=this.myScalePanel.pp_addObject(),this.myScaleStepText=this.myScaleStepPanel.pp_addObject(),this.myScaleStepCursorTarget=this.myScaleStepPanel.pp_addObject(),this.myScaleStepIncreaseButtonPanel=this.myScaleStepPanel.pp_addObject(),this.myScaleStepIncreaseButtonBackground=this.myScaleStepIncreaseButtonPanel.pp_addObject(),this.myScaleStepIncreaseButtonText=this.myScaleStepIncreaseButtonPanel.pp_addObject(),this.myScaleStepIncreaseButtonCursorTarget=this.myScaleStepIncreaseButtonPanel.pp_addObject(),this.myScaleStepDecreaseButtonPanel=this.myScaleStepPanel.pp_addObject(),this.myScaleStepDecreaseButtonBackground=this.myScaleStepDecreaseButtonPanel.pp_addObject(),this.myScaleStepDecreaseButtonText=this.myScaleStepDecreaseButtonPanel.pp_addObject(),this.myScaleStepDecreaseButtonCursorTarget=this.myScaleStepDecreaseButtonPanel.pp_addObject()}_setTransformHook(){this.myPositionPanel.pp_setPositionLocal(this._myConfig.myPositionPanelPosition),this.myPositionLabelText.pp_scaleObject(this._myConfig.myComponentLabelTextScale),this.myPositionLabelCursorTarget.pp_setPositionLocal(this._myConfig.myComponentLabelCursorTargetPosition);for(let e=0;e<3;e++)this.myPositionPanels[e].pp_setPositionLocal(this._myConfig.myValuePanelsPositions[e]),this.myPositionTexts[e].pp_scaleObject(this._myConfig.myValueTextScale),this.myPositionCursorTargets[e].pp_setPositionLocal(this._myConfig.myValueCursorTargetPosition),this.myPositionIncreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myIncreaseButtonPosition),this.myPositionIncreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myPositionIncreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myPositionIncreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myPositionIncreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myPositionDecreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myDecreaseButtonPosition),this.myPositionDecreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myPositionDecreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myPositionDecreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myPositionDecreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition);this.myRotationPanel.pp_setPositionLocal(this._myConfig.myRotationPanelPosition),this.myRotationLabelText.pp_scaleObject(this._myConfig.myComponentLabelTextScale),this.myRotationLabelCursorTarget.pp_setPositionLocal(this._myConfig.myComponentLabelCursorTargetPosition);for(let e=0;e<3;e++)this.myRotationPanels[e].pp_setPositionLocal(this._myConfig.myValuePanelsPositions[e]),this.myRotationTexts[e].pp_scaleObject(this._myConfig.myValueTextScale),this.myRotationCursorTargets[e].pp_setPositionLocal(this._myConfig.myValueCursorTargetPosition),this.myRotationIncreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myIncreaseButtonPosition),this.myRotationIncreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myRotationIncreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myRotationIncreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myRotationIncreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myRotationDecreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myDecreaseButtonPosition),this.myRotationDecreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myRotationDecreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myRotationDecreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myRotationDecreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition);this.myScalePanel.pp_setPositionLocal(this._myConfig.myScalePanelPosition),this.myScaleLabelText.pp_scaleObject(this._myConfig.myComponentLabelTextScale),this.myScaleLabelCursorTarget.pp_setPositionLocal(this._myConfig.myComponentLabelCursorTargetPosition);for(let e=0;e<3;e++)this.myScalePanels[e].pp_setPositionLocal(this._myConfig.myValuePanelsPositions[e]),this.myScaleTexts[e].pp_scaleObject(this._myConfig.myValueTextScale),this.myScaleCursorTargets[e].pp_setPositionLocal(this._myConfig.myValueCursorTargetPosition),this.myScaleIncreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myIncreaseButtonPosition),this.myScaleIncreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myScaleIncreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myScaleIncreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myScaleIncreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myScaleDecreaseButtonPanels[e].pp_setPositionLocal(this._myConfig.myDecreaseButtonPosition),this.myScaleDecreaseButtonBackgrounds[e].pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myScaleDecreaseButtonTexts[e].pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myScaleDecreaseButtonTexts[e].pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myScaleDecreaseButtonCursorTargets[e].pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition);this.myPositionStepPanel.pp_setPositionLocal(this._myConfig.myStepPanelPosition),this.myPositionStepText.pp_scaleObject(this._myConfig.myStepTextScale),this.myPositionStepCursorTarget.pp_setPositionLocal(this._myConfig.myStepCursorTargetPosition),this.myPositionStepIncreaseButtonPanel.pp_setPositionLocal(this._myConfig.myIncreaseButtonPosition),this.myPositionStepIncreaseButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myPositionStepIncreaseButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myPositionStepIncreaseButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myPositionStepIncreaseButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myPositionStepDecreaseButtonPanel.pp_setPositionLocal(this._myConfig.myDecreaseButtonPosition),this.myPositionStepDecreaseButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myPositionStepDecreaseButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myPositionStepDecreaseButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myPositionStepDecreaseButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myRotationStepPanel.pp_setPositionLocal(this._myConfig.myStepPanelPosition),this.myRotationStepText.pp_scaleObject(this._myConfig.myStepTextScale),this.myRotationStepCursorTarget.pp_setPositionLocal(this._myConfig.myStepCursorTargetPosition),this.myRotationStepIncreaseButtonPanel.pp_setPositionLocal(this._myConfig.myIncreaseButtonPosition),this.myRotationStepIncreaseButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myRotationStepIncreaseButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myRotationStepIncreaseButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myRotationStepIncreaseButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myRotationStepDecreaseButtonPanel.pp_setPositionLocal(this._myConfig.myDecreaseButtonPosition),this.myRotationStepDecreaseButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myRotationStepDecreaseButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myRotationStepDecreaseButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myRotationStepDecreaseButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myScaleStepPanel.pp_setPositionLocal(this._myConfig.myStepPanelPosition),this.myScaleStepText.pp_scaleObject(this._myConfig.myStepTextScale),this.myScaleStepCursorTarget.pp_setPositionLocal(this._myConfig.myStepCursorTargetPosition),this.myScaleStepIncreaseButtonPanel.pp_setPositionLocal(this._myConfig.myIncreaseButtonPosition),this.myScaleStepIncreaseButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myScaleStepIncreaseButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myScaleStepIncreaseButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myScaleStepIncreaseButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition),this.myScaleStepDecreaseButtonPanel.pp_setPositionLocal(this._myConfig.myDecreaseButtonPosition),this.myScaleStepDecreaseButtonBackground.pp_scaleObject(this._myConfig.mySideButtonBackgroundScale),this.myScaleStepDecreaseButtonText.pp_setPositionLocal(this._myConfig.mySideButtonTextPosition),this.myScaleStepDecreaseButtonText.pp_scaleObject(this._myConfig.mySideButtonTextScale),this.myScaleStepDecreaseButtonCursorTarget.pp_setPositionLocal(this._myConfig.mySideButtonCursorTargetPosition)}_addComponentsHook(){this.myPositionLabelTextComponent=this.myPositionLabelText.pp_addComponent(_e),this._setupTextComponent(this.myPositionLabelTextComponent),this.myPositionLabelTextComponent.text=this._myConfig.myPositionText,this.myPositionLabelCursorTargetComponent=this.myPositionLabelCursorTarget.pp_addComponent(ge),this.myPositionLabelCollisionComponent=this.myPositionLabelCursorTarget.pp_addComponent(de),this.myPositionLabelCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionLabelCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionLabelCollisionComponent.extents=this._myConfig.myComponentLabelCollisionExtents,this.myPositionTextComponents=[],this.myPositionCursorTargetComponents=[],this.myPositionCollisionComponents=[],this.myPositionIncreaseButtonBackgroundComponents=[],this.myPositionIncreaseButtonTextComponents=[],this.myPositionIncreaseButtonCursorTargetComponents=[],this.myPositionIncreaseButtonCollisionComponents=[],this.myPositionDecreaseButtonBackgroundComponents=[],this.myPositionDecreaseButtonTextComponents=[],this.myPositionDecreaseButtonCursorTargetComponents=[],this.myPositionDecreaseButtonCollisionComponents=[];for(let e=0;e<3;e++)this.myPositionTextComponents[e]=this.myPositionTexts[e].pp_addComponent(_e),this._setupTextComponent(this.myPositionTextComponents[e]),this.myPositionTextComponents[e].text=" ",this.myPositionCursorTargetComponents[e]=this.myPositionCursorTargets[e].pp_addComponent(ge),this.myPositionCollisionComponents[e]=this.myPositionCursorTargets[e].pp_addComponent(de),this.myPositionCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionCollisionComponents[e].extents=this._myConfig.myValueCollisionExtents,this.myPositionIncreaseButtonBackgroundComponents[e]=this.myPositionIncreaseButtonBackgrounds[e].pp_addComponent(Je),this.myPositionIncreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myPositionIncreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myPositionIncreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myPositionIncreaseButtonTextComponents[e]=this.myPositionIncreaseButtonTexts[e].pp_addComponent(_e),this._setupTextComponent(this.myPositionIncreaseButtonTextComponents[e]),this.myPositionIncreaseButtonTextComponents[e].text=this._myConfig.myIncreaseButtonText,this.myPositionIncreaseButtonCursorTargetComponents[e]=this.myPositionIncreaseButtonCursorTargets[e].pp_addComponent(ge),this.myPositionIncreaseButtonCollisionComponents[e]=this.myPositionIncreaseButtonCursorTargets[e].pp_addComponent(de),this.myPositionIncreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionIncreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionIncreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents,this.myPositionDecreaseButtonBackgroundComponents[e]=this.myPositionDecreaseButtonBackgrounds[e].pp_addComponent(Je),this.myPositionDecreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myPositionDecreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myPositionDecreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myPositionDecreaseButtonTextComponents[e]=this.myPositionDecreaseButtonTexts[e].pp_addComponent(_e),this._setupTextComponent(this.myPositionDecreaseButtonTextComponents[e]),this.myPositionDecreaseButtonTextComponents[e].text=this._myConfig.myDecreaseButtonText,this.myPositionDecreaseButtonCursorTargetComponents[e]=this.myPositionDecreaseButtonCursorTargets[e].pp_addComponent(ge),this.myPositionDecreaseButtonCollisionComponents[e]=this.myPositionDecreaseButtonCursorTargets[e].pp_addComponent(de),this.myPositionDecreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionDecreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionDecreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents;this.myRotationLabelTextComponent=this.myRotationLabelText.pp_addComponent(_e),this._setupTextComponent(this.myRotationLabelTextComponent),this.myRotationLabelTextComponent.text=this._myConfig.myRotationText,this.myRotationLabelCursorTargetComponent=this.myRotationLabelCursorTarget.pp_addComponent(ge),this.myRotationLabelCollisionComponent=this.myRotationLabelCursorTarget.pp_addComponent(de),this.myRotationLabelCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationLabelCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationLabelCollisionComponent.extents=this._myConfig.myComponentLabelCollisionExtents,this.myRotationTextComponents=[],this.myRotationCursorTargetComponents=[],this.myRotationCollisionComponents=[],this.myRotationIncreaseButtonBackgroundComponents=[],this.myRotationIncreaseButtonTextComponents=[],this.myRotationIncreaseButtonCursorTargetComponents=[],this.myRotationIncreaseButtonCollisionComponents=[],this.myRotationDecreaseButtonBackgroundComponents=[],this.myRotationDecreaseButtonTextComponents=[],this.myRotationDecreaseButtonCursorTargetComponents=[],this.myRotationDecreaseButtonCollisionComponents=[];for(let e=0;e<3;e++)this.myRotationTextComponents[e]=this.myRotationTexts[e].pp_addComponent(_e),this._setupTextComponent(this.myRotationTextComponents[e]),this.myRotationTextComponents[e].text=" ",this.myRotationCursorTargetComponents[e]=this.myRotationCursorTargets[e].pp_addComponent(ge),this.myRotationCollisionComponents[e]=this.myRotationCursorTargets[e].pp_addComponent(de),this.myRotationCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationCollisionComponents[e].extents=this._myConfig.myValueCollisionExtents,this.myRotationIncreaseButtonBackgroundComponents[e]=this.myRotationIncreaseButtonBackgrounds[e].pp_addComponent(Je),this.myRotationIncreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myRotationIncreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myRotationIncreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myRotationIncreaseButtonTextComponents[e]=this.myRotationIncreaseButtonTexts[e].pp_addComponent(_e),this._setupTextComponent(this.myRotationIncreaseButtonTextComponents[e]),this.myRotationIncreaseButtonTextComponents[e].text=this._myConfig.myIncreaseButtonText,this.myRotationIncreaseButtonCursorTargetComponents[e]=this.myRotationIncreaseButtonCursorTargets[e].pp_addComponent(ge),this.myRotationIncreaseButtonCollisionComponents[e]=this.myRotationIncreaseButtonCursorTargets[e].pp_addComponent(de),this.myRotationIncreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationIncreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationIncreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents,this.myRotationDecreaseButtonBackgroundComponents[e]=this.myRotationDecreaseButtonBackgrounds[e].pp_addComponent(Je),this.myRotationDecreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myRotationDecreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myRotationDecreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myRotationDecreaseButtonTextComponents[e]=this.myRotationDecreaseButtonTexts[e].pp_addComponent(_e),this._setupTextComponent(this.myRotationDecreaseButtonTextComponents[e]),this.myRotationDecreaseButtonTextComponents[e].text=this._myConfig.myDecreaseButtonText,this.myRotationDecreaseButtonCursorTargetComponents[e]=this.myRotationDecreaseButtonCursorTargets[e].pp_addComponent(ge),this.myRotationDecreaseButtonCollisionComponents[e]=this.myRotationDecreaseButtonCursorTargets[e].pp_addComponent(de),this.myRotationDecreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationDecreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationDecreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents;this.myScaleLabelTextComponent=this.myScaleLabelText.pp_addComponent(_e),this._setupTextComponent(this.myScaleLabelTextComponent),this.myScaleLabelTextComponent.text=this._myConfig.myScaleText,this.myScaleLabelCursorTargetComponent=this.myScaleLabelCursorTarget.pp_addComponent(ge),this.myScaleLabelCollisionComponent=this.myScaleLabelCursorTarget.pp_addComponent(de),this.myScaleLabelCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleLabelCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleLabelCollisionComponent.extents=this._myConfig.myComponentLabelCollisionExtents,this.myScaleTextComponents=[],this.myScaleCursorTargetComponents=[],this.myScaleCollisionComponents=[],this.myScaleIncreaseButtonBackgroundComponents=[],this.myScaleIncreaseButtonTextComponents=[],this.myScaleIncreaseButtonCursorTargetComponents=[],this.myScaleIncreaseButtonCollisionComponents=[],this.myScaleDecreaseButtonBackgroundComponents=[],this.myScaleDecreaseButtonTextComponents=[],this.myScaleDecreaseButtonCursorTargetComponents=[],this.myScaleDecreaseButtonCollisionComponents=[];for(let e=0;e<3;e++)this.myScaleTextComponents[e]=this.myScaleTexts[e].pp_addComponent(_e),this._setupTextComponent(this.myScaleTextComponents[e]),this.myScaleTextComponents[e].text=" ",this.myScaleCursorTargetComponents[e]=this.myScaleCursorTargets[e].pp_addComponent(ge),this.myScaleCollisionComponents[e]=this.myScaleCursorTargets[e].pp_addComponent(de),this.myScaleCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleCollisionComponents[e].extents=this._myConfig.myValueCollisionExtents,this.myScaleIncreaseButtonBackgroundComponents[e]=this.myScaleIncreaseButtonBackgrounds[e].pp_addComponent(Je),this.myScaleIncreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myScaleIncreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myScaleIncreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myScaleIncreaseButtonTextComponents[e]=this.myScaleIncreaseButtonTexts[e].pp_addComponent(_e),this._setupTextComponent(this.myScaleIncreaseButtonTextComponents[e]),this.myScaleIncreaseButtonTextComponents[e].text=this._myConfig.myIncreaseButtonText,this.myScaleIncreaseButtonCursorTargetComponents[e]=this.myScaleIncreaseButtonCursorTargets[e].pp_addComponent(ge),this.myScaleIncreaseButtonCollisionComponents[e]=this.myScaleIncreaseButtonCursorTargets[e].pp_addComponent(de),this.myScaleIncreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleIncreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleIncreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents,this.myScaleDecreaseButtonBackgroundComponents[e]=this.myScaleDecreaseButtonBackgrounds[e].pp_addComponent(Je),this.myScaleDecreaseButtonBackgroundComponents[e].mesh=this._myPlaneMesh,this.myScaleDecreaseButtonBackgroundComponents[e].material=this._myParams.myPlaneMaterial.clone(),this.myScaleDecreaseButtonBackgroundComponents[e].material.color=this._myConfig.myBackgroundColor,this.myScaleDecreaseButtonTextComponents[e]=this.myScaleDecreaseButtonTexts[e].pp_addComponent(_e),this._setupTextComponent(this.myScaleDecreaseButtonTextComponents[e]),this.myScaleDecreaseButtonTextComponents[e].text=this._myConfig.myDecreaseButtonText,this.myScaleDecreaseButtonCursorTargetComponents[e]=this.myScaleDecreaseButtonCursorTargets[e].pp_addComponent(ge),this.myScaleDecreaseButtonCollisionComponents[e]=this.myScaleDecreaseButtonCursorTargets[e].pp_addComponent(de),this.myScaleDecreaseButtonCollisionComponents[e].collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleDecreaseButtonCollisionComponents[e].group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleDecreaseButtonCollisionComponents[e].extents=this._myConfig.mySideButtonCollisionExtents;this.myPositionStepTextComponent=this.myPositionStepText.pp_addComponent(_e),this._setupTextComponent(this.myPositionStepTextComponent),this.myPositionStepTextComponent.text=" ",this.myPositionStepCursorTargetComponent=this.myPositionStepCursorTarget.pp_addComponent(ge),this.myPositionStepCollisionComponent=this.myPositionStepCursorTarget.pp_addComponent(de),this.myPositionStepCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionStepCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionStepCollisionComponent.extents=this._myConfig.myStepCollisionExtents,this.myPositionStepIncreaseButtonBackgroundComponent=this.myPositionStepIncreaseButtonBackground.pp_addComponent(Je),this.myPositionStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPositionStepIncreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myPositionStepIncreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myPositionStepIncreaseButtonTextComponent=this.myPositionStepIncreaseButtonText.pp_addComponent(_e),this._setupTextComponent(this.myPositionStepIncreaseButtonTextComponent),this.myPositionStepIncreaseButtonTextComponent.text=this._myConfig.myIncreaseButtonText,this.myPositionStepIncreaseButtonCursorTargetComponent=this.myPositionStepIncreaseButtonCursorTarget.pp_addComponent(ge),this.myPositionStepIncreaseButtonCollisionComponent=this.myPositionStepIncreaseButtonCursorTarget.pp_addComponent(de),this.myPositionStepIncreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionStepIncreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionStepIncreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myPositionStepDecreaseButtonBackgroundComponent=this.myPositionStepDecreaseButtonBackground.pp_addComponent(Je),this.myPositionStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPositionStepDecreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myPositionStepDecreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myPositionStepDecreaseButtonTextComponent=this.myPositionStepDecreaseButtonText.pp_addComponent(_e),this._setupTextComponent(this.myPositionStepDecreaseButtonTextComponent),this.myPositionStepDecreaseButtonTextComponent.text=this._myConfig.myDecreaseButtonText,this.myPositionStepDecreaseButtonCursorTargetComponent=this.myPositionStepDecreaseButtonCursorTarget.pp_addComponent(ge),this.myPositionStepDecreaseButtonCollisionComponent=this.myPositionStepDecreaseButtonCursorTarget.pp_addComponent(de),this.myPositionStepDecreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionStepDecreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionStepDecreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myRotationStepTextComponent=this.myRotationStepText.pp_addComponent(_e),this._setupTextComponent(this.myRotationStepTextComponent),this.myRotationStepTextComponent.text=" ",this.myRotationStepCursorTargetComponent=this.myRotationStepCursorTarget.pp_addComponent(ge),this.myRotationStepCollisionComponent=this.myRotationStepCursorTarget.pp_addComponent(de),this.myRotationStepCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationStepCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationStepCollisionComponent.extents=this._myConfig.myStepCollisionExtents,this.myRotationStepIncreaseButtonBackgroundComponent=this.myRotationStepIncreaseButtonBackground.pp_addComponent(Je),this.myRotationStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myRotationStepIncreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myRotationStepIncreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myRotationStepIncreaseButtonTextComponent=this.myRotationStepIncreaseButtonText.pp_addComponent(_e),this._setupTextComponent(this.myRotationStepIncreaseButtonTextComponent),this.myRotationStepIncreaseButtonTextComponent.text=this._myConfig.myIncreaseButtonText,this.myRotationStepIncreaseButtonCursorTargetComponent=this.myRotationStepIncreaseButtonCursorTarget.pp_addComponent(ge),this.myRotationStepIncreaseButtonCollisionComponent=this.myRotationStepIncreaseButtonCursorTarget.pp_addComponent(de),this.myRotationStepIncreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationStepIncreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationStepIncreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myRotationStepDecreaseButtonBackgroundComponent=this.myRotationStepDecreaseButtonBackground.pp_addComponent(Je),this.myRotationStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myRotationStepDecreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myRotationStepDecreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myRotationStepDecreaseButtonTextComponent=this.myRotationStepDecreaseButtonText.pp_addComponent(_e),this._setupTextComponent(this.myRotationStepDecreaseButtonTextComponent),this.myRotationStepDecreaseButtonTextComponent.text=this._myConfig.myDecreaseButtonText,this.myRotationStepDecreaseButtonCursorTargetComponent=this.myRotationStepDecreaseButtonCursorTarget.pp_addComponent(ge),this.myRotationStepDecreaseButtonCollisionComponent=this.myRotationStepDecreaseButtonCursorTarget.pp_addComponent(de),this.myRotationStepDecreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationStepDecreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationStepDecreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myScaleStepTextComponent=this.myScaleStepText.pp_addComponent(_e),this._setupTextComponent(this.myScaleStepTextComponent),this.myScaleStepTextComponent.text=" ",this.myScaleStepCursorTargetComponent=this.myScaleStepCursorTarget.pp_addComponent(ge),this.myScaleStepCollisionComponent=this.myScaleStepCursorTarget.pp_addComponent(de),this.myScaleStepCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleStepCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleStepCollisionComponent.extents=this._myConfig.myStepCollisionExtents,this.myScaleStepIncreaseButtonBackgroundComponent=this.myScaleStepIncreaseButtonBackground.pp_addComponent(Je),this.myScaleStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myScaleStepIncreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myScaleStepIncreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myScaleStepIncreaseButtonTextComponent=this.myScaleStepIncreaseButtonText.pp_addComponent(_e),this._setupTextComponent(this.myScaleStepIncreaseButtonTextComponent),this.myScaleStepIncreaseButtonTextComponent.text=this._myConfig.myIncreaseButtonText,this.myScaleStepIncreaseButtonCursorTargetComponent=this.myScaleStepIncreaseButtonCursorTarget.pp_addComponent(ge),this.myScaleStepIncreaseButtonCollisionComponent=this.myScaleStepIncreaseButtonCursorTarget.pp_addComponent(de),this.myScaleStepIncreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleStepIncreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleStepIncreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myScaleStepDecreaseButtonBackgroundComponent=this.myScaleStepDecreaseButtonBackground.pp_addComponent(Je),this.myScaleStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myScaleStepDecreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myScaleStepDecreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myScaleStepDecreaseButtonTextComponent=this.myScaleStepDecreaseButtonText.pp_addComponent(_e),this._setupTextComponent(this.myScaleStepDecreaseButtonTextComponent),this.myScaleStepDecreaseButtonTextComponent.text=this._myConfig.myDecreaseButtonText,this.myScaleStepDecreaseButtonCursorTargetComponent=this.myScaleStepDecreaseButtonCursorTarget.pp_addComponent(ge),this.myScaleStepDecreaseButtonCollisionComponent=this.myScaleStepDecreaseButtonCursorTarget.pp_addComponent(de),this.myScaleStepDecreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleStepDecreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleStepDecreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents}_addStepComponents(){this.myPositionStepTextComponent=this.myPositionStepText.pp_addComponent(_e),this._setupTextComponent(this.myPositionStepTextComponent),this.myPositionStepTextComponent.text=" ",this.myPositionStepCursorTargetComponent=this.myPositionStepCursorTarget.pp_addComponent(ge),this.myPositionStepCollisionComponent=this.myPositionStepCursorTarget.pp_addComponent(de),this.myPositionStepCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionStepCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionStepCollisionComponent.extents=this._myConfig.myStepCollisionExtents,this.myPositionStepIncreaseButtonBackgroundComponent=this.myPositionStepIncreaseButtonBackground.pp_addComponent(Je),this.myPositionStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPositionStepIncreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myPositionStepIncreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myPositionStepIncreaseButtonTextComponent=this.myPositionStepIncreaseButtonText.pp_addComponent(_e),this._setupTextComponent(this.myPositionStepIncreaseButtonTextComponent),this.myPositionStepIncreaseButtonTextComponent.text=this._myConfig.myIncreaseButtonText,this.myPositionStepIncreaseButtonCursorTargetComponent=this.myPositionStepIncreaseButtonCursorTarget.pp_addComponent(ge),this.myPositionStepIncreaseButtonCollisionComponent=this.myPositionStepIncreaseButtonCursorTarget.pp_addComponent(de),this.myPositionStepIncreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionStepIncreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionStepIncreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myPositionStepDecreaseButtonBackgroundComponent=this.myPositionStepDecreaseButtonBackground.pp_addComponent(Je),this.myPositionStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myPositionStepDecreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myPositionStepDecreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myPositionStepDecreaseButtonTextComponent=this.myPositionStepDecreaseButtonText.pp_addComponent(_e),this._setupTextComponent(this.myPositionStepDecreaseButtonTextComponent),this.myPositionStepDecreaseButtonTextComponent.text=this._myConfig.myDecreaseButtonText,this.myPositionStepDecreaseButtonCursorTargetComponent=this.myPositionStepDecreaseButtonCursorTarget.pp_addComponent(ge),this.myPositionStepDecreaseButtonCollisionComponent=this.myPositionStepDecreaseButtonCursorTarget.pp_addComponent(de),this.myPositionStepDecreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myPositionStepDecreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myPositionStepDecreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myRotationStepTextComponent=this.myRotationStepText.pp_addComponent(_e),this._setupTextComponent(this.myRotationStepTextComponent),this.myRotationStepTextComponent.text=" ",this.myRotationStepCursorTargetComponent=this.myRotationStepCursorTarget.pp_addComponent(ge),this.myRotationStepCollisionComponent=this.myRotationStepCursorTarget.pp_addComponent(de),this.myRotationStepCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationStepCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationStepCollisionComponent.extents=this._myConfig.myStepCollisionExtents,this.myRotationStepIncreaseButtonBackgroundComponent=this.myRotationStepIncreaseButtonBackground.pp_addComponent(Je),this.myRotationStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myRotationStepIncreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myRotationStepIncreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myRotationStepIncreaseButtonTextComponent=this.myRotationStepIncreaseButtonText.pp_addComponent(_e),this._setupTextComponent(this.myRotationStepIncreaseButtonTextComponent),this.myRotationStepIncreaseButtonTextComponent.text=this._myConfig.myIncreaseButtonText,this.myRotationStepIncreaseButtonCursorTargetComponent=this.myRotationStepIncreaseButtonCursorTarget.pp_addComponent(ge),this.myRotationStepIncreaseButtonCollisionComponent=this.myRotationStepIncreaseButtonCursorTarget.pp_addComponent(de),this.myRotationStepIncreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationStepIncreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationStepIncreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myRotationStepDecreaseButtonBackgroundComponent=this.myRotationStepDecreaseButtonBackground.pp_addComponent(Je),this.myRotationStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myRotationStepDecreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myRotationStepDecreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myRotationStepDecreaseButtonTextComponent=this.myRotationStepDecreaseButtonText.pp_addComponent(_e),this._setupTextComponent(this.myRotationStepDecreaseButtonTextComponent),this.myRotationStepDecreaseButtonTextComponent.text=this._myConfig.myDecreaseButtonText,this.myRotationStepDecreaseButtonCursorTargetComponent=this.myRotationStepDecreaseButtonCursorTarget.pp_addComponent(ge),this.myRotationStepDecreaseButtonCollisionComponent=this.myRotationStepDecreaseButtonCursorTarget.pp_addComponent(de),this.myRotationStepDecreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myRotationStepDecreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myRotationStepDecreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myScaleStepTextComponent=this.myScaleStepText.pp_addComponent(_e),this._setupTextComponent(this.myScaleStepTextComponent),this.myScaleStepTextComponent.text=" ",this.myScaleStepCursorTargetComponent=this.myScaleStepCursorTarget.pp_addComponent(ge),this.myScaleStepCollisionComponent=this.myScaleStepCursorTarget.pp_addComponent(de),this.myScaleStepCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleStepCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleStepCollisionComponent.extents=this._myConfig.myStepCollisionExtents,this.myScaleStepIncreaseButtonBackgroundComponent=this.myScaleStepIncreaseButtonBackground.pp_addComponent(Je),this.myScaleStepIncreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myScaleStepIncreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myScaleStepIncreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myScaleStepIncreaseButtonTextComponent=this.myScaleStepIncreaseButtonText.pp_addComponent(_e),this._setupTextComponent(this.myScaleStepIncreaseButtonTextComponent),this.myScaleStepIncreaseButtonTextComponent.text=this._myConfig.myIncreaseButtonText,this.myScaleStepIncreaseButtonCursorTargetComponent=this.myScaleStepIncreaseButtonCursorTarget.pp_addComponent(ge),this.myScaleStepIncreaseButtonCollisionComponent=this.myScaleStepIncreaseButtonCursorTarget.pp_addComponent(de),this.myScaleStepIncreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleStepIncreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleStepIncreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents,this.myScaleStepDecreaseButtonBackgroundComponent=this.myScaleStepDecreaseButtonBackground.pp_addComponent(Je),this.myScaleStepDecreaseButtonBackgroundComponent.mesh=this._myPlaneMesh,this.myScaleStepDecreaseButtonBackgroundComponent.material=this._myParams.myPlaneMaterial.clone(),this.myScaleStepDecreaseButtonBackgroundComponent.material.color=this._myConfig.myBackgroundColor,this.myScaleStepDecreaseButtonTextComponent=this.myScaleStepDecreaseButtonText.pp_addComponent(_e),this._setupTextComponent(this.myScaleStepDecreaseButtonTextComponent),this.myScaleStepDecreaseButtonTextComponent.text=this._myConfig.myDecreaseButtonText,this.myScaleStepDecreaseButtonCursorTargetComponent=this.myScaleStepDecreaseButtonCursorTarget.pp_addComponent(ge),this.myScaleStepDecreaseButtonCollisionComponent=this.myScaleStepDecreaseButtonCursorTarget.pp_addComponent(de),this.myScaleStepDecreaseButtonCollisionComponent.collider=this._myConfig.myCursorTargetCollisionCollider,this.myScaleStepDecreaseButtonCollisionComponent.group=1<<this._myConfig.myCursorTargetCollisionGroup,this.myScaleStepDecreaseButtonCollisionComponent.extents=this._myConfig.mySideButtonCollisionExtents}};var Ja=class extends Xt{constructor(e,t,n=r.getMainEngine()){super(e),this._myGamepad=t,this._myConfig=new Xa,this._myUI=new Ka(n),this._myValueButtonEditIntensity=0,this._myValueButtonEditIntensityTimer=0,this._myStepButtonEditIntensity=0,this._myStepButtonEditIntensityTimer=0,this._myValueEditEnabled=!1,this._myStepEditEnabled=!1,this._myValueRealValue=0,this._myComponentStepValue=0,this._myStepMultiplierValue=0,this._myStepFastEdit=!1,this._myValueEditIndex=-1,this._myComponentIndex=0,this._myStepIndex=0,this._myTempTransformValue=be(),this._myTempPositionValue=m(),this._myTempRotationValue=m(),this._myTempScaleValue=m()}_setEasyTuneVariableHook(){if(this._myValueEditIndex>=0)switch(this._myComponentIndex){case 0:this._myValueRealValue=this._myVariable._myPosition[this._myValueEditIndex],this._myComponentStepValue=this._myVariable._myPositionStepPerSecond;break;case 1:this._myValueRealValue=this._myVariable._myRotation[this._myValueEditIndex],this._myComponentStepValue=this._myVariable._myRotationStepPerSecond;break;case 2:this._myValueRealValue=this._myVariable._myScale[this._myValueEditIndex],this._myComponentStepValue=this._myVariable._myScaleStepPerSecond;break}}_refreshUIHook(){for(let e=0;e<3;e++)this._myUI.myPositionTextComponents[e].text=this._myVariable._myPosition[e].toFixed(this._myVariable._myDecimalPlaces);this._myUI.myPositionStepTextComponent.text=this._myConfig.myStepStartString.concat(this._myVariable._myPositionStepPerSecond);for(let e=0;e<3;e++)this._myUI.myRotationTextComponents[e].text=this._myVariable._myRotation[e].toFixed(this._myVariable._myDecimalPlaces);this._myUI.myRotationStepTextComponent.text=this._myConfig.myStepStartString.concat(this._myVariable._myRotationStepPerSecond);for(let e=0;e<3;e++)this._myUI.myScaleTextComponents[e].text=this._myVariable._myScale[e].toFixed(this._myVariable._myDecimalPlaces);this._myUI.myScaleStepTextComponent.text=this._myConfig.myStepStartString.concat(this._myVariable._myScaleStepPerSecond)}_startHook(e,t){this._myUI.setAdditionalButtonsVisible(t.myAdditionalButtonsVisible)}_setEasyTuneVariableHook(){this._myVariable!=null&&(this._myTempPositionValue.pp_copy(this._myVariable._myPosition),this._myTempRotationValue.pp_copy(this._myVariable._myRotation),this._myTempScaleValue.pp_copy(this._myVariable._myScale))}_updateHook(e){this._updateValue(e)}_updateValue(e){let t=0;if(this._myGamepad){let s=this._myGamepad.getAxesInfo(oe.THUMBSTICK).myAxes[1];if(Math.abs(s)>this._myConfig.myEditThumbstickMinThreshold){let a=(Math.abs(s)-this._myConfig.myEditThumbstickMinThreshold)/(1-this._myConfig.myEditThumbstickMinThreshold);t=Math.sign(s)*a}}let n=0;if(this._myValueEditEnabled?n=t:this._myValueButtonEditIntensity!=0&&(this._myValueButtonEditIntensityTimer<=0?n=this._myValueButtonEditIntensity:this._myValueButtonEditIntensityTimer-=e),n!=0){this._myTempPositionValue.pp_copy(this._myVariable._myPosition),this._myTempRotationValue.pp_copy(this._myVariable._myRotation),this._myTempScaleValue.pp_copy(this._myVariable._myScale);let s=n*this._myComponentStepValue*e;this._myValueRealValue+=s;let a=Math.pow(10,this._myVariable._myDecimalPlaces);switch(this._myComponentIndex){case 0:this._myTempPositionValue[this._myValueEditIndex]=Math.round(this._myValueRealValue*a+Number.EPSILON)/a,this._myUI.myPositionTextComponents[this._myValueEditIndex].text=this._myTempPositionValue[this._myValueEditIndex].toFixed(this._myVariable._myDecimalPlaces);break;case 1:if(this._myValueRealValue>180){for(;this._myValueRealValue>180;)this._myValueRealValue-=180;this._myValueRealValue=-180+this._myValueRealValue}if(this._myValueRealValue<-180){for(;this._myValueRealValue<-180;)this._myValueRealValue+=180;this._myValueRealValue=180-this._myValueRealValue}this._myTempRotationValue[this._myValueEditIndex]=Math.round(this._myValueRealValue*a+Number.EPSILON)/a,this._myUI.myRotationTextComponents[this._myValueEditIndex].text=this._myTempRotationValue[this._myValueEditIndex].toFixed(this._myVariable._myDecimalPlaces);break;case 2:if(this._myValueRealValue<=0&&(this._myValueRealValue=1/a),this._myVariable._myScaleAsOne){let h=Math.round(this._myValueRealValue*a+Number.EPSILON)/a-this._myTempScaleValue[this._myValueEditIndex];for(let _=0;_<3;_++)this._myTempScaleValue[_]=Math.round((this._myTempScaleValue[_]+h)*a+Number.EPSILON)/a,this._myTempScaleValue[_]=Math.max(this._myTempScaleValue[_],1/a),this._myUI.myScaleTextComponents[_].text=this._myTempScaleValue[_].toFixed(this._myVariable._myDecimalPlaces)}else this._myTempScaleValue[this._myValueEditIndex]=Math.round(this._myValueRealValue*a+Number.EPSILON)/a,this._myTempScaleValue[this._myValueEditIndex]=Math.max(this._myTempScaleValue[this._myValueEditIndex],1/a),this._myUI.myScaleTextComponents[this._myValueEditIndex].text=this._myTempScaleValue[this._myValueEditIndex].toFixed(this._myVariable._myDecimalPlaces);break}this._myTempTransformValue.mat4_setPositionRotationDegreesScale(this._myTempPositionValue,this._myTempRotationValue,this._myTempScaleValue),this._myVariable.setValue(this._myTempTransformValue)}else switch(this._myComponentIndex){case 0:this._myValueRealValue=this._myVariable._myPosition[this._myValueEditIndex];break;case 1:this._myValueRealValue=this._myVariable._myRotation[this._myValueEditIndex];break;case 2:this._myValueRealValue=this._myVariable._myScale[this._myValueEditIndex];break}let o=0;if(this._myStepEditEnabled?o=t:this._myStepButtonEditIntensity!=0&&(this._myStepButtonEditIntensityTimer<=0?o=this._myStepButtonEditIntensity:this._myStepButtonEditIntensityTimer-=e),o!=0){let s=0;if(this._myStepFastEdit?(s=Math.sign(o)*1,this._myStepFastEdit=!1):s=o*this._myConfig.myStepMultiplierStepPerSecond*e,this._myStepMultiplierValue+=s,Math.abs(this._myStepMultiplierValue)>=1){let a=0;switch(this._myStepIndex){case 0:a=this._myVariable._myPositionStepPerSecond;break;case 1:a=this._myVariable._myRotationStepPerSecond;break;case 2:a=this._myVariable._myScaleStepPerSecond;break;default:a=0}Math.sign(this._myStepMultiplierValue)>0?(this._myStepMultiplierValue-=1,this._changeStep(this._myStepIndex,a*10)):(this._myStepMultiplierValue+=1,this._changeStep(this._myStepIndex,a*.1))}}else this._myStepMultiplierValue=0,this._myStepFastEdit=!0}_addListenersHook(){let e=this._myUI;e.myVariableLabelCursorTargetComponent.onClick.add(this._resetAllValues.bind(this)),e.myVariableLabelCursorTargetComponent.onHover.add(this._genericTextHover.bind(this,e.myVariableLabelText)),e.myVariableLabelCursorTargetComponent.onUnhover.add(this._genericTextUnHover.bind(this,e.myVariableLabelText,this._myConfig.myVariableLabelTextScale)),e.myPositionLabelCursorTargetComponent.onClick.add(this._resetComponentValues.bind(this,0)),e.myPositionLabelCursorTargetComponent.onHover.add(this._genericTextHover.bind(this,e.myPositionLabelText)),e.myPositionLabelCursorTargetComponent.onUnhover.add(this._genericTextUnHover.bind(this,e.myPositionLabelText,this._myConfig.myComponentLabelTextScale));for(let t=0;t<3;t++)e.myPositionIncreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,0,t,1)),e.myPositionIncreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,0,t,1)),e.myPositionIncreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,0,t,0)),e.myPositionIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,0,t,0)),e.myPositionDecreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,0,t,-1)),e.myPositionDecreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,0,t,-1)),e.myPositionDecreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,0,t,0)),e.myPositionDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,0,t,0)),e.myPositionIncreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myPositionIncreaseButtonBackgroundComponents[t].material)),e.myPositionIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnHover.bind(this,e.myPositionIncreaseButtonBackgroundComponents[t].material)),e.myPositionDecreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myPositionDecreaseButtonBackgroundComponents[t].material)),e.myPositionDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnHover.bind(this,e.myPositionDecreaseButtonBackgroundComponents[t].material)),e.myPositionCursorTargetComponents[t].onClick.add(this._resetValue.bind(this,0,t)),e.myPositionCursorTargetComponents[t].onHover.add(this._setValueEditEnabled.bind(this,0,t,e.myPositionTexts[t],!0)),e.myPositionCursorTargetComponents[t].onUnhover.add(this._setValueEditEnabled.bind(this,0,t,e.myPositionTexts[t],!1));e.myRotationLabelCursorTargetComponent.onClick.add(this._resetComponentValues.bind(this,1)),e.myRotationLabelCursorTargetComponent.onHover.add(this._genericTextHover.bind(this,e.myRotationLabelText)),e.myRotationLabelCursorTargetComponent.onUnhover.add(this._genericTextUnHover.bind(this,e.myRotationLabelText,this._myConfig.myComponentLabelTextScale));for(let t=0;t<3;t++)e.myRotationIncreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,1,t,1)),e.myRotationIncreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,1,t,1)),e.myRotationIncreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,1,t,0)),e.myRotationIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,1,t,0)),e.myRotationDecreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,1,t,-1)),e.myRotationDecreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,1,t,-1)),e.myRotationDecreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,1,t,0)),e.myRotationDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,1,t,0)),e.myRotationIncreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myRotationIncreaseButtonBackgroundComponents[t].material)),e.myRotationIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnHover.bind(this,e.myRotationIncreaseButtonBackgroundComponents[t].material)),e.myRotationDecreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myRotationDecreaseButtonBackgroundComponents[t].material)),e.myRotationDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnHover.bind(this,e.myRotationDecreaseButtonBackgroundComponents[t].material)),e.myRotationCursorTargetComponents[t].onClick.add(this._resetValue.bind(this,1,t)),e.myRotationCursorTargetComponents[t].onHover.add(this._setValueEditEnabled.bind(this,1,t,e.myRotationTexts[t],!0)),e.myRotationCursorTargetComponents[t].onUnhover.add(this._setValueEditEnabled.bind(this,1,t,e.myRotationTexts[t],!1));e.myScaleLabelCursorTargetComponent.onClick.add(this._resetComponentValues.bind(this,2)),e.myScaleLabelCursorTargetComponent.onHover.add(this._genericTextHover.bind(this,e.myScaleLabelText)),e.myScaleLabelCursorTargetComponent.onUnhover.add(this._genericTextUnHover.bind(this,e.myScaleLabelText,this._myConfig.myComponentLabelTextScale));for(let t=0;t<3;t++)e.myScaleIncreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,2,t,1)),e.myScaleIncreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,2,t,1)),e.myScaleIncreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,2,t,0)),e.myScaleIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,2,t,0)),e.myScaleDecreaseButtonCursorTargetComponents[t].onDown.add(this._setValueEditIntensity.bind(this,2,t,-1)),e.myScaleDecreaseButtonCursorTargetComponents[t].onDownOnHover.add(this._setValueEditIntensity.bind(this,2,t,-1)),e.myScaleDecreaseButtonCursorTargetComponents[t].onUp.add(this._setValueEditIntensity.bind(this,2,t,0)),e.myScaleDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._setValueEditIntensity.bind(this,2,t,0)),e.myScaleIncreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myScaleIncreaseButtonBackgroundComponents[t].material)),e.myScaleIncreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnHover.bind(this,e.myScaleIncreaseButtonBackgroundComponents[t].material)),e.myScaleDecreaseButtonCursorTargetComponents[t].onHover.add(this._genericHover.bind(this,e.myScaleDecreaseButtonBackgroundComponents[t].material)),e.myScaleDecreaseButtonCursorTargetComponents[t].onUnhover.add(this._genericUnHover.bind(this,e.myScaleDecreaseButtonBackgroundComponents[t].material)),e.myScaleCursorTargetComponents[t].onClick.add(this._resetValue.bind(this,2,t)),e.myScaleCursorTargetComponents[t].onHover.add(this._setValueEditEnabled.bind(this,2,t,e.myScaleTexts[t],!0)),e.myScaleCursorTargetComponents[t].onUnhover.add(this._setValueEditEnabled.bind(this,2,t,e.myScaleTexts[t],!1));e.myPositionStepCursorTargetComponent.onClick.add(this._resetStep.bind(this,0)),e.myPositionStepCursorTargetComponent.onHover.add(this._setStepEditEnabled.bind(this,0,e.myPositionStepText,!0)),e.myPositionStepCursorTargetComponent.onUnhover.add(this._setStepEditEnabled.bind(this,0,e.myPositionStepText,!1)),e.myPositionStepIncreaseButtonCursorTargetComponent.onDown.add(this._setStepEditIntensity.bind(this,0,1)),e.myPositionStepIncreaseButtonCursorTargetComponent.onDownOnHover.add(this._setStepEditIntensity.bind(this,0,1)),e.myPositionStepIncreaseButtonCursorTargetComponent.onUp.add(this._setStepEditIntensity.bind(this,0,0)),e.myPositionStepIncreaseButtonCursorTargetComponent.onUnhover.add(this._setStepEditIntensity.bind(this,0,0)),e.myPositionStepDecreaseButtonCursorTargetComponent.onDown.add(this._setStepEditIntensity.bind(this,0,-1)),e.myPositionStepDecreaseButtonCursorTargetComponent.onDownOnHover.add(this._setStepEditIntensity.bind(this,0,-1)),e.myPositionStepDecreaseButtonCursorTargetComponent.onUp.add(this._setStepEditIntensity.bind(this,0,0)),e.myPositionStepDecreaseButtonCursorTargetComponent.onUnhover.add(this._setStepEditIntensity.bind(this,0,0)),e.myPositionStepIncreaseButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myPositionStepIncreaseButtonBackgroundComponent.material)),e.myPositionStepIncreaseButtonCursorTargetComponent.onUnhover.add(this._genericUnHover.bind(this,e.myPositionStepIncreaseButtonBackgroundComponent.material)),e.myPositionStepDecreaseButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myPositionStepDecreaseButtonBackgroundComponent.material)),e.myPositionStepDecreaseButtonCursorTargetComponent.onUnhover.add(this._genericUnHover.bind(this,e.myPositionStepDecreaseButtonBackgroundComponent.material)),e.myRotationStepCursorTargetComponent.onClick.add(this._resetStep.bind(this,1)),e.myRotationStepCursorTargetComponent.onHover.add(this._setStepEditEnabled.bind(this,1,e.myRotationStepText,!0)),e.myRotationStepCursorTargetComponent.onUnhover.add(this._setStepEditEnabled.bind(this,1,e.myRotationStepText,!1)),e.myRotationStepIncreaseButtonCursorTargetComponent.onDown.add(this._setStepEditIntensity.bind(this,1,1)),e.myRotationStepIncreaseButtonCursorTargetComponent.onDownOnHover.add(this._setStepEditIntensity.bind(this,1,1)),e.myRotationStepIncreaseButtonCursorTargetComponent.onUp.add(this._setStepEditIntensity.bind(this,1,0)),e.myRotationStepIncreaseButtonCursorTargetComponent.onUnhover.add(this._setStepEditIntensity.bind(this,1,0)),e.myRotationStepDecreaseButtonCursorTargetComponent.onDown.add(this._setStepEditIntensity.bind(this,1,-1)),e.myRotationStepDecreaseButtonCursorTargetComponent.onDownOnHover.add(this._setStepEditIntensity.bind(this,1,-1)),e.myRotationStepDecreaseButtonCursorTargetComponent.onUp.add(this._setStepEditIntensity.bind(this,1,0)),e.myRotationStepDecreaseButtonCursorTargetComponent.onUnhover.add(this._setStepEditIntensity.bind(this,1,0)),e.myRotationStepIncreaseButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myRotationStepIncreaseButtonBackgroundComponent.material)),e.myRotationStepIncreaseButtonCursorTargetComponent.onUnhover.add(this._genericUnHover.bind(this,e.myRotationStepIncreaseButtonBackgroundComponent.material)),e.myRotationStepDecreaseButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myRotationStepDecreaseButtonBackgroundComponent.material)),e.myRotationStepDecreaseButtonCursorTargetComponent.onUnhover.add(this._genericUnHover.bind(this,e.myRotationStepDecreaseButtonBackgroundComponent.material)),e.myScaleStepCursorTargetComponent.onClick.add(this._resetStep.bind(this,2)),e.myScaleStepCursorTargetComponent.onHover.add(this._setStepEditEnabled.bind(this,2,e.myScaleStepText,!0)),e.myScaleStepCursorTargetComponent.onUnhover.add(this._setStepEditEnabled.bind(this,2,e.myScaleStepText,!1)),e.myScaleStepIncreaseButtonCursorTargetComponent.onDown.add(this._setStepEditIntensity.bind(this,2,1)),e.myScaleStepIncreaseButtonCursorTargetComponent.onDownOnHover.add(this._setStepEditIntensity.bind(this,2,1)),e.myScaleStepIncreaseButtonCursorTargetComponent.onUp.add(this._setStepEditIntensity.bind(this,2,0)),e.myScaleStepIncreaseButtonCursorTargetComponent.onUnhover.add(this._setStepEditIntensity.bind(this,2,0)),e.myScaleStepDecreaseButtonCursorTargetComponent.onDown.add(this._setStepEditIntensity.bind(this,2,-1)),e.myScaleStepDecreaseButtonCursorTargetComponent.onDownOnHover.add(this._setStepEditIntensity.bind(this,2,-1)),e.myScaleStepDecreaseButtonCursorTargetComponent.onUp.add(this._setStepEditIntensity.bind(this,2,0)),e.myScaleStepDecreaseButtonCursorTargetComponent.onUnhover.add(this._setStepEditIntensity.bind(this,2,0)),e.myScaleStepIncreaseButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myScaleStepIncreaseButtonBackgroundComponent.material)),e.myScaleStepIncreaseButtonCursorTargetComponent.onUnhover.add(this._genericUnHover.bind(this,e.myScaleStepIncreaseButtonBackgroundComponent.material)),e.myScaleStepDecreaseButtonCursorTargetComponent.onHover.add(this._genericHover.bind(this,e.myScaleStepDecreaseButtonBackgroundComponent.material)),e.myScaleStepDecreaseButtonCursorTargetComponent.onUnhover.add(this._genericUnHover.bind(this,e.myScaleStepDecreaseButtonBackgroundComponent.material))}_setValueEditIntensity(e,t,n){if(this._isActive()||n==0){if(n!=0){switch(e){case 0:this._myValueRealValue=this._myVariable._myPosition[t],this._myComponentStepValue=this._myVariable._myPositionStepPerSecond;break;case 1:this._myValueRealValue=this._myVariable._myRotation[t],this._myComponentStepValue=this._myVariable._myRotationStepPerSecond;break;case 2:this._myValueRealValue=this._myVariable._myScale[t],this._myComponentStepValue=this._myVariable._myScaleStepPerSecond;break}this._myValueButtonEditIntensityTimer=this._myConfig.myButtonEditDelay,this._myValueEditIndex=t,this._myComponentIndex=e}this._myValueButtonEditIntensity=n}}_setStepEditIntensity(e,t){(this._isActive()||t==0)&&(t!=0&&(this._myStepButtonEditIntensityTimer=this._myConfig.myButtonEditDelay),this._myStepButtonEditIntensity=t,this._myStepIndex=e)}_setValueEditEnabled(e,t,n,o){if(this._isActive()||!o){if(o){switch(e){case 0:this._myValueRealValue=this._myVariable._myPosition[t],this._myComponentStepValue=this._myVariable._myPositionStepPerSecond;break;case 1:this._myValueRealValue=this._myVariable._myRotation[t],this._myComponentStepValue=this._myVariable._myRotationStepPerSecond;break;case 2:this._myValueRealValue=this._myVariable._myScale[t],this._myComponentStepValue=this._myVariable._myScaleStepPerSecond;break}this._myValueEditIndex=t,this._myComponentIndex=e,n.pp_scaleObject(this._myConfig.myTextHoverScaleMultiplier)}else n.pp_setScaleLocal(this._myConfig.myValueTextScale);this._myValueEditEnabled=o}}_setStepEditEnabled(e,t,n){(this._isActive()||!n)&&(n?t.pp_scaleObject(this._myConfig.myTextHoverScaleMultiplier):t.pp_setScaleLocal(this._myConfig.myStepTextScale),this._myStepEditEnabled=n,this._myStepIndex=e)}_resetValue(e,t){if(this._isActive()){switch(this._myTempPositionValue.pp_copy(this._myVariable._myPosition),this._myTempRotationValue.pp_copy(this._myVariable._myRotation),this._myTempScaleValue.pp_copy(this._myVariable._myScale),e){case 0:this._myTempPositionValue[t]=this._myVariable._myDefaultPosition[t],this._myUI.myPositionTextComponents[t].text=this._myTempPositionValue[t].toFixed(this._myVariable._myDecimalPlaces);break;case 1:this._myTempRotationValue[t]=this._myVariable._myDefaultRotation[t],this._myUI.myRotationTextComponents[t].text=this._myTempRotationValue[t].toFixed(this._myVariable._myDecimalPlaces);break;case 2:this._myTempScaleValue[t]=this._myVariable._myDefaultScale[t],this._myUI.myScaleTextComponents[t].text=this._myTempScaleValue[t].toFixed(this._myVariable._myDecimalPlaces);break}this._myTempTransformValue.mat4_setPositionRotationDegreesScale(this._myTempPositionValue,this._myTempRotationValue,this._myTempScaleValue),this._myVariable.setValue(this._myTempTransformValue)}}_resetAllValues(){for(let e=0;e<3;e++)this._resetComponentValues(e)}_resetComponentValues(e){for(let t=0;t<3;t++)this._resetValue(e,t)}_resetStep(e){if(this._isActive()){let t=0;switch(e){case 0:t=this._myVariable._myDefaultPositionStepPerSecond;break;case 1:t=this._myVariable._myDefaultRotationStepPerSecond;break;case 2:t=this._myVariable._myDefaultScaleStepPerSecond;break;default:t=0}this._changeStep(e,t)}}_changeStep(e,t){switch(t=Math.pp_roundDecimal(t,10),e){case 0:this._myVariable._myPositionStepPerSecond=t,this._myUI.myPositionStepTextComponent.text=this._myConfig.myStepStartString.concat(this._myVariable._myPositionStepPerSecond);break;case 1:this._myVariable._myRotationStepPerSecond=t,this._myUI.myRotationStepTextComponent.text=this._myConfig.myStepStartString.concat(this._myVariable._myRotationStepPerSecond);break;case 2:this._myVariable._myScaleStepPerSecond=t,this._myUI.myScaleStepTextComponent.text=this._myConfig.myStepStartString.concat(this._myVariable._myScaleStepPerSecond);break}}_genericTextHover(e){e.pp_scaleObject(this._myConfig.myTextHoverScaleMultiplier)}_genericTextUnHover(e,t){e.pp_setScaleLocal(t)}};var Za=class extends Eo{constructor(){super(),this.myShowOnStart=!1,this.myShowVisibilityButton=!1,this.myAdditionalButtonsVisible=!1,this.myGamepadScrollVariableEnabled=!1,this.myVariablesImportExportButtonsVisible=!1,this.myVariablesImportCallback=null,this.myVariablesExportCallback=null}},Ya=class{constructor(e=r.getMainEngine()){this._myStarted=!1,this._myStartVariable=null,this._myWidgetFrame=new Do("E",1,e),this._myWidgetFrame.registerWidgetVisibleChangedEventListener(this,this._widgetVisibleChanged.bind(this)),this._myConfig=new ja,this._myParams=null,this._myWidgets=[],this._myEasyTuneVariables=null,this._myEasyTuneLastSize=0,this._myVariableNames=null,this._myCurrentWidget=null,this._myCurrentVariable=null,this._myScrollVariableTimer=0,this._myGamepad=null,this._myRefreshVariablesTimer=0,this._myDirty=!1,this._myEngine=e,this._myDestroyed=!1}setActiveVariable(e){this._myStarted?this._myEasyTuneVariables.has(e)?(this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(e),this._selectCurrentWidget()):console.log("Can't set easy tune active variable"):this._myStartVariable=e}refresh(){this._myWidgetFrame.isVisible()&&(this._myDirty=!0)}setVisible(e){this._myWidgetFrame.setVisible(e)}isVisible(){return this._myWidgetFrame.isVisible()}start(e,t,n){this._myRightGamepad=r.getRightGamepad(this._myEngine),this._myLeftGamepad=r.getLeftGamepad(this._myEngine),this._myConfig.myGamepadHandedness==U.RIGHT?this._myGamepad=this._myRightGamepad:this._myConfig.myGamepadHandedness==U.LEFT&&(this._myGamepad=this._myLeftGamepad),this._myStarted=!0,this._myParams=t,this._myWidgetFrame.start(e,t),this._myEasyTuneVariables=n,this._myEasyTuneLastSize=this._myEasyTuneVariables.length(),this._myVariableNames=this._myEasyTuneVariables.getEasyTuneVariablesNames(),this._myEasyTuneVariables.length()>0&&(this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(this._myVariableNames[0])),this._myStartVariable&&(this._myEasyTuneVariables.has(this._myStartVariable)?this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(this._myStartVariable):console.log("Can't set easy tune active variable")),this._initializeWidgets()}update(e){this._myWidgetFrame.update(e),(this._myEasyTuneVariables.length()!=this._myEasyTuneLastSize||this._myDirty)&&this._refreshEasyTuneVariables(),this._myWidgetFrame.isVisible()&&this._myEasyTuneVariables.length()>0&&(this._myConfig.myRefreshVariablesDelay!=null&&(this._myRefreshVariablesTimer+=e,this._myRefreshVariablesTimer>this._myConfig.myRefreshVariablesDelay&&(this._myRefreshVariablesTimer=0,this._refreshEasyTuneVariables())),this._myCurrentWidget&&this._myCurrentWidget.update(e),this._myParams.myGamepadScrollVariableEnabled&&this._updateGamepadScrollVariable(e)),this._updateGamepadWidgetVisibility(),this._updateActiveVariable()}_initializeWidgets(){let e=new Oa;e.myVariablesImportCallback=this._importVariables.bind(this),e.myVariablesExportCallback=this._exportVariables.bind(this),this._myWidgets[ci.NONE]=new Ga(e,this._myEngine),this._myWidgets[ci.NUMBER]=new qa(e,this._myGamepad,this._myEngine),this._myWidgets[ci.BOOL]=new wa(e,this._myGamepad,this._myEngine),this._myWidgets[ci.TRANSFORM]=new Ja(e,this._myGamepad,this._myEngine);for(let t of this._myWidgets)t!=null&&(t.start(this._myWidgetFrame.getWidgetObject(),this._myParams),t.setVisible(!1),t.registerScrollVariableRequestEventListener(this,this._scrollVariable.bind(this)));this._selectCurrentWidget()}_selectCurrentWidget(){if(this._myEasyTuneVariables.length()<=0)return;this._myCurrentVariable==null&&(this._myVariableNames=this._myEasyTuneVariables.getEasyTuneVariablesNames(),this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(this._myVariableNames[0]));let e=null;this._myCurrentWidget!=null&&(e=this._myCurrentWidget.getWidget()),this._myCurrentVariable.getType()in this._myWidgets?this._myCurrentWidget=this._myWidgets[this._myCurrentVariable.getType()]:this._myCurrentWidget=this._myWidgets[ci.NONE],this._myCurrentWidget.setEasyTuneVariable(this._myCurrentVariable,this._createIndexString()),this._myCurrentWidget.getWidget().syncWidget(e),e?.setVisible(!1),this._myCurrentWidget.setVisible(this._myWidgetFrame.isVisible())}_refreshEasyTuneVariables(){this._myVariableNames=this._myEasyTuneVariables.getEasyTuneVariablesNames(),this._myEasyTuneLastSize=this._myEasyTuneVariables.length(),this._myEasyTuneVariables.length()>0?(this._myCurrentVariable&&this._myEasyTuneVariables.has(this._myCurrentVariable.getName())?this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(this._myCurrentVariable.getName()):this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(this._myVariableNames[0]),this._selectCurrentWidget()):(this._myCurrentVariable=null,this._myCurrentWidget&&(this._myCurrentWidget.setVisible(!1),this._myCurrentWidget=null)),this._myDirty=!1}_updateGamepadWidgetVisibility(){this._myGamepad&&(this._myGamepad.getButtonInfo(M.BOTTOM_BUTTON).isPressStart()&&this._myGamepad.getButtonInfo(M.TOP_BUTTON).isPressed()||this._myGamepad.getButtonInfo(M.TOP_BUTTON).isPressStart()&&this._myGamepad.getButtonInfo(M.BOTTOM_BUTTON).isPressed())&&this._toggleVisibility()}_toggleVisibility(){this._myWidgetFrame.toggleVisibility()}_widgetVisibleChanged(e){for(let t of this._myWidgets)t?.setVisible(!1);this._myCurrentWidget&&(this._myEasyTuneVariables.length()>0?this._myCurrentWidget.setVisible(e):this._myCurrentWidget.setVisible(!1)),e&&this._refreshEasyTuneVariables()}_updateGamepadScrollVariable(e){if(this._myGamepad&&(!this._myConfig.myScrollVariableButtonID||this._myGamepad.getButtonInfo(this._myConfig.myScrollVariableButtonID).isPressed())){let t=this._myGamepad.getAxesInfo(oe.THUMBSTICK).myAxes[0],n=this._myGamepad.getAxesInfo(oe.THUMBSTICK).myAxes[1];if(Math.abs(t)>this._myConfig.myScrollVariableMinXThreshold&&Math.abs(n)<this._myConfig.myScrollVariableMaxYThreshold)for(this._myScrollVariableTimer+=e;this._myScrollVariableTimer>this._myConfig.myScrollVariableDelay;)this._myScrollVariableTimer-=this._myConfig.myScrollVariableDelay,this._scrollVariable(Math.sign(t));else this._myScrollVariableTimer=this._myConfig.myScrollVariableDelay}else this._myScrollVariableTimer=this._myConfig.myScrollVariableDelay}_scrollVariable(e){if(this._myEasyTuneVariables.length()<=0)return;let t=this._getVariableIndex(this._myCurrentVariable);if(t>=0){let n=((t+e)%this._myVariableNames.length+this._myVariableNames.length)%this._myVariableNames.length;this._myEasyTuneVariables.has(this._myVariableNames[n])?(this._myCurrentVariable=this._myEasyTuneVariables.getEasyTuneVariable(this._myVariableNames[n]),this._selectCurrentWidget()):this._refreshEasyTuneVariables()}else this._refreshEasyTuneVariables()}_createIndexString(){let e=" (",t=(this._getVariableIndex(this._myCurrentVariable)+1).toString(),n=this._myEasyTuneVariables.length().toString();for(;t.length<n.length;)t="0".concat(t);return e=e.concat(t).concat(" - ").concat(n).concat(")"),e}_getVariableIndex(e){return this._myVariableNames.indexOf(e.getName())}_updateActiveVariable(){for(let e of this._myEasyTuneVariables.getEasyTuneVariablesList())e.setActive(!1);this._myWidgetFrame.isVisible()&&this._myCurrentVariable&&this._myCurrentVariable.setActive(!0)}_importVariables(){this._myParams.myVariablesImportCallback(this._onImportSuccess.bind(this),this._onImportFailure.bind(this))}_exportVariables(){this._myParams.myVariablesExportCallback(this._onExportSuccess.bind(this),this._onExportFailure.bind(this))}_onImportSuccess(){this._myCurrentWidget&&this._myCurrentWidget.onImportSuccess()}_onImportFailure(){this._myCurrentWidget&&this._myCurrentWidget.onImportFailure()}_onExportSuccess(){this._myCurrentWidget&&this._myCurrentWidget.onExportSuccess()}_onExportFailure(){this._myCurrentWidget&&this._myCurrentWidget.onExportFailure()}destroy(){this._myDestroyed=!0;for(let e of this._myWidgets)e.destroy();this._myWidgetFrame.destroy()}isDestroyed(){return this._myDestroyed}};var jn=class extends tV{init(){this.object.pp_addComponent(Lt),this._myWidget=new Ya(this.engine),He.addSetWidgetActiveVariableCallback(this,function(e){this._myWidget.setActiveVariable(e)}.bind(this),this.engine),He.addRefreshWidgetCallback(this,function(){this._myWidget.refresh()}.bind(this),this.engine),this._myStarted=!1}start(){if(r.isToolEnabled(this.engine)){let e=new Za;e.myHandedness=[null,"left","right"][this._myHandedness],e.myShowOnStart=this._myShowOnStart,e.myShowVisibilityButton=this._myShowVisibilityButton,e.myAdditionalButtonsVisible=!0,e.myGamepadScrollVariableEnabled=this._myGamepadScrollVariableEnabled,e.myPlaneMaterial=r.getDefaultMaterials(this.engine).myFlatOpaque.clone(),e.myTextMaterial=r.getDefaultMaterials(this.engine).myText.clone(),e.myVariablesImportExportButtonsVisible=this._myVariablesImportExportButtonsVisible,e.myVariablesImportCallback=function(t,n){He.importVariables(this._myVariablesImportURL,this._myResetVariablesDefaultValueOnImport,t,n,this.engine)}.bind(this),e.myVariablesExportCallback=function(t,n){He.exportVariables(this._myVariablesExportURL,t,n,this.engine)}.bind(this),this._myWidget.start(this.object,e,r.getEasyTuneVariables(this.engine)),this._myWidgetVisibleBackup=this._myWidget.isVisible(),this._mySetVisibleNextUpdate=!1,this._myStarted=!0,this._myFirstUpdate=!0}}update(e){r.isToolEnabled(this.engine)&&this._myStarted&&(this._myFirstUpdate&&(this._myFirstUpdate=!1,this._myImportVariablesOnStart&&He.importVariables(this._myVariablesImportURL,this._myResetVariablesDefaultValueOnImport,void 0,void 0,this.engine)),this._mySetVisibleNextUpdate&&(this._mySetVisibleNextUpdate=!1,this._myWidget.setVisible(!1),this._myWidget.setVisible(this._myWidgetVisibleBackup)),this._myWidget.update(e))}onActivate(){r.isToolEnabled(this.engine)&&this._myStarted&&(this._mySetVisibleNextUpdate=!0)}onDeactivate(){r.isToolEnabled(this.engine)&&this._myStarted&&(this._myWidgetVisibleBackup=this._myWidget.isVisible(),this._myWidget.setVisible(!1))}onDestroy(){this._myWidget.destroy(),He.removeSetWidgetActiveVariableCallback(this,this.engine),He.removeRefreshWidgetCallback(this,this.engine)}};R(jn,"TypeName","pp-easy-tune-tool"),R(jn,"Properties",{_myHandedness:Fi.enum(["None","Left","Right"],"None"),_myShowOnStart:Fi.bool(!1),_myShowVisibilityButton:Fi.bool(!1),_myGamepadScrollVariableEnabled:Fi.bool(!0),_myVariablesImportExportButtonsVisible:Fi.bool(!1),_myVariablesImportURL:Fi.string(""),_myVariablesExportURL:Fi.string(""),_myImportVariablesOnStart:Fi.bool(!1),_myResetVariablesDefaultValueOnImport:Fi.bool(!1)});import{Component as iV,Property as Eb}from"@wonderlandengine/api";var zn=class extends iV{start(){this._myFirstUpdate=!0}update(e){this._myFirstUpdate&&(this._myFirstUpdate=!1,He.importVariables(this._myVariablesImportURL,this._myResetVariablesDefaultValueOnImport,void 0,void 0,this.engine))}};R(zn,"TypeName","pp-easy-tune-import-variables"),R(zn,"Properties",{_myVariablesImportURL:Eb.string(""),_myResetVariablesDefaultValueOnImport:Eb.bool(!0)});var st=class{constructor(e,t,n,o,s=r.getMainEngine()){this._myObject=e,this._myUseTuneTarget=o,this._mySetAsDefault=n,this._myEasyObject=this._myObject,this._myUseTuneTarget&&(this._myEasyObject=r.getEasyTuneTarget(s)),this._myPrevEasyObject=null;let a=this._getVariableNamePrefix();t==""?this._myEasyTuneVariableName=a.concat(this._myObject.pp_getID()):this._myEasyTuneVariableName=a.concat(t),this._myEngine=s}start(){let e=this._createEasyTuneVariable(this._myEasyTuneVariableName);r.getEasyTuneVariables(this._myEngine).add(e),this._mySetAsDefault&&He.setWidgetActiveVariable(this._myEasyTuneVariableName,this._myEngine)}update(e){if(r.getEasyTuneVariables(this._myEngine).isActive(this._myEasyTuneVariableName)){if(this._myUseTuneTarget&&(this._myEasyObject=r.getEasyTuneTarget(engine)),this._myPrevEasyObject!=this._myEasyObject)if(this._myPrevEasyObject=this._myEasyObject,this._myEasyObject){let t=this._getObjectValue(this._myEasyObject);r.getEasyTuneVariables(this._myEngine).set(this._myEasyTuneVariableName,t,!0)}else{let t=this._getDefaultValue();r.getEasyTuneVariables(this._myEngine).set(this._myEasyTuneVariableName,t,!0)}this._myEasyObject&&this._updateObjectValue(this._myEasyObject,r.getEasyTuneVariables(this._myEngine).get(this._myEasyTuneVariableName))}}updateVariableValue(e){r.getEasyTuneVariables(this._myEngine).set(this._myEasyTuneVariableName,e)}};import{LightComponent as Db}from"@wonderlandengine/api";var $a=class extends st{constructor(e,t,n,o){super(e,t,n,o)}_getVariableNamePrefix(){return"Light Attenuation "}_createEasyTuneVariable(e){return new sn(e,this._getDefaultValue(),.01,3,0,1)}_getObjectValue(e){return this._getLightAttenuation(e)}_getDefaultValue(){return 0}_updateObjectValue(e,t){let n=t,o=e.pp_getComponent(Db);o&&(o.color[3]=n)}_getLightAttenuation(e){let t=this._getDefaultValue(),n=e.pp_getComponent(Db);return n&&(t=n.color[3]),t}};import{LightComponent as Rb}from"@wonderlandengine/api";var er=class extends st{constructor(e,t,n,o,s,a){super(t,n,o,s,a),this._myColorModel=e}_getVariableNamePrefix(){let e=null;return this._myColorModel==0?e="Light RGB ":e="Light HSV ",e}_createEasyTuneVariable(e){return new ki(e,this._getDefaultValue(),100,0,255)}_getObjectValue(e){let t=null,n=this._getLightColor(e);return n?this._myColorModel==0?t=he.rgbCodeToHuman(n):t=he.hsvCodeToHuman(he.rgbToHSV(n)):t=this._getDefaultValue(),t}_getDefaultValue(){return m()}_updateObjectValue(e,t){let n=t;this._myColorModel==0?n=he.rgbHumanToCode(n):n=he.hsvToRGB(he.hsvHumanToCode(n));let o=e.pp_getComponent(Rb);if(o&&(o.color[0]=n[0],o.color[1]=n[1],o.color[2]=n[2],o.color[3]=o.color[3]),r.getRightGamepad(this._myEngine).getButtonInfo(M.TOP_BUTTON).isPressStart()&&r.getLeftGamepad(this._myEngine).getButtonInfo(M.TOP_BUTTON).isPressed()||r.getLeftGamepad(this._myEngine).getButtonInfo(M.TOP_BUTTON).isPressStart()&&r.getRightGamepad(this._myEngine).getButtonInfo(M.TOP_BUTTON).isPressed()){let s=he.color1To255(he.rgbToHSV(n)),a=he.color1To255(n);console.log("RGB:",a.vec_toString(0),"- HSV:",s.vec_toString(0))}}_getLightColor(e){let t=null,n=e.pp_getComponent(Rb);return n&&(t=n.color.slice(0,3)),t}};var tr=class extends st{constructor(e,t,n,o,s,a,l){super(n,o,s,a,l),this._myColorModel=e,this._myColorType=t,this._myColorVariableNames=["color","diffuseColor","ambientColor","specularColor","emissiveColor","fogColor","ambientFactor"]}_getVariableNamePrefix(){let e=null;return this._myColorModel==0?e="Mesh RGB ":e="Mesh HSV ",e}_createEasyTuneVariable(e){return this._myColorType==6?new Li(e,this._getDefaultValue(),.1,3,0,1):new ki(e,this._getDefaultValue(),100,0,255)}_getObjectValue(e){let t=null,n=this._getMeshMaterial(e);return n?this._myColorType!=6?(t=n[this._myColorVariableNames[this._myColorType]].pp_clone(),this._myColorModel==0?t=he.rgbCodeToHuman(t):t=he.hsvCodeToHuman(he.rgbToHSV(t))):t=[n[this._myColorVariableNames[this._myColorType]]]:t=this._getDefaultValue(),t}_getDefaultValue(){return this._myColorType==6?[0]:w()}_updateObjectValue(e,t){let n=t;this._myColorType!=6&&(this._myColorModel==0?n=he.rgbHumanToCode(n):n=he.hsvToRGB(he.hsvHumanToCode(n)));let o=this._getMeshMaterial(e);if(o&&(o[this._myColorVariableNames[this._myColorType]]=n),this._myColorType!=6&&(r.getRightGamepad(this._myEngine).getButtonInfo(M.TOP_BUTTON).isPressStart()&&r.getLeftGamepad(this._myEngine).getButtonInfo(M.TOP_BUTTON).isPressed()||r.getLeftGamepad(this._myEngine).getButtonInfo(M.TOP_BUTTON).isPressStart()&&r.getRightGamepad(this._myEngine).getButtonInfo(M.TOP_BUTTON).isPressed())){let s=he.color1To255(he.rgbToHSV(n)),a=he.color1To255(n);console.log("RGB:",a.vec_toString(0),"- HSV:",s.vec_toString(0))}}_getMeshMaterial(e){let t=null,n=e.pp_getComponent(MeshComponent);return n&&(t=n.material),t}};var ir=class extends st{constructor(e,t,n,o,s,a,l){super(n,o,s,a,l),this._myLocal=e,this._myScaleAsOne=t}_getVariableNamePrefix(){return"Scale "}_createEasyTuneVariable(e){return new Li(e,this._getDefaultValue(),1,3,.001,null,this._myScaleAsOne)}_getObjectValue(e){return this._myLocal?e.pp_getScaleLocal():e.pp_getScale()}_getDefaultValue(){return m(1,1,1)}_updateObjectValue(e,t){this._myLocal?e.pp_setScaleLocal(t):e.pp_setScale(t)}};var nr=class extends st{constructor(e,t,n,o,s,a,l){super(n,o,s,a,l),this._myLocal=e,this._myScaleAsOne=t}_getVariableNamePrefix(){return"Transform "}_createEasyTuneVariable(e){return new Oo(e,this._getDefaultValue(),this._myScaleAsOne)}_getObjectValue(e){return this._myLocal?e.pp_getTransformLocal():e.pp_getTransform()}_getDefaultValue(){return be()}_updateObjectValue(e,t){this._myLocal?e.pp_setTransformLocal(t):e.pp_setTransform(t)}};var or=class extends st{constructor(e,t,n,o,s){super(e,t,n,o,s)}_getVariableNamePrefix(){let e=null;return this._myColorModel==0,e="Mesh AF ",e}_createEasyTuneVariable(e){return new sn(e,this._getDefaultValue(),.1,3,0,1)}_getObjectValue(e){let t=null,n=this._getMeshMaterial(e);return n?t=n.ambientFactor:t=this._getDefaultValue(),t}_getDefaultValue(){return 0}_updateObjectValue(e,t){let n=t,o=this._getMeshMaterial(e);o&&(o.ambientFactor=n)}_getMeshMaterial(e){let t=null,n=e.pp_getComponent(MeshComponent);return n&&(t=n.material),t}};var sr=class extends st{constructor(e,t,n,o,s,a,l){super(n,o,s,a,l),this._myColorModel=e,this._myColorType=t,this._myColorVariableNames=["color","effectColor"]}_getVariableNamePrefix(){let e=null;return this._myColorModel==0?e="Text RGB ":e="Text HSV ",e}_createEasyTuneVariable(e){return new ki(e,this._getDefaultValue(),100,0,255)}_getObjectValue(e){let t=null,n=this._getTextMaterial(e);return n?(t=n[this._myColorVariableNames[this._myColorType]].pp_clone(),this._myColorModel==0?t=he.rgbCodeToHuman(t):t=he.hsvCodeToHuman(he.rgbToHSV(t))):t=this._getDefaultValue(),t}_getDefaultValue(){return w()}_updateObjectValue(e,t){let n=t;this._myColorModel==0?n=he.rgbHumanToCode(n):n=he.hsvToRGB(he.hsvHumanToCode(n));let o=this._getTextMaterial(e);if(o&&(o[this._myColorVariableNames[this._myColorType]]=n),r.getRightGamepad(this._myEngine).getButtonInfo(M.TOP_BUTTON).isPressStart()&&r.getLeftGamepad(this._myEngine).getButtonInfo(M.TOP_BUTTON).isPressed()||r.getLeftGamepad(this._myEngine).getButtonInfo(M.TOP_BUTTON).isPressStart()&&r.getRightGamepad(this._myEngine).getButtonInfo(M.TOP_BUTTON).isPressed()){let s=he.color1To255(he.rgbToHSV(n)),a=he.color1To255(n);console.log("RGB:",a.vec_toString(0),"- HSV:",s.vec_toString(0))}}_getTextMaterial(e){let t=null,n=e.pp_getComponent(TextComponent);return n&&(t=n.material),t}};import{Component as nV,Property as Tm}from"@wonderlandengine/api";var Nn=class extends nV{init(){this._myEasyObjectTuner=null,r.isToolEnabled(this.engine)&&(this._myEasyObjectTuner=new $a(this.object,this._myVariableName,this._mySetAsDefault,this._myUseTuneTarget))}start(){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.start()}update(e){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.update(e)}};R(Nn,"TypeName","pp-easy-light-attenuation"),R(Nn,"Properties",{_myVariableName:Tm.string(""),_mySetAsDefault:Tm.bool(!1),_myUseTuneTarget:Tm.bool(!1)});import{Component as oV,Property as nl}from"@wonderlandengine/api";var Gn=class extends oV{init(){this._myEasyObjectTuner=null,r.isToolEnabled(this.engine)&&(this._myEasyObjectTuner=new er(this._myColorModel,this.object,this._myVariableName,this._mySetAsDefault,this._myUseTuneTarget))}start(){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.start()}update(e){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.update(e)}};R(Gn,"TypeName","pp-easy-light-color"),R(Gn,"Properties",{_myVariableName:nl.string(""),_mySetAsDefault:nl.bool(!1),_myUseTuneTarget:nl.bool(!1),_myColorModel:nl.enum(["RGB","HSV"],"HSV")});import{Component as sV,Property as bm}from"@wonderlandengine/api";var Un=class extends sV{init(){this._myEasyObjectTuner=null,r.isToolEnabled(this.engine)&&(this._myEasyObjectTuner=new or(this.object,this._myVariableName,this._mySetAsDefault,this._myUseTuneTarget))}start(){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.start()}update(e){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.update(e)}pp_clone(e){return N.cloneDefault(this,e)}};R(Un,"TypeName","pp-easy-mesh-ambient-factor"),R(Un,"Properties",{_myVariableName:bm.string(""),_myUseTuneTarget:bm.bool(!1),_mySetAsDefault:bm.bool(!1)});import{Component as aV,Property as ar}from"@wonderlandengine/api";var Wn=class extends aV{init(){this._myEasyObjectTuner=null,r.isToolEnabled(this.engine)&&(this._myEasyObjectTuner=new tr(this._myColorModel,this._myColorType,this.object,this._myVariableName,this._mySetAsDefault,this._myUseTuneTarget))}start(){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.start()}update(e){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.update(e)}pp_clone(e){return N.cloneDefault(this,e)}};R(Wn,"TypeName","pp-easy-mesh-color"),R(Wn,"Properties",{_myVariableName:ar.string(""),_myUseTuneTarget:ar.bool(!1),_mySetAsDefault:ar.bool(!1),_myColorModel:ar.enum(["RGB","HSV"],"HSV"),_myColorType:ar.enum(["Color","Diffuse Color","Ambient Color","Specular Color","Emissive Color","Fog Color","Ambient Factor"],"Color")});import{Component as rV,Property as rr}from"@wonderlandengine/api";var Qn=class extends rV{init(){this._myEasyObjectTuner=null,r.isToolEnabled(this.engine)&&(this._myEasyObjectTuner=new ir(this._myLocal,this._myScaleAsOne,this.object,this._myVariableName,this._mySetAsDefault,this._myUseTuneTarget))}start(){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.start()}update(e){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.update(e)}};R(Qn,"TypeName","pp-easy-scale"),R(Qn,"Properties",{_myVariableName:rr.string(""),_mySetAsDefault:rr.bool(!1),_myUseTuneTarget:rr.bool(!1),_myLocal:rr.bool(!1),_myScaleAsOne:rr.bool(!0)});import{Component as lV,Property as Ab}from"@wonderlandengine/api";var qn=class extends lV{start(){if(r.isToolEnabled(this.engine)){this._myEasyTuneVariableName="Target Child ",this._myVariableName==""?this._myEasyTuneVariableName=this._myEasyTuneVariableName.concat(this.object.pp_getID()):this._myEasyTuneVariableName=this._myEasyTuneVariableName.concat(this._myVariableName);let e=this.object.pp_getChildren().length,t=1,n=e;e==0&&(t=0,n=0),r.getEasyTuneVariables(this.engine).add(new EasyTuneInt(this._myEasyTuneVariableName,0,10,t,n)),this._mySetAsDefault&&He.setWidgetActiveVariable(this._myEasyTuneVariableName,this.engine),this._myCurrentChildIndex=-1,this._myCurrentChildrenCount=e,this._myEasyTuneTarget=null}}update(e){if(r.isToolEnabled(this.engine)&&r.getEasyTuneVariables(this.engine).isActive(this._myEasyTuneVariableName)){let t=this.object.pp_getChildren().length;if(t!=this._myCurrentChildrenCount){this._myCurrentChildrenCount=t;let o=1,s=t;t==0&&(o=0,s=0);let a=r.getEasyTuneVariables(this.engine).getEasyTuneVariable(this._myEasyTuneVariableName);a.setMin(o),a.setMax(s)}let n=r.getEasyTuneVariables(this.engine).get(this._myEasyTuneVariableName);n!=this._myCurrentChildIndex&&(n==0&&this._myCurrentChildIndex!=-1?(r.getEasyTuneTarget(this.engine)==this._myEasyTuneTarget&&r.removeEasyTuneTarget(this.engine),this._myEasyTuneTarget=null):n>0&&(this._myEasyTuneTarget=this.object.pp_getChildren()[n-1],r.setEasyTuneTarget(this._myEasyTuneTarget,this.engine)),this._myCurrentChildIndex=n)}}};R(qn,"TypeName","pp-easy-set-tune-target-child-number"),R(qn,"Properties",{_myVariableName:Ab.string(""),_mySetAsDefault:Ab.bool(!1)});import{Component as mV}from"@wonderlandengine/api";var Xn=class extends mV{start(){this._myGrabber=null,r.isToolEnabled(this.engine)&&(this._myGrabber=this.object.pp_getComponent(bi),this._myEasyTuneTarget=null)}_onRelease(e,t){this._myEasyTuneTarget=t.object,r.setEasyTuneTarget(this._myEasyTuneTarget,this.engine)}_onGrab(e,t){r.getEasyTuneTarget(this.engine)==this._myEasyTuneTarget&&r.removeEasyTuneTarget(this.engine),this._myEasyTuneTarget=null}onActivate(){r.isToolEnabled(this.engine)&&this._myGrabber!=null&&this._myGrabber.registerThrowEventListener(this,this._onRelease.bind(this))}onDeactivate(){r.isToolEnabled(this.engine)&&this._myGrabber!=null&&this._myGrabber.unregisterThrowEventListener(this)}};R(Xn,"TypeName","pp-easy-set-tune-target-grab"),R(Xn,"Properties",{});import{Component as yV,Property as lr}from"@wonderlandengine/api";var Kn=class extends yV{init(){this._myEasyObjectTuner=null,r.isToolEnabled(this.engine)&&(this._myEasyObjectTuner=new sr(this._myColorModel,this._myColorType,this.object,this._myVariableName,this._mySetAsDefault,this._myUseTuneTarget))}start(){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.start()}update(e){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.update(e)}};R(Kn,"TypeName","pp-easy-text-color"),R(Kn,"Properties",{_myVariableName:lr.string(""),_mySetAsDefault:lr.bool(!1),_myUseTuneTarget:lr.bool(!1),_myColorModel:lr.enum(["RGB","HSV"],"HSV"),_myColorType:lr.enum(["Color","Effect Color"],"Color")});import{Component as uV,Property as mr}from"@wonderlandengine/api";var Jn=class extends uV{init(){this._myEasyObjectTuner=null,r.isToolEnabled(this.engine)&&(this._myEasyObjectTuner=new nr(this._myLocal,this._myScaleAsOne,this.object,this._myVariableName,this._mySetAsDefault,this._myUseTuneTarget))}start(){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.start()}update(e){r.isToolEnabled(this.engine)&&this._myEasyObjectTuner!=null&&this._myEasyObjectTuner.update(e)}pp_clone(e){return N.cloneDefault(this,e)}};R(Jn,"TypeName","pp-easy-transform"),R(Jn,"Properties",{_myVariableName:mr.string(""),_mySetAsDefault:mr.bool(!1),_myUseTuneTarget:mr.bool(!1),_myLocal:mr.bool(!1),_myScaleAsOne:mr.bool(!0)});export{Ci as AddPPToWindowComponent,gi as AddWLToWindowComponent,dn as AdjustHierarchyPhysXScaleComponent,q as ArrayUtils,Ms as AudioEvent,Es as AudioManager,$t as AudioManagerComponent,Zn as AudioPlayer,Ji as AudioSetup,oR as AudioUtils,Os as BaseGamepad,je as BasePose,xt as BasePoseParams,un as BenchmarkMaxPhysXComponent,hn as BenchmarkMaxVisibleTrianglesComponent,Zo as BrowserUtils,Tn as CADisplayLeaderboardComponent,Xs as CADummyServer,ot as CAError,Te as CAUtils,ta as CharacterColliderAdditionalParams,ia as CharacterColliderDebugParams,Zs as CharacterColliderHorizontalCheckParams,HT as CharacterColliderHorizontalPositionVerticalCheckDirection,co as CharacterColliderSetup,po as CharacterColliderSetupSimplifiedCreationAccuracyLevel,oa as CharacterColliderSetupSimplifiedCreationParams,cm as CharacterColliderSetupUtils,na as CharacterColliderSlideFlickerPreventionMode,ea as CharacterColliderSplitMovementParams,ms as CharacterColliderSurfaceParams,Ys as CharacterColliderVerticalCheckParams,$s as CharacterColliderWallSlideParams,ss as CharacterCollisionCheckTransformResults,en as CharacterCollisionCheckType,rs as CharacterCollisionDebugResults,ls as CharacterCollisionInternalResults,$i as CharacterCollisionMovementResults,Ge as CharacterCollisionResults,as as CharacterCollisionSplitMovementResults,uo as CharacterCollisionSurfaceInfo,ho as CharacterCollisionSurfaceResults,ys as CharacterCollisionSystem,vn as CharacterCollisionSystemComponent,os as CharacterCollisionTeleportResults,ns as CharacterCollisionTransformResults,is as CharacterCollisionWallSlideResults,_o as CharacterController,xn as CharacterControllerComponent,qR as CharacterControllerUtils,No as ClassicGamepadCore,_a as CleanedPlayerLocomotion,ui as CleanedPlayerLocomotionSmooth,yt as CleanedPlayerTransformManager,cn as ClearConsoleOnXRSessionStartComponent,Zt as CloneParams,G as CollisionCheck,mi as CollisionCheckBridge,Ae as CollisionCheckParams,Bi as CollisionCheckUtils,re as CollisionRuntimeParams,he as ColorUtils,N as ComponentUtils,qt as ConsoleOriginalFunctions,Aa as ConsoleVR,wn as ConsoleVRToolComponent,Ra as ConsoleVRWidget,Sa as ConsoleVRWidgetConfig,pe as ConsoleVRWidgetConsoleFunction,el as ConsoleVRWidgetMessage,k as ConsoleVRWidgetMessageType,Da as ConsoleVRWidgetParams,ba as ConsoleVRWidgetPulseOnNewMessage,Oe as ConsoleVRWidgetSender,xa as ConsoleVRWidgetUI,Hn as CopyHandTransformComponent,Ln as CopyHeadTransformComponent,Fn as CopyPlayerPivotTransformComponent,kn as CopyPlayerTransformComponent,Ts as CustomCloneParams,fn as DebugArrayFunctionsPerformanceAnalyzerComponent,es as DebugFunctionPerformanceAnalysisResults,$o as DebugFunctionsOverwriter,Yo as DebugFunctionsOverwriterParams,Qs as DebugFunctionsPerformanceAnalysisResultsLogger,Ws as DebugFunctionsPerformanceAnalysisResultsLoggerParams,yo as DebugFunctionsPerformanceAnalyzer,et as DebugFunctionsPerformanceAnalyzerComponent,ts as DebugFunctionsPerformanceAnalyzerParams,Ut as DebugFunctionsPerformanceAnalyzerSortOrder,As as DebugManager,ti as DebugManagerComponent,gn as DebugPPFunctionsPerformanceAnalyzerComponent,_n as DebugTransformComponent,to as DebugVisualManager,Cn as DebugWLComponentsFunctionsPerformanceAnalyzerComponent,Pn as DebugWLFunctionsPerformanceAnalyzerComponent,Yt as DeepCloneParams,xs as DefaultResources,Lr as DefaultResourcesMaterials,Hr as DefaultResourcesMeshes,wo as DefaultWLComponentCloneCallbacks,Mt as Direction2DTo3DConverter,li as Direction2DTo3DConverterParams,pr as EPSILON,jm as EPSILON_DEGREES,wm as EPSILON_SQUARED,ue as EasingFunction,$a as EasyLightAttenuation,Nn as EasyLightAttenuationComponent,er as EasyLightColor,Gn as EasyLightColorComponent,or as EasyMeshAmbientFactor,Un as EasyMeshAmbientFactorComponent,tr as EasyMeshColor,Wn as EasyMeshColorComponent,st as EasyObjectTuner,ir as EasyScale,Qn as EasyScaleComponent,Xn as EasySetTuneTargeetGrabComponent,qn as EasySetTuneTargetChildNumberComponent,sr as EasyTextColor,Kn as EasyTextColorComponent,nr as EasyTransform,Jn as EasyTransformComponent,Bo as EasyTuneBaseArrayWidgetSelector,Xt as EasyTuneBaseWidget,Kt as EasyTuneBaseWidgetConfig,Oa as EasyTuneBaseWidgetParams,Jt as EasyTuneBaseWidgetUI,gm as EasyTuneBool,tl as EasyTuneBoolArray,Fa as EasyTuneBoolArrayWidget,Ba as EasyTuneBoolArrayWidgetConfig,wa as EasyTuneBoolArrayWidgetSelector,ka as EasyTuneBoolArrayWidgetUI,zn as EasyTuneImportVariablesComponent,_m as EasyTuneInt,ki as EasyTuneIntArray,Ga as EasyTuneNoneWidget,za as EasyTuneNoneWidgetConfig,Na as EasyTuneNoneWidgetUI,sn as EasyTuneNumber,Li as EasyTuneNumberArray,Qa as EasyTuneNumberArrayWidget,Ua as EasyTuneNumberArrayWidgetConfig,qa as EasyTuneNumberArrayWidgetSelector,Wa as EasyTuneNumberArrayWidgetUI,jn as EasyTuneToolComponent,Oo as EasyTuneTransform,Ja as EasyTuneTransformWidget,Xa as EasyTuneTransformWidgetConfig,Ka as EasyTuneTransformWidgetUI,He as EasyTuneUtils,Vo as EasyTuneVariable,hi as EasyTuneVariableArray,ci as EasyTuneVariableType,ks as EasyTuneVariables,Ya as EasyTuneWidget,ja as EasyTuneWidgetConfig,Za as EasyTuneWidgetParams,fi as EnableDebugsComponent,Pi as EnableToolsComponent,ze as FSM,Si as FingerCursorComponent,ai as GamepadAxesEvent,oe as GamepadAxesID,no as GamepadAxesInfo,ae as GamepadButtonEvent,M as GamepadButtonID,io as GamepadButtonInfo,On as GamepadControlSchemeComponent,Nt as GamepadCore,Qi as GamepadMeshAnimatorComponent,oo as GamepadPulseInfo,pA as GamepadUtils,Bs as GamepadsManager,kt as GetDefaultResourcesComponent,Ft as GetSceneObjectsComponent,r as Globals,Ti as GrabbableComponent,bi as GrabberHandComponent,ao as HandPose,so as HandPoseParams,A as Handedness,Gi as HandednessIndex,Is as HeadPose,nm as HowlerAudioPlayer,xi as InitConsoleVRComponent,Lt as InitEasyTuneVariablesComponent,Ls as InputManager,Ht as InputManagerComponent,$e as InputSourceType,ee as InputUtils,mm as IntOverValue,ym as IntRangeOverValue,$ as JSUtils,te as KeyID,Vs as Keyboard,Go as KeyboardGamepadCore,Y as Mat3Utils,V as Mat4Utils,Us as MaterialUtils,H as MathUtils,Fo as MeshCreationParams,Ni as MeshCreationTriangleParams,ko as MeshCreationVertexParams,Xe as MeshUtils,Hs as Mouse,Zi as MouseButtonID,mn as MuteEverythingComponent,Oi as NumberOverValue,Ur as NumberRangeOverValue,Yn as ObjectPool,Mi as ObjectPoolParams,Ds as ObjectPoolsManager,u as ObjectUtils,ln as PPGatewayComponent,js as PerformDelayedMode,Vi as PerformMode,Ai as PhysicsCollisionCollector,Re as PhysicsLayerFlags,Me as PhysicsUtils,sa as PlayerCharacterController,Mn as PlayerCharacterControllerComponent,ra as PlayerHandCharacterController,Dn as PlayerHandCharacterControllerComponent,aa as PlayerHeadCharacterController,En as PlayerHeadCharacterControllerComponent,Ks as PlayerHeadController,bn as PlayerHeadControllerComponent,se as PlayerHeadManager,tn as PlayerHeadManagerParams,da as PlayerLocomotion,Rn as PlayerLocomotionComponent,Xr as PlayerLocomotionDirectionReferenceType,Hi as PlayerLocomotionMovement,go as PlayerLocomotionMovementRuntimeParams,pa as PlayerLocomotionParams,Wt as PlayerLocomotionRotate,fo as PlayerLocomotionRotateParams,yi as PlayerLocomotionSmooth,So as PlayerLocomotionSmoothParams,on as PlayerLocomotionTeleport,ma as PlayerLocomotionTeleportDetectionParams,Qr as PlayerLocomotionTeleportDetectionRuntimeParams,dt as PlayerLocomotionTeleportDetectionState,nn as PlayerLocomotionTeleportDetectionVisualizer,la as PlayerLocomotionTeleportDetectionVisualizerParams,Qt as PlayerLocomotionTeleportParable,bo as PlayerLocomotionTeleportParams,qr as PlayerLocomotionTeleportRuntimeParams,Ct as PlayerLocomotionTeleportState,ya as PlayerLocomotionTeleportTeleportBlinkState,ha as PlayerLocomotionTeleportTeleportParams,To as PlayerLocomotionTeleportTeleportShiftState,ca as PlayerLocomotionTeleportTeleportState,ua as PlayerLocomotionTeleportTeleportType,Ir as PlayerObjects,Co as PlayerObscureManager,Po as PlayerObscureManagerParams,mt as PlayerTransformManager,vo as PlayerTransformManagerParams,le as PlayerTransformManagerSyncFlag,Js as PlayerViewOcclusion,Sn as PlayerViewOcclusionComponent,Ce as PluginUtils,O as Quat2Utils,f as QuatUtils,lt as RaycastHit,ct as RaycastParams,Le as RaycastResults,am as SaveManager,Gt as SaveUtils,vs as SceneObjects,J as SceneUtils,pn as SetActiveComponent,qi as SetHandLocalTransformComponent,vi as SetHeadLocalTransformComponent,In as SetPlayerHeightComponent,Xi as SetTrackedHandJointLocalTransformComponent,Ui as ShowFPSComponent,Xo as SkipStateFunction,yn as SpatialAudioListenerComponent,mo as State,Ko as StateData,An as SwitchHandObjectComponent,Ii as SyncedCharacterController,bR as TextUtils,ie as Timer,Ns as TimerState,Ki as ToolCursorComponent,U as ToolHandedness,Ee as ToolInputSourceType,Vn as TrackedHandDrawAllJointsComponent,ii as TrackedHandDrawJointComponent,Wi as TrackedHandDrawSkinComponent,at as TrackedHandJointID,jo as TrackedHandJointIDIndex,Qo as TrackedHandJointPose,qo as TrackedHandPose,ro as TrackedHandPoseParams,lm as Transition,Jo as TransitionData,Wo as UniversalGamepad,gt as Vec2Utils,p as Vec3Utils,zi as Vec4Utils,At as VecUtils,Ta as VirtualGamepad,Et as VirtualGamepadButtonParams,Bn as VirtualGamepadComponent,us as VirtualGamepadGamepadCore,xo as VirtualGamepadIcon,hs as VirtualGamepadIconParams,Ve as VirtualGamepadIconType,Mo as VirtualGamepadParams,fa as VirtualGamepadThumbstickParams,Pa as VirtualGamepadVirtualButton,Ca as VirtualGamepadVirtualThumbstick,ht as VisualArrow,tt as VisualArrowParams,xe as VisualElementType,rt as VisualLine,Ke as VisualLineParams,eo as VisualManager,ei as VisualManagerComponent,Ei as VisualMesh,ni as VisualMeshParams,wt as VisualPoint,vt as VisualPointParams,$n as VisualRaycast,oi as VisualRaycastParams,Rs as VisualResources,kr as VisualResourcesMaterials,Di as VisualText,Vt as VisualTextParams,zt as VisualTorus,jt as VisualTorusParams,si as VisualTransform,Ot as VisualTransformParams,Do as WidgetFrame,Ma as WidgetFrameConfig,Ea as WidgetFrameUI,Eo as WidgetParams,Uo as XRGamepadCore,B as XRUtils,jy as add,Hd as addComponent,pl as addEngine,Sb as addRefreshWidgetCallback,Tb as addSetWidgetActiveVariableCallback,Hy as angle,ty as angleClamp,iy as angleClampDegrees,ny as angleClampRadians,Ly as angleDegrees,Km as angleDistance,Jm as angleDistanceDegrees,Zm as angleDistanceRadians,Ym as angleDistanceSigned,$m as angleDistanceSignedDegrees,ey as angleDistanceSignedRadians,ky as angleRadians,Jy as angleSigned,Zy as angleSignedDegrees,Yy as angleSignedRadians,KT as areButtonsPressEnd,XT as areButtonsPressStart,$T as areButtonsTouchEnd,ZT as areButtonsTouchStart,Wf as ceil,ET as checkMovement,DT as checkTeleportToTransform,RT as checkTransform,oP as cleanObjectProperties,fP as cloneCollision,FP as cloneDefault,gP as cloneMesh,CP as clonePhysX,kP as clonePostProcess,PP as cloneText,ZC as color1To255,JC as color255To1,tu as componentAlongAxis,wT as computeCeilingPerceivedAngle,FT as computeGroundPerceivedAngle,jT as computeSurfacePerceivedAngle,IT as convertCharacterColliderSetupToCollisionCheckParams,OT as convertCharacterCollisionResultsToCollisionRuntimeParams,BT as convertCollisionRuntimeParamsToCharacterCollisionResults,_d as convertDirectionLocalToObject,yd as convertDirectionLocalToWorld,pd as convertDirectionObjectToLocal,ad as convertDirectionObjectToWorld,bu as convertDirectionToLocal,vu as convertDirectionToLocalMatrix,Mu as convertDirectionToLocalQuat,Tu as convertDirectionToWorld,Su as convertDirectionToWorldMatrix,xu as convertDirectionToWorldQuat,hd as convertDirectionWorldToLocal,ld as convertDirectionWorldToObject,dd as convertPositionLocalToObject,md as convertPositionLocalToWorld,cd as convertPositionObjectToLocal,sd as convertPositionObjectToWorld,_u as convertPositionToLocal,fu as convertPositionToLocalMatrix,Cu as convertPositionToLocalQuat,du as convertPositionToWorld,gu as convertPositionToWorldMatrix,Pu as convertPositionToWorldQuat,ud as convertPositionWorldToLocal,rd as convertPositionWorldToObject,Od as convertTransformLocalToObject,Bd as convertTransformLocalToObjectMatrix,Id as convertTransformLocalToObjectQuat,Sd as convertTransformLocalToWorld,vd as convertTransformLocalToWorldMatrix,xd as convertTransformLocalToWorldQuat,Rd as convertTransformObjectToLocal,Ad as convertTransformObjectToLocalMatrix,Vd as convertTransformObjectToLocalQuat,gd as convertTransformObjectToWorld,fd as convertTransformObjectToWorldMatrix,Pd as convertTransformObjectToWorldQuat,Md as convertTransformWorldToLocal,Ed as convertTransformWorldToLocalMatrix,Dd as convertTransformWorldToLocalQuat,Cd as convertTransformWorldToObject,Td as convertTransformWorldToObjectMatrix,bd as convertTransformWorldToObjectQuat,ou as copyComponentAlongAxis,nP as copyObjectProperties,pP as createPlane,LT as createSimplified,kT as createTeleportColliderSetupFromMovementColliderSetup,Wy as cross,Eu as degreesAddRotation,Du as degreesAddRotationDegrees,Au as degreesAddRotationQuat,Ru as degreesAddRotationRadians,Hu as degreesToMatrix,eu as degreesToQuat,U_ as destroy,Fy as distance,wy as distanceSquared,Ny as div,sP as doesObjectPropertyUseAccessors,Gy as dot,zf as error,Cb as exportVariables,yy as find,hy as findAll,dy as findAllEqual,cy as findAllIndexes,gy as findAllIndexesEqual,py as findEqual,uy as findIndex,_y as findIndexEqual,ry as first,Uf as floor,Ku as fromAxis,Ju as fromAxisDegrees,Zu as fromAxisRadians,$u as fromDegrees,Dy as fromMatrix,Iy as fromQuat,Yu as fromRadians,lh as fromTwistSwing,vT as generate360TeleportParamsFromMovementParams,Gu as getAngle,Uu as getAngleDegrees,Wu as getAngleRadians,xm as getAudioManager,kh as getAxesLocal,Lh as getAxesWorld,Nu as getAxis,Qu as getAxisScaled,qu as getAxisScaledDegrees,Xu as getAxisScaledRadians,zh as getBackwardLocal,jh as getBackwardWorld,Am as getBody,xg as getCanvas,Lg as getCharacterCollisionSystem,L_ as getChildren,EP as getClassFromType,zP as getCloneCallback,WP as getClonePostProcessCallback,ug as getComponentBreadth,Gd as getComponentChildren,hg as getComponentDepth,jd as getComponentDescendants,zd as getComponentDescendantsBreadth,Nd as getComponentDescendantsDepth,kd as getComponentHierarchy,Fd as getComponentHierarchyBreadth,wd as getComponentHierarchyDepth,eg as getComponentObjects,Ld as getComponentSelf,$_ as getComponentsAmountMapChildren,Y_ as getComponentsAmountMapDescendants,Z_ as getComponentsAmountMapHierarchy,J_ as getComponentsAmountMapSelf,cg as getComponentsBreadth,Zd as getComponentsChildren,pg as getComponentsDepth,Xd as getComponentsDescendants,Kd as getComponentsDescendantsBreadth,Jd as getComponentsDescendantsDepth,Wd as getComponentsHierarchy,Qd as getComponentsHierarchyBreadth,qd as getComponentsHierarchyDepth,tg as getComponentsObjects,Ud as getComponentsSelf,db as getConsoleOriginalAssert,_b as getConsoleOriginalClear,pb as getConsoleOriginalDebug,ub as getConsoleOriginalError,cb as getConsoleOriginalInfo,yb as getConsoleOriginalLog,hb as getConsoleOriginalWarn,df as getConsoleVR,Pl as getDebugManager,Vg as getDebugVisualManager,Vf as getDefaultMaterials,Af as getDefaultMeshes,Mr as getDefaultResources,qP as getDefaultWLComponentCloneCallback,B_ as getDescendants,I_ as getDescendantsBreadth,H_ as getDescendantsDepth,ml as getDocument,Wh as getDownLocal,Uh as getDownWorld,pT as getDummyServer,Sf as getEasyTuneTarget,Pf as getEasyTuneVariables,j_ as getEngine,Sg as getEngines,wh as getForwardLocal,Fh as getForwardWorld,sC as getFrame,qg as getGamepad,Xg as getGamepads,Qg as getGamepadsManager,Yg as getHandPose,$g as getHandPoses,gC as getHandednessByIndex,Zg as getHeadPose,A_ as getHierarchy,V_ as getHierarchyBreadth,O_ as getHierarchyDepth,z_ as getID,qe as getInputManager,fC as getInputSource,CC as getInputSourceType,PC as getInputSourceTypeByHandedness,AP as getJavascriptComponentClass,VP as getJavascriptComponentClassesByIndex,RP as getJavascriptComponentInstances,IP as getJavascriptComponentTypeFromIndex,OP as getJavascriptComponentTypeIndex,BP as getJavascriptComponentTypeIndexes,bC as getJointIDByIndex,Wg as getKeyboard,RC as getLayerFlagsNames,gT as getLeaderboard,fT as getLeaderboardDummy,Kg as getLeftGamepad,ef as getLeftHandPose,qh as getLeftLocal,sf as getLeftTrackedHandPose,Qh as getLeftWorld,pi as getMainEngine,Ug as getMouse,F_ as getName,Rm as getNavigator,Pg as getObjectByIDBreadth,R_ as getObjectByIDChildren,Cg as getObjectByIDDepth,M_ as getObjectByIDDescendants,E_ as getObjectByIDDescendantsBreadth,D_ as getObjectByIDDescendantsDepth,S_ as getObjectByIDHierarchy,v_ as getObjectByIDHierarchyBreadth,x_ as getObjectByIDHierarchyDepth,sg as getObjectByIDObjects,dg as getObjectByNameBreadth,d_ as getObjectByNameChildren,_g as getObjectByNameDepth,h_ as getObjectByNameDescendants,c_ as getObjectByNameDescendantsBreadth,p_ as getObjectByNameDescendantsDepth,m_ as getObjectByNameHierarchy,y_ as getObjectByNameHierarchyBreadth,u_ as getObjectByNameHierarchyDepth,ng as getObjectByNameObjects,$f as getObjectFromPath,eP as getObjectNameFromPath,tP as getObjectParentFromPath,Kf as getObjectProperty,Xf as getObjectPropertyDescriptor,qf as getObjectPropertyNames,Zf as getObjectPropertyOwnParent,Yf as getObjectPropertyOwnParents,Qf as getObjectPrototypes,lg as getObjects,mg as getObjectsBreadth,ag as getObjectsByIDObjects,gg as getObjectsByNameBreadth,b_ as getObjectsByNameChildren,fg as getObjectsByNameDepth,P_ as getObjectsByNameDescendants,C_ as getObjectsByNameDescendantsBreadth,T_ as getObjectsByNameDescendantsDepth,__ as getObjectsByNameHierarchy,g_ as getObjectsByNameHierarchyBreadth,f_ as getObjectsByNameHierarchyDepth,og as getObjectsByNameObjects,yg as getObjectsDepth,TC as getOppositeHandedness,od as getParent,vg as getPhysics,Lf as getPlayerObjects,ch as getPositionLocal,hh as getPositionWorld,nC as getReferenceSpace,oC as getReferenceSpaceType,Jg as getRightGamepad,tf as getRightHandPose,Kh as getRightLocal,af as getRightTrackedHandPose,Xh as getRightWorld,Ch as getRotationLocal,Th as getRotationLocalDegrees,Sh as getRotationLocalMatrix,vh as getRotationLocalQuat,bh as getRotationLocalRadians,ph as getRotationMatrix,dh as getRotationWorld,_h as getRotationWorldDegrees,fh as getRotationWorldMatrix,Ph as getRotationWorldQuat,gh as getRotationWorldRadians,_T as getSDK,Mh as getScaleLocal,xh as getScaleWorld,gl as getScene,Of as getSceneObjects,k_ as getSelf,tC as getSession,iC as getSessionMode,WT as getSimultaneousPressMaxDelay,QT as getSimultaneousTouchMaxDelay,sh as getSwing,ah as getSwingFromTwist,nf as getTrackedHandPose,of as getTrackedHandPoses,Eh as getTransform,Bh as getTransformLocal,Ih as getTransformLocalMatrix,Hh as getTransformLocalQuat,Dh as getTransformMatrix,Rh as getTransformQuat,Ah as getTransformWorld,Vh as getTransformWorldMatrix,Oh as getTransformWorldQuat,oh as getTwist,rh as getTwistFromSwing,MP as getTypeFromTypeOrClass,Gh as getUpLocal,Nh as getUpWorld,TT as getUser,bT as getUserDummy,Hm as getVisualManager,Vm as getVisualResources,Mg as getWASM,xP as getWLJavascriptComponentTypes,vP as getWLNativeComponentTypes,ur as getWindow,Eg as getXR,Dm as hasAudioManager,wg as hasCharacterCollisionSystem,NP as hasCloneCallback,LP as hasClonePostProcess,QP as hasClonePostProcessCallback,ff as hasConsoleVR,Hg as hasDebugEnabled,Ag as hasDebugManager,Rf as hasDefaultResources,XP as hasDefaultWLComponentCloneCallback,Mf as hasEasyTuneTarget,bf as hasEasyTuneVariables,_l as hasEngine,my as hasEqual,Gg as hasInputManager,yf as hasPoseForwardFixed,Hf as hasSceneObjects,pf as hasToolEnabled,l_ as hasUniformScaleLocal,r_ as hasUniformScaleWorld,Fm as hasVisualManager,Im as hasVisualResources,XC as hsvCodeToHuman,KC as hsvHumanToCode,WC as hsvToRGB,Pb as importVariables,Rl as initArrayExtension,cP as initArrayExtensionProtoype,MT as initBridge,ql as initComponentMods,Ul as initCursorComponentMod,SC as initCursorComponentModPrototype,Wl as initCursorTargetComponentMod,vC as initCursorTargetComponentModPrototype,Xl as initEmitterMod,MC as initEmitterModPrototype,bg as initEngine,Fl as initJSExtensions,wl as initJSPlugins,Ll as initMathExtension,ZP as initMathExtensionStatic,Ql as initMouseLookComponentMod,xC as initMouseLookComponentModPrototype,kl as initNumberExtension,YP as initNumberExtensionPrototype,jl as initObjectExtension,$P as initObjectExtensionProtoype,$l as initPP,Zl as initPlugins,zl as initSceneExtension,eC as initSceneExtensionPrototype,Nl as initWLExtensions,Kl as initWLMods,Jl as initWLPlugins,hP as injectProperties,dC as isARSupported,cA as isAnyButtonPressEnd,qT as isAnyButtonPressStart,YT as isAnyButtonTouchEnd,JT as isAnyButtonTouchStart,yP as isClass,rP as isClassByName,su as isConcordant,Og as isDebugEnabled,aT as isDesktop,_C as isDeviceEmulated,au as isFartherAlongAxis,mP as isFunction,aP as isFunctionByName,oy as isInsideAngleRange,sy as isInsideAngleRangeDegrees,ay as isInsideAngleRangeRadians,sT as isMobile,uP as isObject,lP as isObjectByName,cu as isOnAxis,pu as isOnPlane,HC as isPlaybackBlocked,rf as isPoseForwardFixed,rC as isReferenceSpaceFloorBased,dT as isSDKAvailable,aC as isSessionActive,ru as isToTheRight,uf as isToolEnabled,G_ as isTransformChanged,DP as isTypeRegistered,cT as isUseDummyServerOnError,hT as isUseDummyServerOnSDKMissing,pC as isVRSupported,TP as isWLComponent,SP as isWLJavascriptComponent,bP as isWLNativeComponent,HP as isWLNativeComponentRegistered,ly as last,Ky as lengthSigned,wC as load,NC as loadBool,zC as loadNumber,jC as loadString,jf as log,Zp as lookAt,$p as lookAtLocal,Yp as lookAtWorld,ed as lookTo,id as lookToLocal,td as lookToWorld,Gm as mapToRange,N_ as markDirty,wE as mat3_create,be as mat4_create,Uy as negate,iP as overwriteObjectProperty,zu as perpendicularRandom,mu as projectOnAxis,yu as projectOnAxisAlongAxis,uu as projectOnPlane,hu as projectOnPlaneAlongAxis,Sy as pushUnique,j as quat2_create,z as quat_create,Vu as radiansAddRotation,Ou as radiansAddRotationDegrees,Iu as radiansAddRotationQuat,Bu as radiansAddRotationRadians,Lu as radiansToMatrix,$y as radiansToQuat,Um as random,Qm as randomBool,Wm as randomInt,Xm as randomPick,qm as randomSign,AC as raycast,fb as refreshWidget,Yl as registerPPComponents,yC as registerSessionEndEventListener,hC as registerSessionStartEndEventListeners,lC as registerSessionStartEventListener,rl as registerWLComponents,Cy as removeAll,by as removeAllEqual,Py as removeAllIndexes,Em as removeAudioManager,Fg as removeCharacterCollisionSystem,jP as removeCloneCallback,UP as removeClonePostProcessCallback,nu as removeComponentAlongAxis,gf as removeConsoleVR,Ig as removeDebugEnabled,Rg as removeDebugManager,Df as removeDefaultResources,JP as removeDefaultWLComponentCloneCallbacks,xf as removeEasyTuneTarget,Tf as removeEasyTuneVariables,dl as removeEngine,Ty as removeEqual,fy as removeIndex,Ng as removeInputManager,mf as removePoseForwardFixed,vb as removeRefreshWidgetCallback,If as removeSceneObjects,bb as removeSetWidgetActiveVariableCallback,cf as removeToolEnabled,km as removeVisualManager,Bm as removeVisualResources,W_ as reserveObjects,K_ as reserveObjectsChildren,X_ as reserveObjectsDescendants,q_ as reserveObjectsHierarchy,Q_ as reserveObjectsSelf,Ic as resetPosition,Lc as resetPositionLocal,Hc as resetPositionWorld,kc as resetRotation,wc as resetRotationLocal,Fc as resetRotationWorld,jc as resetScale,Nc as resetScaleLocal,zc as resetScaleWorld,Gc as resetTransform,Wc as resetTransformLocal,Uc as resetTransformWorld,QC as rgbCodeToHuman,qC as rgbHumanToCode,UC as rgbToHSV,Up as rotateAroundAxisLocal,Wp as rotateAroundAxisLocalDegrees,Qp as rotateAroundAxisLocalRadians,qp as rotateAroundAxisObject,Xp as rotateAroundAxisObjectDegrees,Kp as rotateAroundAxisObjectRadians,zp as rotateAroundAxisWorld,Np as rotateAroundAxisWorldDegrees,Gp as rotateAroundAxisWorldRadians,Vp as rotateAroundLocal,Op as rotateAroundLocalDegrees,Ip as rotateAroundLocalMatrix,Hp as rotateAroundLocalQuat,Bp as rotateAroundLocalRadians,xp as rotateAroundMatrix,Lp as rotateAroundObject,kp as rotateAroundObjectDegrees,wp as rotateAroundObjectMatrix,jp as rotateAroundObjectQuat,Fp as rotateAroundObjectRadians,Mp as rotateAroundWorld,Ep as rotateAroundWorldDegrees,Rp as rotateAroundWorldMatrix,Ap as rotateAroundWorldQuat,Dp as rotateAroundWorldRadians,Pp as rotateAxisLocal,Cp as rotateAxisLocalDegrees,Tp as rotateAxisLocalRadians,bp as rotateAxisObject,Sp as rotateAxisObjectDegrees,vp as rotateAxisObjectRadians,_p as rotateAxisWorld,gp as rotateAxisWorldDegrees,fp as rotateAxisWorldRadians,ap as rotateLocal,rp as rotateLocalDegrees,mp as rotateLocalMatrix,yp as rotateLocalQuat,lp as rotateLocalRadians,ep as rotateMatrix,up as rotateObject,hp as rotateObjectDegrees,pp as rotateObjectMatrix,dp as rotateObjectQuat,cp as rotateObjectRadians,tp as rotateWorld,ip as rotateWorldDegrees,op as rotateWorldMatrix,sp as rotateWorldQuat,np as rotateWorldRadians,ku as rotationToPivoted,Fu as rotationToPivotedDegrees,ju as rotationToPivotedQuat,wu as rotationToPivotedRadians,Gf as round,Nm as roundDecimal,FC as save,Jp as scaleObject,Yd as setActive,a_ as setActiveChildren,n_ as setActiveDescendants,o_ as setActiveDescendantsBreadth,s_ as setActiveDescendantsDepth,e_ as setActiveHierarchy,t_ as setActiveHierarchyBreadth,i_ as setActiveHierarchyDepth,ig as setActiveObjects,$d as setActiveSelf,YC as setAlpha,Mm as setAudioManager,hc as setAxesLocal,uc as setAxesWorld,_c as setBackwardLocal,dc as setBackwardWorld,kg as setCharacterCollisionSystem,wP as setCloneCallback,GP as setClonePostProcessCallback,oT as setClonedMaterials,_f as setConsoleVR,Bg as setDebugEnabled,Dg as setDebugManager,Ef as setDefaultResources,KP as setDefaultWLComponentCloneCallbacks,Cc as setDownLocal,Pc as setDownWorld,uT as setDummyServer,vf as setEasyTuneTarget,Cf as setEasyTuneVariables,pc as setForwardLocal,cc as setForwardWorld,zg as setInputManager,DC as setLayerFlagsNames,bc as setLeftLocal,Tc as setLeftWorld,cl as setMainEngine,w_ as setName,$C as setObjectAlpha,tT as setObjectClonedMaterials,nT as setObjectFogColor,eT as setObjectMaterial,Jf as setObjectProperty,iT as setObjectSpecularColor,nd as setParent,lf as setPoseForwardFixed,Zh as setPositionLocal,Vy as setPositionRotationDegreesScale,By as setPositionRotationQuatScale,Oy as setPositionRotationRadiansScale,Ay as setPositionRotationScale,Jh as setPositionWorld,vc as setRightLocal,Sc as setRightWorld,oc as setRotationLocal,sc as setRotationLocalDegrees,rc as setRotationLocalMatrix,lc as setRotationLocalQuat,ac as setRotationLocalRadians,Yh as setRotationMatrix,$h as setRotationWorld,ec as setRotationWorldDegrees,ic as setRotationWorldMatrix,nc as setRotationWorldQuat,tc as setRotationWorldRadians,yc as setScaleLocal,mc as setScaleWorld,Bf as setSceneObjects,GT as setSimultaneousPressMaxDelay,UT as setSimultaneousTouchMaxDelay,hf as setToolEnabled,xc as setTransform,Vc as setTransformLocal,Oc as setTransformLocalMatrix,Bc as setTransformLocalQuat,Mc as setTransformMatrix,Ec as setTransformQuat,Dc as setTransformWorld,Rc as setTransformWorldMatrix,Ac as setTransformWorldQuat,fc as setUpLocal,gc as setUpWorld,yT as setUseDummyServerOnError,mT as setUseDummyServerOnSDKMissing,Lm as setVisualManager,Om as setVisualResources,gb as setWidgetActiveVariable,zm as sign,lu as signTo,yh as sinterpolate,mh as slerp,zy as sub,eh as subRotation,th as subRotationDegrees,nh as subRotationQuat,ih as subRotationRadians,PT as submitScore,CT as submitScoreDummy,qy as transformMat3,Xy as transformMat4,Qy as transformQuat,Qc as translate,Jc as translateAxis,Yc as translateAxisLocal,$c as translateAxisObject,Zc as translateAxisWorld,Xc as translateLocal,Kc as translateObject,qc as translateWorld,uC as unregisterSessionEndEventListener,cC as unregisterSessionStartEndEventListeners,mC as unregisterSessionStartEventListener,vy as unshiftUnique,VT as updateCeilingInfo,AT as updateGroundInfo,iu as valueAlongAxis,De as vec2_create,m as vec3_create,w as vec4_create,Nf as warn,rg as wrapObject};
//# sourceMappingURL=wle_pp_bundle.js.map
